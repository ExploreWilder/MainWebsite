{"version":3,"sources":["webpack://vts/webpack/bootstrap","webpack://vts/./src/core/utils/matrix.js","webpack://vts/./src/core/utils/utils.js","webpack://vts/./src/core/utils/math.js","webpack://vts/./src/core/utils/url.js","webpack://vts/./src/core/utils/platform.js","webpack://vts/./node_modules/geographiclib/geographiclib.js","webpack://vts/./node_modules/melowntech-proj4/lib/global.js","webpack://vts/./node_modules/melowntech-proj4/lib/constants/values.js","webpack://vts/./node_modules/melowntech-proj4/lib/constants/PrimeMeridian.js","webpack://vts/./node_modules/melowntech-proj4/lib/constants/units.js","webpack://vts/./node_modules/melowntech-proj4/lib/match.js","webpack://vts/./node_modules/melowntech-proj4/lib/projString.js","webpack://vts/./node_modules/wkt-parser/parser.js","webpack://vts/./node_modules/wkt-parser/process.js","webpack://vts/./node_modules/wkt-parser/index.js","webpack://vts/./node_modules/melowntech-proj4/lib/defs.js","webpack://vts/./node_modules/melowntech-proj4/lib/parseCode.js","webpack://vts/./node_modules/melowntech-proj4/lib/extend.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/msfnz.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/sign.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/adjust_lon.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/tsfnz.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/phi2z.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/longlat.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/merc.js","webpack://vts/./node_modules/melowntech-proj4/lib/constants/Ellipsoid.js","webpack://vts/./node_modules/melowntech-proj4/lib/constants/Datum.js","webpack://vts/./node_modules/melowntech-proj4/lib/datum.js","webpack://vts/./node_modules/melowntech-proj4/lib/Proj.js","webpack://vts/./node_modules/melowntech-proj4/lib/deriveConstants.js","webpack://vts/./node_modules/melowntech-proj4/lib/datumUtils.js","webpack://vts/./node_modules/melowntech-proj4/lib/datum_transform.js","webpack://vts/./node_modules/melowntech-proj4/lib/adjust_axis.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/toPoint.js","webpack://vts/./node_modules/melowntech-proj4/lib/transform.js","webpack://vts/./node_modules/melowntech-proj4/lib/core.js","webpack://vts/./node_modules/mgrs/mgrs.js","webpack://vts/./node_modules/melowntech-proj4/lib/Point.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/pj_enfn.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/pj_mlfn.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/pj_inv_mlfn.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/tmerc.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/sinh.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/hypot.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/asinhy.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/log1py.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/gatg.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/clens_cmplx.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/cosh.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/etmerc.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/clens.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/utm.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/adjust_zone.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/srat.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/gauss.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/sterea.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/stere.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/somerc.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/omerc.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/lcc.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/krovak.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/mlfn.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/e0fn.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/e1fn.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/e2fn.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/e3fn.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/gN.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/adjust_lat.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/imlfn.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/cass.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/qsfnz.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/laea.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/asinz.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/aea.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/gnom.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/cea.js","webpack://vts/./node_modules/melowntech-proj4/lib/common/iqsfnz.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/eqc.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/poly.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/nzmg.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/mill.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/sinu.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/moll.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/eqdc.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/vandg.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/aeqd.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/ortho.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/geocent.js","webpack://vts/./node_modules/melowntech-proj4/lib/projections/qsc.js","webpack://vts/./node_modules/melowntech-proj4/projs.js","webpack://vts/./node_modules/melowntech-proj4/lib/index.js","webpack://vts/./src/core/map/view.js","webpack://vts/./src/core/renderer/gpu/texture.js","webpack://vts/./src/core/map/surface-tile.js","webpack://vts/./src/core/map/surface-tree.js","webpack://vts/./src/core/map/subtexture.js","webpack://vts/./src/core/map/texture.js","webpack://vts/./src/core/renderer/bbox.js","webpack://vts/./src/core/map/metanode.js","webpack://vts/./src/core/map/metatile.js","webpack://vts/./src/core/renderer/gpu/mesh.js","webpack://vts/./src/core/map/submesh.js","webpack://vts/./src/core/renderer/gpu/program.js","webpack://vts/./src/core/renderer/gpu/shaders.js","webpack://vts/./src/core/map/mesh.js","webpack://vts/./src/core/map/geodata-geometry.js","webpack://vts/./src/core/map/geodata-import/geojson.js","webpack://vts/./src/core/map/geodata-import/vts-geodata.js","webpack://vts/./src/core/map/geodata-import/3dtiles.js","webpack://vts/./src/core/map/geodata-builder.js","webpack://vts/./src/core/map/geodata.js","webpack://vts/./src/core/map/resource-node.js","webpack://vts/./src/core/map/resource-tree.js","webpack://vts/./src/core/map/srs.js","webpack://vts/./src/core/map/cache.js","webpack://vts/./src/core/map/camera.js","webpack://vts/./src/core/map/credit.js","webpack://vts/./src/core/map/bound-layer.js","webpack://vts/./src/core/map/division-node.js","webpack://vts/./src/core/map/refframe.js","webpack://vts/./src/core/map/body.js","webpack://vts/./src/core/map/stylesheet.js","webpack://vts/./src/core/map/surface.js","webpack://vts/./src/core/map/virtual-surface.js","webpack://vts/./src/core/map/config.js","webpack://vts/./src/core/map/convert.js","webpack://vts/./src/core/map/measure.js","webpack://vts/./src/core/renderer/gpu/group.js","webpack://vts/./src/core/map/geodata-processor/processor.js","webpack://vts/./src/core/map/geodata-view.js","webpack://vts/./src/core/map/draw-tiles.js","webpack://vts/./src/core/map/draw.js","webpack://vts/./src/core/map/loader/loader.js","webpack://vts/./src/core/map/position.js","webpack://vts/./src/core/map/render-slots.js","webpack://vts/./src/core/map/stats.js","webpack://vts/./src/core/map/surface-sequence.js","webpack://vts/./src/core/map/map.js","webpack://vts/./src/core/inspector/input.js","webpack://vts/./src/core/inspector/stats.js","webpack://vts/./src/core/inspector/graphs.js","webpack://vts/./src/core/inspector/layers.js","webpack://vts/./src/core/inspector/replay.js","webpack://vts/./src/core/inspector/stylesheets.js","webpack://vts/./src/core/inspector/inspector.js","webpack://vts/./src/core/renderer/gpu/device.js","webpack://vts/./src/core/renderer/gpu/font.js","webpack://vts/./src/core/renderer/camera.js","webpack://vts/./src/core/renderer/geometry.js","webpack://vts/./src/core/renderer/gpu/bbox.js","webpack://vts/./src/core/renderer/gpu/pixel-line3.js","webpack://vts/./src/core/renderer/init.js","webpack://vts/./src/core/renderer/gmap.js","webpack://vts/./src/core/renderer/draw.js","webpack://vts/./src/core/renderer/rmap.js","webpack://vts/./src/core/renderer/renderer.js","webpack://vts/./src/core/renderer/octree.js","webpack://vts/./src/core/renderer/interface.js","webpack://vts/./src/core/map/trajectory.js","webpack://vts/./src/core/map/interface.js","webpack://vts/./src/core/core.js","webpack://vts/./node_modules/earcut/src/earcut.js","webpack://vts/./node_modules/worker-loader/dist/workers/InlineWorker.js","webpack://vts/./src/core/map/url.js","webpack://vts/./src/core/interface.js","webpack://vts/./src/core/map/geodata-processor/worker-main.js","webpack://vts/./src/core/map/loader/worker-main.js","webpack://vts/./src/browser/ui/element/event.js","webpack://vts/./src/browser/utility/dom.js","webpack://vts/./src/browser/ui/element/element.js","webpack://vts/./src/browser/ui/control/holder.js","webpack://vts/./src/browser/ui/control/map.js","webpack://vts/./src/browser/ui/control/compass.js","webpack://vts/./src/browser/ui/control/credits.js","webpack://vts/./src/browser/ui/control/fullscreen.js","webpack://vts/./src/browser/ui/control/zoom.js","webpack://vts/./src/browser/control-mode/map-observer.js","webpack://vts/./src/browser/ui/control/space.js","webpack://vts/./src/browser/ui/control/search-filter.js","webpack://vts/./src/browser/ui/control/search.js","webpack://vts/./src/browser/ui/control/link.js","webpack://vts/./src/browser/ui/control/layers.js","webpack://vts/./src/browser/ui/control/fallback.js","webpack://vts/./src/browser/ui/control/popup.js","webpack://vts/./src/browser/ui/control/loading.js","webpack://vts/./src/browser/ui/control/measure.js","webpack://vts/./src/browser/ui/control/measure-lite.js","webpack://vts/./src/browser/ui/ui.js","webpack://vts/./src/browser/autopilot/autopilot.js","webpack://vts/./src/browser/control-mode/disabled.js","webpack://vts/./src/browser/control-mode/pano.js","webpack://vts/./src/browser/control-mode/control-mode.js","webpack://vts/./src/browser/presenter/presenter.js","webpack://vts/./src/browser/rois/rois.js","webpack://vts/./src/browser/browser.js","webpack://vts/./src/browser/interface.js","webpack://vts/./src/browser/index.js"],"names":["installedModules","__webpack_require__","moduleId","exports","module","i","l","modules","call","m","c","d","name","getter","o","Object","defineProperty","enumerable","get","r","Symbol","toStringTag","value","t","mode","__esModule","ns","create","key","bind","n","object","property","prototype","hasOwnProperty","p","s","vec2","a","b","Array","vec4","x","y","z","vec3","e","g","Math","sqrt","j","dd","f","dx","dy","dz","mat3","mat4","h","k","A","B","u","v","w","C","D","E","q","F","G","sin","cos","tan","PI","frustum","identity","math","utilsUrl","utils","defaultValue","minValue","maxValue","clamp","array","arraySize","minValues","maxValues","defaultValues","isArray","length","width","join","binary","exponent","fraction","NaN","Infinity","pow","str","obj","replace","match","plain","simpleFmtObj","Date","getFullYear","urls","trim","split","indexOf","substring","code","result","exec","parseInt","fn","round","log","LN2","ceil","hash","li","charCodeAt","cb","cr","max","min","abs","getHash","convertRGB2YCbCr","counter","floor","convertHSL2RGB","path","onLoaded","onError","withCredentials","xhrParams","loadJSON","data","DOMParser","parseFromString","skipParse","xhr","XMLHttpRequest","onreadystatechange","readyState","status","console","response","parsedData","JSON","parse","this","open","setRequestHeader","overrideMimeType","send","responseType","abuffer","url","getAllResponseHeaders","onerror","onload","direct","image","Image","crossOrigin","src","getParamsFromUrl","textDecoderUtf8","TextDecoder","unint8ArrayToString","decode","code_points2","Uint8Array","byteLength","set","code_points","Uint32Array","buffer","cp","String","fromCharCode","value2","delta","degrees","radians","left","right","bottom","top","near","far","transpose","fovy","aspect","ymax","xmax","frustumMatrix","vsize","axis","angle","ca","sa","sx","sy","sz","scaleMatrix","tx","ty","tz","translationMatrix","docHost","document","location","hostname","parser","createElement","queryString","vars","pair","arr","push","href","protocol","origin","port","slice","link","originUrl","baseUrl","getBase","baseUrlSchema","getSchema","baseUrlOrigin","getOrigin","platform","initialized","init","self","browser","searchString","dataBrowser","version","searchVersion","navigator","userAgent","toLowerCase","appVersion","OS","dataOS","mobile","mobileAndroid","getBrowser","getBrowserVersion","getOS","isMobile","isAndroid","dataString","string","dataProp","prop","versionSearchString","versionSearch","subString","index","parseFloat","vendor","window","opera","geo","GeographicLib","Constants","Accumulator","WGS84","major","minor","patch","version_string","digits","epsilon","degree","sq","hypot","cbrt","log1p","atanh","copysign","sum","up","vpp","polyval","N","AngRound","remainder","AngNormalize","LatFix","Number","AngDiff","sincosd","sinx","cosx","atan2d","ang","atan2","Set","constructor","_s","_t","Add","Sum","Negate","Remainder","Geodesic","GeodesicLine","PolygonArea","nC3x_","nC4x_","astroid","A1m1f_coeff","C1f_coeff","C1pf_coeff","A2m1f_coeff","C2f_coeff","A3_coeff","C3_coeff","C4_coeff","maxit2_","tol0_","tol1_","tol2_","tolb_","xthresh_","tiny_","MIN_VALUE","nC1_","nC1p_","nC2_","nC3_","nC4_","CAP_C1","CAP_C1p","CAP_C2","CAP_C3","CAP_C4","NONE","ARC","LATITUDE","LONGITUDE","AZIMUTH","DISTANCE","STANDARD","DISTANCE_IN","REDUCEDLENGTH","GEODESICSCALE","AREA","ALL","OUT_ALL","LONG_UNROLL","OUT_MASK","SinCosSeries","sinp","ar","y0","y1","S","r2","r3","disc","T3","T","uv","A1m1f","eps","nA1_","C1f","eps2","C1pf","A2m1f","nA2_","C2f","_f1","_e2","_ep2","_n","_b","_c2","atan","_etol2","isFinite","Error","_A3x","_C3x","_C4x","A3coeff","C3coeff","C4coeff","nA3_","A3f","nA3x_","C3f","mult","C4f","Lengths","sig12","ssig1","csig1","dn1","ssig2","csig2","dn2","cbet1","cbet2","outmask","C1a","C2a","B1","csig12","vals","m0x","J12","A1","A2","s12b","m0","m12b","M12","M21","InverseStart","sbet1","sbet2","lam12","slam12","clam12","sbet12a","shortline","omg12","sbetm2","somg12","comg12","ssig12","lamscale","k2","cbet12a","bet12a","nvals","omg12a","lam12x","sbet12","cbet12","dnm","salp1","calp1","salp2","calp2","Lambda12","slam120","clam120","diffp","C3a","salp0","calp0","somg1","comg1","somg2","comg2","B312","eta","domg12","dlam12","Inverse","lat1","lon1","lat2","lon2","InverseInt","azi1","azi2","lon12","lon12s","lonsign","swapp","latsign","s12x","m12x","meridian","numit","salp1a","calp1a","salp1b","calp1b","tripn","tripb","dv","dalp1","sdalp1","cdalp1","nsalp1","lengthmask","alp12","A4","C4a","B41","B42","dbet1","dbet2","salp12","calp12","sdomg12","cdomg12","a12","s12","m12","S12","GenDirect","arcmode","s12_a12","GenPosition","Direct","ArcDirect","Line","caps","DirectLine","GenDirectLine","ArcDirectLine","GenSetDistance","InverseLine","SetArc","Polygon","polyline","geod","_dn1","_salp0","_calp0","_ssig1","_somg1","_csig1","_comg1","_k2","_A1m1","_C1a","_B11","_stau1","_ctau1","_C1pa","_A2m1","_C2a","_B21","_C3a","_A3c","_B31","_C4a","_A4","_B41","a13","s13","B12","AB1","tau12","B22","AB2","Position","ArcPosition","s13_a13","SetDistance","transit","transitdirect","AreaReduceA","AreaReduceB","area","area0","crossings","reverse","sign","_geod","_area0","_mask","_areasum","_perimetersum","Clear","num","_crossings","_lat0","_lon0","lat","lon","AddPoint","AddEdge","azi","Compute","tempsum","number","perimeter","TestPoint","TestEdge","DMS","lookup","zerofill","internalDecode","numMatch","components_","toUpperCase","substr","DEGREE","MINUTE","SECOND","Decode","dms","end","mi","pi","ind2","pa","pb","dmsa","ind1","charAt","val","ind","beg","ipieces","fpieces","npiece","icurrent","fcurrent","ncurrent","pointseen","digcount","intcount","errormsg","p0","p1","POSITIVE_INFINITY","DecodeLatLon","stra","strb","longfirst","valsa","valsb","ia","ib","DecodeAngle","angstr","DecodeAzimuth","azistr","Encode","trailing","prec","idegree","fdegree","pieces","ip","fp","scale","toFixed","SEC_TO_RAD","HALF_PI","EPSLN","EPSILON","D2R","R2D","FORTPI","TWO_PI","SPI","ft","to_meter","ignoredChar","testkey","keys","lkey","paramName","paramVal","paramOutname","paramObj","defData","map","filter","reduce","params","proj","datum","rf","lat_0","lat0","lat_1","lat_2","lat_ts","lon_0","long0","lon_1","long1","lon_2","long2","alpha","lonc","longc","x_0","x0","y_0","k_0","k0","r_a","R_A","zone","south","utmSouth","towgs84","datum_params","units","unit","from_greenwich","pm","nadgrids","datumCode","txt","Parser","output","whitespace","latin","keyword","endThings","digets","text","level","place","root","stack","currentObject","state","mapit","unshift","thing","out","newObj","item","sExpr","shift","convert","readCharicter","char","test","neutral","quoted","afterquote","word","afterItem","pop","newObjects","d2r","input","lisp","wkt","type","projName","local","PROJECTION","AXIS","axisOrder","ii","descriptor","UNIT","DATUM","SPHEROID","geogcs","GEOGCS","toMeter","sphere","ellps","TOWGS84","forEach","outName","inName","cleanWKT","defs","that","arguments","def","apply","EPSG","ESRI","IAU2000","GOOGLE","global","codeWords","testObj","testDef","some","testWKT","testProj","destination","source","undefined","con","eccent","sinphi","cosphi","com","phi","dphi","eccnth","ts","pt","projs","es","msfnz","forward","adjust_lon","tsfnz","inverse","exp","phi2z","names","projStore","add","len","start","ellipseName","wgs84","ellipse","datumName","ch1903","ggrs87","nad83","nad27","potsdam","carthage","hermannskogel","ire65","rassadiran","nzgd49","osgb36","s_jtsk","beduaram","gunung_segara","rnb72","ep2","datum_type","Projection","srsCode","callback","error","json","parseCode","ourProj","projections","datumDef","a2","b2","sphere_","ecc","datumObj","extend","Proj","geodeticToGeocentric","Rn","Sin_Lat","Sin2_Lat","Cos_Lat","Longitude","Latitude","Height","geocentricToGeodetic","P","RR","CT","ST","RX","RK","RN","CPHI0","SPHI0","CPHI","SPHI","SDPHI","iter","X","Y","Z","checkParams","dest","compareDatums","point","Dx_BF","Dy_BF","Dz_BF","Rx_BF","Ry_BF","Rz_BF","M_BF","geocentricToWgs84","x_tmp","y_tmp","z_tmp","geocentricFromWgs84","xin","yin","zin","denorm","crs","transform","toPoint","checkNotWGS","adjust_axis","isGeocent","datum_transform","transformer","from","to","coords","transformedArray","checkProj","oProj","fromProj","toProj","coord","retProj","single","info","I","O","mgrs","bbox","UTMtoLL","ll","accuracy","utm","seasting","easting","snorthing","northing","zoneNumber","zoneLetter","setParm","get100kSetForZone","setColumn","setRow","column","row","parm","colOrigin","rowOrigin","colInt","rowInt","rollover","encode","M","LongOriginRad","ZoneNumber","Lat","Long","LatRad","degToRad","LongRad","UTMEasting","UTMNorthing","getLetterDesignator","LLtoUTM","deg","radToDeg","rad","N1","T1","C1","R1","LongOrigin","mu","phi1Rad","e1","topRight","LetterDesignator","mgrsString","testChar","hunK","sb","east100k","curCol","eastingValue","rewindMarker","getEastingFromChar","north100k","curRow","northingValue","getNorthingFromChar","getMinNorthing","accuracyBonus","sepEastingString","sepNorthingString","sep","sepEasting","sepNorthing","Point","warn","fromMGRS","mgrsStr","toMGRS","C08","en","cphi","sphi","arg","pj_mlfn","pj_enfn","ml0","delta_lon","sin_phi","cos_phi","al","als","cs","tq","ml","acos","pj_inv_mlfn","tan_phi","ds","temp","asin","log1py","cos_2B","pp","h1","h2","hr2","hi2","sin_arg_r","arg_r","cos_arg_r","sinh_arg_i","sinh","arg_i","cosh_arg_i","cosh","hr","hi1","hr1","hi","cgb","cbg","utg","gtu","np","Qn","gatg","Zb","clens","Ce","Cn","sin_Cn","cos_Cn","sin_Ce","cos_Ce","asinhy","tmp","clens_cmplx","adjust_zone","etmerc","dependsOn","esinp","rc","phic0","ratexp","K","srat","gauss","sinc0","cosc0","R2","title","sinc","cosc","cosl","rho","coslat0","sinlat0","isNaN","cons","ms1","X0","ssfn_","cosX0","sinX0","sinX","cosX","rh","sinlat","coslat","dlon","ce","Chi","phit","eccen","phy0","lambda0","sinPhy0","semiMajorAxis","flattening","e2","R","b0","k1","k3","Sa1","Sa2","rotI","rotB","lambda","phy","prevPhy","iteration","no_off","no_rot","bl","fl","gl","t0","dl","t1","t2","el","hl","jl","pl","dlon12","dlon10","gamma0","uc","us","vs","ql","sl","tl","vl","ul","qp","sp","tp","vp","sin1","cos1","ts1","sin2","cos2","ms2","ts2","ts0","f0","rh1","theta","s45","s90","fi0","alfa","uq","u0","n0","s0","ro0","ad","gfi","deltav","ro","czech","fi1","ok","e0","e3","e0fn","e1fn","e2fn","e3fn","mlfn","lam","nl","gN","asq","cl","ml1","phi1","imlfn","nl1","rl1","tl1","dsq","adjust_lat","S_POLE","N_POLE","EQUIT","OBLIQ","qsfnz","mmf","apa","APA","authset","rq","xmf","ymf","sinb1","cosb1","sinph0","cosph0","coslam","sinlam","sinb","cosb","phi0","cCe","sCe","ab","beta","cosz","sinz","sin_po","cos_po","qs1","qs2","t3","qs0","ns0","qs","phi1z","asinz","eccnts","sin_p14","cos_p14","infinity_dist","coslon","iqsfnz","dlat","tanphi","mln","mlnp","ma","B_re","B_im","C_re","C_im","delta_lat","d_phi","d_lambda","d_phi_n","d_psi","th_n_im1","th_re","th_im","th_n_re","th_n_im","z_re","z_im","z_n_im1","delta_x","z_n_re","z_n_im","iterations","num_re","num_im","den_re","den_im","den2","d_psi_n","C_y","C_x","V","delta_theta","ml2","sinth","costh","gsq","msq","xx","yy","xys","c1","c2","c3","a1","m1","th1","sin_p12","cos_p12","Mlp","Ml","Nl1","Nl","psi","Az","H","GH","Hs","kp","cos_c","s2","s3","s4","cosAz","Ee","FACE_ENUM","AREA_ENUM","qsc_fwd_equat_face_theta","qsc_shift_lon_origin","offset","slon","face","one_minus_f","one_minus_f_squared","xy","sinlon","nu","cosmu","tannu","tantheta","invert_sign","xa","lp","defaultDatum","tmerc","proj4","sterea","stere","somerc","omerc","lcc","krovak","cass","laea","aea","gnom","cea","eqc","poly","nzmg","mill","sinu","moll","eqdc","vandg","aeqd","ortho","geocent","qsc","MapView","fixPaths","freeLayers","surfaces","options","stringify","layer","processUrl","fallback","getInfo","view","renderer","getSuperElevationState","se","getSuperElevation","GpuTexture","gpu","core","fileSize","repeat","keepImage","texture","framebuffer","size","height","loaded","trilinear","load","kill","deleteTexture","getSize","createFromData","lx","ly","createTexture","bindTexture","TEXTURE_2D","REPEAT","CLAMP_TO_EDGE","texParameteri","TEXTURE_WRAP_S","TEXTURE_WRAP_T","mipmaps","TEXTURE_MIN_FILTER","LINEAR","TEXTURE_MAG_FILTER","LINEAR_MIPMAP_LINEAR","NEAREST","pixelStorei","UNPACK_ALIGNMENT","texImage2D","RGBA","UNSIGNED_BYTE","generateMipmap","createFromImage","aniso","naturalWidth","naturalHeight","isPowerOfTwo","nearestPowerOfTwo","canvas","getContext","drawImage","anisoLevel","texParameterf","anisoExt","TEXTURE_MAX_ANISOTROPY_EXT","noTextures","loadImage","killed","markDirty","createFramebufferFromData","createFramebuffer","bindFramebuffer","FRAMEBUFFER","renderbuffer","createRenderbuffer","bindRenderbuffer","RENDERBUFFER","renderbufferStorage","DEPTH_COMPONENT16","framebufferTexture2D","COLOR_ATTACHMENT0","framebufferRenderbuffer","DEPTH_ATTACHMENT","readFramebufferPixels","fastMode","setFramebuffer","readPixels","tileBorderTable","tileCornerTable","MapSurfaceTile","parent","id","viewCounter","drawCounter","childrenReadyCount","renderReady","geodataCounter","gridRenderCounter","texelSize","texelSize2","distance","tiltAngle","seCounter","metanode","lastMetanode","boundmetaresources","surface","surfaceMesh","surfaceGeodata","surfaceGeodataView","surfaceTextures","resourceSurface","virtual","virtualReady","virtualSurfaces","resetDrawCommands","drawCommands","bounds","boundLayers","boundTextures","updateBounds","hmap","heightMap","imageryCredits","glueImageryCredits","mapdataCredits","resources","resourcesTree","findNode","metaresources","findAgregatedNode","boundresources","children","lastSurface","lastState","lastRenderState","verifyChildren","removeChild","validate","getMetatile","viewSwitched","config","mapSoftViewSwitch","border","border2","border3","borderNodes","borderReady","gridPoints","sequence","transparent","viewCoutner","transparentBounds","virtualSurfacesUncomplete","restoreLastState","lastResourceSurface","addChild","childId","removeChildByIndex","tile","isMetanodeReady","tree","priority","preventLoad","checkSurface","checkMetanode","metatile","used","getSurface","sourceReference","node","useSuperElevation","minZ","getSuperElevatedHeight","minZ2","maxZ","maxZ2","generateCullingHelpers","freeLayerSurface","surfaceSequence","alien","hasTile2","isReady","getNode","hasChildById","isVirtualMetanodeReady","createVirtualMetanode","hasChild","readyCount","glue","hasGeometry","internalTextureCount","desiredSurfaceIndex","viewSurfaceIndex","jump","clone","flags","useVersion","bboxVisible","cameraPos","camera","measure","minDivisionNodeDepth","mapDisableCulling","p2","diskPos","position","rayVec","normalize4","distanceFactor","dot","diskNormal","diskAngle","pointsVisible","bbox2","insideCone","coneVec","diskAngle2A","getPixelSize","screenPixelSize","worldPos","returnDistance","tilePos1x","tilePos1y","tilePos2x","tilePos2y","tilePos3x","tilePos3y","tilePos4x","tilePos4y","factor","scaleFactor","getPixelSize3Old","geocentDistance","diskDistance","geocentNormal","diskAngle2","l1","scaleFactor2","getPixelSize3","d2","cameraDistance","updateTexelSize","pixelSize","draw","texelSizeFit","preciseDistance","mapPreciseDistanceTest","usedTexelSize","ndcToScreenPixel","usedDisplaySize","maxSize","displaySize","getViewHeight","planetRadius","vector","mapDegradeHorizon","degradeHorizonFactor","degradeHorizon","mapDegradeHorizonParams","degradeFadeStart","degradeFadeEnd","degradeFactor","degradeHorizonTiltFactor","observerDistance","perceivedDistance","distanceFade","drawGrid","divNode","onlySetBorderData","subdiv","hasChildren","ur","res","gridSkipped","getSpatialDivisionNodeAndExtents","middle","hasPoles","referenceFrame","isPole","nodeExtent","extents","viewExtent","lod","log2","prog","planeBuffer","flatGrid","gridFlat","joinGrids","gridGlues","useSurrogatez","mapGridSurrogatez","surrogatez","n1","getPhysicalCoords","n2","n3","n4","mtop","mbottom","mleft","mright","mnode","borderTable","skip","getNodeById","cornerTable","nodeTable","getRenderedNodeById","lowestNode","bcoords","llx","lly","urx","ury","getGridHeight","mv","getModelviewMatrix","getProjectionMatrix","poleRadius","poleRadiusFactor","useTexture","mapGridTextureLayer","gridTexture","sourceTile","lodRange","sourceLod","mapGridTextureLevel","getTexture","hitmapRender","onlyDepth","progPlane2D","progPlane2","useProgram","setVec4","progPlane","progPlane3D","progPlane3","setFloatArray","setVec3","setMat4","step1","gridStep1","px","py","getGpuTexture","fogDensity","gridStep2","tt","getTransform","heightmapTexture","gridBlend","atmoColor","planeMesh","stats","drawnFaces","polygons","drawHmapTile","pipeline","progHmapPlane","initProceduralShaders","testMode","debug","drawTestMode","progHmapPlane2","progHmapPlane5","progHmapPlane6","progHmapPlane7","progHmapPlane4","progHmapPlane3","progHmapPlane8","ntextures","vecRight","vecTop","normalize","vecDir","mv2","modelview","vts","toInverseMat3","multiplyVec3","space","setMat3","extraBound","minHeight","maxHeight","drawTestData","setSampler","planeMesh2","MapSurfaceTree","freeLayer","rootId","metaBinaryOrder","surfaceTree","surfaceOnlySequence","metastorageTree","surfaceTracer","heightTracer","findSurfaceTile","mask","findNavTile","hasNavtile","navtile","storeTilesOnly","periodicity","getPhysicalSrs","geodata","drawChannel","drawSurface","period","mapGeodataLoadMode","mapLoadMode","mapSplitMeshes","drawSurfaceWithSpliting","drawSurfaceDownTop","drawSurfaceFit","drawSurfaceFitOnly","updateNodeHeightExtents","heightReady","parentNode","logTileInfo","visible","typeFactor","drawTiles","drawBuffer","processBuffer","newProcessBuffer","processBuffer2","drawBufferIndex","processBufferIndex","newProcessBufferIndex","gpuNeeded","replay","storeNodes","storeFreeNodes","storeNodesBuffer","nodeBuffer","lj","pocessedNodes","pocessedMetatiles","usedNodes","best","getDrawCommandsGpuSize","childrenCount","childrenBuffer","child","drawSurfaceTile","sorted","storeDrawBufferGeometry","bestMeshTexelSize","processedNodes","processedMetatiles","processDrawBuffer","splitMask","visibleCounter","skipRenderCounter","useMask","useDrawBufferOnly","nodesReadyCount","drawBuffer2","maxLod","free","mapHeightfiledWhenUnloaded","lodShift","parent2","children2","maxHiresLodLevels","mapMaxHiresLodLevels","grids","pack","depth","lastProcessBufferIndex","lastDrawBufferIndex","tilesToLoad","hit","drawBufferIndex2","findLoadedParent","hasLoadedParent","noGrid","storeTiles","storeFreeTiles","tileBuffer","tiles","camVec","tilt","scanExtents","mapFeatureStickMode","hmax","hmin","getMvpMatrix","gpuCache","skipCostCheck","underSurfaceGrid","mapGridUnderSurface","clear","cameraPosition","fovDist","gpuRenderUsed","maxGpuUsed","drawBBoxes","drawTileInfo","gridHmax","gridHmin","checkCost","storeGeometry","storedTilesRes","mesh","submeshes","submesh","vertices","lk","traceHeight","nodeOnly","heightFunction","traceHeightTileByNodeOnly","traceHeightTileByMap","traceHeightTile","nodeReadyOnly","childIndex","traceHeightChild","finalNode","waitingForNode","center","desiredLod","bestHeightMap","heightMapExtents","getNavUrl","chekTileMesh","loadMeshes","loadTextures","mapNoTextures","traceAreaTiles","coneAngle","limit","areaTiles","MapSubtexture","internal","imageData","imageExtents","gpuTexture","loadState","loadErrorTime","loadErrorCounter","neverReady","mapLoaderUrl","statsCounter","checkStatus","checkType","checkValue","fastHeaderCheck","gpuSize","cacheItem","gpuCacheItem","killImage","killGpuTexture","killedByCache","resourcesCache","remove","gpuTextures","graphsFluxTexture","doNotLoad","doNotCheckGpu","doNotUseGpu","scheduleHeadRequest","mapLoadErrorMaxRetryCount","performance","now","mapLoadErrorRetryTime","extraInfo","setBoundTexture","updateItem","buildHeightMap","renderBuild","buildGpuTexture","scheduleLoad","header","loader","onLoad","mapLoaderCallLoaded","mapLoaderCallError","onLoadError","mapXhrImageLoad","processLoadBinary","onBinaryLoaded","tokenCookieHost","killBlob","URL","revokeObjectURL","setTimeout","filesize","onHeadLoaded","mapAsyncImageDecode","createImageBitmap","then","createObjectURL","bitmap","insert","downloadAll","onLoadHead","onLoadHeadError","headRequest","useCredentials","mapCheckTextureSize","ctx","getImageData","getHeightMapValue","MapTexture","mainTexture","getSubtexture","maskTexture","availability","mime","codes","getHMapUrl","getUrl","getTileTextureTransform","ready","checkMask","getMaskTexture","metaPath","getMetatileUrl","getMaskUrl","maskState","isMaskPosible","isMaskInfoReady","getGpuMaskTexture","getGpuSize","getImageExtents","BBox","xmin","ymin","zmin","zmax","NEGATIVE_INFINITY","updateMaxSize","side","vec","translateXY","MapMetanode","stream","divisionNode","credits","parseMetanode","ix","iy","parseExtentBits","extentBytes","extentBits","bitIndex","streamData","getUint8","extentsSize","extentsBytes","metanodeBuffer","minExtents","maxExtents","spaceExtentSize","spaceExtentOffset","extentsBytesSum","getFloat32","decodeFloat16","getUint16","getInt16","plane","mapPreciseCulling","pos","tmpVec3","maxDivisionNodeDepth","pos2","tmpVec5","getSpatialDivisionNodeFromId","getSpatialDivisionNodeAndExtents2","getPhysicalCoordsFast","normal","d1","d3","d4","maxDelta","mapPreciseBBoxTest","normalize2","mpos","maxX","minX","maxY","minY","normalize3","dot2","expand","getWorldMatrix","geoPos","matrix","multiply","drawBBox","drawBBox2","progBBox","mvp","bboxMesh","bboxBuffer","camPos","progBBox2","bboxMesh2","drawPlane","points","altitude","gridSelect","blend","dataWidth","fx","fy","index2","ix2","h00","h01","h10","w0","MapMetatile","nodes","metatileCache","removeMetatile","metatileIdx","metatileIdy","offsetx","offsety","sizex","sizey","nodeSize","creditCount","flagPlanes","metanodesIndex","metanodeSize","applyMetanodeCredits","applyMetatanodeBitplanes","getMetaUrl","task","addProcessingTask","DataView","parseMetatatile","magic","getUint32","parseFlagPlanes","parseMetatatileCredits","parseMetatatileNodes","mapForceMetatileV3","bitplaneSize","bitplane","creditSize","bitfieldSize","creditId","bitfield","credit","getCreditByNumber","stringId","creditMask","applyMetatatileBitplanes","byteIndex","bitMask","applyMetatatileCredits","GpuMesh","meshData","use16bit","verticesUnnormalized","vertexBuffer","uvBuffer","uv2Buffer","uvs","uvs2","indices","vertexSize","uvSize","uv2Size","createBuffer","bindBuffer","ARRAY_BUFFER","bufferData","Float32Array","STATIC_DRAW","itemSize","numItems","indexBuffer","ELEMENT_ARRAY_BUFFER","Uint16Array","varSize","valid","deleteBuffer","program","attrVertex","attrUV","attrUV2","attrBarycenteric","skipDraw","vertexAttribute","getAttribute","vertexAttribPointer","UNSIGNED_SHORT","uvAttribute","uv2Attribute","FLOAT","barycentericAttribute","barycentricBuffer","drawElements","TRIANGLES","drawArrays","getBBox","getPolygons","MapSubmesh","generateLines","internalUVs","externalUVs","faces","uvArea","uvAreaComputed","flagsInternalTexcoords","flagsExternalTexcoords","flagsPerVertexUndulation","flagsTextureMode","parseSubmesh","parseHeader","parseVerticesAndFaces2","parseVerticesAndFaces","surfaceReference","textureLayer","textureLayer2","bboxMin","bboxMax","getFloat64","uint8Data","numVertices","onlyOneUVs","mapOnlyOneUVs","uvfactor","vindex","uvindex","tmpVertices","tmpExternalUVs","numUVs","tmpInternalUVs","numFaces","onlyExternalIndices","mapIndexBuffers","onlyInternalIndices","onlyIndices","v1","v2","v3","vv1","vv2","vv3","sindex","vtmp","eUVs","iUVs","parseWord","parseDelta","quant","multiplier","cx","cy","cz","mx","my","mz","quantU","quantV","multiplierU","multiplierV","high","getFileSize","buildGpuMesh","computeUVArea","faceArea","i1","i2","i3","l2","l3","getWorldMatrixSE","GpuProgram","vertex","fragment","variants","uniformLocationCache","attributeLocationCache","createProgram","programs","createShader","vertexShader","shader","FRAGMENT_SHADER","VERTEX_SHADER","shaderSource","compileShader","getShaderParameter","COMPILE_STATUS","getShaderInfoLog","callListener","fragmentShader","attachShader","linkProgram","getProgramParameter","LINK_STATUS","getUniform","uniform1i","zoffset","m3","uniformMatrix4fv","uniformMatrix3fv","setVec2","uniform2fv","uniform3fv","uniform4fv","setFloat","uniform1f","uniform1fv","getAttribLocation","getUniformLocation","GpuShaders","planeVertexShader","quadPoint","planeFragmentShader","getHFNormal","getHFNormal2","planeVertex4Shader","planeFragmentShader2","tileVertexShader","tileFragmentShader","shadedMeshVertexShader","shadedMeshFragmentShader","tileWireFrameBasicShader","imageVertexShader","imageFragmentShader","MapMesh","map16bitMeshes","mBuffer","mBuffer2","vBuffer","gpuSubmeshes","submeshesKilled","killSubmeshes","killGpuSubmeshes","gpuMeshes","graphsFluxMesh","buildGpuSubmeshes","makeUrl","meshUrl","parseWorkerData","parseMapMesh","meanUndulation","numSubmeshes","submeshData","addSubmesh","generateTileShader","progs","mapSplitMargin","drawSubmesh","splitSpace","gpuSubmesh","gpuMask","texcoordsAttr","texcoords2Attr","drawWireframe","attributes","meshStats","meshesUVArea","meshesFaces","progDepthTile","progFlatShadeTile","progTile","flatShade","progTile2","progTile3","shaderFilters","shaderFilter","varFlatShade","progMap","pixelShader","variations","progFogTile","statsCoutner","superElevation","earthRadius","earthERatio","getModelviewFMatrix","getProjectionFMatrix","zbufferOffset","getZoffsetFactor","bmin","bmax","cv","vector2","zFactor","progWireFrameBasic","LINE_LOOP","drawCalls","MapGeodataGeometry","geometryBuffer","indicesBuffer","borders","getType","getElement","getElements","pathIndex","si","ei","getRelationToCanvasPoint","screenX","screenY","sc","tc","getScreenRay","cross","dP","getPathElement","getPathPoint","totalLength","getPathNED","withoutSlope","vv","nn","nomalize","getPathLengthToElement","elementIndex","getPathLength","getPathsCount","getSurfaceArea","surfaceArea","p3","MapGeodataImportGeoJSON","builder","heightMode","srs","groupIdPrefix","dontCreateGroups","tesselation","processGeometry","geometry","feature","addPoint","addPointArray","addLineString","addLineStringArray","addPolygon","coords2","geometries","processFeature","processCollection","features","processJSON","addGroup","MapGeodataImportVTSGeodata","newPoints","groups","group","resolution","fz","pointsFeatures","subpoints","newSubpoints","linesFeatures","line","sublines","newSublines","polygonsFeatures","pz","polygon","addPolygonRAW","MapGeodataImport3DTiles","navSrs","getNavigationSrs","physSrs","rootPath","filesToLoad","processNode","builderNode","onlyChildren","volume","boundingVolume","convertCoordsFrom","radius","halfAxis","precision","addNode","content","getProcessUrl","addMesh","onFinished","baseOptions","makeAbsolute","MapGeodataBuilder","currentGroup","heightsToProcess","heightsProcessBuffer","heightsProcessBufferFirst","heightsProcessBufferLast","heightsLod","heightsSource","updateCallback","processingHeights","processHeightsCalls","addToHeightsBuffer","prev","next","removeFromHeightsBuffer","lines","tileset","meshes","properties","directCopy","floatHeights","floatHeight","featurePoints","linePoints","subline","featureLines","totalHeights","shape","holes","addPolygon3","getPolygonCenter","projected","sumX","sumY","sumZ","avgX","avgY","avgZ","insidePolygon","verticesLength","inside","xi","yi","xj","yj","srsProj4","hole","holesIndices","flatShape","maxDistance","trueHolesCount","totalPoints","north","east","dir","ned","getNewNED","direction","gcenter","x1","x2","y2","vertices2","flatShape2","p4","p5","p6","earcut","maxFaceLength","borders2","sbuffer","sbuffer2","sbuffer3","sbufferIndex","sbufferIndex2","sbufferIndex3","vbuffer","lastMaxFaceLength","edge1","edge2","edge3","mm","ebuffer","ebufferIndex","unrollBorder","borderArray","lo","lastEbufferIndex","featureVertices","featureSurface","featureBorders","importVTSGeodata","importGeoJson","import3DTiles","load3DTiles","processHeights","onProcessed","lastItem","noSource","getOptimalHeightLodBySampleSize","getSpatialDivisionNode","getSurfaceHeight","on","extractGeometry","groupPoints","groupLines","groupPolygons","Float64Array","compileGroup","finalFeature","geodataGroup","bboxScaleFactor","finalPoints","finalLines","finalVertices","finalBorders","makeGeodata","makeFreeLayer","style","MapGeodata","killGeodata","mapGeodataBinaryLoad","MapResourceNode","metatiles","textures","subtextures","getMesh","getGeodata","addMetatile","allowCreation","MapResourceTree","createNonexisted","agregation","MapSrs","comment","srsDef","srsModifiers","vdatum","parsePeriodicity","srsInfo","geoidGrid","geoidGridMap","latlonProj4","proj4Cache","geoidGridData","definition","srsDefEllps","valueRange","spheroid","periodicityData","getSrsInfo","isGeoidGridReady","isProjected","getOriginalHeight","getVerticalAdjustmentFactor","getGeoidGridDelta","getFinalHeight","mapCoords","imageExtens","latlonProj","convertCoordsTo","skipVerticalAdjust","stringSrs","srsDef2","convertCoordsToFast","coords3","HALFPI","convertMercToWGS","TWOPI","convertWGSToGeocent","SinLat","Sin2Lat","CosLat","MapCache","maxCost","MAX_VALUE","last","first","totalCost","totalItems","getMaxCost","setMaxCost","cost","destructor","addItem","removeItem","itemUsed","MapCamera","distance2","terrainHeight","lastTerrainHeight","update","check","getHeight","getOptimalHeightLod","getCoords","getViewExtent","mapNavSamplesPerViewExtent","surfaceHeight","heightTerrain","heightDelta","getHeightMode","camInfo","getPositionCameraInfo","setPosition","orbitCoords","setRotationMatrix","rotMatrix","orbitHeight","getViewDistance","getFar","getFov","setViewHeight","convertCoords","mapIsProjected","setParams","getCameraHeight","cameraHeight","getRotationMatrix","getRotationviewMatrix","getAspect","MapCredit","notice","copyrighted","html","simpleWikiLinks","MapBoundLayer","currentAlpha","tileSize","tileRange","jsonUrl","dataType","parseJson","refreshView","numberId","metaUrl","maskUrl","isTransparent","creditsUrl","specificity","addCredit","setOptions","getOptions","hasTile","hasTileOrInfluence","skipBaseUrl","MapDivisionNode","heightRange","partitioning","getMapsSrs","getInnerCoords","getOuterCoords","getExtents","MapRefFrame","description","nodesMap","model","physicalSrs","navigationSrs","publicSrs","body","getBody","navDelta","division","rootLod","arity","parseSpaceExtents","divisionNodes","parseNode","getGlobalHeightRange","nodeData","parseExtents","nodeId","extentsData","getSpatialDivisionNodes","sourceSrs","destinationSrs","MapBody","class","atmosphere","MapStylesheet","fonts","fontsReady","setFonts","setData","checkFonts","getFont","mapDefaultFont","MapSurface","navUrl","textureUrl","boundLayerSequence","geodataProcessor","geodataNavtileInfo","monoGeodata","monoGeodataView","monoGeodataCounter","creditsNumbers","surfaceCounter","stylesheet","originalStyle","originalStylesheet","styleChanged","hmapUrl","mapForcePipeline","geodataUrl","getCreditById","setStyle","above","hasMetatile","toString","getStylesheet","addStylesheet","getSurfaceReference","getMeshUrl","getTextureUrl","subId","getGeodataUrl","navtileStr","getMonoGeodataUrl","MapVirtualSurface","mappingUrl","strId","sort","loadBinary","onMappingFileLoaded","onMappingFileLoadError","parseMappingFile","count","getGlue","MapConfig","mapConfig","parseConfig","parseSrses","parseBodies","parseReferenceFrame","parseCredits","parseStylesheets","parseSurfaces","parseGlues","parseVirtualSurfaces","parseBoundLayers","parseFreeLayers","parseViews","parseParams","parseBrowserOptions","loadedCount","loadErrorCount","loadFirst","loadLast","afterConfigParsed","setView","initialView","srses","addSrs","bodies","addBody","addSurface","mapVirtualSurfaces","views","namedViews","addNamedView","glues","addGlue","layers","addBoundLayer","addFreeLayer","styles","stylesheets","browserOptions","cloneConfig","MapConvert","movePositionCoordsTo","azimuth","azimuthCorrectionFactor","yaw","setCoords2","getGeodesic","orientation","getOrientation","setOrientation","convertPositionViewMode","covertToFloat","convertPositionHeightMode","pich","setCoords","getPositionCameraCoords","noPrecisionCheck","rotationMatrix","getViewMode","getPositionNavCoordsFromPublic","getPositionPublicCoords","getPositionPhysCoords","includeSE","getPositionCameraSpaceCoords","getPositionCanvasCoords","physical","containsSE","transformPointBySE","project2","transformPhysCoordsBySE","convertCoordsFromPhysToNav","getUnsuperElevatedHeight","getGeodesicLinePoints","density","minStep","navigationSrsInfo","MapMeasure","getPublicSrs","getSpatialDivisionNodeDepths","getSurfaceAreaGeometry","reurn","storeStats","nodeCoords","coordsArray","useNodeOnly","mapHeightLodBlend","mapIgnoreNavtiles","getSurfaceHeightNodeOnly","heightClass","heightLod","heightNode","arrayRes","height1","height2","getHeightmapValue","nodeCoords2","statsLod","deltaSample","mapHeightNodeBlend","res1","res2","res3","res4","center2","dataExtents","mapExtents","bestNode","bestLod","bestCoords","bestNodeCoords","nx","ny","minLod","desiredSamplesSize","nodeLod","desiredSamplesPerViewExtent","getDistance","includingHeight","usePublic","getAzimuthCorrection","ret","getNED","upCoords","rightCoords","centerCoords","geodesic","returnMatrix","clampTilt","orbitPos","spaceMatrix","east2","north2","direction2","roty","tmpMatrix","localRotMatrix","latlonMatrix","GpuGroup","jobs","reduced","subjob","loadMode","geFactor","geNormalized","drawLineString","color","depthOffset","screenSpace","depthTest","writeDepth","useState","job","vertexPositionBuffer","vertexElementBuffer","vertexNormalBuffer","vertexTexcoordBuffer","vertexOriginBuffer","globalGeometry","getZbufferOffset","addGeometry","convertColor","addLineJob","progLine","zIndex","clickEvent","hoverEvent","enterEvent","leaveEvent","advancedHit","hitable","eventInfo","stencil","culling","lineWidth","program2","progELine","elements","elementBuffer","addExtentedLineJob","normals","normalBuffer","widthByRatio","getBitmap","background","progTBLine","progTLine","progRLine","progLine3","progTPBLine","progTPLine","progETLine","progERLine","progELine3","progETPLine","processReduce","drawnGeodataTilesUsed","mapFeaturesReduceFactor","addLineLabelJob","singleBuffer","singleBuffer2","texcoords","texcoordsBuffer","progText","color2","outline","visibility","labelPoints","labelIndex","labelSize","hysteresis","noOverlap","labelPointsBuffer","points2","files","progText2","textVector","addIconJob","label","origins","originBuffer","progIcon","stick","icon","gamma","progIcon2","subjobs","vsjobs","addPack","o2","addVSPoint","vswitch","vsjob","storeVSJobs","addVSwitch","addMeshJob","stmp","texturePath","copyBuffer","addRenderJob2","currentNode","rootNode","oldJobs","addRenderJob","nodeBegin","nodeEnd","getNodeLOD","getNodeTexelSize","normalizeGE","ge","getLinePointParametricDist","getOctant","setDivisionSpace","octant","volume2","xf","yf","zf","xv","yv","zv","traverseNode","isready","skipRender","curSize","isNodeReady","drawNode","splitLods","mapSplitLods","priority2","node2","goodLod","skipChildRender","skipGpu","isMeshReady","drawNodeVolume","noSkip","drawnNodes","drawNBBoxes","drawSpaceBBox","getRendererInterface","getCanvasCoords","drawLods","drawText","getTextSize","drawDistance","drawFaceCount","drawResources","drawSurfaces","parts","drawTextureSize","drawMesh","applyOrigin","layerGroupVisible","renderCounter","geoRenderCounter","mapSplitSpace","mvp2","jobZBuffer","jobZBufferSize","onlyHitable","jobZBuffer2","jobZBuffer2Size","onlyHitLayers","MapGeodataProcessor","listener","busy","waitingForStylesheet","processCounter","worker","processWorker","event","message","filename","lineno","onmessage","onMessage","postMessage","terminate","command","bitmaps","messages","setListener","sendCommand","dpr","setStylesheet","fontsOnly","ppi","devicePixelRatio","mapFeaturesReduceParams","isDef","rmode","mapFeaturesReduceMode","mapFeaturesSortByTop","mapFeaturesReduceFactor2","mapFeaturesReduceFactor3","mapMetricUnits","mapLanguage","mapLogGeodataStyles","fontMap","fontUrl","font","setFont","MapGeodataView","gpuGroups","currentGpuGroup","processor","onGeodataProcessorMessage","geodataProcessors","processing","killGeodataView","gpuGeodata","graphsFluxGeodata","processPackedCommands","maxIndex","maxTime","mapMaxGeodataProcessingTime","addProcessingTask2","cameraTiltFator","mtmp","MapDrawTiles","preventRedener","drawGeodataOnly","heightmapOnly","renderedLods","drawnTiles","drawnGeodataTilesPerLayer","drawnGeodataTilesFactor","drawnGeodataTiles","drawGeodataTile","drawMeshTile","channel","processDrawCommands","applyCredits","areDrawCommandsReady","boundsDebug","surface2","drawMeshBBox","updateTileBounds","material","drawBlendedTileState","drawTileState","layerId","getBoundLayerByNumber","updateTileHmap","commands","encodeURIComponent","geodataView","sourceTexture","submeshSurface","updateTileSurfaceBounds","getParentTile","targetTile","bound","fullUpdate","sequenceFullAndOpaque","sequenceMaskPosible","fullAndOpaqueCounter","maskPosible","skipOther","fullAndOpaque","newSequence","getBoundLayerById","debugTextSize","drawIndices","drawPositions","drawGPixelSize","drawOrder","drawTileCounter","drawSurfaces2","getHashColor2","drawBoundLayers","drawCredits","drawNodeInfo","MapDraw","blendHeightmap","drawTexelSize","drawMaxLod","drawLayers","drawLabelBoxes","drawAllLabels","drawHiddenLabels","drawEarth","drawGridCells","drawPolyWires","drawFog","mapFog","ignoreTexelSize","maxZoom","atmoColor2","atmoHeight","atmoHeightFactor","atmoDensity","zFactor2","zShift","zLastShift","bestGeodataTexelSize","log8","geodataTilesPerLayer","drawChannelNames","createState","drawStardomeState","zwrite","ztest","zequal","drawAuraState","drawAtmoState","drawAtmoState2","drawnFreeTiles","tracedNodes","tracedFreeNodes","storeLoaded","mapStoreLoadStats","drawGlobe","drawNodes","drawFreeTiles","drawFreeNodes","drawLoaded","singleLod","loadedIndex","singleLodedIndex","drawMap","skipFreeLayers","setViewport","visibleCredits","imagery","glueImagery","mapdata","mapGridMode","debugStr","dirty","mapHack","benevolentMargins","mapBenevolentMargins","mapForceFrameTime","frameTime","hoverFeatureCounter","hoverFeatureList","hoverFeature","cameraOrientation","cameraVector","cameraViewExtent","cameraViewExtent2","fmaxDist","fminDist","labelVector","tiltFactor","localViewExtentFactor","setState","setupDetailDegradation","setChannel","updateFogDensity","updateGridFactors","freeLayersHaveGeodata","clearJobBuffer","singleIndex","file","drawGpuJobs","freeLayerSequence","drawMonoliticGeodata","progAtmo","progAtmo2","earthRadius2","atmoSize","params2","params3","getPosition","heightFactor","mix","drawBall","drawToTexture","switchToFramebuffer","renderSlots","processRenderSlots","drawHitmap","hitmapMode","copyHitmap","hitMapDirty","drawGeodataHitmap","advancedPassNeeded","geoHitMapDirty","checkGpu","textureReady","meshReady","cameraVisibility","degradeMore","mapMobileDetailDegradation","mapTexelSizeFit","MapLoader","maxThreads","usedThreads","maxPending","fadeout","pending","downloading","downloadingTime","workerTask","lastDownloadTime","downloaded","updateThreadCount","mapSeparateLoader","onWorkerMessage","mapDownloadThreads","kind","Blob","mapParseMeshInWorker","downloadFunction","searchArrayIndexById","splice","timer","time","duration","interval","threads","updateChannel","skipTick","loaderSuspended","contextLost","mapPackLoaderEvents","MapPosition","getCoords2","setHeight","setFov","fov","setViewExtent","extent","isSame","isEqual","toArray","MapRenderSlots","createRenderSlot","enabled","addRenderSlot","getRenderSlotIndex","checkRenderSlotId","moveRenderSlotBefore","whichId","whereId","moveRenderSlotAfter","removeRenderSlot","setRenderSlotEnabled","getRenderSlotEnabled","slot","MapStats","inspector","statsCycle","fps","renderTime","renderTimeTmp","renderTimeBegin","lastRenderTime","lastFrameTime","debugIds","recordGraphs","graphsTimeIndex","graphsLastTimeIndex","graphsTimeSamples","graphsRenderTimes","graphsCreateMeshTimes","graphsCreateGpuMeshTimes","graphsCreateTextureTimes","graphsFrameTimes","graphsCpuMemoryMetatiles","graphsCpuMemoryUsed","graphsGpuMemoryTextures","graphsGpuMemoryMeshes","graphsGpuMemoryGeodata","graphsGpuMemoryRender","graphsPolygons","graphsLODs","graphsBuild","graphsFluxTextures","graphsFluxMeshes","graphsFluxGeodatas","graphsCreateTextureTime","graphsCreateGpuMeshTime","graphsCreateMeshTime","resetGraphs","gpuUsed","resourcesUsed","metaUsed","gpuNeeded2","begin","graphs","updateGraphs","updateStatsPanel","MapSurfaceSequence","generateSurfaceSequence","currentView","surfaceSequenceIndices","listId","vsurfaces","vsurfaceCount","list","missed","flagProper","flagAlien","lesser","lastIndex","getFreeLayer","generateBoundLayerSequence","item2","surfaceLayers","freeLayersProperties","MapUrl","Map","configStorage","setConfigParams","setLoaderParams","getProj4","coreConfig","lastPosition","creditsByNumber","processingTasks","processingTasks2","currentViewString","srsReady","mapGPUCache","mapCache","mapMetatileCache","setupMobileMode","mapMobileMode","setupCache","updateCoutner","dirtyCountdown","hoverFeatureId","lastHoverFeature","lastHoverFeatureId","colorHorizon","colorZenith","thickness","mapMobileModeAutodect","getCoreInterface","interface","setOption","getOption","getSrs","srsId","getSrses","getMapKeys","getBodies","setReferenceFrame","getCredits","getVisibleCredits","imageryArray","imagerySpecificity","mapdataArray","mapdataSpecificity","searchArrayById","getSurfaces","setBoundLayerOptions","getBoundLayerOptions","removeBoundLayer","getBoundLayers","getView","removeFreeLayer","setFreeLayerOptions","getFreeLayerOptions","getFreeLayers","getNamedView","getNamedViews","forceRefresh","posToFixed","superelevation","setSuperElevationState","setSuperElevation","clearJobHBuffer","refreshFreelayesInView","getStylesheets","getStylesheetData","setStylesheetData","searchMapByInnerId","getMapIds","isReferenceFrameReady","sources","setConfigParam","validateString","validateNumber","MAXINTEGER","mapMaxProcessingTime","validateBool","mapFlatshade","mapAllowHires","mapAllowLowres","mapAllowSmartSwitching","mapBasicTileSequence","mapSmartNodeParsing","validateNumberArray","mapRefreshCycles","mapFeatureGridCells","mapFeaturesPerSquareInch","mapPackGeodataEvents","mapSortHysteresis","mapHysteresisWait","mapDMapSize","mapDMapMode","mario","getConfigParam","click","hover","persistent","renderToImage","w2","fitToPowerOfTwo","data2","getScreenDepth","useFallback","ray","planePos","planeNormal","tmp1","imageProjectionMatrix","getDepth","getHitCoords","cameraSpaceCoords","hitTest","fallbackUsed","navCoords","hitTestGeoLayers","relatedEvents","getCurrentGeometry","processProcessingTasks","tokenExpiration","tokenExpirationCallback","div","rect","getBoundingClientRect","onResize","InspectorInput","addEventListener","onKeyUp","onKeyPress","onKeyDown","altDown","altKey","ctrlDown","ctrlKey","shiftDown","shiftKey","press","getMap","blockHit","keyCode","which","charCode","preventDefault","enableInspector","diagnosticMode","shakeCamera","saveScreenshot","switchPanel","setOrtho","getOrtho","drawRadar","radarLod","setParameter","getBool","has","InspectorStats","addStyle","element","innerHTML","getCoreVersion","appendChild","infoElement","getElementById","posElement","doNothing","panelVisible","showPanel","display","hidePanel","text2","totalJobs","drawnJobs","jobsTimer2","jobsTimer1","text3","InspectorGraphs","canvasRender","canvasCache","canvasRenderCtx","canvasCacheCtx","onclick","recordingPressed","refreshPressed","resetPressed","zoomPressed","magnifyPressed","graphPressed","onmousemove","onMouseMove","onmouseout","onMouseOut","zoom","graph","refresh","updateGraphsPanel","magnify","clientX","showCursor","cursorIndex","ignoreRefresh","samples","samplesIndex","factorX","clearRect","values","factorY","valuesGeodata","totalFrame","totalRender","totalTexture","totalMeshes","totalGpuMeshes","realCount","valuesFrame","valuesRender","valuesTextures","valuesMeshes","valuesGpuMeshes","fillStyle","fillRect","maxMetatiles","maxResources","maxTextures","maxMeshes","maxGeodata","maxGpu","valuesMetatiles","valuesResources","valuesGpu","total","lods","maxCount","maxTexPlusCount","maxTexPlusSize","maxTexMinusCount","maxTexMinusSize","maxMeshPlusCount","maxMeshPlusSize","maxMeshMinusCount","maxMeshMinusSize","maxGeodataPlusCount","maxGeodataPlusSize","maxGeodataMinusCount","maxGeodataMinusSize","factorY2","base","base2","y1Up","y1Down","y2Up","y2Down","InspectorLayers","viewItems","surfacesItems","boundLayersItems","freeLayersItems","freeLayersPropertiesItems","jsonText","jsonText2","panelInitialized","currentSurface","currentFreeLayer","initViews","states","skey","original","freeLayerInfo","depthShift","depthShift2","depthShift3","viewSurfaces","findIdInArray","viewfreeLayers","freeLayerProperties","buildViews","htmlId","switchView","selectView","buildSurfaces","firstKey","checked","onchange","switchSurface","selectSurface","buildBoundLayers","switchBoundLayer","buildFreeLayers","switchFreeLayer","selectFreeLayer","buildFreeLayerProperties","switchFreeLayerProperty","switchFreeLayerBoundLayer","backgroundColor","applyMapView","action","jsonOnly","sourceView","surfaceBoundLayers","options2","freeLayerBoundLayers","updatePanel","InspectorReplay","items","lodSlider","onSliderChange","oninput","lodText","onTextChange","timeSlider","timeText","timeInfo","infoMeshes","ctxMeshes","infoTextures","ctxTextures","infoTextures2","ctxTextures2","infoGeodata","ctxGeodata","infoMetatiles","ctxMetatiles","infoIntervals","ctxIntervals","infoThreads","ctxThreads","cameraLines","cameraLines2","cameraLines3","cameraGenarated","buildReplayCombo","updateFileInfo","updateLoadGraphs","button","stepUp","stepDown","generateCameraLines","segments","map2","m2","cameraMatrix","v4","dfov","frustumState","frustumMesh","createMesh","itemButton","switchItem","drawCamera","getRenderer","globeTexture","grey","minMeshes","avgMeshes","avgMeshesCount","minTextures","avgTextures","avgTexturesCount","minTextures2","maxTextures2","avgTextures2","avgTextures2Count","minGeodata","avgGeodata","avgGeodataCount","minMetatiles","avgMetatiles","avgMetatilesCount","minThreads","avgThreads","avgThreadsCount","minIntervals","maxIntervals","avgIntervals","avgIntervalsCount","InspectorStylesheets","optionsElement","onComboSwitched","textElement","onUpdate","buildStylesheetsCombo","niceStyleFormat","buff","element2","buff2","key2","Inspector","drawReplayCamera","debugValue","measureMode","measurePoints","circleImage","circleTexture","onMapUpdate","getElementsByTagName","stopPropagation","returnValue","getMapInterface","redraw","slines","convertCoordsFromPhysToCameraSpace","renderer2","drawTBall","progStardome","cameInfo","getCameraInfo","viewMatrix","norm","shaderVariables","step","cbuffer","screenCoords","convertCoordsFromNavToCanvas","lbuffer","GpuDevice","keepFrameBuffer","antialias","currentProgram","maxAttributesCount","newAttributes","enabledAttributes","defaultState","currentState","currentOffset","contextRestored","preserveDrawingBuffer","getExtension","maxAniso","getParameter","MAX_TEXTURE_MAX_ANISOTROPY_EXT","viewportWidth","viewportHeight","clearColor","disable","BLEND","STENCIL_TEST","depthMask","enable","DEPTH_TEST","depthFunc","LESS","CULL_FACE","viewport","COLOR_BUFFER_BIT","DEPTH_BUFFER_BIT","resize","skipCanvas","setAniso","getCanvas","clearDepth","nextSampler","enableVertexAttribArray","disableVertexAttribArray","activeTexture","TEXTURE1","TEXTURE0","blendEquationSeparate","FUNC_ADD","blendFuncSeparate","SRC_ALPHA","ONE_MINUS_SRC_ALPHA","ONE","LEQUAL","GpuFont","images","onFileLoaded","onFileLoadError","areTexturesReady","Camera","fovTan","rotationByMatrix","rotationview","projection","mvp32","modelview32","rotationview32","projection32","frustumPlanes","bboxPoints","scaleFactorVec","setAspect","viewHeight","newFov","getNear","getRotationviewFMatrix","getMvpFMatrix","returnDist","dist","subtract","pointVisible","planes","dot3","negative","orthographicMatrix","perspectiveMatrix","mvpt","multiplyVec4","RendererGeometry","setFaceVertices","setFaceUVs","covnetTo16Bit","xx1","xx2","yy1","yy2","latitudeBands","longitudeBands","useIndices","flon","flat","spherePos","makeQuad","array2","ta","tb","td","GpuBBox","attrPosition","vertexPositionAttribute","LINES","GpuPixelLine3","maxLines","joins","joinSides","addCircle","addLine","compile","sides","getBbox","RendererInit","initShaders","initHeightmap","initSkydome","initHitmap","initTextMap","initImage","initTestMap","initBBox","initLines","initBaricentricBuffer","shaders","sdExt","progFlatShadeTileSE","progCFlatShadeTile","progCFlatShadeTileSE","progDepthHeightmap","heightmapDepthVertexShader","progShadedTile","progTShadedTile","progHeightmap","heightmapVertexShader","heightmapFragmentShader","progPlaneD","progSkydome","skydomeVertexShader","skydomeFragmentShader","stardomeFragmentShader","atmoVertexShader","atmoFragmentShader","atmoVertexShader3","atmoFragmentShader3","bboxVertexShader","bboxFragmentShader","bbox2VertexShader","lineVertexShader","lineFragmentShader","progLineSE","progELineSE","progLine3SE","progELine3SE","progLine4","progLine5","progRLineSE","progERLineSE","tlineVertexShader","tlineFragmentShader","tplineVertexShader","tblineFragmentShader","etlineVertexShader","elineFragmentShader","etplineVertexShader","text2FragmentShader","progText2SE","progLineLabel16","progLineLabel32","progLineLabel48","progLineLabel64","progLineLabel96","progLineLabel128","progPolygon","polygonVertexShader","polygonFragmentShader","progImage","iconVertexShader","textFragmentShader","icon2VertexShader","progLabel16","icon3VertexShader","progLabel32","progLabel48","progLabel64","progLabel96","progLabel128","use16Bit","buildHeightmap","buildPlane","hitmapSize","hitmapData","hitmapTexture","geoHitmapTexture","geoHitmapTexture2","redTexture","whiteTexture","blackTexture","textTexture2","rectVerticesBuffer","rectIndicesBuffer","textBuff16","textBuff32","textBuff48","textBuff64","textQuads16","generateTextQuads","textQuads32","textQuads48","textQuads64","textQuads96","textQuads128","buildSkydome","skydomeMesh","atmoMesh","plineBuffer","plines","plineJoints","stencilLineState","lineLabelState","labelState","stencilLineHitState","lineLabelHitState","polygonB1S1C1tate","polygonB1S0C1tate","polygonB1S1C0tate","polygonB1S0C0tate","polygonB0S1C1tate","polygonB0S0C1tate","polygonB0S1C0tate","polygonB0S0C0tate","sortFeatures","currentIndex","currentValue2","topFeatures","gmapTop","topFeaturesIndex","topFeaturesIndex2","featureCache","gmap","currentValue","storeFeatureToHitmap","hitMap","hcache","hcacheSize","radixSortFeatures","inputSize","depthOnly","radixCountBuffer16","radixCountBuffer32","bunit32","buffUint32","bfloat32","buffFloat32","fill","getVMapValue","vmap","v00","v01","v10","tileCount","featuresPerSquareInch","screenLX","screenLY","featureCount","featureCacheSize","gmapIndex","featureCount2","tileFeatures","gmapHit","usedFeatures","colors","colorIndex","is","gmapStore","hitMapCount","rmap","addRectangle","lastSubJob","addLineLabel","depthParams","storeRemovedRectangle","jobHBuffer","drawGpuSubJobLineLabel","drawGpuSubJob","pp2","maxRadius","maxHitcount","gmap2","gmap3","hmapSize","gmap3Size","divByDist","ub","lb","invMaxRadius","hitCount","hitCacheSize","maxFeatures","featuresPerTile","featuresPerTileInt","featuresPerTileFract","tileSizeX","tileSizeY","featureCache2","featureCacheSize2","gmap4","fillVMapHoles","holesCount","vcount","vsum","vmax","radixDeltaSortFeatures","RendererDraw","q4Slerp","omega","cosom","sinom","scale0","scale1","ax","ay","az","aw","bx","by","bz","bw","drawSkydome","normMat","domeMat","scaleMatrixf","renderedPolygons","size2","nocull","cullFace","FRONT","BACK","drawBall2","nfactor","radius2","tmpState","drawCircle","drawBillboard","drawFlatImage","sizeX","sizeY","sizeX2","charPosX","charPosY","sortHysteresis","timerWait","jobsTimer4","jobsTimer3","stencilMask","STENCIL_BUFFER_BIT","stencilFunc","EQUAL","stencilOp","KEEP","INCR","clearPass","clearPassIndex","clearStencilPasses","onlyAdvancedHitLayers","hsortBuff","jobHSortBuffer","hsortBuffSize","gmapUseVersion","forceUpdate","lj2","buffer2","drawGpuJob","rectanglesCount","rectangles2Count","processRectangles","hbuffer","job2","hysteresisCounter","hysteresisBackup","timerShow","timerHide","fade","job3","updatePos","slayers","vswitchIndex","sjob","paintGL","onlyLayers","processNoOverlap","stickShift","exit","reduce78","checkRectangle","advancedHitPass","ignoreFilters","geodataSelection","vertexTexcoordAttribute","vertexNormalAttribute","vertexOriginAttribute","vertexElementAttribute","screenPixelSize2","debugWires","progLineWireframe","progWireFrameBasicSE","textureParams","gamma2","diameter","localTilt","fontFiles","indexLimit","notready","stickMode","stickHeight","hdelta","vbuff","vitems","subjob2","useSE","targetSize","sizeFactor","labelMorph","s1","pointsIndex","sePoints","sePoints2","transformPointBySE2","margin","RendererRMap","blockSize","maxBlockRectangles","blockSizeFactor","blocks","blocks2","blocksRCount","blocks2RCount","allocatedBlocks","rectangles","rectangles2","rectanglesR","rectanglesRCount","positionsBuffer","sx2","sy2","sy1","sx1","cx2","cy1","bx2","by2","marginFlags","totalNeeded","circleAABBoxCollide","hwidth","hheight","distX","distY","lineAABBoxCollide","rx1","ry1","rx2","ry2","tx1","tx2","tmin","tmax","ty1","ty2","y3","any","checkDepthMap","blockRectangles","blockRectanglesCount","rectangleIndex","removeList","removeRectangle","rr","pbuff","pindex","RenderInit","RenderDraw","RenderRMap","Renderer","progWireframeTile","progWireframeTile2","hitmapCounter","geoHitmapCounter","onResizeCall","touchSurfaceEvent","winSize","oldSize","rendererAllowScreenshots","rendererAntialiasing","rendererAnisotropic","drawTileMatrix","drawTileMatrix2","drawTileVec","drawTileWorldMatrix","pixelTileSizeMatrix","heightmapMesh","skydomeTexture","updateHitmap","updateGeoHitmap","jobHBufferSize","updateCameraMatrix","seTmpVec","seTmpVec2","seTmpVec3","lastHitPosition","logTilePos","resizeGL","lineTexture","skipPaint","includeDistance","f1","f2","getEllipsoidHeight","project","cameraPos2","rayNormalizeDeviceSpace","rayClipCoords","invProjection","rayEye","invView","rayWorld","secondTexture","pixel","surfaceHit","screenRay","pixels","filetype","context","createImageData","putImageData","dataURI","toDataURL","byteString","atob","ArrayBuffer","download","tiled","useHash","Octree","maxItemsPerNode","maxDepth","depthCount","pattern","buildFromGeometry","OctreeNode","octree","mid","combination","OctreeRaycaster","octantTable","findEntryOctant","tx0","ty0","tz0","txm","tym","tzm","entry","findNextOctant","currentOctant","tz1","raycastOctant","intersects","hitFace","intersectOctree","rayPos","rayDir","invDirX","invDirY","invDirZ","dimensions","halfDimensions","intersectOctants","octants","hits","RendererInterface","stateOptions","removeTexture","vertexAttr","uvAttr","uv2Attr","removeMesh","removeResource","resource","addJob","clearJobs","drawJobs","drawDebugText","buildOctreeFromGeometry","raycastOctreeGeometry","raycaster","getCanvasSize","getGLInterface","setMarginFlags","getMarginFlags","MapTrajectory","op2","hm1","hm2","vm1","vm2","pp1","submode","minDuration","maxDuration","samplePeriod","fadePower","yawInterpolation","pv","distanceAzimuth","geoAzimuth","geoDistance","detectMode","detectDuration","detectFlightHeight","flightHeight","headingDuration","generate","getInterpolatedCoords","getInterpolatedHeight","o1","getInterpolatedOrinetation","getInterpolatedFov","getInterpolatedViewExtent","factor2","getSmoothFactor","getSineHeight","getFlightOrienation","azimut","od1","od2","od3","fo","MapInterface","getCurrentCredits","getCreditInfo","getViews","getViewInfo","viewId","getBoundLayerInfo","getFreeLayerInfo","getSurfaceInfo","surfaceId","getReferenceFrame","srs2","convertCoordsFromNavToPublic","convertCoordsFromPublicToNav","convertCoordsFromPhysToPublic","convertCoordsFromNavToPhys","convertCoordsFromPhysToCanvas","convertCoordsFromNavToCameraSpace","skipOrientation","once","includingHeights","onlyMatrix","isPointInsideCameraFrustum","isBBoxInsideCameraFrustum","generateTrajectory","generatePIHTrajectory","setLoaderSuspended","getLoaderSuspended","getGpuCache","getStats","switches","busyWorkers","rendererTime","createGeodata","getGeodataGeometry","setGeodataSelection","selection","getGeodataSelection","Core","coreInterface","lang","languages","language","userLanguage","authorization","listeners","listenerCounter","tokenIFrame","mapInterface","rendererInterface","requestAnimFrame","requestAnimationFrame","webkitRequestAnimationFrame","mozRequestAnimationFrame","oRequestAnimationFrame","msRequestAnimationFrame","mozNow","msNow","oNow","webkitNow","getTime","loadMap","full","checkSupport","destroyMap","tokenCookieLoaded","mapConfigData","tokenExpirationLoop","tokenCanBeSkiped","mapRunnig","onMapConfigLoaded","onMapConfigError","onAutorizationLoaded","onLoadMapconfig","tokenLoaded","onAutorizationError","onLoadImageCookie","onImageCookieLoaded","getHost","iframe","destroy","wait","removeListener","solveStorage","setRendererConfigParam","getRendererConfigParam","rederer","holeIndices","dim","invSize","hasHoles","outerLen","outerNode","linkedList","triangles","queue","steiner","getLeftmost","compareX","eliminateHole","filterPoints","eliminateHoles","earcutLinked","clockwise","signedArea","insertNode","equals","removeNode","again","ear","pass","zOrder","prevZ","nextZ","tail","numMerges","pSize","qSize","inSize","sortLinked","indexCurve","stop","isEarHashed","isEar","cureLocalIntersections","splitEarcut","pointInTriangle","minTX","minTY","maxTX","maxTY","locallyInside","isValidDiagonal","splitPolygon","hx","hy","qx","tanMin","sectorContainsSector","findHoleBridge","leftmost","intersectsPolygon","middleInside","q1","q2","o3","o4","onSegment","Node","an","bp","default","deviation","polygonArea","trianglesArea","flatten","holeIndex","webkitURL","blob","BlobBuilder","WebKitBlobBuilder","MozBlobBuilder","MSBlobBuilder","append","getBlob","Worker","urlCounter","quadKey","digit","hex","processUrlFunction","string2","fc","eval","loclod","locx","locy","strings","findLocalRoot","validNodes","templ","localRoot","id2","simpleFmtObjOrCall","CoreInterface","eventName","UIEvent","getMouseButton","touches","getMouseCoords","absolute","getEventCoords","getPageRect","getDragDelta","getDragZoom","getDragTouches","getModifierKey","getKeyCode","getDragButton","getTouchesCount","getWheelDelta","wheelDelta","detail","getTouchParameter","getTouchCoords","Dom","classList","contains","className","getClass","RegExp","classes","splitWords","hasClass","setClass","baseVal","removeEventListener","documentElement","vtsStamp","stampCounter","TRANSFORM","getSupportedProperty","UIElement","control","ui","events","dragBeginCall","onDragBegin","dragBeginCallTouch","dragMoveCall","onDragMove","dragMoveCallTouch","dragEndCall","onDragEnd","dragEndCallTouch","firstDragDistance","lastDragDistance","dragStartPos","dragCurrentPos","dragLastPos","dragAbsMoved","zoomDrag","getStyle","addClass","removeClass","getRect","rect2","getMapElement","offsetX","pageXOffset","offsetY","pageYOffset","setHtml","allElements","elementsById","getHtml","externalElement","addEvent","removeEventCall","removeEvent","off","fire","hooks","hook","stamp","handler","getEventName","setDraggableState","dragable","dragging","dragTouchCount","dragTouches","dragTouches2","resetPos","dragButtons","getDraggableState","getDraggingState","touchUsed","disableTextSelection","disableImageDrag","updateDragButtonsState","rotateDelta","panDelta","distanceDelta","touchCount","cosAngle","cosAngle2","v1x","v1y","v2x","v2y","enableTextSelection","enableImageDrag","UIControlHolder","visibleLock","parentElement","setVisible","setVisibleLock","getVisible","getVisibleLock","UIControlMap","addControl","UIControlCompass","compass","onDrag","onDoubleClick","image2","image3","lastStyle","autopilot","setAutorotate","setAutopan","controller","controlMode","getCurrentController","orientationDeltas","navigationMode","UIControlCredits","lastHTML","lastHTML2","lastHTML3","getCreditsString","separator","creditInfo","more","html2","html3","butt","onExtendButton","onMoreButton","popup","show","UIControlFullscreen","img","onClick","onDoNothing","requestFullscreen","mozRequestFullScreen","webkitRequestFullscreen","msRequestFullscreen","exitFullscreen","mozCancelFullScreen","webkitExitFullscreen","fullscreenEnabled","mozFullScreenEnabled","webkitFullscreenEnabled","UIControlZoom","plus","onZoomIn","minus","onZoomOut","delay","viewExtentDeltas","ControlModeMapObserver","coordsDeltas","northResetAnimation","drag","wheel","tick","reset","keyup","keydown","keypress","doubleclick","retinaFactor","constrainMapPosition","constrainCamera","minVE","minViewExtent","maxVE","maxViewExtent","maxTilt","threshold","tiltConstrainThreshold","thresholdMin","thresholdMax","cameraConstrainDistance","getFinalOrientation","sensitivity","azimuthDistance","getAzimuthAndDistance","modifierKey","rotationAllowed","zoomAllowed","reduceFloatingHeight","legacyInertia","updateDeltas","panAllowed","fovCorrection","ctrltKey","cameraInfo","speed","jumpAllowed","canvasSize","flyTo","walkMode","fixedHeight","isNavigationSRSProjected","zoomFactor","onlyLastPan","onlyLastRotate","onlyLastZoom","deltas","correction","inertia","timeFactor","invTimeFactor","timeNormalizedInertia","UIControlSpace","button2D","onSwitch","button3D","space3D","display3D","rtrnHit","adr","region","county","rtrn","hasLocation","dupes","filterHits","display_name","dedupe","boundingbox","address","state_district","importance","country","house_number","road","rank","country_code","cc","polygonpoints","done","note","reshakeHits","UIControlSearch","controlSearchElement","onChange","onFocus","onDrag2","mapControl","getMapControl","mapElement","ignoreDrag","urlTemplate","urlTemplate2","lastSearch","itemIndex","searchCounter","coordsSrs","initialValueUsed","controlSearchValue","processTemplate","showList","hideList","moveSelector","updateList","onSelectItem","onHoverItem","solveSRS","refFrame","navigationSrsId","physicalSrsId","controlSearchSrs","av","bv","blur","onListLoaded","controlSearchFilter","onListLoadError","parseLatLon","lastChar","lastChar2","part","words","lengthCheck","numbers","directions","numberCount","controlSearchUrl","mapLoaded","UIControlLink","linkPanel","linkVisible","updateLink","controlZoom","controlSpace","linkValue","getLinkWithCurrentPos","UIControlPopup","hide","UIControlLoading","loading","dots","hiding","setControlVisible","search","controlSearch","controlCompass","controlLink","controlGithub","controlMeasure","controlMeasureLite","controlFullscreen","controlCredits","timeDelta","UIControlMeasureIcon","UIControlMeasureIcon2","UIControlMeasure","buttonOff","buttonOn","compute","computeButton","onCompute","clearButton","onClear","toolButtons","toolButton","onTool","metricButton","measuring","lastCoords","tool","metric","mapUpdateDestructor","listPanel","onMouseMoveCall","onMouseLeaveCall","onMouseLeave","onMouseClickCall","onMouseClick","onMapUpdateCall","clickCoords","getTextNumber","listElement","scrollTop","scrollHeight","divRect","emin","emax","getCore","traceVolumeCall","terrain","lastIndexOf","sampleArea","volumeAbove","volumeBelow","traceVolumeLine","hitFaces","yd2m","points3","concat","UIControlMeasureLite","UI","rootElement","controls","instanceId","instanceCounter","controlLoading","fullscreen","measure2","controlLayers","disableContexMenu","removeControl","setControlHtml","setHTML","lockState","bigScreenMargins","getControlVisible","getControl","setParam","controlScale","controlLogo","Autopilot","trajectory","flightDuration","flightTime","trajectoryIndex","finished","autoMovement","autoRotate","autoPan","autoPanAzimuth","lastTime","getAutorotate","getAutopan","flyToDAH","setTrajectory","flyTrajectory","sampleDuration","cancelFlight","getControlMode","setCurrentControlMode","lastControlMode","getCurrentControlMode","timeStart","sampleIndex","totalSamples","ControlModePano","velocity","impulse","mouse","down","ControlMode","onDown","onUp","onWheel","onTick","controlModes","currentCotnrolModeId","currentControlMode","addControlMode","setDefaultControlMode","removeControlMode","newMode","currentControlModeId","checkAutopilot","updateModifierKeys","draggingState","Presenter","container","aTags","sectionTags","defaultHeight","subtitlesHeights","firstTitleMargin","swipeOffset","actualNode","maxNodes","animTime","currentToolbox","current","presenter","presenterAutoplay","playPresentation","addPresentation","removePresentation","getCurrentPresentation","stopPresentation","getCurrentPresentationType","readTextInput","listPresentations","initPresentation","HTMLtemplate","template","ctrlDelve","setContainer","linksDecode","renderControl","presentation","htmlDataStorage","checkID","getLevel","loc","rawFile","allText","responseText","autorotate","transition","navigate","nextArticle","getNumbers","lastNode","handleArticle","handleSubtitlesPosition","useToolbox","rightPanel","getElementsByClassName","subtitles","swipeControl","setAttribute","opacity","querySelectorAll","swipeControlUp","swipeControlDw","nextButton","prevButton","getElementsTrueHeight","offsetTop","elems","offsetHeight","btnUp","btnDw","articleClass","actualHeight","subtitlesContainer","leftButton","childNodes","rightButton","sections","swipeSubtitles","removeAttribute","hideSections","showSections","sectionType","cursor","elem","Rois","roiServers","roisAtPosition","Browser","initConfig","originalConfig","updatePosInUrl","lastUrlUpdateTime","mapInteracted","rois","onMapLoaded","onMapUnloaded","onMapPositionChanged","onMapPositionFixedHeightChanged","onMapPositionPanned","onMapPositionRotated","onMapPositionZoomed","getUI","setControlMode","originalOptions","geojson","onGeoJsonLoaded","pan","urlParts","extraParts","positionInUrl","geojsonStyle","history","replaceState","positionUrlHistory","searchElement","searchValue","ignoreCore","updateUI","BrowserInterface","getParam","browserInterface"],"mappings":"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","file":"vts-browser.min.js","sourcesContent":[" \t// The module cache\n \tvar installedModules = {};\n\n \t// The require function\n \tfunction __webpack_require__(moduleId) {\n\n \t\t// Check if module is in cache\n \t\tif(installedModules[moduleId]) {\n \t\t\treturn installedModules[moduleId].exports;\n \t\t}\n \t\t// Create a new module (and put it into the cache)\n \t\tvar module = installedModules[moduleId] = {\n \t\t\ti: moduleId,\n \t\t\tl: false,\n \t\t\texports: {}\n \t\t};\n\n \t\t// Execute the module function\n \t\tmodules[moduleId].call(module.exports, module, module.exports, __webpack_require__);\n\n \t\t// Flag the module as loaded\n \t\tmodule.l = true;\n\n \t\t// Return the exports of the module\n \t\treturn module.exports;\n \t}\n\n\n \t// expose the modules object (__webpack_modules__)\n \t__webpack_require__.m = modules;\n\n \t// expose the module cache\n \t__webpack_require__.c = installedModules;\n\n \t// define getter function for harmony exports\n \t__webpack_require__.d = function(exports, name, getter) {\n \t\tif(!__webpack_require__.o(exports, name)) {\n \t\t\tObject.defineProperty(exports, name, { enumerable: true, get: getter });\n \t\t}\n \t};\n\n \t// define __esModule on exports\n \t__webpack_require__.r = function(exports) {\n \t\tif(typeof Symbol !== 'undefined' && Symbol.toStringTag) {\n \t\t\tObject.defineProperty(exports, Symbol.toStringTag, { value: 'Module' });\n \t\t}\n \t\tObject.defineProperty(exports, '__esModule', { value: true });\n \t};\n\n \t// create a fake namespace object\n \t// mode & 1: value is a module id, require it\n \t// mode & 2: merge all properties of value into the ns\n \t// mode & 4: return value when already ns object\n \t// mode & 8|1: behave like require\n \t__webpack_require__.t = function(value, mode) {\n \t\tif(mode & 1) value = __webpack_require__(value);\n \t\tif(mode & 8) return value;\n \t\tif((mode & 4) && typeof value === 'object' && value && value.__esModule) return value;\n \t\tvar ns = Object.create(null);\n \t\t__webpack_require__.r(ns);\n \t\tObject.defineProperty(ns, 'default', { enumerable: true, value: value });\n \t\tif(mode & 2 && typeof value != 'string') for(var key in value) __webpack_require__.d(ns, key, function(key) { return value[key]; }.bind(null, key));\n \t\treturn ns;\n \t};\n\n \t// getDefaultExport function for compatibility with non-harmony modules\n \t__webpack_require__.n = function(module) {\n \t\tvar getter = module && module.__esModule ?\n \t\t\tfunction getDefault() { return module['default']; } :\n \t\t\tfunction getModuleExports() { return module; };\n \t\t__webpack_require__.d(getter, 'a', getter);\n \t\treturn getter;\n \t};\n\n \t// Object.prototype.hasOwnProperty.call\n \t__webpack_require__.o = function(object, property) { return Object.prototype.hasOwnProperty.call(object, property); };\n\n \t// __webpack_public_path__\n \t__webpack_require__.p = \"\";\n\n\n \t// Load entry module and return exports\n \treturn __webpack_require__(__webpack_require__.s = 20);\n","\n\nvar vec2 = {};\n\n\nvec2.create = function (a) {\n    var b = new Array(2);\n    if (a) {\n        b[0] = a[0];\n        b[1] = a[1];\n    }\n    return b;\n};\n\n\nvar vec4 = {};\n\n\nvec4.create = function (a) {\n    var b = new Array(4);\n    if (a) {\n        b[0] = a[0];\n        b[1] = a[1];\n        b[2] = a[2];\n        b[3] = a[3];\n    }\n    return b;\n};\n\n\nvec4.dot = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3];\n};\n\n\nvec4.dot2 = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3];\n};\n\n\nvec4.dot3 = function (a, b, i, x, y, z) {\n    return a[0] * (b[i]-x) + a[1] * (b[i+1]-y) + a[2] * (b[i+2]-z) + a[3];\n};\n\n\nvar vec3 = {};\n\n\nvec3.create = function (a) {\n    var b = new Array(3);\n    if (a) {\n        b[0] = a[0];\n        b[1] = a[1];\n        b[2] = a[2];\n    }\n    return b;\n};\n\n\nvec3.set = function (a, b) {\n    b[0] = a[0];\n    b[1] = a[1];\n    b[2] = a[2];\n    return b;\n};\n\n\nvec3.add = function (a, b, c) {\n    if (!c || a == c) {\n        a[0] += b[0];\n        a[1] += b[1];\n        a[2] += b[2];\n        return a;\n    }\n    c[0] = a[0] + b[0];\n    c[1] = a[1] + b[1];\n    c[2] = a[2] + b[2];\n    return c;\n};\n\n\nvec3.subtract = function (a, b, c) {\n    if (!c || a == c) {\n        a[0] -= b[0];\n        a[1] -= b[1];\n        a[2] -= b[2];\n        return a;\n    }\n    c[0] = a[0] - b[0];\n    c[1] = a[1] - b[1];\n    c[2] = a[2] - b[2];\n    return c;\n};\n\n\nvec3.negate = function (a, b) {\n    b || (b = a);\n    b[0] = -a[0];\n    b[1] = -a[1];\n    b[2] = -a[2];\n    return b;\n};\n\n\nvec3.scale = function (a, b, c) {\n    if (!c || a == c) {\n        a[0] *= b;\n        a[1] *= b;\n        a[2] *= b;\n        return a;\n    }\n    c[0] = a[0] * b;\n    c[1] = a[1] * b;\n    c[2] = a[2] * b;\n    return c;\n};\n\n\nvec3.normalize = function (a, b) {\n    b || (b = a);\n    var c = a[0],\n        d = a[1],\n        e = a[2],\n        g = Math.sqrt(c * c + d * d + e * e);\n    if (g) {\n        if (g == 1) {\n            b[0] = c;\n            b[1] = d;\n            b[2] = e;\n            return b;\n        }\n    } else {\n        b[0] = 0;\n        b[1] = 0;\n        b[2] = 0;\n        return b;\n    }\n    g = 1 / g;\n    b[0] = c * g;\n    b[1] = d * g;\n    b[2] = e * g;\n    return b;\n};\n\n\nvec3.normalize2 = function (a, i, b) {\n    var c = a[i],\n        d = a[i+1],\n        e = a[i+2],\n        g = Math.sqrt(c * c + d * d + e * e);\n    if (g) {\n        if (g == 1) {\n            b[0] = c;\n            b[1] = d;\n            b[2] = e;\n            return b;\n        }\n    } else {\n        b[0] = 0;\n        b[1] = 0;\n        b[2] = 0;\n        return b;\n    }\n    g = 1 / g;\n    b[0] = c * g;\n    b[1] = d * g;\n    b[2] = e * g;\n};\n\n\nvec3.normalize3 = function (a, i, b, j) {\n    var c = a[i],\n        d = a[i+1],\n        e = a[i+2],\n        g = Math.sqrt(c * c + d * d + e * e);\n    if (g) {\n        if (g == 1) {\n            b[j] = c;\n            b[j+1] = d;\n            b[j+2] = e;\n            return b;\n        }\n    } else {\n        b[j] = 0;\n        b[j+1] = 0;\n        b[j+2] = 0;\n        return b;\n    }\n    g = 1 / g;\n    b[j] = c * g;\n    b[j+1] = d * g;\n    b[j+2] = e * g;\n};\n\n\nvec3.normalize4 = function (a, b) {\n    b || (b = a);\n    var c = a[0],\n        d = a[1],\n        e = a[2],\n        g = Math.sqrt(c * c + d * d + e * e);\n    if (g) {\n        if (g == 1) {\n            b[0] = c;\n            b[1] = d;\n            b[2] = e;\n            return b;\n        }\n    } else {\n        b[0] = 0;\n        b[1] = 0;\n        b[2] = 0;\n        return b;\n    }\n    var dd = g;\n    g = 1 / g;\n    b[0] = c * g;\n    b[1] = d * g;\n    b[2] = e * g;\n    return dd;\n};\n\n\nvec3.cross = function (a, b, c) {\n    c || (c = a);\n    var d = a[0],\n        e = a[1];\n    a = a[2];\n    var g = b[0],\n        f = b[1];\n    b = b[2];\n    c[0] = e * b - a * f;\n    c[1] = a * g - d * b;\n    c[2] = d * f - e * g;\n    return c;\n};\n\n\nvec3.length = function (a) {\n    var b = a[0],\n        c = a[1];\n    a = a[2];\n    return Math.sqrt(b * b + c * c + a * a);\n};\n\n\nvec3.dot = function (a, b) {\n    return a[0] * b[0] + a[1] * b[1] + a[2] * b[2];\n};\n\n\nvec3.dot2 = function (a, b, i) {\n    return a[0] * b[i] + a[1] * b[i+1] + a[2] * b[i+2];\n};\n\n\nvec3.dot3 = function (a, i, b, j) {\n    return a[i] * b[j] + a[i+1] * b[j+1] + a[i+2] * b[j+2];\n};\n\n\nvec3.squareDistance = function (a, b) {\n    var dx = b[0] - a[0];\n    var dy = b[1] - a[1];\n    var dz = b[2] - a[2];\n    return dx*dx + dy*dy + dz*dz;\n};\n\n\nvec3.direction = function (a, b, c) {\n    c || (c = a);\n    var d = a[0] - b[0],\n        e = a[1] - b[1];\n    a = a[2] - b[2];\n    b = Math.sqrt(d * d + e * e + a * a);\n    if (!b) {\n        c[0] = 0;\n        c[1] = 0;\n        c[2] = 0;\n        return c;\n    }\n    b = 1 / b;\n    c[0] = d * b;\n    c[1] = e * b;\n    c[2] = a * b;\n    return c;\n};\n\n\nvec3.lerp = function (a, b, c, d) {\n    d || (d = a);\n    d[0] = a[0] + c * (b[0] - a[0]);\n    d[1] = a[1] + c * (b[1] - a[1]);\n    d[2] = a[2] + c * (b[2] - a[2]);\n    return d;\n};\n\n\nvec3.str = function (a) {\n    return '[' + a[0] + ', ' + a[1] + ', ' + a[2] + ']';\n};\n\n\nvar mat3 = {};\n\n\nmat3.create = function (a) {\n    var b = new Array(9);\n    if (a) {\n        b[0] = a[0];\n        b[1] = a[1];\n        b[2] = a[2];\n        b[3] = a[3];\n        b[4] = a[4];\n        b[5] = a[5];\n        b[6] = a[6];\n        b[7] = a[7];\n        b[8] = a[8];\n        b[9] = a[9];\n    }\n    return b;\n};\n\n\nmat3.set = function (a, b) {\n    b[0] = a[0];\n    b[1] = a[1];\n    b[2] = a[2];\n    b[3] = a[3];\n    b[4] = a[4];\n    b[5] = a[5];\n    b[6] = a[6];\n    b[7] = a[7];\n    b[8] = a[8];\n    return b;\n};\n\n\nmat3.identity = function (a) {\n    a[0] = 1;\n    a[1] = 0;\n    a[2] = 0;\n    a[3] = 0;\n    a[4] = 1;\n    a[5] = 0;\n    a[6] = 0;\n    a[7] = 0;\n    a[8] = 1;\n    return a;\n};\n\n\nmat3.transpose = function (a, b) {\n    if (!b || a == b) {\n        var c = a[1],\n            d = a[2],\n            e = a[5];\n        a[1] = a[3];\n        a[2] = a[6];\n        a[3] = c;\n        a[5] = a[7];\n        a[6] = d;\n        a[7] = e;\n        return a;\n    }\n    b[0] = a[0];\n    b[1] = a[3];\n    b[2] = a[6];\n    b[3] = a[1];\n    b[4] = a[4];\n    b[5] = a[7];\n    b[6] = a[2];\n    b[7] = a[5];\n    b[8] = a[8];\n    return b;\n};\n\n\nmat3.toMat4 = function (a, b) {\n    b || (b = mat4.create());\n    b[0] = a[0];\n    b[1] = a[1];\n    b[2] = a[2];\n    b[3] = 0;\n    b[4] = a[3];\n    b[5] = a[4];\n    b[6] = a[5];\n    b[7] = 0;\n    b[8] = a[6];\n    b[9] = a[7];\n    b[10] = a[8];\n    b[11] = 0;\n    b[12] = 0;\n    b[13] = 0;\n    b[14] = 0;\n    b[15] = 1;\n    return b;\n};\n\nmat3.multiplyVec3 = function (a, b, c) {\n    c || (c = b);\n    var d = b[0],\n        e = b[1];\n    b = b[2];\n    c[0] = a[0] * d + a[3] * e + a[6] * b;\n    c[1] = a[1] * d + a[4] * e + a[7] * b;\n    c[2] = a[2] * d + a[5] * e + a[8] * b;\n    return c;\n};\n\n\nmat3.str = function (a) {\n    return '[' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' + a[8] + ']';\n};\n\n\nvar mat4 = {};\n\n\nmat4.create = function (a) {\n    var b = new Array(16);\n    if (a) {\n        b[0] = a[0];\n        b[1] = a[1];\n        b[2] = a[2];\n        b[3] = a[3];\n        b[4] = a[4];\n        b[5] = a[5];\n        b[6] = a[6];\n        b[7] = a[7];\n        b[8] = a[8];\n        b[9] = a[9];\n        b[10] = a[10];\n        b[11] = a[11];\n        b[12] = a[12];\n        b[13] = a[13];\n        b[14] = a[14];\n        b[15] = a[15];\n    }\n    return b;\n};\n\n\nmat4.set = function (a, b) {\n    b[0] = a[0];\n    b[1] = a[1];\n    b[2] = a[2];\n    b[3] = a[3];\n    b[4] = a[4];\n    b[5] = a[5];\n    b[6] = a[6];\n    b[7] = a[7];\n    b[8] = a[8];\n    b[9] = a[9];\n    b[10] = a[10];\n    b[11] = a[11];\n    b[12] = a[12];\n    b[13] = a[13];\n    b[14] = a[14];\n    b[15] = a[15];\n    return b;\n};\n\n\nmat4.identity = function (a) {\n    a[0] = 1;\n    a[1] = 0;\n    a[2] = 0;\n    a[3] = 0;\n    a[4] = 0;\n    a[5] = 1;\n    a[6] = 0;\n    a[7] = 0;\n    a[8] = 0;\n    a[9] = 0;\n    a[10] = 1;\n    a[11] = 0;\n    a[12] = 0;\n    a[13] = 0;\n    a[14] = 0;\n    a[15] = 1;\n    return a;\n};\n\n\nmat4.transpose = function (a, b) {\n    if (!b || a == b) {\n        var c = a[1],\n            d = a[2],\n            e = a[3],\n            g = a[6],\n            f = a[7],\n            h = a[11];\n        a[1] = a[4];\n        a[2] = a[8];\n        a[3] = a[12];\n        a[4] = c;\n        a[6] = a[9];\n        a[7] = a[13];\n        a[8] = d;\n        a[9] = g;\n        a[11] = a[14];\n        a[12] = e;\n        a[13] = f;\n        a[14] = h;\n        return a;\n    }\n    b[0] = a[0];\n    b[1] = a[4];\n    b[2] = a[8];\n    b[3] = a[12];\n    b[4] = a[1];\n    b[5] = a[5];\n    b[6] = a[9];\n    b[7] = a[13];\n    b[8] = a[2];\n    b[9] = a[6];\n    b[10] = a[10];\n    b[11] = a[14];\n    b[12] = a[3];\n    b[13] = a[7];\n    b[14] = a[11];\n    b[15] = a[15];\n    return b;\n};\n\n\nmat4.determinant = function (a) {\n    var b = a[0],\n        c = a[1],\n        d = a[2],\n        e = a[3],\n        g = a[4],\n        f = a[5],\n        h = a[6],\n        i = a[7],\n        j = a[8],\n        k = a[9],\n        l = a[10],\n        o = a[11],\n        m = a[12],\n        n = a[13],\n        p = a[14];\n    a = a[15];\n    return m * k * h * e - j * n * h * e - m * f * l * e + g * n * l * e + j * f * p * e - g * k * p * e - m * k * d * i + j * n * d * i + m * c * l * i - b * n * l * i - j * c * p * i + b * k * p * i + m * f * d * o - g * n * d * o - m * c * h * o + b * n * h * o + g * c * p * o - b * f * p * o - j * f * d * a + g * k * d * a + j * c * h * a - b * k * h * a - g * c * l * a + b * f * l * a;\n};\n\n\nmat4.inverse = function (a, b) {\n    b || (b = a);\n    var c = a[0],\n        d = a[1],\n        e = a[2],\n        g = a[3],\n        f = a[4],\n        h = a[5],\n        i = a[6],\n        j = a[7],\n        k = a[8],\n        l = a[9],\n        o = a[10],\n        m = a[11],\n        n = a[12],\n        p = a[13],\n        r = a[14],\n        s = a[15],\n        A = c * h - d * f,\n        B = c * i - e * f,\n        t = c * j - g * f,\n        u = d * i - e * h,\n        v = d * j - g * h,\n        w = e * j - g * i,\n        x = k * p - l * n,\n        y = k * r - o * n,\n        z = k * s - m * n,\n        C = l * r - o * p,\n        D = l * s - m * p,\n        E = o * s - m * r,\n        q = 1 / (A * E - B * D + t * C + u * z - v * y + w * x);\n    b[0] = (h * E - i * D + j * C) * q;\n    b[1] = (-d * E + e * D - g * C) * q;\n    b[2] = (p * w - r * v + s * u) * q;\n    b[3] = (-l * w + o * v - m * u) * q;\n    b[4] = (-f * E + i * z - j * y) * q;\n    b[5] = (c * E - e * z + g * y) * q;\n    b[6] = (-n * w + r * t - s * B) * q;\n    b[7] = (k * w - o * t + m * B) * q;\n    b[8] = (f * D - h * z + j * x) * q;\n    b[9] = (-c * D + d * z - g * x) * q;\n    b[10] = (n * v - p * t + s * A) * q;\n    b[11] = (-k * v + l * t - m * A) * q;\n    b[12] = (-f * C + h * y - i * x) * q;\n    b[13] = (c * C - d * y + e * x) * q;\n    b[14] = (-n * u + p * B - r * A) * q;\n    b[15] = (k * u - l * B + o * A) * q;\n    return b;\n};\n\n\nmat4.toRotationMat = function (a, b) {\n    b || (b = mat4.create());\n    b[0] = a[0];\n    b[1] = a[1];\n    b[2] = a[2];\n    b[3] = a[3];\n    b[4] = a[4];\n    b[5] = a[5];\n    b[6] = a[6];\n    b[7] = a[7];\n    b[8] = a[8];\n    b[9] = a[9];\n    b[10] = a[10];\n    b[11] = a[11];\n    b[12] = 0;\n    b[13] = 0;\n    b[14] = 0;\n    b[15] = 1;\n    return b;\n};\n\n\nmat4.toMat3 = function (a, b) {\n    b || (b = mat3.create());\n    b[0] = a[0];\n    b[1] = a[1];\n    b[2] = a[2];\n    b[3] = a[4];\n    b[4] = a[5];\n    b[5] = a[6];\n    b[6] = a[8];\n    b[7] = a[9];\n    b[8] = a[10];\n    return b;\n};\n\n\nmat4.toInverseMat3 = function (a, b) {\n    var c = a[0],\n        d = a[1],\n        e = a[2],\n        g = a[4],\n        f = a[5],\n        h = a[6],\n        i = a[8],\n        j = a[9],\n        k = a[10],\n        l = k * f - h * j,\n        o = -k * g + h * i,\n        m = j * g - f * i,\n        n = c * l + d * o + e * m;\n    if (!n) return null;\n    n = 1 / n;\n    b || (b = mat3.create());\n    b[0] = l * n;\n    b[1] = (-k * d + e * j) * n;\n    b[2] = (h * d - e * f) * n;\n    b[3] = o * n;\n    b[4] = (k * c - e * i) * n;\n    b[5] = (-h * c + e * g) * n;\n    b[6] = m * n;\n    b[7] = (-j * c + d * i) * n;\n    b[8] = (f * c - d * g) * n;\n    return b;\n};\n\n\nmat4.multiply = function (a, b, c) {\n    c || (c = a);\n    var d = a[0],\n        e = a[1],\n        g = a[2],\n        f = a[3],\n        h = a[4],\n        i = a[5],\n        j = a[6],\n        k = a[7],\n        l = a[8],\n        o = a[9],\n        m = a[10],\n        n = a[11],\n        p = a[12],\n        r = a[13],\n        s = a[14];\n    a = a[15];\n    var A = b[0],\n        B = b[1],\n        t = b[2],\n        u = b[3],\n        v = b[4],\n        w = b[5],\n        x = b[6],\n        y = b[7],\n        z = b[8],\n        C = b[9],\n        D = b[10],\n        E = b[11],\n        q = b[12],\n        F = b[13],\n        G = b[14];\n    b = b[15];\n    c[0] = A * d + B * h + t * l + u * p;\n    c[1] = A * e + B * i + t * o + u * r;\n    c[2] = A * g + B * j + t * m + u * s;\n    c[3] = A * f + B * k + t * n + u * a;\n    c[4] = v * d + w * h + x * l + y * p;\n    c[5] = v * e + w * i + x * o + y * r;\n    c[6] = v * g + w * j + x * m + y * s;\n    c[7] = v * f + w * k + x * n + y * a;\n    c[8] = z * d + C * h + D * l + E * p;\n    c[9] = z * e + C * i + D * o + E * r;\n    c[10] = z *\n        g + C * j + D * m + E * s;\n    c[11] = z * f + C * k + D * n + E * a;\n    c[12] = q * d + F * h + G * l + b * p;\n    c[13] = q * e + F * i + G * o + b * r;\n    c[14] = q * g + F * j + G * m + b * s;\n    c[15] = q * f + F * k + G * n + b * a;\n    return c;\n};\n\n\nmat4.multiplyVec3 = function (a, b, c) {\n    c || (c = b);\n    var d = b[0],\n        e = b[1];\n    b = b[2];\n    c[0] = a[0] * d + a[4] * e + a[8] * b + a[12];\n    c[1] = a[1] * d + a[5] * e + a[9] * b + a[13];\n    c[2] = a[2] * d + a[6] * e + a[10] * b + a[14];\n    return c;\n};\n\n\nmat4.multiplyVec4 = function (a, b, c) {\n    c || (c = b);\n    var d = b[0],\n        e = b[1],\n        g = b[2];\n    b = b[3];\n    c[0] = a[0] * d + a[4] * e + a[8] * g + a[12] * b;\n    c[1] = a[1] * d + a[5] * e + a[9] * g + a[13] * b;\n    c[2] = a[2] * d + a[6] * e + a[10] * g + a[14] * b;\n    c[3] = a[3] * d + a[7] * e + a[11] * g + a[15] * b;\n    return c;\n};\n\n\nmat4.translate = function (a, b, c) {\n    var d = b[0],\n        e = b[1];\n    b = b[2];\n    if (!c || a == c) {\n        a[12] = a[0] * d + a[4] * e + a[8] * b + a[12];\n        a[13] = a[1] * d + a[5] * e + a[9] * b + a[13];\n        a[14] = a[2] * d + a[6] * e + a[10] * b + a[14];\n        a[15] = a[3] * d + a[7] * e + a[11] * b + a[15];\n        return a;\n    }\n    var g = a[0],\n        f = a[1],\n        h = a[2],\n        i = a[3],\n        j = a[4],\n        k = a[5],\n        l = a[6],\n        o = a[7],\n        m = a[8],\n        n = a[9],\n        p = a[10],\n        r = a[11];\n    c[0] = g;\n    c[1] = f;\n    c[2] = h;\n    c[3] = i;\n    c[4] = j;\n    c[5] = k;\n    c[6] = l;\n    c[7] = o;\n    c[8] = m;\n    c[9] = n;\n    c[10] = p;\n    c[11] = r;\n    c[12] = g * d + j * e + m * b + a[12];\n    c[13] = f * d + k * e + n * b + a[13];\n    c[14] = h * d + l * e + p * b + a[14];\n    c[15] = i * d + o * e + r * b + a[15];\n    return c;\n};\n\n\nmat4.scale = function (a, b, c) {\n    var d = b[0],\n        e = b[1];\n    b = b[2];\n    if (!c || a == c) {\n        a[0] *= d;\n        a[1] *= d;\n        a[2] *= d;\n        a[3] *= d;\n        a[4] *= e;\n        a[5] *= e;\n        a[6] *= e;\n        a[7] *= e;\n        a[8] *= b;\n        a[9] *= b;\n        a[10] *= b;\n        a[11] *= b;\n        return a;\n    }\n    c[0] = a[0] * d;\n    c[1] = a[1] * d;\n    c[2] = a[2] * d;\n    c[3] = a[3] * d;\n    c[4] = a[4] * e;\n    c[5] = a[5] * e;\n    c[6] = a[6] * e;\n    c[7] = a[7] * e;\n    c[8] = a[8] * b;\n    c[9] = a[9] * b;\n    c[10] = a[10] * b;\n    c[11] = a[11] * b;\n    c[12] = a[12];\n    c[13] = a[13];\n    c[14] = a[14];\n    c[15] = a[15];\n    return c;\n};\n\n\nmat4.rotate = function (a, b, c, d) {\n    var e = c[0],\n        g = c[1];\n    c = c[2];\n    var f = Math.sqrt(e * e + g * g + c * c);\n    if (!f) return null;\n    if (f != 1) {\n        f = 1 / f;\n        e *= f;\n        g *= f;\n        c *= f;\n    }\n    var h = Math.sin(b),\n        i = Math.cos(b),\n        j = 1 - i;\n    b = a[0];\n    f = a[1];\n    var k = a[2],\n        l = a[3],\n        o = a[4],\n        m = a[5],\n        n = a[6],\n        p = a[7],\n        r = a[8],\n        s = a[9],\n        A = a[10],\n        B = a[11],\n        t = e * e * j + i,\n        u = g * e * j + c * h,\n        v = c * e * j - g * h,\n        w = e * g * j - c * h,\n        x = g * g * j + i,\n        y = c * g * j + e * h,\n        z = e * c * j + g * h;\n    e = g * c * j - e * h;\n    g = c * c * j + i;\n    if (d) {\n        if (a != d) {\n            d[12] = a[12];\n            d[13] = a[13];\n            d[14] = a[14];\n            d[15] = a[15];\n        }\n    } else d = a;\n    d[0] = b * t + o * u + r * v;\n    d[1] = f * t + m * u + s * v;\n    d[2] = k * t + n * u + A * v;\n    d[3] = l * t + p * u + B *\n        v;\n    d[4] = b * w + o * x + r * y;\n    d[5] = f * w + m * x + s * y;\n    d[6] = k * w + n * x + A * y;\n    d[7] = l * w + p * x + B * y;\n    d[8] = b * z + o * e + r * g;\n    d[9] = f * z + m * e + s * g;\n    d[10] = k * z + n * e + A * g;\n    d[11] = l * z + p * e + B * g;\n    return d;\n};\n\n\nmat4.rotateX = function (a, b, c) {\n    var d = Math.sin(b);\n    b = Math.cos(b);\n    var e = a[4],\n        g = a[5],\n        f = a[6],\n        h = a[7],\n        i = a[8],\n        j = a[9],\n        k = a[10],\n        l = a[11];\n    if (c) {\n        if (a != c) {\n            c[0] = a[0];\n            c[1] = a[1];\n            c[2] = a[2];\n            c[3] = a[3];\n            c[12] = a[12];\n            c[13] = a[13];\n            c[14] = a[14];\n            c[15] = a[15];\n        }\n    } else c = a;\n    c[4] = e * b + i * d;\n    c[5] = g * b + j * d;\n    c[6] = f * b + k * d;\n    c[7] = h * b + l * d;\n    c[8] = e * -d + i * b;\n    c[9] = g * -d + j * b;\n    c[10] = f * -d + k * b;\n    c[11] = h * -d + l * b;\n    return c;\n};\n\n\nmat4.rotateY = function (a, b, c) {\n    var d = Math.sin(b);\n    b = Math.cos(b);\n    var e = a[0],\n        g = a[1],\n        f = a[2],\n        h = a[3],\n        i = a[8],\n        j = a[9],\n        k = a[10],\n        l = a[11];\n    if (c) {\n        if (a != c) {\n            c[4] = a[4];\n            c[5] = a[5];\n            c[6] = a[6];\n            c[7] = a[7];\n            c[12] = a[12];\n            c[13] = a[13];\n            c[14] = a[14];\n            c[15] = a[15];\n        }\n    } else c = a;\n    c[0] = e * b + i * -d;\n    c[1] = g * b + j * -d;\n    c[2] = f * b + k * -d;\n    c[3] = h * b + l * -d;\n    c[8] = e * d + i * b;\n    c[9] = g * d + j * b;\n    c[10] = f * d + k * b;\n    c[11] = h * d + l * b;\n    return c;\n};\n\n\nmat4.rotateZ = function (a, b, c) {\n    var d = Math.sin(b);\n    b = Math.cos(b);\n    var e = a[0],\n        g = a[1],\n        f = a[2],\n        h = a[3],\n        i = a[4],\n        j = a[5],\n        k = a[6],\n        l = a[7];\n    if (c) {\n        if (a != c) {\n            c[8] = a[8];\n            c[9] = a[9];\n            c[10] = a[10];\n            c[11] = a[11];\n            c[12] = a[12];\n            c[13] = a[13];\n            c[14] = a[14];\n            c[15] = a[15];\n        }\n    } else c = a;\n    c[0] = e * b + i * d;\n    c[1] = g * b + j * d;\n    c[2] = f * b + k * d;\n    c[3] = h * b + l * d;\n    c[4] = e * -d + i * b;\n    c[5] = g * -d + j * b;\n    c[6] = f * -d + k * b;\n    c[7] = h * -d + l * b;\n    return c;\n};\n\n\nmat4.frustum = function (a, b, c, d, e, g, f) {\n    f || (f = mat4.create());\n    var h = b - a,\n        i = d - c,\n        j = g - e;\n    f[0] = e * 2 / h;\n    f[1] = 0;\n    f[2] = 0;\n    f[3] = 0;\n    f[4] = 0;\n    f[5] = e * 2 / i;\n    f[6] = 0;\n    f[7] = 0;\n    f[8] = (b + a) / h;\n    f[9] = (d + c) / i;\n    f[10] = -(g + e) / j;\n    f[11] = -1;\n    f[12] = 0;\n    f[13] = 0;\n    f[14] = -(g * e * 2) / j;\n    f[15] = 0;\n    return f;\n};\n\n\nmat4.perspective = function (a, b, c, d, e) {\n    a = c * Math.tan(a * Math.PI / 360);\n    b = a * b;\n    return mat4.frustum(-b, b, -a, a, c, d, e);\n};\n\n\nmat4.ortho = function (a, b, c, d, e, g, f) {\n    f || (f = mat4.create());\n    var h = b - a,\n        i = d - c,\n        j = g - e;\n    f[0] = 2 / h;\n    f[1] = 0;\n    f[2] = 0;\n    f[3] = 0;\n    f[4] = 0;\n    f[5] = 2 / i;\n    f[6] = 0;\n    f[7] = 0;\n    f[8] = 0;\n    f[9] = 0;\n    f[10] = -2 / j;\n    f[11] = 0;\n    f[12] = -(a + b) / h;\n    f[13] = -(d + c) / i;\n    f[14] = -(g + e) / j;\n    f[15] = 1;\n    return f;\n};\n\n\nmat4.lookAt = function (a, b, c, d) {\n    d || (d = mat4.create());\n    var e = a[0],\n        g = a[1];\n    a = a[2];\n    var f = c[0],\n        h = c[1],\n        i = c[2];\n    c = b[1];\n    var j = b[2];\n    if (e == b[0] && g == c && a == j) return mat4.identity(d);\n    var k, l, o, m;\n    c = e - b[0];\n    j = g - b[1];\n    b = a - b[2];\n    m = 1 / Math.sqrt(c * c + j * j + b * b);\n    c *= m;\n    j *= m;\n    b *= m;\n    k = h * b - i * j;\n    i = i * c - f * b;\n    f = f * j - h * c;\n    m = Math.sqrt(k * k + i * i + f * f);\n    if (m) {\n        m = 1 / m;\n        k *= m;\n        i *= m;\n        f *= m;\n    } else f = i = k = 0;\n    h = j * f - b * i;\n    l = b * k - c * f;\n    o = c * i - j * k;\n    m = Math.sqrt(h * h + l * l + o * o);\n    if (m) {\n        m = 1 / m;\n        h *= m;\n        l *= m;\n        o *= m;\n    } else o = l = h = 0;\n    d[0] = k;\n    d[1] = h;\n    d[2] = c;\n    d[3] = 0;\n    d[4] = i;\n    d[5] = l;\n    d[6] = j;\n    d[7] = 0;\n    d[8] = f;\n    d[9] =\n        o;\n    d[10] = b;\n    d[11] = 0;\n    d[12] = -(k * e + i * g + f * a);\n    d[13] = -(h * e + l * g + o * a);\n    d[14] = -(c * e + j * g + b * a);\n    d[15] = 1;\n    return d;\n};\n\n\nmat4.str = function (a) {\n    return '[' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ', ' + a[4] + ', ' + a[5] + ', ' + a[6] + ', ' + a[7] + ', ' + a[8] + ', ' + a[9] + ', ' + a[10] + ', ' + a[11] + ', ' + a[12] + ', ' + a[13] + ', ' + a[14] + ', ' + a[15] + ']';\n};\n\n\nvar quat4 = {};\n\n\nquat4.create = function (a) {\n    var b = new Array(4);\n    if (a) {\n        b[0] = a[0];\n        b[1] = a[1];\n        b[2] = a[2];\n        b[3] = a[3];\n    }\n    return b;\n};\n\n\nquat4.set = function (a, b) {\n    b[0] = a[0];\n    b[1] = a[1];\n    b[2] = a[2];\n    b[3] = a[3];\n    return b;\n};\n\n\nquat4.calculateW = function (a, b) {\n    var c = a[0],\n        d = a[1],\n        e = a[2];\n    if (!b || a == b) {\n        a[3] = -Math.sqrt(Math.abs(1 - c * c - d * d - e * e));\n        return a;\n    }\n    b[0] = c;\n    b[1] = d;\n    b[2] = e;\n    b[3] = -Math.sqrt(Math.abs(1 - c * c - d * d - e * e));\n    return b;\n};\n\n\nquat4.inverse = function (a, b) {\n    if (!b || a == b) {\n        a[0] *= 1;\n        a[1] *= 1;\n        a[2] *= 1;\n        return a;\n    }\n    b[0] = -a[0];\n    b[1] = -a[1];\n    b[2] = -a[2];\n    b[3] = a[3];\n    return b;\n};\n\n\nquat4.length = function (a) {\n    var b = a[0],\n        c = a[1],\n        d = a[2];\n    a = a[3];\n    return Math.sqrt(b * b + c * c + d * d + a * a);\n};\n\n\nquat4.normalize = function (a, b) {\n    b || (b = a);\n    var c = a[0],\n        d = a[1],\n        e = a[2],\n        g = a[3],\n        f = Math.sqrt(c * c + d * d + e * e + g * g);\n    if (f == 0) {\n        b[0] = 0;\n        b[1] = 0;\n        b[2] = 0;\n        b[3] = 0;\n        return b;\n    }\n    f = 1 / f;\n    b[0] = c * f;\n    b[1] = d * f;\n    b[2] = e * f;\n    b[3] = g * f;\n    return b;\n};\n\n\nquat4.multiply = function (a, b, c) {\n    c || (c = a);\n    var d = a[0],\n        e = a[1],\n        g = a[2];\n    a = a[3];\n    var f = b[0],\n        h = b[1],\n        i = b[2];\n    b = b[3];\n    c[0] = d * b + a * f + e * i - g * h;\n    c[1] = e * b + a * h + g * f - d * i;\n    c[2] = g * b + a * i + d * h - e * f;\n    c[3] = a * b - d * f - e * h - g * i;\n    return c;\n};\n\n\nquat4.multiplyVec3 = function (a, b, c) {\n    c || (c = b);\n    var d = b[0],\n        e = b[1],\n        g = b[2];\n    b = a[0];\n    var f = a[1],\n        h = a[2];\n    a = a[3];\n    var i = a * d + f * g - h * e,\n        j = a * e + h * d - b * g,\n        k = a * g + b * e - f * d;\n    d = -b * d - f * e - h * g;\n    c[0] = i * a + d * -b + j * -h - k * -f;\n    c[1] = j * a + d * -f + k * -b - i * -h;\n    c[2] = k * a + d * -h + i * -f - j * -b;\n    return c;\n};\n\n\nquat4.toMat3 = function (a, b) {\n    b || (b = mat3.create());\n    var c = a[0],\n        d = a[1],\n        e = a[2],\n        g = a[3],\n        f = c + c,\n        h = d + d,\n        i = e + e,\n        j = c * f,\n        k = c * h;\n    c = c * i;\n    var l = d * h;\n    d = d * i;\n    e = e * i;\n    f = g * f;\n    h = g * h;\n    g = g * i;\n    b[0] = 1 - (l + e);\n    b[1] = k - g;\n    b[2] = c + h;\n    b[3] = k + g;\n    b[4] = 1 - (j + e);\n    b[5] = d - f;\n    b[6] = c - h;\n    b[7] = d + f;\n    b[8] = 1 - (j + l);\n    return b;\n};\n\n\nquat4.toMat4 = function (a, b) {\n    b || (b = mat4.create());\n    var c = a[0],\n        d = a[1],\n        e = a[2],\n        g = a[3],\n        f = c + c,\n        h = d + d,\n        i = e + e,\n        j = c * f,\n        k = c * h;\n    c = c * i;\n    var l = d * h;\n    d = d * i;\n    e = e * i;\n    f = g * f;\n    h = g * h;\n    g = g * i;\n    b[0] = 1 - (l + e);\n    b[1] = k - g;\n    b[2] = c + h;\n    b[3] = 0;\n    b[4] = k + g;\n    b[5] = 1 - (j + e);\n    b[6] = d - f;\n    b[7] = 0;\n    b[8] = c - h;\n    b[9] = d + f;\n    b[10] = 1 - (j + l);\n    b[11] = 0;\n    b[12] = 0;\n    b[13] = 0;\n    b[14] = 0;\n    b[15] = 1;\n    return b;\n};\n\n\nquat4.slerp = function (a, b, c, d) {\n    d || (d = a);\n    var e = c;\n    if (a[0] * b[0] + a[1] * b[1] + a[2] * b[2] + a[3] * b[3] < 0) e = -1 * c;\n    d[0] = 1 - c * a[0] + e * b[0];\n    d[1] = 1 - c * a[1] + e * b[1];\n    d[2] = 1 - c * a[2] + e * b[2];\n    d[3] = 1 - c * a[3] + e * b[3];\n    return d;\n};\n\n\nquat4.str = function (a) {\n    return '[' + a[0] + ', ' + a[1] + ', ' + a[2] + ', ' + a[3] + ']';\n};\n\nexport {vec2, vec3, vec4, mat3, mat4};\n\n","\nimport {math as math_} from './math';\nimport {utilsUrl as utilsUrl_} from './url';\n\n//get rid of compiler mess\nvar math = math_;\nvar utilsUrl = utilsUrl_;\n\n\nvar utils = {};\nutils.useCredentials = false;\nutils.instanceCounter = 0;\n\n\nutils.validateBool = function(value, defaultValue) {\n    if (typeof value === 'boolean') {\n        return value;\n    } else {\n        return defaultValue;\n    }\n};\n\n\nutils.validateNumber = function(value, minValue, maxValue, defaultValue) {\n    if (typeof value === 'number') {\n        return math.clamp(value, minValue, maxValue);\n    } else {\n        return defaultValue;\n    }\n};\n\n\nutils.validateNumberArray = function(array, arraySize, minValues, maxValues, defaultValues) {\n    if (Array.isArray(array) && array.length == arraySize) {\n        for (var i = 0; i < arraySize; i++) {\n            array[i] = math.clamp(array[i], minValues[i], maxValues[i]);\n        }\n        return array;\n    } else {\n        return defaultValues;\n    }\n};\n\n\nutils.validateString = function(value, defaultValue) {\n    if (typeof value === 'string') {\n        return value;\n    } else {\n        return defaultValue;\n    }\n};\n\n\nutils.padNumber = function(n, width) {\n    var z = '0';\n\n    if (n < 0) {\n        n = (-n) + '';\n        width--;     //7\n        return n.length >= width ? ('-' + n) : '-' + (new Array(width - n.length + 1).join(z) + n);\n    } else {\n        n = n + '';\n        return n.length >= width ? n : new Array(width - n.length + 1).join(z) + n;\n    }\n};\n\n\nutils.decodeFloat16 = function(binary) {\n    var exponent = (binary & 0x7C00) >> 10;\n    var fraction = binary & 0x03FF;\n    return (binary >> 15 ? -1 : 1) * (\n        exponent ?\n        (\n            exponent === 0x1F ?\n            fraction ? NaN : Infinity :\n            Math.pow(2, exponent - 15) * (1 + fraction / 0x400)\n        ) :\n        6.103515625e-5 * (fraction / 0x400)\n    );\n};\n\n\nutils.simpleFmtObj = (function obj(str, obj) {\n    if (!str || str == '') {\n        return '';\n    }\n\n    return str.replace(/\\{([$a-zA-Z0-9][$a-zA-Z0-9]*)\\}/g, function(s, match) {\n        return (match in obj ? obj[match] : s);\n    });\n});\n\n\nutils.simpleWikiLinks = (function obj(str, plain) {\n    if (!str || str == '') {\n        return '';\n    }\n\n    var str2 = utils.simpleFmtObj(str, {'copy':'&copy;', 'Y': (new Date().getFullYear())}); \n    \n    return str2.replace(/\\[([^\\]]*)\\]/g, function(s, match) {\n        match  = match.trim();\n        var urls = match.split(' ');//, 1);\n        \n        if (urls[0].indexOf('//') != -1) {\n            if (plain) {\n                if (urls.length > 1) {\n                    return '' + match.substring(urls[0].length);\n                } else {\n                    return '' + urls[0];\n                }\n            } else {\n                if (urls.length > 1) {\n                    return '<a href=' + urls[0] + ' target=\"blank\">' + match.substring(urls[0].length)+'</a>';\n                } else {\n                    return '<a href=' + urls[0] + ' target=\"blank\">' + urls[0]+'</a>';\n                }\n            }\n        }\n        \n        return match;\n    });\n});\n\n\nutils.simpleFmtObjOrCall = (function obj(str, obj, call) {\n    if (!str || str == '') {\n        return '';\n    }\n\n    return str.replace(/\\{([$a-zA-Z(-9][$a-zA-Z(-9]*)\\}/g, function(s, match) {\n        return (match in obj ? obj[match] : call(match));\n    });\n});\n\n\nutils.getABGRFromHexaCode = (function(code) {\n    var result = /^#?([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})([a-f\\d]{2})$/i.exec(code);\n\n    return result ?\n    [ parseInt(result[4], 16),\n        parseInt(result[3], 16),\n        parseInt(result[2], 16),\n        parseInt(result[1], 16)]\n    : [0,0,0,255];\n});\n\n\nutils.stringifyFunction = (function(fn) {\n    // Stringify the code\n    return '(' + fn + ').call(self);';\n});\n\n\nutils.isPowerOfTwo = (function(value) {\n    return (value & (value - 1)) === 0 && value !== 0;\n});\n\n\nutils.nearestPowerOfTwo = (function(value) {\n    return Math.pow(2, Math.round(Math.log(value) / Math.LN2));\n});   \n\n\nutils.fitToPowerOfTwo = (function(value) {\n    return Math.pow(2, Math.ceil(Math.log(value) / Math.LN2));\n});   \n\n\nutils.getHash = function(str) {\n    if (!str || str.length === 0) {\n        return 0;    \n    }\n\n    var hash = 0, c;\n    for (var i = 0, li = str.length; i < li; i++) {\n        c   = str.charCodeAt(i);\n        hash  = ((hash << 5) - hash) + c;\n        hash |= 0; // Convert to 32bit integer\n    }\n\n    return hash;\n};\n\n\nutils.convertRGB2YCbCr = function(r, g, b) {\n  return [( .299 * r + .587 * g  +  0.114 * b) + 0,\n          ( -.169 * r + -.331 * g +  0.500 * b) + 128,\n          ( .500 * r + -.419 * g +  -0.081 * b) + 128];\n};\n\n\nutils.convertYCbCr2RGB = function(y, cb, cr) {\n  return [1 * y +  0 * (cb-128)      +  1.4 * (cr-128),\n          1 * y +  -.343 * (cb-128)  +  -.711 * (cr-128),\n          1 * y +  1.765 * (cb-128)  +  0 * (cr-128)];\n};\n\n\nutils.convertHSL2RGB = function(h, s, l){\n   var r, g, b, m, c, x;\n\n    h /= 60;\n    if (h < 0) h = 6 - (-h % 6);\n    h %= 6;\n\n    s = Math.max(0, Math.min(1, s / 100));\n    l = Math.max(0, Math.min(1, l / 100));\n\n    c = (1 - Math.abs((2 * l) - 1)) * s;\n    x = c * (1 - Math.abs((h % 2) - 1));\n\n    if (h < 1) {\n        r = c, g = x, b = 0;\n    } else if (h < 2) {\n        r = x, g = c, b = 0;\n    } else if (h < 3) {\n        r = 0, g = c, b = x;\n    } else if (h < 4) {\n        r = 0, g = x, b = c;\n    } else if (h < 5) {\n        r = x, g = 0, b = c;\n    } else {\n        r = c, g = 0, b = x;\n    }\n\n    m = l - c / 2\n    \n    return [(r + m),\n            (g + m),\n            (b + m)];\n}\n\n\nutils.getHashColor = function(str) {\n    var h = utils.getHash(str);\n    var c = utils.convertRGB2YCbCr(h&255,(h>>8)&255,(h>>16)&255);\n    c[0] = math.clamp(c[0], 50, 200);\n    return utils.convertRGB2YCbCr(c[0],c[1],c[2]);\n};\n\n\nutils.getHashColor2 = function(counter) {\n    var h = Math.floor(counter / 18);\n    var l = 50;\n\n    if (h >= 1) {\n        if (h % 2) {\n            l = 50 + ((l * 10) % 30);\n        } else {\n            l = 50 - (((l-1) * 10) % 30);\n        }\n     }\n\n    h = (counter % 18) * 20;\n\n    return utils.convertHSL2RGB(h,100,l);\n};\n\n\nutils.loadText = function(path, onLoaded, onError, withCredentials, xhrParams) {\n    utils.loadJSON(path, onLoaded, onError, true, withCredentials, xhrParams);\n};\n\n\nutils.loadXML = function(path, onLoaded, onError, withCredentials, xhrParams) {\n    var onLoaded2 = (function(data){\n        var parser = new DOMParser();\n        data = parser.parseFromString(data, 'text/xml');\n        if (onLoaded) {\n            onLoaded(data);\n        }\n    });\n\n    utils.loadJSON(path, onLoaded2, onError, true, withCredentials, xhrParams);\n};\n\n\nutils.loadJSON = function(path, onLoaded, onError, skipParse, withCredentials, xhrParams) {\n    var xhr = new XMLHttpRequest();\n\n    //xhr.onload  = (function() {\n    xhr.onreadystatechange = (function (){\n\n        switch (xhr.readyState) {\n        case 0 : // UNINITIALIZED\n        case 1 : // LOADING\n        case 2 : // LOADED\n        case 3 : // INTERACTIVE\n            break;\n        case 4 : // COMPLETED\n    \n            if (xhr.status >= 400 || xhr.status == 0) {\n                if (onError) {\n                    onError(xhr.status);\n                    console.log('JSON Load Error: path = '+path+' ; XHR status = ' + xhr.status);\n                }\n                break;\n            }\n    \n            var data = xhr.response;\n            var parsedData = data;\n                \n            if (!skipParse) {\n                try {\n                        //var parsedData = skipParse ? data : eval(\"(\"+data+\")\");\n                    parsedData = JSON.parse(data);\n                } catch(e) {\n                    // eslint-disable-next-line\n                    console.log('JSON Parse Error: path = '+path+' : ' + (e['message'] ? e['message'] : ''));\n                        \n                    if (onError ) {\n                        onError(xhr.status);\n                    }\n                \n                    return;\n                }\n            }\n                \n            if (onLoaded) {\n                onLoaded(parsedData);\n            }\n    \n            break;\n        }\n\n    }).bind(this);\n\n    /*\n    xhr.onerror  = (function() {\n        if (onError) {\n            onError();\n        }\n    }).bind(this);*/\n\n    xhr.open('GET',  path, true);\n    xhr.withCredentials = withCredentials;\n    \n    if (xhrParams && xhrParams['token'] /*&& xhrParams[\"tokenHeader\"]*/) {\n        //xhr.setRequestHeader(xhrParams[\"tokenHeader\"], xhrParams[\"token\"]); //old way\n        xhr.setRequestHeader('Accept', 'token/' + xhrParams['token'] + ', */*');\n    }\n\n    if (xhrParams && xhrParams['charset']) {\n        xhr.overrideMimeType('text/xml; charset=' + xhrParams['charset']);\n        //xhr.setRequestHeader('Content-type', xhrParams['Content-type']);\n    }\n    \n    xhr.send('');\n};\n\n\nutils.loadBinary = function(path, onLoaded, onError, withCredentials, xhrParams, responseType) {\n    var xhr = new XMLHttpRequest();\n\n    xhr.onreadystatechange = (function (){\n\n        switch (xhr.readyState) {\n        case 0 : // UNINITIALIZED\n        case 1 : // LOADING\n        case 2 : // LOADED\n        case 3 : // INTERACTIVE\n            break;\n        case 4 : // COMPLETED\n    \n            if (xhr.status >= 400 || xhr.status == 0) {\n                if (onError) {\n                    onError(xhr.status);\n                }\n                break;\n            }\n    \n            var abuffer = xhr.response;\n                    \n            if (!abuffer) {\n                if (onError) {\n                    onError();\n                }\n                break;\n            }\n                    \n                    //if (!responseType || responseType == \"arraybuffer\") {\n                        //var data = new DataView(abuffer);\n                    //} else {\n                      //  var data = abuffer;\n                    //}\n    \n            if (onLoaded) {\n                onLoaded(abuffer);\n            }\n    \n            break;\n    \n        default:\n    \n            if (onError) {\n                onError();\n            }\n    \n            break;\n        }\n\n    }).bind(this);\n    \n    /*\n    xhr.onerror  = (function() {\n        if (onError) {\n            onError();\n        }\n    }).bind(this);*/\n\n    xhr.open('GET', path, true);\n    xhr.responseType = responseType ? responseType : 'arraybuffer';\n    xhr.withCredentials = withCredentials;\n\n    if (xhrParams && xhrParams['token'] /*&& xhrParams[\"tokenHeader\"]*/) {\n        //xhr.setRequestHeader(xhrParams[\"tokenHeader\"], xhrParams[\"token\"]); //old way\n        xhr.setRequestHeader('Accept', 'token/' + xhrParams['token'] + ', */*');\n    }\n\n    xhr.send('');\n};\n\n\nutils.headRequest = function(url, onLoaded, onError, withCredentials, xhrParams) { \n    var xhr = new XMLHttpRequest();\n\n    xhr.onreadystatechange = (function (){\n\n        switch (xhr.readyState) {\n        case 0 : // UNINITIALIZED\n        case 1 : // LOADING\n        case 2 : // LOADED\n        case 3 : // INTERACTIVE\n            break;\n        case 4 : // COMPLETED\n            if (onLoaded != null) {\n                onLoaded(xhr.getAllResponseHeaders(), xhr.status);\n                    //onLoaded(xhr.getResponseHeader(\"X-VE-Tile-Info\"), xhr.status);\n            }\n            break;\n    \n        default:\n    \n            if (onError != null) {\n                onError();\n            }\n    \n            break;\n        }\n\n    }).bind(this);\n\n    xhr.onerror  = (function() {\n        if (onError != null) {\n            onError();\n        }\n    }).bind(this);\n\n    xhr.open('HEAD', url, true);\n    //xhr.responseType = responseType ? responseType : \"arraybuffer\";\n    xhr.withCredentials = withCredentials;\n\n    if (xhrParams && xhrParams['token'] /*&& xhrParams[\"tokenHeader\"]*/) {\n        //xhr.setRequestHeader(xhrParams[\"tokenHeader\"], xhrParams[\"token\"]); //old way\n        xhr.setRequestHeader('Accept', 'token/' + xhrParams['token'] + ', */*');\n    }\n\n    xhr.send('');\n};\n\n\nutils.loadImage = function(url, onload, onerror, withCredentials, direct) {\n    var image = new Image();\n    image.onerror = onerror;\n    image.onload = onload;\n\n    if (!direct){\n        image.crossOrigin = withCredentials ? 'use-credentials' : 'anonymous';\n    }\n\n    image.src = url;\n    return image;\n};\n\n\nutils.getParamsFromUrl = function(url) {\n    return utilsUrl.getParamsFromUrl(url);\n};\n\n\n//var textDecoderUtf8 = null; //(typeof TextDecoder !== 'undefined') ? (new TextDecoder('utf-8')) : null;\nvar textDecoderUtf8 = (typeof TextDecoder !== 'undefined') ? (new TextDecoder('utf-8')) : null;\n\nutils.unint8ArrayToString = function(array) {\n    if (textDecoderUtf8) {\n        return textDecoderUtf8.decode(array);\n    } else {\n//        return String.fromCharCode.apply(null, new Uint8Array(array.buffer));\n\n        /*\n        var buff = new Uint16Array(array.buffer, array.byteOffset, array.byteLength);\n        var getChar = String.fromCharCode;\n        //var buff2 = new Array(buff.length);\n        var str = '';\n\n        for (var i = 0, li = buff.length; i < li; i++) {\n            //buff2[i] = getChar(buff[i]);\n            str += getChar(buff[i]);\n        }\n\n        return str;\n        //return buff2.join('');\n        */\n\n        var s = '';\n        //var code_points2 = new Uint8Array(array.buffer, array.byteOffset, array.byteLength);\n        var code_points2 = new Uint8Array(array.byteLength);\n        code_points2.set(array);\n        var code_points = new Uint32Array(code_points2.buffer);\n\n        for (var i = 0, li = code_points.length; i < li; ++i) {\n          var cp = code_points[i];\n          if (cp <= 0xFFFF) {\n            s += String.fromCharCode(cp);\n          } else {\n            cp -= 0x10000;\n            s += String.fromCharCode((cp >> 10) + 0xD800,\n                                     (cp & 0x3FF) + 0xDC00);\n          }\n        }\n        return s;\n\n    }\n}\n\n\nexport {utils};\n\n// only implement if no native implementation is available\n/*\nif (typeof Array.isArray === 'undefined') {\n  Array.isArray = (function(obj) {\n    return Object.prototype.toString.call(obj) === '[object Array]';\n  });\n}*/\n","\nimport {mat4 as mat4_} from './matrix';\n\n//get rid of compiler mess\nvar mat4 = mat4_;\n\n\nvar math = {};\n\n\nmath.isEqual = function(value, value2, delta) {\n    return (Math.abs(value - value2) < delta);\n};\n\n\nmath.clamp = function(value, min, max) {\n    if (value < min) value = min;\n    else if (value > max) value = max;\n\n    return value;\n};\n\n\nmath.radians = function(degrees) {\n    return degrees * Math.PI / 180;\n};\n\n\nmath.degrees = function(radians) {\n    return (radians / Math.PI) * 180;\n};\n\n\nmath.mix = function(a, b, c) {\n    return a + (b - a) * c;\n};\n\n\nmath.frustumMatrix = function(left, right, bottom, top, near, far) {\n    var w = (right - left);\n    var h = (top - bottom);\n    var d = (far - near);\n\n    var m = mat4.create([2*near/w, 0, (right+left)/w, 0,\n        0, 2*near/h, (top+bottom)/h, 0,\n        0, 0, -(far+near)/d, -2*far*near/d,\n        0, 0, -1, 0]);\n\n    mat4.transpose(m);\n    return m;\n};\n\n\nmath.perspectiveMatrix = function(fovy, aspect, near, far) {\n    var ymax = near * Math.tan(fovy * Math.PI / 180.0);\n    var xmax = ymax * aspect;\n    return math.frustumMatrix(-xmax, xmax, -ymax, ymax, near, far);\n};\n\n\nmath.orthographicMatrix = function(vsize, aspect, near, far) {\n    //vsize *= 0.020;\n    var w = vsize* 0.5 * aspect;\n    var h = vsize * 0.5;\n    var d = (far - near);\n\n    var m = mat4.create([1/w, 0, 0, 0,\n        0, 1/h, 0, 0,\n        0, 0, -2/d, -((far+near)/d),\n        0, 0, 0, 1]);\n\n    mat4.transpose(m);\n    return m;\n};\n\n\nmath.rotationMatrix = function(axis, angle) {\n    var ca = Math.cos(angle), sa = Math.sin(angle);\n\n    /*    var m;\n    switch (axis) {\n    case 0:\n        m = [\n            1,  0,  0, 0,\n            0, ca,-sa, 0,\n            0, sa, ca, 0,\n            0,  0,  0, 1 ];\n        break;\n    case 1:\n        m = [\n            ca, 0,-sa, 0,\n            0, 1,  0,  0,\n            sa, 0, ca, 0,\n            0, 0,  0, 1 ];\n        break;\n    default:\n        m = [\n            ca,-sa, 0, 0,\n            sa, ca, 0, 0,\n            0,  0,  1, 0,\n            0,  0,  0, 1 ];\n        break;\n    }\n    mat4.transpose(m);\n    return m; */\n\n    switch (axis) {\n    case 0:\n        return [\n            1,   0,   0,  0,\n            0,  ca,  sa,  0,\n            0, -sa,  ca,  0,\n            0,   0,   0,  1 ];\n    case 1:\n        return [\n             ca,  0,  sa,  0,\n              0,  1,   0,  0,\n            -sa,  0,  ca,  0,\n              0,  0,   0,  1 ];\n    default:\n        return [\n             ca, sa,  0,  0,\n            -sa, ca,  0,  0,\n              0,  0,  1,  0,\n              0,  0,  0,  1 ];\n    }\n\n};\n\n\nmath.scaleMatrix = function(sx, sy, sz) {\n    /*var m = [\n        sx,  0,  0, 0,\n        0, sy,  0, 0,\n        0,  0, sz, 0,\n        0,  0,  0, 1 ];\n\n    mat4.transpose(m);\n    return m;*/\n    return [\n        sx,   0,   0,   0,\n        0,   sy,   0,   0,\n        0,    0,  sz,   0,\n        0,    0,   0,   1 ];\n};\n\n\nmath.scaleMatrixf = function(s) {\n    return math.scaleMatrix(s, s, s);\n};\n\n\nmath.translationMatrix = function(tx, ty, tz) {\n    /*\n    var m = [\n        1, 0, 0, tx,\n        0, 1, 0, ty,\n        0, 0, 1, tz,\n        0, 0, 0, 1 ];\n\n    mat4.transpose(m);\n    */\n\n    return [\n        1,   0,  0,  0,\n        0,   1,  0,  0,\n        0,   0,  1,  0,\n        tx, ty, tz,  1 ];\n};\n\n\nmath.translationMatrix2f = function(t) {\n    return math.translationMatrix(t[0], t[1], 0);\n};\n\n\nmath.translationMatrix3f = function(t) {\n    return math.translationMatrix(t[0], t[1], t[2]);\n};\n\n\nexport {math};\n","\nvar utilsUrl = {};\n\n\nutilsUrl.isSameOrigin = function(url) {\n    if (typeof url !== 'string') {\n        return false;\n    }\n    var docHost = document.location.hostname;\n    var parser = utilsUrl.parse(url);\n    return parser['hostname'] === docHost;\n};\n\n\nutilsUrl.parse = function(url) {\n    if (typeof url !== 'string') {\n        return null;\n    }\n\n    var parser = document.createElement('a');\n    parser['href'] = url;\n    return parser;\n};\n\n\nutilsUrl.getParamsFromUrl = function(url) {\n    var parser = utilsUrl.parse(url);\n    var queryString = {};\n    var query = parser['search'].substring(1);\n    var vars = query.split('&');\n    if (!(vars.length == 1 && vars[0] == '')) {\n        for (var i=0; i < vars.length; i++) {\n            var pair = vars[i].split('=');\n            if (typeof queryString[pair[0]] === 'undefined') {\n                queryString[pair[0]] = pair[1];\n            } else if (typeof queryString[pair[0]] === 'string') {\n                var arr = [ queryString[pair[0]], pair[1] ];\n                queryString[pair[0]] = arr;\n            } else {\n                queryString[pair[0]].push(pair[1]);\n            }\n        }\n    }\n    return queryString;\n};\n\n\nutilsUrl.getHost = function(url) {\n    var location = document.createElement('a');\n    location.href = url;\n    return location.hostname; \n};\n\n\nutilsUrl.getSchema = function(url) {\n    //if (window.location.href.indexOf(\"file://\") != -1) {\n    if (url.indexOf('http://') != -1) {\n        return 'http:';\n    } else if (url.indexOf('https://') != -1) {\n        return 'https:';\n    } else {\n        var location = document.createElement('a');\n        location.href = url;\n        return location.protocol;\n    }\n};\n\n\nutilsUrl.getOrigin = function(url) {\n    var location = document.createElement('a');\n    location.href = url;\n\n    if (!location.origin) {  //IE11 hack\n      return location.protocol + \"//\" + location.hostname + (location.port ? ':' + location.port: '');\n    }\n\n    return location.origin; \n};\n\n\nutilsUrl.getBase = function(url) {\n    return url.split('?')[0].split('/').slice(0, -1).join('/')+'/';\n};\n\n\nutilsUrl.makeAbsolute = function(href) {\n    var link = document.createElement(\"a\");\n    link.href = href;\n    return link.href;\n};\n\nutilsUrl.getProcessUrl = function(url, originUrl) {\n    if (!url || !originUrl) {\n        return url;\n    }\n\n    url = url.trim();\n    originUrl= originUrl.trim();\n    var baseUrl = utilsUrl.getBase(originUrl);\n    var baseUrlSchema = utilsUrl.getSchema(originUrl);\n    var baseUrlOrigin = utilsUrl.getOrigin(originUrl); \n   \n    if (url.indexOf('://') != -1) { //absolute\n        return url;\n    } else if (url.indexOf('//') == 0) {  //absolute without schema\n        return baseUrlSchema + url;\n    } else if (url.indexOf('/') == 0) {  //absolute without host\n        return baseUrlOrigin + url;\n    } else {  //relative\n        return baseUrl + url; \n    }\n};\n\n\nexport {utilsUrl};\n","\nvar platform = {\n\n    initialized : false,\n\n    init: function () {\n\n        var self = platform;\n\n        self.browser = self.searchString(self.dataBrowser) || 'An unknown browser';\n        self.version = self.searchVersion(navigator.userAgent.toLowerCase()) || self.searchVersion(navigator.appVersion) || 'an unknown version';\n        self.OS = self.searchString(self.dataOS) || 'an unknown os: ua: ' + navigator.userAgent + ' pl: ' + navigator.platform;\n\n        self.mobile = (self.OS == 'iphone/ipod' || self.OS == 'android' || self.OS == 'ipad' || self.OS == 'windows ce'  || self.OS == 'windows phone' || self.OS == 'kindle');\n        self.mobileAndroid = (self.OS == 'android');\n        self.initialized = true;\n    },\n\n    getBrowser : function() {\n        if(!platform.initialized) { platform.init(); }\n        return platform.browser;\n    },\n\n    getBrowserVersion : function() {\n        if(!platform.initialized) { platform.init(); }\n        return platform.browser;\n    },\n\n    getOS : function() {\n        if(!platform.initialized) { platform.init(); }\n        return platform.browser;\n    },\n\n    isMobile : function() {\n        if(!platform.initialized) { platform.init(); }\n        return platform.mobile;\n    },\n    \n    isAndroid : function() {\n        if(!platform.initialized) { platform.init(); }\n        return platform.mobileAndroid;\n    },\n\n    searchString: function (data) {\n        var self = platform;\n        for (var i=0; i<data.length; i++) {\n            var dataString = data[i].string;\n            var dataProp = data[i].prop;\n            self.versionSearchString = data[i].versionSearch || data[i].identity;\n\n            if (dataString) {\n                if (dataString.toLowerCase().indexOf(data[i].subString) != -1) {\n                    if (data[i].version != null) {\n                        self.version = data[i].version;\n                    }\n                    return data[i].identity;\n                }\n            } else if (dataProp) {\n                return data[i].identity;\n            }\n        }\n    },\n\n    searchVersion: function (dataString) {\n        var self = platform;\n        if (self.version != null) {\n            return self.version;\n        }\n        var index = dataString.indexOf(self.versionSearchString);\n        if (index == -1) return;\n        return parseFloat(dataString.substring(index+self.versionSearchString.length+1));\n    },\n\n    dataBrowser: [\n        {\n            string: navigator.userAgent,\n            subString: 'chrome',\n            identity: 'chrome'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'firefox',\n            identity: 'firefox'\n        },\n        {\n            string: navigator.vendor,\n            subString: 'apple',\n            identity: 'safari',\n            versionSearch: 'version'\n        },\n        {\n            prop: window.opera,\n            identity: 'opera',\n            versionSearch: 'version'\n        },\n        {\n            string: navigator.vendor,\n            subString: 'icab',\n            identity: 'icab'\n        },\n        {\n            string: navigator.vendor,\n            subString: 'kde',\n            identity: 'konqueror'\n        },\n        {\n            string: navigator.vendor,\n            subString: 'camino',\n            identity: 'camino'\n        },\n        {       // for newer Netscapes (6+)\n            string: navigator.userAgent,\n            subString: 'netscape',\n            identity: 'netscape'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'msie',\n            identity: 'explorer',\n            versionSearch: 'msie'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'trident/',\n            identity: 'explorer',\n            version: '11'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'edge/',\n            identity: 'explorer',\n            version: '12'\n        },\n        {   string: navigator.userAgent,\n            subString: 'omniweb',\n            versionSearch: 'omniweb/',\n            identity: 'omniweb'\n        },\n        {   string: navigator.userAgent,\n            subString: 'silk',\n            versionSearch: 'silk/',\n            identity: 'silk'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'gecko',\n            identity: 'mozilla',\n            versionSearch: 'rv'\n        },\n        {       // for older Netscapes (4-)\n            string: navigator.userAgent,\n            subString: 'mozilla',\n            identity: 'netscape',\n            versionSearch: 'mozilla'\n        }\n    ],\n\n    dataOS : [\n        {\n            string: navigator.userAgent,\n            subString: 'windows ce',\n            identity: 'windows ce'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'windows phone',\n            identity: 'windows phone'\n        },\n        {\n            string: navigator.platform,\n            subString: 'win',\n            identity: 'windows'\n        },\n        {\n            string: navigator.platform,\n            subString: 'mac',\n            identity: 'mac'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'iphone',\n            identity: 'iphone/ipod'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'ipod',\n            identity: 'iphone/ipod'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'ipad',\n            identity: 'ipad'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'android',\n            identity: 'android'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'silk',\n            identity: 'kindle'\n        },\n        {\n            string: navigator.userAgent,\n            subString: 'blackberry',\n            identity: 'blackberry'\n        },\n        {\n            string: navigator.platform,\n            subString: 'linux',\n            identity: 'linux'\n        }\n    ]\n\n};\n\nexport {platform};\n\n","/*\n * Geodesic routines from GeographicLib translated to JavaScript.  See\n * https://geographiclib.sourceforge.io/html/js/\n *\n * The algorithms are derived in\n *\n *    Charles F. F. Karney,\n *    Algorithms for geodesics, J. Geodesy 87, 43-55 (2013),\n *    https://doi.org/10.1007/s00190-012-0578-z\n *    Addenda: https://geographiclib.sourceforge.io/geod-addenda.html\n *\n * This file is the concatenation and compression of the JavaScript files in\n * doc/scripts/GeographicLib in the source tree for GeographicLib.\n *\n * Copyright (c) Charles Karney (2011-2015) <charles@karney.com> and licensed\n * under the MIT/X11 License.  For more information, see\n * https://geographiclib.sourceforge.io/\n *\n * Version: 1.50\n * File inventory:\n *   Math.js Geodesic.js GeodesicLine.js PolygonArea.js DMS.js\n */\n\n(function(cb) {\n\n/**************** Math.js ****************/\n/*\n * Math.js\n * Transcription of Math.hpp, Constants.hpp, and Accumulator.hpp into\n * JavaScript.\n *\n * Copyright (c) Charles Karney (2011-2019) <charles@karney.com> and licensed\n * under the MIT/X11 License.  For more information, see\n * https://geographiclib.sourceforge.io/\n */\n\n/**\n * @namespace GeographicLib\n * @description The parent namespace for the following modules:\n * - {@link module:GeographicLib/Geodesic GeographicLib/Geodesic} The main\n *   engine for solving geodesic problems via the\n *   {@link module:GeographicLib/Geodesic.Geodesic Geodesic} class.\n * - {@link module:GeographicLib/GeodesicLine GeographicLib/GeodesicLine}\n *   computes points along a single geodesic line via the\n *   {@link module:GeographicLib/GeodesicLine.GeodesicLine GeodesicLine}\n *   class.\n * - {@link module:GeographicLib/PolygonArea GeographicLib/PolygonArea}\n *   computes the area of a geodesic polygon via the\n *   {@link module:GeographicLib/PolygonArea.PolygonArea PolygonArea}\n *   class.\n * - {@link module:GeographicLib/DMS GeographicLib/DMS} handles the decoding\n *   and encoding of angles in degree, minutes, and seconds, via static\n *   functions in this module.\n * - {@link module:GeographicLib/Constants GeographicLib/Constants} defines\n *   constants specifying the version numbers and the parameters for the WGS84\n *   ellipsoid.\n *\n * The following modules are used internally by the package:\n * - {@link module:GeographicLib/Math GeographicLib/Math} defines various\n *   mathematical functions.\n * - {@link module:GeographicLib/Accumulator GeographicLib/Accumulator}\n *   interally used by\n *   {@link module:GeographicLib/PolygonArea.PolygonArea PolygonArea} (via the\n *   {@link module:GeographicLib/Accumulator.Accumulator Accumulator} class)\n *   for summing the contributions to the area of a polygon.\n */\n\"use strict\";\nvar GeographicLib = {};\nGeographicLib.Constants = {};\nGeographicLib.Math = {};\nGeographicLib.Accumulator = {};\n\n(function(\n  /**\n   * @exports GeographicLib/Constants\n   * @description Define constants defining the version and WGS84 parameters.\n   */\n  c) {\n\n  /**\n   * @constant\n   * @summary WGS84 parameters.\n   * @property {number} a the equatorial radius (meters).\n   * @property {number} f the flattening.\n   */\n  c.WGS84 = { a: 6378137, f: 1/298.257223563 };\n  /**\n   * @constant\n   * @summary an array of version numbers.\n   * @property {number} major the major version number.\n   * @property {number} minor the minor version number.\n   * @property {number} patch the patch number.\n   */\n  c.version = { major: 1, minor: 50, patch: 0 };\n  /**\n   * @constant\n   * @summary version string\n   */\n  c.version_string = \"1.50\";\n})(GeographicLib.Constants);\n\n(function(\n  /**\n   * @exports GeographicLib/Math\n   * @description Some useful mathematical constants and functions (mainly for\n   *   internal use).\n   */\n  m) {\n\n  /**\n   * @summary The number of digits of precision in floating-point numbers.\n   * @constant {number}\n   */\n  m.digits = 53;\n  /**\n   * @summary The machine epsilon.\n   * @constant {number}\n   */\n  m.epsilon = Math.pow(0.5, m.digits - 1);\n  /**\n   * @summary The factor to convert degrees to radians.\n   * @constant {number}\n   */\n  m.degree = Math.PI/180;\n\n  /**\n   * @summary Square a number.\n   * @param {number} x the number.\n   * @returns {number} the square.\n   */\n  m.sq = function(x) { return x * x; };\n\n  /**\n   * @summary The hypotenuse function.\n   * @param {number} x the first side.\n   * @param {number} y the second side.\n   * @returns {number} the hypotenuse.\n   */\n  m.hypot = Math.hypot || function(x, y) {\n    var a, b;\n    x = Math.abs(x);\n    y = Math.abs(y);\n    a = Math.max(x, y); b = Math.min(x, y) / (a ? a : 1);\n    return a * Math.sqrt(1 + b * b);\n  };\n\n  /**\n   * @summary Cube root function.\n   * @param {number} x the argument.\n   * @returns {number} the real cube root.\n   */\n  m.cbrt = Math.cbrt || function(x) {\n    var y = Math.pow(Math.abs(x), 1/3);\n    return x > 0 ? y : (x < 0 ? -y : x);\n  };\n\n  /**\n   * @summary The log1p function.\n   * @param {number} x the argument.\n   * @returns {number} log(1 + x).\n   */\n  m.log1p = Math.log1p || function(x) {\n    var y = 1 + x,\n        z = y - 1;\n    // Here's the explanation for this magic: y = 1 + z, exactly, and z\n    // approx x, thus log(y)/z (which is nearly constant near z = 0) returns\n    // a good approximation to the true log(1 + x)/x.  The multiplication x *\n    // (log(y)/z) introduces little additional error.\n    return z === 0 ? x : x * Math.log(y) / z;\n  };\n\n  /**\n   * @summary Inverse hyperbolic tangent.\n   * @param {number} x the argument.\n   * @returns {number} tanh<sup>&minus;1</sup> x.\n   */\n  m.atanh = Math.atanh || function(x) {\n    var y = Math.abs(x);          // Enforce odd parity\n    y = m.log1p(2 * y/(1 - y))/2;\n    return x > 0 ? y : (x < 0 ? -y : x);\n  };\n\n  /**\n   * @summary Copy the sign.\n   * @param {number} x gives the magitude of the result.\n   * @param {number} y gives the sign of the result.\n   * @returns {number} value with the magnitude of x and with the sign of y.\n   */\n  m.copysign = function(x, y) {\n    return Math.abs(x) * (y < 0 || (y === 0 && 1/y < 0) ? -1 : 1);\n  };\n\n  /**\n   * @summary An error-free sum.\n   * @param {number} u\n   * @param {number} v\n   * @returns {object} sum with sum.s = round(u + v) and sum.t is u + v &minus;\n   *   round(u + v)\n   */\n  m.sum = function(u, v) {\n    var s = u + v,\n        up = s - v,\n        vpp = s - up,\n        t;\n    up -= u;\n    vpp -= v;\n    t = -(up + vpp);\n    // u + v =       s      + t\n    //       = round(u + v) + t\n    return {s: s, t: t};\n  };\n\n  /**\n   * @summary Evaluate a polynomial.\n   * @param {integer} N the order of the polynomial.\n   * @param {array} p the coefficient array (of size N + 1) (leading\n   *   order coefficient first)\n   * @param {number} x the variable.\n   * @returns {number} the value of the polynomial.\n   */\n  m.polyval = function(N, p, s, x) {\n    var y = N < 0 ? 0 : p[s++];\n    while (--N >= 0) y = y * x + p[s++];\n    return y;\n  };\n\n  /**\n   * @summary Coarsen a value close to zero.\n   * @param {number} x\n   * @returns {number} the coarsened value.\n   */\n  m.AngRound = function(x) {\n    // The makes the smallest gap in x = 1/16 - nextafter(1/16, 0) = 1/2^57 for\n    // reals = 0.7 pm on the earth if x is an angle in degrees.  (This is about\n    // 1000 times more resolution than we get with angles around 90 degrees.)\n    // We use this to avoid having to deal with near singular cases when x is\n    // non-zero but tiny (e.g., 1.0e-200).  This converts -0 to +0; however\n    // tiny negative numbers get converted to -0.\n    if (x === 0) return x;\n    var z = 1/16,\n        y = Math.abs(x);\n    // The compiler mustn't \"simplify\" z - (z - y) to y\n    y = y < z ? z - (z - y) : y;\n    return x < 0 ? -y : y;\n  };\n\n  /**\n   * @summary The remainder function.\n   * @param {number} x the numerator of the division\n   * @param {number} y the denominator of the division\n   * @return {number} the remainder in the range [&minus;y/2, y/2].\n   * <p>\n   * The range of x is unrestricted; y must be positive.\n   */\n  m.remainder = function(x, y) {\n    x = x % y;\n    return x < -y/2 ? x + y : (x < y/2 ? x : x - y);\n  };\n\n  /**\n   * @summary Normalize an angle.\n   * @param {number} x the angle in degrees.\n   * @returns {number} the angle reduced to the range (&minus;180&deg;,\n   *   180&deg;].\n   */\n  m.AngNormalize = function(x) {\n    // Place angle in (-180, 180].\n    x = m.remainder(x, 360);\n    return x == -180 ? 180 : x;\n  };\n\n  /**\n   * @summary Normalize a latitude.\n   * @param {number} x the angle in degrees.\n   * @returns {number} x if it is in the range [&minus;90&deg;, 90&deg;],\n   *   otherwise return NaN.\n   */\n  m.LatFix = function(x) {\n    // Replace angle with NaN if outside [-90, 90].\n    return Math.abs(x) > 90 ? Number.NaN : x;\n  };\n\n  /**\n   * @summary The exact difference of two angles reduced to (&minus;180&deg;,\n   *   180&deg;]\n   * @param {number} x the first angle in degrees.\n   * @param {number} y the second angle in degrees.\n   * @return {object} diff the exact difference, y &minus; x.\n   *\n   * This computes z = y &minus; x exactly, reduced to (&minus;180&deg;,\n   * 180&deg;]; and then sets diff.s = d = round(z) and diff.t = e = z &minus;\n   * round(z).  If d = &minus;180, then e &gt; 0; If d = 180, then e &le; 0.\n   */\n  m.AngDiff = function(x, y) {\n    // Compute y - x and reduce to [-180,180] accurately.\n    var r = m.sum(m.AngNormalize(-x), m.AngNormalize(y)),\n        d = m.AngNormalize(r.s),\n        t = r.t;\n    return m.sum(d === 180 && t > 0 ? -180 : d, t);\n  };\n\n  /**\n   * @summary Evaluate the sine and cosine function with the argument in\n   *   degrees\n   * @param {number} x in degrees.\n   * @returns {object} r with r.s = sin(x) and r.c = cos(x).\n   */\n  m.sincosd = function(x) {\n    // In order to minimize round-off errors, this function exactly reduces\n    // the argument to the range [-45, 45] before converting it to radians.\n    var r, q, s, c, sinx, cosx;\n    r = x % 360;\n    q = 0 + Math.round(r / 90); // If r is NaN this returns NaN\n    r -= 90 * q;\n    // now abs(r) <= 45\n    r *= this.degree;\n    // Possibly could call the gnu extension sincos\n    s = Math.sin(r); c = Math.cos(r);\n    switch (q & 3) {\n      case 0:  sinx =  s; cosx =  c; break;\n      case 1:  sinx =  c; cosx = -s; break;\n      case 2:  sinx = -s; cosx = -c; break;\n      default: sinx = -c; cosx =  s; break; // case 3\n    }\n    if (x !== 0) { sinx += 0; cosx += 0; }\n    return {s: sinx, c: cosx};\n  };\n\n  /**\n   * @summary Evaluate the atan2 function with the result in degrees\n   * @param {number} y\n   * @param {number} x\n   * @returns atan2(y, x) in degrees, in the range (&minus;180&deg;\n   *   180&deg;].\n   */\n  m.atan2d = function(y, x) {\n    // In order to minimize round-off errors, this function rearranges the\n    // arguments so that result of atan2 is in the range [-pi/4, pi/4] before\n    // converting it to degrees and mapping the result to the correct\n    // quadrant.\n    var q = 0, t, ang;\n    if (Math.abs(y) > Math.abs(x)) { t = x; x = y; y = t; q = 2; }\n    if (x < 0) { x = -x; ++q; }\n    // here x >= 0 and x >= abs(y), so angle is in [-pi/4, pi/4]\n    ang = Math.atan2(y, x) / this.degree;\n    switch (q) {\n      // Note that atan2d(-0.0, 1.0) will return -0.  However, we expect that\n      // atan2d will not be called with y = -0.  If need be, include\n      //\n      //   case 0: ang = 0 + ang; break;\n      //\n      // and handle mpfr as in AngRound.\n      case 1: ang = (y >= 0 ? 180 : -180) - ang; break;\n      case 2: ang =  90 - ang; break;\n      case 3: ang = -90 + ang; break;\n    }\n    return ang;\n  };\n})(GeographicLib.Math);\n\n(function(\n  /**\n   * @exports GeographicLib/Accumulator\n   * @description Accurate summation via the\n   *   {@link module:GeographicLib/Accumulator.Accumulator Accumulator} class\n   *   (mainly for internal use).\n   */\n  a, m) {\n\n  /**\n   * @class\n   * @summary Accurate summation of many numbers.\n   * @classdesc This allows many numbers to be added together with twice the\n   *   normal precision.  In the documentation of the member functions, sum\n   *   stands for the value currently held in the accumulator.\n   * @param {number | Accumulator} [y = 0]  set sum = y.\n   */\n  a.Accumulator = function(y) {\n    this.Set(y);\n  };\n\n  /**\n   * @summary Set the accumulator to a number.\n   * @param {number | Accumulator} [y = 0] set sum = y.\n   */\n  a.Accumulator.prototype.Set = function(y) {\n    if (!y) y = 0;\n    if (y.constructor === a.Accumulator) {\n      this._s = y._s;\n      this._t = y._t;\n    } else {\n      this._s = y;\n      this._t = 0;\n    }\n  };\n\n  /**\n   * @summary Add a number to the accumulator.\n   * @param {number} [y = 0] set sum += y.\n   */\n  a.Accumulator.prototype.Add = function(y) {\n    // Here's Shewchuk's solution...\n    // Accumulate starting at least significant end\n    var u = m.sum(y, this._t),\n        v = m.sum(u.s, this._s);\n    u = u.t;\n    this._s = v.s;\n    this._t = v.t;\n    // Start is _s, _t decreasing and non-adjacent.  Sum is now (s + t + u)\n    // exactly with s, t, u non-adjacent and in decreasing order (except\n    // for possible zeros).  The following code tries to normalize the\n    // result.  Ideally, we want _s = round(s+t+u) and _u = round(s+t+u -\n    // _s).  The follow does an approximate job (and maintains the\n    // decreasing non-adjacent property).  Here are two \"failures\" using\n    // 3-bit floats:\n    //\n    // Case 1: _s is not equal to round(s+t+u) -- off by 1 ulp\n    // [12, -1] - 8 -> [4, 0, -1] -> [4, -1] = 3 should be [3, 0] = 3\n    //\n    // Case 2: _s+_t is not as close to s+t+u as it shold be\n    // [64, 5] + 4 -> [64, 8, 1] -> [64,  8] = 72 (off by 1)\n    //                    should be [80, -7] = 73 (exact)\n    //\n    // \"Fixing\" these problems is probably not worth the expense.  The\n    // representation inevitably leads to small errors in the accumulated\n    // values.  The additional errors illustrated here amount to 1 ulp of\n    // the less significant word during each addition to the Accumulator\n    // and an additional possible error of 1 ulp in the reported sum.\n    //\n    // Incidentally, the \"ideal\" representation described above is not\n    // canonical, because _s = round(_s + _t) may not be true.  For\n    // example, with 3-bit floats:\n    //\n    // [128, 16] + 1 -> [160, -16] -- 160 = round(145).\n    // But [160, 0] - 16 -> [128, 16] -- 128 = round(144).\n    //\n    if (this._s === 0)          // This implies t == 0,\n      this._s = u;              // so result is u\n    else\n      this._t += u;             // otherwise just accumulate u to t.\n  };\n\n  /**\n   * @summary Return the result of adding a number to sum (but\n   *   don't change sum).\n   * @param {number} [y = 0] the number to be added to the sum.\n   * @return sum + y.\n   */\n  a.Accumulator.prototype.Sum = function(y) {\n    var b;\n    if (!y)\n      return this._s;\n    else {\n      b = new a.Accumulator(this);\n      b.Add(y);\n      return b._s;\n    }\n  };\n\n  /**\n   * @summary Set sum = &minus;sum.\n   */\n  a.Accumulator.prototype.Negate = function() {\n    this._s *= -1;\n    this._t *= -1;\n  };\n\n  /**\n   * @summary Take the remainder\n   * @param {number} y the divisor of the remainder operation.\n   * @return sum in range [&minus;y/2, y/2].\n   */\n  a.Accumulator.prototype.Remainder = function(y) {\n    this._s = m.remainder(this._s, y);\n    this.Add(0);\n  };\n})(GeographicLib.Accumulator, GeographicLib.Math);\n\n/**************** Geodesic.js ****************/\n/*\n * Geodesic.js\n * Transcription of Geodesic.[ch]pp into JavaScript.\n *\n * See the documentation for the C++ class.  The conversion is a literal\n * conversion from C++.\n *\n * The algorithms are derived in\n *\n *    Charles F. F. Karney,\n *    Algorithms for geodesics, J. Geodesy 87, 43-55 (2013);\n *    https://doi.org/10.1007/s00190-012-0578-z\n *    Addenda: https://geographiclib.sourceforge.io/geod-addenda.html\n *\n * Copyright (c) Charles Karney (2011-2017) <charles@karney.com> and licensed\n * under the MIT/X11 License.  For more information, see\n * https://geographiclib.sourceforge.io/\n */\n\n// Load AFTER Math.js\n\nGeographicLib.Geodesic = {};\nGeographicLib.GeodesicLine = {};\nGeographicLib.PolygonArea = {};\n\n(function(\n  /**\n   * @exports GeographicLib/Geodesic\n   * @description Solve geodesic problems via the\n   *   {@link module:GeographicLib/Geodesic.Geodesic Geodesic} class.\n   */\n  g, l, p, m, c) {\n\n  var GEOGRAPHICLIB_GEODESIC_ORDER = 6,\n      nA1_ = GEOGRAPHICLIB_GEODESIC_ORDER,\n      nA2_ = GEOGRAPHICLIB_GEODESIC_ORDER,\n      nA3_ = GEOGRAPHICLIB_GEODESIC_ORDER,\n      nA3x_ = nA3_,\n      nC3x_, nC4x_,\n      maxit1_ = 20,\n      maxit2_ = maxit1_ + m.digits + 10,\n      tol0_ = m.epsilon,\n      tol1_ = 200 * tol0_,\n      tol2_ = Math.sqrt(tol0_),\n      tolb_ = tol0_ * tol1_,\n      xthresh_ = 1000 * tol2_,\n      CAP_NONE = 0,\n      CAP_ALL  = 0x1F,\n      CAP_MASK = CAP_ALL,\n      OUT_ALL  = 0x7F80,\n      astroid,\n      A1m1f_coeff, C1f_coeff, C1pf_coeff,\n      A2m1f_coeff, C2f_coeff,\n      A3_coeff, C3_coeff, C4_coeff;\n\n  g.tiny_ = Math.sqrt(Number.MIN_VALUE);\n  g.nC1_ = GEOGRAPHICLIB_GEODESIC_ORDER;\n  g.nC1p_ = GEOGRAPHICLIB_GEODESIC_ORDER;\n  g.nC2_ = GEOGRAPHICLIB_GEODESIC_ORDER;\n  g.nC3_ = GEOGRAPHICLIB_GEODESIC_ORDER;\n  g.nC4_ = GEOGRAPHICLIB_GEODESIC_ORDER;\n  nC3x_ = (g.nC3_ * (g.nC3_ - 1)) / 2;\n  nC4x_ = (g.nC4_ * (g.nC4_ + 1)) / 2;\n  g.CAP_C1   = 1<<0;\n  g.CAP_C1p  = 1<<1;\n  g.CAP_C2   = 1<<2;\n  g.CAP_C3   = 1<<3;\n  g.CAP_C4   = 1<<4;\n\n  g.NONE          = 0;\n  g.ARC           = 1<<6;\n  g.LATITUDE      = 1<<7  | CAP_NONE;\n  g.LONGITUDE     = 1<<8  | g.CAP_C3;\n  g.AZIMUTH       = 1<<9  | CAP_NONE;\n  g.DISTANCE      = 1<<10 | g.CAP_C1;\n  g.STANDARD      = g.LATITUDE | g.LONGITUDE | g.AZIMUTH | g.DISTANCE;\n  g.DISTANCE_IN   = 1<<11 | g.CAP_C1 | g.CAP_C1p;\n  g.REDUCEDLENGTH = 1<<12 | g.CAP_C1 | g.CAP_C2;\n  g.GEODESICSCALE = 1<<13 | g.CAP_C1 | g.CAP_C2;\n  g.AREA          = 1<<14 | g.CAP_C4;\n  g.ALL           = OUT_ALL| CAP_ALL;\n  g.LONG_UNROLL   = 1<<15;\n  g.OUT_MASK      = OUT_ALL| g.LONG_UNROLL;\n\n  g.SinCosSeries = function(sinp, sinx, cosx, c) {\n    // Evaluate\n    // y = sinp ? sum(c[i] * sin( 2*i    * x), i, 1, n) :\n    //            sum(c[i] * cos((2*i+1) * x), i, 0, n-1)\n    // using Clenshaw summation.  N.B. c[0] is unused for sin series\n    // Approx operation count = (n + 5) mult and (2 * n + 2) add\n    var k = c.length,           // Point to one beyond last element\n        n = k - (sinp ? 1 : 0),\n        ar = 2 * (cosx - sinx) * (cosx + sinx), // 2 * cos(2 * x)\n        y0 = n & 1 ? c[--k] : 0, y1 = 0;        // accumulators for sum\n    // Now n is even\n    n = Math.floor(n/2);\n    while (n--) {\n      // Unroll loop x 2, so accumulators return to their original role\n      y1 = ar * y0 - y1 + c[--k];\n      y0 = ar * y1 - y0 + c[--k];\n    }\n    return (sinp ? 2 * sinx * cosx * y0 : // sin(2 * x) * y0\n            cosx * (y0 - y1));            // cos(x) * (y0 - y1)\n  };\n\n  astroid = function(x, y) {\n    // Solve k^4+2*k^3-(x^2+y^2-1)*k^2-2*y^2*k-y^2 = 0 for positive\n    // root k.  This solution is adapted from Geocentric::Reverse.\n    var k,\n        p = m.sq(x),\n        q = m.sq(y),\n        r = (p + q - 1) / 6,\n        S, r2, r3, disc, u, T3, T, ang, v, uv, w;\n    if ( !(q === 0 && r <= 0) ) {\n      // Avoid possible division by zero when r = 0 by multiplying\n      // equations for s and t by r^3 and r, resp.\n      S = p * q / 4;            // S = r^3 * s\n      r2 = m.sq(r);\n      r3 = r * r2;\n      // The discriminant of the quadratic equation for T3.  This is\n      // zero on the evolute curve p^(1/3)+q^(1/3) = 1\n      disc = S * (S + 2 * r3);\n      u = r;\n      if (disc >= 0) {\n        T3 = S + r3;\n        // Pick the sign on the sqrt to maximize abs(T3).  This\n        // minimizes loss of precision due to cancellation.  The\n        // result is unchanged because of the way the T is used\n        // in definition of u.\n        T3 += T3 < 0 ? -Math.sqrt(disc) : Math.sqrt(disc);    // T3 = (r * t)^3\n        // N.B. cbrt always returns the real root.  cbrt(-8) = -2.\n        T = m.cbrt(T3);     // T = r * t\n        // T can be zero; but then r2 / T -> 0.\n        u += T + (T !== 0 ? r2 / T : 0);\n      } else {\n        // T is complex, but the way u is defined the result is real.\n        ang = Math.atan2(Math.sqrt(-disc), -(S + r3));\n        // There are three possible cube roots.  We choose the\n        // root which avoids cancellation.  Note that disc < 0\n        // implies that r < 0.\n        u += 2 * r * Math.cos(ang / 3);\n      }\n      v = Math.sqrt(m.sq(u) + q);       // guaranteed positive\n      // Avoid loss of accuracy when u < 0.\n      uv = u < 0 ? q / (v - u) : u + v; // u+v, guaranteed positive\n      w = (uv - q) / (2 * v);           // positive?\n      // Rearrange expression for k to avoid loss of accuracy due to\n      // subtraction.  Division by 0 not possible because uv > 0, w >= 0.\n      k = uv / (Math.sqrt(uv + m.sq(w)) + w); // guaranteed positive\n    } else {                                  // q == 0 && r <= 0\n      // y = 0 with |x| <= 1.  Handle this case directly.\n      // for y small, positive root is k = abs(y)/sqrt(1-x^2)\n      k = 0;\n    }\n    return k;\n  };\n\n  A1m1f_coeff = [\n    // (1-eps)*A1-1, polynomial in eps2 of order 3\n      +1, 4, 64, 0, 256\n  ];\n\n  // The scale factor A1-1 = mean value of (d/dsigma)I1 - 1\n  g.A1m1f = function(eps) {\n    var p = Math.floor(nA1_/2),\n        t = m.polyval(p, A1m1f_coeff, 0, m.sq(eps)) / A1m1f_coeff[p + 1];\n    return (t + eps) / (1 - eps);\n  };\n\n  C1f_coeff = [\n    // C1[1]/eps^1, polynomial in eps2 of order 2\n      -1, 6, -16, 32,\n    // C1[2]/eps^2, polynomial in eps2 of order 2\n      -9, 64, -128, 2048,\n    // C1[3]/eps^3, polynomial in eps2 of order 1\n      +9, -16, 768,\n    // C1[4]/eps^4, polynomial in eps2 of order 1\n      +3, -5, 512,\n    // C1[5]/eps^5, polynomial in eps2 of order 0\n      -7, 1280,\n    // C1[6]/eps^6, polynomial in eps2 of order 0\n      -7, 2048\n  ];\n\n  // The coefficients C1[l] in the Fourier expansion of B1\n  g.C1f = function(eps, c) {\n    var eps2 = m.sq(eps),\n        d = eps,\n        o = 0,\n        l, p;\n    for (l = 1; l <= g.nC1_; ++l) {     // l is index of C1p[l]\n      p = Math.floor((g.nC1_ - l) / 2); // order of polynomial in eps^2\n      c[l] = d * m.polyval(p, C1f_coeff, o, eps2) / C1f_coeff[o + p + 1];\n      o += p + 2;\n      d *= eps;\n    }\n  };\n\n  C1pf_coeff = [\n    // C1p[1]/eps^1, polynomial in eps2 of order 2\n      +205, -432, 768, 1536,\n    // C1p[2]/eps^2, polynomial in eps2 of order 2\n      +4005, -4736, 3840, 12288,\n    // C1p[3]/eps^3, polynomial in eps2 of order 1\n      -225, 116, 384,\n    // C1p[4]/eps^4, polynomial in eps2 of order 1\n      -7173, 2695, 7680,\n    // C1p[5]/eps^5, polynomial in eps2 of order 0\n      +3467, 7680,\n    // C1p[6]/eps^6, polynomial in eps2 of order 0\n      +38081, 61440\n  ];\n\n  // The coefficients C1p[l] in the Fourier expansion of B1p\n  g.C1pf = function(eps, c) {\n    var eps2 = m.sq(eps),\n        d = eps,\n        o = 0,\n        l, p;\n    for (l = 1; l <= g.nC1p_; ++l) {     // l is index of C1p[l]\n      p = Math.floor((g.nC1p_ - l) / 2); // order of polynomial in eps^2\n      c[l] = d * m.polyval(p, C1pf_coeff, o, eps2) / C1pf_coeff[o + p + 1];\n      o += p + 2;\n      d *= eps;\n    }\n  };\n\n  A2m1f_coeff = [\n    // (eps+1)*A2-1, polynomial in eps2 of order 3\n      -11, -28, -192, 0, 256\n  ];\n\n  // The scale factor A2-1 = mean value of (d/dsigma)I2 - 1\n  g.A2m1f = function(eps) {\n    var p = Math.floor(nA2_/2),\n        t = m.polyval(p, A2m1f_coeff, 0, m.sq(eps)) / A2m1f_coeff[p + 1];\n    return (t - eps) / (1 + eps);\n  };\n\n  C2f_coeff = [\n    // C2[1]/eps^1, polynomial in eps2 of order 2\n      +1, 2, 16, 32,\n    // C2[2]/eps^2, polynomial in eps2 of order 2\n      +35, 64, 384, 2048,\n    // C2[3]/eps^3, polynomial in eps2 of order 1\n      +15, 80, 768,\n    // C2[4]/eps^4, polynomial in eps2 of order 1\n      +7, 35, 512,\n    // C2[5]/eps^5, polynomial in eps2 of order 0\n      +63, 1280,\n    // C2[6]/eps^6, polynomial in eps2 of order 0\n      +77, 2048\n  ];\n\n  // The coefficients C2[l] in the Fourier expansion of B2\n  g.C2f = function(eps, c) {\n    var eps2 = m.sq(eps),\n        d = eps,\n        o = 0,\n        l, p;\n    for (l = 1; l <= g.nC2_; ++l) {     // l is index of C2[l]\n      p = Math.floor((g.nC2_ - l) / 2); // order of polynomial in eps^2\n      c[l] = d * m.polyval(p, C2f_coeff, o, eps2) / C2f_coeff[o + p + 1];\n      o += p + 2;\n      d *= eps;\n    }\n  };\n\n  /**\n   * @class\n   * @property {number} a the equatorial radius (meters).\n   * @property {number} f the flattening.\n   * @summary Initialize a Geodesic object for a specific ellipsoid.\n   * @classdesc Performs geodesic calculations on an ellipsoid of revolution.\n   *   The routines for solving the direct and inverse problems return an\n   *   object with some of the following fields set: lat1, lon1, azi1, lat2,\n   *   lon2, azi2, s12, a12, m12, M12, M21, S12.  See {@tutorial 2-interface},\n   *   \"The results\".\n   * @example\n   * var GeographicLib = require(\"geographiclib\"),\n   *     geod = GeographicLib.Geodesic.WGS84;\n   * var inv = geod.Inverse(1,2,3,4);\n   * console.log(\"lat1 = \" + inv.lat1 + \", lon1 = \" + inv.lon1 +\n   *             \", lat2 = \" + inv.lat2 + \", lon2 = \" + inv.lon2 +\n   *             \",\\nazi1 = \" + inv.azi1 + \", azi2 = \" + inv.azi2 +\n   *             \", s12 = \" + inv.s12);\n   * @param {number} a the equatorial radius of the ellipsoid (meters).\n   * @param {number} f the flattening of the ellipsoid.  Setting f = 0 gives\n   *   a sphere (on which geodesics are great circles).  Negative f gives a\n   *   prolate ellipsoid.\n   * @throws an error if the parameters are illegal.\n   */\n  g.Geodesic = function(a, f) {\n    this.a = a;\n    this.f = f;\n    this._f1 = 1 - this.f;\n    this._e2 = this.f * (2 - this.f);\n    this._ep2 = this._e2 / m.sq(this._f1); // e2 / (1 - e2)\n    this._n = this.f / ( 2 - this.f);\n    this._b = this.a * this._f1;\n    // authalic radius squared\n    this._c2 = (m.sq(this.a) + m.sq(this._b) *\n                (this._e2 === 0 ? 1 :\n                 (this._e2 > 0 ? m.atanh(Math.sqrt(this._e2)) :\n                  Math.atan(Math.sqrt(-this._e2))) /\n                 Math.sqrt(Math.abs(this._e2))))/2;\n    // The sig12 threshold for \"really short\".  Using the auxiliary sphere\n    // solution with dnm computed at (bet1 + bet2) / 2, the relative error in\n    // the azimuth consistency check is sig12^2 * abs(f) * min(1, 1-f/2) / 2.\n    // (Error measured for 1/100 < b/a < 100 and abs(f) >= 1/1000.  For a given\n    // f and sig12, the max error occurs for lines near the pole.  If the old\n    // rule for computing dnm = (dn1 + dn2)/2 is used, then the error increases\n    // by a factor of 2.)  Setting this equal to epsilon gives sig12 = etol2.\n    // Here 0.1 is a safety factor (error decreased by 100) and max(0.001,\n    // abs(f)) stops etol2 getting too large in the nearly spherical case.\n    this._etol2 = 0.1 * tol2_ /\n      Math.sqrt( Math.max(0.001, Math.abs(this.f)) *\n                 Math.min(1.0, 1 - this.f/2) / 2 );\n    if (!(isFinite(this.a) && this.a > 0))\n      throw new Error(\"Equatorial radius is not positive\");\n    if (!(isFinite(this._b) && this._b > 0))\n      throw new Error(\"Polar semi-axis is not positive\");\n    this._A3x = new Array(nA3x_);\n    this._C3x = new Array(nC3x_);\n    this._C4x = new Array(nC4x_);\n    this.A3coeff();\n    this.C3coeff();\n    this.C4coeff();\n  };\n\n  A3_coeff = [\n    // A3, coeff of eps^5, polynomial in n of order 0\n      -3, 128,\n    // A3, coeff of eps^4, polynomial in n of order 1\n      -2, -3, 64,\n    // A3, coeff of eps^3, polynomial in n of order 2\n      -1, -3, -1, 16,\n    // A3, coeff of eps^2, polynomial in n of order 2\n      +3, -1, -2, 8,\n    // A3, coeff of eps^1, polynomial in n of order 1\n      +1, -1, 2,\n    // A3, coeff of eps^0, polynomial in n of order 0\n      +1, 1\n  ];\n\n  // The scale factor A3 = mean value of (d/dsigma)I3\n  g.Geodesic.prototype.A3coeff = function() {\n    var o = 0, k = 0,\n        j, p;\n    for (j = nA3_ - 1; j >= 0; --j) { // coeff of eps^j\n      p = Math.min(nA3_ - j - 1, j);  // order of polynomial in n\n      this._A3x[k++] = m.polyval(p, A3_coeff, o, this._n) /\n        A3_coeff[o + p + 1];\n      o += p + 2;\n    }\n  };\n\n  C3_coeff = [\n    // C3[1], coeff of eps^5, polynomial in n of order 0\n      +3, 128,\n    // C3[1], coeff of eps^4, polynomial in n of order 1\n      +2, 5, 128,\n    // C3[1], coeff of eps^3, polynomial in n of order 2\n      -1, 3, 3, 64,\n    // C3[1], coeff of eps^2, polynomial in n of order 2\n      -1, 0, 1, 8,\n    // C3[1], coeff of eps^1, polynomial in n of order 1\n      -1, 1, 4,\n    // C3[2], coeff of eps^5, polynomial in n of order 0\n      +5, 256,\n    // C3[2], coeff of eps^4, polynomial in n of order 1\n      +1, 3, 128,\n    // C3[2], coeff of eps^3, polynomial in n of order 2\n      -3, -2, 3, 64,\n    // C3[2], coeff of eps^2, polynomial in n of order 2\n      +1, -3, 2, 32,\n    // C3[3], coeff of eps^5, polynomial in n of order 0\n      +7, 512,\n    // C3[3], coeff of eps^4, polynomial in n of order 1\n      -10, 9, 384,\n    // C3[3], coeff of eps^3, polynomial in n of order 2\n      +5, -9, 5, 192,\n    // C3[4], coeff of eps^5, polynomial in n of order 0\n      +7, 512,\n    // C3[4], coeff of eps^4, polynomial in n of order 1\n      -14, 7, 512,\n    // C3[5], coeff of eps^5, polynomial in n of order 0\n      +21, 2560\n  ];\n\n  // The coefficients C3[l] in the Fourier expansion of B3\n  g.Geodesic.prototype.C3coeff = function() {\n    var o = 0, k = 0,\n        l, j, p;\n    for (l = 1; l < g.nC3_; ++l) {        // l is index of C3[l]\n      for (j = g.nC3_ - 1; j >= l; --j) { // coeff of eps^j\n        p = Math.min(g.nC3_ - j - 1, j);  // order of polynomial in n\n        this._C3x[k++] = m.polyval(p, C3_coeff, o, this._n) /\n          C3_coeff[o + p + 1];\n        o += p + 2;\n      }\n    }\n  };\n\n  C4_coeff = [\n    // C4[0], coeff of eps^5, polynomial in n of order 0\n      +97, 15015,\n    // C4[0], coeff of eps^4, polynomial in n of order 1\n      +1088, 156, 45045,\n    // C4[0], coeff of eps^3, polynomial in n of order 2\n      -224, -4784, 1573, 45045,\n    // C4[0], coeff of eps^2, polynomial in n of order 3\n      -10656, 14144, -4576, -858, 45045,\n    // C4[0], coeff of eps^1, polynomial in n of order 4\n      +64, 624, -4576, 6864, -3003, 15015,\n    // C4[0], coeff of eps^0, polynomial in n of order 5\n      +100, 208, 572, 3432, -12012, 30030, 45045,\n    // C4[1], coeff of eps^5, polynomial in n of order 0\n      +1, 9009,\n    // C4[1], coeff of eps^4, polynomial in n of order 1\n      -2944, 468, 135135,\n    // C4[1], coeff of eps^3, polynomial in n of order 2\n      +5792, 1040, -1287, 135135,\n    // C4[1], coeff of eps^2, polynomial in n of order 3\n      +5952, -11648, 9152, -2574, 135135,\n    // C4[1], coeff of eps^1, polynomial in n of order 4\n      -64, -624, 4576, -6864, 3003, 135135,\n    // C4[2], coeff of eps^5, polynomial in n of order 0\n      +8, 10725,\n    // C4[2], coeff of eps^4, polynomial in n of order 1\n      +1856, -936, 225225,\n    // C4[2], coeff of eps^3, polynomial in n of order 2\n      -8448, 4992, -1144, 225225,\n    // C4[2], coeff of eps^2, polynomial in n of order 3\n      -1440, 4160, -4576, 1716, 225225,\n    // C4[3], coeff of eps^5, polynomial in n of order 0\n      -136, 63063,\n    // C4[3], coeff of eps^4, polynomial in n of order 1\n      +1024, -208, 105105,\n    // C4[3], coeff of eps^3, polynomial in n of order 2\n      +3584, -3328, 1144, 315315,\n    // C4[4], coeff of eps^5, polynomial in n of order 0\n      -128, 135135,\n    // C4[4], coeff of eps^4, polynomial in n of order 1\n      -2560, 832, 405405,\n    // C4[5], coeff of eps^5, polynomial in n of order 0\n      +128, 99099\n  ];\n\n  g.Geodesic.prototype.C4coeff = function() {\n    var o = 0, k = 0,\n        l, j, p;\n    for (l = 0; l < g.nC4_; ++l) {        // l is index of C4[l]\n      for (j = g.nC4_ - 1; j >= l; --j) { // coeff of eps^j\n        p = g.nC4_ - j - 1;               // order of polynomial in n\n        this._C4x[k++] = m.polyval(p, C4_coeff, o, this._n) /\n          C4_coeff[o + p + 1];\n        o += p + 2;\n      }\n    }\n  };\n\n  g.Geodesic.prototype.A3f = function(eps) {\n    // Evaluate A3\n    return m.polyval(nA3x_ - 1, this._A3x, 0, eps);\n  };\n\n  g.Geodesic.prototype.C3f = function(eps, c) {\n    // Evaluate C3 coeffs\n    // Elements c[1] thru c[nC3_ - 1] are set\n    var mult = 1,\n        o = 0,\n        l, p;\n    for (l = 1; l < g.nC3_; ++l) { // l is index of C3[l]\n      p = g.nC3_ - l - 1;          // order of polynomial in eps\n      mult *= eps;\n      c[l] = mult * m.polyval(p, this._C3x, o, eps);\n      o += p + 1;\n    }\n  };\n\n  g.Geodesic.prototype.C4f = function(eps, c) {\n    // Evaluate C4 coeffs\n    // Elements c[0] thru c[g.nC4_ - 1] are set\n    var mult = 1,\n        o = 0,\n        l, p;\n    for (l = 0; l < g.nC4_; ++l) { // l is index of C4[l]\n      p = g.nC4_ - l - 1;          // order of polynomial in eps\n      c[l] = mult * m.polyval(p, this._C4x, o, eps);\n      o += p + 1;\n      mult *= eps;\n    }\n  };\n\n  // return s12b, m12b, m0, M12, M21\n  g.Geodesic.prototype.Lengths = function(eps, sig12,\n                                          ssig1, csig1, dn1, ssig2, csig2, dn2,\n                                          cbet1, cbet2, outmask,\n                                          C1a, C2a) {\n    // Return m12b = (reduced length)/_b; also calculate s12b =\n    // distance/_b, and m0 = coefficient of secular term in\n    // expression for reduced length.\n    outmask &= g.OUT_MASK;\n    var vals = {},\n        m0x = 0, J12 = 0, A1 = 0, A2 = 0,\n        B1, B2, l, csig12, t;\n    if (outmask & (g.DISTANCE | g.REDUCEDLENGTH | g.GEODESICSCALE)) {\n      A1 = g.A1m1f(eps);\n      g.C1f(eps, C1a);\n      if (outmask & (g.REDUCEDLENGTH | g.GEODESICSCALE)) {\n        A2 = g.A2m1f(eps);\n        g.C2f(eps, C2a);\n        m0x = A1 - A2;\n        A2 = 1 + A2;\n      }\n      A1 = 1 + A1;\n    }\n    if (outmask & g.DISTANCE) {\n      B1 = g.SinCosSeries(true, ssig2, csig2, C1a) -\n        g.SinCosSeries(true, ssig1, csig1, C1a);\n      // Missing a factor of _b\n      vals.s12b = A1 * (sig12 + B1);\n      if (outmask & (g.REDUCEDLENGTH | g.GEODESICSCALE)) {\n        B2 = g.SinCosSeries(true, ssig2, csig2, C2a) -\n          g.SinCosSeries(true, ssig1, csig1, C2a);\n        J12 = m0x * sig12 + (A1 * B1 - A2 * B2);\n      }\n    } else if (outmask & (g.REDUCEDLENGTH | g.GEODESICSCALE)) {\n      // Assume here that nC1_ >= nC2_\n      for (l = 1; l <= g.nC2_; ++l)\n        C2a[l] = A1 * C1a[l] - A2 * C2a[l];\n      J12 = m0x * sig12 + (g.SinCosSeries(true, ssig2, csig2, C2a) -\n                           g.SinCosSeries(true, ssig1, csig1, C2a));\n    }\n    if (outmask & g.REDUCEDLENGTH) {\n      vals.m0 = m0x;\n      // Missing a factor of _b.\n      // Add parens around (csig1 * ssig2) and (ssig1 * csig2) to ensure\n      // accurate cancellation in the case of coincident points.\n      vals.m12b = dn2 * (csig1 * ssig2) - dn1 * (ssig1 * csig2) -\n        csig1 * csig2 * J12;\n    }\n    if (outmask & g.GEODESICSCALE) {\n      csig12 = csig1 * csig2 + ssig1 * ssig2;\n      t = this._ep2 * (cbet1 - cbet2) * (cbet1 + cbet2) / (dn1 + dn2);\n      vals.M12 = csig12 + (t * ssig2 - csig2 * J12) * ssig1 / dn1;\n      vals.M21 = csig12 - (t * ssig1 - csig1 * J12) * ssig2 / dn2;\n    }\n    return vals;\n  };\n\n  // return sig12, salp1, calp1, salp2, calp2, dnm\n  g.Geodesic.prototype.InverseStart = function(sbet1, cbet1, dn1,\n                                               sbet2, cbet2, dn2,\n                                               lam12, slam12, clam12,\n                                               C1a, C2a) {\n    // Return a starting point for Newton's method in salp1 and calp1\n    // (function value is -1).  If Newton's method doesn't need to be\n    // used, return also salp2 and calp2 and function value is sig12.\n    // salp2, calp2 only updated if return val >= 0.\n    var vals = {},\n        // bet12 = bet2 - bet1 in [0, pi); bet12a = bet2 + bet1 in (-pi, 0]\n        sbet12 = sbet2 * cbet1 - cbet2 * sbet1,\n        cbet12 = cbet2 * cbet1 + sbet2 * sbet1,\n        sbet12a, shortline, omg12, sbetm2, somg12, comg12, t, ssig12, csig12,\n        x, y, lamscale, betscale, k2, eps, cbet12a, bet12a, m12b, m0, nvals,\n        k, omg12a, lam12x;\n    vals.sig12 = -1;        // Return value\n    // Volatile declaration needed to fix inverse cases\n    // 88.202499451857 0 -88.202499451857 179.981022032992859592\n    // 89.262080389218 0 -89.262080389218 179.992207982775375662\n    // 89.333123580033 0 -89.333123580032997687 179.99295812360148422\n    // which otherwise fail with g++ 4.4.4 x86 -O3\n    sbet12a = sbet2 * cbet1;\n    sbet12a += cbet2 * sbet1;\n\n    shortline = cbet12 >= 0 && sbet12 < 0.5 && cbet2 * lam12 < 0.5;\n    if (shortline) {\n      sbetm2 = m.sq(sbet1 + sbet2);\n      // sin((bet1+bet2)/2)^2\n      // =  (sbet1 + sbet2)^2 / ((sbet1 + sbet2)^2 + (cbet1 + cbet2)^2)\n      sbetm2 /= sbetm2 + m.sq(cbet1 + cbet2);\n      vals.dnm = Math.sqrt(1 + this._ep2 * sbetm2);\n      omg12 = lam12 / (this._f1 * vals.dnm);\n      somg12 = Math.sin(omg12); comg12 = Math.cos(omg12);\n    } else {\n      somg12 = slam12; comg12 = clam12;\n    }\n\n    vals.salp1 = cbet2 * somg12;\n    vals.calp1 = comg12 >= 0 ?\n      sbet12 + cbet2 * sbet1 * m.sq(somg12) / (1 + comg12) :\n      sbet12a - cbet2 * sbet1 * m.sq(somg12) / (1 - comg12);\n\n    ssig12 = m.hypot(vals.salp1, vals.calp1);\n    csig12 = sbet1 * sbet2 + cbet1 * cbet2 * comg12;\n    if (shortline && ssig12 < this._etol2) {\n      // really short lines\n      vals.salp2 = cbet1 * somg12;\n      vals.calp2 = sbet12 - cbet1 * sbet2 *\n        (comg12 >= 0 ? m.sq(somg12) / (1 + comg12) : 1 - comg12);\n      // norm(vals.salp2, vals.calp2);\n      t = m.hypot(vals.salp2, vals.calp2); vals.salp2 /= t; vals.calp2 /= t;\n      // Set return value\n      vals.sig12 = Math.atan2(ssig12, csig12);\n    } else if (Math.abs(this._n) > 0.1 || // Skip astroid calc if too eccentric\n               csig12 >= 0 ||\n               ssig12 >= 6 * Math.abs(this._n) * Math.PI * m.sq(cbet1)) {\n      // Nothing to do, zeroth order spherical approximation is OK\n    } else {\n      // Scale lam12 and bet2 to x, y coordinate system where antipodal\n      // point is at origin and singular point is at y = 0, x = -1.\n      lam12x = Math.atan2(-slam12, -clam12); // lam12 - pi\n      if (this.f >= 0) {       // In fact f == 0 does not get here\n        // x = dlong, y = dlat\n        k2 = m.sq(sbet1) * this._ep2;\n        eps = k2 / (2 * (1 + Math.sqrt(1 + k2)) + k2);\n        lamscale = this.f * cbet1 * this.A3f(eps) * Math.PI;\n        betscale = lamscale * cbet1;\n\n        x = lam12x / lamscale;\n        y = sbet12a / betscale;\n      } else {                  // f < 0\n        // x = dlat, y = dlong\n        cbet12a = cbet2 * cbet1 - sbet2 * sbet1;\n        bet12a = Math.atan2(sbet12a, cbet12a);\n        // In the case of lon12 = 180, this repeats a calculation made\n        // in Inverse.\n        nvals = this.Lengths(this._n, Math.PI + bet12a,\n                             sbet1, -cbet1, dn1, sbet2, cbet2, dn2,\n                             cbet1, cbet2, g.REDUCEDLENGTH, C1a, C2a);\n        m12b = nvals.m12b; m0 = nvals.m0;\n        x = -1 + m12b / (cbet1 * cbet2 * m0 * Math.PI);\n        betscale = x < -0.01 ? sbet12a / x :\n          -this.f * m.sq(cbet1) * Math.PI;\n        lamscale = betscale / cbet1;\n        y = lam12 / lamscale;\n      }\n\n      if (y > -tol1_ && x > -1 - xthresh_) {\n        // strip near cut\n        if (this.f >= 0) {\n          vals.salp1 = Math.min(1, -x);\n          vals.calp1 = -Math.sqrt(1 - m.sq(vals.salp1));\n        } else {\n          vals.calp1 = Math.max(x > -tol1_ ? 0 : -1, x);\n          vals.salp1 = Math.sqrt(1 - m.sq(vals.calp1));\n        }\n      } else {\n        // Estimate alp1, by solving the astroid problem.\n        //\n        // Could estimate alpha1 = theta + pi/2, directly, i.e.,\n        //   calp1 = y/k; salp1 = -x/(1+k);  for f >= 0\n        //   calp1 = x/(1+k); salp1 = -y/k;  for f < 0 (need to check)\n        //\n        // However, it's better to estimate omg12 from astroid and use\n        // spherical formula to compute alp1.  This reduces the mean number of\n        // Newton iterations for astroid cases from 2.24 (min 0, max 6) to 2.12\n        // (min 0 max 5).  The changes in the number of iterations are as\n        // follows:\n        //\n        // change percent\n        //    1       5\n        //    0      78\n        //   -1      16\n        //   -2       0.6\n        //   -3       0.04\n        //   -4       0.002\n        //\n        // The histogram of iterations is (m = number of iterations estimating\n        // alp1 directly, n = number of iterations estimating via omg12, total\n        // number of trials = 148605):\n        //\n        //  iter    m      n\n        //    0   148    186\n        //    1 13046  13845\n        //    2 93315 102225\n        //    3 36189  32341\n        //    4  5396      7\n        //    5   455      1\n        //    6    56      0\n        //\n        // Because omg12 is near pi, estimate work with omg12a = pi - omg12\n        k = astroid(x, y);\n        omg12a = lamscale * ( this.f >= 0 ? -x * k/(1 + k) : -y * (1 + k)/k );\n        somg12 = Math.sin(omg12a); comg12 = -Math.cos(omg12a);\n        // Update spherical estimate of alp1 using omg12 instead of\n        // lam12\n        vals.salp1 = cbet2 * somg12;\n        vals.calp1 = sbet12a -\n          cbet2 * sbet1 * m.sq(somg12) / (1 - comg12);\n      }\n    }\n    // Sanity check on starting guess.  Backwards check allows NaN through.\n    if (!(vals.salp1 <= 0.0)) {\n      // norm(vals.salp1, vals.calp1);\n      t = m.hypot(vals.salp1, vals.calp1); vals.salp1 /= t; vals.calp1 /= t;\n    } else {\n      vals.salp1 = 1; vals.calp1 = 0;\n    }\n    return vals;\n  };\n\n  // return lam12, salp2, calp2, sig12, ssig1, csig1, ssig2, csig2, eps,\n  // domg12, dlam12,\n  g.Geodesic.prototype.Lambda12 = function(sbet1, cbet1, dn1,\n                                           sbet2, cbet2, dn2,\n                                           salp1, calp1, slam120, clam120,\n                                           diffp, C1a, C2a, C3a) {\n    var vals = {},\n        t, salp0, calp0,\n        somg1, comg1, somg2, comg2, somg12, comg12, B312, eta, k2, nvals;\n    if (sbet1 === 0 && calp1 === 0)\n      // Break degeneracy of equatorial line.  This case has already been\n      // handled.\n      calp1 = -g.tiny_;\n\n    // sin(alp1) * cos(bet1) = sin(alp0)\n    salp0 = salp1 * cbet1;\n    calp0 = m.hypot(calp1, salp1 * sbet1); // calp0 > 0\n\n    // tan(bet1) = tan(sig1) * cos(alp1)\n    // tan(omg1) = sin(alp0) * tan(sig1) = tan(omg1)=tan(alp1)*sin(bet1)\n    vals.ssig1 = sbet1; somg1 = salp0 * sbet1;\n    vals.csig1 = comg1 = calp1 * cbet1;\n    // norm(vals.ssig1, vals.csig1);\n    t = m.hypot(vals.ssig1, vals.csig1); vals.ssig1 /= t; vals.csig1 /= t;\n    // norm(somg1, comg1); -- don't need to normalize!\n\n    // Enforce symmetries in the case abs(bet2) = -bet1.  Need to be careful\n    // about this case, since this can yield singularities in the Newton\n    // iteration.\n    // sin(alp2) * cos(bet2) = sin(alp0)\n    vals.salp2 = cbet2 !== cbet1 ? salp0 / cbet2 : salp1;\n    // calp2 = sqrt(1 - sq(salp2))\n    //       = sqrt(sq(calp0) - sq(sbet2)) / cbet2\n    // and subst for calp0 and rearrange to give (choose positive sqrt\n    // to give alp2 in [0, pi/2]).\n    vals.calp2 = cbet2 !== cbet1 || Math.abs(sbet2) !== -sbet1 ?\n      Math.sqrt(m.sq(calp1 * cbet1) + (cbet1 < -sbet1 ?\n                                       (cbet2 - cbet1) * (cbet1 + cbet2) :\n                                       (sbet1 - sbet2) * (sbet1 + sbet2))) /\n      cbet2 : Math.abs(calp1);\n    // tan(bet2) = tan(sig2) * cos(alp2)\n    // tan(omg2) = sin(alp0) * tan(sig2).\n    vals.ssig2 = sbet2; somg2 = salp0 * sbet2;\n    vals.csig2 = comg2 = vals.calp2 * cbet2;\n    // norm(vals.ssig2, vals.csig2);\n    t = m.hypot(vals.ssig2, vals.csig2); vals.ssig2 /= t; vals.csig2 /= t;\n    // norm(somg2, comg2); -- don't need to normalize!\n\n    // sig12 = sig2 - sig1, limit to [0, pi]\n    vals.sig12 = Math.atan2(Math.max(0, vals.csig1 * vals.ssig2 -\n                                        vals.ssig1 * vals.csig2),\n                                        vals.csig1 * vals.csig2 +\n                                        vals.ssig1 * vals.ssig2);\n\n    // omg12 = omg2 - omg1, limit to [0, pi]\n    somg12 = Math.max(0, comg1 * somg2 - somg1 * comg2);\n    comg12 =             comg1 * comg2 + somg1 * somg2;\n    // eta = omg12 - lam120\n    eta = Math.atan2(somg12 * clam120 - comg12 * slam120,\n                     comg12 * clam120 + somg12 * slam120);\n    k2 = m.sq(calp0) * this._ep2;\n    vals.eps = k2 / (2 * (1 + Math.sqrt(1 + k2)) + k2);\n    this.C3f(vals.eps, C3a);\n    B312 = (g.SinCosSeries(true, vals.ssig2, vals.csig2, C3a) -\n            g.SinCosSeries(true, vals.ssig1, vals.csig1, C3a));\n    vals.domg12 =  -this.f * this.A3f(vals.eps) * salp0 * (vals.sig12 + B312);\n    vals.lam12 = eta + vals.domg12;\n    if (diffp) {\n      if (vals.calp2 === 0)\n        vals.dlam12 = -2 * this._f1 * dn1 / sbet1;\n      else {\n        nvals = this.Lengths(vals.eps, vals.sig12,\n                             vals.ssig1, vals.csig1, dn1,\n                             vals.ssig2, vals.csig2, dn2,\n                             cbet1, cbet2, g.REDUCEDLENGTH, C1a, C2a);\n        vals.dlam12 = nvals.m12b;\n        vals.dlam12 *= this._f1 / (vals.calp2 * cbet2);\n      }\n    }\n    return vals;\n  };\n\n  /**\n   * @summary Solve the inverse geodesic problem.\n   * @param {number} lat1 the latitude of the first point in degrees.\n   * @param {number} lon1 the longitude of the first point in degrees.\n   * @param {number} lat2 the latitude of the second point in degrees.\n   * @param {number} lon2 the longitude of the second point in degrees.\n   * @param {bitmask} [outmask = STANDARD] which results to include.\n   * @returns {object} the requested results\n   * @description The lat1, lon1, lat2, lon2, and a12 fields of the result are\n   *   always set.  For details on the outmask parameter, see {@tutorial\n   *   2-interface}, \"The outmask and caps parameters\".\n   */\n  g.Geodesic.prototype.Inverse = function(lat1, lon1, lat2, lon2, outmask) {\n    var r, vals;\n    if (!outmask) outmask = g.STANDARD;\n    if (outmask === g.LONG_UNROLL) outmask |= g.STANDARD;\n    outmask &= g.OUT_MASK;\n    r = this.InverseInt(lat1, lon1, lat2, lon2, outmask);\n    vals = r.vals;\n    if (outmask & g.AZIMUTH) {\n      vals.azi1 = m.atan2d(r.salp1, r.calp1);\n      vals.azi2 = m.atan2d(r.salp2, r.calp2);\n    }\n    return vals;\n  };\n\n  g.Geodesic.prototype.InverseInt = function(lat1, lon1, lat2, lon2, outmask) {\n    var vals = {},\n        lon12, lon12s, lonsign, t, swapp, latsign,\n        sbet1, cbet1, sbet2, cbet2, s12x, m12x,\n        dn1, dn2, lam12, slam12, clam12,\n        sig12, calp1, salp1, calp2, salp2, C1a, C2a, C3a, meridian, nvals,\n        ssig1, csig1, ssig2, csig2, eps, omg12, dnm,\n        numit, salp1a, calp1a, salp1b, calp1b,\n        tripn, tripb, v, dv, dalp1, sdalp1, cdalp1, nsalp1,\n        lengthmask, salp0, calp0, alp12, k2, A4, C4a, B41, B42,\n        somg12, comg12, domg12, dbet1, dbet2, salp12, calp12, sdomg12, cdomg12;\n    // Compute longitude difference (AngDiff does this carefully).  Result is\n    // in [-180, 180] but -180 is only for west-going geodesics.  180 is for\n    // east-going and meridional geodesics.\n    vals.lat1 = lat1 = m.LatFix(lat1); vals.lat2 = lat2 = m.LatFix(lat2);\n    // If really close to the equator, treat as on equator.\n    lat1 = m.AngRound(lat1);\n    lat2 = m.AngRound(lat2);\n    lon12 = m.AngDiff(lon1, lon2); lon12s = lon12.t; lon12 = lon12.s;\n    if (outmask & g.LONG_UNROLL) {\n      vals.lon1 = lon1; vals.lon2 = (lon1 + lon12) + lon12s;\n    } else {\n      vals.lon1 = m.AngNormalize(lon1); vals.lon2 = m.AngNormalize(lon2);\n    }\n    // Make longitude difference positive.\n    lonsign = lon12 >= 0 ? 1 : -1;\n    // If very close to being on the same half-meridian, then make it so.\n    lon12 = lonsign * m.AngRound(lon12);\n    lon12s = m.AngRound((180 - lon12) - lonsign * lon12s);\n    lam12 = lon12 * m.degree;\n    t = m.sincosd(lon12 > 90 ? lon12s : lon12);\n    slam12 = t.s; clam12 = (lon12 > 90 ? -1 : 1) * t.c;\n\n    // Swap points so that point with higher (abs) latitude is point 1\n    // If one latitude is a nan, then it becomes lat1.\n    swapp = Math.abs(lat1) < Math.abs(lat2) ? -1 : 1;\n    if (swapp < 0) {\n      lonsign *= -1;\n      t = lat1;\n      lat1 = lat2;\n      lat2 = t;\n      // swap(lat1, lat2);\n    }\n    // Make lat1 <= 0\n    latsign = lat1 < 0 ? 1 : -1;\n    lat1 *= latsign;\n    lat2 *= latsign;\n    // Now we have\n    //\n    //     0 <= lon12 <= 180\n    //     -90 <= lat1 <= 0\n    //     lat1 <= lat2 <= -lat1\n    //\n    // longsign, swapp, latsign register the transformation to bring the\n    // coordinates to this canonical form.  In all cases, 1 means no change was\n    // made.  We make these transformations so that there are few cases to\n    // check, e.g., on verifying quadrants in atan2.  In addition, this\n    // enforces some symmetries in the results returned.\n\n    t = m.sincosd(lat1); sbet1 = this._f1 * t.s; cbet1 = t.c;\n    // norm(sbet1, cbet1);\n    t = m.hypot(sbet1, cbet1); sbet1 /= t; cbet1 /= t;\n    // Ensure cbet1 = +epsilon at poles\n    cbet1 = Math.max(g.tiny_, cbet1);\n\n    t = m.sincosd(lat2); sbet2 = this._f1 * t.s; cbet2 = t.c;\n    // norm(sbet2, cbet2);\n    t = m.hypot(sbet2, cbet2); sbet2 /= t; cbet2 /= t;\n    // Ensure cbet2 = +epsilon at poles\n    cbet2 = Math.max(g.tiny_, cbet2);\n\n    // If cbet1 < -sbet1, then cbet2 - cbet1 is a sensitive measure of the\n    // |bet1| - |bet2|.  Alternatively (cbet1 >= -sbet1), abs(sbet2) + sbet1 is\n    // a better measure.  This logic is used in assigning calp2 in Lambda12.\n    // Sometimes these quantities vanish and in that case we force bet2 = +/-\n    // bet1 exactly.  An example where is is necessary is the inverse problem\n    // 48.522876735459 0 -48.52287673545898293 179.599720456223079643\n    // which failed with Visual Studio 10 (Release and Debug)\n\n    if (cbet1 < -sbet1) {\n      if (cbet2 === cbet1)\n        sbet2 = sbet2 < 0 ? sbet1 : -sbet1;\n    } else {\n      if (Math.abs(sbet2) === -sbet1)\n        cbet2 = cbet1;\n    }\n\n    dn1 = Math.sqrt(1 + this._ep2 * m.sq(sbet1));\n    dn2 = Math.sqrt(1 + this._ep2 * m.sq(sbet2));\n\n    // index zero elements of these arrays are unused\n    C1a = new Array(g.nC1_ + 1);\n    C2a = new Array(g.nC2_ + 1);\n    C3a = new Array(g.nC3_);\n\n    meridian = lat1 === -90 || slam12 === 0;\n    if (meridian) {\n\n      // Endpoints are on a single full meridian, so the geodesic might\n      // lie on a meridian.\n\n      calp1 = clam12; salp1 = slam12; // Head to the target longitude\n      calp2 = 1; salp2 = 0;           // At the target we're heading north\n\n      // tan(bet) = tan(sig) * cos(alp)\n      ssig1 = sbet1; csig1 = calp1 * cbet1;\n      ssig2 = sbet2; csig2 = calp2 * cbet2;\n\n      // sig12 = sig2 - sig1\n      sig12 = Math.atan2(Math.max(0, csig1 * ssig2 - ssig1 * csig2),\n                                     csig1 * csig2 + ssig1 * ssig2);\n      nvals = this.Lengths(this._n, sig12,\n                           ssig1, csig1, dn1, ssig2, csig2, dn2, cbet1, cbet2,\n                           outmask | g.DISTANCE | g.REDUCEDLENGTH,\n                           C1a, C2a);\n      s12x = nvals.s12b;\n      m12x = nvals.m12b;\n      // Ignore m0\n      if (outmask & g.GEODESICSCALE) {\n        vals.M12 = nvals.M12;\n        vals.M21 = nvals.M21;\n      }\n      // Add the check for sig12 since zero length geodesics might yield\n      // m12 < 0.  Test case was\n      //\n      //    echo 20.001 0 20.001 0 | GeodSolve -i\n      //\n      // In fact, we will have sig12 > pi/2 for meridional geodesic\n      // which is not a shortest path.\n      if (sig12 < 1 || m12x >= 0) {\n        // Need at least 2, to handle 90 0 90 180\n        if (sig12 < 3 * g.tiny_)\n          sig12 = m12x = s12x = 0;\n        m12x *= this._b;\n        s12x *= this._b;\n        vals.a12 = sig12 / m.degree;\n      } else\n        // m12 < 0, i.e., prolate and too close to anti-podal\n        meridian = false;\n    }\n\n    somg12 = 2;\n    if (!meridian &&\n        sbet1 === 0 &&           // and sbet2 == 0\n        (this.f <= 0 || lon12s >= this.f * 180)) {\n\n      // Geodesic runs along equator\n      calp1 = calp2 = 0; salp1 = salp2 = 1;\n      s12x = this.a * lam12;\n      sig12 = omg12 = lam12 / this._f1;\n      m12x = this._b * Math.sin(sig12);\n      if (outmask & g.GEODESICSCALE)\n        vals.M12 = vals.M21 = Math.cos(sig12);\n      vals.a12 = lon12 / this._f1;\n\n    } else if (!meridian) {\n\n      // Now point1 and point2 belong within a hemisphere bounded by a\n      // meridian and geodesic is neither meridional or equatorial.\n\n      // Figure a starting point for Newton's method\n      nvals = this.InverseStart(sbet1, cbet1, dn1, sbet2, cbet2, dn2,\n                                lam12, slam12, clam12, C1a, C2a);\n      sig12 = nvals.sig12;\n      salp1 = nvals.salp1;\n      calp1 = nvals.calp1;\n\n      if (sig12 >= 0) {\n        salp2 = nvals.salp2;\n        calp2 = nvals.calp2;\n        // Short lines (InverseStart sets salp2, calp2, dnm)\n\n        dnm = nvals.dnm;\n        s12x = sig12 * this._b * dnm;\n        m12x = m.sq(dnm) * this._b * Math.sin(sig12 / dnm);\n        if (outmask & g.GEODESICSCALE)\n          vals.M12 = vals.M21 = Math.cos(sig12 / dnm);\n        vals.a12 = sig12 / m.degree;\n        omg12 = lam12 / (this._f1 * dnm);\n      } else {\n\n        // Newton's method.  This is a straightforward solution of f(alp1) =\n        // lambda12(alp1) - lam12 = 0 with one wrinkle.  f(alp) has exactly one\n        // root in the interval (0, pi) and its derivative is positive at the\n        // root.  Thus f(alp) is positive for alp > alp1 and negative for alp <\n        // alp1.  During the course of the iteration, a range (alp1a, alp1b) is\n        // maintained which brackets the root and with each evaluation of\n        // f(alp) the range is shrunk if possible.  Newton's method is\n        // restarted whenever the derivative of f is negative (because the new\n        // value of alp1 is then further from the solution) or if the new\n        // estimate of alp1 lies outside (0,pi); in this case, the new starting\n        // guess is taken to be (alp1a + alp1b) / 2.\n        numit = 0;\n        // Bracketing range\n        salp1a = g.tiny_; calp1a = 1; salp1b = g.tiny_; calp1b = -1;\n        for (tripn = false, tripb = false; numit < maxit2_; ++numit) {\n          // the WGS84 test set: mean = 1.47, sd = 1.25, max = 16\n          // WGS84 and random input: mean = 2.85, sd = 0.60\n          nvals = this.Lambda12(sbet1, cbet1, dn1, sbet2, cbet2, dn2,\n                                salp1, calp1, slam12, clam12, numit < maxit1_,\n                                C1a, C2a, C3a);\n          v = nvals.lam12;\n          salp2 = nvals.salp2;\n          calp2 = nvals.calp2;\n          sig12 = nvals.sig12;\n          ssig1 = nvals.ssig1;\n          csig1 = nvals.csig1;\n          ssig2 = nvals.ssig2;\n          csig2 = nvals.csig2;\n          eps = nvals.eps;\n          domg12 = nvals.domg12;\n          dv = nvals.dlam12;\n\n          // 2 * tol0 is approximately 1 ulp for a number in [0, pi].\n          // Reversed test to allow escape with NaNs\n          if (tripb || !(Math.abs(v) >= (tripn ? 8 : 1) * tol0_))\n            break;\n          // Update bracketing values\n          if (v > 0 && (numit < maxit1_ || calp1/salp1 > calp1b/salp1b)) {\n            salp1b = salp1; calp1b = calp1;\n          } else if (v < 0 &&\n                     (numit < maxit1_ || calp1/salp1 < calp1a/salp1a)) {\n            salp1a = salp1; calp1a = calp1;\n          }\n          if (numit < maxit1_ && dv > 0) {\n            dalp1 = -v/dv;\n            sdalp1 = Math.sin(dalp1); cdalp1 = Math.cos(dalp1);\n            nsalp1 = salp1 * cdalp1 + calp1 * sdalp1;\n            if (nsalp1 > 0 && Math.abs(dalp1) < Math.PI) {\n              calp1 = calp1 * cdalp1 - salp1 * sdalp1;\n              salp1 = nsalp1;\n              // norm(salp1, calp1);\n              t = m.hypot(salp1, calp1); salp1 /= t; calp1 /= t;\n              // In some regimes we don't get quadratic convergence because\n              // slope -> 0.  So use convergence conditions based on epsilon\n              // instead of sqrt(epsilon).\n              tripn = Math.abs(v) <= 16 * tol0_;\n              continue;\n            }\n          }\n          // Either dv was not positive or updated value was outside legal\n          // range.  Use the midpoint of the bracket as the next estimate.\n          // This mechanism is not needed for the WGS84 ellipsoid, but it does\n          // catch problems with more eccentric ellipsoids.  Its efficacy is\n          // such for the WGS84 test set with the starting guess set to alp1 =\n          // 90deg:\n          // the WGS84 test set: mean = 5.21, sd = 3.93, max = 24\n          // WGS84 and random input: mean = 4.74, sd = 0.99\n          salp1 = (salp1a + salp1b)/2;\n          calp1 = (calp1a + calp1b)/2;\n          // norm(salp1, calp1);\n          t = m.hypot(salp1, calp1); salp1 /= t; calp1 /= t;\n          tripn = false;\n          tripb = (Math.abs(salp1a - salp1) + (calp1a - calp1) < tolb_ ||\n                   Math.abs(salp1 - salp1b) + (calp1 - calp1b) < tolb_);\n        }\n        lengthmask = outmask |\n            (outmask & (g.REDUCEDLENGTH | g.GEODESICSCALE) ?\n             g.DISTANCE : g.NONE);\n        nvals = this.Lengths(eps, sig12,\n                             ssig1, csig1, dn1, ssig2, csig2, dn2,\n                             cbet1, cbet2,\n                             lengthmask, C1a, C2a);\n        s12x = nvals.s12b;\n        m12x = nvals.m12b;\n        // Ignore m0\n        if (outmask & g.GEODESICSCALE) {\n          vals.M12 = nvals.M12;\n          vals.M21 = nvals.M21;\n        }\n        m12x *= this._b;\n        s12x *= this._b;\n        vals.a12 = sig12 / m.degree;\n        if (outmask & g.AREA) {\n          // omg12 = lam12 - domg12\n          sdomg12 = Math.sin(domg12); cdomg12 = Math.cos(domg12);\n          somg12 = slam12 * cdomg12 - clam12 * sdomg12;\n          comg12 = clam12 * cdomg12 + slam12 * sdomg12;\n        }\n      }\n    }\n\n    if (outmask & g.DISTANCE)\n      vals.s12 = 0 + s12x;      // Convert -0 to 0\n\n    if (outmask & g.REDUCEDLENGTH)\n      vals.m12 = 0 + m12x;      // Convert -0 to 0\n\n    if (outmask & g.AREA) {\n      // From Lambda12: sin(alp1) * cos(bet1) = sin(alp0)\n      salp0 = salp1 * cbet1;\n      calp0 = m.hypot(calp1, salp1 * sbet1); // calp0 > 0\n      if (calp0 !== 0 && salp0 !== 0) {\n        // From Lambda12: tan(bet) = tan(sig) * cos(alp)\n        ssig1 = sbet1; csig1 = calp1 * cbet1;\n        ssig2 = sbet2; csig2 = calp2 * cbet2;\n        k2 = m.sq(calp0) * this._ep2;\n        eps = k2 / (2 * (1 + Math.sqrt(1 + k2)) + k2);\n        // Multiplier = a^2 * e^2 * cos(alpha0) * sin(alpha0).\n        A4 = m.sq(this.a) * calp0 * salp0 * this._e2;\n        // norm(ssig1, csig1);\n        t = m.hypot(ssig1, csig1); ssig1 /= t; csig1 /= t;\n        // norm(ssig2, csig2);\n        t = m.hypot(ssig2, csig2); ssig2 /= t; csig2 /= t;\n        C4a = new Array(g.nC4_);\n        this.C4f(eps, C4a);\n        B41 = g.SinCosSeries(false, ssig1, csig1, C4a);\n        B42 = g.SinCosSeries(false, ssig2, csig2, C4a);\n        vals.S12 = A4 * (B42 - B41);\n      } else\n        // Avoid problems with indeterminate sig1, sig2 on equator\n        vals.S12 = 0;\n      if (!meridian && somg12 > 1) {\n        somg12 = Math.sin(omg12); comg12 = Math.cos(omg12);\n      }\n      if (!meridian &&\n          comg12 > -0.7071 &&      // Long difference not too big\n          sbet2 - sbet1 < 1.75) { // Lat difference not too big\n        // Use tan(Gamma/2) = tan(omg12/2)\n        // * (tan(bet1/2)+tan(bet2/2))/(1+tan(bet1/2)*tan(bet2/2))\n        // with tan(x/2) = sin(x)/(1+cos(x))\n        domg12 = 1 + comg12; dbet1 = 1 + cbet1; dbet2 = 1 + cbet2;\n        alp12 = 2 * Math.atan2( somg12 * (sbet1*dbet2 + sbet2*dbet1),\n                                domg12 * (sbet1*sbet2 + dbet1*dbet2) );\n      } else {\n        // alp12 = alp2 - alp1, used in atan2 so no need to normalize\n        salp12 = salp2 * calp1 - calp2 * salp1;\n        calp12 = calp2 * calp1 + salp2 * salp1;\n        // The right thing appears to happen if alp1 = +/-180 and alp2 = 0, viz\n        // salp12 = -0 and alp12 = -180.  However this depends on the sign\n        // being attached to 0 correctly.  The following ensures the correct\n        // behavior.\n        if (salp12 === 0 && calp12 < 0) {\n          salp12 = g.tiny_ * calp1;\n          calp12 = -1;\n        }\n        alp12 = Math.atan2(salp12, calp12);\n      }\n      vals.S12 += this._c2 * alp12;\n      vals.S12 *= swapp * lonsign * latsign;\n      // Convert -0 to 0\n      vals.S12 += 0;\n    }\n\n    // Convert calp, salp to azimuth accounting for lonsign, swapp, latsign.\n    if (swapp < 0) {\n      t = salp1;\n      salp1 = salp2;\n      salp2 = t;\n      // swap(salp1, salp2);\n      t = calp1;\n      calp1 = calp2;\n      calp2 = t;\n      // swap(calp1, calp2);\n      if (outmask & g.GEODESICSCALE) {\n        t = vals.M12;\n        vals.M12 = vals.M21;\n        vals.M21 = t;\n        // swap(vals.M12, vals.M21);\n      }\n    }\n\n    salp1 *= swapp * lonsign; calp1 *= swapp * latsign;\n    salp2 *= swapp * lonsign; calp2 *= swapp * latsign;\n\n    return {vals: vals,\n            salp1: salp1, calp1: calp1,\n            salp2: salp2, calp2: calp2};\n  };\n\n  /**\n   * @summary Solve the general direct geodesic problem.\n   * @param {number} lat1 the latitude of the first point in degrees.\n   * @param {number} lon1 the longitude of the first point in degrees.\n   * @param {number} azi1 the azimuth at the first point in degrees.\n   * @param {bool} arcmode is the next parameter an arc length?\n   * @param {number} s12_a12 the (arcmode ? arc length : distance) from the\n   *   first point to the second in (arcmode ? degrees : meters).\n   * @param {bitmask} [outmask = STANDARD] which results to include.\n   * @returns {object} the requested results.\n   * @description The lat1, lon1, azi1, and a12 fields of the result are always\n   *   set; s12 is included if arcmode is false.  For details on the outmask\n   *   parameter, see {@tutorial 2-interface}, \"The outmask and caps\n   *   parameters\".\n   */\n  g.Geodesic.prototype.GenDirect = function(lat1, lon1, azi1,\n                                            arcmode, s12_a12, outmask) {\n    var line;\n    if (!outmask) outmask = g.STANDARD;\n    else if (outmask === g.LONG_UNROLL) outmask |= g.STANDARD;\n    // Automatically supply DISTANCE_IN if necessary\n    if (!arcmode) outmask |= g.DISTANCE_IN;\n    line = new l.GeodesicLine(this, lat1, lon1, azi1, outmask);\n    return line.GenPosition(arcmode, s12_a12, outmask);\n  };\n\n  /**\n   * @summary Solve the direct geodesic problem.\n   * @param {number} lat1 the latitude of the first point in degrees.\n   * @param {number} lon1 the longitude of the first point in degrees.\n   * @param {number} azi1 the azimuth at the first point in degrees.\n   * @param {number} s12 the distance from the first point to the second in\n   *   meters.\n   * @param {bitmask} [outmask = STANDARD] which results to include.\n   * @returns {object} the requested results.\n   * @description The lat1, lon1, azi1, s12, and a12 fields of the result are\n   *   always set.  For details on the outmask parameter, see {@tutorial\n   *   2-interface}, \"The outmask and caps parameters\".\n   */\n  g.Geodesic.prototype.Direct = function(lat1, lon1, azi1, s12, outmask) {\n    return this.GenDirect(lat1, lon1, azi1, false, s12, outmask);\n  };\n\n  /**\n   * @summary Solve the direct geodesic problem with arc length.\n   * @param {number} lat1 the latitude of the first point in degrees.\n   * @param {number} lon1 the longitude of the first point in degrees.\n   * @param {number} azi1 the azimuth at the first point in degrees.\n   * @param {number} a12 the arc length from the first point to the second in\n   *   degrees.\n   * @param {bitmask} [outmask = STANDARD] which results to include.\n   * @returns {object} the requested results.\n   * @description The lat1, lon1, azi1, and a12 fields of the result are\n   *   always set.  For details on the outmask parameter, see {@tutorial\n   *   2-interface}, \"The outmask and caps parameters\".\n   */\n  g.Geodesic.prototype.ArcDirect = function(lat1, lon1, azi1, a12, outmask) {\n    return this.GenDirect(lat1, lon1, azi1, true, a12, outmask);\n  };\n\n  /**\n   * @summary Create a {@link module:GeographicLib/GeodesicLine.GeodesicLine\n   *   GeodesicLine} object.\n   * @param {number} lat1 the latitude of the first point in degrees.\n   * @param {number} lon1 the longitude of the first point in degrees.\n   * @param {number} azi1 the azimuth at the first point in degrees.\n   *   degrees.\n   * @param {bitmask} [caps = STANDARD | DISTANCE_IN] which capabilities to\n   *   include.\n   * @returns {object} the\n   *   {@link module:GeographicLib/GeodesicLine.GeodesicLine\n   *   GeodesicLine} object\n   * @description For details on the caps parameter, see {@tutorial\n   *   2-interface}, \"The outmask and caps parameters\".\n   */\n  g.Geodesic.prototype.Line = function(lat1, lon1, azi1, caps) {\n    return new l.GeodesicLine(this, lat1, lon1, azi1, caps);\n  };\n\n  /**\n   * @summary Define a {@link module:GeographicLib/GeodesicLine.GeodesicLine\n   *   GeodesicLine} in terms of the direct geodesic problem specified in terms\n   *   of distance.\n   * @param {number} lat1 the latitude of the first point in degrees.\n   * @param {number} lon1 the longitude of the first point in degrees.\n   * @param {number} azi1 the azimuth at the first point in degrees.\n   *   degrees.\n   * @param {number} s12 the distance between point 1 and point 2 (meters); it\n   *   can be negative.\n   * @param {bitmask} [caps = STANDARD | DISTANCE_IN] which capabilities to\n   *   include.\n   * @returns {object} the\n   *   {@link module:GeographicLib/GeodesicLine.GeodesicLine\n   *   GeodesicLine} object\n   * @description This function sets point 3 of the GeodesicLine to correspond\n   *   to point 2 of the direct geodesic problem.  For details on the caps\n   *   parameter, see {@tutorial 2-interface}, \"The outmask and caps\n   *   parameters\".\n   */\n  g.Geodesic.prototype.DirectLine = function(lat1, lon1, azi1, s12, caps) {\n    return this.GenDirectLine(lat1, lon1, azi1, false, s12, caps);\n  };\n\n  /**\n   * @summary Define a {@link module:GeographicLib/GeodesicLine.GeodesicLine\n   *   GeodesicLine} in terms of the direct geodesic problem specified in terms\n   *   of arc length.\n   * @param {number} lat1 the latitude of the first point in degrees.\n   * @param {number} lon1 the longitude of the first point in degrees.\n   * @param {number} azi1 the azimuth at the first point in degrees.\n   *   degrees.\n   * @param {number} a12 the arc length between point 1 and point 2 (degrees);\n   *   it can be negative.\n   * @param {bitmask} [caps = STANDARD | DISTANCE_IN] which capabilities to\n   *   include.\n   * @returns {object} the\n   *   {@link module:GeographicLib/GeodesicLine.GeodesicLine\n   *   GeodesicLine} object\n   * @description This function sets point 3 of the GeodesicLine to correspond\n   *   to point 2 of the direct geodesic problem.  For details on the caps\n   *   parameter, see {@tutorial 2-interface}, \"The outmask and caps\n   *   parameters\".\n   */\n  g.Geodesic.prototype.ArcDirectLine = function(lat1, lon1, azi1, a12, caps) {\n    return this.GenDirectLine(lat1, lon1, azi1, true, a12, caps);\n  };\n\n  /**\n   * @summary Define a {@link module:GeographicLib/GeodesicLine.GeodesicLine\n   *   GeodesicLine} in terms of the direct geodesic problem specified in terms\n   *   of either distance or arc length.\n   * @param {number} lat1 the latitude of the first point in degrees.\n   * @param {number} lon1 the longitude of the first point in degrees.\n   * @param {number} azi1 the azimuth at the first point in degrees.\n   *   degrees.\n   * @param {bool} arcmode boolean flag determining the meaning of the\n   *   s12_a12.\n   * @param {number} s12_a12 if arcmode is false, this is the distance between\n   *   point 1 and point 2 (meters); otherwise it is the arc length between\n   *   point 1 and point 2 (degrees); it can be negative.\n   * @param {bitmask} [caps = STANDARD | DISTANCE_IN] which capabilities to\n   *   include.\n   * @returns {object} the\n   *   {@link module:GeographicLib/GeodesicLine.GeodesicLine\n   *   GeodesicLine} object\n   * @description This function sets point 3 of the GeodesicLine to correspond\n   *   to point 2 of the direct geodesic problem.  For details on the caps\n   *   parameter, see {@tutorial 2-interface}, \"The outmask and caps\n   *   parameters\".\n   */\n  g.Geodesic.prototype.GenDirectLine = function(lat1, lon1, azi1,\n                                                arcmode, s12_a12, caps) {\n    var t;\n    if (!caps) caps = g.STANDARD | g.DISTANCE_IN;\n    // Automatically supply DISTANCE_IN if necessary\n    if (!arcmode) caps |= g.DISTANCE_IN;\n    t = new l.GeodesicLine(this, lat1, lon1, azi1, caps);\n    t.GenSetDistance(arcmode, s12_a12);\n    return t;\n  };\n\n  /**\n   * @summary Define a {@link module:GeographicLib/GeodesicLine.GeodesicLine\n   *   GeodesicLine} in terms of the inverse geodesic problem.\n   * @param {number} lat1 the latitude of the first point in degrees.\n   * @param {number} lon1 the longitude of the first point in degrees.\n   * @param {number} lat2 the latitude of the second point in degrees.\n   * @param {number} lon2 the longitude of the second point in degrees.\n   * @param {bitmask} [caps = STANDARD | DISTANCE_IN] which capabilities to\n   *   include.\n   * @returns {object} the\n   *   {@link module:GeographicLib/GeodesicLine.GeodesicLine\n   *   GeodesicLine} object\n   * @description This function sets point 3 of the GeodesicLine to correspond\n   *   to point 2 of the inverse geodesic problem.  For details on the caps\n   *   parameter, see {@tutorial 2-interface}, \"The outmask and caps\n   *   parameters\".\n   */\n  g.Geodesic.prototype.InverseLine = function(lat1, lon1, lat2, lon2, caps) {\n    var r, t, azi1;\n    if (!caps) caps = g.STANDARD | g.DISTANCE_IN;\n    r = this.InverseInt(lat1, lon1, lat2, lon2, g.ARC);\n    azi1 = m.atan2d(r.salp1, r.calp1);\n    // Ensure that a12 can be converted to a distance\n    if (caps & (g.OUT_MASK & g.DISTANCE_IN)) caps |= g.DISTANCE;\n    t = new l.GeodesicLine(this, lat1, lon1, azi1, caps, r.salp1, r.calp1);\n    t.SetArc(r.vals.a12);\n    return t;\n  };\n\n  /**\n   * @summary Create a {@link module:GeographicLib/PolygonArea.PolygonArea\n   *   PolygonArea} object.\n   * @param {bool} [polyline = false] if true the new PolygonArea object\n   *   describes a polyline instead of a polygon.\n   * @returns {object} the\n   *   {@link module:GeographicLib/PolygonArea.PolygonArea\n   *   PolygonArea} object\n   */\n  g.Geodesic.prototype.Polygon = function(polyline) {\n    return new p.PolygonArea(this, polyline);\n  };\n\n  /**\n   * @summary a {@link module:GeographicLib/Geodesic.Geodesic Geodesic} object\n   *   initialized for the WGS84 ellipsoid.\n   * @constant {object}\n   */\n  g.WGS84 = new g.Geodesic(c.WGS84.a, c.WGS84.f);\n})(GeographicLib.Geodesic, GeographicLib.GeodesicLine,\n   GeographicLib.PolygonArea, GeographicLib.Math, GeographicLib.Constants);\n\n/**************** GeodesicLine.js ****************/\n/*\n * GeodesicLine.js\n * Transcription of GeodesicLine.[ch]pp into JavaScript.\n *\n * See the documentation for the C++ class.  The conversion is a literal\n * conversion from C++.\n *\n * The algorithms are derived in\n *\n *    Charles F. F. Karney,\n *    Algorithms for geodesics, J. Geodesy 87, 43-55 (2013);\n *    https://doi.org/10.1007/s00190-012-0578-z\n *    Addenda: https://geographiclib.sourceforge.io/geod-addenda.html\n *\n * Copyright (c) Charles Karney (2011-2019) <charles@karney.com> and licensed\n * under the MIT/X11 License.  For more information, see\n * https://geographiclib.sourceforge.io/\n */\n\n// Load AFTER GeographicLib/Math.js, GeographicLib/Geodesic.js\n\n(function(\n  g,\n  /**\n   * @exports GeographicLib/GeodesicLine\n   * @description Solve geodesic problems on a single geodesic line via the\n   *   {@link module:GeographicLib/GeodesicLine.GeodesicLine GeodesicLine}\n   *   class.\n   */\n  l, m) {\n\n  /**\n   * @class\n   * @property {number} a the equatorial radius (meters).\n   * @property {number} f the flattening.\n   * @property {number} lat1 the initial latitude (degrees).\n   * @property {number} lon1 the initial longitude (degrees).\n   * @property {number} azi1 the initial azimuth (degrees).\n   * @property {number} salp1 the sine of the azimuth at the first point.\n   * @property {number} calp1 the cosine the azimuth at the first point.\n   * @property {number} s13 the distance to point 3 (meters).\n   * @property {number} a13 the arc length to point 3 (degrees).\n   * @property {bitmask} caps the capabilities of the object.\n   * @summary Initialize a GeodesicLine object.  For details on the caps\n   *   parameter, see {@tutorial 2-interface}, \"The outmask and caps\n   *   parameters\".\n   * @classdesc Performs geodesic calculations along a given geodesic line.\n   *   This object is usually instantiated by\n   *   {@link module:GeographicLib/Geodesic.Geodesic#Line Geodesic.Line}.\n   *   The methods\n   *   {@link module:GeographicLib/Geodesic.Geodesic#DirectLine\n   *   Geodesic.DirectLine} and\n   *   {@link module:GeographicLib/Geodesic.Geodesic#InverseLine\n   *   Geodesic.InverseLine} set in addition the position of a reference point\n   *   3.\n   * @param {object} geod a {@link module:GeographicLib/Geodesic.Geodesic\n   *   Geodesic} object.\n   * @param {number} lat1 the latitude of the first point in degrees.\n   * @param {number} lon1 the longitude of the first point in degrees.\n   * @param {number} azi1 the azimuth at the first point in degrees.\n   * @param {bitmask} [caps = STANDARD | DISTANCE_IN] which capabilities to\n   *   include; LATITUDE | AZIMUTH are always included.\n   */\n  l.GeodesicLine = function(geod, lat1, lon1, azi1, caps, salp1, calp1) {\n    var t, cbet1, sbet1, eps, s, c;\n    if (!caps) caps = g.STANDARD | g.DISTANCE_IN;\n\n    this.a = geod.a;\n    this.f = geod.f;\n    this._b = geod._b;\n    this._c2 = geod._c2;\n    this._f1 = geod._f1;\n    this.caps = caps | g.LATITUDE | g.AZIMUTH | g.LONG_UNROLL;\n\n    this.lat1 = m.LatFix(lat1);\n    this.lon1 = lon1;\n    if (typeof salp1 === 'undefined' || typeof calp1 === 'undefined') {\n      this.azi1 = m.AngNormalize(azi1);\n      t = m.sincosd(m.AngRound(this.azi1)); this.salp1 = t.s; this.calp1 = t.c;\n    } else {\n      this.azi1 = azi1; this.salp1 = salp1; this.calp1 = calp1;\n    }\n    t = m.sincosd(m.AngRound(this.lat1)); sbet1 = this._f1 * t.s; cbet1 = t.c;\n    // norm(sbet1, cbet1);\n    t = m.hypot(sbet1, cbet1); sbet1 /= t; cbet1 /= t;\n    // Ensure cbet1 = +epsilon at poles\n    cbet1 = Math.max(g.tiny_, cbet1);\n    this._dn1 = Math.sqrt(1 + geod._ep2 * m.sq(sbet1));\n\n    // Evaluate alp0 from sin(alp1) * cos(bet1) = sin(alp0),\n    this._salp0 = this.salp1 * cbet1; // alp0 in [0, pi/2 - |bet1|]\n    // Alt: calp0 = hypot(sbet1, calp1 * cbet1).  The following\n    // is slightly better (consider the case salp1 = 0).\n    this._calp0 = m.hypot(this.calp1, this.salp1 * sbet1);\n    // Evaluate sig with tan(bet1) = tan(sig1) * cos(alp1).\n    // sig = 0 is nearest northward crossing of equator.\n    // With bet1 = 0, alp1 = pi/2, we have sig1 = 0 (equatorial line).\n    // With bet1 =  pi/2, alp1 = -pi, sig1 =  pi/2\n    // With bet1 = -pi/2, alp1 =  0 , sig1 = -pi/2\n    // Evaluate omg1 with tan(omg1) = sin(alp0) * tan(sig1).\n    // With alp0 in (0, pi/2], quadrants for sig and omg coincide.\n    // No atan2(0,0) ambiguity at poles since cbet1 = +epsilon.\n    // With alp0 = 0, omg1 = 0 for alp1 = 0, omg1 = pi for alp1 = pi.\n    this._ssig1 = sbet1; this._somg1 = this._salp0 * sbet1;\n    this._csig1 = this._comg1 =\n      sbet1 !== 0 || this.calp1 !== 0 ? cbet1 * this.calp1 : 1;\n    // norm(this._ssig1, this._csig1); // sig1 in (-pi, pi]\n    t = m.hypot(this._ssig1, this._csig1);\n    this._ssig1 /= t; this._csig1 /= t;\n    // norm(this._somg1, this._comg1); -- don't need to normalize!\n\n    this._k2 = m.sq(this._calp0) * geod._ep2;\n    eps = this._k2 / (2 * (1 + Math.sqrt(1 + this._k2)) + this._k2);\n\n    if (this.caps & g.CAP_C1) {\n      this._A1m1 = g.A1m1f(eps);\n      this._C1a = new Array(g.nC1_ + 1);\n      g.C1f(eps, this._C1a);\n      this._B11 = g.SinCosSeries(true, this._ssig1, this._csig1, this._C1a);\n      s = Math.sin(this._B11); c = Math.cos(this._B11);\n      // tau1 = sig1 + B11\n      this._stau1 = this._ssig1 * c + this._csig1 * s;\n      this._ctau1 = this._csig1 * c - this._ssig1 * s;\n      // Not necessary because C1pa reverts C1a\n      //    _B11 = -SinCosSeries(true, _stau1, _ctau1, _C1pa);\n    }\n\n    if (this.caps & g.CAP_C1p) {\n      this._C1pa = new Array(g.nC1p_ + 1);\n      g.C1pf(eps, this._C1pa);\n    }\n\n    if (this.caps & g.CAP_C2) {\n      this._A2m1 = g.A2m1f(eps);\n      this._C2a = new Array(g.nC2_ + 1);\n      g.C2f(eps, this._C2a);\n      this._B21 = g.SinCosSeries(true, this._ssig1, this._csig1, this._C2a);\n    }\n\n    if (this.caps & g.CAP_C3) {\n      this._C3a = new Array(g.nC3_);\n      geod.C3f(eps, this._C3a);\n      this._A3c = -this.f * this._salp0 * geod.A3f(eps);\n      this._B31 = g.SinCosSeries(true, this._ssig1, this._csig1, this._C3a);\n    }\n\n    if (this.caps & g.CAP_C4) {\n      this._C4a = new Array(g.nC4_); // all the elements of _C4a are used\n      geod.C4f(eps, this._C4a);\n      // Multiplier = a^2 * e^2 * cos(alpha0) * sin(alpha0)\n      this._A4 = m.sq(this.a) * this._calp0 * this._salp0 * geod._e2;\n      this._B41 = g.SinCosSeries(false, this._ssig1, this._csig1, this._C4a);\n    }\n\n    this.a13 = this.s13 = Number.NaN;\n  };\n\n  /**\n   * @summary Find the position on the line (general case).\n   * @param {bool} arcmode is the next parameter an arc length?\n   * @param {number} s12_a12 the (arcmode ? arc length : distance) from the\n   *   first point to the second in (arcmode ? degrees : meters).\n   * @param {bitmask} [outmask = STANDARD] which results to include; this is\n   *   subject to the capabilities of the object.\n   * @returns {object} the requested results.\n   * @description The lat1, lon1, azi1, and a12 fields of the result are\n   *   always set; s12 is included if arcmode is false.  For details on the\n   *   outmask parameter, see {@tutorial 2-interface}, \"The outmask and caps\n   *   parameters\".\n   */\n  l.GeodesicLine.prototype.GenPosition = function(arcmode, s12_a12,\n                                                  outmask) {\n    var vals = {},\n        sig12, ssig12, csig12, B12, AB1, ssig2, csig2, tau12, s, c, serr,\n        omg12, lam12, lon12, E, sbet2, cbet2, somg2, comg2, salp2, calp2, dn2,\n        B22, AB2, J12, t, B42, salp12, calp12;\n    if (!outmask) outmask = g.STANDARD;\n    else if (outmask === g.LONG_UNROLL) outmask |= g.STANDARD;\n    outmask &= this.caps & g.OUT_MASK;\n    vals.lat1 = this.lat1; vals.azi1 = this.azi1;\n    vals.lon1 = outmask & g.LONG_UNROLL ?\n      this.lon1 : m.AngNormalize(this.lon1);\n    if (arcmode)\n      vals.a12 = s12_a12;\n    else\n      vals.s12 = s12_a12;\n    if (!( arcmode || (this.caps & g.DISTANCE_IN & g.OUT_MASK) )) {\n      // Uninitialized or impossible distance calculation requested\n      vals.a12 = Number.NaN;\n      return vals;\n    }\n\n    // Avoid warning about uninitialized B12.\n    B12 = 0; AB1 = 0;\n    if (arcmode) {\n      // Interpret s12_a12 as spherical arc length\n      sig12 = s12_a12 * m.degree;\n      t = m.sincosd(s12_a12); ssig12 = t.s; csig12 = t.c;\n    } else {\n      // Interpret s12_a12 as distance\n      tau12 = s12_a12 / (this._b * (1 + this._A1m1));\n      s = Math.sin(tau12);\n      c = Math.cos(tau12);\n      // tau2 = tau1 + tau12\n      B12 = -g.SinCosSeries(true,\n                            this._stau1 * c + this._ctau1 * s,\n                            this._ctau1 * c - this._stau1 * s,\n                            this._C1pa);\n      sig12 = tau12 - (B12 - this._B11);\n      ssig12 = Math.sin(sig12); csig12 = Math.cos(sig12);\n      if (Math.abs(this.f) > 0.01) {\n        // Reverted distance series is inaccurate for |f| > 1/100, so correct\n        // sig12 with 1 Newton iteration.  The following table shows the\n        // approximate maximum error for a = WGS_a() and various f relative to\n        // GeodesicExact.\n        //     erri = the error in the inverse solution (nm)\n        //     errd = the error in the direct solution (series only) (nm)\n        //     errda = the error in the direct solution\n        //             (series + 1 Newton) (nm)\n        //\n        //       f     erri  errd errda\n        //     -1/5    12e6 1.2e9  69e6\n        //     -1/10  123e3  12e6 765e3\n        //     -1/20   1110 108e3  7155\n        //     -1/50  18.63 200.9 27.12\n        //     -1/100 18.63 23.78 23.37\n        //     -1/150 18.63 21.05 20.26\n        //      1/150 22.35 24.73 25.83\n        //      1/100 22.35 25.03 25.31\n        //      1/50  29.80 231.9 30.44\n        //      1/20   5376 146e3  10e3\n        //      1/10  829e3  22e6 1.5e6\n        //      1/5   157e6 3.8e9 280e6\n        ssig2 = this._ssig1 * csig12 + this._csig1 * ssig12;\n        csig2 = this._csig1 * csig12 - this._ssig1 * ssig12;\n        B12 = g.SinCosSeries(true, ssig2, csig2, this._C1a);\n        serr = (1 + this._A1m1) * (sig12 + (B12 - this._B11)) -\n          s12_a12 / this._b;\n        sig12 = sig12 - serr / Math.sqrt(1 + this._k2 * m.sq(ssig2));\n        ssig12 = Math.sin(sig12); csig12 = Math.cos(sig12);\n        // Update B12 below\n      }\n    }\n\n    // sig2 = sig1 + sig12\n    ssig2 = this._ssig1 * csig12 + this._csig1 * ssig12;\n    csig2 = this._csig1 * csig12 - this._ssig1 * ssig12;\n    dn2 = Math.sqrt(1 + this._k2 * m.sq(ssig2));\n    if (outmask & (g.DISTANCE | g.REDUCEDLENGTH | g.GEODESICSCALE)) {\n      if (arcmode || Math.abs(this.f) > 0.01)\n        B12 = g.SinCosSeries(true, ssig2, csig2, this._C1a);\n      AB1 = (1 + this._A1m1) * (B12 - this._B11);\n    }\n    // sin(bet2) = cos(alp0) * sin(sig2)\n    sbet2 = this._calp0 * ssig2;\n    // Alt: cbet2 = hypot(csig2, salp0 * ssig2);\n    cbet2 = m.hypot(this._salp0, this._calp0 * csig2);\n    if (cbet2 === 0)\n      // I.e., salp0 = 0, csig2 = 0.  Break the degeneracy in this case\n      cbet2 = csig2 = g.tiny_;\n    // tan(alp0) = cos(sig2)*tan(alp2)\n    salp2 = this._salp0; calp2 = this._calp0 * csig2; // No need to normalize\n\n    if (arcmode && (outmask & g.DISTANCE))\n      vals.s12 = this._b * ((1 + this._A1m1) * sig12 + AB1);\n\n    if (outmask & g.LONGITUDE) {\n      // tan(omg2) = sin(alp0) * tan(sig2)\n      somg2 = this._salp0 * ssig2; comg2 = csig2; // No need to normalize\n      E = m.copysign(1, this._salp0);\n      // omg12 = omg2 - omg1\n      omg12 = outmask & g.LONG_UNROLL ?\n        E * (sig12 -\n             (Math.atan2(ssig2, csig2) -\n              Math.atan2(this._ssig1, this._csig1)) +\n             (Math.atan2(E * somg2, comg2) -\n              Math.atan2(E * this._somg1, this._comg1))) :\n        Math.atan2(somg2 * this._comg1 - comg2 * this._somg1,\n                     comg2 * this._comg1 + somg2 * this._somg1);\n      lam12 = omg12 + this._A3c *\n        ( sig12 + (g.SinCosSeries(true, ssig2, csig2, this._C3a) -\n                   this._B31));\n      lon12 = lam12 / m.degree;\n      vals.lon2 = outmask & g.LONG_UNROLL ? this.lon1 + lon12 :\n        m.AngNormalize(m.AngNormalize(this.lon1) + m.AngNormalize(lon12));\n    }\n\n    if (outmask & g.LATITUDE)\n      vals.lat2 = m.atan2d(sbet2, this._f1 * cbet2);\n\n    if (outmask & g.AZIMUTH)\n      vals.azi2 = m.atan2d(salp2, calp2);\n\n    if (outmask & (g.REDUCEDLENGTH | g.GEODESICSCALE)) {\n      B22 = g.SinCosSeries(true, ssig2, csig2, this._C2a);\n      AB2 = (1 + this._A2m1) * (B22 - this._B21);\n      J12 = (this._A1m1 - this._A2m1) * sig12 + (AB1 - AB2);\n      if (outmask & g.REDUCEDLENGTH)\n        // Add parens around (_csig1 * ssig2) and (_ssig1 * csig2) to ensure\n        // accurate cancellation in the case of coincident points.\n        vals.m12 = this._b * ((      dn2 * (this._csig1 * ssig2) -\n                               this._dn1 * (this._ssig1 * csig2)) -\n                              this._csig1 * csig2 * J12);\n      if (outmask & g.GEODESICSCALE) {\n        t = this._k2 * (ssig2 - this._ssig1) * (ssig2 + this._ssig1) /\n          (this._dn1 + dn2);\n        vals.M12 = csig12 +\n          (t * ssig2 - csig2 * J12) * this._ssig1 / this._dn1;\n        vals.M21 = csig12 -\n          (t * this._ssig1 - this._csig1 * J12) * ssig2 / dn2;\n      }\n    }\n\n    if (outmask & g.AREA) {\n      B42 = g.SinCosSeries(false, ssig2, csig2, this._C4a);\n      if (this._calp0 === 0 || this._salp0 === 0) {\n        // alp12 = alp2 - alp1, used in atan2 so no need to normalize\n        salp12 = salp2 * this.calp1 - calp2 * this.salp1;\n        calp12 = calp2 * this.calp1 + salp2 * this.salp1;\n      } else {\n        // tan(alp) = tan(alp0) * sec(sig)\n        // tan(alp2-alp1) = (tan(alp2) -tan(alp1)) / (tan(alp2)*tan(alp1)+1)\n        // = calp0 * salp0 * (csig1-csig2) / (salp0^2 + calp0^2 * csig1*csig2)\n        // If csig12 > 0, write\n        //   csig1 - csig2 = ssig12 * (csig1 * ssig12 / (1 + csig12) + ssig1)\n        // else\n        //   csig1 - csig2 = csig1 * (1 - csig12) + ssig12 * ssig1\n        // No need to normalize\n        salp12 = this._calp0 * this._salp0 *\n          (csig12 <= 0 ? this._csig1 * (1 - csig12) + ssig12 * this._ssig1 :\n           ssig12 * (this._csig1 * ssig12 / (1 + csig12) + this._ssig1));\n        calp12 = m.sq(this._salp0) + m.sq(this._calp0) * this._csig1 * csig2;\n      }\n      vals.S12 = this._c2 * Math.atan2(salp12, calp12) +\n        this._A4 * (B42 - this._B41);\n    }\n\n    if (!arcmode)\n      vals.a12 = sig12 / m.degree;\n    return vals;\n  };\n\n  /**\n   * @summary Find the position on the line given s12.\n   * @param {number} s12 the distance from the first point to the second in\n   *   meters.\n   * @param {bitmask} [outmask = STANDARD] which results to include; this is\n   *   subject to the capabilities of the object.\n   * @returns {object} the requested results.\n   * @description The lat1, lon1, azi1, s12, and a12 fields of the result are\n   *   always set; s12 is included if arcmode is false.  For details on the\n   *   outmask parameter, see {@tutorial 2-interface}, \"The outmask and caps\n   *   parameters\".\n   */\n  l.GeodesicLine.prototype.Position = function(s12, outmask) {\n    return this.GenPosition(false, s12, outmask);\n  };\n\n  /**\n   * @summary Find the position on the line given a12.\n   * @param {number} a12 the arc length from the first point to the second in\n   *   degrees.\n   * @param {bitmask} [outmask = STANDARD] which results to include; this is\n   *   subject to the capabilities of the object.\n   * @returns {object} the requested results.\n   * @description The lat1, lon1, azi1, and a12 fields of the result are\n   *   always set.  For details on the outmask parameter, see {@tutorial\n   *   2-interface}, \"The outmask and caps parameters\".\n   */\n  l.GeodesicLine.prototype.ArcPosition = function(a12, outmask) {\n    return this.GenPosition(true, a12, outmask);\n  };\n\n  /**\n   * @summary Specify position of point 3 in terms of either distance or arc\n   *   length.\n   * @param {bool} arcmode boolean flag determining the meaning of the second\n   *   parameter; if arcmode is false, then the GeodesicLine object must have\n   *   been constructed with caps |= DISTANCE_IN.\n   * @param {number} s13_a13 if arcmode is false, this is the distance from\n   *   point 1 to point 3 (meters); otherwise it is the arc length from\n   *   point 1 to point 3 (degrees); it can be negative.\n   */\n  l.GeodesicLine.prototype.GenSetDistance = function(arcmode, s13_a13) {\n    if (arcmode)\n      this.SetArc(s13_a13);\n    else\n      this.SetDistance(s13_a13);\n  };\n\n  /**\n   * @summary Specify position of point 3 in terms distance.\n   * @param {number} s13 the distance from point 1 to point 3 (meters); it\n   *   can be negative.\n   */\n  l.GeodesicLine.prototype.SetDistance = function(s13) {\n    var r;\n    this.s13 = s13;\n    r = this.GenPosition(false, this.s13, g.ARC);\n    this.a13 = 0 + r.a12;       // the 0+ converts undefined into NaN\n  };\n\n  /**\n   * @summary Specify position of point 3 in terms of arc length.\n   * @param {number} a13 the arc length from point 1 to point 3 (degrees);\n   *   it can be negative.\n   */\n  l.GeodesicLine.prototype.SetArc = function(a13) {\n    var r;\n    this.a13 = a13;\n    r = this.GenPosition(true, this.a13, g.DISTANCE);\n    this.s13 = 0 + r.s12;       // the 0+ converts undefined into NaN\n  };\n\n})(GeographicLib.Geodesic, GeographicLib.GeodesicLine, GeographicLib.Math);\n\n/**************** PolygonArea.js ****************/\n/*\n * PolygonArea.js\n * Transcription of PolygonArea.[ch]pp into JavaScript.\n *\n * See the documentation for the C++ class.  The conversion is a literal\n * conversion from C++.\n *\n * The algorithms are derived in\n *\n *    Charles F. F. Karney,\n *    Algorithms for geodesics, J. Geodesy 87, 43-55 (2013);\n *    https://doi.org/10.1007/s00190-012-0578-z\n *    Addenda: https://geographiclib.sourceforge.io/geod-addenda.html\n *\n * Copyright (c) Charles Karney (2011-2019) <charles@karney.com> and licensed\n * under the MIT/X11 License.  For more information, see\n * https://geographiclib.sourceforge.io/\n */\n\n// Load AFTER GeographicLib/Math.js and GeographicLib/Geodesic.js\n\n(function(\n  /**\n   * @exports GeographicLib/PolygonArea\n   * @description Compute the area of geodesic polygons via the\n   *   {@link module:GeographicLib/PolygonArea.PolygonArea PolygonArea}\n   *   class.\n   */\n  p, g, m, a) {\n\n  var transit, transitdirect, AreaReduceA, AreaReduceB;\n  transit = function(lon1, lon2) {\n    // Return 1 or -1 if crossing prime meridian in east or west direction.\n    // Otherwise return zero.\n    var lon12, cross;\n    // Compute lon12 the same way as Geodesic::Inverse.\n    lon1 = m.AngNormalize(lon1);\n    lon2 = m.AngNormalize(lon2);\n    lon12 = m.AngDiff(lon1, lon2).s;\n    cross = lon1 <= 0 && lon2 > 0 && lon12 > 0 ? 1 :\n      (lon2 <= 0 && lon1 > 0 && lon12 < 0 ? -1 : 0);\n    return cross;\n  };\n\n  // an alternate version of transit to deal with longitudes in the direct\n  // problem.\n  transitdirect = function(lon1, lon2) {\n    // We want to compute exactly\n    //   int(ceil(lon2 / 360)) - int(ceil(lon1 / 360))\n    // Since we only need the parity of the result we can use std::remquo but\n    // this is buggy with g++ 4.8.3 and requires C++11.  So instead we do\n    lon1 = lon1 % 720.0; lon2 = lon2 % 720.0;\n    return ( ((lon2 <= 0 && lon2 > -360) || lon2 > 360 ? 1 : 0) -\n             ((lon1 <= 0 && lon1 > -360) || lon1 > 360 ? 1 : 0) );\n  };\n\n  // Reduce Accumulator area\n  AreaReduceA = function(area, area0, crossings, reverse, sign) {\n    area.Remainder(area0);\n    if (crossings & 1)\n      area.Add( (area.Sum() < 0 ? 1 : -1) * area0/2 );\n    // area is with the clockwise sense.  If !reverse convert to\n    // counter-clockwise convention.\n    if (!reverse)\n      area.Negate();\n    // If sign put area in (-area0/2, area0/2], else put area in [0, area0)\n    if (sign) {\n      if (area.Sum() > area0/2)\n        area.Add( -area0 );\n      else if (area.Sum() <= -area0/2)\n        area.Add( +area0 );\n    } else {\n      if (area.Sum() >= area0)\n        area.Add( -area0 );\n      else if (area.Sum() < 0)\n        area.Add( +area0 );\n    }\n    return 0 + area.Sum();\n  };\n\n  // Reduce double area\n  AreaReduceB = function(area, area0, crossings, reverse, sign) {\n    area = m.remainder(area, area0);\n    if (crossings & 1)\n      area += (area < 0 ? 1 : -1) * area0/2;\n    // area is with the clockwise sense.  If !reverse convert to\n    // counter-clockwise convention.\n    if (!reverse)\n      area *= -1;\n    // If sign put area in (-area0/2, area0/2], else put area in [0, area0)\n    if (sign) {\n      if (area > area0/2)\n        area -= area0;\n      else if (area <= -area0/2)\n        area += area0;\n    } else {\n      if (area >= area0)\n        area -= area0;\n      else if (area < 0)\n        area += area0;\n    }\n    return 0 + area;\n  };\n\n  /**\n   * @class\n   * @property {number} a the equatorial radius (meters).\n   * @property {number} f the flattening.\n   * @property {bool} polyline whether the PolygonArea object describes a\n   *   polyline or a polygon.\n   * @property {number} num the number of vertices so far.\n   * @property {number} lat the current latitude (degrees).\n   * @property {number} lon the current longitude (degrees).\n   * @summary Initialize a PolygonArea object.\n   * @classdesc Computes the area and perimeter of a geodesic polygon.\n   *   This object is usually instantiated by\n   *   {@link module:GeographicLib/Geodesic.Geodesic#Polygon Geodesic.Polygon}.\n   * @param {object} geod a {@link module:GeographicLib/Geodesic.Geodesic\n   *   Geodesic} object.\n   * @param {bool} [polyline = false] if true the new PolygonArea object\n   *   describes a polyline instead of a polygon.\n   */\n  p.PolygonArea = function(geod, polyline) {\n    this._geod = geod;\n    this.a = this._geod.a;\n    this.f = this._geod.f;\n    this._area0 = 4 * Math.PI * geod._c2;\n    this.polyline = !polyline ? false : polyline;\n    this._mask = g.LATITUDE | g.LONGITUDE | g.DISTANCE |\n          (this.polyline ? g.NONE : g.AREA | g.LONG_UNROLL);\n    if (!this.polyline)\n      this._areasum = new a.Accumulator(0);\n    this._perimetersum = new a.Accumulator(0);\n    this.Clear();\n  };\n\n  /**\n   * @summary Clear the PolygonArea object, setting the number of vertices to\n   *   0.\n   */\n  p.PolygonArea.prototype.Clear = function() {\n    this.num = 0;\n    this._crossings = 0;\n    if (!this.polyline)\n      this._areasum.Set(0);\n    this._perimetersum.Set(0);\n    this._lat0 = this._lon0 = this.lat = this.lon = Number.NaN;\n  };\n\n  /**\n   * @summary Add the next vertex to the polygon.\n   * @param {number} lat the latitude of the point (degrees).\n   * @param {number} lon the longitude of the point (degrees).\n   * @description This adds an edge from the current vertex to the new vertex.\n   */\n  p.PolygonArea.prototype.AddPoint = function(lat, lon) {\n    var t;\n    if (this.num === 0) {\n      this._lat0 = this.lat = lat;\n      this._lon0 = this.lon = lon;\n    } else {\n      t = this._geod.Inverse(this.lat, this.lon, lat, lon, this._mask);\n      this._perimetersum.Add(t.s12);\n      if (!this.polyline) {\n        this._areasum.Add(t.S12);\n        this._crossings += transit(this.lon, lon);\n      }\n      this.lat = lat;\n      this.lon = lon;\n    }\n    ++this.num;\n  };\n\n  /**\n   * @summary Add the next edge to the polygon.\n   * @param {number} azi the azimuth at the current the point (degrees).\n   * @param {number} s the length of the edge (meters).\n   * @description This specifies the new vertex in terms of the edge from the\n   *   current vertex.\n   */\n  p.PolygonArea.prototype.AddEdge = function(azi, s) {\n    var t;\n    if (this.num) {\n      t = this._geod.Direct(this.lat, this.lon, azi, s, this._mask);\n      this._perimetersum.Add(s);\n      if (!this.polyline) {\n        this._areasum.Add(t.S12);\n        this._crossings += transitdirect(this.lon, t.lon2);\n      }\n      this.lat = t.lat2;\n      this.lon = t.lon2;\n    }\n    ++this.num;\n  };\n\n  /**\n   * @summary Compute the perimeter and area of the polygon.\n   * @param {bool} reverse if true then clockwise (instead of\n   *   counter-clockwise) traversal counts as a positive area.\n   * @param {bool} sign if true then return a signed result for the area if the\n   *   polygon is traversed in the \"wrong\" direction instead of returning the\n   *   area for the rest of the earth.\n   * @returns {object} r where r.number is the number of vertices, r.perimeter\n   *   is the perimeter (meters), and r.area (only returned if polyline is\n   *   false) is the area (meters<sup>2</sup>).\n   * @description Arbitrarily complex polygons are allowed.  In the case of\n   *   self-intersecting polygons the area is accumulated \"algebraically\",\n   *   e.g., the areas of the 2 loops in a figure-8 polygon will partially\n   *   cancel.  If the object is a polygon (and not a polyline), the perimeter\n   *   includes the length of a final edge connecting the current point to the\n   *   initial point.  If the object is a polyline, then area is nan.  More\n   *   points can be added to the polygon after this call.\n   */\n  p.PolygonArea.prototype.Compute = function(reverse, sign) {\n    var vals = {number: this.num}, t, tempsum;\n    if (this.num < 2) {\n      vals.perimeter = 0;\n      if (!this.polyline)\n        vals.area = 0;\n      return vals;\n    }\n    if (this.polyline) {\n      vals.perimeter = this._perimetersum.Sum();\n      return vals;\n    }\n    t = this._geod.Inverse(this.lat, this.lon, this._lat0, this._lon0,\n                           this._mask);\n    vals.perimeter = this._perimetersum.Sum(t.s12);\n    tempsum = new a.Accumulator(this._areasum);\n    tempsum.Add(t.S12);\n    vals.area = AreaReduceA(tempsum, this._area0,\n                            this._crossings + transit(this.lon, this._lon0),\n                            reverse, sign);\n    return vals;\n  };\n\n  /**\n   * @summary Compute the perimeter and area of the polygon with a tentative\n   *   new vertex.\n   * @param {number} lat the latitude of the point (degrees).\n   * @param {number} lon the longitude of the point (degrees).\n   * @param {bool} reverse if true then clockwise (instead of\n   *   counter-clockwise) traversal counts as a positive area.\n   * @param {bool} sign if true then return a signed result for the area if the\n   *   polygon is traversed in the \"wrong\" direction instead of returning the\n   *   area for the rest of the earth.\n   * @returns {object} r where r.number is the number of vertices, r.perimeter\n   *   is the perimeter (meters), and r.area (only returned if polyline is\n   *   false) is the area (meters<sup>2</sup>).\n   * @description A new vertex is *not* added to the polygon.\n   */\n  p.PolygonArea.prototype.TestPoint = function(lat, lon, reverse, sign) {\n    var vals = {number: this.num + 1}, t, tempsum, crossings, i;\n    if (this.num === 0) {\n      vals.perimeter = 0;\n      if (!this.polyline)\n        vals.area = 0;\n      return vals;\n    }\n    vals.perimeter = this._perimetersum.Sum();\n    tempsum = this.polyline ? 0 : this._areasum.Sum();\n    crossings = this._crossings;\n    for (i = 0; i < (this.polyline ? 1 : 2); ++i) {\n      t = this._geod.Inverse(\n       i === 0 ? this.lat : lat, i === 0 ? this.lon : lon,\n       i !== 0 ? this._lat0 : lat, i !== 0 ? this._lon0 : lon,\n       this._mask);\n      vals.perimeter += t.s12;\n      if (!this.polyline) {\n        tempsum += t.S12;\n        crossings += transit(i === 0 ? this.lon : lon,\n                               i !== 0 ? this._lon0 : lon);\n      }\n    }\n\n    if (this.polyline)\n      return vals;\n\n    vals.area = AreaReduceB(tempsum, this._area0, crossings, reverse, sign);\n    return vals;\n  };\n\n  /**\n   * @summary Compute the perimeter and area of the polygon with a tentative\n   *   new edge.\n   * @param {number} azi the azimuth of the edge (degrees).\n   * @param {number} s the length of the edge (meters).\n   * @param {bool} reverse if true then clockwise (instead of\n   *   counter-clockwise) traversal counts as a positive area.\n   * @param {bool} sign if true then return a signed result for the area if the\n   *   polygon is traversed in the \"wrong\" direction instead of returning the\n   *   area for the rest of the earth.\n   * @returns {object} r where r.number is the number of vertices, r.perimeter\n   *   is the perimeter (meters), and r.area (only returned if polyline is\n   *   false) is the area (meters<sup>2</sup>).\n   * @description A new vertex is *not* added to the polygon.\n   */\n  p.PolygonArea.prototype.TestEdge = function(azi, s, reverse, sign) {\n    var vals = {number: this.num ? this.num + 1 : 0}, t, tempsum, crossings;\n    if (this.num === 0)\n      return vals;\n    vals.perimeter = this._perimetersum.Sum() + s;\n    if (this.polyline)\n      return vals;\n\n    tempsum = this._areasum.Sum();\n    crossings = this._crossings;\n    t = this._geod.Direct(this.lat, this.lon, azi, s, this._mask);\n    tempsum += t.S12;\n    crossings += transitdirect(this.lon, t.lon2);\n    crossings += transit(t.lon2, this._lon0);\n    t = this._geod.Inverse(t.lat2, t.lon2, this._lat0, this._lon0, this._mask);\n    vals.perimeter += t.s12;\n    tempsum += t.S12;\n\n    vals.area = AreaReduceB(tempsum, this._area0, crossings, reverse, sign);\n    return vals;\n  };\n\n})(GeographicLib.PolygonArea, GeographicLib.Geodesic,\n   GeographicLib.Math, GeographicLib.Accumulator);\n\n/**************** DMS.js ****************/\n/*\n * DMS.js\n * Transcription of DMS.[ch]pp into JavaScript.\n *\n * See the documentation for the C++ class.  The conversion is a literal\n * conversion from C++.\n *\n * Copyright (c) Charles Karney (2011-2019) <charles@karney.com> and licensed\n * under the MIT/X11 License.  For more information, see\n * https://geographiclib.sourceforge.io/\n */\n\nGeographicLib.DMS = {};\n\n(function(\n  /**\n   * @exports GeographicLib/DMS\n   * @description Decode/Encode angles expressed as degrees, minutes, and\n   *   seconds.  This module defines several constants:\n   *   - hemisphere indicator (returned by\n   *       {@link module:GeographicLib/DMS.Decode Decode}) and a formatting\n   *       indicator (used by\n   *       {@link module:GeographicLib/DMS.Encode Encode})\n   *     - NONE = 0, no designator and format as plain angle;\n   *     - LATITUDE = 1, a N/S designator and format as latitude;\n   *     - LONGITUDE = 2, an E/W designator and format as longitude;\n   *     - AZIMUTH = 3, format as azimuth;\n   *   - the specification of the trailing component in\n   *       {@link module:GeographicLib/DMS.Encode Encode}\n   *     - DEGREE;\n   *     - MINUTE;\n   *     - SECOND.\n   */\n  d) {\n\n  var lookup, zerofill, internalDecode, numMatch,\n      hemispheres_ = \"SNWE\",\n      signs_ = \"-+\",\n      digits_ = \"0123456789\",\n      dmsindicators_ = \"D'\\\":\",\n      // dmsindicatorsu_ = \"\\u00b0\\u2032\\u2033\"; // Unicode variants\n      dmsindicatorsu_ = \"\\u00b0'\\\"\", // Use degree symbol\n      components_ = [\"degrees\", \"minutes\", \"seconds\"];\n  lookup = function(s, c) {\n    return s.indexOf(c.toUpperCase());\n  };\n  zerofill = function(s, n) {\n    return String(\"0000\").substr(0, Math.max(0, Math.min(4, n-s.length))) +\n      s;\n  };\n  d.NONE = 0;\n  d.LATITUDE = 1;\n  d.LONGITUDE = 2;\n  d.AZIMUTH = 3;\n  d.DEGREE = 0;\n  d.MINUTE = 1;\n  d.SECOND = 2;\n\n  /**\n   * @summary Decode a DMS string.\n   * @description The interpretation of the string is given in the\n   *   documentation of the corresponding function, Decode(string&, flag&)\n   *   in the {@link\n   *   https://geographiclib.sourceforge.io/html/classGeographicLib_1_1DMS.html\n   *   C++ DMS class}\n   * @param {string} dms the string.\n   * @returns {object} r where r.val is the decoded value (degrees) and r.ind\n   *   is a hemisphere designator, one of NONE, LATITUDE, LONGITUDE.\n   * @throws an error if the string is illegal.\n   */\n  d.Decode = function(dms) {\n    var dmsa = dms, end,\n        v = 0, i = 0, mi, pi, vals,\n        ind1 = d.NONE, ind2, p, pa, pb;\n    dmsa = dmsa\n      .replace(/\\u2212/g, '-')  // U+2212 minus sign\n      .replace(/\\u00b0/g, 'd')  // U+00b0 degree symbol\n      .replace(/\\u00ba/g, 'd')  // U+00ba alt symbol\n      .replace(/\\u2070/g, 'd')  // U+2070 sup zero\n      .replace(/\\u02da/g, 'd')  // U+02da ring above\n      .replace(/\\u2032/g, '\\'') // U+2032 prime\n      .replace(/\\u00b4/g, '\\'') // U+00b4 acute accent\n      .replace(/\\u2019/g, '\\'') // U+2019 right single quote\n      .replace(/\\u2033/g, '\"')  // U+2033 double prime\n      .replace(/\\u201d/g, '\"')  // U+201d right double quote\n      .replace(/\\u00a0/g, '')   // U+00a0 non-breaking space\n      .replace(/\\u202f/g, '')   // U+202f narrow space\n      .replace(/\\u2007/g, '')   // U+2007 figure space\n      .replace(/''/g, '\"')      // '' -> \"\n      .trim();\n\n    end = dmsa.length;\n    // p is pointer to the next piece that needs decoding\n    for (p = 0; p < end; p = pb, ++i) {\n      pa = p;\n      // Skip over initial hemisphere letter (for i == 0)\n      if (i === 0 && lookup(hemispheres_, dmsa.charAt(pa)) >= 0)\n        ++pa;\n      // Skip over initial sign (checking for it if i == 0)\n      if (i > 0 || (pa < end && lookup(signs_, dmsa.charAt(pa)) >= 0))\n        ++pa;\n      // Find next sign\n      mi = dmsa.substr(pa, end - pa).indexOf('-');\n      pi = dmsa.substr(pa, end - pa).indexOf('+');\n      if (mi < 0) mi = end; else mi += pa;\n      if (pi < 0) pi = end; else pi += pa;\n      pb = Math.min(mi, pi);\n      vals = internalDecode(dmsa.substr(p, pb - p));\n      v += vals.val; ind2 = vals.ind;\n      if (ind1 === d.NONE)\n        ind1 = ind2;\n      else if (!(ind2 === d.NONE || ind1 === ind2))\n        throw new Error(\"Incompatible hemisphere specifies in \" +\n                        dmsa.substr(0, pb));\n    }\n    if (i === 0)\n      throw new Error(\"Empty or incomplete DMS string \" + dmsa);\n    return {val: v, ind: ind1};\n  };\n\n  internalDecode = function(dmsa) {\n    var vals = {}, errormsg = \"\",\n        sign, beg, end, ind1, k,\n        ipieces, fpieces, npiece,\n        icurrent, fcurrent, ncurrent, p,\n        pointseen,\n        digcount, intcount,\n        x;\n    do {                       // Executed once (provides the ability to break)\n      sign = 1;\n      beg = 0; end = dmsa.length;\n      ind1 = d.NONE;\n      k = -1;\n      if (end > beg && (k = lookup(hemispheres_, dmsa.charAt(beg))) >= 0) {\n        ind1 = (k & 2) ? d.LONGITUDE : d.LATITUDE;\n        sign = (k & 1) ? 1 : -1;\n        ++beg;\n      }\n      if (end > beg &&\n          (k = lookup(hemispheres_, dmsa.charAt(end-1))) >= 0) {\n        if (k >= 0) {\n          if (ind1 !== d.NONE) {\n            if (dmsa.charAt(beg - 1).toUpperCase() ===\n                dmsa.charAt(end - 1).toUpperCase())\n              errormsg = \"Repeated hemisphere indicators \" +\n              dmsa.charAt(beg - 1) + \" in \" +\n              dmsa.substr(beg - 1, end - beg + 1);\n            else\n              errormsg = \"Contradictory hemisphere indicators \" +\n              dmsa.charAt(beg - 1) + \" and \" + dmsa.charAt(end - 1) + \" in \" +\n              dmsa.substr(beg - 1, end - beg + 1);\n            break;\n          }\n          ind1 = (k & 2) ? d.LONGITUDE : d.LATITUDE;\n          sign = (k & 1) ? 1 : -1;\n          --end;\n        }\n      }\n      if (end > beg && (k = lookup(signs_, dmsa.charAt(beg))) >= 0) {\n        if (k >= 0) {\n          sign *= k ? 1 : -1;\n          ++beg;\n        }\n      }\n      if (end === beg) {\n        errormsg = \"Empty or incomplete DMS string \" + dmsa;\n        break;\n      }\n      ipieces = [0, 0, 0];\n      fpieces = [0, 0, 0];\n      npiece = 0;\n      icurrent = 0;\n      fcurrent = 0;\n      ncurrent = 0;\n      p = beg;\n      pointseen = false;\n      digcount = 0;\n      intcount = 0;\n      while (p < end) {\n        x = dmsa.charAt(p++);\n        if ((k = lookup(digits_, x)) >= 0) {\n          ++ncurrent;\n          if (digcount > 0) {\n            ++digcount;         // Count of decimal digits\n          } else {\n            icurrent = 10 * icurrent + k;\n            ++intcount;\n          }\n        } else if (x === '.') {\n          if (pointseen) {\n            errormsg = \"Multiple decimal points in \" +\n              dmsa.substr(beg, end - beg);\n            break;\n          }\n          pointseen = true;\n          digcount = 1;\n        } else if ((k = lookup(dmsindicators_, x)) >= 0) {\n          if (k >= 3) {\n            if (p === end) {\n              errormsg = \"Illegal for colon to appear at the end of \" +\n                dmsa.substr(beg, end - beg);\n              break;\n            }\n            k = npiece;\n          }\n          if (k === npiece - 1) {\n            errormsg = \"Repeated \" + components_[k] +\n              \" component in \" + dmsa.substr(beg, end - beg);\n            break;\n          } else if (k < npiece) {\n            errormsg = components_[k] + \" component follows \" +\n              components_[npiece - 1] + \" component in \" +\n              dmsa.substr(beg, end - beg);\n            break;\n          }\n          if (ncurrent === 0) {\n            errormsg = \"Missing numbers in \" + components_[k] +\n              \" component of \" + dmsa.substr(beg, end - beg);\n            break;\n          }\n          if (digcount > 0) {\n            fcurrent = parseFloat(dmsa.substr(p - intcount - digcount - 1,\n                                              intcount + digcount));\n            icurrent = 0;\n          }\n          ipieces[k] = icurrent;\n          fpieces[k] = icurrent + fcurrent;\n          if (p < end) {\n            npiece = k + 1;\n            icurrent = fcurrent = 0;\n            ncurrent = digcount = intcount = 0;\n          }\n        } else if (lookup(signs_, x) >= 0) {\n          errormsg = \"Internal sign in DMS string \" +\n            dmsa.substr(beg, end - beg);\n          break;\n        } else {\n          errormsg = \"Illegal character \" + x + \" in DMS string \" +\n            dmsa.substr(beg, end - beg);\n          break;\n        }\n      }\n      if (errormsg.length)\n        break;\n      if (lookup(dmsindicators_, dmsa.charAt(p - 1)) < 0) {\n        if (npiece >= 3) {\n          errormsg = \"Extra text following seconds in DMS string \" +\n            dmsa.substr(beg, end - beg);\n          break;\n        }\n        if (ncurrent === 0) {\n          errormsg = \"Missing numbers in trailing component of \" +\n            dmsa.substr(beg, end - beg);\n          break;\n        }\n        if (digcount > 0) {\n          fcurrent = parseFloat(dmsa.substr(p - intcount - digcount,\n                                            intcount + digcount));\n          icurrent = 0;\n        }\n        ipieces[npiece] = icurrent;\n        fpieces[npiece] = icurrent + fcurrent;\n      }\n      if (pointseen && digcount === 0) {\n        errormsg = \"Decimal point in non-terminal component of \" +\n          dmsa.substr(beg, end - beg);\n        break;\n      }\n      // Note that we accept 59.999999... even though it rounds to 60.\n      if (ipieces[1] >= 60 || fpieces[1] > 60) {\n        errormsg = \"Minutes \" + fpieces[1] + \" not in range [0,60)\";\n        break;\n      }\n      if (ipieces[2] >= 60 || fpieces[2] > 60) {\n        errormsg = \"Seconds \" + fpieces[2] + \" not in range [0,60)\";\n        break;\n      }\n      vals.ind = ind1;\n      // Assume check on range of result is made by calling routine (which\n      // might be able to offer a better diagnostic).\n      vals.val = sign *\n        ( fpieces[2] ? (60*(60*fpieces[0] + fpieces[1]) + fpieces[2]) / 3600 :\n          ( fpieces[1] ? (60*fpieces[0] + fpieces[1]) / 60 : fpieces[0] ) );\n      return vals;\n    } while (false);\n    vals.val = numMatch(dmsa);\n    if (vals.val === 0)\n      throw new Error(errormsg);\n    else\n      vals.ind = d.NONE;\n    return vals;\n  };\n\n  numMatch = function(s) {\n    var t, sign, p0, p1;\n    if (s.length < 3)\n      return 0;\n    t = s.toUpperCase().replace(/0+$/, \"\");\n    sign = t.charAt(0) === '-' ? -1 : 1;\n    p0 = t.charAt(0) === '-' || t.charAt(0) === '+' ? 1 : 0;\n    p1 = t.length - 1;\n    if (p1 + 1 < p0 + 3)\n      return 0;\n    // Strip off sign and trailing 0s\n    t = t.substr(p0, p1 + 1 - p0); // Length at least 3\n    if (t === \"NAN\" || t === \"1.#QNAN\" || t === \"1.#SNAN\" || t === \"1.#IND\" ||\n        t === \"1.#R\")\n      return Number.NaN;\n    else if (t === \"INF\" || t === \"1.#INF\")\n      return sign * Number.POSITIVE_INFINITY;\n    return 0;\n  };\n\n  /**\n   * @summary Decode two DMS strings interpreting them as a latitude/longitude\n   *   pair.\n   * @param {string} stra the first string.\n   * @param {string} strb the first string.\n   * @param {bool} [longfirst = false] if true assume then longitude is given\n   *   first (in the absence of any hemisphere indicators).\n   * @returns {object} r where r.lat is the decoded latitude and r.lon is the\n   *   decoded longitude (both in degrees).\n   * @throws an error if the strings are illegal.\n   */\n  d.DecodeLatLon = function(stra, strb, longfirst) {\n    var vals = {},\n        valsa = d.Decode(stra),\n        valsb = d.Decode(strb),\n        a = valsa.val, ia = valsa.ind,\n        b = valsb.val, ib = valsb.ind,\n        lat, lon;\n    if (!longfirst) longfirst = false;\n    if (ia === d.NONE && ib === d.NONE) {\n      // Default to lat, long unless longfirst\n      ia = longfirst ? d.LONGITUDE : d.LATITUDE;\n      ib = longfirst ? d.LATITUDE : d.LONGITUDE;\n    } else if (ia === d.NONE)\n      ia = d.LATITUDE + d.LONGITUDE - ib;\n    else if (ib === d.NONE)\n      ib = d.LATITUDE + d.LONGITUDE - ia;\n    if (ia === ib)\n      throw new Error(\"Both \" + stra + \" and \" + strb + \" interpreted as \" +\n                      (ia === d.LATITUDE ? \"latitudes\" : \"longitudes\"));\n    lat = ia === d.LATITUDE ? a : b;\n    lon = ia === d.LATITUDE ? b : a;\n    if (Math.abs(lat) > 90)\n      throw new Error(\"Latitude \" + lat + \" not in [-90,90]\");\n    vals.lat = lat;\n    vals.lon = lon;\n    return vals;\n  };\n\n  /**\n   * @summary Decode a DMS string interpreting it as an arc length.\n   * @param {string} angstr the string (this must not include a hemisphere\n   *   indicator).\n   * @returns {number} the arc length (degrees).\n   * @throws an error if the string is illegal.\n   */\n  d.DecodeAngle = function(angstr) {\n    var vals = d.Decode(angstr),\n        ang = vals.val, ind = vals.ind;\n    if (ind !== d.NONE)\n      throw new Error(\"Arc angle \" + angstr +\n                      \" includes a hemisphere N/E/W/S\");\n    return ang;\n  };\n\n  /**\n   * @summary Decode a DMS string interpreting it as an azimuth.\n   * @param {string} azistr the string (this may include an E/W hemisphere\n   *   indicator).\n   * @returns {number} the azimuth (degrees).\n   * @throws an error if the string is illegal.\n   */\n  d.DecodeAzimuth = function(azistr) {\n    var vals = d.Decode(azistr),\n        azi = vals.val, ind = vals.ind;\n    if (ind === d.LATITUDE)\n      throw new Error(\"Azimuth \" + azistr + \" has a latitude hemisphere N/S\");\n    return azi;\n  };\n\n  /**\n   * @summary Convert angle (in degrees) into a DMS string (using &deg;, ',\n   *  and &quot;).\n   * @param {number} angle input angle (degrees).\n   * @param {number} trailing one of DEGREE, MINUTE, or SECOND to indicate\n   *   the trailing component of the string (this component is given as a\n   *   decimal number if necessary).\n   * @param {number} prec the number of digits after the decimal point for\n   *   the trailing component.\n   * @param {number} [ind = NONE] a formatting indicator, one of NONE,\n   *   LATITUDE, LONGITUDE, AZIMUTH.\n   * @returns {string} the resulting string formatted as follows:\n   *   * NONE, signed result no leading zeros on degrees except in the units\n   *     place, e.g., -8&deg;03'.\n   *   * LATITUDE, trailing N or S hemisphere designator, no sign, pad\n   *     degrees to 2 digits, e.g., 08&deg;03'S.\n   *   * LONGITUDE, trailing E or W hemisphere designator, no sign, pad\n   *     degrees to 3 digits, e.g., 008&deg;03'W.\n   *   * AZIMUTH, convert to the range [0, 360&deg;), no sign, pad degrees to\n   *     3 digits, e.g., 351&deg;57'.\n   */\n  d.Encode = function(angle, trailing, prec, ind) {\n    // Assume check on range of input angle has been made by calling\n    // routine (which might be able to offer a better diagnostic).\n    var scale = 1, i, sign,\n        idegree, fdegree, f, pieces, ip, fp, s;\n    if (!ind) ind = d.NONE;\n    if (!isFinite(angle))\n      return angle < 0 ? String(\"-inf\") :\n      (angle > 0 ? String(\"inf\") : String(\"nan\"));\n\n    // 15 - 2 * trailing = ceiling(log10(2^53/90/60^trailing)).\n    // This suffices to give full real precision for numbers in [-90,90]\n    prec = Math.min(15 - 2 * trailing, prec);\n    for (i = 0; i < trailing; ++i)\n      scale *= 60;\n    for (i = 0; i < prec; ++i)\n      scale *= 10;\n    if (ind === d.AZIMUTH)\n      angle -= Math.floor(angle/360) * 360;\n    sign = angle < 0 ? -1 : 1;\n    angle *= sign;\n\n    // Break off integer part to preserve precision in manipulation of\n    // fractional part.\n    idegree = Math.floor(angle);\n    fdegree = (angle - idegree) * scale + 0.5;\n    f = Math.floor(fdegree);\n    // Implement the \"round ties to even\" rule\n    fdegree = (f === fdegree && (f & 1) === 1) ? f - 1 : f;\n    fdegree /= scale;\n\n    fdegree = Math.floor((angle - idegree) * scale + 0.5) / scale;\n    if (fdegree >= 1) {\n      idegree += 1;\n      fdegree -= 1;\n    }\n    pieces = [fdegree, 0, 0];\n    for (i = 1; i <= trailing; ++i) {\n      ip = Math.floor(pieces[i - 1]);\n      fp = pieces[i - 1] - ip;\n      pieces[i] = fp * 60;\n      pieces[i - 1] = ip;\n    }\n    pieces[0] += idegree;\n    s = \"\";\n    if (ind === d.NONE && sign < 0)\n      s += '-';\n    switch (trailing) {\n    case d.DEGREE:\n      s += zerofill(pieces[0].toFixed(prec),\n                    ind === d.NONE ? 0 :\n                    1 + Math.min(ind, 2) + prec + (prec ? 1 : 0)) +\n        dmsindicatorsu_.charAt(0);\n      break;\n    default:\n      s += zerofill(pieces[0].toFixed(0),\n                    ind === d.NONE ? 0 : 1 + Math.min(ind, 2)) +\n        dmsindicatorsu_.charAt(0);\n      switch (trailing) {\n      case d.MINUTE:\n        s += zerofill(pieces[1].toFixed(prec), 2 + prec + (prec ? 1 : 0)) +\n          dmsindicatorsu_.charAt(1);\n        break;\n      case d.SECOND:\n        s += zerofill(pieces[1].toFixed(0), 2) + dmsindicatorsu_.charAt(1);\n        s += zerofill(pieces[2].toFixed(prec), 2 + prec + (prec ? 1 : 0)) +\n          dmsindicatorsu_.charAt(2);\n        break;\n      default:\n        break;\n      }\n    }\n    if (ind !== d.NONE && ind !== d.AZIMUTH)\n      s += hemispheres_.charAt((ind === d.LATITUDE ? 0 : 2) +\n                               (sign < 0 ? 0 : 1));\n    return s;\n  };\n})(GeographicLib.DMS);\n\ncb(GeographicLib);\n\n})(function(geo) {\n  if (typeof module === 'object' && module.exports) {\n    /******** support loading with node's require ********/\n    module.exports = geo;\n  } else if (typeof define === 'function' && define.amd) {\n    /******** support loading with AMD ********/\n    define('geographiclib', [], function() { return geo; });\n  } else {\n    /******** otherwise just pollute our global namespace ********/\n    window.GeographicLib = geo;\n  }\n});\n","export default function(defs) {\n  defs('EPSG:4326', \"+title=WGS 84 (long/lat) +proj=longlat +ellps=WGS84 +datum=WGS84 +units=degrees\");\n  defs('EPSG:4269', \"+title=NAD83 (long/lat) +proj=longlat +a=6378137.0 +b=6356752.31414036 +ellps=GRS80 +datum=NAD83 +units=degrees\");\n  defs('EPSG:3857', \"+title=WGS 84 / Pseudo-Mercator +proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +no_defs\");\n\n  defs.WGS84 = defs['EPSG:4326'];\n  defs['EPSG:3785'] = defs['EPSG:3857']; // maintain backward compat, official code is 3857\n  defs.GOOGLE = defs['EPSG:3857'];\n  defs['EPSG:900913'] = defs['EPSG:3857'];\n  defs['EPSG:102113'] = defs['EPSG:3857'];\n}\n","export var PJD_3PARAM = 1;\nexport var PJD_7PARAM = 2;\nexport var PJD_WGS84 = 4; // WGS84 or equivalent\nexport var PJD_NODATUM = 5; // WGS84 or equivalent\nexport var SEC_TO_RAD = 4.84813681109535993589914102357e-6;\nexport var HALF_PI = Math.PI/2;\n// ellipoid pj_set_ell.c\nexport var SIXTH = 0.1666666666666666667;\n/* 1/6 */\nexport var RA4 = 0.04722222222222222222;\n/* 17/360 */\nexport var RA6 = 0.02215608465608465608;\nexport var EPSLN = (typeof Number.EPSILON === 'undefined') ? 1.0e-10 : Number.EPSILON;\nexport var D2R = 0.01745329251994329577;\nexport var R2D = 57.29577951308232088;\nexport var FORTPI = Math.PI/4;\nexport var TWO_PI = Math.PI * 2;\n// SPI is slightly greater than Math.PI, so values that exceed the -180..180\n// degree range by a tiny amount don't get wrapped. This prevents points that\n// have drifted from their original location along the 180th meridian (due to\n// floating point error) from changing their sign.\nexport var SPI = 3.14159265359;\n","var exports = {};\nexport {exports as default};\n\nexports.greenwich = 0.0; //\"0dE\",\nexports.lisbon = -9.131906111111; //\"9d07'54.862\\\"W\",\nexports.paris = 2.337229166667; //\"2d20'14.025\\\"E\",\nexports.bogota = -74.080916666667; //\"74d04'51.3\\\"W\",\nexports.madrid = -3.687938888889; //\"3d41'16.58\\\"W\",\nexports.rome = 12.452333333333; //\"12d27'8.4\\\"E\",\nexports.bern = 7.439583333333; //\"7d26'22.5\\\"E\",\nexports.jakarta = 106.807719444444; //\"106d48'27.79\\\"E\",\nexports.ferro = -17.666666666667; //\"17d40'W\",\nexports.brussels = 4.367975; //\"4d22'4.71\\\"E\",\nexports.stockholm = 18.058277777778; //\"18d3'29.8\\\"E\",\nexports.athens = 23.7163375; //\"23d42'58.815\\\"E\",\nexports.oslo = 10.722916666667; //\"10d43'22.5\\\"E\"\n","export default {\n  ft: {to_meter: 0.3048},\n  'us-ft': {to_meter: 1200 / 3937}\n};\n","var ignoredChar = /[\\s_\\-\\/\\(\\)]/g;\nexport default function match(obj, key) {\n  if (obj[key]) {\n    return obj[key];\n  }\n  var keys = Object.keys(obj);\n  var lkey = key.toLowerCase().replace(ignoredChar, '');\n  var i = -1;\n  var testkey, processedKey;\n  while (++i < keys.length) {\n    testkey = keys[i];\n    processedKey = testkey.toLowerCase().replace(ignoredChar, '');\n    if (processedKey === lkey) {\n      return obj[testkey];\n    }\n  }\n}\n","import {D2R} from './constants/values';\nimport PrimeMeridian from './constants/PrimeMeridian';\nimport units from './constants/units';\nimport match from './match';\n\nexport default function(defData) {\n  var self = {};\n  var paramObj = defData.split('+').map(function(v) {\n    return v.trim();\n  }).filter(function(a) {\n    return a;\n  }).reduce(function(p, a) {\n    var split = a.split('=');\n    split.push(true);\n    p[split[0].toLowerCase()] = split[1];\n    return p;\n  }, {});\n  var paramName, paramVal, paramOutname;\n  var params = {\n    proj: 'projName',\n    datum: 'datumCode',\n    rf: function(v) {\n      self.rf = parseFloat(v);\n    },\n    lat_0: function(v) {\n      self.lat0 = v * D2R;\n    },\n    lat_1: function(v) {\n      self.lat1 = v * D2R;\n    },\n    lat_2: function(v) {\n      self.lat2 = v * D2R;\n    },\n    lat_ts: function(v) {\n      self.lat_ts = v * D2R;\n    },\n    lon_0: function(v) {\n      self.long0 = v * D2R;\n    },\n    lon_1: function(v) {\n      self.long1 = v * D2R;\n    },\n    lon_2: function(v) {\n      self.long2 = v * D2R;\n    },\n    alpha: function(v) {\n      self.alpha = parseFloat(v) * D2R;\n    },\n    lonc: function(v) {\n      self.longc = v * D2R;\n    },\n    x_0: function(v) {\n      self.x0 = parseFloat(v);\n    },\n    y_0: function(v) {\n      self.y0 = parseFloat(v);\n    },\n    k_0: function(v) {\n      self.k0 = parseFloat(v);\n    },\n    k: function(v) {\n      self.k0 = parseFloat(v);\n    },\n    a: function(v) {\n      self.a = parseFloat(v);\n    },\n    b: function(v) {\n      self.b = parseFloat(v);\n    },\n    r_a: function() {\n      self.R_A = true;\n    },\n    zone: function(v) {\n      self.zone = parseInt(v, 10);\n    },\n    south: function() {\n      self.utmSouth = true;\n    },\n    towgs84: function(v) {\n      self.datum_params = v.split(\",\").map(function(a) {\n        return parseFloat(a);\n      });\n    },\n    to_meter: function(v) {\n      self.to_meter = parseFloat(v);\n    },\n    units: function(v) {\n      self.units = v;\n      var unit = match(units, v);\n      if (unit) {\n        self.to_meter = unit.to_meter;\n      }\n    },\n    from_greenwich: function(v) {\n      self.from_greenwich = v * D2R;\n    },\n    pm: function(v) {\n      var pm = match(PrimeMeridian, v);\n      self.from_greenwich = (pm ? pm : parseFloat(v)) * D2R;\n    },\n    nadgrids: function(v) {\n      if (v === '@null') {\n        self.datumCode = 'none';\n      }\n      else {\n        self.nadgrids = v;\n      }\n    },\n    axis: function(v) {\n      var legalAxis = \"ewnsud\";\n      if (v.length === 3 && legalAxis.indexOf(v.substr(0, 1)) !== -1 && legalAxis.indexOf(v.substr(1, 1)) !== -1 && legalAxis.indexOf(v.substr(2, 1)) !== -1) {\n        self.axis = v;\n      }\n    }\n  };\n  for (paramName in paramObj) {\n    paramVal = paramObj[paramName];\n    if (paramName in params) {\n      paramOutname = params[paramName];\n      if (typeof paramOutname === 'function') {\n        paramOutname(paramVal);\n      }\n      else {\n        self[paramOutname] = paramVal;\n      }\n    }\n    else {\n      self[paramName] = paramVal;\n    }\n  }\n  if(typeof self.datumCode === 'string' && self.datumCode !== \"WGS84\"){\n    self.datumCode = self.datumCode.toLowerCase();\n  }\n  return self;\n}\n","export default parseString;\n\nvar NEUTRAL = 1;\nvar KEYWORD = 2;\nvar NUMBER = 3;\nvar QUOTED = 4;\nvar AFTERQUOTE = 5;\nvar ENDED = -1;\nvar whitespace = /\\s/;\nvar latin = /[A-Za-z]/;\nvar keyword = /[A-Za-z84]/;\nvar endThings = /[,\\]]/;\nvar digets = /[\\d\\.E\\-\\+]/;\n// const ignoredChar = /[\\s_\\-\\/\\(\\)]/g;\nfunction Parser(text) {\n  if (typeof text !== 'string') {\n    throw new Error('not a string');\n  }\n  this.text = text.trim();\n  this.level = 0;\n  this.place = 0;\n  this.root = null;\n  this.stack = [];\n  this.currentObject = null;\n  this.state = NEUTRAL;\n}\nParser.prototype.readCharicter = function() {\n  var char = this.text[this.place++];\n  if (this.state !== QUOTED) {\n    while (whitespace.test(char)) {\n      if (this.place >= this.text.length) {\n        return;\n      }\n      char = this.text[this.place++];\n    }\n  }\n  switch (this.state) {\n    case NEUTRAL:\n      return this.neutral(char);\n    case KEYWORD:\n      return this.keyword(char)\n    case QUOTED:\n      return this.quoted(char);\n    case AFTERQUOTE:\n      return this.afterquote(char);\n    case NUMBER:\n      return this.number(char);\n    case ENDED:\n      return;\n  }\n};\nParser.prototype.afterquote = function(char) {\n  if (char === '\"') {\n    this.word += '\"';\n    this.state = QUOTED;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.word = this.word.trim();\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in afterquote yet, index ' + this.place);\n};\nParser.prototype.afterItem = function(char) {\n  if (char === ',') {\n    if (this.word !== null) {\n      this.currentObject.push(this.word);\n    }\n    this.word = null;\n    this.state = NEUTRAL;\n    return;\n  }\n  if (char === ']') {\n    this.level--;\n    if (this.word !== null) {\n      this.currentObject.push(this.word);\n      this.word = null;\n    }\n    this.state = NEUTRAL;\n    this.currentObject = this.stack.pop();\n    if (!this.currentObject) {\n      this.state = ENDED;\n    }\n\n    return;\n  }\n};\nParser.prototype.number = function(char) {\n  if (digets.test(char)) {\n    this.word += char;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.word = parseFloat(this.word);\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in number yet, index ' + this.place);\n};\nParser.prototype.quoted = function(char) {\n  if (char === '\"') {\n    this.state = AFTERQUOTE;\n    return;\n  }\n  this.word += char;\n  return;\n};\nParser.prototype.keyword = function(char) {\n  if (keyword.test(char)) {\n    this.word += char;\n    return;\n  }\n  if (char === '[') {\n    var newObjects = [];\n    newObjects.push(this.word);\n    this.level++;\n    if (this.root === null) {\n      this.root = newObjects;\n    } else {\n      this.currentObject.push(newObjects);\n    }\n    this.stack.push(this.currentObject);\n    this.currentObject = newObjects;\n    this.state = NEUTRAL;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in keyword yet, index ' + this.place);\n};\nParser.prototype.neutral = function(char) {\n  if (latin.test(char)) {\n    this.word = char;\n    this.state = KEYWORD;\n    return;\n  }\n  if (char === '\"') {\n    this.word = '';\n    this.state = QUOTED;\n    return;\n  }\n  if (digets.test(char)) {\n    this.word = char;\n    this.state = NUMBER;\n    return;\n  }\n  if (endThings.test(char)) {\n    this.afterItem(char);\n    return;\n  }\n  throw new Error('havn\\'t handled \"' +char + '\" in neutral yet, index ' + this.place);\n};\nParser.prototype.output = function() {\n  while (this.place < this.text.length) {\n    this.readCharicter();\n  }\n  if (this.state === ENDED) {\n    return this.root;\n  }\n  throw new Error('unable to parse string \"' +this.text + '\". State is ' + this.state);\n};\n\nfunction parseString(txt) {\n  var parser = new Parser(txt);\n  return parser.output();\n}\n","\n\nfunction mapit(obj, key, value) {\n  if (Array.isArray(key)) {\n    value.unshift(key);\n    key = null;\n  }\n  var thing = key ? {} : obj;\n\n  var out = value.reduce(function(newObj, item) {\n    sExpr(item, newObj);\n    return newObj\n  }, thing);\n  if (key) {\n    obj[key] = out;\n  }\n}\n\nexport function sExpr(v, obj) {\n  if (!Array.isArray(v)) {\n    obj[v] = true;\n    return;\n  }\n  var key = v.shift();\n  if (key === 'PARAMETER') {\n    key = v.shift();\n  }\n  if (v.length === 1) {\n    if (Array.isArray(v[0])) {\n      obj[key] = {};\n      sExpr(v[0], obj[key]);\n      return;\n    }\n    obj[key] = v[0];\n    return;\n  }\n  if (!v.length) {\n    obj[key] = true;\n    return;\n  }\n  if (key === 'TOWGS84') {\n    obj[key] = v;\n    return;\n  }\n  if (key === 'AXIS') {\n    if (!(key in obj)) {\n      obj[key] = [];\n    }\n    obj[key].push(v);\n    return;\n  }\n  if (!Array.isArray(key)) {\n    obj[key] = {};\n  }\n\n  var i;\n  switch (key) {\n    case 'UNIT':\n    case 'PRIMEM':\n    case 'VERT_DATUM':\n      obj[key] = {\n        name: v[0].toLowerCase(),\n        convert: v[1]\n      };\n      if (v.length === 3) {\n        sExpr(v[2], obj[key]);\n      }\n      return;\n    case 'SPHEROID':\n    case 'ELLIPSOID':\n      obj[key] = {\n        name: v[0],\n        a: v[1],\n        rf: v[2]\n      };\n      if (v.length === 4) {\n        sExpr(v[3], obj[key]);\n      }\n      return;\n    case 'PROJECTEDCRS':\n    case 'PROJCRS':\n    case 'GEOGCS':\n    case 'GEOCCS':\n    case 'PROJCS':\n    case 'LOCAL_CS':\n    case 'GEODCRS':\n    case 'GEODETICCRS':\n    case 'GEODETICDATUM':\n    case 'EDATUM':\n    case 'ENGINEERINGDATUM':\n    case 'VERT_CS':\n    case 'VERTCRS':\n    case 'VERTICALCRS':\n    case 'COMPD_CS':\n    case 'COMPOUNDCRS':\n    case 'ENGINEERINGCRS':\n    case 'ENGCRS':\n    case 'FITTED_CS':\n    case 'LOCAL_DATUM':\n    case 'DATUM':\n      v[0] = ['name', v[0]];\n      mapit(obj, key, v);\n      return;\n    default:\n      i = -1;\n      while (++i < v.length) {\n        if (!Array.isArray(v[i])) {\n          return sExpr(v, obj[key]);\n        }\n      }\n      return mapit(obj, key, v);\n  }\n}\n","var D2R = 0.01745329251994329577;\nimport parser from './parser';\nimport {sExpr} from './process';\n\n\n\nfunction rename(obj, params) {\n  var outName = params[0];\n  var inName = params[1];\n  if (!(outName in obj) && (inName in obj)) {\n    obj[outName] = obj[inName];\n    if (params.length === 3) {\n      obj[outName] = params[2](obj[outName]);\n    }\n  }\n}\n\nfunction d2r(input) {\n  return input * D2R;\n}\n\nfunction cleanWKT(wkt) {\n  if (wkt.type === 'GEOGCS') {\n    wkt.projName = 'longlat';\n  } else if (wkt.type === 'LOCAL_CS') {\n    wkt.projName = 'identity';\n    wkt.local = true;\n  } else {\n    if (typeof wkt.PROJECTION === 'object') {\n      wkt.projName = Object.keys(wkt.PROJECTION)[0];\n    } else {\n      wkt.projName = wkt.PROJECTION;\n    }\n  }\n  if (wkt.AXIS) {\n    var axisOrder = '';\n    for (var i = 0, ii = wkt.AXIS.length; i < ii; ++i) {\n      var axis = wkt.AXIS[i];\n      var descriptor = axis[0].toLowerCase();\n      if (descriptor.indexOf('north') !== -1) {\n        axisOrder += 'n';\n      } else if (descriptor.indexOf('south') !== -1) {\n        axisOrder += 's';\n      } else if (descriptor.indexOf('east') !== -1) {\n        axisOrder += 'e';\n      } else if (descriptor.indexOf('west') !== -1) {\n        axisOrder += 'w';\n      }\n    }\n    if (axisOrder.length === 2) {\n      axisOrder += 'u';\n    }\n    if (axisOrder.length === 3) {\n      wkt.axis = axisOrder;\n    }\n  }\n  if (wkt.UNIT) {\n    wkt.units = wkt.UNIT.name.toLowerCase();\n    if (wkt.units === 'metre') {\n      wkt.units = 'meter';\n    }\n    if (wkt.UNIT.convert) {\n      if (wkt.type === 'GEOGCS') {\n        if (wkt.DATUM && wkt.DATUM.SPHEROID) {\n          wkt.to_meter = wkt.UNIT.convert*wkt.DATUM.SPHEROID.a;\n        }\n      } else {\n        wkt.to_meter = wkt.UNIT.convert;\n      }\n    }\n  }\n  var geogcs = wkt.GEOGCS;\n  if (wkt.type === 'GEOGCS') {\n    geogcs = wkt;\n  }\n  if (geogcs) {\n    //if(wkt.GEOGCS.PRIMEM&&wkt.GEOGCS.PRIMEM.convert){\n    //  wkt.from_greenwich=wkt.GEOGCS.PRIMEM.convert*D2R;\n    //}\n    if (geogcs.DATUM) {\n      wkt.datumCode = geogcs.DATUM.name.toLowerCase();\n    } else {\n      wkt.datumCode = geogcs.name.toLowerCase();\n    }\n    if (wkt.datumCode.slice(0, 2) === 'd_') {\n      wkt.datumCode = wkt.datumCode.slice(2);\n    }\n    if (wkt.datumCode === 'new_zealand_geodetic_datum_1949' || wkt.datumCode === 'new_zealand_1949') {\n      wkt.datumCode = 'nzgd49';\n    }\n    if (wkt.datumCode === 'wgs_1984' || wkt.datumCode === 'world_geodetic_system_1984') {\n      if (wkt.PROJECTION === 'Mercator_Auxiliary_Sphere') {\n        wkt.sphere = true;\n      }\n      wkt.datumCode = 'wgs84';\n    }\n    if (wkt.datumCode.slice(-6) === '_ferro') {\n      wkt.datumCode = wkt.datumCode.slice(0, - 6);\n    }\n    if (wkt.datumCode.slice(-8) === '_jakarta') {\n      wkt.datumCode = wkt.datumCode.slice(0, - 8);\n    }\n    if (~wkt.datumCode.indexOf('belge')) {\n      wkt.datumCode = 'rnb72';\n    }\n    if (geogcs.DATUM && geogcs.DATUM.SPHEROID) {\n      wkt.ellps = geogcs.DATUM.SPHEROID.name.replace('_19', '').replace(/[Cc]larke\\_18/, 'clrk');\n      if (wkt.ellps.toLowerCase().slice(0, 13) === 'international') {\n        wkt.ellps = 'intl';\n      }\n\n      wkt.a = geogcs.DATUM.SPHEROID.a;\n      wkt.rf = parseFloat(geogcs.DATUM.SPHEROID.rf, 10);\n    }\n\n    if (geogcs.DATUM && geogcs.DATUM.TOWGS84) {\n      wkt.datum_params = geogcs.DATUM.TOWGS84;\n    }\n    if (~wkt.datumCode.indexOf('osgb_1936')) {\n      wkt.datumCode = 'osgb36';\n    }\n    if (~wkt.datumCode.indexOf('osni_1952')) {\n      wkt.datumCode = 'osni52';\n    }\n    if (~wkt.datumCode.indexOf('tm65')\n      || ~wkt.datumCode.indexOf('geodetic_datum_of_1965')) {\n      wkt.datumCode = 'ire65';\n    }\n    if (wkt.datumCode === 'ch1903+') {\n      wkt.datumCode = 'ch1903';\n    }\n    if (~wkt.datumCode.indexOf('israel')) {\n      wkt.datumCode = 'isr93';\n    }\n  }\n  if (wkt.b && !isFinite(wkt.b)) {\n    wkt.b = wkt.a;\n  }\n\n  function toMeter(input) {\n    var ratio = wkt.to_meter || 1;\n    return input * ratio;\n  }\n  var renamer = function(a) {\n    return rename(wkt, a);\n  };\n  var list = [\n    ['standard_parallel_1', 'Standard_Parallel_1'],\n    ['standard_parallel_2', 'Standard_Parallel_2'],\n    ['false_easting', 'False_Easting'],\n    ['false_northing', 'False_Northing'],\n    ['central_meridian', 'Central_Meridian'],\n    ['latitude_of_origin', 'Latitude_Of_Origin'],\n    ['latitude_of_origin', 'Central_Parallel'],\n    ['scale_factor', 'Scale_Factor'],\n    ['k0', 'scale_factor'],\n    ['latitude_of_center', 'Latitude_Of_Center'],\n    ['latitude_of_center', 'Latitude_of_center'],\n    ['lat0', 'latitude_of_center', d2r],\n    ['longitude_of_center', 'Longitude_Of_Center'],\n    ['longitude_of_center', 'Longitude_of_center'],\n    ['longc', 'longitude_of_center', d2r],\n    ['x0', 'false_easting', toMeter],\n    ['y0', 'false_northing', toMeter],\n    ['long0', 'central_meridian', d2r],\n    ['lat0', 'latitude_of_origin', d2r],\n    ['lat0', 'standard_parallel_1', d2r],\n    ['lat1', 'standard_parallel_1', d2r],\n    ['lat2', 'standard_parallel_2', d2r],\n    ['azimuth', 'Azimuth'],\n    ['alpha', 'azimuth', d2r],\n    ['srsCode', 'name']\n  ];\n  list.forEach(renamer);\n  if (!wkt.long0 && wkt.longc && (wkt.projName === 'Albers_Conic_Equal_Area' || wkt.projName === 'Lambert_Azimuthal_Equal_Area')) {\n    wkt.long0 = wkt.longc;\n  }\n  if (!wkt.lat_ts && wkt.lat1 && (wkt.projName === 'Stereographic_South_Pole' || wkt.projName === 'Polar Stereographic (variant B)')) {\n    wkt.lat0 = d2r(wkt.lat1 > 0 ? 90 : -90);\n    wkt.lat_ts = wkt.lat1;\n  }\n}\nexport default function(wkt) {\n  var lisp = parser(wkt);\n  var type = lisp.shift();\n  var name = lisp.shift();\n  lisp.unshift(['name', name]);\n  lisp.unshift(['type', type]);\n  var obj = {};\n  sExpr(lisp, obj);\n  cleanWKT(obj);\n  return obj;\n}\n","import globals from './global';\nimport parseProj from './projString';\nimport wkt from 'wkt-parser';\n\nfunction defs(name) {\n  /*global console*/\n  var that = this;\n  if (arguments.length === 2) {\n    var def = arguments[1];\n    if (typeof def === 'string') {\n      if (def.charAt(0) === '+') {\n        defs[name] = parseProj(arguments[1]);\n      }\n      else {\n        defs[name] = wkt(arguments[1]);\n      }\n    } else {\n      defs[name] = def;\n    }\n  }\n  else if (arguments.length === 1) {\n    if (Array.isArray(name)) {\n      return name.map(function(v) {\n        if (Array.isArray(v)) {\n          defs.apply(that, v);\n        }\n        else {\n          defs(v);\n        }\n      });\n    }\n    else if (typeof name === 'string') {\n      if (name in defs) {\n        return defs[name];\n      }\n    }\n    else if ('EPSG' in name) {\n      defs['EPSG:' + name.EPSG] = name;\n    }\n    else if ('ESRI' in name) {\n      defs['ESRI:' + name.ESRI] = name;\n    }\n    else if ('IAU2000' in name) {\n      defs['IAU2000:' + name.IAU2000] = name;\n    }\n    else {\n      console.log(name);\n    }\n    return;\n  }\n\n\n}\nglobals(defs);\nexport default defs;\n","import defs from './defs';\nimport wkt from 'wkt-parser';\nimport projStr from './projString';\nfunction testObj(code){\n  return typeof code === 'string';\n}\nfunction testDef(code){\n  return code in defs;\n}\n var codeWords = ['PROJECTEDCRS', 'PROJCRS', 'GEOGCS','GEOCCS','PROJCS','LOCAL_CS', 'GEODCRS', 'GEODETICCRS', 'GEODETICDATUM', 'ENGCRS', 'ENGINEERINGCRS']; \nfunction testWKT(code){\n  return codeWords.some(function (word) {\n    return code.indexOf(word) > -1;\n  });\n}\nfunction testProj(code){\n  return code[0] === '+';\n}\nfunction parse(code){\n  if (testObj(code)) {\n    //check to see if this is a WKT string\n    if (testDef(code)) {\n      return defs[code];\n    }\n    if (testWKT(code)) {\n      return wkt(code);\n    }\n    if (testProj(code)) {\n      return projStr(code);\n    }\n  }else{\n    return code;\n  }\n}\n\nexport default parse;\n","export default function(destination, source) {\n  destination = destination || {};\n  var value, property;\n  if (!source) {\n    return destination;\n  }\n  for (property in source) {\n    value = source[property];\n    if (value !== undefined) {\n      destination[property] = value;\n    }\n  }\n  return destination;\n}\n","export default function(eccent, sinphi, cosphi) {\n  var con = eccent * sinphi;\n  return cosphi / (Math.sqrt(1 - con * con));\n}","export default function(x) {\n  return x<0 ? -1 : 1;\n}","\nimport {TWO_PI, SPI} from '../constants/values';\nimport sign from './sign';\n\nexport default function(x) {\n  return (Math.abs(x) <= SPI) ? x : (x - (sign(x) * TWO_PI));\n}\n","import {HALF_PI} from '../constants/values';\n\nexport default function(eccent, phi, sinphi) {\n  var con = eccent * sinphi;\n  var com = 0.5 * eccent;\n  con = Math.pow(((1 - con) / (1 + con)), com);\n  return (Math.tan(0.5 * (HALF_PI - phi)) / con);\n}\n","import {HALF_PI} from '../constants/values';\n\nexport default function(eccent, ts) {\n  var eccnth = 0.5 * eccent;\n  var con, dphi;\n  var phi = HALF_PI - 2 * Math.atan(ts);\n  for (var i = 0; i <= 15; i++) {\n    con = eccent * Math.sin(phi);\n    dphi = HALF_PI - 2 * Math.atan(ts * (Math.pow(((1 - con) / (1 + con)), eccnth))) - phi;\n    phi += dphi;\n    if (Math.abs(dphi) <= 0.0000000001) {\n      return phi;\n    }\n  }\n  //console.log(\"phi2z has NoConvergence\");\n  return -9999;\n}\n","export function init() {\n  //no-op for longlat\n}\n\nfunction identity(pt) {\n  return pt;\n}\nexport {identity as forward};\nexport {identity as inverse};\nexport var names = [\"longlat\", \"identity\"];\nexport default {\n  init: init,\n  forward: identity,\n  inverse: identity,\n  names: names\n};\n","import merc from \"./projections/merc\";\nimport longlat from \"./projections/longlat\";\nvar projs = [merc, longlat];\nvar names = {};\nvar projStore = [];\n\nfunction add(proj, i) {\n  var len = projStore.length;\n  if (!proj.names) {\n    console.log(i);\n    return true;\n  }\n  projStore[len] = proj;\n  proj.names.forEach(function(n) {\n    names[n.toLowerCase()] = len;\n  });\n  return this;\n}\n\nexport {add};\n\nexport function get(name) {\n  if (!name) {\n    return false;\n  }\n  var n = name.toLowerCase();\n  if (typeof names[n] !== 'undefined' && projStore[names[n]]) {\n    return projStore[names[n]];\n  }\n}\n\nexport function start() {\n  projs.forEach(add);\n}\nexport default {\n  start: start,\n  add: add,\n  get: get\n};\n","import msfnz from '../common/msfnz';\n\nimport adjust_lon from '../common/adjust_lon';\nimport tsfnz from '../common/tsfnz';\nimport phi2z from '../common/phi2z';\nimport {FORTPI, R2D, EPSLN, HALF_PI} from '../constants/values';\nexport function init() {\n  var con = this.b / this.a;\n  this.es = 1 - con * con;\n  if(!('x0' in this)){\n    this.x0 = 0;\n  }\n  if(!('y0' in this)){\n    this.y0 = 0;\n  }\n  this.e = Math.sqrt(this.es);\n  if (this.lat_ts) {\n    if (this.sphere) {\n      this.k0 = Math.cos(this.lat_ts);\n    }\n    else {\n      this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));\n    }\n  }\n  else {\n    if (!this.k0) {\n      if (this.k) {\n        this.k0 = this.k;\n      }\n      else {\n        this.k0 = 1;\n      }\n    }\n  }\n}\n\n/* Mercator forward equations--mapping lat,long to x,y\n  --------------------------------------------------*/\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  // convert to radians\n  if (lat * R2D > 90 && lat * R2D < -90 && lon * R2D > 180 && lon * R2D < -180) {\n    return null;\n  }\n\n  var x, y;\n  if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {\n    return null;\n  }\n  else {\n    if (this.sphere) {\n      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);\n      y = this.y0 + this.a * this.k0 * Math.log(Math.tan(FORTPI + 0.5 * lat));\n    }\n    else {\n      var sinphi = Math.sin(lat);\n      var ts = tsfnz(this.e, lat, sinphi);\n      x = this.x0 + this.a * this.k0 * adjust_lon(lon - this.long0);\n      y = this.y0 - this.a * this.k0 * Math.log(ts);\n    }\n    p.x = x;\n    p.y = y;\n    return p;\n  }\n}\n\n/* Mercator inverse equations--mapping x,y to lat/long\n  --------------------------------------------------*/\nexport function inverse(p) {\n\n  var x = p.x - this.x0;\n  var y = p.y - this.y0;\n  var lon, lat;\n\n  if (this.sphere) {\n    lat = HALF_PI - 2 * Math.atan(Math.exp(-y / (this.a * this.k0)));\n  }\n  else {\n    var ts = Math.exp(-y / (this.a * this.k0));\n    lat = phi2z(this.e, ts);\n    if (lat === -9999) {\n      return null;\n    }\n  }\n  lon = adjust_lon(this.long0 + x / (this.a * this.k0));\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Mercator\", \"Popular Visualisation Pseudo Mercator\", \"Mercator_1SP\", \"Mercator_Auxiliary_Sphere\", \"merc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","var exports = {};\nexport {exports as default};\nexports.MERIT = {\n  a: 6378137.0,\n  rf: 298.257,\n  ellipseName: \"MERIT 1983\"\n};\n\nexports.SGS85 = {\n  a: 6378136.0,\n  rf: 298.257,\n  ellipseName: \"Soviet Geodetic System 85\"\n};\n\nexports.GRS80 = {\n  a: 6378137.0,\n  rf: 298.257222101,\n  ellipseName: \"GRS 1980(IUGG, 1980)\"\n};\n\nexports.IAU76 = {\n  a: 6378140.0,\n  rf: 298.257,\n  ellipseName: \"IAU 1976\"\n};\n\nexports.airy = {\n  a: 6377563.396,\n  b: 6356256.910,\n  ellipseName: \"Airy 1830\"\n};\n\nexports.APL4 = {\n  a: 6378137,\n  rf: 298.25,\n  ellipseName: \"Appl. Physics. 1965\"\n};\n\nexports.NWL9D = {\n  a: 6378145.0,\n  rf: 298.25,\n  ellipseName: \"Naval Weapons Lab., 1965\"\n};\n\nexports.mod_airy = {\n  a: 6377340.189,\n  b: 6356034.446,\n  ellipseName: \"Modified Airy\"\n};\n\nexports.andrae = {\n  a: 6377104.43,\n  rf: 300.0,\n  ellipseName: \"Andrae 1876 (Den., Iclnd.)\"\n};\n\nexports.aust_SA = {\n  a: 6378160.0,\n  rf: 298.25,\n  ellipseName: \"Australian Natl & S. Amer. 1969\"\n};\n\nexports.GRS67 = {\n  a: 6378160.0,\n  rf: 298.2471674270,\n  ellipseName: \"GRS 67(IUGG 1967)\"\n};\n\nexports.bessel = {\n  a: 6377397.155,\n  rf: 299.1528128,\n  ellipseName: \"Bessel 1841\"\n};\n\nexports.bess_nam = {\n  a: 6377483.865,\n  rf: 299.1528128,\n  ellipseName: \"Bessel 1841 (Namibia)\"\n};\n\nexports.clrk66 = {\n  a: 6378206.4,\n  b: 6356583.8,\n  ellipseName: \"Clarke 1866\"\n};\n\nexports.clrk80 = {\n  a: 6378249.145,\n  rf: 293.4663,\n  ellipseName: \"Clarke 1880 mod.\"\n};\n\nexports.clrk58 = {\n  a: 6378293.645208759,\n  rf: 294.2606763692654,\n  ellipseName: \"Clarke 1858\"\n};\n\nexports.CPM = {\n  a: 6375738.7,\n  rf: 334.29,\n  ellipseName: \"Comm. des Poids et Mesures 1799\"\n};\n\nexports.delmbr = {\n  a: 6376428.0,\n  rf: 311.5,\n  ellipseName: \"Delambre 1810 (Belgium)\"\n};\n\nexports.engelis = {\n  a: 6378136.05,\n  rf: 298.2566,\n  ellipseName: \"Engelis 1985\"\n};\n\nexports.evrst30 = {\n  a: 6377276.345,\n  rf: 300.8017,\n  ellipseName: \"Everest 1830\"\n};\n\nexports.evrst48 = {\n  a: 6377304.063,\n  rf: 300.8017,\n  ellipseName: \"Everest 1948\"\n};\n\nexports.evrst56 = {\n  a: 6377301.243,\n  rf: 300.8017,\n  ellipseName: \"Everest 1956\"\n};\n\nexports.evrst69 = {\n  a: 6377295.664,\n  rf: 300.8017,\n  ellipseName: \"Everest 1969\"\n};\n\nexports.evrstSS = {\n  a: 6377298.556,\n  rf: 300.8017,\n  ellipseName: \"Everest (Sabah & Sarawak)\"\n};\n\nexports.fschr60 = {\n  a: 6378166.0,\n  rf: 298.3,\n  ellipseName: \"Fischer (Mercury Datum) 1960\"\n};\n\nexports.fschr60m = {\n  a: 6378155.0,\n  rf: 298.3,\n  ellipseName: \"Fischer 1960\"\n};\n\nexports.fschr68 = {\n  a: 6378150.0,\n  rf: 298.3,\n  ellipseName: \"Fischer 1968\"\n};\n\nexports.helmert = {\n  a: 6378200.0,\n  rf: 298.3,\n  ellipseName: \"Helmert 1906\"\n};\n\nexports.hough = {\n  a: 6378270.0,\n  rf: 297.0,\n  ellipseName: \"Hough\"\n};\n\nexports.intl = {\n  a: 6378388.0,\n  rf: 297.0,\n  ellipseName: \"International 1909 (Hayford)\"\n};\n\nexports.kaula = {\n  a: 6378163.0,\n  rf: 298.24,\n  ellipseName: \"Kaula 1961\"\n};\n\nexports.lerch = {\n  a: 6378139.0,\n  rf: 298.257,\n  ellipseName: \"Lerch 1979\"\n};\n\nexports.mprts = {\n  a: 6397300.0,\n  rf: 191.0,\n  ellipseName: \"Maupertius 1738\"\n};\n\nexports.new_intl = {\n  a: 6378157.5,\n  b: 6356772.2,\n  ellipseName: \"New International 1967\"\n};\n\nexports.plessis = {\n  a: 6376523.0,\n  rf: 6355863.0,\n  ellipseName: \"Plessis 1817 (France)\"\n};\n\nexports.krass = {\n  a: 6378245.0,\n  rf: 298.3,\n  ellipseName: \"Krassovsky, 1942\"\n};\n\nexports.SEasia = {\n  a: 6378155.0,\n  b: 6356773.3205,\n  ellipseName: \"Southeast Asia\"\n};\n\nexports.walbeck = {\n  a: 6376896.0,\n  b: 6355834.8467,\n  ellipseName: \"Walbeck\"\n};\n\nexports.WGS60 = {\n  a: 6378165.0,\n  rf: 298.3,\n  ellipseName: \"WGS 60\"\n};\n\nexports.WGS66 = {\n  a: 6378145.0,\n  rf: 298.25,\n  ellipseName: \"WGS 66\"\n};\n\nexports.WGS7 = {\n  a: 6378135.0,\n  rf: 298.26,\n  ellipseName: \"WGS 72\"\n};\n\nexport var WGS84 = exports.WGS84 = {\n  a: 6378137.0,\n  rf: 298.257223563,\n  ellipseName: \"WGS 84\"\n};\n\nexports.sphere = {\n  a: 6370997.0,\n  b: 6370997.0,\n  ellipseName: \"Normal Sphere (r=6370997)\"\n};\n","var exports = {};\nexport {exports as default};\nexports.wgs84 = {\n  towgs84: \"0,0,0\",\n  ellipse: \"WGS84\",\n  datumName: \"WGS84\"\n};\n\nexports.ch1903 = {\n  towgs84: \"674.374,15.056,405.346\",\n  ellipse: \"bessel\",\n  datumName: \"swiss\"\n};\n\nexports.ggrs87 = {\n  towgs84: \"-199.87,74.79,246.62\",\n  ellipse: \"GRS80\",\n  datumName: \"Greek_Geodetic_Reference_System_1987\"\n};\n\nexports.nad83 = {\n  towgs84: \"0,0,0\",\n  ellipse: \"GRS80\",\n  datumName: \"North_American_Datum_1983\"\n};\n\nexports.nad27 = {\n  nadgrids: \"@conus,@alaska,@ntv2_0.gsb,@ntv1_can.dat\",\n  ellipse: \"clrk66\",\n  datumName: \"North_American_Datum_1927\"\n};\n\nexports.potsdam = {\n  towgs84: \"606.0,23.0,413.0\",\n  ellipse: \"bessel\",\n  datumName: \"Potsdam Rauenberg 1950 DHDN\"\n};\n\nexports.carthage = {\n  towgs84: \"-263.0,6.0,431.0\",\n  ellipse: \"clark80\",\n  datumName: \"Carthage 1934 Tunisia\"\n};\n\nexports.hermannskogel = {\n  towgs84: \"653.0,-212.0,449.0\",\n  ellipse: \"bessel\",\n  datumName: \"Hermannskogel\"\n};\n\nexports.ire65 = {\n  towgs84: \"482.530,-130.596,564.557,-1.042,-0.214,-0.631,8.15\",\n  ellipse: \"mod_airy\",\n  datumName: \"Ireland 1965\"\n};\n\nexports.rassadiran = {\n  towgs84: \"-133.63,-157.5,-158.62\",\n  ellipse: \"intl\",\n  datumName: \"Rassadiran\"\n};\n\nexports.nzgd49 = {\n  towgs84: \"59.47,-5.04,187.44,0.47,-0.1,1.024,-4.5993\",\n  ellipse: \"intl\",\n  datumName: \"New Zealand Geodetic Datum 1949\"\n};\n\nexports.osgb36 = {\n  towgs84: \"446.448,-125.157,542.060,0.1502,0.2470,0.8421,-20.4894\",\n  ellipse: \"airy\",\n  datumName: \"Airy 1830\"\n};\n\nexports.s_jtsk = {\n  towgs84: \"589,76,480\",\n  ellipse: 'bessel',\n  datumName: 'S-JTSK (Ferro)'\n};\n\nexports.beduaram = {\n  towgs84: '-106,-87,188',\n  ellipse: 'clrk80',\n  datumName: 'Beduaram'\n};\n\nexports.gunung_segara = {\n  towgs84: '-403,684,41',\n  ellipse: 'bessel',\n  datumName: 'Gunung Segara Jakarta'\n};\n\nexports.rnb72 = {\n  towgs84: \"106.869,-52.2978,103.724,-0.33657,0.456955,-1.84218,1\",\n  ellipse: \"intl\",\n  datumName: \"Reseau National Belge 1972\"\n};\n","import {PJD_3PARAM, PJD_7PARAM, PJD_WGS84, PJD_NODATUM, SEC_TO_RAD} from './constants/values';\n\nfunction datum(datumCode, datum_params, a, b, es, ep2) {\n  var out = {};\n\n  if (datumCode === undefined || datumCode === 'none') {\n    out.datum_type = PJD_NODATUM;\n  } else {\n    out.datum_type = PJD_WGS84;\n  }\n\n  if (datum_params) {\n    out.datum_params = datum_params.map(parseFloat);\n    if (out.datum_params[0] !== 0 || out.datum_params[1] !== 0 || out.datum_params[2] !== 0) {\n      out.datum_type = PJD_3PARAM;\n    }\n    if (out.datum_params.length > 3) {\n      if (out.datum_params[3] !== 0 || out.datum_params[4] !== 0 || out.datum_params[5] !== 0 || out.datum_params[6] !== 0) {\n        out.datum_type = PJD_7PARAM;\n        out.datum_params[3] *= SEC_TO_RAD;\n        out.datum_params[4] *= SEC_TO_RAD;\n        out.datum_params[5] *= SEC_TO_RAD;\n        out.datum_params[6] = (out.datum_params[6] / 1000000.0) + 1.0;\n      }\n    }\n  }\n\n  out.a = a; //datum object also uses these values\n  out.b = b;\n  out.es = es;\n  out.ep2 = ep2;\n  return out;\n}\n\nexport default datum;\n","import parseCode from './parseCode';\nimport extend from './extend';\nimport projections from './projections';\nimport {sphere as dc_sphere, eccentricity as dc_eccentricity} from './deriveConstants';\nimport Datum from './constants/Datum';\nimport datum from './datum';\nimport match from './match';\n\nfunction Projection(srsCode,callback) {\n  if (!(this instanceof Projection)) {\n    return new Projection(srsCode);\n  }\n  callback = callback || function(error){\n    if(error){\n      throw error;\n    }\n  };\n  var json = parseCode(srsCode);\n  if(typeof json !== 'object'){\n    callback(srsCode);\n    return;\n  }\n  var ourProj = Projection.projections.get(json.projName);\n  if(!ourProj){\n    callback(srsCode);\n    return;\n  }\n  if (json.datumCode && json.datumCode !== 'none') {\n    var datumDef = match(Datum, json.datumCode);\n    if (datumDef) {\n      json.datum_params = datumDef.towgs84 ? datumDef.towgs84.split(',') : null;\n      json.ellps = datumDef.ellipse;\n      json.datumName = datumDef.datumName ? datumDef.datumName : json.datumCode;\n    }\n  }\n  json.k0 = json.k0 || 1.0;\n  json.axis = json.axis || 'enu';\n  json.ellps = json.ellps || 'wgs84';\n  var sphere_ = dc_sphere(json.a, json.b, json.rf, json.ellps, json.sphere);\n  var ecc = dc_eccentricity(sphere_.a, sphere_.b, sphere_.rf, json.R_A);\n  var datumObj = json.datum || datum(json.datumCode, json.datum_params, sphere_.a, sphere_.b, ecc.es, ecc.ep2);\n\n  extend(this, json); // transfer everything over from the projection because we don't know what we'll need\n  extend(this, ourProj); // transfer all the methods from the projection\n\n  // copy the 4 things over we calulated in deriveConstants.sphere\n  this.a = sphere_.a;\n  this.b = sphere_.b;\n  this.rf = sphere_.rf;\n  this.sphere = sphere_.sphere;\n\n  // copy the 3 things we calculated in deriveConstants.eccentricity\n  this.es = ecc.es;\n  this.e = ecc.e;\n  this.ep2 = ecc.ep2;\n\n  // add in the datum object\n  this.datum = datumObj;\n\n  // init the projection\n  this.init();\n\n  // legecy callback from back in the day when it went to spatialreference.org\n  callback(null, this);\n\n}\nProjection.projections = projections;\nProjection.projections.start();\nexport default Projection;\n","import {SIXTH, RA4, RA6, EPSLN} from './constants/values';\nimport {default as Ellipsoid, WGS84} from './constants/Ellipsoid';\nimport match from './match';\n\nexport function eccentricity(a, b, rf, R_A) {\n  var a2 = a * a; // used in geocentric\n  var b2 = b * b; // used in geocentric\n  var es = (a2 - b2) / a2; // e ^ 2\n  var e = 0;\n  if (R_A) {\n    a *= 1 - es * (SIXTH + es * (RA4 + es * RA6));\n    a2 = a * a;\n    es = 0;\n  } else {\n    e = Math.sqrt(es); // eccentricity\n  }\n  var ep2 = (a2 - b2) / b2; // used in geocentric\n  return {\n    es: es,\n    e: e,\n    ep2: ep2\n  };\n}\nexport function sphere(a, b, rf, ellps, sphere) {\n  if (!a) { // do we have an ellipsoid?\n    var ellipse = match(Ellipsoid, ellps);\n    if (!ellipse) {\n      ellipse = WGS84;\n    }\n    a = ellipse.a;\n    b = ellipse.b;\n    rf = ellipse.rf;\n  }\n\n  if (rf && !b) {\n    b = (1.0 - 1.0 / rf) * a;\n  }\n  if (rf === 0 || Math.abs(a - b) < EPSLN) {\n    sphere = true;\n    b = a;\n  }\n  return {\n    a: a,\n    b: b,\n    rf: rf,\n    sphere: sphere\n  };\n}\n","'use strict';\nimport {PJD_3PARAM, PJD_7PARAM, HALF_PI} from './constants/values';\nexport function compareDatums(source, dest) {\n  if (source.datum_type !== dest.datum_type) {\n    return false; // false, datums are not equal\n  } else if (source.a !== dest.a || Math.abs(source.es - dest.es) > 0.000000000050) {\n    // the tolerance for es is to ensure that GRS80 and WGS84\n    // are considered identical\n    return false;\n  } else if (source.datum_type === PJD_3PARAM) {\n    return (source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2]);\n  } else if (source.datum_type === PJD_7PARAM) {\n    return (source.datum_params[0] === dest.datum_params[0] && source.datum_params[1] === dest.datum_params[1] && source.datum_params[2] === dest.datum_params[2] && source.datum_params[3] === dest.datum_params[3] && source.datum_params[4] === dest.datum_params[4] && source.datum_params[5] === dest.datum_params[5] && source.datum_params[6] === dest.datum_params[6]);\n  } else {\n    return true; // datums are equal\n  }\n} // cs_compare_datums()\n\n/*\n * The function Convert_Geodetic_To_Geocentric converts geodetic coordinates\n * (latitude, longitude, and height) to geocentric coordinates (X, Y, Z),\n * according to the current ellipsoid parameters.\n *\n *    Latitude  : Geodetic latitude in radians                     (input)\n *    Longitude : Geodetic longitude in radians                    (input)\n *    Height    : Geodetic height, in meters                       (input)\n *    X         : Calculated Geocentric X coordinate, in meters    (output)\n *    Y         : Calculated Geocentric Y coordinate, in meters    (output)\n *    Z         : Calculated Geocentric Z coordinate, in meters    (output)\n *\n */\nexport function geodeticToGeocentric(p, es, a) {\n  var Longitude = p.x;\n  var Latitude = p.y;\n  var Height = p.z ? p.z : 0; //Z value not always supplied\n\n  var Rn; /*  Earth radius at location  */\n  var Sin_Lat; /*  Math.sin(Latitude)  */\n  var Sin2_Lat; /*  Square of Math.sin(Latitude)  */\n  var Cos_Lat; /*  Math.cos(Latitude)  */\n\n  /*\n   ** Don't blow up if Latitude is just a little out of the value\n   ** range as it may just be a rounding issue.  Also removed longitude\n   ** test, it should be wrapped by Math.cos() and Math.sin().  NFW for PROJ.4, Sep/2001.\n   */\n  if (Latitude < -HALF_PI && Latitude > -1.001 * HALF_PI) {\n    Latitude = -HALF_PI;\n  } else if (Latitude > HALF_PI && Latitude < 1.001 * HALF_PI) {\n    Latitude = HALF_PI;\n  } else if ((Latitude < -HALF_PI) || (Latitude > HALF_PI)) {\n    /* Latitude out of range */\n    //..reportError('geocent:lat out of range:' + Latitude);\n    return null;\n  }\n\n  if (Longitude > Math.PI) {\n    Longitude -= (2 * Math.PI);\n  }\n  Sin_Lat = Math.sin(Latitude);\n  Cos_Lat = Math.cos(Latitude);\n  Sin2_Lat = Sin_Lat * Sin_Lat;\n  Rn = a / (Math.sqrt(1.0e0 - es * Sin2_Lat));\n  return {\n    x: (Rn + Height) * Cos_Lat * Math.cos(Longitude),\n    y: (Rn + Height) * Cos_Lat * Math.sin(Longitude),\n    z: ((Rn * (1 - es)) + Height) * Sin_Lat\n  };\n} // cs_geodetic_to_geocentric()\n\nexport function geocentricToGeodetic(p, es, a, b) {\n  /* local defintions and variables */\n  /* end-criterium of loop, accuracy of sin(Latitude) */\n  var genau = 1e-12;\n  var genau2 = (genau * genau);\n  var maxiter = 30;\n\n  var P; /* distance between semi-minor axis and location */\n  var RR; /* distance between center and location */\n  var CT; /* sin of geocentric latitude */\n  var ST; /* cos of geocentric latitude */\n  var RX;\n  var RK;\n  var RN; /* Earth radius at location */\n  var CPHI0; /* cos of start or old geodetic latitude in iterations */\n  var SPHI0; /* sin of start or old geodetic latitude in iterations */\n  var CPHI; /* cos of searched geodetic latitude */\n  var SPHI; /* sin of searched geodetic latitude */\n  var SDPHI; /* end-criterium: addition-theorem of sin(Latitude(iter)-Latitude(iter-1)) */\n  var iter; /* # of continous iteration, max. 30 is always enough (s.a.) */\n\n  var X = p.x;\n  var Y = p.y;\n  var Z = p.z ? p.z : 0.0; //Z value not always supplied\n  var Longitude;\n  var Latitude;\n  var Height;\n\n  P = Math.sqrt(X * X + Y * Y);\n  RR = Math.sqrt(X * X + Y * Y + Z * Z);\n\n  /*      special cases for latitude and longitude */\n  if (P / a < genau) {\n\n    /*  special case, if P=0. (X=0., Y=0.) */\n    Longitude = 0.0;\n\n    /*  if (X,Y,Z)=(0.,0.,0.) then Height becomes semi-minor axis\n     *  of ellipsoid (=center of mass), Latitude becomes PI/2 */\n    if (RR / a < genau) {\n      Latitude = HALF_PI;\n      Height = -b;\n      return {\n        x: p.x,\n        y: p.y,\n        z: p.z\n      };\n    }\n  } else {\n    /*  ellipsoidal (geodetic) longitude\n     *  interval: -PI < Longitude <= +PI */\n    Longitude = Math.atan2(Y, X);\n  }\n\n  /* --------------------------------------------------------------\n   * Following iterative algorithm was developped by\n   * \"Institut for Erdmessung\", University of Hannover, July 1988.\n   * Internet: www.ife.uni-hannover.de\n   * Iterative computation of CPHI,SPHI and Height.\n   * Iteration of CPHI and SPHI to 10**-12 radian resp.\n   * 2*10**-7 arcsec.\n   * --------------------------------------------------------------\n   */\n  CT = Z / RR;\n  ST = P / RR;\n  RX = 1.0 / Math.sqrt(1.0 - es * (2.0 - es) * ST * ST);\n  CPHI0 = ST * (1.0 - es) * RX;\n  SPHI0 = CT * RX;\n  iter = 0;\n\n  /* loop to find sin(Latitude) resp. Latitude\n   * until |sin(Latitude(iter)-Latitude(iter-1))| < genau */\n  do {\n    iter++;\n    RN = a / Math.sqrt(1.0 - es * SPHI0 * SPHI0);\n\n    /*  ellipsoidal (geodetic) height */\n    Height = P * CPHI0 + Z * SPHI0 - RN * (1.0 - es * SPHI0 * SPHI0);\n\n    RK = es * RN / (RN + Height);\n    RX = 1.0 / Math.sqrt(1.0 - RK * (2.0 - RK) * ST * ST);\n    CPHI = ST * (1.0 - RK) * RX;\n    SPHI = CT * RX;\n    SDPHI = SPHI * CPHI0 - CPHI * SPHI0;\n    CPHI0 = CPHI;\n    SPHI0 = SPHI;\n  }\n  while (SDPHI * SDPHI > genau2 && iter < maxiter);\n\n  /*      ellipsoidal (geodetic) latitude */\n  Latitude = Math.atan(SPHI / Math.abs(CPHI));\n  return {\n    x: Longitude,\n    y: Latitude,\n    z: Height\n  };\n} // cs_geocentric_to_geodetic()\n\n/****************************************************************/\n// pj_geocentic_to_wgs84( p )\n//  p = point to transform in geocentric coordinates (x,y,z)\n\n\n/** point object, nothing fancy, just allows values to be\n    passed back and forth by reference rather than by value.\n    Other point classes may be used as long as they have\n    x and y properties, which will get modified in the transform method.\n*/\nexport function geocentricToWgs84(p, datum_type, datum_params) {\n\n  if (datum_type === PJD_3PARAM) {\n    // if( x[io] === HUGE_VAL )\n    //    continue;\n    return {\n      x: p.x + datum_params[0],\n      y: p.y + datum_params[1],\n      z: p.z + datum_params[2],\n    };\n  } else if (datum_type === PJD_7PARAM) {\n    var Dx_BF = datum_params[0];\n    var Dy_BF = datum_params[1];\n    var Dz_BF = datum_params[2];\n    var Rx_BF = datum_params[3];\n    var Ry_BF = datum_params[4];\n    var Rz_BF = datum_params[5];\n    var M_BF = datum_params[6];\n    // if( x[io] === HUGE_VAL )\n    //    continue;\n    return {\n      x: M_BF * (p.x - Rz_BF * p.y + Ry_BF * p.z) + Dx_BF,\n      y: M_BF * (Rz_BF * p.x + p.y - Rx_BF * p.z) + Dy_BF,\n      z: M_BF * (-Ry_BF * p.x + Rx_BF * p.y + p.z) + Dz_BF\n    };\n  }\n} // cs_geocentric_to_wgs84\n\n/****************************************************************/\n// pj_geocentic_from_wgs84()\n//  coordinate system definition,\n//  point to transform in geocentric coordinates (x,y,z)\nexport function geocentricFromWgs84(p, datum_type, datum_params) {\n\n  if (datum_type === PJD_3PARAM) {\n    //if( x[io] === HUGE_VAL )\n    //    continue;\n    return {\n      x: p.x - datum_params[0],\n      y: p.y - datum_params[1],\n      z: p.z - datum_params[2],\n    };\n\n  } else if (datum_type === PJD_7PARAM) {\n    var Dx_BF = datum_params[0];\n    var Dy_BF = datum_params[1];\n    var Dz_BF = datum_params[2];\n    var Rx_BF = datum_params[3];\n    var Ry_BF = datum_params[4];\n    var Rz_BF = datum_params[5];\n    var M_BF = datum_params[6];\n    var x_tmp = (p.x - Dx_BF) / M_BF;\n    var y_tmp = (p.y - Dy_BF) / M_BF;\n    var z_tmp = (p.z - Dz_BF) / M_BF;\n    //if( x[io] === HUGE_VAL )\n    //    continue;\n\n    return {\n      x: x_tmp + Rz_BF * y_tmp - Ry_BF * z_tmp,\n      y: -Rz_BF * x_tmp + y_tmp + Rx_BF * z_tmp,\n      z: Ry_BF * x_tmp - Rx_BF * y_tmp + z_tmp\n    };\n  } //cs_geocentric_from_wgs84()\n}\n","import {PJD_3PARAM, PJD_7PARAM, PJD_NODATUM} from './constants/values';\n\nimport {geodeticToGeocentric, geocentricToGeodetic, geocentricToWgs84, geocentricFromWgs84, compareDatums} from './datumUtils';\nfunction checkParams(type) {\n  return (type === PJD_3PARAM || type === PJD_7PARAM);\n}\n\nexport default function(source, dest, point) {\n  // Short cut if the datums are identical.\n  if (compareDatums(source, dest)) {\n    return point; // in this case, zero is sucess,\n    // whereas cs_compare_datums returns 1 to indicate TRUE\n    // confusing, should fix this\n  }\n\n  // Explicitly skip datum transform by setting 'datum=none' as parameter for either source or dest\n  if (source.datum_type === PJD_NODATUM || dest.datum_type === PJD_NODATUM) {\n    return point;\n  }\n\n  // If this datum requires grid shifts, then apply it to geodetic coordinates.\n\n  // Do we need to go through geocentric coordinates?\n  if (source.es === dest.es && source.a === dest.a && !checkParams(source.datum_type) &&  !checkParams(dest.datum_type)) {\n    return point;\n  }\n\n  // Convert to geocentric coordinates.\n  point = geodeticToGeocentric(point, source.es, source.a);\n  // Convert between datums\n  if (checkParams(source.datum_type)) {\n    point = geocentricToWgs84(point, source.datum_type, source.datum_params);\n  }\n  if (checkParams(dest.datum_type)) {\n    point = geocentricFromWgs84(point, dest.datum_type, dest.datum_params);\n  }\n  return geocentricToGeodetic(point, dest.es, dest.a, dest.b);\n\n}\n","export default function(crs, denorm, point) {\n  var xin = point.x,\n    yin = point.y,\n    zin = point.z || 0.0;\n  var v, t, i;\n  var out = {};\n  for (i = 0; i < 3; i++) {\n    if (denorm && i === 2 && point.z === undefined) {\n      continue;\n    }\n    if (i === 0) {\n      v = xin;\n      t = 'x';\n    }\n    else if (i === 1) {\n      v = yin;\n      t = 'y';\n    }\n    else {\n      v = zin;\n      t = 'z';\n    }\n    switch (crs.axis[i]) {\n    case 'e':\n      out[t] = v;\n      break;\n    case 'w':\n      out[t] = -v;\n      break;\n    case 'n':\n      out[t] = v;\n      break;\n    case 's':\n      out[t] = -v;\n      break;\n    case 'u':\n      if (point[t] !== undefined) {\n        out.z = v;\n      }\n      break;\n    case 'd':\n      if (point[t] !== undefined) {\n        out.z = -v;\n      }\n      break;\n    default:\n      //console.log(\"ERROR: unknow axis (\"+crs.axis[i]+\") - check definition of \"+crs.projName);\n      return null;\n    }\n  }\n  return out;\n}\n","export default function (array){\n  var out = {\n    x: array[0],\n    y: array[1]\n  };\n  if (array.length>2) {\n    out.z = array[2];\n  }\n  if (array.length>3) {\n    out.m = array[3];\n  }\n  return out;\n}","import {D2R, R2D, PJD_3PARAM, PJD_7PARAM} from './constants/values';\nimport datum_transform from './datum_transform';\nimport {geodeticToGeocentric, geocentricToGeodetic} from './datumUtils';\nimport adjust_axis from './adjust_axis';\nimport proj from './Proj';\nimport toPoint from './common/toPoint';\nfunction checkNotWGS(source, dest) {\n  return ((source.datum.datum_type === PJD_3PARAM || source.datum.datum_type === PJD_7PARAM) && dest.datumCode !== 'WGS84') || ((dest.datum.datum_type === PJD_3PARAM || dest.datum.datum_type === PJD_7PARAM) && source.datumCode !== 'WGS84');\n}\n\nexport default function transform(source, dest, point) {\n  var wgs84;\n  if (Array.isArray(point)) {\n    point = toPoint(point);\n  }\n\n  // Workaround for datum shifts towgs84, if either source or destination projection is not wgs84\n  if (source.datum && dest.datum && checkNotWGS(source, dest)) {\n    wgs84 = new proj('WGS84');\n    point = transform(source, wgs84, point);\n    source = wgs84;\n  }\n  // DGR, 2010/11/12\n  if (source.axis !== 'enu') {\n    point = adjust_axis(source, false, point);\n  }\n  // Transform source points to long/lat, if they aren't already.\n  if (source.projName === 'longlat') {\n    point.x *= D2R;\n    point.y *= D2R;\n  }\n  else {\n    if (source.isGeocent) {\n      if (source.to_meter) {\n        point.x *= source.to_meter;\n        point.y *= source.to_meter;\n        point.z *= source.to_meter;\n      }\n      // originally dest.datum.geocentric_to_geodetic_noniter(point);\n      point = geocentricToGeodetic(point, dest.es, dest.a, dest.b);\n    } else {\n      if (source.to_meter) {\n        point.x *= source.to_meter;\n        point.y *= source.to_meter;\n      }\n      point = source.inverse(point); // Convert Cartesian to longlat\n    }\n  }\n// Adjust for the prime meridian if necessary\n  if (source.from_greenwich) {\n    point.x += source.from_greenwich;\n  }\n\n// Convert datums if needed, and if possible.\n  point = datum_transform(source.datum, dest.datum, point);\n\n// Adjust for the prime meridian if necessary\n  if (dest.from_greenwich) {\n    point.x -= dest.from_greenwich;\n  }\n\n  if (dest.projName === 'longlat') {\n    // convert radians to decimal degrees\n    point.x *= R2D;\n    point.y *= R2D;\n  } else { // else project\n    if (dest.isGeocent) {\n      point = geodeticToGeocentric(point, dest.es, dest.a);\n      if (dest.to_meter) {\n        point.x /= dest.to_meter;\n        point.y /= dest.to_meter;\n        point.z /= dest.to_meter;\n      }\n    } else {\n      dest.forward(point);\n      if (dest.to_meter) {\n        point.x /= dest.to_meter;\n        point.y /= dest.to_meter;\n      }\n    }\n  }\n\n// DGR, 2010/11/12\n  if (dest.axis !== 'enu') {\n    return adjust_axis(dest, true, point);\n  }\n\n  return point;\n}\n","import proj from './Proj';\nimport transform from './transform';\nvar wgs84 = proj('WGS84');\n\nfunction transformer(from, to, coords) {\n  var transformedArray;\n  if (Array.isArray(coords)) {\n    transformedArray = transform(from, to, coords);\n    if (coords.length === 3) {\n      return [transformedArray.x, transformedArray.y, transformedArray.z];\n    }\n    else {\n      return [transformedArray.x, transformedArray.y];\n    }\n  }\n  else {\n    return transform(from, to, coords);\n  }\n}\n\nfunction checkProj(item) {\n  if (item instanceof proj) {\n    return item;\n  }\n  if (item.oProj) {\n    return item.oProj;\n  }\n  return proj(item);\n}\nfunction proj4(fromProj, toProj, coord, retProj) {\n  if(retProj) {\n    return fromProj;\n  }\n  fromProj = checkProj(fromProj);\n  var single = false;\n  var obj;\n  if (typeof toProj === 'undefined') {\n    toProj = fromProj;\n    fromProj = wgs84;\n    single = true;\n  }\n  else if (typeof toProj.x !== 'undefined' || Array.isArray(toProj)) {\n    coord = toProj;\n    toProj = fromProj;\n    fromProj = wgs84;\n    single = true;\n  }\n  toProj = checkProj(toProj);\n  if (coord) {\n    return transformer(fromProj, toProj, coord);\n  }\n  else {\n    obj = {\n      forward: function (coords) {\n        return transformer(fromProj, toProj, coords);\n      },\n      inverse: function (coords) {\n        return transformer(toProj, fromProj, coords);\n      },\n      info: function () {\n        return {\n          \"a\": toProj.a,\n          \"b\": toProj.b,\n          \"ra\": toProj.R_A,\n          \"proj-name\": toProj.projName\n        };\n      }\n    };\n    if (single) {\n      obj.oProj = toProj;\n    }\n    return obj;\n  }\n}\nexport default proj4;","\n\n\n/**\n * UTM zones are grouped, and assigned to one of a group of 6\n * sets.\n *\n * {int} @private\n */\nvar NUM_100K_SETS = 6;\n\n/**\n * The column letters (for easting) of the lower left value, per\n * set.\n *\n * {string} @private\n */\nvar SET_ORIGIN_COLUMN_LETTERS = 'AJSAJS';\n\n/**\n * The row letters (for northing) of the lower left value, per\n * set.\n *\n * {string} @private\n */\nvar SET_ORIGIN_ROW_LETTERS = 'AFAFAF';\n\nvar A = 65; // A\nvar I = 73; // I\nvar O = 79; // O\nvar V = 86; // V\nvar Z = 90; // Z\nexport default {\n  forward: forward,\n  inverse: inverse,\n  toPoint: toPoint\n};\n/**\n * Conversion of lat/lon to MGRS.\n *\n * @param {object} ll Object literal with lat and lon properties on a\n *     WGS84 ellipsoid.\n * @param {int} accuracy Accuracy in digits (5 for 1 m, 4 for 10 m, 3 for\n *      100 m, 2 for 1000 m or 1 for 10000 m). Optional, default is 5.\n * @return {string} the MGRS string for the given location and accuracy.\n */\nexport function forward(ll, accuracy) {\n  accuracy = accuracy || 5; // default accuracy 1m\n  return encode(LLtoUTM({\n    lat: ll[1],\n    lon: ll[0]\n  }), accuracy);\n};\n\n/**\n * Conversion of MGRS to lat/lon.\n *\n * @param {string} mgrs MGRS string.\n * @return {array} An array with left (longitude), bottom (latitude), right\n *     (longitude) and top (latitude) values in WGS84, representing the\n *     bounding box for the provided MGRS reference.\n */\nexport function inverse(mgrs) {\n  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));\n  if (bbox.lat && bbox.lon) {\n    return [bbox.lon, bbox.lat, bbox.lon, bbox.lat];\n  }\n  return [bbox.left, bbox.bottom, bbox.right, bbox.top];\n};\n\nexport function toPoint(mgrs) {\n  var bbox = UTMtoLL(decode(mgrs.toUpperCase()));\n  if (bbox.lat && bbox.lon) {\n    return [bbox.lon, bbox.lat];\n  }\n  return [(bbox.left + bbox.right) / 2, (bbox.top + bbox.bottom) / 2];\n};\n/**\n * Conversion from degrees to radians.\n *\n * @private\n * @param {number} deg the angle in degrees.\n * @return {number} the angle in radians.\n */\nfunction degToRad(deg) {\n  return (deg * (Math.PI / 180.0));\n}\n\n/**\n * Conversion from radians to degrees.\n *\n * @private\n * @param {number} rad the angle in radians.\n * @return {number} the angle in degrees.\n */\nfunction radToDeg(rad) {\n  return (180.0 * (rad / Math.PI));\n}\n\n/**\n * Converts a set of Longitude and Latitude co-ordinates to UTM\n * using the WGS84 ellipsoid.\n *\n * @private\n * @param {object} ll Object literal with lat and lon properties\n *     representing the WGS84 coordinate to be converted.\n * @return {object} Object literal containing the UTM value with easting,\n *     northing, zoneNumber and zoneLetter properties, and an optional\n *     accuracy property in digits. Returns null if the conversion failed.\n */\nfunction LLtoUTM(ll) {\n  var Lat = ll.lat;\n  var Long = ll.lon;\n  var a = 6378137.0; //ellip.radius;\n  var eccSquared = 0.00669438; //ellip.eccsq;\n  var k0 = 0.9996;\n  var LongOrigin;\n  var eccPrimeSquared;\n  var N, T, C, A, M;\n  var LatRad = degToRad(Lat);\n  var LongRad = degToRad(Long);\n  var LongOriginRad;\n  var ZoneNumber;\n  // (int)\n  ZoneNumber = Math.floor((Long + 180) / 6) + 1;\n\n  //Make sure the longitude 180.00 is in Zone 60\n  if (Long === 180) {\n    ZoneNumber = 60;\n  }\n\n  // Special zone for Norway\n  if (Lat >= 56.0 && Lat < 64.0 && Long >= 3.0 && Long < 12.0) {\n    ZoneNumber = 32;\n  }\n\n  // Special zones for Svalbard\n  if (Lat >= 72.0 && Lat < 84.0) {\n    if (Long >= 0.0 && Long < 9.0) {\n      ZoneNumber = 31;\n    }\n    else if (Long >= 9.0 && Long < 21.0) {\n      ZoneNumber = 33;\n    }\n    else if (Long >= 21.0 && Long < 33.0) {\n      ZoneNumber = 35;\n    }\n    else if (Long >= 33.0 && Long < 42.0) {\n      ZoneNumber = 37;\n    }\n  }\n\n  LongOrigin = (ZoneNumber - 1) * 6 - 180 + 3; //+3 puts origin\n  // in middle of\n  // zone\n  LongOriginRad = degToRad(LongOrigin);\n\n  eccPrimeSquared = (eccSquared) / (1 - eccSquared);\n\n  N = a / Math.sqrt(1 - eccSquared * Math.sin(LatRad) * Math.sin(LatRad));\n  T = Math.tan(LatRad) * Math.tan(LatRad);\n  C = eccPrimeSquared * Math.cos(LatRad) * Math.cos(LatRad);\n  A = Math.cos(LatRad) * (LongRad - LongOriginRad);\n\n  M = a * ((1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256) * LatRad - (3 * eccSquared / 8 + 3 * eccSquared * eccSquared / 32 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(2 * LatRad) + (15 * eccSquared * eccSquared / 256 + 45 * eccSquared * eccSquared * eccSquared / 1024) * Math.sin(4 * LatRad) - (35 * eccSquared * eccSquared * eccSquared / 3072) * Math.sin(6 * LatRad));\n\n  var UTMEasting = (k0 * N * (A + (1 - T + C) * A * A * A / 6.0 + (5 - 18 * T + T * T + 72 * C - 58 * eccPrimeSquared) * A * A * A * A * A / 120.0) + 500000.0);\n\n  var UTMNorthing = (k0 * (M + N * Math.tan(LatRad) * (A * A / 2 + (5 - T + 9 * C + 4 * C * C) * A * A * A * A / 24.0 + (61 - 58 * T + T * T + 600 * C - 330 * eccPrimeSquared) * A * A * A * A * A * A / 720.0)));\n  if (Lat < 0.0) {\n    UTMNorthing += 10000000.0; //10000000 meter offset for\n    // southern hemisphere\n  }\n\n  return {\n    northing: Math.round(UTMNorthing),\n    easting: Math.round(UTMEasting),\n    zoneNumber: ZoneNumber,\n    zoneLetter: getLetterDesignator(Lat)\n  };\n}\n\n/**\n * Converts UTM coords to lat/long, using the WGS84 ellipsoid. This is a convenience\n * class where the Zone can be specified as a single string eg.\"60N\" which\n * is then broken down into the ZoneNumber and ZoneLetter.\n *\n * @private\n * @param {object} utm An object literal with northing, easting, zoneNumber\n *     and zoneLetter properties. If an optional accuracy property is\n *     provided (in meters), a bounding box will be returned instead of\n *     latitude and longitude.\n * @return {object} An object literal containing either lat and lon values\n *     (if no accuracy was provided), or top, right, bottom and left values\n *     for the bounding box calculated according to the provided accuracy.\n *     Returns null if the conversion failed.\n */\nfunction UTMtoLL(utm) {\n\n  var UTMNorthing = utm.northing;\n  var UTMEasting = utm.easting;\n  var zoneLetter = utm.zoneLetter;\n  var zoneNumber = utm.zoneNumber;\n  // check the ZoneNummber is valid\n  if (zoneNumber < 0 || zoneNumber > 60) {\n    return null;\n  }\n\n  var k0 = 0.9996;\n  var a = 6378137.0; //ellip.radius;\n  var eccSquared = 0.00669438; //ellip.eccsq;\n  var eccPrimeSquared;\n  var e1 = (1 - Math.sqrt(1 - eccSquared)) / (1 + Math.sqrt(1 - eccSquared));\n  var N1, T1, C1, R1, D, M;\n  var LongOrigin;\n  var mu, phi1Rad;\n\n  // remove 500,000 meter offset for longitude\n  var x = UTMEasting - 500000.0;\n  var y = UTMNorthing;\n\n  // We must know somehow if we are in the Northern or Southern\n  // hemisphere, this is the only time we use the letter So even\n  // if the Zone letter isn't exactly correct it should indicate\n  // the hemisphere correctly\n  if (zoneLetter < 'N') {\n    y -= 10000000.0; // remove 10,000,000 meter offset used\n    // for southern hemisphere\n  }\n\n  // There are 60 zones with zone 1 being at West -180 to -174\n  LongOrigin = (zoneNumber - 1) * 6 - 180 + 3; // +3 puts origin\n  // in middle of\n  // zone\n\n  eccPrimeSquared = (eccSquared) / (1 - eccSquared);\n\n  M = y / k0;\n  mu = M / (a * (1 - eccSquared / 4 - 3 * eccSquared * eccSquared / 64 - 5 * eccSquared * eccSquared * eccSquared / 256));\n\n  phi1Rad = mu + (3 * e1 / 2 - 27 * e1 * e1 * e1 / 32) * Math.sin(2 * mu) + (21 * e1 * e1 / 16 - 55 * e1 * e1 * e1 * e1 / 32) * Math.sin(4 * mu) + (151 * e1 * e1 * e1 / 96) * Math.sin(6 * mu);\n  // double phi1 = ProjMath.radToDeg(phi1Rad);\n\n  N1 = a / Math.sqrt(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad));\n  T1 = Math.tan(phi1Rad) * Math.tan(phi1Rad);\n  C1 = eccPrimeSquared * Math.cos(phi1Rad) * Math.cos(phi1Rad);\n  R1 = a * (1 - eccSquared) / Math.pow(1 - eccSquared * Math.sin(phi1Rad) * Math.sin(phi1Rad), 1.5);\n  D = x / (N1 * k0);\n\n  var lat = phi1Rad - (N1 * Math.tan(phi1Rad) / R1) * (D * D / 2 - (5 + 3 * T1 + 10 * C1 - 4 * C1 * C1 - 9 * eccPrimeSquared) * D * D * D * D / 24 + (61 + 90 * T1 + 298 * C1 + 45 * T1 * T1 - 252 * eccPrimeSquared - 3 * C1 * C1) * D * D * D * D * D * D / 720);\n  lat = radToDeg(lat);\n\n  var lon = (D - (1 + 2 * T1 + C1) * D * D * D / 6 + (5 - 2 * C1 + 28 * T1 - 3 * C1 * C1 + 8 * eccPrimeSquared + 24 * T1 * T1) * D * D * D * D * D / 120) / Math.cos(phi1Rad);\n  lon = LongOrigin + radToDeg(lon);\n\n  var result;\n  if (utm.accuracy) {\n    var topRight = UTMtoLL({\n      northing: utm.northing + utm.accuracy,\n      easting: utm.easting + utm.accuracy,\n      zoneLetter: utm.zoneLetter,\n      zoneNumber: utm.zoneNumber\n    });\n    result = {\n      top: topRight.lat,\n      right: topRight.lon,\n      bottom: lat,\n      left: lon\n    };\n  }\n  else {\n    result = {\n      lat: lat,\n      lon: lon\n    };\n  }\n  return result;\n}\n\n/**\n * Calculates the MGRS letter designator for the given latitude.\n *\n * @private\n * @param {number} lat The latitude in WGS84 to get the letter designator\n *     for.\n * @return {char} The letter designator.\n */\nfunction getLetterDesignator(lat) {\n  //This is here as an error flag to show that the Latitude is\n  //outside MGRS limits\n  var LetterDesignator = 'Z';\n\n  if ((84 >= lat) && (lat >= 72)) {\n    LetterDesignator = 'X';\n  }\n  else if ((72 > lat) && (lat >= 64)) {\n    LetterDesignator = 'W';\n  }\n  else if ((64 > lat) && (lat >= 56)) {\n    LetterDesignator = 'V';\n  }\n  else if ((56 > lat) && (lat >= 48)) {\n    LetterDesignator = 'U';\n  }\n  else if ((48 > lat) && (lat >= 40)) {\n    LetterDesignator = 'T';\n  }\n  else if ((40 > lat) && (lat >= 32)) {\n    LetterDesignator = 'S';\n  }\n  else if ((32 > lat) && (lat >= 24)) {\n    LetterDesignator = 'R';\n  }\n  else if ((24 > lat) && (lat >= 16)) {\n    LetterDesignator = 'Q';\n  }\n  else if ((16 > lat) && (lat >= 8)) {\n    LetterDesignator = 'P';\n  }\n  else if ((8 > lat) && (lat >= 0)) {\n    LetterDesignator = 'N';\n  }\n  else if ((0 > lat) && (lat >= -8)) {\n    LetterDesignator = 'M';\n  }\n  else if ((-8 > lat) && (lat >= -16)) {\n    LetterDesignator = 'L';\n  }\n  else if ((-16 > lat) && (lat >= -24)) {\n    LetterDesignator = 'K';\n  }\n  else if ((-24 > lat) && (lat >= -32)) {\n    LetterDesignator = 'J';\n  }\n  else if ((-32 > lat) && (lat >= -40)) {\n    LetterDesignator = 'H';\n  }\n  else if ((-40 > lat) && (lat >= -48)) {\n    LetterDesignator = 'G';\n  }\n  else if ((-48 > lat) && (lat >= -56)) {\n    LetterDesignator = 'F';\n  }\n  else if ((-56 > lat) && (lat >= -64)) {\n    LetterDesignator = 'E';\n  }\n  else if ((-64 > lat) && (lat >= -72)) {\n    LetterDesignator = 'D';\n  }\n  else if ((-72 > lat) && (lat >= -80)) {\n    LetterDesignator = 'C';\n  }\n  return LetterDesignator;\n}\n\n/**\n * Encodes a UTM location as MGRS string.\n *\n * @private\n * @param {object} utm An object literal with easting, northing,\n *     zoneLetter, zoneNumber\n * @param {number} accuracy Accuracy in digits (1-5).\n * @return {string} MGRS string for the given UTM location.\n */\nfunction encode(utm, accuracy) {\n  // prepend with leading zeroes\n  var seasting = \"00000\" + utm.easting,\n    snorthing = \"00000\" + utm.northing;\n\n  return utm.zoneNumber + utm.zoneLetter + get100kID(utm.easting, utm.northing, utm.zoneNumber) + seasting.substr(seasting.length - 5, accuracy) + snorthing.substr(snorthing.length - 5, accuracy);\n}\n\n/**\n * Get the two letter 100k designator for a given UTM easting,\n * northing and zone number value.\n *\n * @private\n * @param {number} easting\n * @param {number} northing\n * @param {number} zoneNumber\n * @return the two letter 100k designator for the given UTM location.\n */\nfunction get100kID(easting, northing, zoneNumber) {\n  var setParm = get100kSetForZone(zoneNumber);\n  var setColumn = Math.floor(easting / 100000);\n  var setRow = Math.floor(northing / 100000) % 20;\n  return getLetter100kID(setColumn, setRow, setParm);\n}\n\n/**\n * Given a UTM zone number, figure out the MGRS 100K set it is in.\n *\n * @private\n * @param {number} i An UTM zone number.\n * @return {number} the 100k set the UTM zone is in.\n */\nfunction get100kSetForZone(i) {\n  var setParm = i % NUM_100K_SETS;\n  if (setParm === 0) {\n    setParm = NUM_100K_SETS;\n  }\n\n  return setParm;\n}\n\n/**\n * Get the two-letter MGRS 100k designator given information\n * translated from the UTM northing, easting and zone number.\n *\n * @private\n * @param {number} column the column index as it relates to the MGRS\n *        100k set spreadsheet, created from the UTM easting.\n *        Values are 1-8.\n * @param {number} row the row index as it relates to the MGRS 100k set\n *        spreadsheet, created from the UTM northing value. Values\n *        are from 0-19.\n * @param {number} parm the set block, as it relates to the MGRS 100k set\n *        spreadsheet, created from the UTM zone. Values are from\n *        1-60.\n * @return two letter MGRS 100k code.\n */\nfunction getLetter100kID(column, row, parm) {\n  // colOrigin and rowOrigin are the letters at the origin of the set\n  var index = parm - 1;\n  var colOrigin = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(index);\n  var rowOrigin = SET_ORIGIN_ROW_LETTERS.charCodeAt(index);\n\n  // colInt and rowInt are the letters to build to return\n  var colInt = colOrigin + column - 1;\n  var rowInt = rowOrigin + row;\n  var rollover = false;\n\n  if (colInt > Z) {\n    colInt = colInt - Z + A - 1;\n    rollover = true;\n  }\n\n  if (colInt === I || (colOrigin < I && colInt > I) || ((colInt > I || colOrigin < I) && rollover)) {\n    colInt++;\n  }\n\n  if (colInt === O || (colOrigin < O && colInt > O) || ((colInt > O || colOrigin < O) && rollover)) {\n    colInt++;\n\n    if (colInt === I) {\n      colInt++;\n    }\n  }\n\n  if (colInt > Z) {\n    colInt = colInt - Z + A - 1;\n  }\n\n  if (rowInt > V) {\n    rowInt = rowInt - V + A - 1;\n    rollover = true;\n  }\n  else {\n    rollover = false;\n  }\n\n  if (((rowInt === I) || ((rowOrigin < I) && (rowInt > I))) || (((rowInt > I) || (rowOrigin < I)) && rollover)) {\n    rowInt++;\n  }\n\n  if (((rowInt === O) || ((rowOrigin < O) && (rowInt > O))) || (((rowInt > O) || (rowOrigin < O)) && rollover)) {\n    rowInt++;\n\n    if (rowInt === I) {\n      rowInt++;\n    }\n  }\n\n  if (rowInt > V) {\n    rowInt = rowInt - V + A - 1;\n  }\n\n  var twoLetter = String.fromCharCode(colInt) + String.fromCharCode(rowInt);\n  return twoLetter;\n}\n\n/**\n * Decode the UTM parameters from a MGRS string.\n *\n * @private\n * @param {string} mgrsString an UPPERCASE coordinate string is expected.\n * @return {object} An object literal with easting, northing, zoneLetter,\n *     zoneNumber and accuracy (in meters) properties.\n */\nfunction decode(mgrsString) {\n\n  if (mgrsString && mgrsString.length === 0) {\n    throw (\"MGRSPoint coverting from nothing\");\n  }\n\n  var length = mgrsString.length;\n\n  var hunK = null;\n  var sb = \"\";\n  var testChar;\n  var i = 0;\n\n  // get Zone number\n  while (!(/[A-Z]/).test(testChar = mgrsString.charAt(i))) {\n    if (i >= 2) {\n      throw (\"MGRSPoint bad conversion from: \" + mgrsString);\n    }\n    sb += testChar;\n    i++;\n  }\n\n  var zoneNumber = parseInt(sb, 10);\n\n  if (i === 0 || i + 3 > length) {\n    // A good MGRS string has to be 4-5 digits long,\n    // ##AAA/#AAA at least.\n    throw (\"MGRSPoint bad conversion from: \" + mgrsString);\n  }\n\n  var zoneLetter = mgrsString.charAt(i++);\n\n  // Should we check the zone letter here? Why not.\n  if (zoneLetter <= 'A' || zoneLetter === 'B' || zoneLetter === 'Y' || zoneLetter >= 'Z' || zoneLetter === 'I' || zoneLetter === 'O') {\n    throw (\"MGRSPoint zone letter \" + zoneLetter + \" not handled: \" + mgrsString);\n  }\n\n  hunK = mgrsString.substring(i, i += 2);\n\n  var set = get100kSetForZone(zoneNumber);\n\n  var east100k = getEastingFromChar(hunK.charAt(0), set);\n  var north100k = getNorthingFromChar(hunK.charAt(1), set);\n\n  // We have a bug where the northing may be 2000000 too low.\n  // How\n  // do we know when to roll over?\n\n  while (north100k < getMinNorthing(zoneLetter)) {\n    north100k += 2000000;\n  }\n\n  // calculate the char index for easting/northing separator\n  var remainder = length - i;\n\n  if (remainder % 2 !== 0) {\n    throw (\"MGRSPoint has to have an even number \\nof digits after the zone letter and two 100km letters - front \\nhalf for easting meters, second half for \\nnorthing meters\" + mgrsString);\n  }\n\n  var sep = remainder / 2;\n\n  var sepEasting = 0.0;\n  var sepNorthing = 0.0;\n  var accuracyBonus, sepEastingString, sepNorthingString, easting, northing;\n  if (sep > 0) {\n    accuracyBonus = 100000.0 / Math.pow(10, sep);\n    sepEastingString = mgrsString.substring(i, i + sep);\n    sepEasting = parseFloat(sepEastingString) * accuracyBonus;\n    sepNorthingString = mgrsString.substring(i + sep);\n    sepNorthing = parseFloat(sepNorthingString) * accuracyBonus;\n  }\n\n  easting = sepEasting + east100k;\n  northing = sepNorthing + north100k;\n\n  return {\n    easting: easting,\n    northing: northing,\n    zoneLetter: zoneLetter,\n    zoneNumber: zoneNumber,\n    accuracy: accuracyBonus\n  };\n}\n\n/**\n * Given the first letter from a two-letter MGRS 100k zone, and given the\n * MGRS table set for the zone number, figure out the easting value that\n * should be added to the other, secondary easting value.\n *\n * @private\n * @param {char} e The first letter from a two-letter MGRS 100´k zone.\n * @param {number} set The MGRS table set for the zone number.\n * @return {number} The easting value for the given letter and set.\n */\nfunction getEastingFromChar(e, set) {\n  // colOrigin is the letter at the origin of the set for the\n  // column\n  var curCol = SET_ORIGIN_COLUMN_LETTERS.charCodeAt(set - 1);\n  var eastingValue = 100000.0;\n  var rewindMarker = false;\n\n  while (curCol !== e.charCodeAt(0)) {\n    curCol++;\n    if (curCol === I) {\n      curCol++;\n    }\n    if (curCol === O) {\n      curCol++;\n    }\n    if (curCol > Z) {\n      if (rewindMarker) {\n        throw (\"Bad character: \" + e);\n      }\n      curCol = A;\n      rewindMarker = true;\n    }\n    eastingValue += 100000.0;\n  }\n\n  return eastingValue;\n}\n\n/**\n * Given the second letter from a two-letter MGRS 100k zone, and given the\n * MGRS table set for the zone number, figure out the northing value that\n * should be added to the other, secondary northing value. You have to\n * remember that Northings are determined from the equator, and the vertical\n * cycle of letters mean a 2000000 additional northing meters. This happens\n * approx. every 18 degrees of latitude. This method does *NOT* count any\n * additional northings. You have to figure out how many 2000000 meters need\n * to be added for the zone letter of the MGRS coordinate.\n *\n * @private\n * @param {char} n Second letter of the MGRS 100k zone\n * @param {number} set The MGRS table set number, which is dependent on the\n *     UTM zone number.\n * @return {number} The northing value for the given letter and set.\n */\nfunction getNorthingFromChar(n, set) {\n\n  if (n > 'V') {\n    throw (\"MGRSPoint given invalid Northing \" + n);\n  }\n\n  // rowOrigin is the letter at the origin of the set for the\n  // column\n  var curRow = SET_ORIGIN_ROW_LETTERS.charCodeAt(set - 1);\n  var northingValue = 0.0;\n  var rewindMarker = false;\n\n  while (curRow !== n.charCodeAt(0)) {\n    curRow++;\n    if (curRow === I) {\n      curRow++;\n    }\n    if (curRow === O) {\n      curRow++;\n    }\n    // fixing a bug making whole application hang in this loop\n    // when 'n' is a wrong character\n    if (curRow > V) {\n      if (rewindMarker) { // making sure that this loop ends\n        throw (\"Bad character: \" + n);\n      }\n      curRow = A;\n      rewindMarker = true;\n    }\n    northingValue += 100000.0;\n  }\n\n  return northingValue;\n}\n\n/**\n * The function getMinNorthing returns the minimum northing value of a MGRS\n * zone.\n *\n * Ported from Geotrans' c Lattitude_Band_Value structure table.\n *\n * @private\n * @param {char} zoneLetter The MGRS zone to get the min northing for.\n * @return {number}\n */\nfunction getMinNorthing(zoneLetter) {\n  var northing;\n  switch (zoneLetter) {\n  case 'C':\n    northing = 1100000.0;\n    break;\n  case 'D':\n    northing = 2000000.0;\n    break;\n  case 'E':\n    northing = 2800000.0;\n    break;\n  case 'F':\n    northing = 3700000.0;\n    break;\n  case 'G':\n    northing = 4600000.0;\n    break;\n  case 'H':\n    northing = 5500000.0;\n    break;\n  case 'J':\n    northing = 6400000.0;\n    break;\n  case 'K':\n    northing = 7300000.0;\n    break;\n  case 'L':\n    northing = 8200000.0;\n    break;\n  case 'M':\n    northing = 9100000.0;\n    break;\n  case 'N':\n    northing = 0.0;\n    break;\n  case 'P':\n    northing = 800000.0;\n    break;\n  case 'Q':\n    northing = 1700000.0;\n    break;\n  case 'R':\n    northing = 2600000.0;\n    break;\n  case 'S':\n    northing = 3500000.0;\n    break;\n  case 'T':\n    northing = 4400000.0;\n    break;\n  case 'U':\n    northing = 5300000.0;\n    break;\n  case 'V':\n    northing = 6200000.0;\n    break;\n  case 'W':\n    northing = 7000000.0;\n    break;\n  case 'X':\n    northing = 7900000.0;\n    break;\n  default:\n    northing = -1.0;\n  }\n  if (northing >= 0.0) {\n    return northing;\n  }\n  else {\n    throw (\"Invalid zone letter: \" + zoneLetter);\n  }\n\n}\n","import {toPoint, forward} from 'mgrs';\n\nfunction Point(x, y, z) {\n  if (!(this instanceof Point)) {\n    return new Point(x, y, z);\n  }\n  if (Array.isArray(x)) {\n    this.x = x[0];\n    this.y = x[1];\n    this.z = x[2] || 0.0;\n  } else if(typeof x === 'object') {\n    this.x = x.x;\n    this.y = x.y;\n    this.z = x.z || 0.0;\n  } else if (typeof x === 'string' && typeof y === 'undefined') {\n    var coords = x.split(',');\n    this.x = parseFloat(coords[0], 10);\n    this.y = parseFloat(coords[1], 10);\n    this.z = parseFloat(coords[2], 10) || 0.0;\n  } else {\n    this.x = x;\n    this.y = y;\n    this.z = z || 0.0;\n  }\n  console.warn('proj4.Point will be removed in version 3, use proj4.toPoint');\n}\n\nPoint.fromMGRS = function(mgrsStr) {\n  return new Point(toPoint(mgrsStr));\n};\nPoint.prototype.toMGRS = function(accuracy) {\n  return forward([this.x, this.y], accuracy);\n};\nexport default Point;\n","var C00 = 1;\nvar C02 = 0.25;\nvar C04 = 0.046875;\nvar C06 = 0.01953125;\nvar C08 = 0.01068115234375;\nvar C22 = 0.75;\nvar C44 = 0.46875;\nvar C46 = 0.01302083333333333333;\nvar C48 = 0.00712076822916666666;\nvar C66 = 0.36458333333333333333;\nvar C68 = 0.00569661458333333333;\nvar C88 = 0.3076171875;\n\nexport default function(es) {\n  var en = [];\n  en[0] = C00 - es * (C02 + es * (C04 + es * (C06 + es * C08)));\n  en[1] = es * (C22 - es * (C04 + es * (C06 + es * C08)));\n  var t = es * es;\n  en[2] = t * (C44 - es * (C46 + es * C48));\n  t *= es;\n  en[3] = t * (C66 - es * C68);\n  en[4] = t * es * C88;\n  return en;\n}","export default function(phi, sphi, cphi, en) {\n  cphi *= sphi;\n  sphi *= sphi;\n  return (en[0] * phi - cphi * (en[1] + sphi * (en[2] + sphi * (en[3] + sphi * en[4]))));\n}","import pj_mlfn from \"./pj_mlfn\";\nimport {EPSLN} from '../constants/values';\n\nvar MAX_ITER = 20;\n\nexport default function(arg, es, en) {\n  var k = 1 / (1 - es);\n  var phi = arg;\n  for (var i = MAX_ITER; i; --i) { /* rarely goes over 2 iterations */\n    var s = Math.sin(phi);\n    var t = 1 - es * s * s;\n    //t = this.pj_mlfn(phi, s, Math.cos(phi), en) - arg;\n    //phi -= t * (t * Math.sqrt(t)) * k;\n    t = (pj_mlfn(phi, s, Math.cos(phi), en) - arg) * (t * Math.sqrt(t)) * k;\n    phi -= t;\n    if (Math.abs(t) < EPSLN) {\n      return phi;\n    }\n  }\n  //..reportError(\"cass:pj_inv_mlfn: Convergence error\");\n  return phi;\n}\n","// Heavily based on this tmerc projection implementation\n// https://github.com/mbloch/mapshaper-proj/blob/master/src/projections/tmerc.js\n\nimport pj_enfn from '../common/pj_enfn';\nimport pj_mlfn from '../common/pj_mlfn';\nimport pj_inv_mlfn from '../common/pj_inv_mlfn';\nimport adjust_lon from '../common/adjust_lon';\n\nimport {EPSLN, HALF_PI} from '../constants/values';\nimport sign from '../common/sign';\n\nexport function init() {\n  this.x0 = this.x0 !== undefined ? this.x0 : 0;\n  this.y0 = this.y0 !== undefined ? this.y0 : 0;\n  this.long0 = this.long0 !== undefined ? this.long0 : 0;\n  this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;\n\n  if (this.es) {\n    this.en = pj_enfn(this.es);\n    this.ml0 = pj_mlfn(this.lat0, Math.sin(this.lat0), Math.cos(this.lat0), this.en);\n  }\n}\n\n/**\n    Transverse Mercator Forward  - long/lat to x/y\n    long/lat in radians\n  */\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n\n  var delta_lon = adjust_lon(lon - this.long0);\n  var con;\n  var x, y;\n  var sin_phi = Math.sin(lat);\n  var cos_phi = Math.cos(lat);\n\n  if (!this.es) {\n    var b = cos_phi * Math.sin(delta_lon);\n\n    if ((Math.abs(Math.abs(b) - 1)) < EPSLN) {\n      return (93);\n    }\n    else {\n      x = 0.5 * this.a * this.k0 * Math.log((1 + b) / (1 - b)) + this.x0;\n      y = cos_phi * Math.cos(delta_lon) / Math.sqrt(1 - Math.pow(b, 2));\n      b = Math.abs(y);\n\n      if (b >= 1) {\n        if ((b - 1) > EPSLN) {\n          return (93);\n        }\n        else {\n          y = 0;\n        }\n      }\n      else {\n        y = Math.acos(y);\n      }\n\n      if (lat < 0) {\n        y = -y;\n      }\n\n      y = this.a * this.k0 * (y - this.lat0) + this.y0;\n    }\n  }\n  else {\n    var al = cos_phi * delta_lon;\n    var als = Math.pow(al, 2);\n    var c = this.ep2 * Math.pow(cos_phi, 2);\n    var cs = Math.pow(c, 2);\n    var tq = Math.abs(cos_phi) > EPSLN ? Math.tan(lat) : 0;\n    var t = Math.pow(tq, 2);\n    var ts = Math.pow(t, 2);\n    con = 1 - this.es * Math.pow(sin_phi, 2);\n    al = al / Math.sqrt(con);\n    var ml = pj_mlfn(lat, sin_phi, cos_phi, this.en);\n\n    x = this.a * (this.k0 * al * (1 +\n      als / 6 * (1 - t + c +\n      als / 20 * (5 - 18 * t + ts + 14 * c - 58 * t * c +\n      als / 42 * (61 + 179 * ts - ts * t - 479 * t))))) +\n      this.x0;\n\n    y = this.a * (this.k0 * (ml - this.ml0 +\n      sin_phi * delta_lon * al / 2 * (1 +\n      als / 12 * (5 - t + 9 * c + 4 * cs +\n      als / 30 * (61 + ts - 58 * t + 270 * c - 330 * t * c +\n      als / 56 * (1385 + 543 * ts - ts * t - 3111 * t)))))) +\n      this.y0;\n  }\n\n  p.x = x;\n  p.y = y;\n\n  return p;\n}\n\n/**\n    Transverse Mercator Inverse  -  x/y to long/lat\n  */\nexport function inverse(p) {\n  var con, phi;\n  var lat, lon;\n  var x = (p.x - this.x0) * (1 / this.a);\n  var y = (p.y - this.y0) * (1 / this.a);\n\n  if (!this.es) {\n    var f = Math.exp(x / this.k0);\n    var g = 0.5 * (f - 1 / f);\n    var temp = this.lat0 + y / this.k0;\n    var h = Math.cos(temp);\n    con = Math.sqrt((1 - Math.pow(h, 2)) / (1 + Math.pow(g, 2)));\n    lat = Math.asin(con);\n\n    if (y < 0) {\n      lat = -lat;\n    }\n\n    if ((g === 0) && (h === 0)) {\n      lon = 0;\n    }\n    else {\n      lon = adjust_lon(Math.atan2(g, h) + this.long0);\n    }\n  }\n  else { // ellipsoidal form\n    con = this.ml0 + y / this.k0;\n    phi = pj_inv_mlfn(con, this.es, this.en);\n\n    if (Math.abs(phi) < HALF_PI) {\n      var sin_phi = Math.sin(phi);\n      var cos_phi = Math.cos(phi);\n      var tan_phi = Math.abs(cos_phi) > EPSLN ? Math.tan(phi) : 0;\n      var c = this.ep2 * Math.pow(cos_phi, 2);\n      var cs = Math.pow(c, 2);\n      var t = Math.pow(tan_phi, 2);\n      var ts = Math.pow(t, 2);\n      con = 1 - this.es * Math.pow(sin_phi, 2);\n      var d = x * Math.sqrt(con) / this.k0;\n      var ds = Math.pow(d, 2);\n      con = con * tan_phi;\n\n      lat = phi - (con * ds / (1 - this.es)) * 0.5 * (1 -\n        ds / 12 * (5 + 3 * t - 9 * c * t + c - 4 * cs -\n        ds / 30 * (61 + 90 * t - 252 * c * t + 45 * ts + 46 * c -\n        ds / 56 * (1385 + 3633 * t + 4095 * ts + 1574 * ts * t))));\n\n      lon = adjust_lon(this.long0 + (d * (1 -\n        ds / 6 * (1 + 2 * t + c -\n        ds / 20 * (5 + 28 * t + 24 * ts + 8 * c * t + 6 * c -\n        ds / 42 * (61 + 662 * t + 1320 * ts + 720 * ts * t)))) / cos_phi));\n    }\n    else {\n      lat = HALF_PI * sign(y);\n      lon = 0;\n    }\n  }\n\n  p.x = lon;\n  p.y = lat;\n\n  return p;\n}\n\nexport var names = [\"Transverse_Mercator\", \"Transverse Mercator\", \"tmerc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function(x) {\n  var r = Math.exp(x);\n  r = (r - 1 / r) / 2;\n  return r;\n}","export default function(x, y) {\n  x = Math.abs(x);\n  y = Math.abs(y);\n  var a = Math.max(x, y);\n  var b = Math.min(x, y) / (a ? a : 1);\n\n  return a * Math.sqrt(1 + Math.pow(b, 2));\n}\n","import hypot from './hypot';\nimport log1py from './log1py';\n\nexport default function(x) {\n  var y = Math.abs(x);\n  y = log1py(y * (1 + y / (hypot(1, y) + 1)));\n\n  return x < 0 ? -y : y;\n}\n","export default function(x) {\n  var y = 1 + x;\n  var z = y - 1;\n\n  return z === 0 ? x : x * Math.log(y) / z;\n}\n","export default function(pp, B) {\n  var cos_2B = 2 * Math.cos(2 * B);\n  var i = pp.length - 1;\n  var h1 = pp[i];\n  var h2 = 0;\n  var h;\n\n  while (--i >= 0) {\n    h = -h2 + cos_2B * h1 + pp[i];\n    h2 = h1;\n    h1 = h;\n  }\n\n  return (B + h * Math.sin(2 * B));\n}\n","import sinh from './sinh';\nimport cosh from './cosh';\n\nexport default function(pp, arg_r, arg_i) {\n  var sin_arg_r = Math.sin(arg_r);\n  var cos_arg_r = Math.cos(arg_r);\n  var sinh_arg_i = sinh(arg_i);\n  var cosh_arg_i = cosh(arg_i);\n  var r = 2 * cos_arg_r * cosh_arg_i;\n  var i = -2 * sin_arg_r * sinh_arg_i;\n  var j = pp.length - 1;\n  var hr = pp[j];\n  var hi1 = 0;\n  var hr1 = 0;\n  var hi = 0;\n  var hr2;\n  var hi2;\n\n  while (--j >= 0) {\n    hr2 = hr1;\n    hi2 = hi1;\n    hr1 = hr;\n    hi1 = hi;\n    hr = -hr2 + r * hr1 - i * hi1 + pp[j];\n    hi = -hi2 + i * hr1 + r * hi1;\n  }\n\n  r = sin_arg_r * cosh_arg_i;\n  i = cos_arg_r * sinh_arg_i;\n\n  return [r * hr - i * hi, r * hi + i * hr];\n}\n","export default function(x) {\n  var r = Math.exp(x);\n  r = (r + 1 / r) / 2;\n  return r;\n}","// Heavily based on this etmerc projection implementation\n// https://github.com/mbloch/mapshaper-proj/blob/master/src/projections/etmerc.js\n\nimport sinh from '../common/sinh';\nimport hypot from '../common/hypot';\nimport asinhy from '../common/asinhy';\nimport gatg from '../common/gatg';\nimport clens from '../common/clens';\nimport clens_cmplx from '../common/clens_cmplx';\nimport adjust_lon from '../common/adjust_lon';\n\nexport function init() {\n  if (this.es === undefined || this.es <= 0) {\n    throw new Error('incorrect elliptical usage');\n  }\n\n  this.x0 = this.x0 !== undefined ? this.x0 : 0;\n  this.y0 = this.y0 !== undefined ? this.y0 : 0;\n  this.long0 = this.long0 !== undefined ? this.long0 : 0;\n  this.lat0 = this.lat0 !== undefined ? this.lat0 : 0;\n\n  this.cgb = [];\n  this.cbg = [];\n  this.utg = [];\n  this.gtu = [];\n\n  var f = this.es / (1 + Math.sqrt(1 - this.es));\n  var n = f / (2 - f);\n  var np = n;\n\n  this.cgb[0] = n * (2 + n * (-2 / 3 + n * (-2 + n * (116 / 45 + n * (26 / 45 + n * (-2854 / 675 ))))));\n  this.cbg[0] = n * (-2 + n * ( 2 / 3 + n * ( 4 / 3 + n * (-82 / 45 + n * (32 / 45 + n * (4642 / 4725))))));\n\n  np = np * n;\n  this.cgb[1] = np * (7 / 3 + n * (-8 / 5 + n * (-227 / 45 + n * (2704 / 315 + n * (2323 / 945)))));\n  this.cbg[1] = np * (5 / 3 + n * (-16 / 15 + n * ( -13 / 9 + n * (904 / 315 + n * (-1522 / 945)))));\n\n  np = np * n;\n  this.cgb[2] = np * (56 / 15 + n * (-136 / 35 + n * (-1262 / 105 + n * (73814 / 2835))));\n  this.cbg[2] = np * (-26 / 15 + n * (34 / 21 + n * (8 / 5 + n * (-12686 / 2835))));\n\n  np = np * n;\n  this.cgb[3] = np * (4279 / 630 + n * (-332 / 35 + n * (-399572 / 14175)));\n  this.cbg[3] = np * (1237 / 630 + n * (-12 / 5 + n * ( -24832 / 14175)));\n\n  np = np * n;\n  this.cgb[4] = np * (4174 / 315 + n * (-144838 / 6237));\n  this.cbg[4] = np * (-734 / 315 + n * (109598 / 31185));\n\n  np = np * n;\n  this.cgb[5] = np * (601676 / 22275);\n  this.cbg[5] = np * (444337 / 155925);\n\n  np = Math.pow(n, 2);\n  this.Qn = this.k0 / (1 + n) * (1 + np * (1 / 4 + np * (1 / 64 + np / 256)));\n\n  this.utg[0] = n * (-0.5 + n * ( 2 / 3 + n * (-37 / 96 + n * ( 1 / 360 + n * (81 / 512 + n * (-96199 / 604800))))));\n  this.gtu[0] = n * (0.5 + n * (-2 / 3 + n * (5 / 16 + n * (41 / 180 + n * (-127 / 288 + n * (7891 / 37800))))));\n\n  this.utg[1] = np * (-1 / 48 + n * (-1 / 15 + n * (437 / 1440 + n * (-46 / 105 + n * (1118711 / 3870720)))));\n  this.gtu[1] = np * (13 / 48 + n * (-3 / 5 + n * (557 / 1440 + n * (281 / 630 + n * (-1983433 / 1935360)))));\n\n  np = np * n;\n  this.utg[2] = np * (-17 / 480 + n * (37 / 840 + n * (209 / 4480 + n * (-5569 / 90720 ))));\n  this.gtu[2] = np * (61 / 240 + n * (-103 / 140 + n * (15061 / 26880 + n * (167603 / 181440))));\n\n  np = np * n;\n  this.utg[3] = np * (-4397 / 161280 + n * (11 / 504 + n * (830251 / 7257600)));\n  this.gtu[3] = np * (49561 / 161280 + n * (-179 / 168 + n * (6601661 / 7257600)));\n\n  np = np * n;\n  this.utg[4] = np * (-4583 / 161280 + n * (108847 / 3991680));\n  this.gtu[4] = np * (34729 / 80640 + n * (-3418889 / 1995840));\n\n  np = np * n;\n  this.utg[5] = np * (-20648693 / 638668800);\n  this.gtu[5] = np * (212378941 / 319334400);\n\n  var Z = gatg(this.cbg, this.lat0);\n  this.Zb = -this.Qn * (Z + clens(this.gtu, 2 * Z));\n}\n\nexport function forward(p) {\n  var Ce = adjust_lon(p.x - this.long0);\n  var Cn = p.y;\n\n  Cn = gatg(this.cbg, Cn);\n  var sin_Cn = Math.sin(Cn);\n  var cos_Cn = Math.cos(Cn);\n  var sin_Ce = Math.sin(Ce);\n  var cos_Ce = Math.cos(Ce);\n\n  Cn = Math.atan2(sin_Cn, cos_Ce * cos_Cn);\n  Ce = Math.atan2(sin_Ce * cos_Cn, hypot(sin_Cn, cos_Cn * cos_Ce));\n  Ce = asinhy(Math.tan(Ce));\n\n  var tmp = clens_cmplx(this.gtu, 2 * Cn, 2 * Ce);\n\n  Cn = Cn + tmp[0];\n  Ce = Ce + tmp[1];\n\n  var x;\n  var y;\n\n  if (Math.abs(Ce) <= 2.623395162778) {\n    x = this.a * (this.Qn * Ce) + this.x0;\n    y = this.a * (this.Qn * Cn + this.Zb) + this.y0;\n  }\n  else {\n    x = Infinity;\n    y = Infinity;\n  }\n\n  p.x = x;\n  p.y = y;\n\n  return p;\n}\n\nexport function inverse(p) {\n  var Ce = (p.x - this.x0) * (1 / this.a);\n  var Cn = (p.y - this.y0) * (1 / this.a);\n\n  Cn = (Cn - this.Zb) / this.Qn;\n  Ce = Ce / this.Qn;\n\n  var lon;\n  var lat;\n\n  if (Math.abs(Ce) <= 2.623395162778) {\n    var tmp = clens_cmplx(this.utg, 2 * Cn, 2 * Ce);\n\n    Cn = Cn + tmp[0];\n    Ce = Ce + tmp[1];\n    Ce = Math.atan(sinh(Ce));\n\n    var sin_Cn = Math.sin(Cn);\n    var cos_Cn = Math.cos(Cn);\n    var sin_Ce = Math.sin(Ce);\n    var cos_Ce = Math.cos(Ce);\n\n    Cn = Math.atan2(sin_Cn * cos_Ce, hypot(sin_Ce, cos_Ce * cos_Cn));\n    Ce = Math.atan2(sin_Ce, cos_Ce * cos_Cn);\n\n    lon = adjust_lon(Ce + this.long0);\n    lat = gatg(this.cgb, Cn);\n  }\n  else {\n    lon = Infinity;\n    lat = Infinity;\n  }\n\n  p.x = lon;\n  p.y = lat;\n\n  return p;\n}\n\nexport var names = [\"Extended_Transverse_Mercator\", \"Extended Transverse Mercator\", \"etmerc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function(pp, arg_r) {\n  var r = 2 * Math.cos(arg_r);\n  var i = pp.length - 1;\n  var hr1 = pp[i];\n  var hr2 = 0;\n  var hr;\n\n  while (--i >= 0) {\n    hr = -hr2 + r * hr1 + pp[i];\n    hr2 = hr1;\n    hr1 = hr;\n  }\n\n  return Math.sin(arg_r) * hr;\n}\n","import adjust_zone from '../common/adjust_zone';\nimport etmerc from './etmerc';\nexport var dependsOn = 'etmerc';\nimport {D2R} from '../constants/values';\n\n\nexport function init() {\n  var zone = adjust_zone(this.zone, this.long0);\n  if (zone === undefined) {\n    throw new Error('unknown utm zone');\n  }\n  this.lat0 = 0;\n  this.long0 =  ((6 * Math.abs(zone)) - 183) * D2R;\n  this.x0 = 500000;\n  this.y0 = this.utmSouth ? 10000000 : 0;\n  this.k0 = 0.9996;\n\n  etmerc.init.apply(this);\n  this.forward = etmerc.forward;\n  this.inverse = etmerc.inverse;\n}\n\nexport var names = [\"Universal Transverse Mercator System\", \"utm\"];\nexport default {\n  init: init,\n  names: names,\n  dependsOn: dependsOn\n};\n","import adjust_lon from './adjust_lon';\n\nexport default function(zone, lon) {\n  if (zone === undefined) {\n    zone = Math.floor((adjust_lon(lon) + Math.PI) * 30 / Math.PI) + 1;\n\n    if (zone < 0) {\n      return 0;\n    } else if (zone > 60) {\n      return 60;\n    }\n  }\n  return zone;\n}\n","export default function(esinp, exp) {\n  return (Math.pow((1 - esinp) / (1 + esinp), exp));\n}","import srat from '../common/srat';\nvar MAX_ITER = 20;\nimport {HALF_PI, FORTPI} from '../constants/values';\n\nexport function init() {\n  var sphi = Math.sin(this.lat0);\n  var cphi = Math.cos(this.lat0);\n  cphi *= cphi;\n  this.rc = Math.sqrt(1 - this.es) / (1 - this.es * sphi * sphi);\n  this.C = Math.sqrt(1 + this.es * cphi * cphi / (1 - this.es));\n  this.phic0 = Math.asin(sphi / this.C);\n  this.ratexp = 0.5 * this.C * this.e;\n  this.K = Math.tan(0.5 * this.phic0 + FORTPI) / (Math.pow(Math.tan(0.5 * this.lat0 + FORTPI), this.C) * srat(this.e * sphi, this.ratexp));\n}\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n\n  p.y = 2 * Math.atan(this.K * Math.pow(Math.tan(0.5 * lat + FORTPI), this.C) * srat(this.e * Math.sin(lat), this.ratexp)) - HALF_PI;\n  p.x = this.C * lon;\n  return p;\n}\n\nexport function inverse(p) {\n  var DEL_TOL = 1e-14;\n  var lon = p.x / this.C;\n  var lat = p.y;\n  var num = Math.pow(Math.tan(0.5 * lat + FORTPI) / this.K, 1 / this.C);\n  for (var i = MAX_ITER; i > 0; --i) {\n    lat = 2 * Math.atan(num * srat(this.e * Math.sin(p.y), - 0.5 * this.e)) - HALF_PI;\n    if (Math.abs(lat - p.y) < DEL_TOL) {\n      break;\n    }\n    p.y = lat;\n  }\n  /* convergence failed */\n  if (!i) {\n    return null;\n  }\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"gauss\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import gauss from './gauss';\nimport adjust_lon from '../common/adjust_lon';\n\nexport function init() {\n  gauss.init.apply(this);\n  if (!this.rc) {\n    return;\n  }\n  this.sinc0 = Math.sin(this.phic0);\n  this.cosc0 = Math.cos(this.phic0);\n  this.R2 = 2 * this.rc;\n  if (!this.title) {\n    this.title = \"Oblique Stereographic Alternative\";\n  }\n}\n\nexport function forward(p) {\n  var sinc, cosc, cosl, k;\n  p.x = adjust_lon(p.x - this.long0);\n  gauss.forward.apply(this, [p]);\n  sinc = Math.sin(p.y);\n  cosc = Math.cos(p.y);\n  cosl = Math.cos(p.x);\n  k = this.k0 * this.R2 / (1 + this.sinc0 * sinc + this.cosc0 * cosc * cosl);\n  p.x = k * cosc * Math.sin(p.x);\n  p.y = k * (this.cosc0 * sinc - this.sinc0 * cosc * cosl);\n  p.x = this.a * p.x + this.x0;\n  p.y = this.a * p.y + this.y0;\n  return p;\n}\n\nexport function inverse(p) {\n  var sinc, cosc, lon, lat, rho;\n  p.x = (p.x - this.x0) / this.a;\n  p.y = (p.y - this.y0) / this.a;\n\n  p.x /= this.k0;\n  p.y /= this.k0;\n  if ((rho = Math.sqrt(p.x * p.x + p.y * p.y))) {\n    var c = 2 * Math.atan2(rho, this.R2);\n    sinc = Math.sin(c);\n    cosc = Math.cos(c);\n    lat = Math.asin(cosc * this.sinc0 + p.y * sinc * this.cosc0 / rho);\n    lon = Math.atan2(p.x * sinc, rho * this.cosc0 * cosc - p.y * this.sinc0 * sinc);\n  }\n  else {\n    lat = this.phic0;\n    lon = 0;\n  }\n\n  p.x = lon;\n  p.y = lat;\n  gauss.inverse.apply(this, [p]);\n  p.x = adjust_lon(p.x + this.long0);\n  return p;\n}\n\nexport var names = [\"Stereographic_North_Pole\", \"Oblique_Stereographic\", \"Polar_Stereographic\", \"sterea\",\"Oblique Stereographic Alternative\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import {EPSLN, HALF_PI} from '../constants/values';\n\nimport sign from '../common/sign';\nimport msfnz from '../common/msfnz';\nimport tsfnz from '../common/tsfnz';\nimport phi2z from '../common/phi2z';\nimport adjust_lon from '../common/adjust_lon';\n\nexport function ssfn_(phit, sinphi, eccen) {\n  sinphi *= eccen;\n  return (Math.tan(0.5 * (HALF_PI + phit)) * Math.pow((1 - sinphi) / (1 + sinphi), 0.5 * eccen));\n}\n\nexport function init() {\n  this.coslat0 = Math.cos(this.lat0);\n  this.sinlat0 = Math.sin(this.lat0);\n  if (this.sphere) {\n    if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {\n      this.k0 = 0.5 * (1 + sign(this.lat0) * Math.sin(this.lat_ts));\n    }\n  }\n  else {\n    if (Math.abs(this.coslat0) <= EPSLN) {\n      if (this.lat0 > 0) {\n        //North pole\n        //trace('stere:north pole');\n        this.con = 1;\n      }\n      else {\n        //South pole\n        //trace('stere:south pole');\n        this.con = -1;\n      }\n    }\n    this.cons = Math.sqrt(Math.pow(1 + this.e, 1 + this.e) * Math.pow(1 - this.e, 1 - this.e));\n    if (this.k0 === 1 && !isNaN(this.lat_ts) && Math.abs(this.coslat0) <= EPSLN) {\n      this.k0 = 0.5 * this.cons * msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts)) / tsfnz(this.e, this.con * this.lat_ts, this.con * Math.sin(this.lat_ts));\n    }\n    this.ms1 = msfnz(this.e, this.sinlat0, this.coslat0);\n    this.X0 = 2 * Math.atan(this.ssfn_(this.lat0, this.sinlat0, this.e)) - HALF_PI;\n    this.cosX0 = Math.cos(this.X0);\n    this.sinX0 = Math.sin(this.X0);\n  }\n}\n\n// Stereographic forward equations--mapping lat,long to x,y\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var sinlat = Math.sin(lat);\n  var coslat = Math.cos(lat);\n  var A, X, sinX, cosX, ts, rh;\n  var dlon = adjust_lon(lon - this.long0);\n\n  if (Math.abs(Math.abs(lon - this.long0) - Math.PI) <= EPSLN && Math.abs(lat + this.lat0) <= EPSLN) {\n    //case of the origine point\n    //trace('stere:this is the origin point');\n    p.x = NaN;\n    p.y = NaN;\n    return p;\n  }\n  if (this.sphere) {\n    //trace('stere:sphere case');\n    A = 2 * this.k0 / (1 + this.sinlat0 * sinlat + this.coslat0 * coslat * Math.cos(dlon));\n    p.x = this.a * A * coslat * Math.sin(dlon) + this.x0;\n    p.y = this.a * A * (this.coslat0 * sinlat - this.sinlat0 * coslat * Math.cos(dlon)) + this.y0;\n    return p;\n  }\n  else {\n    X = 2 * Math.atan(this.ssfn_(lat, sinlat, this.e)) - HALF_PI;\n    cosX = Math.cos(X);\n    sinX = Math.sin(X);\n    if (Math.abs(this.coslat0) <= EPSLN) {\n      ts = tsfnz(this.e, lat * this.con, this.con * sinlat);\n      rh = 2 * this.a * this.k0 * ts / this.cons;\n      p.x = this.x0 + rh * Math.sin(lon - this.long0);\n      p.y = this.y0 - this.con * rh * Math.cos(lon - this.long0);\n      //trace(p.toString());\n      return p;\n    }\n    else if (Math.abs(this.sinlat0) < EPSLN) {\n      //Eq\n      //trace('stere:equateur');\n      A = 2 * this.a * this.k0 / (1 + cosX * Math.cos(dlon));\n      p.y = A * sinX;\n    }\n    else {\n      //other case\n      //trace('stere:normal case');\n      A = 2 * this.a * this.k0 * this.ms1 / (this.cosX0 * (1 + this.sinX0 * sinX + this.cosX0 * cosX * Math.cos(dlon)));\n      p.y = A * (this.cosX0 * sinX - this.sinX0 * cosX * Math.cos(dlon)) + this.y0;\n    }\n    p.x = A * cosX * Math.sin(dlon) + this.x0;\n  }\n  //trace(p.toString());\n  return p;\n}\n\n//* Stereographic inverse equations--mapping x,y to lat/long\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var lon, lat, ts, ce, Chi;\n  var rh = Math.sqrt(p.x * p.x + p.y * p.y);\n  if (this.sphere) {\n    var c = 2 * Math.atan(rh / (0.5 * this.a * this.k0));\n    lon = this.long0;\n    lat = this.lat0;\n    if (rh <= EPSLN) {\n      p.x = lon;\n      p.y = lat;\n      return p;\n    }\n    lat = Math.asin(Math.cos(c) * this.sinlat0 + p.y * Math.sin(c) * this.coslat0 / rh);\n    if (Math.abs(this.coslat0) < EPSLN) {\n      if (this.lat0 > 0) {\n        lon = adjust_lon(this.long0 + Math.atan2(p.x, - 1 * p.y));\n      }\n      else {\n        lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));\n      }\n    }\n    else {\n      lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(c), rh * this.coslat0 * Math.cos(c) - p.y * this.sinlat0 * Math.sin(c)));\n    }\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  else {\n    if (Math.abs(this.coslat0) <= EPSLN) {\n      if (rh <= EPSLN) {\n        lat = this.lat0;\n        lon = this.long0;\n        p.x = lon;\n        p.y = lat;\n        //trace(p.toString());\n        return p;\n      }\n      p.x *= this.con;\n      p.y *= this.con;\n      ts = rh * this.cons / (2 * this.a * this.k0);\n      lat = this.con * phi2z(this.e, ts);\n      lon = this.con * adjust_lon(this.con * this.long0 + Math.atan2(p.x, - 1 * p.y));\n    }\n    else {\n      ce = 2 * Math.atan(rh * this.cosX0 / (2 * this.a * this.k0 * this.ms1));\n      lon = this.long0;\n      if (rh <= EPSLN) {\n        Chi = this.X0;\n      }\n      else {\n        Chi = Math.asin(Math.cos(ce) * this.sinX0 + p.y * Math.sin(ce) * this.cosX0 / rh);\n        lon = adjust_lon(this.long0 + Math.atan2(p.x * Math.sin(ce), rh * this.cosX0 * Math.cos(ce) - p.y * this.sinX0 * Math.sin(ce)));\n      }\n      lat = -1 * phi2z(this.e, Math.tan(0.5 * (HALF_PI + Chi)));\n    }\n  }\n  p.x = lon;\n  p.y = lat;\n\n  //trace(p.toString());\n  return p;\n\n}\n\nexport var names = [\"stere\", \"Stereographic_South_Pole\", \"Polar Stereographic (variant B)\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names,\n  ssfn_: ssfn_\n};\n","/*\n  references:\n    Formules et constantes pour le Calcul pour la\n    projection cylindrique conforme à axe oblique et pour la transformation entre\n    des systèmes de référence.\n    http://www.swisstopo.admin.ch/internet/swisstopo/fr/home/topics/survey/sys/refsys/switzerland.parsysrelated1.31216.downloadList.77004.DownloadFile.tmp/swissprojectionfr.pdf\n  */\n\nexport function init() {\n  var phy0 = this.lat0;\n  this.lambda0 = this.long0;\n  var sinPhy0 = Math.sin(phy0);\n  var semiMajorAxis = this.a;\n  var invF = this.rf;\n  var flattening = 1 / invF;\n  var e2 = 2 * flattening - Math.pow(flattening, 2);\n  var e = this.e = Math.sqrt(e2);\n  this.R = this.k0 * semiMajorAxis * Math.sqrt(1 - e2) / (1 - e2 * Math.pow(sinPhy0, 2));\n  this.alpha = Math.sqrt(1 + e2 / (1 - e2) * Math.pow(Math.cos(phy0), 4));\n  this.b0 = Math.asin(sinPhy0 / this.alpha);\n  var k1 = Math.log(Math.tan(Math.PI / 4 + this.b0 / 2));\n  var k2 = Math.log(Math.tan(Math.PI / 4 + phy0 / 2));\n  var k3 = Math.log((1 + e * sinPhy0) / (1 - e * sinPhy0));\n  this.K = k1 - this.alpha * k2 + this.alpha * e / 2 * k3;\n}\n\nexport function forward(p) {\n  var Sa1 = Math.log(Math.tan(Math.PI / 4 - p.y / 2));\n  var Sa2 = this.e / 2 * Math.log((1 + this.e * Math.sin(p.y)) / (1 - this.e * Math.sin(p.y)));\n  var S = -this.alpha * (Sa1 + Sa2) + this.K;\n\n  // spheric latitude\n  var b = 2 * (Math.atan(Math.exp(S)) - Math.PI / 4);\n\n  // spheric longitude\n  var I = this.alpha * (p.x - this.lambda0);\n\n  // psoeudo equatorial rotation\n  var rotI = Math.atan(Math.sin(I) / (Math.sin(this.b0) * Math.tan(b) + Math.cos(this.b0) * Math.cos(I)));\n\n  var rotB = Math.asin(Math.cos(this.b0) * Math.sin(b) - Math.sin(this.b0) * Math.cos(b) * Math.cos(I));\n\n  p.y = this.R / 2 * Math.log((1 + Math.sin(rotB)) / (1 - Math.sin(rotB))) + this.y0;\n  p.x = this.R * rotI + this.x0;\n  return p;\n}\n\nexport function inverse(p) {\n  var Y = p.x - this.x0;\n  var X = p.y - this.y0;\n\n  var rotI = Y / this.R;\n  var rotB = 2 * (Math.atan(Math.exp(X / this.R)) - Math.PI / 4);\n\n  var b = Math.asin(Math.cos(this.b0) * Math.sin(rotB) + Math.sin(this.b0) * Math.cos(rotB) * Math.cos(rotI));\n  var I = Math.atan(Math.sin(rotI) / (Math.cos(this.b0) * Math.cos(rotI) - Math.sin(this.b0) * Math.tan(rotB)));\n\n  var lambda = this.lambda0 + I / this.alpha;\n\n  var S = 0;\n  var phy = b;\n  var prevPhy = -1000;\n  var iteration = 0;\n  while (Math.abs(phy - prevPhy) > 0.0000001) {\n    if (++iteration > 20) {\n      //...reportError(\"omercFwdInfinity\");\n      return;\n    }\n    //S = Math.log(Math.tan(Math.PI / 4 + phy / 2));\n    S = 1 / this.alpha * (Math.log(Math.tan(Math.PI / 4 + b / 2)) - this.K) + this.e * Math.log(Math.tan(Math.PI / 4 + Math.asin(this.e * Math.sin(phy)) / 2));\n    prevPhy = phy;\n    phy = 2 * Math.atan(Math.exp(S)) - Math.PI / 2;\n  }\n\n  p.x = lambda;\n  p.y = phy;\n  return p;\n}\n\nexport var names = [\"somerc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import tsfnz from '../common/tsfnz';\nimport adjust_lon from '../common/adjust_lon';\nimport phi2z from '../common/phi2z';\nimport {EPSLN, HALF_PI, FORTPI} from '../constants/values';\n\n/* Initialize the Oblique Mercator  projection\n    ------------------------------------------*/\nexport function init() {\n  this.no_off = this.no_off || false;\n  this.no_rot = this.no_rot || false;\n\n  if (isNaN(this.k0)) {\n    this.k0 = 1;\n  }\n  var sinlat = Math.sin(this.lat0);\n  var coslat = Math.cos(this.lat0);\n  var con = this.e * sinlat;\n\n  this.bl = Math.sqrt(1 + this.es / (1 - this.es) * Math.pow(coslat, 4));\n  this.al = this.a * this.bl * this.k0 * Math.sqrt(1 - this.es) / (1 - con * con);\n  var t0 = tsfnz(this.e, this.lat0, sinlat);\n  var dl = this.bl / coslat * Math.sqrt((1 - this.es) / (1 - con * con));\n  if (dl * dl < 1) {\n    dl = 1;\n  }\n  var fl;\n  var gl;\n  if (!isNaN(this.longc)) {\n    //Central point and azimuth method\n\n    if (this.lat0 >= 0) {\n      fl = dl + Math.sqrt(dl * dl - 1);\n    }\n    else {\n      fl = dl - Math.sqrt(dl * dl - 1);\n    }\n    this.el = fl * Math.pow(t0, this.bl);\n    gl = 0.5 * (fl - 1 / fl);\n    this.gamma0 = Math.asin(Math.sin(this.alpha) / dl);\n    this.long0 = this.longc - Math.asin(gl * Math.tan(this.gamma0)) / this.bl;\n\n  }\n  else {\n    //2 points method\n    var t1 = tsfnz(this.e, this.lat1, Math.sin(this.lat1));\n    var t2 = tsfnz(this.e, this.lat2, Math.sin(this.lat2));\n    if (this.lat0 >= 0) {\n      this.el = (dl + Math.sqrt(dl * dl - 1)) * Math.pow(t0, this.bl);\n    }\n    else {\n      this.el = (dl - Math.sqrt(dl * dl - 1)) * Math.pow(t0, this.bl);\n    }\n    var hl = Math.pow(t1, this.bl);\n    var ll = Math.pow(t2, this.bl);\n    fl = this.el / hl;\n    gl = 0.5 * (fl - 1 / fl);\n    var jl = (this.el * this.el - ll * hl) / (this.el * this.el + ll * hl);\n    var pl = (ll - hl) / (ll + hl);\n    var dlon12 = adjust_lon(this.long1 - this.long2);\n    this.long0 = 0.5 * (this.long1 + this.long2) - Math.atan(jl * Math.tan(0.5 * this.bl * (dlon12)) / pl) / this.bl;\n    this.long0 = adjust_lon(this.long0);\n    var dlon10 = adjust_lon(this.long1 - this.long0);\n    this.gamma0 = Math.atan(Math.sin(this.bl * (dlon10)) / gl);\n    this.alpha = Math.asin(dl * Math.sin(this.gamma0));\n  }\n\n  if (this.no_off) {\n    this.uc = 0;\n  }\n  else {\n    if (this.lat0 >= 0) {\n      this.uc = this.al / this.bl * Math.atan2(Math.sqrt(dl * dl - 1), Math.cos(this.alpha));\n    }\n    else {\n      this.uc = -1 * this.al / this.bl * Math.atan2(Math.sqrt(dl * dl - 1), Math.cos(this.alpha));\n    }\n  }\n\n}\n\n/* Oblique Mercator forward equations--mapping lat,long to x,y\n    ----------------------------------------------------------*/\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var dlon = adjust_lon(lon - this.long0);\n  var us, vs;\n  var con;\n  if (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN) {\n    if (lat > 0) {\n      con = -1;\n    }\n    else {\n      con = 1;\n    }\n    vs = this.al / this.bl * Math.log(Math.tan(FORTPI + con * this.gamma0 * 0.5));\n    us = -1 * con * HALF_PI * this.al / this.bl;\n  }\n  else {\n    var t = tsfnz(this.e, lat, Math.sin(lat));\n    var ql = this.el / Math.pow(t, this.bl);\n    var sl = 0.5 * (ql - 1 / ql);\n    var tl = 0.5 * (ql + 1 / ql);\n    var vl = Math.sin(this.bl * (dlon));\n    var ul = (sl * Math.sin(this.gamma0) - vl * Math.cos(this.gamma0)) / tl;\n    if (Math.abs(Math.abs(ul) - 1) <= EPSLN) {\n      vs = Number.POSITIVE_INFINITY;\n    }\n    else {\n      vs = 0.5 * this.al * Math.log((1 - ul) / (1 + ul)) / this.bl;\n    }\n    if (Math.abs(Math.cos(this.bl * (dlon))) <= EPSLN) {\n      us = this.al * this.bl * (dlon);\n    }\n    else {\n      us = this.al * Math.atan2(sl * Math.cos(this.gamma0) + vl * Math.sin(this.gamma0), Math.cos(this.bl * dlon)) / this.bl;\n    }\n  }\n\n  if (this.no_rot) {\n    p.x = this.x0 + us;\n    p.y = this.y0 + vs;\n  }\n  else {\n\n    us -= this.uc;\n    p.x = this.x0 + vs * Math.cos(this.alpha) + us * Math.sin(this.alpha);\n    p.y = this.y0 + us * Math.cos(this.alpha) - vs * Math.sin(this.alpha);\n  }\n  return p;\n}\n\nexport function inverse(p) {\n  var us, vs;\n  if (this.no_rot) {\n    vs = p.y - this.y0;\n    us = p.x - this.x0;\n  }\n  else {\n    vs = (p.x - this.x0) * Math.cos(this.alpha) - (p.y - this.y0) * Math.sin(this.alpha);\n    us = (p.y - this.y0) * Math.cos(this.alpha) + (p.x - this.x0) * Math.sin(this.alpha);\n    us += this.uc;\n  }\n  var qp = Math.exp(-1 * this.bl * vs / this.al);\n  var sp = 0.5 * (qp - 1 / qp);\n  var tp = 0.5 * (qp + 1 / qp);\n  var vp = Math.sin(this.bl * us / this.al);\n  var up = (vp * Math.cos(this.gamma0) + sp * Math.sin(this.gamma0)) / tp;\n  var ts = Math.pow(this.el / Math.sqrt((1 + up) / (1 - up)), 1 / this.bl);\n  if (Math.abs(up - 1) < EPSLN) {\n    p.x = this.long0;\n    p.y = HALF_PI;\n  }\n  else if (Math.abs(up + 1) < EPSLN) {\n    p.x = this.long0;\n    p.y = -1 * HALF_PI;\n  }\n  else {\n    p.y = phi2z(this.e, ts);\n    p.x = adjust_lon(this.long0 - Math.atan2(sp * Math.cos(this.gamma0) - vp * Math.sin(this.gamma0), Math.cos(this.bl * us / this.al)) / this.bl);\n  }\n  return p;\n}\n\nexport var names = [\"Hotine_Oblique_Mercator\", \"Hotine Oblique Mercator\", \"Hotine_Oblique_Mercator_Azimuth_Natural_Origin\", \"Hotine_Oblique_Mercator_Azimuth_Center\", \"omerc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import msfnz from '../common/msfnz';\nimport tsfnz from '../common/tsfnz';\nimport sign from '../common/sign';\nimport adjust_lon from '../common/adjust_lon';\nimport phi2z from '../common/phi2z';\nimport {HALF_PI, EPSLN} from '../constants/values';\nexport function init() {\n\n  // array of:  r_maj,r_min,lat1,lat2,c_lon,c_lat,false_east,false_north\n  //double c_lat;                   /* center latitude                      */\n  //double c_lon;                   /* center longitude                     */\n  //double lat1;                    /* first standard parallel              */\n  //double lat2;                    /* second standard parallel             */\n  //double r_maj;                   /* major axis                           */\n  //double r_min;                   /* minor axis                           */\n  //double false_east;              /* x offset in meters                   */\n  //double false_north;             /* y offset in meters                   */\n\n  if (!this.lat2) {\n    this.lat2 = this.lat1;\n  } //if lat2 is not defined\n  if (!this.k0) {\n    this.k0 = 1;\n  }\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  // Standard Parallels cannot be equal and on opposite sides of the equator\n  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n    return;\n  }\n\n  var temp = this.b / this.a;\n  this.e = Math.sqrt(1 - temp * temp);\n\n  var sin1 = Math.sin(this.lat1);\n  var cos1 = Math.cos(this.lat1);\n  var ms1 = msfnz(this.e, sin1, cos1);\n  var ts1 = tsfnz(this.e, this.lat1, sin1);\n\n  var sin2 = Math.sin(this.lat2);\n  var cos2 = Math.cos(this.lat2);\n  var ms2 = msfnz(this.e, sin2, cos2);\n  var ts2 = tsfnz(this.e, this.lat2, sin2);\n\n  var ts0 = tsfnz(this.e, this.lat0, Math.sin(this.lat0));\n\n  if (Math.abs(this.lat1 - this.lat2) > EPSLN) {\n    this.ns = Math.log(ms1 / ms2) / Math.log(ts1 / ts2);\n  }\n  else {\n    this.ns = sin1;\n  }\n  if (isNaN(this.ns)) {\n    this.ns = sin1;\n  }\n  this.f0 = ms1 / (this.ns * Math.pow(ts1, this.ns));\n  this.rh = this.a * this.f0 * Math.pow(ts0, this.ns);\n  if (!this.title) {\n    this.title = \"Lambert Conformal Conic\";\n  }\n}\n\n// Lambert Conformal conic forward equations--mapping lat,long to x,y\n// -----------------------------------------------------------------\nexport function forward(p) {\n\n  var lon = p.x;\n  var lat = p.y;\n\n  // singular cases :\n  if (Math.abs(2 * Math.abs(lat) - Math.PI) <= EPSLN) {\n    lat = sign(lat) * (HALF_PI - 2 * EPSLN);\n  }\n\n  var con = Math.abs(Math.abs(lat) - HALF_PI);\n  var ts, rh1;\n  if (con > EPSLN) {\n    ts = tsfnz(this.e, lat, Math.sin(lat));\n    rh1 = this.a * this.f0 * Math.pow(ts, this.ns);\n  }\n  else {\n    con = lat * this.ns;\n    if (con <= 0) {\n      return null;\n    }\n    rh1 = 0;\n  }\n  var theta = this.ns * adjust_lon(lon - this.long0);\n  p.x = this.k0 * (rh1 * Math.sin(theta)) + this.x0;\n  p.y = this.k0 * (this.rh - rh1 * Math.cos(theta)) + this.y0;\n\n  return p;\n}\n\n// Lambert Conformal Conic inverse equations--mapping x,y to lat/long\n// -----------------------------------------------------------------\nexport function inverse(p) {\n\n  var rh1, con, ts;\n  var lat, lon;\n  var x = (p.x - this.x0) / this.k0;\n  var y = (this.rh - (p.y - this.y0) / this.k0);\n  if (this.ns > 0) {\n    rh1 = Math.sqrt(x * x + y * y);\n    con = 1;\n  }\n  else {\n    rh1 = -Math.sqrt(x * x + y * y);\n    con = -1;\n  }\n  var theta = 0;\n  if (rh1 !== 0) {\n    theta = Math.atan2((con * x), (con * y));\n  }\n  if ((rh1 !== 0) || (this.ns > 0)) {\n    con = 1 / this.ns;\n    ts = Math.pow((rh1 / (this.a * this.f0)), con);\n    lat = phi2z(this.e, ts);\n    if (lat === -9999) {\n      return null;\n    }\n  }\n  else {\n    lat = -HALF_PI;\n  }\n  lon = adjust_lon(theta / this.ns + this.long0);\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Lambert Tangential Conformal Conic Projection\", \"Lambert_Conformal_Conic\", \"Lambert_Conformal_Conic_2SP\", \"lcc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\n\nexport function init() {\n  this.a = 6377397.155;\n  this.es = 0.006674372230614;\n  this.e = Math.sqrt(this.es);\n  if (!this.lat0) {\n    this.lat0 = 0.863937979737193;\n  }\n  if (!this.long0) {\n    this.long0 = 0.7417649320975901 - 0.308341501185665;\n  }\n  /* if scale not set default to 0.9999 */\n  if (!this.k0) {\n    this.k0 = 0.9999;\n  }\n  this.s45 = 0.785398163397448; /* 45 */\n  this.s90 = 2 * this.s45;\n  this.fi0 = this.lat0;\n  this.e2 = this.es;\n  this.e = Math.sqrt(this.e2);\n  this.alfa = Math.sqrt(1 + (this.e2 * Math.pow(Math.cos(this.fi0), 4)) / (1 - this.e2));\n  this.uq = 1.04216856380474;\n  this.u0 = Math.asin(Math.sin(this.fi0) / this.alfa);\n  this.g = Math.pow((1 + this.e * Math.sin(this.fi0)) / (1 - this.e * Math.sin(this.fi0)), this.alfa * this.e / 2);\n  this.k = Math.tan(this.u0 / 2 + this.s45) / Math.pow(Math.tan(this.fi0 / 2 + this.s45), this.alfa) * this.g;\n  this.k1 = this.k0;\n  this.n0 = this.a * Math.sqrt(1 - this.e2) / (1 - this.e2 * Math.pow(Math.sin(this.fi0), 2));\n  this.s0 = 1.37008346281555;\n  this.n = Math.sin(this.s0);\n  this.ro0 = this.k1 * this.n0 / Math.tan(this.s0);\n  this.ad = this.s90 - this.uq;\n}\n\n/* ellipsoid */\n/* calculate xy from lat/lon */\n/* Constants, identical to inverse transform function */\nexport function forward(p) {\n  var gfi, u, deltav, s, d, eps, ro;\n  var lon = p.x;\n  var lat = p.y;\n  var delta_lon = adjust_lon(lon - this.long0);\n  /* Transformation */\n  gfi = Math.pow(((1 + this.e * Math.sin(lat)) / (1 - this.e * Math.sin(lat))), (this.alfa * this.e / 2));\n  u = 2 * (Math.atan(this.k * Math.pow(Math.tan(lat / 2 + this.s45), this.alfa) / gfi) - this.s45);\n  deltav = -delta_lon * this.alfa;\n  s = Math.asin(Math.cos(this.ad) * Math.sin(u) + Math.sin(this.ad) * Math.cos(u) * Math.cos(deltav));\n  d = Math.asin(Math.cos(u) * Math.sin(deltav) / Math.cos(s));\n  eps = this.n * d;\n  ro = this.ro0 * Math.pow(Math.tan(this.s0 / 2 + this.s45), this.n) / Math.pow(Math.tan(s / 2 + this.s45), this.n);\n  p.y = ro * Math.cos(eps) / 1;\n  p.x = ro * Math.sin(eps) / 1;\n\n  if (!this.czech) {\n    p.y *= -1;\n    p.x *= -1;\n  }\n  return (p);\n}\n\n/* calculate lat/lon from xy */\nexport function inverse(p) {\n  var u, deltav, s, d, eps, ro, fi1;\n  var ok;\n\n  /* Transformation */\n  /* revert y, x*/\n  var tmp = p.x;\n  p.x = p.y;\n  p.y = tmp;\n  if (!this.czech) {\n    p.y *= -1;\n    p.x *= -1;\n  }\n  ro = Math.sqrt(p.x * p.x + p.y * p.y);\n  eps = Math.atan2(p.y, p.x);\n  d = eps / Math.sin(this.s0);\n  s = 2 * (Math.atan(Math.pow(this.ro0 / ro, 1 / this.n) * Math.tan(this.s0 / 2 + this.s45)) - this.s45);\n  u = Math.asin(Math.cos(this.ad) * Math.sin(s) - Math.sin(this.ad) * Math.cos(s) * Math.cos(d));\n  deltav = Math.asin(Math.cos(s) * Math.sin(d) / Math.cos(u));\n  p.x = this.long0 - deltav / this.alfa;\n  fi1 = u;\n  ok = 0;\n  var iter = 0;\n  do {\n    p.y = 2 * (Math.atan(Math.pow(this.k, - 1 / this.alfa) * Math.pow(Math.tan(u / 2 + this.s45), 1 / this.alfa) * Math.pow((1 + this.e * Math.sin(fi1)) / (1 - this.e * Math.sin(fi1)), this.e / 2)) - this.s45);\n    if (Math.abs(fi1 - p.y) < 0.0000000001) {\n      ok = 1;\n    }\n    fi1 = p.y;\n    iter += 1;\n  } while (ok === 0 && iter < 15);\n  if (iter >= 15) {\n    return null;\n  }\n\n  return (p);\n}\n\nexport var names = [\"Krovak\", \"krovak\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function(e0, e1, e2, e3, phi) {\n  return (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi));\n}","export default function(x) {\n  return (1 - 0.25 * x * (1 + x / 16 * (3 + 1.25 * x)));\n}","export default function(x) {\n  return (0.375 * x * (1 + 0.25 * x * (1 + 0.46875 * x)));\n}","export default function(x) {\n  return (0.05859375 * x * x * (1 + 0.75 * x));\n}","export default function(x) {\n  return (x * x * x * (35 / 3072));\n}","export default function(a, e, sinphi) {\n  var temp = e * sinphi;\n  return a / Math.sqrt(1 - temp * temp);\n}","import {HALF_PI} from '../constants/values';\nimport sign from './sign';\n\nexport default function(x) {\n  return (Math.abs(x) < HALF_PI) ? x : (x - (sign(x) * Math.PI));\n}\n","export default function(ml, e0, e1, e2, e3) {\n  var phi;\n  var dphi;\n\n  phi = ml / e0;\n  for (var i = 0; i < 15; i++) {\n    dphi = (ml - (e0 * phi - e1 * Math.sin(2 * phi) + e2 * Math.sin(4 * phi) - e3 * Math.sin(6 * phi))) / (e0 - 2 * e1 * Math.cos(2 * phi) + 4 * e2 * Math.cos(4 * phi) - 6 * e3 * Math.cos(6 * phi));\n    phi += dphi;\n    if (Math.abs(dphi) <= 0.0000000001) {\n      return phi;\n    }\n  }\n\n  //..reportError(\"IMLFN-CONV:Latitude failed to converge after 15 iterations\");\n  return NaN;\n}","import mlfn from '../common/mlfn';\nimport e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport gN from '../common/gN';\nimport adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport imlfn from '../common/imlfn';\nimport {HALF_PI, EPSLN} from '../constants/values';\n\nexport function init() {\n  if (!this.sphere) {\n    this.e0 = e0fn(this.es);\n    this.e1 = e1fn(this.es);\n    this.e2 = e2fn(this.es);\n    this.e3 = e3fn(this.es);\n    this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);\n  }\n}\n\n/* Cassini forward equations--mapping lat,long to x,y\n  -----------------------------------------------------------------------*/\nexport function forward(p) {\n\n  /* Forward equations\n      -----------------*/\n  var x, y;\n  var lam = p.x;\n  var phi = p.y;\n  lam = adjust_lon(lam - this.long0);\n\n  if (this.sphere) {\n    x = this.a * Math.asin(Math.cos(phi) * Math.sin(lam));\n    y = this.a * (Math.atan2(Math.tan(phi), Math.cos(lam)) - this.lat0);\n  }\n  else {\n    //ellipsoid\n    var sinphi = Math.sin(phi);\n    var cosphi = Math.cos(phi);\n    var nl = gN(this.a, this.e, sinphi);\n    var tl = Math.tan(phi) * Math.tan(phi);\n    var al = lam * Math.cos(phi);\n    var asq = al * al;\n    var cl = this.es * cosphi * cosphi / (1 - this.es);\n    var ml = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);\n\n    x = nl * al * (1 - asq * tl * (1 / 6 - (8 - tl + 8 * cl) * asq / 120));\n    y = ml - this.ml0 + nl * sinphi / cosphi * asq * (0.5 + (5 - tl + 6 * cl) * asq / 24);\n\n\n  }\n\n  p.x = x + this.x0;\n  p.y = y + this.y0;\n  return p;\n}\n\n/* Inverse equations\n  -----------------*/\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var x = p.x / this.a;\n  var y = p.y / this.a;\n  var phi, lam;\n\n  if (this.sphere) {\n    var dd = y + this.lat0;\n    phi = Math.asin(Math.sin(dd) * Math.cos(x));\n    lam = Math.atan2(Math.tan(x), Math.cos(dd));\n  }\n  else {\n    /* ellipsoid */\n    var ml1 = this.ml0 / this.a + y;\n    var phi1 = imlfn(ml1, this.e0, this.e1, this.e2, this.e3);\n    if (Math.abs(Math.abs(phi1) - HALF_PI) <= EPSLN) {\n      p.x = this.long0;\n      p.y = HALF_PI;\n      if (y < 0) {\n        p.y *= -1;\n      }\n      return p;\n    }\n    var nl1 = gN(this.a, this.e, Math.sin(phi1));\n\n    var rl1 = nl1 * nl1 * nl1 / this.a / this.a * (1 - this.es);\n    var tl1 = Math.pow(Math.tan(phi1), 2);\n    var dl = x * this.a / nl1;\n    var dsq = dl * dl;\n    phi = phi1 - nl1 * Math.tan(phi1) / rl1 * dl * dl * (0.5 - (1 + 3 * tl1) * dl * dl / 24);\n    lam = dl * (1 - dsq * (tl1 / 3 + (1 + 3 * tl1) * tl1 * dsq / 15)) / Math.cos(phi1);\n\n  }\n\n  p.x = adjust_lon(lam + this.long0);\n  p.y = adjust_lat(phi);\n  return p;\n\n}\n\nexport var names = [\"Cassini\", \"Cassini_Soldner\", \"cass\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export default function(eccent, sinphi) {\n  var con;\n  if (eccent > 1.0e-7) {\n    con = eccent * sinphi;\n    return ((1 - eccent * eccent) * (sinphi / (1 - con * con) - (0.5 / eccent) * Math.log((1 - con) / (1 + con))));\n  }\n  else {\n    return (2 * sinphi);\n  }\n}","\nimport {HALF_PI, EPSLN, FORTPI} from '../constants/values';\n\nimport qsfnz from '../common/qsfnz';\nimport adjust_lon from '../common/adjust_lon';\n\n/*\n  reference\n    \"New Equal-Area Map Projections for Noncircular Regions\", John P. Snyder,\n    The American Cartographer, Vol 15, No. 4, October 1988, pp. 341-355.\n  */\n\nexport var S_POLE = 1;\n\nexport var N_POLE = 2;\nexport var EQUIT = 3;\nexport var OBLIQ = 4;\n\n/* Initialize the Lambert Azimuthal Equal Area projection\n  ------------------------------------------------------*/\nexport function init() {\n  var t = Math.abs(this.lat0);\n  if (Math.abs(t - HALF_PI) < EPSLN) {\n    this.mode = this.lat0 < 0 ? this.S_POLE : this.N_POLE;\n  }\n  else if (Math.abs(t) < EPSLN) {\n    this.mode = this.EQUIT;\n  }\n  else {\n    this.mode = this.OBLIQ;\n  }\n  if (this.es > 0) {\n    var sinphi;\n\n    this.qp = qsfnz(this.e, 1);\n    this.mmf = 0.5 / (1 - this.es);\n    this.apa = authset(this.es);\n    switch (this.mode) {\n    case this.N_POLE:\n      this.dd = 1;\n      break;\n    case this.S_POLE:\n      this.dd = 1;\n      break;\n    case this.EQUIT:\n      this.rq = Math.sqrt(0.5 * this.qp);\n      this.dd = 1 / this.rq;\n      this.xmf = 1;\n      this.ymf = 0.5 * this.qp;\n      break;\n    case this.OBLIQ:\n      this.rq = Math.sqrt(0.5 * this.qp);\n      sinphi = Math.sin(this.lat0);\n      this.sinb1 = qsfnz(this.e, sinphi) / this.qp;\n      this.cosb1 = Math.sqrt(1 - this.sinb1 * this.sinb1);\n      this.dd = Math.cos(this.lat0) / (Math.sqrt(1 - this.es * sinphi * sinphi) * this.rq * this.cosb1);\n      this.ymf = (this.xmf = this.rq) / this.dd;\n      this.xmf *= this.dd;\n      break;\n    }\n  }\n  else {\n    if (this.mode === this.OBLIQ) {\n      this.sinph0 = Math.sin(this.lat0);\n      this.cosph0 = Math.cos(this.lat0);\n    }\n  }\n}\n\n/* Lambert Azimuthal Equal Area forward equations--mapping lat,long to x,y\n  -----------------------------------------------------------------------*/\nexport function forward(p) {\n\n  /* Forward equations\n      -----------------*/\n  var x, y, coslam, sinlam, sinphi, q, sinb, cosb, b, cosphi;\n  var lam = p.x;\n  var phi = p.y;\n\n  lam = adjust_lon(lam - this.long0);\n  if (this.sphere) {\n    sinphi = Math.sin(phi);\n    cosphi = Math.cos(phi);\n    coslam = Math.cos(lam);\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      y = (this.mode === this.EQUIT) ? 1 + cosphi * coslam : 1 + this.sinph0 * sinphi + this.cosph0 * cosphi * coslam;\n      if (y <= EPSLN) {\n        return null;\n      }\n      y = Math.sqrt(2 / y);\n      x = y * cosphi * Math.sin(lam);\n      y *= (this.mode === this.EQUIT) ? sinphi : this.cosph0 * sinphi - this.sinph0 * cosphi * coslam;\n    }\n    else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {\n      if (this.mode === this.N_POLE) {\n        coslam = -coslam;\n      }\n      if (Math.abs(phi + this.phi0) < EPSLN) {\n        return null;\n      }\n      y = FORTPI - phi * 0.5;\n      y = 2 * ((this.mode === this.S_POLE) ? Math.cos(y) : Math.sin(y));\n      x = y * Math.sin(lam);\n      y *= coslam;\n    }\n  }\n  else {\n    sinb = 0;\n    cosb = 0;\n    b = 0;\n    coslam = Math.cos(lam);\n    sinlam = Math.sin(lam);\n    sinphi = Math.sin(phi);\n    q = qsfnz(this.e, sinphi);\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      sinb = q / this.qp;\n      cosb = Math.sqrt(1 - sinb * sinb);\n    }\n    switch (this.mode) {\n    case this.OBLIQ:\n      b = 1 + this.sinb1 * sinb + this.cosb1 * cosb * coslam;\n      break;\n    case this.EQUIT:\n      b = 1 + cosb * coslam;\n      break;\n    case this.N_POLE:\n      b = HALF_PI + phi;\n      q = this.qp - q;\n      break;\n    case this.S_POLE:\n      b = phi - HALF_PI;\n      q = this.qp + q;\n      break;\n    }\n    if (Math.abs(b) < EPSLN) {\n      return null;\n    }\n    switch (this.mode) {\n    case this.OBLIQ:\n    case this.EQUIT:\n      b = Math.sqrt(2 / b);\n      if (this.mode === this.OBLIQ) {\n        y = this.ymf * b * (this.cosb1 * sinb - this.sinb1 * cosb * coslam);\n      }\n      else {\n        y = (b = Math.sqrt(2 / (1 + cosb * coslam))) * sinb * this.ymf;\n      }\n      x = this.xmf * b * cosb * sinlam;\n      break;\n    case this.N_POLE:\n    case this.S_POLE:\n      if (q >= 0) {\n        x = (b = Math.sqrt(q)) * sinlam;\n        y = coslam * ((this.mode === this.S_POLE) ? b : -b);\n      }\n      else {\n        x = y = 0;\n      }\n      break;\n    }\n  }\n\n  p.x = this.a * x + this.x0;\n  p.y = this.a * y + this.y0;\n  return p;\n}\n\n/* Inverse equations\n  -----------------*/\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var x = p.x / this.a;\n  var y = p.y / this.a;\n  var lam, phi, cCe, sCe, q, rho, ab;\n  if (this.sphere) {\n    var cosz = 0,\n      rh, sinz = 0;\n\n    rh = Math.sqrt(x * x + y * y);\n    phi = rh * 0.5;\n    if (phi > 1) {\n      return null;\n    }\n    phi = 2 * Math.asin(phi);\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      sinz = Math.sin(phi);\n      cosz = Math.cos(phi);\n    }\n    switch (this.mode) {\n    case this.EQUIT:\n      phi = (Math.abs(rh) <= EPSLN) ? 0 : Math.asin(y * sinz / rh);\n      x *= sinz;\n      y = cosz * rh;\n      break;\n    case this.OBLIQ:\n      phi = (Math.abs(rh) <= EPSLN) ? this.phi0 : Math.asin(cosz * this.sinph0 + y * sinz * this.cosph0 / rh);\n      x *= sinz * this.cosph0;\n      y = (cosz - Math.sin(phi) * this.sinph0) * rh;\n      break;\n    case this.N_POLE:\n      y = -y;\n      phi = HALF_PI - phi;\n      break;\n    case this.S_POLE:\n      phi -= HALF_PI;\n      break;\n    }\n    lam = (y === 0 && (this.mode === this.EQUIT || this.mode === this.OBLIQ)) ? 0 : Math.atan2(x, y);\n  }\n  else {\n    ab = 0;\n    if (this.mode === this.OBLIQ || this.mode === this.EQUIT) {\n      x /= this.dd;\n      y *= this.dd;\n      rho = Math.sqrt(x * x + y * y);\n      if (rho < EPSLN) {\n        p.x = 0;\n        p.y = this.phi0;\n        return p;\n      }\n      sCe = 2 * Math.asin(0.5 * rho / this.rq);\n      cCe = Math.cos(sCe);\n      x *= (sCe = Math.sin(sCe));\n      if (this.mode === this.OBLIQ) {\n        ab = cCe * this.sinb1 + y * sCe * this.cosb1 / rho;\n        q = this.qp * ab;\n        y = rho * this.cosb1 * cCe - y * this.sinb1 * sCe;\n      }\n      else {\n        ab = y * sCe / rho;\n        q = this.qp * ab;\n        y = rho * cCe;\n      }\n    }\n    else if (this.mode === this.N_POLE || this.mode === this.S_POLE) {\n      if (this.mode === this.N_POLE) {\n        y = -y;\n      }\n      q = (x * x + y * y);\n      if (!q) {\n        p.x = 0;\n        p.y = this.phi0;\n        return p;\n      }\n      ab = 1 - q / this.qp;\n      if (this.mode === this.S_POLE) {\n        ab = -ab;\n      }\n    }\n    lam = Math.atan2(x, y);\n    phi = authlat(Math.asin(ab), this.apa);\n  }\n\n  p.x = adjust_lon(this.long0 + lam);\n  p.y = phi;\n  return p;\n}\n\n/* determine latitude from authalic latitude */\nvar P00 = 0.33333333333333333333;\n\nvar P01 = 0.17222222222222222222;\nvar P02 = 0.10257936507936507936;\nvar P10 = 0.06388888888888888888;\nvar P11 = 0.06640211640211640211;\nvar P20 = 0.01641501294219154443;\n\nfunction authset(es) {\n  var t;\n  var APA = [];\n  APA[0] = es * P00;\n  t = es * es;\n  APA[0] += t * P01;\n  APA[1] = t * P10;\n  t *= es;\n  APA[0] += t * P02;\n  APA[1] += t * P11;\n  APA[2] = t * P20;\n  return APA;\n}\n\nfunction authlat(beta, APA) {\n  var t = beta + beta;\n  return (beta + APA[0] * Math.sin(t) + APA[1] * Math.sin(t + t) + APA[2] * Math.sin(t + t + t));\n}\n\nexport var names = [\"Lambert Azimuthal Equal Area\", \"Lambert_Azimuthal_Equal_Area\", \"laea\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names,\n  S_POLE: S_POLE,\n  N_POLE: N_POLE,\n  EQUIT: EQUIT,\n  OBLIQ: OBLIQ\n};\n","export default function(x) {\n  if (Math.abs(x) > 1) {\n    x = (x > 1) ? 1 : -1;\n  }\n  return Math.asin(x);\n}","import msfnz from '../common/msfnz';\nimport qsfnz from '../common/qsfnz';\nimport adjust_lon from '../common/adjust_lon';\nimport asinz from '../common/asinz';\nimport {EPSLN} from '../constants/values';\n\nexport function init() {\n\n  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n    return;\n  }\n  this.temp = this.b / this.a;\n  this.es = 1 - Math.pow(this.temp, 2);\n  this.e3 = Math.sqrt(this.es);\n\n  this.sin_po = Math.sin(this.lat1);\n  this.cos_po = Math.cos(this.lat1);\n  this.t1 = this.sin_po;\n  this.con = this.sin_po;\n  this.ms1 = msfnz(this.e3, this.sin_po, this.cos_po);\n  this.qs1 = qsfnz(this.e3, this.sin_po, this.cos_po);\n\n  this.sin_po = Math.sin(this.lat2);\n  this.cos_po = Math.cos(this.lat2);\n  this.t2 = this.sin_po;\n  this.ms2 = msfnz(this.e3, this.sin_po, this.cos_po);\n  this.qs2 = qsfnz(this.e3, this.sin_po, this.cos_po);\n\n  this.sin_po = Math.sin(this.lat0);\n  this.cos_po = Math.cos(this.lat0);\n  this.t3 = this.sin_po;\n  this.qs0 = qsfnz(this.e3, this.sin_po, this.cos_po);\n\n  if (Math.abs(this.lat1 - this.lat2) > EPSLN) {\n    this.ns0 = (this.ms1 * this.ms1 - this.ms2 * this.ms2) / (this.qs2 - this.qs1);\n  }\n  else {\n    this.ns0 = this.con;\n  }\n  this.c = this.ms1 * this.ms1 + this.ns0 * this.qs1;\n  this.rh = this.a * Math.sqrt(this.c - this.ns0 * this.qs0) / this.ns0;\n}\n\n/* Albers Conical Equal Area forward equations--mapping lat,long to x,y\n  -------------------------------------------------------------------*/\nexport function forward(p) {\n\n  var lon = p.x;\n  var lat = p.y;\n\n  this.sin_phi = Math.sin(lat);\n  this.cos_phi = Math.cos(lat);\n\n  var qs = qsfnz(this.e3, this.sin_phi, this.cos_phi);\n  var rh1 = this.a * Math.sqrt(this.c - this.ns0 * qs) / this.ns0;\n  var theta = this.ns0 * adjust_lon(lon - this.long0);\n  var x = rh1 * Math.sin(theta) + this.x0;\n  var y = this.rh - rh1 * Math.cos(theta) + this.y0;\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var rh1, qs, con, theta, lon, lat;\n\n  p.x -= this.x0;\n  p.y = this.rh - p.y + this.y0;\n  if (this.ns0 >= 0) {\n    rh1 = Math.sqrt(p.x * p.x + p.y * p.y);\n    con = 1;\n  }\n  else {\n    rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);\n    con = -1;\n  }\n  theta = 0;\n  if (rh1 !== 0) {\n    theta = Math.atan2(con * p.x, con * p.y);\n  }\n  con = rh1 * this.ns0 / this.a;\n  if (this.sphere) {\n    lat = Math.asin((this.c - con * con) / (2 * this.ns0));\n  }\n  else {\n    qs = (this.c - con * con) / this.ns0;\n    lat = this.phi1z(this.e3, qs);\n  }\n\n  lon = adjust_lon(theta / this.ns0 + this.long0);\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\n/* Function to compute phi1, the latitude for the inverse of the\n   Albers Conical Equal-Area projection.\n-------------------------------------------*/\nexport function phi1z(eccent, qs) {\n  var sinphi, cosphi, con, com, dphi;\n  var phi = asinz(0.5 * qs);\n  if (eccent < EPSLN) {\n    return phi;\n  }\n\n  var eccnts = eccent * eccent;\n  for (var i = 1; i <= 25; i++) {\n    sinphi = Math.sin(phi);\n    cosphi = Math.cos(phi);\n    con = eccent * sinphi;\n    com = 1 - con * con;\n    dphi = 0.5 * com * com / cosphi * (qs / (1 - eccnts) - sinphi / com + 0.5 / eccent * Math.log((1 - con) / (1 + con)));\n    phi = phi + dphi;\n    if (Math.abs(dphi) <= 1e-7) {\n      return phi;\n    }\n  }\n  return null;\n}\n\nexport var names = [\"Albers_Conic_Equal_Area\", \"Albers\", \"aea\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names,\n  phi1z: phi1z\n};\n","import adjust_lon from '../common/adjust_lon';\nimport asinz from '../common/asinz';\nimport {EPSLN} from '../constants/values';\n\n/*\n  reference:\n    Wolfram Mathworld \"Gnomonic Projection\"\n    http://mathworld.wolfram.com/GnomonicProjection.html\n    Accessed: 12th November 2009\n  */\nexport function init() {\n\n  /* Place parameters in static storage for common use\n      -------------------------------------------------*/\n  this.sin_p14 = Math.sin(this.lat0);\n  this.cos_p14 = Math.cos(this.lat0);\n  // Approximation for projecting points to the horizon (infinity)\n  this.infinity_dist = 1000 * this.a;\n  this.rc = 1;\n}\n\n/* Gnomonic forward equations--mapping lat,long to x,y\n    ---------------------------------------------------*/\nexport function forward(p) {\n  var sinphi, cosphi; /* sin and cos value        */\n  var dlon; /* delta longitude value      */\n  var coslon; /* cos of longitude        */\n  var ksp; /* scale factor          */\n  var g;\n  var x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n      -----------------*/\n  dlon = adjust_lon(lon - this.long0);\n\n  sinphi = Math.sin(lat);\n  cosphi = Math.cos(lat);\n\n  coslon = Math.cos(dlon);\n  g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;\n  ksp = 1;\n  if ((g > 0) || (Math.abs(g) <= EPSLN)) {\n    x = this.x0 + this.a * ksp * cosphi * Math.sin(dlon) / g;\n    y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon) / g;\n  }\n  else {\n\n    // Point is in the opposing hemisphere and is unprojectable\n    // We still need to return a reasonable point, so we project\n    // to infinity, on a bearing\n    // equivalent to the northern hemisphere equivalent\n    // This is a reasonable approximation for short shapes and lines that\n    // straddle the horizon.\n\n    x = this.x0 + this.infinity_dist * cosphi * Math.sin(dlon);\n    y = this.y0 + this.infinity_dist * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);\n\n  }\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var rh; /* Rho */\n  var sinc, cosc;\n  var c;\n  var lon, lat;\n\n  /* Inverse equations\n      -----------------*/\n  p.x = (p.x - this.x0) / this.a;\n  p.y = (p.y - this.y0) / this.a;\n\n  p.x /= this.k0;\n  p.y /= this.k0;\n\n  if ((rh = Math.sqrt(p.x * p.x + p.y * p.y))) {\n    c = Math.atan2(rh, this.rc);\n    sinc = Math.sin(c);\n    cosc = Math.cos(c);\n\n    lat = asinz(cosc * this.sin_p14 + (p.y * sinc * this.cos_p14) / rh);\n    lon = Math.atan2(p.x * sinc, rh * this.cos_p14 * cosc - p.y * this.sin_p14 * sinc);\n    lon = adjust_lon(this.long0 + lon);\n  }\n  else {\n    lat = this.phic0;\n    lon = 0;\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"gnom\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport qsfnz from '../common/qsfnz';\nimport msfnz from '../common/msfnz';\nimport iqsfnz from '../common/iqsfnz';\n\n/*\n  reference:\n    \"Cartographic Projection Procedures for the UNIX Environment-\n    A User's Manual\" by Gerald I. Evenden,\n    USGS Open File Report 90-284and Release 4 Interim Reports (2003)\n*/\nexport function init() {\n  //no-op\n  if (!this.sphere) {\n    this.k0 = msfnz(this.e, Math.sin(this.lat_ts), Math.cos(this.lat_ts));\n  }\n}\n\n/* Cylindrical Equal Area forward equations--mapping lat,long to x,y\n    ------------------------------------------------------------*/\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var x, y;\n  /* Forward equations\n      -----------------*/\n  var dlon = adjust_lon(lon - this.long0);\n  if (this.sphere) {\n    x = this.x0 + this.a * dlon * Math.cos(this.lat_ts);\n    y = this.y0 + this.a * Math.sin(lat) / Math.cos(this.lat_ts);\n  }\n  else {\n    var qs = qsfnz(this.e, Math.sin(lat));\n    x = this.x0 + this.a * this.k0 * dlon;\n    y = this.y0 + this.a * qs * 0.5 / this.k0;\n  }\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Cylindrical Equal Area inverse equations--mapping x,y to lat/long\n    ------------------------------------------------------------*/\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var lon, lat;\n\n  if (this.sphere) {\n    lon = adjust_lon(this.long0 + (p.x / this.a) / Math.cos(this.lat_ts));\n    lat = Math.asin((p.y / this.a) * Math.cos(this.lat_ts));\n  }\n  else {\n    lat = iqsfnz(this.e, 2 * p.y * this.k0 / this.a);\n    lon = adjust_lon(this.long0 + p.x / (this.a * this.k0));\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"cea\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import {HALF_PI} from '../constants/values';\n\nexport default function(eccent, q) {\n  var temp = 1 - (1 - eccent * eccent) / (2 * eccent) * Math.log((1 - eccent) / (1 + eccent));\n  if (Math.abs(Math.abs(q) - temp) < 1.0E-6) {\n    if (q < 0) {\n      return (-1 * HALF_PI);\n    }\n    else {\n      return HALF_PI;\n    }\n  }\n  //var phi = 0.5* q/(1-eccent*eccent);\n  var phi = Math.asin(0.5 * q);\n  var dphi;\n  var sin_phi;\n  var cos_phi;\n  var con;\n  for (var i = 0; i < 30; i++) {\n    sin_phi = Math.sin(phi);\n    cos_phi = Math.cos(phi);\n    con = eccent * sin_phi;\n    dphi = Math.pow(1 - con * con, 2) / (2 * cos_phi) * (q / (1 - eccent * eccent) - sin_phi / (1 - con * con) + 0.5 / eccent * Math.log((1 - con) / (1 + con)));\n    phi += dphi;\n    if (Math.abs(dphi) <= 0.0000000001) {\n      return phi;\n    }\n  }\n\n  //console.log(\"IQSFN-CONV:Latitude failed to converge after 30 iterations\");\n  return NaN;\n}\n","import adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\n\nexport function init() {\n\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  this.lat0 = this.lat0 || 0;\n  this.long0 = this.long0 || 0;\n  this.lat_ts = this.lat_ts || 0;\n  this.title = this.title || \"Equidistant Cylindrical (Plate Carre)\";\n\n  this.rc = Math.cos(this.lat_ts);\n}\n\n// forward equations--mapping lat,long to x,y\n// -----------------------------------------------------------------\nexport function forward(p) {\n\n  var lon = p.x;\n  var lat = p.y;\n\n  var dlon = adjust_lon(lon - this.long0);\n  var dlat = adjust_lat(lat - this.lat0);\n  p.x = this.x0 + (this.a * dlon * this.rc);\n  p.y = this.y0 + (this.a * dlat);\n  return p;\n}\n\n// inverse equations--mapping x,y to lat/long\n// -----------------------------------------------------------------\nexport function inverse(p) {\n\n  var x = p.x;\n  var y = p.y;\n\n  p.x = adjust_lon(this.long0 + ((x - this.x0) / (this.a * this.rc)));\n  p.y = adjust_lat(this.lat0 + ((y - this.y0) / (this.a)));\n  return p;\n}\n\nexport var names = [\"Equirectangular\", \"Equidistant_Cylindrical\", \"eqc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport mlfn from '../common/mlfn';\nimport {EPSLN} from '../constants/values';\n\nimport gN from '../common/gN';\nvar MAX_ITER = 20;\n\nexport function init() {\n  /* Place parameters in static storage for common use\n      -------------------------------------------------*/\n  this.temp = this.b / this.a;\n  this.es = 1 - Math.pow(this.temp, 2); // devait etre dans tmerc.js mais n y est pas donc je commente sinon retour de valeurs nulles\n  this.e = Math.sqrt(this.es);\n  this.e0 = e0fn(this.es);\n  this.e1 = e1fn(this.es);\n  this.e2 = e2fn(this.es);\n  this.e3 = e3fn(this.es);\n  this.ml0 = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0); //si que des zeros le calcul ne se fait pas\n}\n\n/* Polyconic forward equations--mapping lat,long to x,y\n    ---------------------------------------------------*/\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var x, y, el;\n  var dlon = adjust_lon(lon - this.long0);\n  el = dlon * Math.sin(lat);\n  if (this.sphere) {\n    if (Math.abs(lat) <= EPSLN) {\n      x = this.a * dlon;\n      y = -1 * this.a * this.lat0;\n    }\n    else {\n      x = this.a * Math.sin(el) / Math.tan(lat);\n      y = this.a * (adjust_lat(lat - this.lat0) + (1 - Math.cos(el)) / Math.tan(lat));\n    }\n  }\n  else {\n    if (Math.abs(lat) <= EPSLN) {\n      x = this.a * dlon;\n      y = -1 * this.ml0;\n    }\n    else {\n      var nl = gN(this.a, this.e, Math.sin(lat)) / Math.tan(lat);\n      x = nl * Math.sin(el);\n      y = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, lat) - this.ml0 + nl * (1 - Math.cos(el));\n    }\n\n  }\n  p.x = x + this.x0;\n  p.y = y + this.y0;\n  return p;\n}\n\n/* Inverse equations\n  -----------------*/\nexport function inverse(p) {\n  var lon, lat, x, y, i;\n  var al, bl;\n  var phi, dphi;\n  x = p.x - this.x0;\n  y = p.y - this.y0;\n\n  if (this.sphere) {\n    if (Math.abs(y + this.a * this.lat0) <= EPSLN) {\n      lon = adjust_lon(x / this.a + this.long0);\n      lat = 0;\n    }\n    else {\n      al = this.lat0 + y / this.a;\n      bl = x * x / this.a / this.a + al * al;\n      phi = al;\n      var tanphi;\n      for (i = MAX_ITER; i; --i) {\n        tanphi = Math.tan(phi);\n        dphi = -1 * (al * (phi * tanphi + 1) - phi - 0.5 * (phi * phi + bl) * tanphi) / ((phi - al) / tanphi - 1);\n        phi += dphi;\n        if (Math.abs(dphi) <= EPSLN) {\n          lat = phi;\n          break;\n        }\n      }\n      lon = adjust_lon(this.long0 + (Math.asin(x * Math.tan(phi) / this.a)) / Math.sin(lat));\n    }\n  }\n  else {\n    if (Math.abs(y + this.ml0) <= EPSLN) {\n      lat = 0;\n      lon = adjust_lon(this.long0 + x / this.a);\n    }\n    else {\n\n      al = (this.ml0 + y) / this.a;\n      bl = x * x / this.a / this.a + al * al;\n      phi = al;\n      var cl, mln, mlnp, ma;\n      var con;\n      for (i = MAX_ITER; i; --i) {\n        con = this.e * Math.sin(phi);\n        cl = Math.sqrt(1 - con * con) * Math.tan(phi);\n        mln = this.a * mlfn(this.e0, this.e1, this.e2, this.e3, phi);\n        mlnp = this.e0 - 2 * this.e1 * Math.cos(2 * phi) + 4 * this.e2 * Math.cos(4 * phi) - 6 * this.e3 * Math.cos(6 * phi);\n        ma = mln / this.a;\n        dphi = (al * (cl * ma + 1) - ma - 0.5 * cl * (ma * ma + bl)) / (this.es * Math.sin(2 * phi) * (ma * ma + bl - 2 * al * ma) / (4 * cl) + (al - ma) * (cl * mlnp - 2 / Math.sin(2 * phi)) - mlnp);\n        phi -= dphi;\n        if (Math.abs(dphi) <= EPSLN) {\n          lat = phi;\n          break;\n        }\n      }\n\n      //lat=phi4z(this.e,this.e0,this.e1,this.e2,this.e3,al,bl,0,0);\n      cl = Math.sqrt(1 - this.es * Math.pow(Math.sin(lat), 2)) * Math.tan(lat);\n      lon = adjust_lon(this.long0 + Math.asin(x * cl / this.a) / Math.sin(lat));\n    }\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Polyconic\", \"poly\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import {SEC_TO_RAD} from '../constants/values';\n\n/*\n  reference\n    Department of Land and Survey Technical Circular 1973/32\n      http://www.linz.govt.nz/docs/miscellaneous/nz-map-definition.pdf\n    OSG Technical Report 4.1\n      http://www.linz.govt.nz/docs/miscellaneous/nzmg.pdf\n  */\n\n/**\n * iterations: Number of iterations to refine inverse transform.\n *     0 -> km accuracy\n *     1 -> m accuracy -- suitable for most mapping applications\n *     2 -> mm accuracy\n */\nexport var iterations = 1;\n\nexport function init() {\n  this.A = [];\n  this.A[1] = 0.6399175073;\n  this.A[2] = -0.1358797613;\n  this.A[3] = 0.063294409;\n  this.A[4] = -0.02526853;\n  this.A[5] = 0.0117879;\n  this.A[6] = -0.0055161;\n  this.A[7] = 0.0026906;\n  this.A[8] = -0.001333;\n  this.A[9] = 0.00067;\n  this.A[10] = -0.00034;\n\n  this.B_re = [];\n  this.B_im = [];\n  this.B_re[1] = 0.7557853228;\n  this.B_im[1] = 0;\n  this.B_re[2] = 0.249204646;\n  this.B_im[2] = 0.003371507;\n  this.B_re[3] = -0.001541739;\n  this.B_im[3] = 0.041058560;\n  this.B_re[4] = -0.10162907;\n  this.B_im[4] = 0.01727609;\n  this.B_re[5] = -0.26623489;\n  this.B_im[5] = -0.36249218;\n  this.B_re[6] = -0.6870983;\n  this.B_im[6] = -1.1651967;\n\n  this.C_re = [];\n  this.C_im = [];\n  this.C_re[1] = 1.3231270439;\n  this.C_im[1] = 0;\n  this.C_re[2] = -0.577245789;\n  this.C_im[2] = -0.007809598;\n  this.C_re[3] = 0.508307513;\n  this.C_im[3] = -0.112208952;\n  this.C_re[4] = -0.15094762;\n  this.C_im[4] = 0.18200602;\n  this.C_re[5] = 1.01418179;\n  this.C_im[5] = 1.64497696;\n  this.C_re[6] = 1.9660549;\n  this.C_im[6] = 2.5127645;\n\n  this.D = [];\n  this.D[1] = 1.5627014243;\n  this.D[2] = 0.5185406398;\n  this.D[3] = -0.03333098;\n  this.D[4] = -0.1052906;\n  this.D[5] = -0.0368594;\n  this.D[6] = 0.007317;\n  this.D[7] = 0.01220;\n  this.D[8] = 0.00394;\n  this.D[9] = -0.0013;\n}\n\n/**\n    New Zealand Map Grid Forward  - long/lat to x/y\n    long/lat in radians\n  */\nexport function forward(p) {\n  var n;\n  var lon = p.x;\n  var lat = p.y;\n\n  var delta_lat = lat - this.lat0;\n  var delta_lon = lon - this.long0;\n\n  // 1. Calculate d_phi and d_psi    ...                          // and d_lambda\n  // For this algorithm, delta_latitude is in seconds of arc x 10-5, so we need to scale to those units. Longitude is radians.\n  var d_phi = delta_lat / SEC_TO_RAD * 1E-5;\n  var d_lambda = delta_lon;\n  var d_phi_n = 1; // d_phi^0\n\n  var d_psi = 0;\n  for (n = 1; n <= 10; n++) {\n    d_phi_n = d_phi_n * d_phi;\n    d_psi = d_psi + this.A[n] * d_phi_n;\n  }\n\n  // 2. Calculate theta\n  var th_re = d_psi;\n  var th_im = d_lambda;\n\n  // 3. Calculate z\n  var th_n_re = 1;\n  var th_n_im = 0; // theta^0\n  var th_n_re1;\n  var th_n_im1;\n\n  var z_re = 0;\n  var z_im = 0;\n  for (n = 1; n <= 6; n++) {\n    th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n    th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n    th_n_re = th_n_re1;\n    th_n_im = th_n_im1;\n    z_re = z_re + this.B_re[n] * th_n_re - this.B_im[n] * th_n_im;\n    z_im = z_im + this.B_im[n] * th_n_re + this.B_re[n] * th_n_im;\n  }\n\n  // 4. Calculate easting and northing\n  p.x = (z_im * this.a) + this.x0;\n  p.y = (z_re * this.a) + this.y0;\n\n  return p;\n}\n\n/**\n    New Zealand Map Grid Inverse  -  x/y to long/lat\n  */\nexport function inverse(p) {\n  var n;\n  var x = p.x;\n  var y = p.y;\n\n  var delta_x = x - this.x0;\n  var delta_y = y - this.y0;\n\n  // 1. Calculate z\n  var z_re = delta_y / this.a;\n  var z_im = delta_x / this.a;\n\n  // 2a. Calculate theta - first approximation gives km accuracy\n  var z_n_re = 1;\n  var z_n_im = 0; // z^0\n  var z_n_re1;\n  var z_n_im1;\n\n  var th_re = 0;\n  var th_im = 0;\n  for (n = 1; n <= 6; n++) {\n    z_n_re1 = z_n_re * z_re - z_n_im * z_im;\n    z_n_im1 = z_n_im * z_re + z_n_re * z_im;\n    z_n_re = z_n_re1;\n    z_n_im = z_n_im1;\n    th_re = th_re + this.C_re[n] * z_n_re - this.C_im[n] * z_n_im;\n    th_im = th_im + this.C_im[n] * z_n_re + this.C_re[n] * z_n_im;\n  }\n\n  // 2b. Iterate to refine the accuracy of the calculation\n  //        0 iterations gives km accuracy\n  //        1 iteration gives m accuracy -- good enough for most mapping applications\n  //        2 iterations bives mm accuracy\n  for (var i = 0; i < this.iterations; i++) {\n    var th_n_re = th_re;\n    var th_n_im = th_im;\n    var th_n_re1;\n    var th_n_im1;\n\n    var num_re = z_re;\n    var num_im = z_im;\n    for (n = 2; n <= 6; n++) {\n      th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n      th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n      th_n_re = th_n_re1;\n      th_n_im = th_n_im1;\n      num_re = num_re + (n - 1) * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);\n      num_im = num_im + (n - 1) * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);\n    }\n\n    th_n_re = 1;\n    th_n_im = 0;\n    var den_re = this.B_re[1];\n    var den_im = this.B_im[1];\n    for (n = 2; n <= 6; n++) {\n      th_n_re1 = th_n_re * th_re - th_n_im * th_im;\n      th_n_im1 = th_n_im * th_re + th_n_re * th_im;\n      th_n_re = th_n_re1;\n      th_n_im = th_n_im1;\n      den_re = den_re + n * (this.B_re[n] * th_n_re - this.B_im[n] * th_n_im);\n      den_im = den_im + n * (this.B_im[n] * th_n_re + this.B_re[n] * th_n_im);\n    }\n\n    // Complex division\n    var den2 = den_re * den_re + den_im * den_im;\n    th_re = (num_re * den_re + num_im * den_im) / den2;\n    th_im = (num_im * den_re - num_re * den_im) / den2;\n  }\n\n  // 3. Calculate d_phi              ...                                    // and d_lambda\n  var d_psi = th_re;\n  var d_lambda = th_im;\n  var d_psi_n = 1; // d_psi^0\n\n  var d_phi = 0;\n  for (n = 1; n <= 9; n++) {\n    d_psi_n = d_psi_n * d_psi;\n    d_phi = d_phi + this.D[n] * d_psi_n;\n  }\n\n  // 4. Calculate latitude and longitude\n  // d_phi is calcuated in second of arc * 10^-5, so we need to scale back to radians. d_lambda is in radians.\n  var lat = this.lat0 + (d_phi * SEC_TO_RAD * 1E5);\n  var lon = this.long0 + d_lambda;\n\n  p.x = lon;\n  p.y = lat;\n\n  return p;\n}\n\nexport var names = [\"New_Zealand_Map_Grid\", \"nzmg\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\n\n/*\n  reference\n    \"New Equal-Area Map Projections for Noncircular Regions\", John P. Snyder,\n    The American Cartographer, Vol 15, No. 4, October 1988, pp. 341-355.\n  */\n\n\n/* Initialize the Miller Cylindrical projection\n  -------------------------------------------*/\nexport function init() {\n  //no-op\n}\n\n/* Miller Cylindrical forward equations--mapping lat,long to x,y\n    ------------------------------------------------------------*/\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n      -----------------*/\n  var dlon = adjust_lon(lon - this.long0);\n  var x = this.x0 + this.a * dlon;\n  var y = this.y0 + this.a * Math.log(Math.tan((Math.PI / 4) + (lat / 2.5))) * 1.25;\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Miller Cylindrical inverse equations--mapping x,y to lat/long\n    ------------------------------------------------------------*/\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n\n  var lon = adjust_lon(this.long0 + p.x / this.a);\n  var lat = 2.5 * (Math.atan(Math.exp(0.8 * p.y / this.a)) - Math.PI / 4);\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Miller_Cylindrical\", \"mill\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport pj_enfn from '../common/pj_enfn';\nvar MAX_ITER = 20;\nimport pj_mlfn from '../common/pj_mlfn';\nimport pj_inv_mlfn from '../common/pj_inv_mlfn';\nimport {EPSLN, HALF_PI} from '../constants/values';\n\nimport asinz from '../common/asinz';\n\n\nexport function init() {\n  /* Place parameters in static storage for common use\n    -------------------------------------------------*/\n\n\n  if (!this.sphere) {\n    this.en = pj_enfn(this.es);\n  }\n  else {\n    this.n = 1;\n    this.m = 0;\n    this.es = 0;\n    this.C_y = Math.sqrt((this.m + 1) / this.n);\n    this.C_x = this.C_y / (this.m + 1);\n  }\n\n}\n\n/* Sinusoidal forward equations--mapping lat,long to x,y\n  -----------------------------------------------------*/\nexport function forward(p) {\n  var x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n    -----------------*/\n  lon = adjust_lon(lon - this.long0);\n\n  if (this.sphere) {\n    if (!this.m) {\n      lat = this.n !== 1 ? Math.asin(this.n * Math.sin(lat)) : lat;\n    }\n    else {\n      var k = this.n * Math.sin(lat);\n      for (var i = MAX_ITER; i; --i) {\n        var V = (this.m * lat + Math.sin(lat) - k) / (this.m + Math.cos(lat));\n        lat -= V;\n        if (Math.abs(V) < EPSLN) {\n          break;\n        }\n      }\n    }\n    x = this.a * this.C_x * lon * (this.m + Math.cos(lat));\n    y = this.a * this.C_y * lat;\n\n  }\n  else {\n\n    var s = Math.sin(lat);\n    var c = Math.cos(lat);\n    y = this.a * pj_mlfn(lat, s, c, this.en);\n    x = this.a * lon * c / Math.sqrt(1 - this.es * s * s);\n  }\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var lat, temp, lon, s;\n\n  p.x -= this.x0;\n  lon = p.x / this.a;\n  p.y -= this.y0;\n  lat = p.y / this.a;\n\n  if (this.sphere) {\n    lat /= this.C_y;\n    lon = lon / (this.C_x * (this.m + Math.cos(lat)));\n    if (this.m) {\n      lat = asinz((this.m * lat + Math.sin(lat)) / this.n);\n    }\n    else if (this.n !== 1) {\n      lat = asinz(Math.sin(lat) / this.n);\n    }\n    lon = adjust_lon(lon + this.long0);\n    lat = adjust_lat(lat);\n  }\n  else {\n    lat = pj_inv_mlfn(p.y / this.a, this.es, this.en);\n    s = Math.abs(lat);\n    if (s < HALF_PI) {\n      s = Math.sin(lat);\n      temp = this.long0 + p.x * Math.sqrt(1 - this.es * s * s) / (this.a * Math.cos(lat));\n      //temp = this.long0 + p.x / (this.a * Math.cos(lat));\n      lon = adjust_lon(temp);\n    }\n    else if ((s - EPSLN) < HALF_PI) {\n      lon = this.long0;\n    }\n  }\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Sinusoidal\", \"sinu\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nexport function init() {}\nimport {EPSLN} from '../constants/values';\n/* Mollweide forward equations--mapping lat,long to x,y\n    ----------------------------------------------------*/\nexport function forward(p) {\n\n  /* Forward equations\n      -----------------*/\n  var lon = p.x;\n  var lat = p.y;\n\n  var delta_lon = adjust_lon(lon - this.long0);\n  var theta = lat;\n  var con = Math.PI * Math.sin(lat);\n\n  /* Iterate using the Newton-Raphson method to find theta\n      -----------------------------------------------------*/\n  for (var i = 0; true; i++) {\n    var delta_theta = -(theta + Math.sin(theta) - con) / (1 + Math.cos(theta));\n    theta += delta_theta;\n    if (Math.abs(delta_theta) < EPSLN) {\n      break;\n    }\n  }\n  theta /= 2;\n\n  /* If the latitude is 90 deg, force the x coordinate to be \"0 + false easting\"\n       this is done here because of precision problems with \"cos(theta)\"\n       --------------------------------------------------------------------------*/\n  if (Math.PI / 2 - Math.abs(lat) < EPSLN) {\n    delta_lon = 0;\n  }\n  var x = 0.900316316158 * this.a * delta_lon * Math.cos(theta) + this.x0;\n  var y = 1.4142135623731 * this.a * Math.sin(theta) + this.y0;\n\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var theta;\n  var arg;\n\n  /* Inverse equations\n      -----------------*/\n  p.x -= this.x0;\n  p.y -= this.y0;\n  arg = p.y / (1.4142135623731 * this.a);\n\n  /* Because of division by zero problems, 'arg' can not be 1.  Therefore\n       a number very close to one is used instead.\n       -------------------------------------------------------------------*/\n  if (Math.abs(arg) > 0.999999999999) {\n    arg = 0.999999999999;\n  }\n  theta = Math.asin(arg);\n  var lon = adjust_lon(this.long0 + (p.x / (0.900316316158 * this.a * Math.cos(theta))));\n  if (lon < (-Math.PI)) {\n    lon = -Math.PI;\n  }\n  if (lon > Math.PI) {\n    lon = Math.PI;\n  }\n  arg = (2 * theta + Math.sin(2 * theta)) / Math.PI;\n  if (Math.abs(arg) > 1) {\n    arg = 1;\n  }\n  var lat = Math.asin(arg);\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Mollweide\", \"moll\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport msfnz from '../common/msfnz';\nimport mlfn from '../common/mlfn';\nimport adjust_lon from '../common/adjust_lon';\nimport adjust_lat from '../common/adjust_lat';\nimport imlfn from '../common/imlfn';\nimport {EPSLN} from '../constants/values';\n\nexport function init() {\n\n  /* Place parameters in static storage for common use\n      -------------------------------------------------*/\n  // Standard Parallels cannot be equal and on opposite sides of the equator\n  if (Math.abs(this.lat1 + this.lat2) < EPSLN) {\n    return;\n  }\n  this.lat2 = this.lat2 || this.lat1;\n  this.temp = this.b / this.a;\n  this.es = 1 - Math.pow(this.temp, 2);\n  this.e = Math.sqrt(this.es);\n  this.e0 = e0fn(this.es);\n  this.e1 = e1fn(this.es);\n  this.e2 = e2fn(this.es);\n  this.e3 = e3fn(this.es);\n\n  this.sinphi = Math.sin(this.lat1);\n  this.cosphi = Math.cos(this.lat1);\n\n  this.ms1 = msfnz(this.e, this.sinphi, this.cosphi);\n  this.ml1 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat1);\n\n  if (Math.abs(this.lat1 - this.lat2) < EPSLN) {\n    this.ns = this.sinphi;\n  }\n  else {\n    this.sinphi = Math.sin(this.lat2);\n    this.cosphi = Math.cos(this.lat2);\n    this.ms2 = msfnz(this.e, this.sinphi, this.cosphi);\n    this.ml2 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat2);\n    this.ns = (this.ms1 - this.ms2) / (this.ml2 - this.ml1);\n  }\n  this.g = this.ml1 + this.ms1 / this.ns;\n  this.ml0 = mlfn(this.e0, this.e1, this.e2, this.e3, this.lat0);\n  this.rh = this.a * (this.g - this.ml0);\n}\n\n/* Equidistant Conic forward equations--mapping lat,long to x,y\n  -----------------------------------------------------------*/\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var rh1;\n\n  /* Forward equations\n      -----------------*/\n  if (this.sphere) {\n    rh1 = this.a * (this.g - lat);\n  }\n  else {\n    var ml = mlfn(this.e0, this.e1, this.e2, this.e3, lat);\n    rh1 = this.a * (this.g - ml);\n  }\n  var theta = this.ns * adjust_lon(lon - this.long0);\n  var x = this.x0 + rh1 * Math.sin(theta);\n  var y = this.y0 + this.rh - rh1 * Math.cos(theta);\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Inverse equations\n  -----------------*/\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y = this.rh - p.y + this.y0;\n  var con, rh1, lat, lon;\n  if (this.ns >= 0) {\n    rh1 = Math.sqrt(p.x * p.x + p.y * p.y);\n    con = 1;\n  }\n  else {\n    rh1 = -Math.sqrt(p.x * p.x + p.y * p.y);\n    con = -1;\n  }\n  var theta = 0;\n  if (rh1 !== 0) {\n    theta = Math.atan2(con * p.x, con * p.y);\n  }\n\n  if (this.sphere) {\n    lon = adjust_lon(this.long0 + theta / this.ns);\n    lat = adjust_lat(this.g - rh1 / this.a);\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  else {\n    var ml = this.g - rh1 / this.a;\n    lat = imlfn(ml, this.e0, this.e1, this.e2, this.e3);\n    lon = adjust_lon(this.long0 + theta / this.ns);\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n\n}\n\nexport var names = [\"Equidistant_Conic\", \"eqdc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\n\nimport {HALF_PI, EPSLN} from '../constants/values';\n\nimport asinz from '../common/asinz';\n\n/* Initialize the Van Der Grinten projection\n  ----------------------------------------*/\nexport function init() {\n  //this.R = 6370997; //Radius of earth\n  this.R = this.a;\n}\n\nexport function forward(p) {\n\n  var lon = p.x;\n  var lat = p.y;\n\n  /* Forward equations\n    -----------------*/\n  var dlon = adjust_lon(lon - this.long0);\n  var x, y;\n\n  if (Math.abs(lat) <= EPSLN) {\n    x = this.x0 + this.R * dlon;\n    y = this.y0;\n  }\n  var theta = asinz(2 * Math.abs(lat / Math.PI));\n  if ((Math.abs(dlon) <= EPSLN) || (Math.abs(Math.abs(lat) - HALF_PI) <= EPSLN)) {\n    x = this.x0;\n    if (lat >= 0) {\n      y = this.y0 + Math.PI * this.R * Math.tan(0.5 * theta);\n    }\n    else {\n      y = this.y0 + Math.PI * this.R * -Math.tan(0.5 * theta);\n    }\n    //  return(OK);\n  }\n  var al = 0.5 * Math.abs((Math.PI / dlon) - (dlon / Math.PI));\n  var asq = al * al;\n  var sinth = Math.sin(theta);\n  var costh = Math.cos(theta);\n\n  var g = costh / (sinth + costh - 1);\n  var gsq = g * g;\n  var m = g * (2 / sinth - 1);\n  var msq = m * m;\n  var con = Math.PI * this.R * (al * (g - msq) + Math.sqrt(asq * (g - msq) * (g - msq) - (msq + asq) * (gsq - msq))) / (msq + asq);\n  if (dlon < 0) {\n    con = -con;\n  }\n  x = this.x0 + con;\n  //con = Math.abs(con / (Math.PI * this.R));\n  var q = asq + g;\n  con = Math.PI * this.R * (m * q - al * Math.sqrt((msq + asq) * (asq + 1) - q * q)) / (msq + asq);\n  if (lat >= 0) {\n    //y = this.y0 + Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n    y = this.y0 + con;\n  }\n  else {\n    //y = this.y0 - Math.PI * this.R * Math.sqrt(1 - con * con - 2 * al * con);\n    y = this.y0 - con;\n  }\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\n/* Van Der Grinten inverse equations--mapping x,y to lat/long\n  ---------------------------------------------------------*/\nexport function inverse(p) {\n  var lon, lat;\n  var xx, yy, xys, c1, c2, c3;\n  var a1;\n  var m1;\n  var con;\n  var th1;\n  var d;\n\n  /* inverse equations\n    -----------------*/\n  p.x -= this.x0;\n  p.y -= this.y0;\n  con = Math.PI * this.R;\n  xx = p.x / con;\n  yy = p.y / con;\n  xys = xx * xx + yy * yy;\n  c1 = -Math.abs(yy) * (1 + xys);\n  c2 = c1 - 2 * yy * yy + xx * xx;\n  c3 = -2 * c1 + 1 + 2 * yy * yy + xys * xys;\n  d = yy * yy / c3 + (2 * c2 * c2 * c2 / c3 / c3 / c3 - 9 * c1 * c2 / c3 / c3) / 27;\n  a1 = (c1 - c2 * c2 / 3 / c3) / c3;\n  m1 = 2 * Math.sqrt(-a1 / 3);\n  con = ((3 * d) / a1) / m1;\n  if (Math.abs(con) > 1) {\n    if (con >= 0) {\n      con = 1;\n    }\n    else {\n      con = -1;\n    }\n  }\n  th1 = Math.acos(con) / 3;\n  if (p.y >= 0) {\n    lat = (-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n  }\n  else {\n    lat = -(-m1 * Math.cos(th1 + Math.PI / 3) - c2 / 3 / c3) * Math.PI;\n  }\n\n  if (Math.abs(xx) < EPSLN) {\n    lon = this.long0;\n  }\n  else {\n    lon = adjust_lon(this.long0 + Math.PI * (xys - 1 + Math.sqrt(1 + 2 * (xx * xx - yy * yy) + xys * xys)) / 2 / xx);\n  }\n\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"Van_der_Grinten_I\", \"VanDerGrinten\", \"vandg\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport {HALF_PI, EPSLN} from '../constants/values';\n\nimport mlfn from '../common/mlfn';\nimport e0fn from '../common/e0fn';\nimport e1fn from '../common/e1fn';\nimport e2fn from '../common/e2fn';\nimport e3fn from '../common/e3fn';\nimport gN from '../common/gN';\nimport asinz from '../common/asinz';\nimport imlfn from '../common/imlfn';\n\n\n\nexport function init() {\n  this.sin_p12 = Math.sin(this.lat0);\n  this.cos_p12 = Math.cos(this.lat0);\n}\n\nexport function forward(p) {\n  var lon = p.x;\n  var lat = p.y;\n  var sinphi = Math.sin(p.y);\n  var cosphi = Math.cos(p.y);\n  var dlon = adjust_lon(lon - this.long0);\n  var e0, e1, e2, e3, Mlp, Ml, tanphi, Nl1, Nl, psi, Az, G, H, GH, Hs, c, kp, cos_c, s, s2, s3, s4, s5;\n  if (this.sphere) {\n    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n      //North Pole case\n      p.x = this.x0 + this.a * (HALF_PI - lat) * Math.sin(dlon);\n      p.y = this.y0 - this.a * (HALF_PI - lat) * Math.cos(dlon);\n      return p;\n    }\n    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n      //South Pole case\n      p.x = this.x0 + this.a * (HALF_PI + lat) * Math.sin(dlon);\n      p.y = this.y0 + this.a * (HALF_PI + lat) * Math.cos(dlon);\n      return p;\n    }\n    else {\n      //default case\n      cos_c = this.sin_p12 * sinphi + this.cos_p12 * cosphi * Math.cos(dlon);\n      c = Math.acos(cos_c);\n      kp = c / Math.sin(c);\n      p.x = this.x0 + this.a * kp * cosphi * Math.sin(dlon);\n      p.y = this.y0 + this.a * kp * (this.cos_p12 * sinphi - this.sin_p12 * cosphi * Math.cos(dlon));\n      return p;\n    }\n  }\n  else {\n    e0 = e0fn(this.es);\n    e1 = e1fn(this.es);\n    e2 = e2fn(this.es);\n    e3 = e3fn(this.es);\n    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n      //North Pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      Ml = this.a * mlfn(e0, e1, e2, e3, lat);\n      p.x = this.x0 + (Mlp - Ml) * Math.sin(dlon);\n      p.y = this.y0 - (Mlp - Ml) * Math.cos(dlon);\n      return p;\n    }\n    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n      //South Pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      Ml = this.a * mlfn(e0, e1, e2, e3, lat);\n      p.x = this.x0 + (Mlp + Ml) * Math.sin(dlon);\n      p.y = this.y0 + (Mlp + Ml) * Math.cos(dlon);\n      return p;\n    }\n    else {\n      //Default case\n      tanphi = sinphi / cosphi;\n      Nl1 = gN(this.a, this.e, this.sin_p12);\n      Nl = gN(this.a, this.e, sinphi);\n      psi = Math.atan((1 - this.es) * tanphi + this.es * Nl1 * this.sin_p12 / (Nl * cosphi));\n      Az = Math.atan2(Math.sin(dlon), this.cos_p12 * Math.tan(psi) - this.sin_p12 * Math.cos(dlon));\n      if (Az === 0) {\n        s = Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));\n      }\n      else if (Math.abs(Math.abs(Az) - Math.PI) <= EPSLN) {\n        s = -Math.asin(this.cos_p12 * Math.sin(psi) - this.sin_p12 * Math.cos(psi));\n      }\n      else {\n        s = Math.asin(Math.sin(dlon) * Math.cos(psi) / Math.sin(Az));\n      }\n      G = this.e * this.sin_p12 / Math.sqrt(1 - this.es);\n      H = this.e * this.cos_p12 * Math.cos(Az) / Math.sqrt(1 - this.es);\n      GH = G * H;\n      Hs = H * H;\n      s2 = s * s;\n      s3 = s2 * s;\n      s4 = s3 * s;\n      s5 = s4 * s;\n      c = Nl1 * s * (1 - s2 * Hs * (1 - Hs) / 6 + s3 / 8 * GH * (1 - 2 * Hs) + s4 / 120 * (Hs * (4 - 7 * Hs) - 3 * G * G * (1 - 7 * Hs)) - s5 / 48 * GH);\n      p.x = this.x0 + c * Math.sin(Az);\n      p.y = this.y0 + c * Math.cos(Az);\n      return p;\n    }\n  }\n\n\n}\n\nexport function inverse(p) {\n  p.x -= this.x0;\n  p.y -= this.y0;\n  var rh, z, sinz, cosz, lon, lat, con, e0, e1, e2, e3, Mlp, M, N1, psi, Az, cosAz, tmp, A, B, D, Ee, F;\n  if (this.sphere) {\n    rh = Math.sqrt(p.x * p.x + p.y * p.y);\n    if (rh > (2 * HALF_PI * this.a)) {\n      return;\n    }\n    z = rh / this.a;\n\n    sinz = Math.sin(z);\n    cosz = Math.cos(z);\n\n    lon = this.long0;\n    if (Math.abs(rh) <= EPSLN) {\n      lat = this.lat0;\n    }\n    else {\n      lat = asinz(cosz * this.sin_p12 + (p.y * sinz * this.cos_p12) / rh);\n      con = Math.abs(this.lat0) - HALF_PI;\n      if (Math.abs(con) <= EPSLN) {\n        if (this.lat0 >= 0) {\n          lon = adjust_lon(this.long0 + Math.atan2(p.x, - p.y));\n        }\n        else {\n          lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));\n        }\n      }\n      else {\n        /*con = cosz - this.sin_p12 * Math.sin(lat);\n        if ((Math.abs(con) < EPSLN) && (Math.abs(p.x) < EPSLN)) {\n          //no-op, just keep the lon value as is\n        } else {\n          var temp = Math.atan2((p.x * sinz * this.cos_p12), (con * rh));\n          lon = adjust_lon(this.long0 + Math.atan2((p.x * sinz * this.cos_p12), (con * rh)));\n        }*/\n        lon = adjust_lon(this.long0 + Math.atan2(p.x * sinz, rh * this.cos_p12 * cosz - p.y * this.sin_p12 * sinz));\n      }\n    }\n\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  else {\n    e0 = e0fn(this.es);\n    e1 = e1fn(this.es);\n    e2 = e2fn(this.es);\n    e3 = e3fn(this.es);\n    if (Math.abs(this.sin_p12 - 1) <= EPSLN) {\n      //North pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n      M = Mlp - rh;\n      lat = imlfn(M / this.a, e0, e1, e2, e3);\n      lon = adjust_lon(this.long0 + Math.atan2(p.x, - 1 * p.y));\n      p.x = lon;\n      p.y = lat;\n      return p;\n    }\n    else if (Math.abs(this.sin_p12 + 1) <= EPSLN) {\n      //South pole case\n      Mlp = this.a * mlfn(e0, e1, e2, e3, HALF_PI);\n      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n      M = rh - Mlp;\n\n      lat = imlfn(M / this.a, e0, e1, e2, e3);\n      lon = adjust_lon(this.long0 + Math.atan2(p.x, p.y));\n      p.x = lon;\n      p.y = lat;\n      return p;\n    }\n    else {\n      //default case\n      rh = Math.sqrt(p.x * p.x + p.y * p.y);\n      Az = Math.atan2(p.x, p.y);\n      N1 = gN(this.a, this.e, this.sin_p12);\n      cosAz = Math.cos(Az);\n      tmp = this.e * this.cos_p12 * cosAz;\n      A = -tmp * tmp / (1 - this.es);\n      B = 3 * this.es * (1 - A) * this.sin_p12 * this.cos_p12 * cosAz / (1 - this.es);\n      D = rh / N1;\n      Ee = D - A * (1 + A) * Math.pow(D, 3) / 6 - B * (1 + 3 * A) * Math.pow(D, 4) / 24;\n      F = 1 - A * Ee * Ee / 2 - D * Ee * Ee * Ee / 6;\n      psi = Math.asin(this.sin_p12 * Math.cos(Ee) + this.cos_p12 * Math.sin(Ee) * cosAz);\n      lon = adjust_lon(this.long0 + Math.asin(Math.sin(Az) * Math.sin(Ee) / Math.cos(psi)));\n      lat = Math.atan((1 - this.es * F * this.sin_p12 / Math.sin(psi)) * Math.tan(psi) / (1 - this.es));\n      p.x = lon;\n      p.y = lat;\n      return p;\n    }\n  }\n\n}\n\nexport var names = [\"Azimuthal_Equidistant\", \"aeqd\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","import adjust_lon from '../common/adjust_lon';\nimport asinz from '../common/asinz';\nimport {EPSLN, HALF_PI} from '../constants/values';\n\nexport function init() {\n  //double temp;      /* temporary variable    */\n\n  /* Place parameters in static storage for common use\n      -------------------------------------------------*/\n  this.sin_p14 = Math.sin(this.lat0);\n  this.cos_p14 = Math.cos(this.lat0);\n}\n\n/* Orthographic forward equations--mapping lat,long to x,y\n    ---------------------------------------------------*/\nexport function forward(p) {\n  var sinphi, cosphi; /* sin and cos value        */\n  var dlon; /* delta longitude value      */\n  var coslon; /* cos of longitude        */\n  var ksp; /* scale factor          */\n  var g, x, y;\n  var lon = p.x;\n  var lat = p.y;\n  /* Forward equations\n      -----------------*/\n  dlon = adjust_lon(lon - this.long0);\n\n  sinphi = Math.sin(lat);\n  cosphi = Math.cos(lat);\n\n  coslon = Math.cos(dlon);\n  g = this.sin_p14 * sinphi + this.cos_p14 * cosphi * coslon;\n  ksp = 1;\n  if ((g > 0) || (Math.abs(g) <= EPSLN)) {\n    x = this.a * ksp * cosphi * Math.sin(dlon);\n    y = this.y0 + this.a * ksp * (this.cos_p14 * sinphi - this.sin_p14 * cosphi * coslon);\n  }\n  p.x = x;\n  p.y = y;\n  return p;\n}\n\nexport function inverse(p) {\n  var rh; /* height above ellipsoid      */\n  var z; /* angle          */\n  var sinz, cosz; /* sin of z and cos of z      */\n  var con;\n  var lon, lat;\n  /* Inverse equations\n      -----------------*/\n  p.x -= this.x0;\n  p.y -= this.y0;\n  rh = Math.sqrt(p.x * p.x + p.y * p.y);\n  z = asinz(rh / this.a);\n\n  sinz = Math.sin(z);\n  cosz = Math.cos(z);\n\n  lon = this.long0;\n  if (Math.abs(rh) <= EPSLN) {\n    lat = this.lat0;\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  lat = asinz(cosz * this.sin_p14 + (p.y * sinz * this.cos_p14) / rh);\n  con = Math.abs(this.lat0) - HALF_PI;\n  if (Math.abs(con) <= EPSLN) {\n    if (this.lat0 >= 0) {\n      lon = adjust_lon(this.long0 + Math.atan2(p.x, - p.y));\n    }\n    else {\n      lon = adjust_lon(this.long0 - Math.atan2(-p.x, p.y));\n    }\n    p.x = lon;\n    p.y = lat;\n    return p;\n  }\n  lon = adjust_lon(this.long0 + Math.atan2((p.x * sinz), rh * this.cos_p14 * cosz - p.y * this.sin_p14 * sinz));\n  p.x = lon;\n  p.y = lat;\n  return p;\n}\n\nexport var names = [\"ortho\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n","export function init() {\n  this.isGeocent = true;\n}\n\nfunction identity(pt) {\n  return pt;\n}\nexport {identity as forward};\nexport {identity as inverse};\nexport var names = [\"geocent\"];\nexport default {\n  init: init,\n  forward: identity,\n  inverse: identity,\n  names: names\n};","// QSC projection rewritten from the original PROJ4\n// https://github.com/OSGeo/proj.4/blob/master/src/PJ_qsc.c\n\nimport {EPSLN, TWO_PI, SPI, HALF_PI, FORTPI} from '../constants/values';\n\n/* constants */\nvar FACE_ENUM = {\n    FRONT: 1,\n    RIGHT: 2,\n    BACK: 3,\n    LEFT: 4,\n    TOP: 5,\n    BOTTOM: 6\n};\n\nvar AREA_ENUM = {\n    AREA_0: 1,\n    AREA_1: 2,\n    AREA_2: 3,\n    AREA_3: 4\n};\n\nexport function init() {\n\n  this.x0 = this.x0 || 0;\n  this.y0 = this.y0 || 0;\n  this.lat0 = this.lat0 || 0;\n  this.long0 = this.long0 || 0;\n  this.lat_ts = this.lat_ts || 0;\n  this.title = this.title || \"Quadrilateralized Spherical Cube\";\n\n  /* Determine the cube face from the center of projection. */\n  if (this.lat0 >= HALF_PI - FORTPI / 2.0) {\n    this.face = FACE_ENUM.TOP;\n  } else if (this.lat0 <= -(HALF_PI - FORTPI / 2.0)) {\n    this.face = FACE_ENUM.BOTTOM;\n  } else if (Math.abs(this.long0) <= FORTPI) {\n    this.face = FACE_ENUM.FRONT;\n  } else if (Math.abs(this.long0) <= HALF_PI + FORTPI) {\n    this.face = this.long0 > 0.0 ? FACE_ENUM.RIGHT : FACE_ENUM.LEFT;\n  } else {\n    this.face = FACE_ENUM.BACK;\n  }\n\n  /* Fill in useful values for the ellipsoid <-> sphere shift\n   * described in [LK12]. */\n  if (this.es !== 0) {\n    this.one_minus_f = 1 - (this.a - this.b) / this.a;\n    this.one_minus_f_squared = this.one_minus_f * this.one_minus_f;\n  }\n}\n\n// QSC forward equations--mapping lat,long to x,y\n// -----------------------------------------------------------------\nexport function forward(p) {\n  var xy = {x: 0, y: 0};\n  var lat, lon;\n  var theta, phi;\n  var t, mu;\n  /* nu; */\n  var area = {value: 0};\n\n  // move lon according to projection's lon\n  p.x -= this.long0;\n\n  /* Convert the geodetic latitude to a geocentric latitude.\n   * This corresponds to the shift from the ellipsoid to the sphere\n   * described in [LK12]. */\n  if (this.es !== 0) {//if (P->es != 0) {\n    lat = Math.atan(this.one_minus_f_squared * Math.tan(p.y));\n  } else {\n    lat = p.y;\n  }\n\n  /* Convert the input lat, lon into theta, phi as used by QSC.\n   * This depends on the cube face and the area on it.\n   * For the top and bottom face, we can compute theta and phi\n   * directly from phi, lam. For the other faces, we must use\n   * unit sphere cartesian coordinates as an intermediate step. */\n  lon = p.x; //lon = lp.lam;\n  if (this.face === FACE_ENUM.TOP) {\n    phi = HALF_PI - lat;\n    if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {\n      area.value = AREA_ENUM.AREA_0;\n      theta = lon - HALF_PI;\n    } else if (lon > HALF_PI + FORTPI || lon <= -(HALF_PI + FORTPI)) {\n      area.value = AREA_ENUM.AREA_1;\n      theta = (lon > 0.0 ? lon - SPI : lon + SPI);\n    } else if (lon > -(HALF_PI + FORTPI) && lon <= -FORTPI) {\n      area.value = AREA_ENUM.AREA_2;\n      theta = lon + HALF_PI;\n    } else {\n      area.value = AREA_ENUM.AREA_3;\n      theta = lon;\n    }\n  } else if (this.face === FACE_ENUM.BOTTOM) {\n    phi = HALF_PI + lat;\n    if (lon >= FORTPI && lon <= HALF_PI + FORTPI) {\n      area.value = AREA_ENUM.AREA_0;\n      theta = -lon + HALF_PI;\n    } else if (lon < FORTPI && lon >= -FORTPI) {\n      area.value = AREA_ENUM.AREA_1;\n      theta = -lon;\n    } else if (lon < -FORTPI && lon >= -(HALF_PI + FORTPI)) {\n      area.value = AREA_ENUM.AREA_2;\n      theta = -lon - HALF_PI;\n    } else {\n      area.value = AREA_ENUM.AREA_3;\n      theta = (lon > 0.0 ? -lon + SPI : -lon - SPI);\n    }\n  } else {\n    var q, r, s;\n    var sinlat, coslat;\n    var sinlon, coslon;\n\n    if (this.face === FACE_ENUM.RIGHT) {\n      lon = qsc_shift_lon_origin(lon, +HALF_PI);\n    } else if (this.face === FACE_ENUM.BACK) {\n      lon = qsc_shift_lon_origin(lon, +SPI);\n    } else if (this.face === FACE_ENUM.LEFT) {\n      lon = qsc_shift_lon_origin(lon, -HALF_PI);\n    }\n    sinlat = Math.sin(lat);\n    coslat = Math.cos(lat);\n    sinlon = Math.sin(lon);\n    coslon = Math.cos(lon);\n    q = coslat * coslon;\n    r = coslat * sinlon;\n    s = sinlat;\n\n    if (this.face === FACE_ENUM.FRONT) {\n      phi = Math.acos(q);\n      theta = qsc_fwd_equat_face_theta(phi, s, r, area);\n    } else if (this.face === FACE_ENUM.RIGHT) {\n      phi = Math.acos(r);\n      theta = qsc_fwd_equat_face_theta(phi, s, -q, area);\n    } else if (this.face === FACE_ENUM.BACK) {\n      phi = Math.acos(-q);\n      theta = qsc_fwd_equat_face_theta(phi, s, -r, area);\n    } else if (this.face === FACE_ENUM.LEFT) {\n      phi = Math.acos(-r);\n      theta = qsc_fwd_equat_face_theta(phi, s, q, area);\n    } else {\n      /* Impossible */\n      phi = theta = 0;\n      area.value = AREA_ENUM.AREA_0;\n    }\n  }\n\n  /* Compute mu and nu for the area of definition.\n   * For mu, see Eq. (3-21) in [OL76], but note the typos:\n   * compare with Eq. (3-14). For nu, see Eq. (3-38). */\n  mu = Math.atan((12 / SPI) * (theta + Math.acos(Math.sin(theta) * Math.cos(FORTPI)) - HALF_PI));\n  t = Math.sqrt((1 - Math.cos(phi)) / (Math.cos(mu) * Math.cos(mu)) / (1 - Math.cos(Math.atan(1 / Math.cos(theta)))));\n\n  /* Apply the result to the real area. */\n  if (area.value === AREA_ENUM.AREA_1) {\n    mu += HALF_PI;\n  } else if (area.value === AREA_ENUM.AREA_2) {\n    mu += SPI;\n  } else if (area.value === AREA_ENUM.AREA_3) {\n    mu += 1.5 * SPI;\n  }\n\n  /* Now compute x, y from mu and nu */\n  xy.x = t * Math.cos(mu);\n  xy.y = t * Math.sin(mu);\n  xy.x = xy.x * this.a + this.x0;\n  xy.y = xy.y * this.a + this.y0;\n\n  p.x = xy.x;\n  p.y = xy.y;\n  return p;\n}\n\n// QSC inverse equations--mapping x,y to lat/long\n// -----------------------------------------------------------------\nexport function inverse(p) {\n  var lp = {lam: 0, phi: 0};\n  var mu, nu, cosmu, tannu;\n  var tantheta, theta, cosphi, phi;\n  var t;\n  var area = {value: 0};\n\n  /* de-offset */\n  p.x = (p.x - this.x0) / this.a;\n  p.y = (p.y - this.y0) / this.a;\n\n  /* Convert the input x, y to the mu and nu angles as used by QSC.\n   * This depends on the area of the cube face. */\n  nu = Math.atan(Math.sqrt(p.x * p.x + p.y * p.y));\n  mu = Math.atan2(p.y, p.x);\n  if (p.x >= 0.0 && p.x >= Math.abs(p.y)) {\n    area.value = AREA_ENUM.AREA_0;\n  } else if (p.y >= 0.0 && p.y >= Math.abs(p.x)) {\n    area.value = AREA_ENUM.AREA_1;\n    mu -= HALF_PI;\n  } else if (p.x < 0.0 && -p.x >= Math.abs(p.y)) {\n    area.value = AREA_ENUM.AREA_2;\n    mu = (mu < 0.0 ? mu + SPI : mu - SPI);\n  } else {\n    area.value = AREA_ENUM.AREA_3;\n    mu += HALF_PI;\n  }\n\n  /* Compute phi and theta for the area of definition.\n   * The inverse projection is not described in the original paper, but some\n   * good hints can be found here (as of 2011-12-14):\n   * http://fits.gsfc.nasa.gov/fitsbits/saf.93/saf.9302\n   * (search for \"Message-Id: <9302181759.AA25477 at fits.cv.nrao.edu>\") */\n  t = (SPI / 12) * Math.tan(mu);\n  tantheta = Math.sin(t) / (Math.cos(t) - (1 / Math.sqrt(2)));\n  theta = Math.atan(tantheta);\n  cosmu = Math.cos(mu);\n  tannu = Math.tan(nu);\n  cosphi = 1 - cosmu * cosmu * tannu * tannu * (1 - Math.cos(Math.atan(1 / Math.cos(theta))));\n  if (cosphi < -1) {\n    cosphi = -1;\n  } else if (cosphi > +1) {\n    cosphi = +1;\n  }\n\n  /* Apply the result to the real area on the cube face.\n   * For the top and bottom face, we can compute phi and lam directly.\n   * For the other faces, we must use unit sphere cartesian coordinates\n   * as an intermediate step. */\n  if (this.face === FACE_ENUM.TOP) {\n    phi = Math.acos(cosphi);\n    lp.phi = HALF_PI - phi;\n    if (area.value === AREA_ENUM.AREA_0) {\n      lp.lam = theta + HALF_PI;\n    } else if (area.value === AREA_ENUM.AREA_1) {\n      lp.lam = (theta < 0.0 ? theta + SPI : theta - SPI);\n    } else if (area.value === AREA_ENUM.AREA_2) {\n      lp.lam = theta - HALF_PI;\n    } else /* area.value == AREA_ENUM.AREA_3 */ {\n      lp.lam = theta;\n    }\n  } else if (this.face === FACE_ENUM.BOTTOM) {\n    phi = Math.acos(cosphi);\n    lp.phi = phi - HALF_PI;\n    if (area.value === AREA_ENUM.AREA_0) {\n      lp.lam = -theta + HALF_PI;\n    } else if (area.value === AREA_ENUM.AREA_1) {\n      lp.lam = -theta;\n    } else if (area.value === AREA_ENUM.AREA_2) {\n      lp.lam = -theta - HALF_PI;\n    } else /* area.value == AREA_ENUM.AREA_3 */ {\n      lp.lam = (theta < 0.0 ? -theta - SPI : -theta + SPI);\n    }\n  } else {\n    /* Compute phi and lam via cartesian unit sphere coordinates. */\n    var q, r, s;\n    q = cosphi;\n    t = q * q;\n    if (t >= 1) {\n      s = 0;\n    } else {\n      s = Math.sqrt(1 - t) * Math.sin(theta);\n    }\n    t += s * s;\n    if (t >= 1) {\n      r = 0;\n    } else {\n      r = Math.sqrt(1 - t);\n    }\n    /* Rotate q,r,s into the correct area. */\n    if (area.value === AREA_ENUM.AREA_1) {\n      t = r;\n      r = -s;\n      s = t;\n    } else if (area.value === AREA_ENUM.AREA_2) {\n      r = -r;\n      s = -s;\n    } else if (area.value === AREA_ENUM.AREA_3) {\n      t = r;\n      r = s;\n      s = -t;\n    }\n    /* Rotate q,r,s into the correct cube face. */\n    if (this.face === FACE_ENUM.RIGHT) {\n      t = q;\n      q = -r;\n      r = t;\n    } else if (this.face === FACE_ENUM.BACK) {\n      q = -q;\n      r = -r;\n    } else if (this.face === FACE_ENUM.LEFT) {\n      t = q;\n      q = r;\n      r = -t;\n    }\n    /* Now compute phi and lam from the unit sphere coordinates. */\n    lp.phi = Math.acos(-s) - HALF_PI;\n    lp.lam = Math.atan2(r, q);\n    if (this.face === FACE_ENUM.RIGHT) {\n      lp.lam = qsc_shift_lon_origin(lp.lam, -HALF_PI);\n    } else if (this.face === FACE_ENUM.BACK) {\n      lp.lam = qsc_shift_lon_origin(lp.lam, -SPI);\n    } else if (this.face === FACE_ENUM.LEFT) {\n      lp.lam = qsc_shift_lon_origin(lp.lam, +HALF_PI);\n    }\n  }\n\n  /* Apply the shift from the sphere to the ellipsoid as described\n   * in [LK12]. */\n  if (this.es !== 0) {\n    var invert_sign;\n    var tanphi, xa;\n    invert_sign = (lp.phi < 0 ? 1 : 0);\n    tanphi = Math.tan(lp.phi);\n    xa = this.b / Math.sqrt(tanphi * tanphi + this.one_minus_f_squared);\n    lp.phi = Math.atan(Math.sqrt(this.a * this.a - xa * xa) / (this.one_minus_f * xa));\n    if (invert_sign) {\n      lp.phi = -lp.phi;\n    }\n  }\n\n  lp.lam += this.long0;\n  p.x = lp.lam;\n  p.y = lp.phi;\n  return p;\n}\n\n/* Helper function for forward projection: compute the theta angle\n * and determine the area number. */\nfunction qsc_fwd_equat_face_theta(phi, y, x, area) {\n  var theta;\n  if (phi < EPSLN) {\n    area.value = AREA_ENUM.AREA_0;\n    theta = 0.0;\n  } else {\n    theta = Math.atan2(y, x);\n    if (Math.abs(theta) <= FORTPI) {\n      area.value = AREA_ENUM.AREA_0;\n    } else if (theta > FORTPI && theta <= HALF_PI + FORTPI) {\n      area.value = AREA_ENUM.AREA_1;\n      theta -= HALF_PI;\n    } else if (theta > HALF_PI + FORTPI || theta <= -(HALF_PI + FORTPI)) {\n      area.value = AREA_ENUM.AREA_2;\n      theta = (theta >= 0.0 ? theta - SPI : theta + SPI);\n    } else {\n      area.value = AREA_ENUM.AREA_3;\n      theta += HALF_PI;\n    }\n  }\n  return theta;\n}\n\n/* Helper function: shift the longitude. */\nfunction qsc_shift_lon_origin(lon, offset) {\n  var slon = lon + offset;\n  if (slon < -SPI) {\n    slon += TWO_PI;\n  } else if (slon > +SPI) {\n    slon -= TWO_PI;\n  }\n  return slon;\n}\n\nexport var names = [\"Quadrilateralized Spherical Cube\", \"Quadrilateralized_Spherical_Cube\", \"qsc\"];\nexport default {\n  init: init,\n  forward: forward,\n  inverse: inverse,\n  names: names\n};\n\n","import tmerc from './lib/projections/tmerc';\nimport etmerc from './lib/projections/etmerc';\nimport utm from './lib/projections/utm';\nimport sterea from './lib/projections/sterea';\nimport stere from './lib/projections/stere';\nimport somerc from './lib/projections/somerc';\nimport omerc from './lib/projections/omerc';\nimport lcc from './lib/projections/lcc';\nimport krovak from './lib/projections/krovak';\nimport cass from './lib/projections/cass';\nimport laea from './lib/projections/laea';\nimport aea from './lib/projections/aea';\nimport gnom from './lib/projections/gnom';\nimport cea from './lib/projections/cea';\nimport eqc from './lib/projections/eqc';\nimport poly from './lib/projections/poly';\nimport nzmg from './lib/projections/nzmg';\nimport mill from './lib/projections/mill';\nimport sinu from './lib/projections/sinu';\nimport moll from './lib/projections/moll';\nimport eqdc from './lib/projections/eqdc';\nimport vandg from './lib/projections/vandg';\nimport aeqd from './lib/projections/aeqd';\nimport ortho from './lib/projections/ortho';\nimport geocent from './lib/projections/geocent';\nimport qsc from './lib/projections/qsc';\nexport default function(proj4){\n  proj4.Proj.projections.add(tmerc);\n  proj4.Proj.projections.add(etmerc);\n  proj4.Proj.projections.add(utm);\n  proj4.Proj.projections.add(sterea);\n  proj4.Proj.projections.add(stere);\n  proj4.Proj.projections.add(somerc);\n  proj4.Proj.projections.add(omerc);\n  proj4.Proj.projections.add(lcc);\n  proj4.Proj.projections.add(krovak);\n  proj4.Proj.projections.add(cass);\n  proj4.Proj.projections.add(laea);\n  proj4.Proj.projections.add(aea);\n  proj4.Proj.projections.add(gnom);\n  proj4.Proj.projections.add(cea);\n  proj4.Proj.projections.add(eqc);\n  proj4.Proj.projections.add(poly);\n  proj4.Proj.projections.add(nzmg);\n  proj4.Proj.projections.add(mill);\n  proj4.Proj.projections.add(sinu);\n  proj4.Proj.projections.add(moll);\n  proj4.Proj.projections.add(eqdc);\n  proj4.Proj.projections.add(vandg);\n  proj4.Proj.projections.add(aeqd);\n  proj4.Proj.projections.add(ortho);\n  proj4.Proj.projections.add(geocent);\n  proj4.Proj.projections.add(qsc);\n}","import proj4 from './core';\nimport Proj from \"./Proj\";\nimport Point from \"./Point\";\nimport common from \"./common/toPoint\";\nimport defs from \"./defs\";\nimport transform from \"./transform\";\nimport mgrs from \"mgrs\";\nimport version from \"./version\";\nimport includedProjections from \"../projs\";\n\nproj4.defaultDatum = 'WGS84'; //default datum\nproj4.Proj = Proj;\nproj4.WGS84 = new proj4.Proj('WGS84');\nproj4.Point = Point;\nproj4.toPoint = common;\nproj4.defs = defs;\nproj4.transform = transform;\nproj4.mgrs = mgrs;\nproj4.version = version;\nincludedProjections(proj4);\nexport default proj4;\n","\nvar MapView = function(map, json, fixPaths) {\n    this.map = map;\n    //this.id = json[\"id\"] || null;\n    this.parse(json, fixPaths);\n};\n\n\nMapView.prototype.parse = function(json, fixPaths) {\n    //this.description = json['description'] || '';\n    //this.boundLayers = json[\"boundLayers\"] || [];\n    this.freeLayers = json['freeLayers'] || {};\n    this.surfaces = {};    \n    this.options = json['options'] || {};    \n\n    if (json['surfaces']) {\n        var surfaces = json['surfaces']; \n        if (Array.isArray(surfaces)) { //convert from old version\n            for (var i = 0, li = surfaces.length; i < li; i++) {\n                this.surfaces[surfaces[i]] = [];\n            }\n        } else {\n            this.surfaces = surfaces;            \n        }\n    }\n\n    if (!this.freeLayers || Array.isArray(this.freeLayers)) { //convert from old version\n        this.freeLayers = {};\n    } else {\n        this.freeLayers = JSON.parse(JSON.stringify(this.freeLayers));\n\n        if (fixPaths) {\n            for (var key in this.freeLayers) {\n                var layer = this.freeLayers[key];\n\n                if (typeof layer['style'] === 'string') {\n                    layer['style'] = this.processUrl(layer['style'], '');\n                }\n            }\n        }\n    }\n    \n    this.surfaces = JSON.parse(JSON.stringify(this.surfaces));\n    this.options = JSON.parse(JSON.stringify(this.options));\n};\n\n\nMapView.prototype.processUrl = function(url, fallback) {\n    if (!url) {\n        return fallback;\n    }\n\n    if (typeof url !== 'string') {\n        return url;\n    }\n\n    url = url.trim();\n\n    if (url.indexOf('://') != -1) { //absolute\n        return url;\n    } else if (url.indexOf('//') == 0) {  //absolute without schema\n        return this.map.url.baseUrlSchema + url;\n    } else if (url.indexOf('/') == 0) {  //absolute without host\n        return this.map.url.baseUrlOrigin + url;\n    } else {  //relative\n        return this.map.url.baseUrl + url; \n    }\n};\n\n\nMapView.prototype.getInfo = function() {\n    var view = {\n        //'description' : JSON.parse(JSON.stringify(this.description)),\n        'surfaces' : JSON.parse(JSON.stringify(this.surfaces)),\n        'freeLayers' : JSON.parse(JSON.stringify(this.freeLayers)),\n        'options' : JSON.parse(JSON.stringify(this.options)),\n    };\n\n    var renderer = this.map.renderer;\n\n    if (this.map.renderer.getSuperElevationState()) {\n        var se = this.map.renderer.getSuperElevation();\n\n        view['options'] = {\n            'superelevation' : [[se[0],se[2]],[se[1],se[3]]]\n        }\n    }\n\n    return view;\n};\n\n\nexport default MapView;\n\n","\nimport {utils as utils_} from '../../utils/utils';\n\n//get rid of compiler mess\nvar utils = utils_;\n\nvar GpuTexture = function(gpu, path, core, fileSize, direct, repeat, filter, keepImage, onLoaded, onError) {\n    this.gpu = gpu;\n    this.gl = gpu.gl;\n    this.texture = null;\n    this.framebuffer = null;\n    this.size = 0;\n    this.fileSize = fileSize; //used for stats\n    this.width = 0;\n    this.height = 0;\n    this.repeat = repeat || false;\n    this.filter = filter || 'linear';\n\n    this.image = null;\n    this.loaded = false;\n    this.trilinear = false;//true;\n    this.core = core;\n\n    if (path != null) {\n        this.load(path, onLoaded, onError, direct, keepImage);\n    }\n};\n\n//destructor\nGpuTexture.prototype.kill = function() {\n    this.gl.deleteTexture(this.texture);\n    \n    this.texture = null;\n};\n\n// Returns GPU RAM used, in bytes.\nGpuTexture.prototype.getSize = function() {\n    return this.size;\n};\n\nGpuTexture.prototype.createFromData = function(lx, ly, data, filter, repeat) {\n    var gl = this.gl;\n\n    this.texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n\n    if (repeat){\n        repeat = gl.REPEAT;\n        this.repeat = true;\n    } else {\n        repeat = gl.CLAMP_TO_EDGE;\n    }\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, repeat);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, repeat);\n    var mipmaps = false;\n\n    switch (filter) {\n    case 'linear':\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        break;\n    case 'trilinear':\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        mipmaps = true;\n        break;\n    default:\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        break;\n    }\n\n    gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);\n\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, lx, ly, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);\n\n    if (mipmaps) {\n        gl.generateMipmap(gl.TEXTURE_2D);\n    }\n\n    gl.bindTexture(gl.TEXTURE_2D, null);\n\n    this.width = lx;\n    this.height = ly;\n    this.size = lx * ly * 4;\n    this.loaded = true;\n};\n\nGpuTexture.prototype.createFromImage = function(image, filter, repeat, aniso) {\n    var gl = this.gl;\n\n    //filter = 'trilinear'; aniso = null; this.gpu.anisoLevel = 0;\n    var width = image.naturalWidth;\n    var height = image.naturalHeight;\n    var data = image;\n\n    this.texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n\n    if (repeat) {\n        repeat = gl.REPEAT;\n        this.repeat = true;\n    } else {\n        repeat = gl.CLAMP_TO_EDGE;\n    }\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, repeat);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, repeat);\n    var mipmaps = false;\n    this.filter = filter;\n\n    switch (filter) {\n    case 'linear':\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        break;\n    case 'trilinear':\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.LINEAR_MIPMAP_LINEAR);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.LINEAR);\n        mipmaps = true;\n        break;\n    default:\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n        gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n        break;\n    }\n\n    //resize image to nearest power of two\n    if ((this.repeat || mipmaps) && (!utils.isPowerOfTwo(width) || !utils.isPowerOfTwo(height))) {\n        width = utils.nearestPowerOfTwo(width);\n        height = utils.nearestPowerOfTwo(height);\n        var canvas = document.createElement('canvas');\n        canvas.width = width;\n        canvas.height = height;\n        var context = canvas.getContext('2d');\n        context.drawImage(image, 0, 0, width, height); \n        data = canvas;\n    }\n\n    var gpu = this.gpu;\n\n    if (gpu.anisoLevel) {\n        gl.texParameterf(gl.TEXTURE_2D, gpu.anisoExt.TEXTURE_MAX_ANISOTROPY_EXT, gpu.anisoLevel);\n    }\n\n    if (gpu.noTextures !== true) { //why is it here and not at the beginig of the code?\n        gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, gl.RGBA, gl.UNSIGNED_BYTE, data);\n\n        if (mipmaps) {\n            gl.generateMipmap(gl.TEXTURE_2D);\n        }\n    }\n\n    gl.bindTexture(gl.TEXTURE_2D, null);\n\n    this.width = width;\n    this.height = height;\n    this.size = width * height * 4;\n    this.loaded = true;\n};\n\nGpuTexture.prototype.load = function(path, onLoaded, onError, direct, keepImage) {\n    this.image = utils.loadImage(path, (function () {\n        if (this.core != null && this.core.killed) {\n            return;\n        }\n\n        this.createFromImage(this.image, this.filter, this.repeat);\n        if (!keepImage) {\n            this.image = null;\n        }\n\n        if (onLoaded) {\n            onLoaded();\n        } else {\n            if (this.core.map && this.core.map.markDirty) {\n                this.core.map.markDirty();\n            }\n        }\n\n    }).bind(this), (function () {\n\n        if (this.core != null && this.core.killed) {\n            return;\n        }\n\n        if (onError) {\n            onError();\n        }\n    }).bind(this),\n     \n     null, direct\n     \n     );\n\n};\n\n\nGpuTexture.prototype.createFramebufferFromData = function(lx, ly, data) {\n    var gl = this.gl;\n\n    var framebuffer = gl.createFramebuffer();\n    gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n    framebuffer.width = lx;\n    framebuffer.height = ly;\n\n    var texture = gl.createTexture();\n    gl.bindTexture(gl.TEXTURE_2D, texture);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_S, gl.CLAMP_TO_EDGE);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_WRAP_T, gl.CLAMP_TO_EDGE);\n\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MIN_FILTER, gl.NEAREST);\n    gl.texParameteri(gl.TEXTURE_2D, gl.TEXTURE_MAG_FILTER, gl.NEAREST);\n\n    gl.pixelStorei(gl.UNPACK_ALIGNMENT, 1);\n\n    gl.texImage2D(gl.TEXTURE_2D, 0, gl.RGBA, lx, ly, 0, gl.RGBA, gl.UNSIGNED_BYTE, data);\n\n\n\n    var renderbuffer = gl.createRenderbuffer();\n    gl.bindRenderbuffer(gl.RENDERBUFFER, renderbuffer);\n    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, lx, ly);\n\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, texture, 0);\n\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderbuffer);\n\n    this.width = lx;\n    this.height = ly;\n    this.size = lx * ly * 4;\n\n    this.texture = texture;\n    this.renderbuffer = renderbuffer;\n    this.framebuffer = framebuffer;\n\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n};\n\n\nGpuTexture.prototype.createFramebuffer = function(lx, ly) {\n    if (this.texture == null){\n        return;\n    }\n\n    var gl = this.gl;\n\n    var framebuffer = gl.createFramebuffer();\n    gl.bindFramebuffer(gl.FRAMEBUFFER, framebuffer);\n    framebuffer.width = lx;\n    framebuffer.height = ly;\n\n    gl.bindTexture(gl.TEXTURE_2D, this.texture);\n\n    var renderbuffer = gl.createRenderbuffer();\n    gl.bindRenderbuffer(gl.RENDERBUFFER, renderbuffer);\n    gl.renderbufferStorage(gl.RENDERBUFFER, gl.DEPTH_COMPONENT16, lx, ly);\n\n    gl.framebufferTexture2D(gl.FRAMEBUFFER, gl.COLOR_ATTACHMENT0, gl.TEXTURE_2D, this.texture, 0);\n    gl.framebufferRenderbuffer(gl.FRAMEBUFFER, gl.DEPTH_ATTACHMENT, gl.RENDERBUFFER, renderbuffer);\n\n    gl.bindTexture(gl.TEXTURE_2D, null);\n    gl.bindRenderbuffer(gl.RENDERBUFFER, null);\n    gl.bindFramebuffer(gl.FRAMEBUFFER, null);\n\n    this.framebuffer = framebuffer;\n    this.renderbuffer = renderbuffer;\n};\n\n\nGpuTexture.prototype.readFramebufferPixels = function(x, y, lx, ly, fastMode, data) {\n    if (this.texture == null) {\n        return;\n    }\n\n    this.gpu.bindTexture(this);\n\n    if (!fastMode) {\n        this.gpu.setFramebuffer(this);\n    }\n\n    var gl = this.gl;\n\n    // Read the contents of the framebuffer (data stores the pixel data)\n    if (!data) {\n        data = new Uint8Array(lx * ly * 4);        \n    }\n    gl.readPixels(x, y, lx, ly, gl.RGBA, gl.UNSIGNED_BYTE, data);\n\n    if (!fastMode) {\n        this.gpu.setFramebuffer(null);\n    }\n\n    return data;\n};\n\nexport default GpuTexture;\n\n\n","\nimport {vec3 as vec3_} from '../utils/matrix';\nimport GpuTexture_ from '../renderer/gpu/texture';\nimport {math as math_} from '../utils/math';\n\n//get rid of compiler mess\nvar vec3 = vec3_;\nvar GpuTexture = GpuTexture_;\nvar math = math_;\n\n var tileBorderTable = [\n    [-1, -1, 0, 0],\n    [0, -1, 0.5, 1], //\n    [1, -1, 1, 0],\n\n    [-1, 0, 0, 0.5],\n    [0, 0, 0.5, 0.5],\n    [1, 0, 1, 0.5],\n\n    [-1, 1, 0, 1],\n    [0, 1, 0.5, 0], //\n    [1, 1, 1, 1]\n];\n\nvar tileCornerTable = [\n    [0,1,3],\n    [2,1,5],\n    [6,3,7],\n    [8,7,5]\n];\n\n\nvar MapSurfaceTile = function(map, parent, id) {\n    this.map = map;\n    this.id = id;\n    this.parent = parent;\n    this.viewCounter = map.viewCounter;\n    this.drawCounter = 0;\n    this.childrenReadyCount = 0;\n    this.renderReady = false;\n    this.geodataCounter = 0;\n    this.gridRenderCounter = 0; //draw grid only once\n    this.texelSize = 1;\n    this.texelSize2 = 1;\n    this.distance = 1;\n    this.tiltAngle = 1;\n    this.seCounter = 0;\n\n    this.metanode = null;  //[metanode, cacheItem]\n    this.lastMetanode = null;\n    this.boundmetaresources = null; //link to bound layers metatile storage\n\n    this.surface = null; //surface or glue\n    this.surfaceMesh = null;\n    this.surfaceGeodata = null;     //probably only used in free layers\n    this.surfaceGeodataView = null; //probably only used in free layers\n    this.surfaceTextures = [];\n    this.resourceSurface = null; //surface directing to resources\n\n    this.virtual = false;\n    this.virtualReady = false;\n    this.virtualSurfaces = [];\n    \n    this.resetDrawCommands = false;\n    this.drawCommands = [[], [], []];\n\n    this.bounds = {};\n    this.boundLayers = {};\n    this.boundTextures = {};\n    this.updateBounds = true;\n\n    this.hmap = null;\n    this.heightMap = null;\n    this.drawCommands = [[], [], []];\n    this.imageryCredits = {};\n    this.glueImageryCredits = {};\n    this.mapdataCredits = {};\n    \n    this.resources = this.map.resourcesTree.findNode(id, true);   // link to resource tree\n    this.metaresources = this.map.resourcesTree.findAgregatedNode(id, 5, true); //link to meta resource tree\n    this.boundresources = this.map.resourcesTree.findAgregatedNode(id, 8, true); //link to meta resource tree\n    \n    this.children = [null, null, null, null];\n};\n\n\nMapSurfaceTile.prototype.kill = function() {\n    //kill children\n    for (var i = 0; i < 4; i++) {\n        if (this.children[i] != null) {\n            this.children[i].kill();\n        }\n    }\n/*\n    if (this.surfaceMesh != null) {\n        this.surfaceMesh.kill();\n    }\n\n    for (var key in this.surfaceTextures) {\n        if (this.surfaceTextures[key] != null) {\n            this.surfaceTextures[key].kill();\n        }\n    }\n\n    if (this.surfaceGeodata != null) {\n        this.surfaceGeodata.kill();\n    }\n\n    if (this.surfaceGeodataView != null) {\n        this.surfaceGeodataView.kill();\n    }\n\n    if (this.heightMap != null) {\n        this.heightMap.kill();\n    }\n\n    for (var key in this.boundTextures) {\n        if (this.boundTextures[key] != null) {\n            this.boundTextures[key].kill();\n        }\n    }\n*/\n    this.resources = null;\n    this.metaresources = null;\n    this.metanode = null;\n\n    this.surface = null;\n    this.surfaceMesh = null;\n    this.surfaceTextures = [];\n    this.surfaceGeodata = null;\n    this.surfaceGeodataView = null;\n    this.resourceSurface = null;\n\n    this.bounds = {};\n    this.boundLayers = {};\n    this.boundTextures = {};\n    this.updateBounds = true;\n\n    this.virtual = false;\n    this.virtualReady = false;\n    this.virtualSurfaces = [];\n\n    this.renderReady = false;\n    this.lastSurface = null;\n    this.lastState = null;\n    this.lastRenderState = null;\n        \n    this.hmap = null;\n    this.heightMap = null;\n    this.drawCommands = [[], [], []];\n    this.imageryCredits = {};\n    this.glueImageryCredits = {};\n    this.mapdataCredits = {};\n\n    this.verifyChildren = false;\n    this.children = [null, null, null, null];\n\n    var parent = this.parent;\n    this.parent = null;\n\n    if (parent != null) {\n        parent.removeChild(this);\n    }\n};\n\n\nMapSurfaceTile.prototype.validate = function() {\n    //is tile empty?\n    if (this.metaresources == null || !this.metaresources.getMetatile(this.surface, null, this)) {\n        //this.kill();\n    }\n};\n\n\nMapSurfaceTile.prototype.viewSwitched = function() {\n    //store last state for view switching\n    this.lastSurface = this.surface;\n    this.lastState = {\n        surfaceMesh : this.surfaceMesh,\n        surfaceTextures : this.surfaceTextures,\n        boundTextures : this.boundTextures,\n        surfaceGeodata : this.surfaceGeodata,\n        surfaceGeodataView : this.surfaceGeodataView,\n        resourceSurface : this.resourceSurface \n    };    \n\n    if (this.drawCommands[0].length > 0) {  // check only visible chanel\n        this.lastRenderState = {\n            drawCommands : this.drawCommands,\n            imageryCredits : this.imageryCredits,\n            mapdataCredits : this.mapdataCredits\n        };\n    } else {\n        this.lastRenderState = null;\n    }\n    \n    //zero surface related data    \n    this.verifyChildren = true;\n    this.renderReady = false;\n    this.lastMetanode = this.metanode;\n    this.metanode = null; //quick hack for switching virtual surfaeces //keep old value for smart switching\n\n    if (!this.map.config.mapSoftViewSwitch) {\n\n        if (this.metanode) {\n            this.metanode.border = null;\n            this.metanode.border2 = null;\n            this.metanode.border3 = null;\n            this.metanode.borderNodes = null;\n            this.metanode.borderReady = null;\n        }\n\n        this.lastState = null;\n        this.lastRenderState = null;\n        this.lastMetanode = null;\n        this.metanode = null;\n        this.gridPoints = null;\n    }\n\n    //this.lastMetanode = null;\n    //this.metanode = null;\n\n    for (var key in this.bounds) {\n        this.bounds[key] = {\n            sequence : [],\n            alpha : [],\n            transparent : false,\n            viewCoutner : 0\n        };\n    }\n\n    this.boundLayers = {};\n    this.boundTextures = {};\n    this.updateBounds = true;\n    this.transparentBounds = false;\n\n    this.surface = null;\n    this.surfaceMesh = null;\n    this.surfaceTextures = [];\n    this.surfaceGeodata = null;\n    this.surfaceGeodataView = null;\n    this.resourceSurface = null;\n    \n    this.virtual = false;\n    this.virtualReady = false;\n    this.virtualSurfaces = [];\n    this.virtualSurfacesUncomplete = false;\n    \n    this.drawCommands = [[], [], []];\n    this.imageryCredits = {};\n    this.glueImageryCredits = {};\n    this.mapdataCredits = {};\n};\n\n\nMapSurfaceTile.prototype.restoreLastState = function() {\n    if (!this.lastState) {\n        return;\n    }\n    this.surfaceMesh = this.lastState.surfaceMesh;\n    this.surfaceTextures = this.lastState.surfaceTextures; \n    this.boundTextures = this.lastState.boundTextures;\n    this.surfaceGeodata = this.lastState.surfaceGeodata;\n    this.surfaceGeodataView = this.lastState.surfaceGeodataView;\n    this.resourceSurface = this.lastState.resourceSurface; \n    this.lastSurface = null;\n    this.lastState = null;\n    this.lastResourceSurface = null;\n};\n\n\nMapSurfaceTile.prototype.addChild = function(index) {\n    if (this.children[index]) {\n        return;\n    }\n    \n    var id = this.id;\n    var childId = [id[0] + 1, id[1] << 1, id[2] << 1];\n\n    switch (index) {\n    case 1: childId[1]++; break;\n    case 2: childId[2]++; break;\n    case 3: childId[1]++; childId[2]++; break;\n    }\n\n    this.children[index] = new MapSurfaceTile(this.map, this, childId);\n};\n\n\nMapSurfaceTile.prototype.removeChildByIndex = function(index) {\n    if (this.children[index] != null) {\n        this.children[index].kill();\n        this.children[index] = null;\n    }\n    \n    //remove resrource node?\n};\n\n\nMapSurfaceTile.prototype.removeChild = function(tile) {\n    for (var i = 0; i < 4; i++) {\n        if (this.children[i] == tile) {\n            this.children[i].kill();\n            this.children[i] = null;\n        }\n    }\n};\n\n\nMapSurfaceTile.prototype.isMetanodeReady = function(tree, priority, preventLoad) {\n\n    //has map view changed?\n    if (this.map.viewCounter != this.viewCoutner) {\n        this.viewSwitched();\n        this.viewCoutner = this.map.viewCounter;\n        this.map.markDirty(); \n    }\n        \n    if (!preventLoad) {\n   \n        //provide surface for tile\n        if (this.virtualSurfacesUncomplete || (this.surface == null && this.virtualSurfaces.length == 0) ) { //|| this.virtualSurfacesUncomplete) {\n            this.checkSurface(tree, priority);\n        }\n   \n        //provide metanode for tile\n        if (this.metanode == null || this.lastMetanode) {\n            \n            if (!this.virtualSurfacesUncomplete) {\n                var ret = this.checkMetanode(tree, priority);\n                \n                if (!ret && !(this.metanode != null && this.lastMetanode)) { //metanode is not ready yet\n                    return false;\n                }\n            }\n            \n            /*if (this.lastMetanode) {\n                processFlag2 = true;\n            }*/\n        }\n        \n    }\n\n    if (this.metanode == null) { // || processFlag3) { //only for wrong data\n        return false;\n    }\n\n    this.metanode.metatile.used();\n\n    if (this.lastSurface && this.lastSurface == this.surface) {\n        this.lastSurface = null;\n        this.restoreLastState();\n        //return;\n    }\n\n    if (this.surface) {\n        if (this.surface.virtual) {\n            this.resourceSurface = this.surface.getSurface(this.metanode.sourceReference);\n            if (!this.resourceSurface) {\n                this.resourceSurface = this.surface;\n            }\n        } else {\n            this.resourceSurface = this.surface;\n        }\n    }\n\n    if (this.seCounter != this.map.renderer.seCounter) {\n        var renderer = this.map.renderer;\n        this.seCounter = renderer.seCounter; // InvalidStateError: An attempt was made to use an object that is not, or is no longer, usable\n        var node = this.metanode;\n\n        if (renderer.useSuperElevation) {\n            node.minZ = renderer.getSuperElevatedHeight(node.minZ2);\n            node.maxZ = renderer.getSuperElevatedHeight(node.maxZ2);\n        } else {\n            node.minZ = node.minZ2;\n            node.maxZ = node.maxZ2;\n        }\n\n        if (renderer.seCounter > 0) {\n            this.gridPoints = null;\n            node.border = null;\n            node.border2 = null;\n            node.border3 = null;\n            node.borderReady = false;\n     \n            node.generateCullingHelpers();\n        }\n    }\n\n    return true;\n};\n\n\nMapSurfaceTile.prototype.checkSurface = function(tree, priority) {\n    this.surface = null;\n    this.virtual = false;\n    this.virtualReady = false;\n    this.virtualSurfaces = [];\n    this.virtualSurfacesUncomplete = false;\n    \n    if (tree.freeLayerSurface) {  //free layer has only one surface\n        this.surface = tree.freeLayerSurface;\n        return; \n    }\n\n    var sequence = tree.surfaceSequence;\n\n    //multiple surfaces\n    //build virtual surfaces array\n    //find surfaces with content\n    for (var i = 0, li = sequence.length; i < li; i++) {\n        var surface = sequence[i][0];\n        var alien = sequence[i][1];\n\n        var res = surface.hasTile2(this.id);\n        if (res[0]) {\n            \n            //check if tile exist\n            if (this.id[0] > 0) { //surface.lodRange[0]) {\n                // removed for debug !!!!!\n                // ????????\n                var parent = this.parent;\n                if (parent) { \n                    \n                    if (parent.virtualSurfacesUncomplete) {\n                        this.virtualSurfacesUncomplete = true;\n                        this.virtualSurfaces = [];\n                        return;\n                    }\n                    \n                    var metatile = parent.metaresources.getMetatile(surface, null, this);\n                    if (metatile) {\n                        \n                        if (!metatile.isReady(priority)) {\n                            this.virtualSurfacesUncomplete = true;\n                            continue;\n                        }\n                        \n                        var node = metatile.getNode(parent.id);\n                        if (node) {\n                            if (!node.hasChildById(this.id)) {\n                                continue;\n                            }\n                        } else {\n                            continue;\n                        }\n                    } else {\n                        continue;\n                    }\n                }\n            }\n    \n            //store surface\n            this.virtualSurfaces.push([surface, alien]);        \n        }\n    }\n\n    if (this.virtualSurfaces.length > 1) {\n        this.virtual = true;\n    } else {\n        this.surface = (this.virtualSurfaces[0]) ? this.virtualSurfaces[0][0] : null;\n    }\n};\n\n\nMapSurfaceTile.prototype.checkMetanode = function(tree, priority) {\n    if (this.virtual) {\n        if (this.isVirtualMetanodeReady(tree, priority)) {\n            this.metanode = this.createVirtualMetanode(tree, priority);\n            this.lastMetanode = null;\n            this.map.markDirty();\n        } else {\n            return false;\n        }\n    }\n\n    var surface = this.surface;\n\n    if (surface == null) {\n        return false;\n    }\n\n    var metatile = this.metaresources.getMetatile(surface, true, this);\n\n    if (metatile.isReady(priority)) {\n\n        if (!this.virtual) {\n            this.metanode = metatile.getNode(this.id);\n            this.lastMetanode = null;\n            this.map.markDirty(); \n        }\n\n        if (this.metanode != null) {\n            this.metanode.tile = this; //used only for validate\n            this.lastMetanode = null;\n            this.map.markDirty(); \n\n            for (var i = 0; i < 4; i++) {\n                if (this.metanode.hasChild(i)) {\n                    this.addChild(i);\n                } else {\n                    this.removeChildByIndex(i);\n                }\n            }\n        }\n\n    } else {\n        return false;\n    }\n    \n    return true;\n};\n\n\nMapSurfaceTile.prototype.isVirtualMetanodeReady = function(tree, priority) {\n    var surfaces = this.virtualSurfaces;\n    var readyCount = 0;\n\n    for (var i = 0, li = surfaces.length; i < li; i++) {\n        var surface = surfaces[i][0];\n        var metatile = this.metaresources.getMetatile(surface, true, this);\n\n        if (metatile.isReady(priority)) {\n            readyCount++;\n        }\n    }\n    \n    if (readyCount == li) {\n        return true;        \n    } else {\n        return false;\n    }\n};\n\n\nMapSurfaceTile.prototype.createVirtualMetanode = function(tree, priority) {\n    var surfaces = this.virtualSurfaces;\n    var node = null, i, li, surface, metatile, metanode;\n\n    //get top most existing surface\n    for (i = 0, li = surfaces.length; i < li; i++) {\n        surface = surfaces[i][0];\n        var alien = surfaces[i][1];\n        metatile = this.metaresources.getMetatile(surface, null, this);\n\n        if (metatile.isReady(priority)) {\n            metanode = metatile.getNode(this.id);\n\n            if (metanode != null) {\n                if (alien != metanode.alien) {\n                    continue;\n                }\n\n                //does metanode have surface reference?\n                //internalTextureCount is reference to surface\n                if (!alien && surface.glue && !metanode.hasGeometry() &&\n                    metanode.internalTextureCount > 0) {\n                    \n                    var desiredSurfaceIndex = metanode.internalTextureCount - 1;\n                    desiredSurfaceIndex = this.map.getSurface(surface.id[desiredSurfaceIndex]).viewSurfaceIndex;\n                    \n                    var jump = false; \n                        \n                    for (var j = i; j < li; j++) {\n                        if (surfaces[j].viewSurfaceIndex <= desiredSurfaceIndex) {\n                            jump = (j > i);\n                            i = j - 1;\n                            break;\n                        }\n                    }\n                    \n                    if (jump) {\n                        continue;\n                    }                         \n                }\n                \n                if (metanode.hasGeometry()) {\n                    node = metanode.clone();\n                    this.surface = surface;\n                    break;\n                }\n            }\n        }\n    }\n\n    //extend bbox, credits and children flags by other surfaces\n    for (i = 0, li = surfaces.length; i < li; i++) {\n        surface = surfaces[i][0];\n        metatile = this.metaresources.getMetatile(surface, null, this);\n\n        if (metatile.isReady(priority)) {\n            metanode = metatile.getNode(this.id);\n\n            if (metanode != null) {\n                //does metanode have surface reference?\n                //internalTextureCount is reference to surface\n                /*\n                if (surface.glue && !metanode.hasGeometry() &&\n                    metanode.internalTextureCount > 0) {\n                    i = this.map.surfaceSequenceIndices[metanode.internalTextureCount - 1] - 1;\n                    continue;\n                }*/\n\n                if (!node) { //just in case all surfaces are without geometry\n                    node = metanode.clone();\n                    this.surface = surface;\n                } else {\n                    node.flags |= metanode.flags & ((15)<<4); \n\n                    /*\n                    for (var j = 0, lj = metanode.credits.length; j <lj; j++) {\n                        if (node.credits.indexOf(metanode.credits[j]) == -1) {\n                            node.credits.push(metanode.credits[j]);\n                        } \n                    }*/\n                   \n                    if (metatile.useVersion < 4) {\n                        // removed for debug !!!!!\n                        node.bbox.min[0] = Math.min(node.bbox.min[0], metanode.bbox.min[0]); \n                        node.bbox.min[1] = Math.min(node.bbox.min[1], metanode.bbox.min[1]); \n                        node.bbox.min[2] = Math.min(node.bbox.min[2], metanode.bbox.min[2]); \n                        node.bbox.max[0] = Math.max(node.bbox.max[0], metanode.bbox.max[0]); \n                        node.bbox.max[1] = Math.max(node.bbox.max[1], metanode.bbox.max[1]); \n                        node.bbox.max[2] = Math.max(node.bbox.max[2], metanode.bbox.max[2]);\n                    }\n                }\n            }\n        }\n    }\n    \n    if (node) {\n        node.generateCullingHelpers(true);\n    }\n    \n    return node;\n};\n\n\nMapSurfaceTile.prototype.bboxVisible = function(id, bbox, cameraPos, node) {\n    var map = this.map;\n    var camera = map.camera;\n    if (id[0] < map.measure.minDivisionNodeDepth) {\n        return true;\n    }\n    \n    var skipGeoTest = map.config.mapDisableCulling;\n    if (!skipGeoTest && map.isGeocent) {\n        if (node) {\n            //if (true) {  //version with perspektive\n            var p2 = node.diskPos;\n            var p1 = camera.position;\n            var rayVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n            var distance = vec3.normalize4(rayVec) * camera.distanceFactor;\n                //vec3.normalize(camVec);\n                \n            var a = vec3.dot(rayVec, node.diskNormal);\n            //} else { //version without perspektive\n            //    var a = vec3.dot(camera.vector, node.diskNormal);\n            //}\n            this.tiltAngle = a;\n            \n            if (distance > 150000 && a > node.diskAngle) {\n                return false;\n            }\n        }\n    }\n\n    if (node.metatile.useVersion >= 4) {\n        return camera.camera.pointsVisible(node.bbox2, cameraPos);\n    } else {\n        if (!(map.isGeocent && (map.config.mapPreciseBBoxTest)) || id[0] < 4) {\n            return camera.camera.bboxVisible(bbox, cameraPos);\n        } else {\n            return camera.camera.pointsVisible(node.bbox2, cameraPos);\n        }\n    }\n};\n\nMapSurfaceTile.prototype.insideCone = function(coneVec, angle, node) {\n\n    if (this.map.isGeocent) { // && node.diskPos && node.diskNormal) {\n        var a = Math.acos(vec3.dot(coneVec, node.diskNormal));\n\n        return (a < angle + node.diskAngle2A);\n    }\n\n    return false;\n};\n\n\nMapSurfaceTile.prototype.getPixelSize = function(bbox, screenPixelSize, cameraPos, worldPos, returnDistance) {\n    var min = bbox.min;\n    var max = bbox.max;\n    var tilePos1x = min[0] - cameraPos[0];\n    var tilePos1y = min[1] - cameraPos[1];\n    var tilePos2x = max[0] - cameraPos[0];\n    var tilePos2y = min[1] - cameraPos[1];\n    var tilePos3x = max[0] - cameraPos[0];\n    var tilePos3y = max[1] - cameraPos[1];\n    var tilePos4x = min[0] - cameraPos[0];\n    var tilePos4y = max[1] - cameraPos[1];\n    var h1 = min[2] - cameraPos[2];\n    var h2 = max[2] - cameraPos[2];\n    \n    //camera inside bbox\n    if (cameraPos[0] > min[0] && cameraPos[0] < max[0] &&\n        cameraPos[1] > min[1] && cameraPos[1] < max[1] &&\n        cameraPos[2] > min[2] && cameraPos[2] < max[2]) {\n\n        if (returnDistance) {\n            return [Number.POSITIVE_INFINITY, 0.1];\n        }\n    \n        return Number.POSITIVE_INFINITY;\n    }\n\n    var factor = 0;\n    var camera = this.map.camera.camera;\n\n    //find bbox sector\n    if (0 < tilePos1y) { //top row - zero means camera position in y\n        if (0 < tilePos1x) { // left top corner\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos1x, tilePos1y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos1x, tilePos1y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos1x, tilePos1y, (h1 + h2)*0.5], returnDistance);\n            }\n        } else if (0 > tilePos2x) { // right top corner\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos2x, tilePos2y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos2x, tilePos2y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos2x, tilePos2y, (h1 + h2)*0.5], returnDistance);\n            }\n        } else { //top side\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, tilePos2y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, tilePos2y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, tilePos2y, (h1 + h2)*0.5], returnDistance);\n            }\n        }\n    } else if (0 > tilePos4y) { //bottom row\n        if (0 < tilePos4x) { // left bottom corner\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos4x, tilePos4y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos4x, tilePos4y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos4x, tilePos4y, (h1 + h2)*0.5], returnDistance);\n            }\n        } else if (0 > tilePos3x) { // right bottom corner\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos3x, tilePos3y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos3x, tilePos3y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos3x, tilePos3y, (h1 + h2)*0.5], returnDistance);\n            }\n        } else { //bottom side\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([(tilePos4x + tilePos3x)*0.5, tilePos3y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([(tilePos4x + tilePos3x)*0.5, tilePos3y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([(tilePos4x + tilePos3x)*0.5, tilePos3y, (h1 + h2)*0.5], returnDistance);\n            }\n        }\n    } else { //middle row\n        if (0 < tilePos4x) { // left side\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos1x, (tilePos2y + tilePos3y)*0.5, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos1x, (tilePos2y + tilePos3y)*0.5, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos1x, (tilePos2y + tilePos3y)*0.5, (h1 + h2)*0.5], returnDistance);\n            }\n        } else if (0 > tilePos3x) { // right side\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos2x, (tilePos2y + tilePos3y)*0.5, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos2x, (tilePos2y + tilePos3y)*0.5, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos2x, (tilePos2y + tilePos3y)*0.5, (h1 + h2)*0.5], returnDistance);\n            }\n        } else { //center\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, (tilePos2y + tilePos3y)*0.5, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, (tilePos2y + tilePos3y)*0.5, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, (tilePos2y + tilePos3y)*0.5, (h1 + h2)*0.5], returnDistance);\n            }\n        }\n    }\n\n    //console.log(\"new: \" + (factor * screenPixelSize) + \" old:\" + this.tilePixelSize2(node) );\n\n    if (returnDistance) {\n        return [(factor[0] * screenPixelSize), factor[1]];\n    }\n\n    return (factor * screenPixelSize);\n};\n\n\nMapSurfaceTile.prototype.getPixelSize3Old = function(node, screenPixelSize, factor) {\n    var camera = this.map.camera;\n    var d = (camera.geocentDistance*factor) - node.diskDistance;\n    if (d < 0) {\n        d = -d;\n        //return [Number.POSITIVE_INFINITY, 0.1];\n    } \n\n    var a = vec3.dot(camera.geocentNormal, node.diskNormal);\n    \n    if (a < node.diskAngle2) {\n        var a2 = Math.acos(a); \n        var a3 = Math.acos(node.diskAngle2);\n        a2 = a2 - a3; \n\n        var l1 = Math.tan(a2) * node.diskDistance;\n        d = Math.sqrt(l1*l1 + d*d);\n    }\n\n    factor = camera.camera.scaleFactor2(d);\n    return [factor * screenPixelSize, d];\n};\n\n\nMapSurfaceTile.prototype.getPixelSize3 = function(node, screenPixelSize) {\n    //if (this.map.drawIndices) {\n      //  return this.getPixelSize3Old(node, screenPixelSize, factor);\n    //}\n    var camera = this.map.camera;\n    var cameraDistance = camera.geocentDistance;// * factor;\n\n    var a = vec3.dot(camera.geocentNormal, node.diskNormal); //get angle between tile normal and cameraGeocentNormal\n    var d = cameraDistance - (node.diskDistance + (node.maxZ - node.minZ)), d2; //vertical distance from top bbox level\n\n    if (a < node.diskAngle2) { //is camera inside tile conus?\n        \n        //get horizontal distance\n        var a2 = Math.acos(a); \n        var a3 = node.diskAngle2A;\n        a2 = a2 - a3; \n        var l1 = Math.tan(a2) * node.diskDistance;// * factor;\n\n        if (d < 0) { //is camera is belown top bbox level?\n            d2 = cameraDistance - node.diskDistance;\n            if (d2 < 0) { //is camera is belown bottom bbox level?\n                d = -d2;\n                d = Math.sqrt(l1*l1 + d*d);\n            } else { //is camera inside bbox\n                d = l1;\n            }\n        } else {\n            d = Math.sqrt(l1*l1 + d*d);\n        }\n\n    } else {\n        if (d < 0) { //is camera is belown top bbox level?\n            d2 = cameraDistance - node.diskDistance;\n            if (d2 < 0) { //is camera is belown bottom bbox level?\n                d = -d2;\n            } else { //is camera inside bbox\n                return [Number.POSITIVE_INFINITY, 0.1];\n            }\n        } \n    }\n\n    return [camera.camera.scaleFactor2(d) * screenPixelSize, d];\n};\n\n/*\n\nMapSurfaceTile.prototype.getPixelSize22 = function(bbox, screenPixelSize, cameraPos, worldPos, returnDistance) {\n    var min = bbox.min;\n    var max = bbox.max;\n    var p1 = bbox.center();\n    bbox.updateMaxSize();\n    var d = bbox.maxSize * 0.5; \n    \n    var dd = [cameraPos[0]-p1[0],\n               cameraPos[1]-p1[1],\n               cameraPos[2]-p1[2]]; \n\n    var d2 = vec3.length(dd) - (bbox.maxSize * 0.5);\n\n    var factor = this.camera.scaleFactor2(d2);\n\n    if (returnDistance) {\n        return [(factor[0] * screenPixelSize), factor[1]];\n    }\n\n    return (factor * screenPixelSize);\n};\n*/\n\nMapSurfaceTile.prototype.updateTexelSize = function() {\n    var pixelSize, factor, v, p;\n    var map = this.map;\n    var draw = map.draw;\n    var camera = map.camera;\n    var texelSizeFit = draw.texelSizeFit;\n    var node = this.metanode;\n    var cameraPos = map.camera.position;\n    var preciseDistance = (map.isGeocent && (map.config.mapPreciseDistanceTest || node.metatile.useVersion >= 4));  \n\n    if (node.hasGeometry()) {\n        var screenPixelSize = Number.POSITIVE_INFINITY;\n\n        if (node.usedTexelSize()) {\n            screenPixelSize = draw.ndcToScreenPixel * node.pixelSize;\n        } else if (node.usedDisplaySize()) {\n            screenPixelSize = draw.ndcToScreenPixel * (node.bbox.maxSize / node.displaySize);\n        }\n\n        if (camera.camera.ortho) {\n            var height = camera.camera.getViewHeight();\n            pixelSize = [(screenPixelSize*2.0) / height, height];\n        } else {\n            \n            if (node.usedDisplaySize()) { \n               \n                if (!preciseDistance) {\n                    screenPixelSize = draw.ndcToScreenPixel * (node.bbox.maxSize / 256);\n\n                    factor = (node.displaySize / 256) * camera.distance;\n                    //var factor = (256 / 256) * this.map.cameraDistance;\n                    \n                    v = camera.vector; //move camera away hack\n                    p = [cameraPos[0] - v[0] * factor, cameraPos[1] - v[1] * factor, cameraPos[2] - v[2] * factor];\n\n                    pixelSize = this.getPixelSize(node.bbox, screenPixelSize, p, p, true);\n                } else {\n                    if (draw.isGeocent) {\n                        //screenPixelSize = draw.ndcToScreenPixel * ((node.diskAngle2A * draw.planetRadius * 2 * 0.70710678118) / 256) * (256 / node.displaySize);\n                        screenPixelSize = draw.ndcToScreenPixel * ((node.diskAngle2A * draw.planetRadius * 1.41421356236) / node.displaySize);\n                    } else {\n                        //screenPixelSize = draw.ndcToScreenPixel * (node.bbox.maxSize / 256) * (256 / node.displaySize);\n                        screenPixelSize = draw.ndcToScreenPixel * (node.bbox.maxSize / node.displaySize);\n                    }\n\n                    pixelSize = this.getPixelSize3(node, screenPixelSize);\n                }\n            } else {\n                \n                if (!preciseDistance && texelSizeFit > 1.1) {\n                    screenPixelSize = draw.ndcToScreenPixel * node.pixelSize * (texelSizeFit / 1.1);\n                    factor = (texelSizeFit / 1.1) * camera.distance;\n                    \n                    v = camera.vector; //move camera away hack\n                    p = [cameraPos[0] - v[0] * factor, cameraPos[1] - v[1] * factor, cameraPos[2] - v[2] * factor];\n                    \n                    pixelSize = this.getPixelSize(node.bbox, screenPixelSize, p, p, true);\n                } else {\n                    if (preciseDistance) {\n                        pixelSize = this.getPixelSize3(node, screenPixelSize);\n                    } else {\n                        pixelSize = this.getPixelSize(node.bbox, screenPixelSize, cameraPos, cameraPos, true);\n                    }\n                }\n            }\n        }\n    } else {\n        if (preciseDistance) {\n            pixelSize = this.getPixelSize3(node, 1, 1);\n        } else {\n            pixelSize = this.getPixelSize(node.bbox, 1, cameraPos, cameraPos, true);\n        }\n\n        //pixelSize = this.getPixelSize(node.bbox, 1, cameraPos, cameraPos, true);\n        pixelSize[0] = Number.POSITIVE_INFINITY;\n    }\n\n    this.texelSize = pixelSize[0];\n    this.distance = pixelSize[1];\n\n    //degrade horizont\n    if (!map.config.mapDegradeHorizon || draw.degradeHorizonFactor < 1.0) {\n        return;\n    }\n\n    var degradeHorizon = map.config.mapDegradeHorizonParams;\n    var degradeFadeStart = degradeHorizon[1];\n    var degradeFadeEnd = degradeHorizon[2];\n\n    //reduce degrade factor by tilt\n    var degradeFactor = draw.degradeHorizonFactor * draw.degradeHorizonTiltFactor; \n    var distance = this.distance * camera.distanceFactor;\n\n    //apply degrade factor smoothly from specified tile distance\n    if (distance < degradeFadeStart) {\n        degradeFactor = 1.0;\n    } else if (distance > degradeFadeStart && distance < degradeFadeEnd) {\n        degradeFactor = 1.0 + (degradeFactor-1.0) * ((distance - degradeFadeStart) / (degradeFadeEnd - degradeFadeStart));\n    }\n\n    degradeFactor = Math.max(degradeFactor, 1.0);\n\n    //reduce degrade factor by observed distance\n    var observerDistance = camera.perceivedDistance;\n    var distanceFade = degradeHorizon[3];\n\n    if (observerDistance > distanceFade) {\n        degradeFactor = 1.0;\n    } else if (observerDistance < distanceFade && degradeFactor > 1.0) {\n        degradeFactor = 1.0 + ((degradeFactor - 1.0) * (1.0-(observerDistance / distanceFade)));\n    }\n\n    //console.log(\"degrade: \" + degradeFactor);\n\n    this.texelSize /= degradeFactor;\n};\n\n\nMapSurfaceTile.prototype.drawGrid = function(cameraPos, divNode, angle, onlySetBorderData, subdiv) {\n    /* if (!(subdiv || onlySetBorderData)) {\n        if (this.gridRenderCounter != this.map.draw.drawCounter) {\n            this.gridRenderCounter = this.map.draw.drawCounter;\n        } else {\n            return; //prevent rendering same grid more then on time\n        }\n    } */\n\n    if ((this.texelSize == Number.POSITIVE_INFINITY || this.texelSize > 4.4) && this.metanode && this.metanode.hasChildren()) {\n        return;\n    }\n    \n    if (!this.metanode) {\n        return;\n    }\n\n    var map = this.map, node, ll, ur, res;\n\n    if (map.draw.gridSkipped) {\n        return;\n    }\n\n\n    if (divNode) {\n        node = divNode[0]; \n        ll = divNode[1][0];\n        ur = divNode[1][1];\n    } else {\n        res = map.measure.getSpatialDivisionNodeAndExtents(this.id);\n        node = res[0]; \n        ll = res[1][0];\n        ur = res[1][1];\n    }\n   \n    var middle = [(ur[0] + ll[0])* 0.5, (ur[1] + ll[1])* 0.5];\n\n    var hasPoles = map.referenceFrame.hasPoles;\n\n    angle = angle || this.metanode.diskAngle2;\n    \n    if ((hasPoles && !node.isPole) &&  Math.acos(angle) > Math.PI*0.1) {\n        angle = Math.cos(Math.acos(angle) * 0.5); \n        \n        this.drawGrid(cameraPos, [node, [ [ll[0], ll[1]],  [middle[0], middle[1]] ] ], angle, false, true);\n        this.drawGrid(cameraPos, [node, [ [middle[0], ll[1]],  [ur[0], middle[1]] ] ], angle, false, true);\n\n        this.drawGrid(cameraPos, [node, [ [ll[0], middle[1]],  [middle[0], ur[1]] ] ], angle, false, true);\n        this.drawGrid(cameraPos, [node, [ [middle[0], middle[1]],  [ur[0], ur[1]] ] ], angle, false, true);\n       \n        return;\n    }\n     \n    var desiredSamplesPerViewExtent = 5;\n    var nodeExtent = node.extents.ur[1] - node.extents.ll[1];\n    var viewExtent = this.distance ;//* 0.1;\n    var lod = Math.log((desiredSamplesPerViewExtent * nodeExtent) / viewExtent) / map.log2;\n    lod = Math.max(0,lod - 8 + node.id[0]);\n   \n    var h, factor, prog, draw = map.draw; \n\n    var sx = cameraPos[0];\n    var sx = cameraPos[0];\n    var sy = cameraPos[1];\n    var sz = cameraPos[2];\n    var buffer = draw.planeBuffer;\n    var flatGrid = draw.gridFlat;\n    var joinGrids = draw.gridGlues; //this.map.draw.debug.drawFog;\n    var gridPoints = this.gridPoints;\n    var useSurrogatez = map.config.mapGridSurrogatez;\n\n    if (!gridPoints) {\n\n        h = useSurrogatez ? this.metanode.surrogatez : this.metanode.minZ;\n        var n1 = node.getPhysicalCoords([ur[0], ur[1], h], true);\n        var n2 = node.getPhysicalCoords([ur[0], ll[1], h], true);\n        var n3 = node.getPhysicalCoords([ll[0], ll[1], h], true);\n        var n4 = node.getPhysicalCoords([ll[0], ur[1], h], true);\n        var mtop = node.getPhysicalCoords([middle[0], ur[1], h], true);\n        var mbottom = node.getPhysicalCoords([middle[0], ll[1], h], true);\n        var mleft = node.getPhysicalCoords([ll[0], middle[1], h], true);\n        var mright = node.getPhysicalCoords([ur[0], middle[1], h], true);\n\n        middle[2] = h;\n        middle = node.getPhysicalCoords(middle, true);\n\n        if (!divNode) {\n\n            var gridPoints = [\n                n4[0], n4[1], n4[2],\n                mtop[0], mtop[1], mtop[2],\n                n1[0], n1[1], n1[2],\n\n                mleft[0], mleft[1], mleft[2],\n                middle[0], middle[1], middle[2],\n                mright[0], mright[1], mright[2],\n                \n                n3[0], n3[1], n3[2],\n                mbottom[0], mbottom[1], mbottom[2],\n                n2[0], n2[1], n2[2]\n            ];\n\n            this.gridPoints = gridPoints;\n\n        } else {\n            buffer[0] = n4[0] - sx;\n            buffer[1] = n4[1] - sy;\n            buffer[2] = n4[2] - sz;\n            \n            buffer[3] = mtop[0] - sx;\n            buffer[4] = mtop[1] - sy;\n            buffer[5] = mtop[2] - sz;\n\n            buffer[6] = n1[0] - sx;\n            buffer[7] = n1[1] - sy;\n            buffer[8] = n1[2] - sz;\n\n            buffer[9] = mleft[0] - sx;\n            buffer[10] = mleft[1] - sy;\n            buffer[11] = mleft[2] - sz;\n                    \n            buffer[12] = middle[0] - sx;\n            buffer[13] = middle[1] - sy;\n            buffer[14] = middle[2] - sz;\n                    \n            buffer[15] = mright[0] - sx;\n            buffer[16] = mright[1] - sy;\n            buffer[17] = mright[2] - sz;\n                \n            buffer[18] = n3[0] - sx;\n            buffer[19] = n3[1] - sy;\n            buffer[20] = n3[2] - sz;\n            \n            buffer[21] = mbottom[0] - sx;\n            buffer[22] = mbottom[1] - sy;\n            buffer[23] = mbottom[2] - sz;\n            \n            buffer[24] = n2[0] - sx;\n            buffer[25] = n2[1] - sy;\n            buffer[26] = n2[2] - sz;\n        }\n     }\n\n\n    if (!flatGrid) {\n\n        var mnode = this.metanode; \n           \n        var border = mnode.border, borderNodes = mnode.borderNodes;\n        var i, li, n, tree = map.tree, id = this.id;\n        \n        if (!border) {\n            mnode.border = new Array(9);\n            mnode.borderNodes = new Array(9);\n            border = mnode.border, borderNodes = mnode.borderNodes;\n            border[4] = useSurrogatez ? mnode.surrogatez : mnode.minZ;\n        }\n        \n\n        var borderTable = tileBorderTable;\n        var skip = false;\n\n        if (!mnode.borderReady) {\n            \n            for (i = 0; i < 9; i++) {\n                if (i != 4 && !borderNodes[i]) {\n                    n = tree.getNodeById([id[0], id[1] + borderTable[i][0], id[2] + borderTable[i][1]], true);\n\n                    if (n) {\n                        borderNodes[i] = n;\n                        border[i] = (useSurrogatez ? n.surrogatez : n.minZ);\n                    } else {\n                        border[i] = border[4];\n                        skip = true;\n                    }\n                }\n            }\n           \n        }\n\n        var border2 = mnode.border2;\n        h = useSurrogatez ? mnode.surrogatez : mnode.minZ\n\n        if (!border2 || !mnode.borderReady) {\n            border2 = [\n                ((border[0] + border[1] + border[3] + border[4]) * 0.25) - h, \n                ((border[1] + border[4]) * 0.5) - h,\n                ((border[2] + border[1] + border[5] + border[4]) * 0.25) - h,\n\n                ((border[3] + border[4]) * 0.5) - h,\n                border[4] - h,\n                ((border[5] + border[4]) * 0.5) - h,\n\n                ((border[6] + border[7] + border[3] + border[4]) * 0.25) - h,\n                ((border[7] + border[4]) * 0.5) - h,\n                ((border[8] + border[7] + border[5] + border[4]) * 0.25) - h\n            ];\n\n            mnode.border2 = border2;\n        }\n\n        if (!skip) {\n            mnode.borderReady = true;\n        }\n\n        if (onlySetBorderData) {\n            return;\n        }\n\n        if (joinGrids) {\n            var cornerTable = tileCornerTable;\n            var nodeTable = this.nodeTable;\n\n            if (!nodeTable) {\n                nodeTable = new Array(9);\n                this.nodeTable = nodeTable;\n            }\n\n            //get bodrer nodes\n            for (i = 0, li = borderTable.length; i < li; i++) {\n                if (i != 4) {\n                    nodeTable[i] = tree.getRenderedNodeById([id[0], id[1] + borderTable[i][0], id[2] + borderTable[i][1]], draw.drawCounter);\n                }\n            }\n\n            var border3 = mnode.border3;\n\n            if (!border3) {\n                border3 = new Array(9);\n                mnode.border3 = border3;\n            }\n\n            //solve corners\n            for (i = 0, li = cornerTable.length; i < li; i++) {\n                var lowestNode = nodeTable[cornerTable[i][0]];\n\n                for (var j = 1; j < 3; j++) {\n                    n = nodeTable[cornerTable[i][j]];\n\n                    if (n) {\n                        if (lowestNode) {\n                            if (n.id[0] < lowestNode.id[0]) {\n                                lowestNode = n;\n                            } \n                        } else {\n                            lowestNode = n;\n                        }\n                    }\n                }\n\n                nodeTable[cornerTable[i][0]] = lowestNode;\n            }\n\n            for (i = 0, li = borderTable.length; i < li; i++) {\n                n = nodeTable[i];\n\n                if (i != 4 && (n && n.id[0] < id[0])) {\n                    var bcoords;\n\n                    switch(i) {\n                        case 0:  bcoords = [mnode.llx, mnode.lly]; break;\n                        case 1:  bcoords = [(mnode.urx+mnode.llx)*0.5, mnode.lly]; break;\n                        case 2:  bcoords = [mnode.urx, mnode.lly]; break;\n                        \n                        case 3:  bcoords = [mnode.llx, (mnode.ury+mnode.lly)*0.5]; break;\n                        case 5:  bcoords = [mnode.urx, (mnode.ury+mnode.lly)*0.5]; break;\n\n                        case 6:  bcoords = [mnode.llx, mnode.ury]; break;\n                        case 7:  bcoords = [(mnode.urx+mnode.llx)*0.5, mnode.ury]; break;\n                        case 8:  bcoords = [mnode.urx, mnode.ury]; break;\n                    }\n\n                    if (!n.border2) {\n                        n.tile.drawGrid(cameraPos, divNode, angle, true);\n                    }\n\n                    if (n.border2) {\n                        mnode.border3[i] = (n.getGridHeight(bcoords, n.border2, 3) + (useSurrogatez ? n.surrogatez : n.minZ))  - h; \n                    } else {\n                        border2[i];\n                    }\n                } else {\n                    mnode.border3[i] = border2[i];\n                }\n            }\n        }                     \n    }\n\n    var renderer = map.renderer;\n    var mv = renderer.camera.getModelviewMatrix();\n    var proj = renderer.camera.getProjectionMatrix();\n\n    if (gridPoints) {\n        buffer[0] = gridPoints[0] - sx;\n        buffer[1] = gridPoints[1] - sy;\n        buffer[2] = gridPoints[2] - sz;\n        \n        buffer[3] = gridPoints[3] - sx;\n        buffer[4] = gridPoints[4] - sy;\n        buffer[5] = gridPoints[5] - sz;\n\n        buffer[6] = gridPoints[6] - sx;\n        buffer[7] = gridPoints[7] - sy;\n        buffer[8] = gridPoints[8] - sz;\n\n        buffer[9] = gridPoints[9] - sx;\n        buffer[10] = gridPoints[10] - sy;\n        buffer[11] = gridPoints[11] - sz;\n                \n        buffer[12] = gridPoints[12] - sx;\n        buffer[13] = gridPoints[13] - sy;\n        buffer[14] = gridPoints[14] - sz;\n                \n        buffer[15] = gridPoints[15] - sx;\n        buffer[16] = gridPoints[16] - sy;\n        buffer[17] = gridPoints[17] - sz;\n            \n        buffer[18] = gridPoints[18] - sx;\n        buffer[19] = gridPoints[19] - sy;\n        buffer[20] = gridPoints[20] - sz;\n        \n        buffer[21] = gridPoints[21] - sx;\n        buffer[22] = gridPoints[22] - sy;\n        buffer[23] = gridPoints[23] - sz;\n        \n        buffer[24] = gridPoints[24] - sx;\n        buffer[25] = gridPoints[25] - sy;\n        buffer[26] = gridPoints[26] - sz;\n    }\n\n    if (hasPoles && !map.poleRadius && node.id[0] == 1 && !node.isPole) {\n        var p = node.getPhysicalCoords([node.extents.ur[0], node.extents.ur[1], 0]);\n        map.poleRadius = Math.sqrt(p[0]*p[0]+p[1]*p[1]); \n        map.poleRadiusFactor = 8 * Math.pow(2.0, 552058 / map.poleRadius); \n    }\n\n    factor = 1;\n\n    var useTexture = (map.config.mapGridTextureLayer != '');\n\n    if (useTexture) {\n        if (!this.gridTexture) {\n\n            var layer = map.boundLayers[map.config.mapGridTextureLayer];\n            var sourceTile = this;\n\n            if (!layer || sourceTile < layer.lodRange[0]) {\n                useTexture = false;\n            } else {\n                var sourceLod = math.clamp(sourceTile.id[0] - map.config.mapGridTextureLevel, layer.lodRange[0], layer.lodRange[3]);\n\n                while (sourceTile.id[0] > sourceLod) {\n                    sourceTile = sourceTile.parent;\n                }\n\n                //(path, type, extraBound, extraInfo, tile, internal)\n                this.gridTexture = this.resources.getTexture(\"gmap#\"+map.config.mapGridTextureLayer, null, {sourceTile: sourceTile, layer:layer, tile: this }, null, null, null);\n                //this.gridTexture.isReady(false, 0, false);\n            }\n\n        }\n\n        if (useTexture && !this.gridTexture.isReady(false, 0, false)) {  //TODO: set params with max priority\n            useTexture = false;       \n        }     \n    }\n\n    var hitmapRender = renderer.onlyDepth;\n\n    if (hasPoles && node.isPole) {\n        factor = map.poleRadiusFactor; \n        prog = hitmapRender ? renderer.progPlane2D :renderer.progPlane2; \n        renderer.gpu.useProgram(prog, ['aPosition', 'aTexCoord']);\n        prog.setVec4('uParams4', [-sx, -sy, map.poleRadius, 0]);\n    } else {\n\n        if (!flatGrid) {\n            prog = hitmapRender ? renderer.progPlane3D : renderer.progPlane3; \n            renderer.gpu.useProgram(prog, ['aPosition', 'aTexCoord']);\n\n            var border;\n\n            if (joinGrids) {\n                border =  mnode.border3;\n            } else {\n                border = mnode.border2;\n            }\n\n            prog.setFloatArray('uHeights', border);\n            prog.setVec3('uVector', mnode.diskNormal);\n\n        } else {\n            prog = hitmapRender ? renderer.progPlane : renderer.progPlane; \n            renderer.gpu.useProgram(prog, ['aPosition', 'aTexCoord']);\n        }\n    }\n\n    prog.setMat4('uMV', mv);\n    prog.setMat4('uProj', proj);\n    prog.setFloatArray('uPoints', buffer);\n    \n    /*\n    var lx = (ur[0] - ll[0]);\n    var ly = (ll[1] - ur[1]);\n    var px = (ll[0] - node.extents.ll[0]) / lx;\n    var py = (ur[1] - node.extents.ll[1]) / ly;\n    \n    var llx = (node.extents.ur[0] - node.extents.ll[0]) / lx;\n    var lly = (node.extents.ur[1] - node.extents.ll[1]) / ly;\n\n    px = px / llx;\n    py = py / lly;\n    llx = 1.0/llx;\n    lly = 1.0/lly;\n    \n    llx *= step1;\n    lly *= step1;\n    px *= step1;\n    py *= step1;\n    */\n\n    var step1 = node.gridStep1 * factor;\n\n    var lx = 1.0 / (ur[0] - ll[0]);\n    var ly = 1.0 / (ll[1] - ur[1]);\n    var llx = step1 / ((node.extents.ur[0] - node.extents.ll[0]) * lx);\n    var lly = step1 / ((node.extents.ur[1] - node.extents.ll[1]) * ly);\n    var px = (ll[0] - node.extents.ll[0]) * lx * llx;\n    var py = (ur[1] - node.extents.ll[1]) * ly * lly;\n\n\n    if (useTexture) {\n        renderer.gpu.bindTexture(this.gridTexture.getGpuTexture());\n        prog.setVec4('uParams', [step1 * factor, draw.fogDensity, 1/15, node.gridStep2 * factor]);\n\n        var tt = this.gridTexture.getTransform();\n\n//        prog.setVec4('uParams3', [tt[2], tt[3]+tt[1], tt[0], tt[1]]);\n        prog.setVec4('uParams3', [tt[2], tt[3], tt[0], tt[1]]);\n\n        //prog.setVec4('uParams3', [(py - Math.floor(py)), (px - Math.floor(px)), lly*0.5, llx*0.5]);\n        prog.setVec4('uParams2', [0, 0, 0, 0]);\n    } else {\n        renderer.gpu.bindTexture(renderer.heightmapTexture);       \n        prog.setVec4('uParams', [step1 * factor, draw.fogDensity, 1/15, node.gridStep2 * factor]);\n        prog.setVec4('uParams3', [(py - Math.floor(py)), (px - Math.floor(px)), lly, llx]);\n        prog.setVec4('uParams2', [0, 0, node.gridBlend, 0]);\n    }\n    \n    prog.setVec4('uFogColor', draw.atmoColor);\n\n    //draw bbox\n    renderer.planeMesh.draw(prog, 'aPosition', 'aTexCoord');    \n\n    this.map.stats.drawnFaces += renderer.planeMesh.polygons;\n}; \n\n\nMapSurfaceTile.prototype.drawHmapTile = function(cameraPos, divNode, angle, pipeline, texture) {\n    //if ((this.texelSize == Number.POSITIVE_INFINITY || this.texelSize > 4.4) && this.metanode && this.metanode.hasChildren()) {\n      //  return;\n    //}\n    \n    if (!this.metanode) {\n        return;\n    }\n\n    var map = this.map, node, ll, ur, res;\n    var renderer = map.renderer;\n\n    if (!renderer.progHmapPlane) {\n        renderer.initProceduralShaders();\n    }\n\n    if (divNode) {\n        node = divNode[0]; \n        ll = divNode[1][0];\n        ur = divNode[1][1];\n    } else {\n        res = map.measure.getSpatialDivisionNodeAndExtents(this.id);\n        node = res[0]; \n        ll = res[1][0];\n        ur = res[1][1];\n    }\n   \n    var middle = [(ur[0] + ll[0])* 0.5, (ur[1] + ll[1])* 0.5];\n    var hasPoles = map.referenceFrame.hasPoles;\n    angle = angle || this.metanode.diskAngle2;\n    \n    if ((hasPoles && !node.isPole) &&  Math.acos(angle) > Math.PI*0.1) {\n        angle = Math.cos(Math.acos(angle) * 0.5); \n        \n        this.drawHmapTile(cameraPos, [node, [ [ll[0], ll[1]],  [middle[0], middle[1]] ] ], angle);\n        this.drawHmapTile(cameraPos, [node, [ [middle[0], ll[1]],  [ur[0], middle[1]] ] ], angle);\n\n        this.drawHmapTile(cameraPos, [node, [ [ll[0], middle[1]],  [middle[0], ur[1]] ] ], angle);\n        this.drawHmapTile(cameraPos, [node, [ [middle[0], middle[1]],  [ur[0], ur[1]] ] ], angle);\n       \n        return;\n    }\n     \n    var desiredSamplesPerViewExtent = 5;\n    var nodeExtent = node.extents.ur[1] - node.extents.ll[1];\n    var viewExtent = this.distance ;//* 0.1;\n    var lod = Math.log((desiredSamplesPerViewExtent * nodeExtent) / viewExtent) / map.log2;\n    lod = Math.max(0,lod - 8 + node.id[0]);\n   \n    var h, factor, prog, draw = map.draw; \n\n    var sx = cameraPos[0];\n    var sx = cameraPos[0];\n    var sy = cameraPos[1];\n    var sz = cameraPos[2];\n    var buffer = draw.planeBuffer;\n    var gridPoints = this.gridPoints;\n    var useSurrogatez = map.config.mapGridSurrogatez;\n\n    if (!gridPoints) {\n\n//        h = this.metanode.minZ;\n        h = 0;//this.metanode.minHeight;\n        var n1 = node.getPhysicalCoords([ur[0], ur[1], h], true);\n        var n2 = node.getPhysicalCoords([ur[0], ll[1], h], true);\n        var n3 = node.getPhysicalCoords([ll[0], ll[1], h], true);\n        var n4 = node.getPhysicalCoords([ll[0], ur[1], h], true);\n        var mtop = node.getPhysicalCoords([middle[0], ur[1], h], true);\n        var mbottom = node.getPhysicalCoords([middle[0], ll[1], h], true);\n        var mleft = node.getPhysicalCoords([ll[0], middle[1], h], true);\n        var mright = node.getPhysicalCoords([ur[0], middle[1], h], true);\n\n        middle[2] = h;\n        middle = node.getPhysicalCoords(middle, true);\n\n        if (!divNode) {\n\n            var gridPoints = [\n                n4[0], n4[1], n4[2],\n                mtop[0], mtop[1], mtop[2],\n                n1[0], n1[1], n1[2],\n\n                mleft[0], mleft[1], mleft[2],\n                middle[0], middle[1], middle[2],\n                mright[0], mright[1], mright[2],\n                \n                n3[0], n3[1], n3[2],\n                mbottom[0], mbottom[1], mbottom[2],\n                n2[0], n2[1], n2[2]\n            ];\n\n            this.gridPoints = gridPoints;\n\n        } else {\n            buffer[0] = n4[0] - sx;\n            buffer[1] = n4[1] - sy;\n            buffer[2] = n4[2] - sz;\n            \n            buffer[3] = mtop[0] - sx;\n            buffer[4] = mtop[1] - sy;\n            buffer[5] = mtop[2] - sz;\n\n            buffer[6] = n1[0] - sx;\n            buffer[7] = n1[1] - sy;\n            buffer[8] = n1[2] - sz;\n\n            buffer[9] = mleft[0] - sx;\n            buffer[10] = mleft[1] - sy;\n            buffer[11] = mleft[2] - sz;\n                    \n            buffer[12] = middle[0] - sx;\n            buffer[13] = middle[1] - sy;\n            buffer[14] = middle[2] - sz;\n                    \n            buffer[15] = mright[0] - sx;\n            buffer[16] = mright[1] - sy;\n            buffer[17] = mright[2] - sz;\n                \n            buffer[18] = n3[0] - sx;\n            buffer[19] = n3[1] - sy;\n            buffer[20] = n3[2] - sz;\n            \n            buffer[21] = mbottom[0] - sx;\n            buffer[22] = mbottom[1] - sy;\n            buffer[23] = mbottom[2] - sz;\n            \n            buffer[24] = n2[0] - sx;\n            buffer[25] = n2[1] - sy;\n            buffer[26] = n2[2] - sz;\n        }\n     }\n\n    var mv = renderer.camera.getModelviewMatrix();\n    var proj = renderer.camera.getProjectionMatrix();\n\n    if (gridPoints) {\n        buffer[0] = gridPoints[0] - sx;\n        buffer[1] = gridPoints[1] - sy;\n        buffer[2] = gridPoints[2] - sz;\n        \n        buffer[3] = gridPoints[3] - sx;\n        buffer[4] = gridPoints[4] - sy;\n        buffer[5] = gridPoints[5] - sz;\n\n        buffer[6] = gridPoints[6] - sx;\n        buffer[7] = gridPoints[7] - sy;\n        buffer[8] = gridPoints[8] - sz;\n\n        buffer[9] = gridPoints[9] - sx;\n        buffer[10] = gridPoints[10] - sy;\n        buffer[11] = gridPoints[11] - sz;\n                \n        buffer[12] = gridPoints[12] - sx;\n        buffer[13] = gridPoints[13] - sy;\n        buffer[14] = gridPoints[14] - sz;\n                \n        buffer[15] = gridPoints[15] - sx;\n        buffer[16] = gridPoints[16] - sy;\n        buffer[17] = gridPoints[17] - sz;\n            \n        buffer[18] = gridPoints[18] - sx;\n        buffer[19] = gridPoints[19] - sy;\n        buffer[20] = gridPoints[20] - sz;\n        \n        buffer[21] = gridPoints[21] - sx;\n        buffer[22] = gridPoints[22] - sy;\n        buffer[23] = gridPoints[23] - sz;\n        \n        buffer[24] = gridPoints[24] - sx;\n        buffer[25] = gridPoints[25] - sy;\n        buffer[26] = gridPoints[26] - sz;\n    }\n\n    if (hasPoles && !map.poleRadius && node.id[0] == 1 && !node.isPole) {\n        var p = node.getPhysicalCoords([node.extents.ur[0], node.extents.ur[1], 0]);\n        map.poleRadius = Math.sqrt(p[0]*p[0]+p[1]*p[1]); \n        map.poleRadiusFactor = 8 * Math.pow(2.0, 552058 / map.poleRadius); \n    }\n\n    var mnode = this.metanode; \n    var testMode = draw.debug.drawTestMode;\n\n    factor = 1;\n\n    if (hasPoles && node.isPole) {\n        factor = map.poleRadiusFactor; \n        prog = renderer.progPlane2; \n        renderer.gpu.useProgram(prog, ['aPosition', 'aTexCoord']);\n        prog.setVec4('uParams4', [-sx, -sy, map.poleRadius, 0]);\n    } else {\n\n        switch(testMode) {\n            default:\n            case 0: prog = renderer.progHmapPlane; break;\n            case 1: prog = renderer.progHmapPlane2; break;\n            case 2: prog = renderer.progHmapPlane5; break;\n            case 3: prog = renderer.progHmapPlane6; break;\n            case 4: prog = renderer.progHmapPlane7; break;\n\n            case 8: prog = renderer.progHmapPlane4; break;\n            case 9: prog = pipeline == 1 ? renderer.progHmapPlane3 : renderer.progHmapPlane8; break;\n        }\n\n\n        if (testMode == 3 || testMode == 4) {\n            if (!renderer.ntextures) {\n                renderer.ntextures = [ \n                    new GpuTexture(renderer.gpu, './textures/test/test001.png', renderer.core, null), //0\n                    new GpuTexture(renderer.gpu, './textures/test/test002.png', renderer.core, null), //1\n                    new GpuTexture(renderer.gpu, './textures/test003.jpg', renderer.core, null),      //2\n                    new GpuTexture(renderer.gpu, './textures/download.png', renderer.core, null),     //3\n                    new GpuTexture(renderer.gpu, './textures/test009.jpg', renderer.core, null),      //4\n                    new GpuTexture(renderer.gpu, './textures/test004.jpg', renderer.core, null),      //5\n                    new GpuTexture(renderer.gpu, './textures/test005.jpg', renderer.core, null),      //6\n                    new GpuTexture(renderer.gpu, './textures/nor_sand.jpg', renderer.core, null),     //7\n                    new GpuTexture(renderer.gpu, './textures/test007.jpg', renderer.core, null),      //8\n                    new GpuTexture(renderer.gpu, './textures/test008.jpg', renderer.core, null),      //9\n\n                    new GpuTexture(renderer.gpu, './textures/download (1).png', renderer.core, null),  //10\n                    new GpuTexture(renderer.gpu, './textures/test010.jpg', renderer.core, null),      //11\n                    new GpuTexture(renderer.gpu, './textures/test011.jpg', renderer.core, null),      //12\n                    new GpuTexture(renderer.gpu, './textures/test012.jpg', renderer.core, null),      //13\n                    new GpuTexture(renderer.gpu, './textures/test013.jpg', renderer.core, null),      //14\n                    new GpuTexture(renderer.gpu, './textures/test014.jpg', renderer.core, null),      //15\n                    new GpuTexture(renderer.gpu, './textures/test015.jpg', renderer.core, null),      //16\n                    new GpuTexture(renderer.gpu, './textures/test016.jpg', renderer.core, null),      //17\n                    new GpuTexture(renderer.gpu, './textures/test017.jpg', renderer.core, null),      //18\n                    new GpuTexture(renderer.gpu, './textures/test018.jpg', renderer.core, null)      //18\n\n                    ];\n            }\n        }\n\n//        renderer.gpu.useProgram(prog, ['aPosition', 'aTexCoord', 'aBarycentric']);\n        //renderer.gpu.useProgram(prog, ['aPosition', 'aTexCoord']);\n        renderer.gpu.useProgram(prog, ['aPosition']);\n        prog.setVec3('uVector', mnode.diskNormal);\n\n        //prog.setVec3('uRight', mnode.diskNormal);\n\n        if (gridPoints) {\n            var vecRight = [gridPoints[15] - gridPoints[12], gridPoints[16] - gridPoints[13], gridPoints[17] - gridPoints[14]];\n            var vecTop = [gridPoints[21] - gridPoints[12], gridPoints[22] - gridPoints[13], gridPoints[23] - gridPoints[14]];\n\n            vec3.normalize(vecRight);\n            vec3.normalize(vecTop);\n\n            var vecDir = mnode.diskNormal.slice();\n            //vecDir = [-vecDir[0], -vecDir[1], -vecDir[2]];\n\n            //prog.setVec3('uRight', vecRight);\n            //prog.setVec3('uTop', vecTop);\n\n\n            var mv = map.camera.camera.modelview;\n            var mv2 = vts.mat3.create();\n\n            vts.mat4.toInverseMat3(mv, mv2);\n\n            //vts.mat4.toMat3(mv, mv2);\n            vts.mat3.transpose(mv2);\n\n            vts.mat3.multiplyVec3(mv2, vecTop);\n            vts.mat3.multiplyVec3(mv2, vecDir);\n            vts.mat3.multiplyVec3(mv2, vecRight);\n\n            var space = [\n                vecRight[0], vecRight[1], vecRight[2],\n                vecTop[0], vecTop[1], vecTop[2],\n                vecDir[0], vecDir[1], vecDir[2],\n            ];\n\n            /*\n            var mv3 = vts.mat3.toMat4(mv2);\n            vts.mat4.multiply(mv3, vts.mat3.toMat4(space), mv3);\n            prog.setMat3('uSpace', vts.mat4.toMat3(mv3));\n            */\n            \n            prog.setMat3('uSpace', space);\n        }\n    }\n\n    prog.setMat4('uMV', mv);\n    prog.setMat4('uProj', proj);\n    prog.setFloatArray('uPoints', buffer);\n    \n\n    var step1 = node.gridStep1 * factor;\n    prog.setVec4('uParams', [step1 * factor, draw.fogDensity, 1/127, node.gridStep2 * factor]);\n\n    if (testMode >= 3 && testMode <= 4) {\n        prog.setVec4('uParams3', [1,1,0,0]);\n    } else {\n        if (texture) {\n            prog.setVec4('uParams3', texture.getTransform());\n        } else {\n            var lx = 1.0 / (ur[0] - ll[0]);\n            var ly = 1.0 / (ll[1] - ur[1]);\n            var llx = step1 / ((node.extents.ur[0] - node.extents.ll[0]) * lx);\n            var lly = step1 / ((node.extents.ur[1] - node.extents.ll[1]) * ly);\n            var px = (ll[0] - node.extents.ll[0]) * lx * llx;\n            var py = (ur[1] - node.extents.ll[1]) * ly * lly;\n\n            prog.setVec4('uParams3', [lly, llx, (py - Math.floor(py)), (px - Math.floor(px))]);\n        }\n    }\n\n    prog.setVec4('uParams2', [0, 0, node.gridBlend, 0]);\n    prog.setVec4('uFogColor', draw.atmoColor);\n\n\n    if (this.hmap.extraBound) {\n        //get height form parent\n        mnode = this.hmap.extraBound.sourceTile.metanode;\n        prog.setVec3('uHeights', [mnode.minHeight, mnode.maxHeight, (1.0/mnode.pixelSize)]);\n        prog.setVec4('uTransform', this.hmap.getTransform());\n    } else {\n        prog.setVec3('uHeights', [mnode.minHeight, mnode.maxHeight, (1.0/mnode.pixelSize)]);\n        prog.setVec4('uTransform', [1,1,0,0]);\n    }\n\n    if (testMode >= 3 && testMode <= 4) {\n        if (!renderer.ntextures[draw.debug.drawTestData].loaded) {\n            return;\n        }\n        renderer.gpu.bindTexture(renderer.ntextures[draw.debug.drawTestData]);\n    } else {\n        if (texture) {\n            renderer.gpu.bindTexture(texture.getGpuTexture());\n        } else {\n            renderer.gpu.bindTexture(renderer.heightmapTexture);\n        }\n    }\n\n    prog.setSampler('uSampler', 0);    \n\n//    if(this.hmap) {\n        renderer.gpu.bindTexture(this.hmap.getGpuTexture(), 1);\n  //  } else {\n        //renderer.gpu.bindTexture(renderer.blackTexture, 1);\n  //      renderer.gpu.bindTexture(renderer.blackTexture2, 1);\n   // }\n\n    prog.setSampler('uSampler2', 1);    \n\n    //draw bbox\n    //renderer.planeMesh2.draw(prog, 'aPosition', 'aTexCoord');    \n    renderer.planeMesh2.draw(prog, 'aPosition');    \n\n    /*\n    if (vecRight && gridPoints) {\n        //renderer.draw.drawLineString(points, screenSpace, size, color, depthOffset, depthTest, transparent, writeDepth, useState);\n        renderer.draw.drawLineString([[gridPoints[12], gridPoints[13], gridPoints[14]], [gridPoints[15], gridPoints[16], gridPoints[17]]], false, 4, [1,0,0,1], null, false, false, false, false);\n        renderer.draw.drawLineString([[gridPoints[12], gridPoints[13], gridPoints[14]], [gridPoints[21], gridPoints[22], gridPoints[23]]], false, 4, [0,0,1,1], null, false, false, false, false);\n\n        renderer.draw.drawLineString([[0, 0, 0], [9000000, 0, 0]], false, 4, [1,0,0,1], null, false, false, false, false);\n        renderer.draw.drawLineString([[0, 0, 0], [0, 9000000, 0, 0]], false, 4, [0,1,0,1], null, false, false, false, false);\n        renderer.draw.drawLineString([[0, 0, 0], [0, 0, 9000000]], false, 4, [0,0,1,1], null, false, false, false, false);\n    }*/\n\n\n    this.map.stats.drawnFaces += renderer.planeMesh2.polygons;\n}; \n\n\nexport default MapSurfaceTile;\n\n\n","\nimport {vec3 as vec3_} from '../utils/matrix';\nimport MapSurfaceTile_ from './surface-tile';\n\n//get rid of compiler mess\nvar vec3 = vec3_;\nvar MapSurfaceTile = MapSurfaceTile_;\n\n\nvar MapSurfaceTree = function(map, freeLayer, freeLayerSurface) {\n    this.map = map;\n    this.camera = map.camera;\n    this.rootId = [0,0,0];\n    this.freeLayer = freeLayer;\n    this.freeLayerSurface = freeLayerSurface;\n    this.metaBinaryOrder = this.map.referenceFrame.params.metaBinaryOrder;\n    //this.initialized = false;\n    //this.geocent = !this.map.getNavigationSrs().isProjected();\n\n    this.surfaceTree = new MapSurfaceTile(this.map, null, this.rootId);\n\n    //if (freeLayer !== true) {\n        //this.heightTracer = new MapMetanodeTracer(this, null, this.traceTileHeight.bind(this), this.traceHeightChild.bind(this));\n        //this.heightTracerNodeOnly = new MapMetanodeTracer(this, null, this.traceTileHeightNodeOnly.bind(this), this.traceHeightChild.bind(this));\n    //}\n\n    this.surfaceSequence = [];\n    this.surfaceOnlySequence = [];\n\n    this.config = this.map.config;\n    this.cameraPos = [0,0,0];\n    this.worldPos = [0,0,0];\n    this.ndcToScreenPixel = 1.0;\n    this.counter = 0;\n};\n\n\nMapSurfaceTree.prototype.kill = function() {\n    this.surfaceTree = null;\n    this.metastorageTree = null;\n    this.surfaceTracer = null;\n    this.heightTracer = null;\n};\n\n\n/*MapSurfaceTree.prototype.init = function() {\n    var url = this.map.url.makeUrl(surface.metaUrl, {lod:result[0], ix:result[1], iy:result[2] });  //result???\n    map.loader.load(url, metatile.load.bind(metatile, url));\n\n    this.metatileTree.load();\n    this.surfaceTree.metatile = 1;\n\n    this.initialized = true;\n};*/\n\n\nMapSurfaceTree.prototype.findSurfaceTile = function(id) {\n    var tile = this.surfaceTree;\n\n//    for (var lod = 1; lod <= id[0]; lod++) {\n//        var mask = 1 << (lod-1);\n//        var index = 0;\n\n    for (var lod = id[0]; lod > 0; lod--) {\n        var mask = 1 << (lod-1);\n        var index = 0;\n        \n        if ((id[1] & mask) != 0) {\n            index += 1;\n        }\n\n        if ((id[2] & mask) != 0) {\n            index += 2;\n        }\n        \n        tile = tile.children[index];\n\n        if (!tile) {\n            return null;\n        }\n    }\n    \n    return tile;\n};\n\n\nMapSurfaceTree.prototype.findNavTile = function(id) {\n    var tile = this.surfaceTree;\n    \n    if (id[0] == 0) {\n        if (tile.metanode && tile.metanode.hasNavtile()) {\n            return tile;\n        } else {\n            return null;\n        }\n    }\n    \n    var navtile = null;\n\n//    for (var lod = 1; lod <= id[0]; lod++) {\n//        var mask = 1 << (id[0] - lod);\n//        var index = 0;\n    for (var lod = id[0]; lod > 0; lod--) {\n        var mask = 1 << (lod-1);\n        var index = 0;\n\n        if ((id[1] & mask) != 0) {\n            index += 1;\n        }\n\n        if ((id[2] & mask) != 0) {\n            index += 2;\n        }\n        \n        tile = tile.children[index];\n\n        if (!tile) {\n            return navtile;\n        } else {\n            if (tile.metanode && tile.metanode.hasNavtile()) {\n                navtile = tile;\n            }\n        }\n    }\n    \n    return navtile;\n};\n\n\nMapSurfaceTree.prototype.draw = function(storeTilesOnly) {\n    this.cameraPos = [0,0,0];\n    this.worldPos = [0,0,0];\n\n    var map = this.map;\n    var draw = map.draw;\n    this.ndcToScreenPixel = draw.ndcToScreenPixel;\n    \n    var srs = map.getPhysicalSrs();\n\n    //var divisionNode = this.divisionNode;\n    var periodicity = srs.periodicity;\n\n    //if (this.map.config.mapBasicTileSequence) {\n        //this.surfaceTracer = this.surfaceTracerBasic;\n    //}\n    \n    if (this.freeLayerSurface && this.freeLayerSurface.geodata && draw.drawChannel != 0) {\n        return;\n    }\n\n    if (periodicity != null) {\n        this.drawSurface([0,0,0]);\n\n        if (periodicity.type == 'X') {\n            this.drawSurface([periodicity.period,0,0], storeTilesOnly);\n            this.drawSurface([-periodicity.period,0,0], storeTilesOnly);\n        }\n\n    } else {\n        var mode;\n\n        if (this.freeLayerSurface && this.freeLayerSurface.geodata) {\n            mode = map.config.mapGeodataLoadMode; \n        } else {\n            mode = map.config.mapLoadMode; \n        }\n\n        switch(mode) {\n        case 'topdown':\n\n            if (map.config.mapSplitMeshes) {\n                this.drawSurfaceWithSpliting([0,0,0], storeTilesOnly);\n            } else {\n                this.drawSurface([0,0,0], storeTilesOnly);\n            }\n\n            break;\n\n        case 'downtop': this.drawSurfaceDownTop([0,0,0], storeTilesOnly); break;\n        case 'fit':     this.drawSurfaceFit([0,0,0], storeTilesOnly); break;\n        case 'fitonly': this.drawSurfaceFitOnly([0,0,0], storeTilesOnly); break;\n        }\n\n    }\n};\n\n\nMapSurfaceTree.prototype.updateNodeHeightExtents = function(tile, node) {\n    \n    if (!node.heightReady && node.metatile.useVersion < 4) {\n        var parent = tile.parent;\n\n        //if (node.hasNavtile()) {\n          //  node = node;\n        //}\n        \n        while (parent) {\n            var parentNode = parent.metanode;  \n            if (parentNode.hasNavtile()) {\n\n                //if (node.hasNavtile()) {\n                  //  node = node;\n                //}\n\n                node.minHeight = parentNode.minHeight;\n                node.maxHeight = parentNode.maxHeight;\n                node.minZ = parentNode.minZ;\n                node.maxZ = parentNode.maxZ;\n                node.minZ2 = parentNode.minZ2;\n                node.maxZ2 = parentNode.maxZ2;\n                node.generateCullingHelpers();\n                break;\n            }\n            \n            parent = parent.parent;\n        }\n\n        node.heightReady = true;\n    }\n};\n\n\nMapSurfaceTree.prototype.logTileInfo = function(tile, node, cameraPos) {\n    if (!tile || !node) {\n        return;\n    }\n    \n    var visible = tile.bboxVisible(tile.id, node.bbox, cameraPos, node);\n    tile.updateTexelSize();\n    \n    // eslint-disable-next-line\n    console.log('tile: ' + JSON.stringify(tile.id) + ' visible: ' + visible + ' texelsize: ' +  tile.texelSize + ' center: '  + JSON.stringify(node.diskPos) + ' vec: ' + node.diskNormal + 'ang: ' + node.diskAngle + ' dist: ' + node.diskDistance);\n};\n\n\n//loadmode = topdown\nMapSurfaceTree.prototype.drawSurface = function(shift, storeTilesOnly) {\n    this.counter++;\n\n    var tile = this.surfaceTree;\n    \n    if (!tile.isMetanodeReady(this, 0)) {\n        return;\n    }\n    \n    var map = this.map;\n    var node = tile.metanode;\n    var cameraPos = map.camera.position;\n\n    if (!tile.bboxVisible(tile.id, node.bbox, cameraPos, node)) {\n        return;\n    }\n\n    tile.updateTexelSize();\n    \n    var typeFactor = this.freeLayerSurface ? 1 : 1;\n\n    var draw = map.draw;\n    var drawTiles = draw.drawTiles;\n    var drawBuffer = draw.drawBuffer;\n    var processBuffer = draw.processBuffer;\n    var newProcessBuffer = draw.processBuffer2;\n    var drawBufferIndex = 0;\n    var processBufferIndex = 0;\n    var newProcessBufferIndex = 0;\n    var gpuNeeded = 0;\n    var gpuNeededForRender = 0;\n    var size = 0;\n    \n    processBuffer[0] = tile;\n    processBufferIndex = 1;\n   \n    var texelSizeFit = draw.texelSizeFit;\n\n    var best2 = 0;\n    var replay = draw.replay;\n    var storeNodes = replay.storeNodes || replay.storeFreeNodes;\n    var storeNodesBuffer = replay.nodeBuffer; \n   \n    draw.drawCounter++;\n    \n    var pocessedNodes = 1;\n    var pocessedMetatiles = 1;  \n    var usedNodes = 1;\n    var drawCounter = draw.drawCounter, i, j, lj;\n\n\n    do {\n        var best = 0;\n        newProcessBufferIndex = 0;\n        \n        for (i = processBufferIndex - 1; i >= 0; i--) {\n            tile = processBuffer[i];\n            node = tile.metanode;\n\n            if (node) {\n                pocessedNodes++;\n                if (node.metatile.drawCounter != drawCounter) {\n                    node.metatile.drawCounter = drawCounter;\n                    pocessedMetatiles++;\n                }\n            }\n            \n            //if (this.map.drawIndices) {\n              //  this.logTileInfo(tile, node, cameraPos);\n            //}\n\n            if (tile.bboxVisible(tile.id, node.bbox, cameraPos, node)) {\n\n                usedNodes++;\n\n                if (tile.texelSize != Number.POSITIVE_INFINITY){\n                    if (tile.texelSize > best) {\n                        best = tile.texelSize;\n                    }\n                }\n                \n                if (storeNodes) { //used only for inspector\n                    storeNodesBuffer.push(tile);\n                }\n              \n                if (/*node.hasGeometry() && */tile.texelSize <= texelSizeFit /*|| gpuNeeded > gpuMax*/) {\n                    size = draw.getDrawCommandsGpuSize(tile.drawCommands[draw.drawChannel] || tile.lastRenderState.drawCommands[draw.drawChannel]);\n\n                    gpuNeeded += size;\n                    gpuNeededForRender += size;\n\n                    tile.drawCounter = draw.drawCounter;\n                    drawBuffer[drawBufferIndex] = tile;\n                    drawBufferIndex++;\n                    \n                } else { //go deeper\n                    size = draw.getDrawCommandsGpuSize(tile.drawCommands[draw.drawChannel] || tile.lastRenderState.drawCommands[draw.drawChannel]);\n                    gpuNeeded += size;\n\n                    var childrenCount = 0;\n                    var readyCount = 0;\n                    var childrenBuffer = [];\n                    \n                    for (j = 0; j < 4; j++) {\n                        var child = tile.children[j];\n                        if (child) {\n                            childrenCount++;\n       \n                            if (child.isMetanodeReady(this, child.id[0])) { //lod is used as priority\n                                var factor = 1;\n\n                                this.updateNodeHeightExtents(child, child.metanode);\n                                child.updateTexelSize(factor);\n                                \n                                var priority = child.id[0] * typeFactor * child.distance;\n                                \n                                if (!tile.surface || !child.metanode.hasGeometry()) {\n\n                                    readyCount++;\n                                    //child.updateTexelSize();\n                                    childrenBuffer.push(child);\n                                    \n                                } else {\n\n                                    //are draw buffers ready? preventRender=true, preventLoad=false, doNotCheckGpu=true\n                                    if (drawTiles.drawSurfaceTile(child, child.metanode, cameraPos, child.texelSize, priority, true, false, true)) {\n                                        \n                                        readyCount++;\n                                        //child.updateTexelSize();\n                                        childrenBuffer.push(child);\n                                    }\n                                    \n                                }\n                            }\n                        }\n                    }\n        \n                    if (/*!(gpuNeeded > gpuMax) &&*/ childrenCount > 0 && childrenCount == readyCount) {\n                        //sort children by distance\n    \n                        do {\n                            var sorted = true;\n                            \n                            for (j = 0, lj = childrenBuffer.length - 1; j < lj; j++) {\n                                if (childrenBuffer[j].distance > childrenBuffer[j+1].distance) {\n                                    var t = childrenBuffer[j];\n                                    childrenBuffer[j] = childrenBuffer[j+1];\n                                    childrenBuffer[j+1] = t;\n                                    sorted = false;\n                                } \n                            }\n                            \n                        } while(!sorted);\n    \n    \n                        //add children to new process buffer \n                        for (j = 0, lj = childrenBuffer.length; j < lj; j++) {\n                            \n                            /*var n = childrenBuffer[j].metanode.divisionNode;\n                            if ((n.id[0] == 1 && n.id[1] == 1 && n.id[2] == 0)) {*/\n                            newProcessBuffer[newProcessBufferIndex] = childrenBuffer[j];\n                            newProcessBufferIndex++;\n                            /*}*/\n                            \n                        }\n                    } else {\n                        gpuNeededForRender += size;\n\n                        tile.drawCounter = draw.drawCounter;\n                        drawBuffer[drawBufferIndex] = tile;\n                        drawBufferIndex++;\n                    }\n                    \n                }\n            }\n        }\n\n        var tmp = processBuffer;\n        processBuffer = newProcessBuffer;\n        newProcessBuffer = tmp;\n        processBufferIndex = newProcessBufferIndex;\n\n    } while(processBufferIndex > 0);\n\n    if (storeTilesOnly) {\n        this.storeDrawBufferGeometry(drawBufferIndex);\n        return;\n    }\n    \n    if (best2 > draw.bestMeshTexelSize) {\n        draw.bestMeshTexelSize = best2;\n    }\n\n    var stats = map.stats;\n\n    stats.usedNodes = usedNodes;    \n    stats.processedNodes = pocessedNodes;    \n    stats.processedMetatiles = pocessedMetatiles;    \n    stats.gpuNeeded = gpuNeeded;    \n    \n    //console.log(\"texel: \"+ this.map.bestMeshTexelSize);\n    //console.log(\"more: \"+ more + \"more2: \" + more2);\n\n    this.processDrawBuffer(draw, drawTiles, cameraPos, map, stats, false, false, replay, drawBuffer, drawBufferIndex, true);\n};\n\n\n//loadmode = topdown + split\nMapSurfaceTree.prototype.drawSurfaceWithSpliting = function(shift, storeTilesOnly) {\n    this.counter++;\n\n    var tile = this.surfaceTree;\n    \n    if (!tile.isMetanodeReady(this, 0)) {\n        return;\n    }\n    \n    var map = this.map;\n    var node = tile.metanode;\n    var cameraPos = map.camera.position;\n\n    if (!tile.bboxVisible(tile.id, node.bbox, cameraPos, node)) {\n        return;\n    }\n\n    tile.updateTexelSize();\n    \n    var typeFactor = this.freeLayerSurface ? 1 : 1;\n\n    var draw = map.draw;\n    var drawTiles = draw.drawTiles;\n    var drawBuffer = draw.drawBuffer;\n    var processBuffer = draw.processBuffer;\n    var newProcessBuffer = draw.processBuffer2;\n    var drawBufferIndex = 0;\n    var processBufferIndex = 0;\n    var newProcessBufferIndex = 0;\n    var gpuNeeded = 0;\n    var gpuNeededForRender = 0;\n    var size = 0;\n    \n    processBuffer[0] = tile;\n    processBufferIndex = 1;\n   \n    var texelSizeFit = draw.texelSizeFit;\n\n    var best2 = 0;\n    var replay = draw.replay;\n    var storeNodes = replay.storeNodes || replay.storeFreeNodes;\n    var storeNodesBuffer = replay.nodeBuffer; \n   \n    draw.drawCounter++;\n    \n    var pocessedNodes = 1;\n    var pocessedMetatiles = 1;  \n    var usedNodes = 1;\n    var drawCounter = draw.drawCounter, i, j, lj;\n\n\n    do {\n        var best = 0;\n        newProcessBufferIndex = 0;\n        \n        for (i = processBufferIndex - 1; i >= 0; i--) {\n            tile = processBuffer[i];\n            node = tile.metanode;\n\n            if (node) {\n                pocessedNodes++;\n                if (node.metatile.drawCounter != drawCounter) {\n                    node.metatile.drawCounter = drawCounter;\n                    pocessedMetatiles++;\n                }\n            }\n            \n            //if (this.map.drawIndices) {\n              //  this.logTileInfo(tile, node, cameraPos);\n            //}\n\n            tile.splitMask = null;\n            //tile.splitMask = [0,0,0,1];\n\n            if (tile.visibleCounter == drawCounter || tile.bboxVisible(tile.id, node.bbox, cameraPos, node)) {\n\n                usedNodes++;\n\n                if (tile.texelSize != Number.POSITIVE_INFINITY){\n                    if (tile.texelSize > best) {\n                        best = tile.texelSize;\n                    }\n                }\n                \n                if (storeNodes) { //used only for inspector\n                    storeNodesBuffer.push(tile);\n                }\n              \n                if (/*node.hasGeometry() && */tile.texelSize <= texelSizeFit /*|| gpuNeeded > gpuMax*/) {\n\n                    if (tile.skipRenderCounter != drawCounter) {\n\n                        size = draw.getDrawCommandsGpuSize(tile.drawCommands[draw.drawChannel] || tile.lastRenderState.drawCommands[draw.drawChannel]);\n\n                        gpuNeeded += size;\n                        gpuNeededForRender += size;\n\n                        //if (tile.parent && tile.parent.children[3] == tile) {\n                            tile.drawCounter = drawCounter;\n                            drawBuffer[drawBufferIndex] = tile;\n                            drawBufferIndex++;\n                        //}\n                    }\n                    \n                } else { //go deeper\n                    size = draw.getDrawCommandsGpuSize(tile.drawCommands[draw.drawChannel] || tile.lastRenderState.drawCommands[draw.drawChannel]);\n                    gpuNeeded += size;\n\n                    var childrenCount = 0;\n                    var childrenBuffer = [];\n                    var mask = [1,1,1,1];\n                    var useMask = false;\n                    \n                    for (j = 0; j < 4; j++) {\n                        var child = tile.children[j];\n                        if (child) {\n                            childrenCount++;\n                            child.skipRenderCounter = tile.skipRenderCounter;\n       \n                            if (child.isMetanodeReady(this, child.id[0])) { //lod is used as priority\n                                var factor = 1;\n\n                                this.updateNodeHeightExtents(child, child.metanode);\n                                child.updateTexelSize(factor);\n\n                                if (child.bboxVisible(child.id, child.metanode.bbox, cameraPos, child.metanode)) {\n                                    child.visibleCounter = draw.drawCounter;\n                                } else {\n                                    continue;\n                                }\n                                \n                                var priority = child.id[0] * typeFactor * child.distance;\n                                \n                                if (!tile.surface || !child.metanode.hasGeometry()) {\n                                    childrenBuffer.push(child);\n                                } else {\n                                    //are draw buffers ready? preventRender=true, preventLoad=false, doNotCheckGpu=true\n                                    if (drawTiles.drawSurfaceTile(child, child.metanode, cameraPos, child.texelSize, priority, true, false, true)) {\n                                        childrenBuffer.push(child);\n                                        mask[j] = 0;\n                                    } else {\n                                        childrenBuffer.push(child);\n                                        child.skipRenderCounter = drawCounter;\n                                        useMask = true;\n                                    }\n                                }\n\n                            } else {\n                                //mask[j] = 0;\n                                useMask = true;\n                            }\n                        }\n                    }\n        \n                    if (childrenBuffer.length > 0) {\n                        //sort children by distance\n    \n                        do {\n                            var sorted = true;\n                            \n                            for (j = 0, lj = childrenBuffer.length - 1; j < lj; j++) {\n                                if (childrenBuffer[j].distance > childrenBuffer[j+1].distance) {\n                                    var t = childrenBuffer[j];\n                                    childrenBuffer[j] = childrenBuffer[j+1];\n                                    childrenBuffer[j+1] = t;\n                                    sorted = false;\n                                } \n                            }\n                            \n                        } while(!sorted);\n    \n    \n                        //add children to new process buffer \n                        for (j = 0, lj = childrenBuffer.length; j < lj; j++) {\n                            newProcessBuffer[newProcessBufferIndex] = childrenBuffer[j];\n                            newProcessBufferIndex++;\n                        }\n                    }\n\n                    if (childrenCount == 0 || useMask) {\n\n                        //if (tile.parent && tile.parent.children[3] == tile) {\n\n                        if (tile.skipRenderCounter != drawCounter) {\n                            gpuNeededForRender += size;\n                            tile.splitMask = useMask ? mask : null;\n                            tile.drawCounter = drawCounter;\n\n                            drawBuffer[drawBufferIndex] = tile;\n                            drawBufferIndex++;\n                        }\n\n                        //}\n                    }\n\n                    \n                }\n            }\n        }\n\n        var tmp = processBuffer;\n        processBuffer = newProcessBuffer;\n        newProcessBuffer = tmp;\n        processBufferIndex = newProcessBufferIndex;\n\n    } while(processBufferIndex > 0);\n\n    if (storeTilesOnly) {\n        this.storeDrawBufferGeometry(drawBufferIndex);\n        return;\n    }\n    \n    if (best2 > draw.bestMeshTexelSize) {\n        draw.bestMeshTexelSize = best2;\n    }\n\n    var stats = map.stats;\n\n    stats.usedNodes = usedNodes;    \n    stats.processedNodes = pocessedNodes;    \n    stats.processedMetatiles = pocessedMetatiles;    \n    stats.gpuNeeded = gpuNeeded;    \n    \n    //console.log(\"texel: \"+ this.map.bestMeshTexelSize);\n    //console.log(\"more: \"+ more + \"more2: \" + more2);\n\n    this.processDrawBuffer(draw, drawTiles, cameraPos, map, stats, false, false, replay, drawBuffer, drawBufferIndex, true);\n};\n\n\n//loadmode = fitonly\nMapSurfaceTree.prototype.drawSurfaceFitOnly = function(shift, storeTilesOnly, useDrawBufferOnly) {\n    this.counter++;\n//    this.surfaceTracer.trace(this.surfaceTree);//this.rootId);\n\n    var tile = this.surfaceTree;\n    \n    if (!tile.isMetanodeReady(this, 0)) {\n        return;\n    }\n    \n    var map = this.map;\n    var node = tile.metanode;\n    var cameraPos = map.camera.position;\n\n    if (!tile.bboxVisible(tile.id, node.bbox, cameraPos, node)) {\n        return;\n    }\n\n    tile.updateTexelSize();\n    \n    //var typeFactor = this.freeLayerSurface ? 1 : 1;\n    \n    var draw = map.draw;\n    var drawTiles = draw.drawTiles;\n    var drawBuffer = draw.drawBuffer;\n    var processBuffer = draw.processBuffer;\n    var newProcessBuffer = draw.processBuffer2;\n    var drawBufferIndex = 0;\n    var processBufferIndex = 0;\n    var newProcessBufferIndex = 0;\n    \n    processBuffer[0] = tile;\n    processBufferIndex = 1;\n\n    var texelSizeFit = draw.texelSizeFit;\n\n    var replay = map.draw.replay;\n    var storeNodes = replay.storeNodes || replay.storeFreeNodes;\n    var storeNodesBuffer = replay.nodeBuffer; \n\n    draw.drawCounter++;\n    \n    var usedNodes = 1;\n    var pocessedNodes = 1;\n    var pocessedMetatiles = 1;  \n    var drawCounter = draw.drawCounter, i, j, lj;\n    var grids = false; \n    \n    do {\n        var best = 0;\n        newProcessBufferIndex = 0;\n       \n        for (i = processBufferIndex - 1; i >= 0; i--) {\n            tile = processBuffer[i];\n            node = tile.metanode;\n\n            if (node) {\n                pocessedNodes++;\n                if (node.metatile.drawCounter != drawCounter) {\n                    node.metatile.drawCounter = drawCounter;\n                    pocessedMetatiles++;\n                }\n            }\n\n            if (tile.bboxVisible(tile.id, node.bbox, cameraPos, node)) {\n\n                usedNodes++;\n\n                if (storeNodes) { //used only for inspector\n                    storeNodesBuffer.push(tile);\n                }\n\n                if (tile.texelSize  != Number.POSITIVE_INFINITY){\n                    if (tile.texelSize > best) {\n                        best = tile.texelSize;\n                    }\n                }\n                \n                if (/*node.hasGeometry() && */tile.texelSize <= texelSizeFit) {\n                   \n                    tile.drawCounter = draw.drawCounter;\n                    drawBuffer[drawBufferIndex] = tile;\n                    drawBufferIndex++;\n                    \n                } else { //go deeper\n\n                    var childrenCount = 0;\n                    var nodesReadyCount = 0;\n                    var childrenBuffer = [];\n        \n                    for (j = 0; j < 4; j++) {\n                        var child = tile.children[j];\n                        if (child) {\n                            childrenCount++;\n       \n                            if (child.isMetanodeReady(this, child.id[0])) { //lod is used as priority\n\n                                this.updateNodeHeightExtents(child, child.metanode);\n                                child.updateTexelSize();\n\n                                childrenBuffer.push(child);\n                                nodesReadyCount++;\n\n                            } /*else if (useDrawBufferOnly) { //used in downtop\n                                //drawBuffer[drawBufferIndex] = [child, true];\n                                //drawBufferIndex++;\n                            }*/\n                        }\n                    }\n        \n                    if (childrenCount > 0 && (!useDrawBufferOnly || childrenCount == nodesReadyCount)) {\n                        //sort children by distance\n    \n                        do {\n                            var sorted = true;\n                            \n                            for (j = 0, lj = childrenBuffer.length - 1; j < lj; j++) {\n                                if (childrenBuffer[j].distance > childrenBuffer[j+1].distance) {\n                                    var t = childrenBuffer[j];\n                                    childrenBuffer[j] = childrenBuffer[j+1];\n                                    childrenBuffer[j+1] = t;\n                                    sorted = false;\n                                } \n                            }\n                            \n                        } while(!sorted);\n    \n                        //add childrn to new process buffer \n                        for (j = 0, lj = childrenBuffer.length; j < lj; j++) {\n\n                            newProcessBuffer[newProcessBufferIndex] = childrenBuffer[j];\n                            newProcessBufferIndex++;\n                        }\n                    } else {\n                        tile.drawCounter = draw.drawCounter;\n                        drawBuffer[drawBufferIndex] = tile;\n                        drawBufferIndex++;\n                    }\n                    \n                }\n            }\n        }\n        \n        var tmp = processBuffer;\n        processBuffer = newProcessBuffer;\n        newProcessBuffer = tmp;\n        processBufferIndex = newProcessBufferIndex;\n        \n    } while(processBufferIndex > 0);\n\n    if (storeTilesOnly) {\n        if (useDrawBufferOnly) {\n            var tmp = draw.drawBuffer2;\n            draw.drawBuffer2 = draw.drawBuffer;\n            draw.drawBuffer = tmp;\n            //draw.drawBufferIndex = drawBufferIndex;            \n        } else {\n            this.storeDrawBufferGeometry(drawBufferIndex);\n        }\n        return drawBufferIndex;\n    }\n\n    var stats = map.stats;\n\n    stats.usedNodes = usedNodes;    \n    stats.processedNodes = pocessedNodes;    \n    stats.processedMetatiles = pocessedMetatiles;    \n\n    this.processDrawBuffer(draw, drawTiles, cameraPos, map, stats, false, false, replay, drawBuffer, drawBufferIndex, true);\n};\n\n\n//loadmode = fit\nMapSurfaceTree.prototype.drawSurfaceFit = function(shift, storeTilesOnly) {\n    this.counter++;\n\n    var tile = this.surfaceTree;\n    \n    if (!tile.isMetanodeReady(this, 0)) {\n        return;\n    }\n    \n    var map = this.map;\n    var node = tile.metanode;\n    var cameraPos = map.camera.position;\n\n    if (!tile.bboxVisible(tile.id, node.bbox, cameraPos, node)) {\n        return;\n    }\n\n    tile.updateTexelSize();\n\n    var geodata = tile.surface ? tile.surface.geodata : null;\n    var maxLod = tile.surface.maxLod || tile.surface.lodRange[1];\n    var free = tile.surface ? tile.surface.free : null;\n    var drawGrid = (!geodata && !free && map.config.mapHeightfiledWhenUnloaded);\n    var checkGpu = true;\n    \n    var lodShift = 4;//this.freeLayerSurface ? 1 : 1;\n    var typeFactor = 2000;//this.freeLayerSurface ? 1 : 1;\n\n    if (this.freeLayerSurface) {\n        lodShift = 0;//this.freeLayerSurface ? 1 : 1;\n        typeFactor = 0.1;//this.freeLayerSurface ? 1 : 1;\n    }\n    \n    var draw = map.draw;\n    var drawTiles = draw.drawTiles;\n    var replay = draw.replay;\n    var drawBuffer = draw.drawBuffer;\n    var processBuffer = draw.processBuffer;\n    var newProcessBuffer = draw.processBuffer2;\n    var drawBufferIndex = 0;\n    var processBufferIndex = 0;\n    var newProcessBufferIndex = 0;\n    \n    processBuffer[0] = [tile, 0];\n    processBufferIndex = 1;\n\n    var texelSizeFit = draw.texelSizeFit;\n\n    var storeNodes = replay.storeNodes || replay.storeFreeNodes;\n    var storeNodesBuffer = replay.nodeBuffer; \n\n    draw.drawCounter++;\n    \n    var usedNodes = 1;\n    var pocessedNodes = 1;\n    var pocessedMetatiles = 1;  \n    var drawCounter = draw.drawCounter;\n    var maxHiresLodLevels = map.config.mapMaxHiresLodLevels, i, j, lj, child, priority, parent, parent2, children2;\n    var grids = false; \n    \n    do {\n        var best = 0;\n        newProcessBufferIndex = 0;\n\n        /*if (this.map.drawIndices) {\n            console.log(\"processed begin==============================================\");\n        }*/            \n       \n        for (i = processBufferIndex - 1; i >= 0; i--) {\n            var pack = processBuffer[i];\n            tile = pack[0];\n            var depth = pack[1];\n\n            tile.childrenReadyCount = 0;\n            \n            /*if (this.map.drawIndices) {\n                console.log(JSON.stringify(tile.id));\n            }*/\n            \n            if (depth >= maxHiresLodLevels) {\n                if (drawGrid) {\n                    parent = tile;\n\n                    //make sure that we draw grid with lowest possible detail \n                    parent2 = parent.parent;                    \n\n                    if (parent.id[0] > 3 && depth !=0 && parent2 && parent2.childrenReadyCount == 0) {\n                        children2 = parent2.children;\n\n                        if (!(depth >= 1 && parent.parent && ((children2[0] && children2[0].childrenReadyCount != 0) || \n                             (children2[1] && children2[1].childrenReadyCount != 0) ||\n                             (children2[2] && children2[2].childrenReadyCount != 0) ||\n                             (children2[3] && children2[3].childrenReadyCount != 0)))) {\n                            parent = parent.parent;\n                        }\n                    }\n\n                    //make sure that grid tile is rendered only one time\n                    if (parent.drawCounter != draw.drawCounter && (!parent.parent || parent.parent.drawCounter != draw.drawCounter )) { \n                        parent.drawCounter = draw.drawCounter;\n                        \n                        drawBuffer[drawBufferIndex] = [parent, true]; //draw grid\n                        drawBufferIndex++;\n                        grids = true;\n                    }\n                }\n\n                continue;\n            }\n            \n            node = tile.metanode;\n\n            if (node) {\n                pocessedNodes++;\n                if (node.metatile.drawCounter != drawCounter) {\n                    node.metatile.drawCounter = drawCounter;\n                    pocessedMetatiles++;\n                }\n            }\n\n\n            if (tile.bboxVisible(tile.id, node.bbox, cameraPos, node)) {\n\n                usedNodes++;\n\n                if (tile.texelSize  != Number.POSITIVE_INFINITY){\n                    if (tile.texelSize > best) {\n                        best = tile.texelSize;\n                    }\n                }\n\n                if (storeNodes) { //used only for inspaector\n                    storeNodesBuffer.push(tile);\n                }\n                \n                var lastProcessBufferIndex = newProcessBufferIndex;\n                var lastDrawBufferIndex = drawBufferIndex;\n\n                if (!node.hasChildren() || tile.texelSize <= texelSizeFit || (geodata && tile.id[0] >= maxLod)) {\n\n                    priority = ((tile.id[0] + lodShift) * typeFactor) * tile.distance; \n            \n                    if (node.hasChildren() && !drawTiles.drawSurfaceTile(tile, tile.metanode, cameraPos, tile.texelSize, priority, true, (depth > 0), checkGpu)) {\n\n                        depth++; //we dont have tile ready, so we try to draw more detailed tiles\n\n                        for (j = 0; j < 4; j++) {\n                            child = tile.children[j];\n                            if (child) {\n           \n                                if (child.isMetanodeReady(this, child.id[0], true)) { //lod is used as priority\n\n                                    this.updateNodeHeightExtents(child, child.metanode);\n                                    child.updateTexelSize();\n                                    \n                                    //are draw buffers ready? preventRender=true, preventLoad=false\n                                    if (drawTiles.drawSurfaceTile(child, child.metanode, cameraPos, child.texelSize, priority, true, (depth > 0), checkGpu)) {\n                                        tile.childrenReadyCount++;\n                                        child.drawCounter = draw.drawCounter;\n                                        \n                                        drawBuffer[drawBufferIndex] = [child, false];\n                                        drawBufferIndex++;\n                                    } else {\n                                        newProcessBuffer[newProcessBufferIndex] = [child, depth];\n                                        newProcessBufferIndex++;\n                                    }\n                                }\n                            }\n                        }\n\n                        if (lastProcessBufferIndex == newProcessBufferIndex && lastDrawBufferIndex == drawBufferIndex) {\n                            depth--; \n                        }\n\n                    } else {\n                        tile.drawCounter = draw.drawCounter;\n\n                        drawBuffer[drawBufferIndex] = [tile, false];\n                        drawBufferIndex++;\n                    }\n                    \n                } else if (depth == 0 && node.hasGeometry() && tile.texelSize <= (texelSizeFit * 2)) {\n                    \n                    //are all children ready? if not then draw carser lod\n                    var childrenCount = 0;\n                    var readyCount = 0;\n                    var childrenBuffer = [];\n        \n                    for (j = 0; j < 4; j++) {\n                        child = tile.children[j];\n                        if (child) {\n                            childrenCount++;\n       \n                            if (child.isMetanodeReady(this, child.id[0])) { //lod is used as priority\n\n                                this.updateNodeHeightExtents(child, child.metanode);\n                                child.updateTexelSize();\n                                \n                                priority = ((child.id[0] + lodShift) * typeFactor) * child.distance; \n                               \n                                //are draw buffers ready? preventRender=true, preventLoad=true\n                                if (drawTiles.drawSurfaceTile(child, child.metanode, cameraPos, child.texelSize, priority, true, true, checkGpu)) {\n                                    readyCount++;\n                                    childrenBuffer.push(child);\n                                }\n                            }\n                        }\n                    }\n        \n                    if (childrenCount > 0 && childrenCount == readyCount) {\n                        //sort children by distance\n    \n                        do {\n                            var sorted = true;\n                            \n                            for (j = 0, lj = childrenBuffer.length - 1; j < lj; j++) {\n                                if (childrenBuffer[j].distance > childrenBuffer[j+1].distance) {\n                                    var t = childrenBuffer[j];\n                                    childrenBuffer[j] = childrenBuffer[j+1];\n                                    childrenBuffer[j+1] = t;\n                                    sorted = false;\n                                } \n                            }\n                            \n                        } while(!sorted);\n    \n                        //add children to new process buffer \n                        for (j = 0, lj = childrenBuffer.length; j < lj; j++) {\n                            newProcessBuffer[newProcessBufferIndex] = [childrenBuffer[j], depth];\n                            newProcessBufferIndex++;\n                        }\n                    } else {\n                        \n                        //can i use coarser lod\n                        priority = ((tile.id[0] + lodShift) * typeFactor) * tile.distance; \n\n                        if (drawTiles.drawSurfaceTile(tile, tile.metanode, cameraPos, tile.texelSize, priority, true, true, checkGpu)) {\n                            tile.drawCounter = draw.drawCounter;\n\n                            drawBuffer[drawBufferIndex] = [tile, false];\n                            drawBufferIndex++;\n\n                            for (j = 0; j < 4; j++) {\n                                child = tile.children[j];\n                                if (child) {\n                                    if (child.isMetanodeReady(this, child.id[0])) { //lod is used as priority\n                                        priority = ((child.id[0] + lodShift) * typeFactor) * child.distance; \n                                        drawTiles.drawSurfaceTile(child, child.metanode, cameraPos, child.texelSize, priority, true, false, checkGpu);\n                                    }\n                                }\n                            }\n\n                        } else {\n\n                            //add children to new process buffer \n                            for (j = 0; j < 4; j++) {\n                                child = tile.children[j];\n                                if (child) {\n                                    if (child.isMetanodeReady(this, child.id[0])) { //lod is used as priority\n                                        this.updateNodeHeightExtents(child, child.metanode);\n                                        child.updateTexelSize();\n\n                                        newProcessBuffer[newProcessBufferIndex] = [child, depth];\n                                        newProcessBufferIndex++;\n                                    }\n                                }\n                            }\n\n                        } \n                    }\n\n                }  else  {  //go deeper\n                    \n                    \n                    for (j = 0; j < 4; j++) {\n                        child = tile.children[j];\n                        if (child) {\n\n                            if (child.isMetanodeReady(this, child.id[0])) { //lod is used as priority\n                                this.updateNodeHeightExtents(child, child.metanode);\n                                child.updateTexelSize();\n                                \n                                newProcessBuffer[newProcessBufferIndex] = [child, depth];\n                                newProcessBufferIndex++;\n                            }\n                        }\n                    }                    \n                }\n            }\n\n\n            if (drawGrid && lastProcessBufferIndex == newProcessBufferIndex && lastDrawBufferIndex == drawBufferIndex) {\n                parent = tile;\n\n                //make sure that we draw grid with lowest possible detail \n                parent2 = parent.parent;                    \n\n                if (parent.id[0] > 3 && depth !=0 && parent2 && parent2.childrenReadyCount == 0) {\n                    children2 = parent2.children;\n\n                    if (!(depth >= 1 && parent.parent && ((children2[0] && children2[0].childrenReadyCount != 0) || \n                         (children2[1] && children2[1].childrenReadyCount != 0) ||\n                         (children2[2] && children2[2].childrenReadyCount != 0) ||\n                         (children2[3] && children2[3].childrenReadyCount != 0)))) {\n                        parent = parent.parent;\n                    }\n                }\n\n                //make sure that grid tile is rendered only one time\n                if (parent && parent.drawCounter != draw.drawCounter) { \n                    parent.drawCounter = draw.drawCounter;\n\n                    drawBuffer[drawBufferIndex] = [parent, true]; //draw grid\n                    drawBufferIndex++;\n                    grids = true;\n                }\n            }\n\n        }\n\n        /*if (this.map.drawIndices) {\n            console.log(\"processed end==============================================\");\n        }*/\n        \n        var tmp = processBuffer;\n        processBuffer = newProcessBuffer;\n        newProcessBuffer = tmp;\n        processBufferIndex = newProcessBufferIndex;\n        \n    } while(processBufferIndex > 0);\n\n    if (storeTilesOnly) {\n        this.storeDrawBufferGeometry(drawBufferIndex);\n        return;\n    }\n\n    var stats = map.stats;\n\n    stats.usedNodes = usedNodes;    \n    stats.processedNodes = pocessedNodes;    \n    stats.processedMetatiles = pocessedMetatiles;    \n\n    this.processDrawBuffer(draw, drawTiles, cameraPos, map, stats, drawGrid, grids, replay, drawBuffer, drawBufferIndex);\n};\n\n\n//loadmode = downtop\nMapSurfaceTree.prototype.drawSurfaceDownTop = function(shift, storeTilesOnly) {\n    this.counter++;\n\n    var map = this.map;\n    var cameraPos = map.camera.position;\n    var tile = this.surfaceTree;\n\n    if (!tile.isMetanodeReady(this, 0)) {\n        return;\n    }\n\n    tile.updateTexelSize();\n\n    var root = tile;\n    var node = tile.metanode;\n\n    if (!tile.bboxVisible(tile.id, node.bbox, cameraPos, node)) {\n        return;\n    }\n\n    //var drawBufferIndex2 = this.drawSurfaceFitOnly(shift, true, true);\n    //if (drawBufferIndex2 == 0) {\n      //  return;\n    //}\n\n    var draw = map.draw;\n    var drawTiles = draw.drawTiles;\n    var drawBuffer = draw.drawBuffer;\n    var drawBuffer2 = draw.drawBuffer2;\n    var drawBufferIndex = 0;\n    var grids = false; \n    var texelSizeFit = draw.texelSizeFit;    \n    var tilesToLoad = 0, priority, parent, child;\n\n    var processBuffer = draw.processBuffer;\n    var newProcessBuffer = draw.processBuffer2;\n    var processBufferIndex = 0;\n    var newProcessBufferIndex = 0;\n    \n    processBuffer[0] = tile;\n    processBufferIndex = 1;\n\n    var texelSizeFit = draw.texelSizeFit;\n\n    draw.drawCounter++;\n    \n    var replay = map.draw.replay;\n    var storeNodes = replay.storeNodes || replay.storeFreeNodes;\n    var storeNodesBuffer = replay.nodeBuffer; \n\n    var usedNodes = 1;\n    var pocessedNodes = 1;\n    var pocessedMetatiles = 1;  \n    var drawCounter = draw.drawCounter, i, j, lj;\n    var grids = false, item, hit; \n    \n    do {\n        var best = 0;\n        newProcessBufferIndex = 0;\n       \n        for (i = processBufferIndex - 1; i >= 0; i--) {\n            tile = processBuffer[i];\n            node = tile.metanode;\n\n            if (node) {\n                pocessedNodes++;\n                if (node.metatile.drawCounter != drawCounter) {\n                    node.metatile.drawCounter = drawCounter;\n                    pocessedMetatiles++;\n                }\n            }\n\n            if (tile.bboxVisible(tile.id, node.bbox, cameraPos, node)) {\n\n                usedNodes++;\n\n                if (storeNodes) { //used only for inspector\n                    storeNodesBuffer.push(tile);\n                }\n\n                if (tile.texelSize  != Number.POSITIVE_INFINITY){\n                    if (tile.texelSize > best) {\n                        best = tile.texelSize;\n                    }\n                }\n                \n                if (/*node.hasGeometry() && */tile.texelSize <= texelSizeFit) {\n                   \n                    tile.drawCounter = drawCounter;\n                    drawBuffer[drawBufferIndex] = tile;\n                    drawBufferIndex++;\n                    \n                } else { //go deeper\n\n                    var childrenCount = 0;\n                    var nodesReadyCount = 0;\n                    var childrenBuffer = [];\n        \n                    for (j = 0; j < 4; j++) {\n                        var child = tile.children[j];\n                        if (child) {\n                            childrenCount++;\n       \n                            if (child.isMetanodeReady(this, child.id[0])) { //lod is used as priority\n\n                                this.updateNodeHeightExtents(child, child.metanode);\n                                child.updateTexelSize();\n\n                                childrenBuffer.push(child);\n                                nodesReadyCount++;\n\n                            } /*else if (useDrawBufferOnly) { //used in downtop\n                                //drawBuffer[drawBufferIndex] = [child, true];\n                                //drawBufferIndex++;\n                            }*/\n                        }\n                    }\n        \n                    if (childrenCount > 0 && (childrenCount == nodesReadyCount)) {\n                        //sort children by distance\n    \n                        do {\n                            var sorted = true;\n                            \n                            for (j = 0, lj = childrenBuffer.length - 1; j < lj; j++) {\n                                if (childrenBuffer[j].distance > childrenBuffer[j+1].distance) {\n                                    var t = childrenBuffer[j];\n                                    childrenBuffer[j] = childrenBuffer[j+1];\n                                    childrenBuffer[j+1] = t;\n                                    sorted = false;\n                                } \n                            }\n                            \n                        } while(!sorted);\n    \n                        //add childrn to new process buffer \n                        for (j = 0, lj = childrenBuffer.length; j < lj; j++) {\n\n                            newProcessBuffer[newProcessBufferIndex] = childrenBuffer[j];\n                            newProcessBufferIndex++;\n                        }\n                    } else {\n                        tile.drawCounter = drawCounter;\n                        drawBuffer[drawBufferIndex] = [tile,true];\n                        drawBufferIndex++;\n                    }\n                    \n                }\n            }\n        }\n        \n        var tmp = processBuffer;\n        processBuffer = newProcessBuffer;\n        newProcessBuffer = tmp;\n        processBufferIndex = newProcessBufferIndex;\n        \n    } while(processBufferIndex > 0);\n\n    if (drawBufferIndex == 0) {\n        return;\n    }\n\n    var tmp = draw.drawBuffer2;\n    draw.drawBuffer2 = draw.drawBuffer;\n    draw.drawBuffer = tmp;\n\n    drawBuffer = draw.drawBuffer;\n    var drawBuffer2 = draw.drawBuffer2;\n    var drawBufferIndex2 = drawBufferIndex;\n    drawBufferIndex = 0;\n\n    //draw.drawCounter++;\n    //drawCounter++;\n\n    var lodShift = 4;\n    var typeFactor = 2000;\n\n    if (this.freeLayerSurface) {\n        lodShift = 0;\n        typeFactor = 0.1;\n    }    \n\n    var findLoadedParent = (function(){\n\n        //TODO: NEW RULES\n            // search parent\n               // if exist load from parent down (there can be configurable limit e.g. max 3 lods up)\n               // if not exist (root) load only fit lod\n\n\n        var hasLoadedParent = false;\n\n        if (/*tile.texelSize != 1 && tile.texelSize <= texelSizeFit &&*/ tile != root) {\n            parent = tile.parent;\n\n            while (parent != root) {\n                priority = ((parent.id[0] + lodShift) * typeFactor);\n\n                // preventRender=true, preventLoad=true, checkGpu = false\n                if (drawTiles.drawSurfaceTile(parent, parent.metanode, cameraPos, parent.texelSize, priority, true, true, false)) {\n                    //render parent\n                    drawBuffer[drawBufferIndex] = [parent, false];\n                    parent.drawCounter = drawCounter;\n                    hasLoadedParent = true;\n\n                    //load children\n                    for (var j = 0; j < 4; j++) {\n                        child = parent.children[j];\n                        if (child) {\n                            if (child.isMetanodeReady(this, child.id[0])) { //lod is used as priority\n                                // preventRender=true, preventLoad=false, checkGpu = false\n                                if (!drawTiles.drawSurfaceTile(child, child.metanode, cameraPos, child.texelSize, priority, true, false, false)) {\n                                    tilesToLoad++;\n                                }\n                            }\n                        }\n                    }\n\n                    break;\n                }\n\n                parent = parent.parent;\n            }\n\n\n            if (!hasLoadedParent) {\n                priority = ((tile.id[0] + lodShift) * typeFactor);\n\n                // preventRender=true, preventLoad=false, checkGpu = false\n                if (!drawTiles.drawSurfaceTile(tile, tile.metanode, cameraPos, tile.texelSize, priority, true, false, false)) {\n                    drawBuffer[drawBufferIndex] = [tile, true];\n                    tile.drawCounter = drawCounter;\n                    tilesToLoad++;\n                } else {\n                    drawBuffer[drawBufferIndex] = [tile, false];\n                    tile.drawCounter = drawCounter;\n                }\n            }\n        }\n\n\n    });\n\n\n    //draw surface\n    for (i = drawBufferIndex2 - 1; i >= 0; i--) {\n        item = drawBuffer2[i];\n        //tile = (noGrid) ? item : item[0];\n\n        if (item[1]) {\n            tile = item[0];\n\n            if (!tile.isMetanodeReady(this, tile.id[0])) { //lod is used as priority\n                continue;\n            }\n\n            drawBuffer[drawBufferIndex] = [tile, true];\n            grids = true; \n            priority = 20;\n\n            //TODO: search parents\n                // if parent exist render parent (limit parent level?), load children, \n                // remove parent children from draw buffer?\n\n            //if (!node.hasChildren() || ) {\n\n            findLoadedParent();\n\n        } else {\n            tile = item;\n            node = tile.metanode;\n            drawBuffer[drawBufferIndex] = [tile, false];\n            priority = ((tile.id[0] + lodShift) * typeFactor);\n           \n            //are draw buffers ready? preventRender=true, preventLoad=false, checkGpu = false\n            if (!drawTiles.drawSurfaceTile(tile, tile.metanode, cameraPos, tile.texelSize, priority, true, false, false)) {\n\n                findLoadedParent();\n\n                tilesToLoad++;\n            } else {\n                tile.drawCounter = drawCounter;\n            }\n        }\n\n        drawBufferIndex++;\n    }\n\n\n    //filter out children\n    var tmp = drawBuffer2;\n    drawBuffer2 = drawBuffer;\n    drawBuffer = tmp;\n\n    var drawBufferIndex2 = drawBufferIndex;\n    drawBufferIndex = 0;\n\n    for (i = 0; i < drawBufferIndex2; i++) {\n        item = drawBuffer2[i];\n\n        tile = item[0];\n        hit = false;\n\n        if (tile != root) {\n            parent = tile.parent;\n\n            while (parent != root) {\n\n                if (parent.drawCounter == drawCounter) {\n                    hit = true;\n                    break;\n                }\n\n                parent = parent.parent;\n            }\n        }\n\n        if (!hit) {\n            drawBuffer[drawBufferIndex] = drawBuffer2[i];\n            drawBufferIndex++;\n        }\n    }\n  \n\n    //TODO: if everything loaded then load parents\n        // use drawCounter as optimization \n\n    if (tilesToLoad == 0) {\n\n        for (i = 0; i < drawBufferIndex; i++) {\n            item = drawBuffer[i];\n\n            tile = item[0];\n            hit = false;\n\n            if (tile != root) {\n                parent = tile.parent;\n\n                while (parent != root) {\n\n                    priority = (((100-tile.id[0]) + lodShift) * typeFactor);\n\n                    //are draw buffers ready? preventRender=true, preventLoad=false, checkGpu = false\n                    if (!drawTiles.drawSurfaceTile(parent, parent.metanode, cameraPos, parent.texelSize, priority, true, false, false)) {\n                        break;\n                    }\n\n                    parent = parent.parent;\n                }\n            }\n\n        }\n\n    }\n\n\n    //if (/*node.hasGeometry() && */tile.texelSize <= texelSizeFit) {\n\n    var stats = map.stats;\n    var draw = map.draw;\n    var drawTiles = draw.drawTiles;\n    var replay = draw.replay;\n\n    var geodata = tile.surface ? tile.surface.geodata : null;\n    var free = tile.surface ? tile.surface.free : null;\n    var drawGrid = (!geodata && !free && map.config.mapHeightfiledWhenUnloaded);\n\n    //stats.usedNodes = usedNodes;    \n    //stats.processedNodes = pocessedNodes;    \n    //stats.processedMetatiles = pocessedMetatiles;    \n\n    this.processDrawBuffer(draw, drawTiles, cameraPos, map, stats, drawGrid, grids, replay, drawBuffer, drawBufferIndex);\n};\n\n\nMapSurfaceTree.prototype.processDrawBuffer = function(draw, drawTiles, cameraPos, map, stats, drawGrid, grids, replay, drawBuffer, drawBufferIndex, noGrid) {\n\n    if (replay.storeTiles || replay.storeFreeTiles) { //used only in inspectors\n        if (!draw.tileBuffer[0]) {\n            draw.tileBuffer[0] = [];\n        }\n        \n        var tiles = draw.tileBuffer[0];\n        for (i = drawBufferIndex - 1; i >= 0; i--) {\n            tiles.push(drawBuffer[i]);\n        }\n    }\n\n    var scanExtents = (!this.freeLayerSurface && map.config.mapFeatureStickMode[0] == 2); // && this.freeLayerSurface.geodata && draw.drawChannel == 0);\n    var hmax = -999999, hmin = 999999;\n    var renderer = map.renderer;\n    var mvp = this.camera.getMvpMatrix(), p1, p2, camVec, length, tilt, factor, i, tile, node; \n\n    map.gpuCache.skipCostCheck = true;\n\n    var underSurfaceGrid = (drawGrid && map.config.mapGridUnderSurface > 0 && grids);\n    \n    if (underSurfaceGrid) {\n        //draw only grid\n        for (i = drawBufferIndex - 1; i >= 0; i--) {\n            drawBuffer[i][0].drawGrid(cameraPos); \n        }\n\n        //clear zbuffer\n        map.renderer.gpu.clear(true, false);\n    }\n\n    //draw surface\n    for (i = drawBufferIndex - 1; i >= 0; i--) {\n        var item = drawBuffer[i];\n        tile = (noGrid) ? item : item[0];\n        node = tile.metanode;\n\n        if (scanExtents && node) {\n            // TODO noramlize by distance and tilt\n\n            p2 = node.diskPos;\n            p1 = renderer.cameraPosition;\n            camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n            length = vec3.normalize4(camVec);\n            tilt = -vec3.dot(camVec, node.diskNormal);\n\n            if (tilt < 0) {\n                tilt = 0;\n            }\n\n            tilt = 1 - tilt;\n\n            factor = (renderer.camera.fovDist / length) * tilt;\n            //renderer.camera.scaleFactor2(d) * screenPixelSize\n            //pp = this.renderer.project2(tile.diskPos, mvp);                \n\n            if (node.minZ * factor < hmin) {\n                hmin = node.minZ * factor;\n            }\n\n            if (node.maxZ * factor > hmax) {\n                hmax = node.maxZ * factor;\n            }\n        }\n\n\n        if (noGrid)  {\n\n            if (stats.gpuRenderUsed >= draw.maxGpuUsed)  {\n                break;\n            }\n\n            //draw tile,  preventRender=false, preventLoad=false\n            drawTiles.drawSurfaceTile(tile, tile.metanode, cameraPos, tile.texelSize, 0, false, false);\n\n        } else {\n\n            if (underSurfaceGrid) {\n\n                if (!item[1] && !(stats.gpuRenderUsed >= draw.maxGpuUsed))  {\n                    drawTiles.drawSurfaceTile(tile, tile.metanode, cameraPos, tile.texelSize, 0, false, false /*, checkGpu*/);\n                } else {\n                    if (drawTiles.debug.drawBBoxes) {\n                        drawTiles.drawTileInfo(tile, tile.metanode, cameraPos);\n                    }\n                }\n\n            } else {\n\n                if ((drawGrid && item[1]) || stats.gpuRenderUsed >= draw.maxGpuUsed)  {\n\n                    if (drawTiles.debug.drawBBoxes) {\n                        drawTiles.drawTileInfo(tile, tile.metanode, cameraPos);\n                    }\n\n                    tile.drawGrid(cameraPos); \n                } else if (!item[1]) {\n                    drawTiles.drawSurfaceTile(tile, tile.metanode, cameraPos, tile.texelSize, 0, false, false /*, checkGpu*/);\n                }\n            }\n\n        }\n    }\n\n    if (scanExtents) {\n        renderer.gridHmax = hmax;\n        renderer.gridHmin = hmin;\n    }\n\n    map.gpuCache.skipCostCheck = false;\n    map.gpuCache.checkCost();\n\n};\n\n\n\nMapSurfaceTree.prototype.storeDrawBufferGeometry = function(drawBufferIndex) {\n    var map = this.map;\n    var drawBuffer = map.draw.drawBuffer;\n\n    this.storeGeometry(drawBuffer, drawBufferIndex);\n};\n\n\nMapSurfaceTree.prototype.storeGeometry = function(array, length) {\n    var map = this.map;\n    var drawBuffer = array;\n    map.storedTilesRes = new Array(length);        \n\n    for (var i = length - 1; i >= 0; i--) {\n        var tile = drawBuffer[i];\n\n        if (tile.metanode && tile.surface && tile.metanode.hasGeometry() &&\n            tile.surfaceMesh && tile.surfaceMesh.isReady(true, 0, true)) {\n\n            var mesh = tile.surfaceMesh;\n            var submeshes = [];\n\n            for (var j = 0, lj = mesh.submeshes.length; j < lj; j++) {\n                var submesh = mesh.submeshes[j],\n                    vertices = submesh.vertices.slice(),\n                    min = submesh.bbox.min,\n                    max = submesh.bbox.max,\n                    delta = [max[0] - min[0], max[1] - min[1], max[2] - min[2]];\n\n                for (var k = 0, lk = vertices.length; k < lk; k+=3) {\n                    vertices[k] = vertices[k]*delta[0] + min[0];\n                    vertices[k+1] = vertices[k+1]*delta[1] + min[1];\n                    vertices[k+2] = vertices[k+2]*delta[2] + min[2];\n                }\n\n                submeshes.push({ \n                    \"bbox\": [min.slice(), max.slice()],\n                    \"vertices\" : vertices });\n            }\n\n            map.storedTilesRes[i] = {\n                \"id\": tile.id.slice(),\n                \"type\": \"mesh\",\n                \"submeshes\": submeshes\n            };\n        }\n    }\n};\n\n\nMapSurfaceTree.prototype.traceHeight = function(tile, params, nodeOnly) {\n    if (!tile) {\n        return;\n    }\n\n    this.params = params;\n\n    var heightFunction = nodeOnly ? this.traceHeightTileByNodeOnly : this.traceHeightTileByMap;  \n\n    if (tile.id[0] == 1) { //update root, get height in VTS2015 starts in division node which has lod 1\n        this.traceHeightTile(tile.parent, 0, true);\n        if (!tile.parent.metanode) {\n            return;\n        }\n    }\n    \n    this.traceHeightTile(tile, 0, false, heightFunction);\n};\n\n\nMapSurfaceTree.prototype.traceHeightTile = function(tile, priority, nodeReadyOnly, heightFunction) {\n    if (tile == null) {\n        return;\n    }\n\n    if (!tile.isMetanodeReady(this, 0) || nodeReadyOnly) {\n        this.params.waitingForNode = true;\n        return;\n    }\n\n    tile.metanode.metatile.used();\n\n    if (tile.lastSurface && tile.lastSurface == tile.surface) {\n        tile.lastSurface = null;\n        tile.restoreLastState();\n        //return;\n    }\n    \n    //process tile e.g. draw or get height\n    var res = heightFunction(tile, this.params, priority); \n    \n    if (res) { //we need to go deeper\n        var childIndex = this.traceHeightChild(tile, this.params);\n        var child = tile.children[childIndex];\n        \n        if (!child) {\n            this.params.finalNode = true;\n        }\n\n        this.traceHeightTile(child, 0, false, heightFunction);\n    }\n};\n\n\nMapSurfaceTree.prototype.traceHeightChild = function(tile, params) {\n    var coords = params.coords;\n    var extents = params.extents;\n    var center = [(extents.ll[0] + extents.ur[0]) *0.5,\n        (extents.ll[1] + extents.ur[1]) *0.5];\n\n    //ul,ur,ll,lr\n    //deside in which quadrant are provided coodinates\n    var right = (coords[0] >= center[0]);\n    var bottom = (coords[1] >= center[1]);\n\n    if (right) {\n        extents.ll[0] = center[0];\n        if (bottom) {\n            extents.ll[1] = center[1];\n        } else {\n            extents.ur[1] = center[1];\n        }\n    } else {\n        extents.ur[0] = center[0];\n        if (bottom) {\n            extents.ll[1] = center[1];\n        } else {\n            extents.ur[1] = center[1];\n        }\n    }\n\n    /*\n    if (extents.ll[0] > extents.ur[0]) {\n        right = !right;\n    }\n\n    if (extents.ll[1] < extents.ur[1]) {\n        bottom = !bottom;\n    }*/\n\n    //trace only resulting quadrant \n    if (right) {\n        return bottom ? 1 : 3;\n    } else {\n        return bottom ? 0 : 2;\n    }\n};\n\n\nMapSurfaceTree.prototype.traceHeightTileByMap = function(tile, params) {\n    if (!tile || (tile.id[0] > params.desiredLod && params.heightMap)) {\n        return false;\n    }\n\n    var node = tile.metanode;\n\n    if (!node) {\n        return false;\n    }\n\n    if (node.hasNavtile()) {\n        params.bestHeightMap = tile.id[0];\n\n        if (!tile.heightMap) {\n            //if (!preventLoad) {\n                //if (!tile.surface || tile.surface.virtual) {\n            if (!tile.surface || !tile.resourceSurface) { //surface.virtual) {\n                return false; //is it best way how to do it?\n            }\n                \n            if (!tile.resourceSurface.getNavUrl) { //virtual surface is as resource surface. Is it bug??!!\n                return false; //is it best way how to do it?\n            }\n                \n            var path = tile.resourceSurface.getNavUrl(tile.id);\n            tile.heightMap = tile.resources.getTexture(path, true);\n            //}\n        } else {\n            if (tile.heightMap.isReady(null, null, true)) {\n                params.parent = {\n                    metanode : params.metanode,\n                    heightMap : params.heightMap,\n                    heightMapExtents : params.heightMapExtents\n                };\n                \n                params.metanode =  node;\n                params.heightMap = tile.heightMap;\n                params.heightMapExtents = {\n                    ll : params.extents.ll.slice(),\n                    ur : params.extents.ur.slice()\n                };\n                return (tile.id[0] != params.desiredLod);\n            }\n        }\n    } else {\n        if (!params.heightMap) {\n            params.metanode =  node;\n        }\n        \n        return true;\n    }\n\n    return false;\n};\n\n\nMapSurfaceTree.prototype.traceHeightTileByNodeOnly = function(tile, params) {\n    if (!tile || tile.id[0] > params.desiredLod) {\n        return false;\n    }\n\n    var node = tile.metanode;\n\n    if (!node) {\n        return false;\n    }\n\n    params.parent = {\n        metanode : params.metanode\n    };\n\n    params.metanode =  node;\n    return (tile.id[0] != params.desiredLod);\n};\n\n\nMapSurfaceTree.prototype.getNodeById = function(id, preventLoad) {\n    var tile = this.surfaceTree;\n\n    if (tile == null) {\n        return;\n    }\n\n    for (var lod = id[0]; lod > 0; lod--) {\n        var mask = 1 << (lod-1);\n        var index = 0;\n\n        if ((id[1] & mask) != 0) {\n            index += 1;\n        }\n\n        if ((id[2] & mask) != 0) {\n            index += 2;\n        }\n        \n        if (!tile.children[index]) {\n\n            if (!tile.isMetanodeReady(this, 0, preventLoad)) {\n                return null;\n            }\n\n            if (!tile.metanode.hasChild(index)) {\n                return null;\n            }\n\n            tile.addChild(index);\n        } \n\n        tile = tile.children[index];\n    }\n\n    if (!tile) {\n        return;\n    }\n\n    if (!tile.isMetanodeReady(this, 0, preventLoad)) {\n        return;\n    }\n\t\n    var node = tile.metanode;\n    tile.metanode.metatile.used();\n\n    return node;\n\n\t/*\n    if (tile.lastSurface && tile.lastSurface == tile.surface) {\n        tile.lastSurface = null;\n        tile.restoreLastState();\n        //return;\n    }*/\n};\n\n\nMapSurfaceTree.prototype.getRenderedNodeById = function(id, drawCounter) {\n    var tile = this.surfaceTree;\n\n    if (tile == null) {\n        return;\n    }\n\n    if (tile.drawCounter == drawCounter) {\n        if (!tile.isMetanodeReady(this, 0)) {\n            return;\n        }\n\n        return tile.metanode;\n    }\n\n    for (var lod = id[0]; lod > 0; lod--) {\n        var mask = 1 << (lod-1);\n        var index = 0;\n\n        if ((id[1] & mask) != 0) {\n            index += 1;\n        }\n\n        if ((id[2] & mask) != 0) {\n            index += 2;\n        }\n        \n        if (!tile.children[index]) {\n\n            if (!tile.isMetanodeReady(this, 0)) {\n                return;\n            }\n\n            if (!tile.metanode.hasChild(index)) {\n                return;\n            }\n        } \n\n        tile = tile.children[index];\n\n        if (tile.drawCounter == drawCounter) {\n            if (!tile.isMetanodeReady(this, 0)) {\n                return;\n            }\n\n            return tile.metanode;\n        } else {\n            if (lod == 1) { //rendered lod is probably from more detailed lod so we take one which is from same lod\n                return tile.metanode;\n            }\n        }\n    }\n\n    return;\n};\n\n\nMapSurfaceTree.prototype.chekTileMesh = function(tile) {\n    if (this.params.loadMeshes || this.params.loadTextures) {\n\n        var tmp = this.config.mapNoTextures;\n        this.config.mapNoTextures = !this.params.loadTextures;\n\n        //are resources ready? priority=0, preventRender=true, preventLoad=false, doNotCheckGpu=true\n        if (!this.map.draw.drawTiles.drawSurfaceTile(tile, tile.metanode, this.map.renderer.cameraPosition, tile.texelSize, 0, true, false, true)) {\n            this.params.loaded = false;\n        }\n\n        this.config.mapNoTextures = tmp;\n    }\n};\n\n\nMapSurfaceTree.prototype.traceAreaTiles = function(tile, priority, nodeReadyOnly) {\n    if (tile == null) {\n        return;\n    }\n\n    if (!tile.isMetanodeReady(this, 0) || nodeReadyOnly) {\n        this.params.loaded = false;\n        //console.log('(L)' + JSON.stringify(tile.id));\n        tile.isMetanodeReady(this, 0);\n        return;\n    }\n\n    tile.metanode.metatile.used();\n\n    if (tile.lastSurface && tile.lastSurface == tile.surface) {\n        tile.lastSurface = null;\n        tile.restoreLastState();\n        //return;\n    }\n\n    if (!tile.insideCone(this.params.coneVec, this.params.coneAngle, tile.metanode)) {\n        return;\n    }\n\n    var fit = (this.params.mode == 'lod') ? (tile.id[0] >= this.params.limit) : (tile.metanode.pixelSize <= this.params.limit);\n\n    if (fit) {\n        //console.log('(A)' + JSON.stringify(tile.id));\n        this.chekTileMesh(tile);\n        this.params.areaTiles.push(tile);\n        return;\n    }\n\n    if (!tile.metanode.hasChildren()) {\n        //console.log('(A)' + JSON.stringify(tile.id));\n        this.chekTileMesh(tile);\n        this.params.areaTiles.push(tile);\n    } else {\n        for (var i = 0; i < 4; i++) {\n            this.traceAreaTiles(tile.children[i], priority, nodeReadyOnly);\n        }\n    }\n};\n\n\n\nexport default MapSurfaceTree;\n","\nimport {utils as utils_} from '../utils/utils';\nimport GpuTexture_ from '../renderer/gpu/texture';\n\n//get rid of compiler mess\nvar utils = utils_;\nvar GpuTexture = GpuTexture_;\n\n\nvar MapSubtexture = function(map, path, type, tile, internal) {\n    this.map = map;\n    this.stats = map.stats;\n    this.tile = tile; // used only for stats\n    this.internal = internal; // used only for stats\n    this.image = null;\n    this.imageData = null;\n    this.imageExtents = null;\n    this.gpuTexture = null;\n    this.loadState = 0;\n    this.loadErrorTime = null;\n    this.loadErrorCounter = 0;\n    this.neverReady = false;\n    this.mapLoaderUrl = path;\n    this.type = type || false;\n    this.statsCounter = 0;\n    this.checkStatus = 0;\n    this.checkType = null;\n    this.checkValue = null;\n    this.fastHeaderCheck = false;\n    this.gpuSize = 0;\n    this.fileSize = 0;\n    this.cacheItem = null; //store killImage\n    this.gpuCacheItem = null; //store killGpuTexture\n};\n\n\nMapSubtexture.prototype.kill = function() {\n    this.killImage();\n    this.killGpuTexture();\n    \n    if (this.mask) {\n        this.mask.killImage(); \n        this.mask.killGpuTexture(); \n    }\n    \n    //this.tile.validate();\n};\n\n\nMapSubtexture.prototype.killImage = function(killedByCache) {\n    this.image = null;\n    this.imageData = null;\n\n    if (killedByCache !== true && this.cacheItem) {\n        this.map.resourcesCache.remove(this.cacheItem);\n        //this.tile.validate();\n    }\n\n    if (this.mask) {\n        this.mask.killImage(); \n    }\n\n    if (!this.gpuTexture) {\n        this.loadState = 0;\n    } //else {\n        //this.loadState = this.loadState;\n    //}\n\n    this.cacheItem = null;\n};\n\n\nMapSubtexture.prototype.killGpuTexture = function(killedByCache) {\n/*\n    //debug only    \n    if (!this.map.lastRemoved) {\n        this.map.lastRemoved = [];\n    }\n\n    //debug only    \n    if (this.map.lastRemoved.indexOf(this.mapLoaderUrl) != -1) {\n        console.log(\"tex: \" + this.mapLoaderUrl);\n    }\n\n    //debug only    \n    this.map.lastRemoved.unshift(this.mapLoaderUrl);\n    this.map.lastRemoved = this.map.lastRemoved.slice(0,20);\n*/\n\n    if (this.gpuTexture != null) {\n        this.stats.gpuTextures -= this.gpuTexture.size;\n        this.gpuTexture.kill();\n\n        this.stats.graphsFluxTexture[1][0]++;\n        this.stats.graphsFluxTexture[1][1] += this.gpuTexture.size;\n\n        if (this.mask) {\n            this.mask.killGpuTexture(); \n        }\n    }\n\n    this.gpuTexture = null;\n\n    if (killedByCache !== true && this.gpuCacheItem) {\n        this.map.gpuCache.remove(this.gpuCacheItem);\n        //this.tile.validate();\n    }\n\n    if (!this.image && !this.imageData) {\n        this.loadState = 0;\n    }\n\n    this.gpuCacheItem = null;\n};\n\n\nMapSubtexture.prototype.isReady = function(doNotLoad, priority, doNotCheckGpu, texture) {\n    var doNotUseGpu = (this.map.stats.gpuRenderUsed >= this.map.draw.maxGpuUsed);\n    doNotLoad = doNotLoad || doNotUseGpu;\n    \n    if (this.neverReady) {\n        return false;\n    }\n\n    switch (texture.checkType) {\n    case VTS_TEXTURECHECK_TYPE:\n    case VTS_TEXTURECHECK_CODE:\n    case VTS_TEXTURECHECK_SIZE:\n        \n        if (this.checkStatus != 2) {\n            this.checkType = texture.checkType;\n            this.checkValue = texture.checkValue;\n\n            if (this.checkStatus == 0) {\n                this.scheduleHeadRequest(priority, (this.checkType == VTS_TEXTURECHECK_SIZE));\n            } else if (this.checkStatus == 3) { //loadError\n                if (this.loadErrorCounter <= this.map.config.mapLoadErrorMaxRetryCount &&\n                        performance.now() > this.loadErrorTime + this.map.config.mapLoadErrorRetryTime) {\n                    this.scheduleHeadRequest(priority, (this.checkType == VTS_TEXTURECHECK_SIZE));\n                }\n            } else if (this.checkStatus == -1) {\n            \n                if (texture.extraInfo) { //find at least texture with lower resolution\n                    if (!texture.extraBound) {\n                        texture.extraBound = { tile: texture.extraInfo.tile, layer: texture.extraInfo.layer};\n                        texture.setBoundTexture(texture.extraBound.tile.parent, texture.extraBound.layer);        \n                    }\n        \n                    while (texture.extraBound.texture.extraBound || texture.extraBound.texture.checkStatus == -1) {\n                        //while (texture.extraBound.texture.checkStatus == -1) {\n                        texture.setBoundTexture(texture.extraBound.sourceTile.parent, texture.extraBound.layer);        \n                    }\n                }\n            }\n    \n            return false;\n        }\n            \n        break;\n    }\n\n    if (this.loadState == 2) { //loaded\n        var t;\n\n        if (!doNotLoad && this.cacheItem) {\n            this.map.resourcesCache.updateItem(this.cacheItem);\n        }\n\n        /*\n        if (((this.type == VTS_TEXTURETYPE_HEIGHT && !this.imageData) || (this.type != VTS_TEXTURETYPE_HEIGHT && !this.gpuTexture)) &&\n              this.stats.renderBuild > this.map.config.mapMaxProcessingTime) {\n            //console.log(\"testure resource build overflow\");\n            this.map.markDirty();\n            return false;\n        }*/\n\n        if (doNotCheckGpu) {\n            if (this.type == VTS_TEXTURETYPE_HEIGHT) {\n                if (!this.imageData) {\n                    t = performance.now();\n                    this.buildHeightMap();\n                    this.stats.renderBuild += performance.now() - t; \n                }\n            }\n\n            return true;\n        }\n\n        if (this.type == VTS_TEXTURETYPE_HEIGHT) {\n            if (!this.imageData) {\n                t = performance.now();\n                this.buildHeightMap();\n                this.stats.renderBuild += performance.now() - t; \n            }\n        } else {\n            if (!this.gpuTexture) {\n                if (this.map.stats.gpuRenderUsed >= this.map.draw.maxGpuUsed) {\n                    return false;\n                }\n                \n                if (doNotUseGpu) {\n                    return false;\n                }\n\n                //if (this.stats.graphsFluxTexture [0][0] > 2) {\n                   // return false;\n                //}\n\n                t = performance.now();\n                this.buildGpuTexture();\n                this.stats.renderBuild += performance.now() - t; \n            }\n\n            if (!doNotLoad && this.gpuCacheItem) {\n                this.map.gpuCache.updateItem(this.gpuCacheItem);\n            }\n        }\n        \n        \n        return true;\n    } else {\n        if (this.loadState == 0) { \n            if (doNotLoad) {\n                //remove from queue\n                //if (this.mapLoaderUrl) {\n                    //this.map.loader.remove(this.mapLoaderUrl);\n                //}\n            } else {\n                //not loaded\n                //add to loading queue or top position in queue\n                this.scheduleLoad(priority);\n            }\n        } else if (this.loadState == 3) { //loadError\n            if (this.loadErrorCounter <= this.map.config.mapLoadErrorMaxRetryCount &&\n                performance.now() > this.loadErrorTime + this.map.config.mapLoadErrorRetryTime) {\n\n                this.scheduleLoad(priority);                    \n            }\n        } //else load in progress\n    }\n\n    return false;\n};\n\n\nMapSubtexture.prototype.scheduleLoad = function(priority, header) {\n    this.map.loader.load(this.mapLoaderUrl, this.onLoad.bind(this, header), priority, this.tile, this.internal ? 'texture-in' : 'texture-ex');\n};\n\n\nMapSubtexture.prototype.onLoad = function(header, url, onLoaded, onError) {\n    this.mapLoaderCallLoaded = onLoaded;\n    this.mapLoaderCallError = onError;\n\n    var onerror = this.onLoadError.bind(this);\n    var onload = this.onLoaded.bind(this);\n\n    if (header) {\n        this.checkStatus = 1;\n    } else {\n        this.loadState = 1;\n    }\n\n    if (this.map.config.mapXhrImageLoad) {\n        //utils.loadBinary(url, this.onBinaryLoaded.bind(this), onerror, (utils.useCredentials ? (this.mapLoaderUrl.indexOf(this.map.url.baseUrl) != -1) : false), this.map.core.xhrParams, 'blob');\n        this.map.loader.processLoadBinary(url, this.onBinaryLoaded.bind(this), onerror, null, 'texture');\n    } else {\n        this.image = utils.loadImage(url, onload, onerror, (this.map.core.tokenCookieHost ? (url.indexOf(this.map.core.tokenCookieHost) != -1) : false));\n    }\n    //mapXhrImageLoad\n};\n\n\nMapSubtexture.prototype.onLoadError = function(killBlob) {\n    if (this.map.killed){\n        return;\n    }\n\n    if (killBlob) {\n        window.URL.revokeObjectURL(this.image.src);\n    }\n\n    this.loadState = 3;\n    this.loadErrorTime = performance.now();\n    this.loadErrorCounter ++;\n    \n    //make sure we try to load it again\n    if (this.loadErrorCounter <= this.map.config.mapLoadErrorMaxRetryCount) { \n        setTimeout((function(){ if (!this.map.killed) { this.map.markDirty(); } }).bind(this), this.map.config.mapLoadErrorRetryTime);\n    }    \n    \n    this.mapLoaderCallError();\n};\n\n\nMapSubtexture.prototype.onBinaryLoaded = function(data, direct, filesize) {\n    if (this.fastHeaderCheck && this.checkType && this.checkType != VTS_TEXTURECHECK_MEATATILE) {\n        this.onHeadLoaded(null, data, null /*status*/);\n        \n        if (this.checkStatus == -1) {\n            this.mapLoaderCallLoaded();\n            return;\n        }\n    }\n\n    if (direct) {\n        this.onLoaded(false, data)\n        this.fileSize = filesize;\n        return;\n    }\n\n    this.fileSize = data.size;\n\n    if (this.map.config.mapAsyncImageDecode) {\n        createImageBitmap(data).then(this.onLoaded.bind(this, false));\n    } else {\n        var image = new Image();\n        image.onerror = this.onLoadError.bind(this, true, null);\n        image.onload = this.onLoaded.bind(this, true, null);\n        this.image = image;\n        image.src = window.URL.createObjectURL(data);\n    }\n};\n\n\nMapSubtexture.prototype.onLoaded = function(killBlob, bitmap) {\n    if (this.map.killed){\n        return;\n    }\n\n    if (killBlob) {\n        window.URL.revokeObjectURL(this.image.src);\n    }\n\n    if (bitmap) {\n        this.image = bitmap;\n        this.image.naturalWidth = bitmap.width;\n        this.image.naturalHeight = bitmap.height;\n    }\n\n    var size = this.image.naturalWidth * this.image.naturalHeight * (this.heightMap ? 3 : 3);\n    this.gpuSize = this.image.naturalWidth * this.image.naturalHeight * 4;  //aproximate size \n\n    //if (!this.image.complete) {\n       // size = size;\n    //}\n    \n    //console.log(size);\n\n    this.cacheItem = this.map.resourcesCache.insert(this.killImage.bind(this, true), size);\n\n    this.map.markDirty();\n    this.loadState = 2;\n    this.loadErrorTime = null;\n    this.loadErrorCounter = 0;\n    this.mapLoaderCallLoaded();\n};\n\n\nMapSubtexture.prototype.scheduleHeadRequest = function(priority, downloadAll) {\n    if (this.map.config.mapXhrImageLoad && this.fastHeaderCheck) {\n        this.scheduleLoad(priority, true);\n    } else {\n        this.map.loader.load(this.mapLoaderUrl, this.onLoadHead.bind(this, downloadAll), priority, this.tile, this.internal, this.internal ? 'texture-in' : 'texture-ex');\n    }\n};\n\n\nMapSubtexture.prototype.onLoadHead = function(downloadAll, url, onLoaded, onError) {\n    this.mapLoaderCallLoaded = onLoaded;\n    this.mapLoaderCallError = onError;\n\n    var onerror = this.onLoadHeadError.bind(this, downloadAll);\n    var onload = this.onHeadLoaded.bind(this, downloadAll);\n\n    this.checkStatus = 1;\n\n    if (downloadAll) {\n        //utils.loadBinary(url, onload, onerror, (utils.useCredentials ? (this.mapLoaderUrl.indexOf(this.map.url.baseUrl) != -1) : false), this.map.core.xhrParams, 'blob');\n        this.map.loader.processLoadBinary(url, onLoad, onerror, null, 'texture');\n    } else {\n        utils.headRequest(url, onload, onerror, (utils.useCredentials ? (this.mapLoaderUrl.indexOf(this.map.url.baseUrl) != -1) : false), this.map.core.xhrParams, 'blob');\n    }\n};\n\n\nMapSubtexture.prototype.onLoadHeadError = function() {\n    if (this.map.killed){\n        return;\n    }\n\n    this.checkStatus = 3;\n    this.loadErrorTime = performance.now();\n    this.loadErrorCounter ++;\n    \n    //make sure we try to load it again\n    if (this.loadErrorCounter <= this.map.config.mapLoadErrorMaxRetryCount) { \n        setTimeout((function(){ if (!this.map.killed) { this.map.markDirty(); } }).bind(this), this.map.config.mapLoadErrorRetryTime);\n    }    \n    \n    this.mapLoaderCallError();\n};\n\n\nMapSubtexture.prototype.onHeadLoaded = function(downloadAll, data, status) {\n    if (this.map.killed){\n        return;\n    }\n\n    this.checkStatus = 2;\n    this.loadErrorTime = null;\n    this.loadErrorCounter = 0;\n\n    if (this.map.config.mapXhrImageLoad && this.fastHeaderCheck) {\n\n        switch (this.checkType) {\n        case VTS_TEXTURECHECK_SIZE:\n            if (data) {\n                if (data.size == this.checkValue) {\n                    this.checkStatus = -1;\n                }\n            }\n            break;\n                \n        case VTS_TEXTURECHECK_TYPE:\n            if (data) {\n                if (data.type == this.checkValue) {\n                    this.checkStatus = -1;\n                }\n            }\n            break;\n                \n        case VTS_TEXTURECHECK_CODE:\n            if (status) {\n                if (this.checkValue.indexOf(status) != -1) {\n                    this.checkStatus = -1;\n                }\n            }\n            break;\n        }\n\n    } else {\n\n        switch (this.checkType) {\n        case VTS_TEXTURECHECK_SIZE:\n            if (data) {\n                if (data.byteLength == this.checkValue) {\n                    this.checkStatus = -1;\n                }\n            }\n            break;\n                \n        case VTS_TEXTURECHECK_TYPE:\n            if (data) {\n                //if (!data.indexOf) {\n                  //  data = data;\n                //}\n                    \n                if (data.indexOf(this.checkValue) != -1) {\n                    this.checkStatus = -1;\n                }\n            }\n            break;\n                \n        case VTS_TEXTURECHECK_CODE:\n            if (status) {\n                if (this.checkValue.indexOf(status) != -1) {\n                    this.checkStatus = -1;\n                }\n            }\n            break;\n        }\n        \n        this.mapLoaderCallLoaded();\n    }\n};\n\n\nMapSubtexture.prototype.buildGpuTexture = function () {\n    if (this.map.config.mapCheckTextureSize && (this.image.naturalWidth > 1024 || this.image.naturalHeight > 1024)) {\n        console.log('very large texture: ' + this.image.naturalWidth + 'x' + this.image.naturalHeight + ' ' + this.mapLoaderUrl);\n\n        var size = 16;\n        var data = new Uint8Array( size * size * 4 );\n\n        for (var i = 0; i < size; i++) {\n            for (var j = 0; j < size; j++) {\n                var index = (i*size+j)*4;\n                data[index] = 0;\n                data[index + 1] = 0;\n                data[index + 2] = 0;\n                data[index + 3] = 255;\n            }\n        }\n\n        this.gpuTexture = new GpuTexture(this.map.renderer.gpu);\n        this.gpuTexture.createFromData(size, size, data);\n        this.gpuTexture.width = this.image.naturalWidth;\n        this.gpuTexture.height = this.image.naturalHeight;\n        //this.gpuTexture = this.map.renderer.blackTexture; \n        this.gpuSize = 0; //this.image.naturalWidth * this.image.naturalHeight * 4;\n        return;\n    }\n\n    this.gpuTexture = new GpuTexture(this.map.renderer.gpu, null, this.map.core);\n    this.gpuTexture.createFromImage(this.image, (this.type == VTS_TEXTURETYPE_CLASS) ? 'nearest' : 'linear', false);\n    this.gpuSize = this.gpuTexture.getSize();\n\n    this.stats.gpuTextures += this.gpuSize;\n\n    this.stats.graphsFluxTexture[0][0]++;\n    this.stats.graphsFluxTexture[0][1] += this.gpuSize;\n\n    this.gpuCacheItem = this.map.gpuCache.insert(this.killGpuTexture.bind(this, true), this.gpuSize);\n};\n\n\nMapSubtexture.prototype.buildHeightMap = function () {\n    var canvas = document.createElement('canvas');\n    canvas.width = this.image.naturalWidth;\n    canvas.height = this.image.naturalHeight;\n    var ctx = canvas.getContext('2d');\n    ctx.drawImage(this.image, 0, 0);\n    this.imageData = ctx.getImageData(0, 0, this.image.naturalWidth, this.image.naturalHeight).data;\n    this.imageExtents = [this.image.naturalWidth, this.image.naturalHeight];\n    this.image = null;\n};\n\n\nMapSubtexture.prototype.getGpuTexture = function() {\n    return this.gpuTexture;\n};\n\n\nMapSubtexture.prototype.getHeightMapValue = function(x, y) {\n    if (this.imageData) {\n        return this.imageData[(y * this.imageExtents[0] + x)*4];\n    }\n    \n    return 0;\n};\n\nexport default MapSubtexture;\n\n","\nimport MapSubtexture_ from './subtexture';\n\n//get rid of compiler mess\nvar MapSubtexture = MapSubtexture_;\n\n\nvar MapTexture = function(map, path, type, extraBound, extraInfo, tile, internal) {\n    this.map = map;\n    this.stats = map.stats;\n    this.tile = tile; // used only for stats\n    this.internal = internal; // used only for stats\n    \n    if (tile) {\n        this.mainTexture = tile.resources.getSubtexture(this, path, type, tile, internal); \n    } else {\n        this.mainTexture = new MapSubtexture(map, path, type, tile, internal); \n    }\n\n    this.maskTexture = null; \n\n    this.loadState = 0;\n    this.loadErrorTime = null;\n    this.loadErrorCounter = 0;\n    this.neverReady = false;\n    this.maskTexture = null;\n    this.mapLoaderUrl = path;\n    this.type = type || VTS_TEXTURETYPE_COLOR;\n    this.extraBound = extraBound;\n    this.extraInfo = extraInfo;\n    this.statsCounter = 0;\n    this.checkStatus = 0;\n    this.checkType = null;\n    this.checkValue = null;\n    this.fastHeaderCheck = false;\n    this.fileSize = 0;\n\n    if (extraInfo && extraInfo.layer) {\n        var layer = extraInfo.layer;\n        \n        if (layer.availability) {\n            this.checkType = layer.availability.type;\n            switch (this.checkType) {\n            case VTS_TEXTURECHECK_TYPE: this.checkValue = layer.availability.mime; break;\n            case VTS_TEXTURECHECK_CODE: this.checkValue = layer.availability.codes; break;\n            case VTS_TEXTURECHECK_SIZE: this.checkValue = layer.availability.size; break;\n            }\n        }       \n    }\n};\n\n\nMapTexture.prototype.kill = function() {\n    this.mainTexture.killImage();\n    this.mainTexture.killGpuTexture();\n    this.mainTexture = null;\n    \n    if (this.maskTexture) {\n        this.maskTexture.killImage(); \n        this.maskTexture.killGpuTexture(); \n    }\n};\n\n\nMapTexture.prototype.killImage = function() {\n    this.mainTexture.killImage();\n\n    if (this.maskTexture) {\n        this.maskTexture.killImage(); \n    }\n};\n\n\nMapTexture.prototype.killGpuTexture = function() {\n    this.mainTexture.killGpuTexture();\n\n    if (this.maskTexture) {\n        this.maskTexture.killGpuTexture(); \n    }\n};\n\n\nMapTexture.prototype.setBoundTexture = function(tile, layer, hmap) {\n    if (tile) {\n        if (hmap) {\n            this.extraBound.sourceTile = tile;\n            this.extraBound.hmap = hmap;\n\n            if (!tile.hmap) {\n                var path = tile.resourceSurface.getHMapUrl(tile.id, true);\n                tile.hmap = tile.resources.getTexture(path, null, null, {tile: tile, hmap: hmap}, this.tile, this.internal);\n            }\n\n            this.extraBound.texture = tile.hmap; \n\n        } else if (layer) {\n            this.extraBound.sourceTile = tile;\n            this.extraBound.layer = layer;\n            \n            if (!tile.boundTextures[layer.id]) {\n                tile.boundLayers[layer.id] = layer;\n                var path = layer.getUrl(tile.id);\n                tile.boundTextures[layer.id] = tile.resources.getTexture(path, null, null, {tile: tile, layer: layer}, this.tile, this.internal);\n            }\n\n            this.extraBound.texture = tile.boundTextures[layer.id]; \n        }\n        \n        this.extraBound.transform = this.map.draw.drawTiles.getTileTextureTransform(tile, this.extraBound.tile);\n        this.map.markDirty();\n    }\n};\n\n\nMapTexture.prototype.isReady = function(doNotLoad, priority, doNotCheckGpu) {\n    var doNotUseGpu = (this.map.stats.gpuRenderUsed >= this.map.draw.maxGpuUsed);\n    doNotLoad = doNotLoad || doNotUseGpu;\n/*   \n   if (this.mapLoaderUrl == \"https://ecn.t3.tiles.virtualearth.net/tiles/a1202310323212333.jpeg?g=5549\") {\n       this.mapLoaderUrl = this.mapLoaderUrl;\n   }\n*/\n    if (this.neverReady) {\n        return false;\n    }\n\n    var parent;\n   \n    if (this.extraBound) {\n        if (this.extraBound.texture) {\n            while (this.extraBound.texture.extraBound || this.extraBound.texture.checkStatus == -1) {\n//            while (this.extraBound.texture.checkStatus == -1) {\n                parent = this.extraBound.sourceTile.parent;\n\n                if (this.extraBound.hmap) {\n                    if (!parent || parent.id[0] < 1) {\n                        this.neverReady = true;\n                        this.extraBound.tile.resetDrawCommands = true;\n                        this.map.markDirty();\n                        return false;\n                    }\n                } else if (this.extraBound.layer) {\n                    if (parent.id[0] < this.extraBound.layer.lodRange[0]) {\n                        this.neverReady = true;\n                        this.extraBound.tile.resetDrawCommands = true;\n                        this.map.markDirty();\n                        return false;\n                    }\n                }\n \n                this.setBoundTexture(parent, this.extraBound.layer);\n            }\n            \n            var ready = this.extraBound.texture.isReady(doNotLoad, priority, doNotCheckGpu);\n            \n            if (ready && this.checkMask) {\n                this.extraBound.tile.resetDrawCommands = (this.extraBound.texture.getMaskTexture() != null);\n                this.checkMask = false;\n            }\n\n            return ready;\n            \n        } else {\n            this.setBoundTexture(this.extraBound.sourceTile, this.extraBound.layer, this.extraBound.hmap);        \n            return this.isReady(doNotLoad, priority, doNotCheckGpu);\n        }\n        \n        return false;\n    }\n\n    /*\n    if (!this.extraBound && this.extraInfo && !this.maskTexture) {\n        var layer = this.extraInfo.layer;\n        \n        if (layer && layer.maskUrl && this.checkType != \"metatile\") {\n            var path = layer.getMaskUrl(this.tile.id);\n            this.maskTexture = this.tile.resources.getTexture(path, null, null, null, this.tile, this.internal);\n        }\n    }*/\n\n    switch (this.checkType) {\n    case VTS_TEXTURECHECK_MEATATILE:\n\n        if (this.checkStatus != 2) {\n            if (this.checkStatus == 0) {\n                if (this.extraInfo && this.extraInfo.tile) {\n                    var metaresources = this.extraInfo.tile.boundmetaresources;\n                    if (!metaresources) {\n                        metaresources = this.map.resourcesTree.findAgregatedNode(this.extraInfo.tile.id, 8);\n                        this.extraInfo.tile.boundmetaresources = metaresources;\n                    }\n                        \n                    var layer = this.extraInfo.layer;\n                    var path = this.extraInfo.metaPath;\n\t\t\t\t\t\t\n                    if(!this.extraInfo.metaPath) {\n                        path = layer.getMetatileUrl(metaresources.id);\t\n                        this.extraInfo.metaPath = path;\n                    }\n\t\t\t\t\t\t\n                    var texture = metaresources.getTexture(path, true, null, null, this.tile, this.internal);\n                        \n                    if (this.maskTexture) {\n                        if (this.maskTexture.isReady(doNotLoad, priority, doNotCheckGpu, this)) {\n                            this.checkStatus = 2;\n                        }\n                    } else {\n                        if (texture.isReady(doNotLoad, priority, doNotCheckGpu)) {\n                            var tile = this.extraInfo.tile;\n                            var value = texture.getHeightMapValue(tile.id[1] & 255, tile.id[2] & 255);\n                            this.checkStatus = (value & 128) ? 2 : -1;\n                                \n                            if (this.checkStatus == 2) {\n                                if (!(value & 64)) { //load mask\n                                    path = layer.getMaskUrl(tile.id);\n                                    this.maskTexture = tile.resources.getTexture(path, null, null, null, this.tile, this.internal);\n                                    this.checkStatus = 0;\n                                }\n                            }\n\n                            tile.resetDrawCommands = true;\n                            this.map.markDirty();\n                        }\n                    }\n                }\n            }\n                \n            if (this.checkStatus == -1) {\n                if (!this.extraBound) {\n                    parent = this.extraInfo.tile.parent;\n                    if (parent.id[0] < this.extraInfo.layer.lodRange[0]) {\n                        this.neverReady = true;\n                        this.extraInfo.tile.resetDrawCommands = true;\n                        this.map.markDirty();\n                        return false;\n                    }\n\n                    this.extraBound = { tile: this.extraInfo.tile, layer: this.extraInfo.layer};\n                    this.setBoundTexture(this.extraBound.tile.parent, this.extraBound.layer);\n                    this.checkMask = true;\n                }\n\n                while (this.extraBound.texture.extraBound || this.extraBound.texture.checkStatus == -1) {\n                    //while (this.extraBound.texture.checkStatus == -1) {\n                    parent = this.extraBound.sourceTile.parent;\n                    if (parent.id[0] < this.extraBound.layer.lodRange[0]) {\n                        this.neverReady = true;\n                        this.extraBound.tile.resetDrawCommands = true;\n                        this.map.markDirty();\n                        return false;\n                    }\n                        \n                    this.setBoundTexture(parent, this.extraBound.layer);        \n                }\n            }\n\n            return false;\n        }\n        \n        break;\n    }\n\n    var maskState = true;\n\n    if (this.maskTexture) {\n        maskState = this.maskTexture.isReady(doNotLoad, priority, doNotCheckGpu, this);\n    }\n    \n\n    return this.mainTexture.isReady(doNotLoad, priority, doNotCheckGpu, this) && maskState;\n};\n\nMapTexture.prototype.isMaskPosible = function() {\n    var texture = this;\n\n    if (this.extraBound) {\n        if (this.extraBound.texture) {\n            texture = this.extraBound.texture;\n        }\n    }\n\n    if (texture.checkType == VTS_TEXTURECHECK_MEATATILE) {\n        return true;\n    } else {\n        return false;\n    }\n};\n\nMapTexture.prototype.isMaskInfoReady = function() {\n    var texture = this;\n\n    if (this.extraBound) {\n        if (this.extraBound.texture) {\n            texture = this.extraBound.texture;\n        }\n    }\n\n    if (texture.checkType == VTS_TEXTURECHECK_MEATATILE) {\n        if (this.maskTexture || texture.checkStatus == 2 || texture.checkStatus ==  -1) {\n            return true;\n        }\n\n        return false;\n    }\n\n    return true;\n}\n\nMapTexture.prototype.getGpuTexture = function() {\n    if (this.extraBound) {\n        if (this.extraBound.texture) {\n            return this.extraBound.texture.getGpuTexture();\n        }\n        return null;\n    } \n\n    return this.mainTexture.getGpuTexture();\n};\n\n\nMapTexture.prototype.getMaskTexture = function() {\n    if (this.extraBound) {\n        if (this.extraBound.texture) {\n            return this.extraBound.texture.getMaskTexture();\n        }\n    } \n\n    return this.maskTexture;\n};\n\n\nMapTexture.prototype.getGpuMaskTexture = function() {\n    if (this.extraBound) {\n        if (this.extraBound.texture && this.extraBound.texture.maskTexture) {\n            return this.extraBound.texture.getGpuMaskTexture();\n        }\n        return null;\n    } \n\n    if (this.maskTexture) {\n        return this.maskTexture.getGpuTexture();\n    }\n    \n    return null;\n};\n\nMapTexture.prototype.getGpuSize = function() {\n    return (this.mainTexture ? (this.mainTexture.gpuSize ? this.mainTexture.gpuSize : 0) : 0) + (this.maskTexture ? (this.maskTexture.gpuSize ? this.maskTexture.gpuSize : 0) : 0);\n};\n\nMapTexture.prototype.getImageData = function() {\n    return this.mainTexture.imageData;\n};\n\n\nMapTexture.prototype.getImageExtents = function() {\n    return this.mainTexture.imageExtents;\n};\n\n\nMapTexture.prototype.getHeightMapValue = function(x, y) {\n    return this.mainTexture.getHeightMapValue(x, y);\n};\n\n\nMapTexture.prototype.getTransform = function() {\n    if (this.extraBound) {\n        if (this.extraBound.texture) {\n            return this.extraBound.transform;\n        }\n        return null;\n    } \n\n    return [1,1,0,0];\n};\n\n\nexport default MapTexture;\n\n","\nvar BBox = function(xmin, ymin, zmin, xmax, ymax, zmax) {\n    this.min = [];\n    this.max = [];\n\n    this.min[0] = (xmin != null) ? xmin : Number.POSITIVE_INFINITY;\n    this.min[1] = (ymin != null) ? ymin : Number.POSITIVE_INFINITY;\n    this.min[2] = (zmin != null) ? zmin : Number.POSITIVE_INFINITY;\n\n    this.max[0] = (xmax != null) ? xmax : Number.NEGATIVE_INFINITY;\n    this.max[1] = (ymax != null) ? ymax : Number.NEGATIVE_INFINITY;\n    this.max[2] = (zmax != null) ? zmax : Number.NEGATIVE_INFINITY;\n\n    this.updateMaxSize();\n};\n\n\nBBox.prototype.clone = function() {\n    return new BBox(this.min[0], this.min[1], this.min[2],\n                    this.max[0], this.max[1], this.max[2]);\n};\n\n\nBBox.prototype.side = function(index) {\n    return this.max[index] - this.min[index];\n};\n\n\nBBox.prototype.updateMaxSize = function() {\n    this.maxSize = Math.abs(Math.max(this.max[0] - this.min[0],\n                                     this.max[1] - this.min[1],\n                                     this.max[2] - this.min[2]));\n};\n\n\nBBox.prototype.center = function(vec) {\n    if (vec != null) {\n        vec[0] = (this.min[0] + this.max[0])*0.5;\n        vec[1] = (this.min[1] + this.max[1])*0.5;\n        return vec;\n    } else {\n        if (!this.middle) {\n            this.middle = [(this.min[0] + this.max[0])*0.5, (this.min[1] + this.max[1])*0.5, (this.min[2] + this.max[2])*0.5];\n\n            if (isNaN(this.middle[0])) {\n                this.middle[0] = 0;\n            }\n\n            if (isNaN(this.middle[1])) {\n                this.middle[1] = 0;\n            }\n\n            if (isNaN(this.middle[2])) {\n                this.middle[2] = 0;\n            }\n        } \n\n        return this.middle;\n    }\n};\n\n\nBBox.prototype.translateXY = function(delta) {\n    return new BBox(this.min[0] - delta[0], this.min[1] - delta[1], this.min[2],\n                    this.max[0] - delta[0], this.max[1] - delta[1], this.max[2]);\n};\n\n\nexport default BBox;\n\n","\nimport {vec3 as vec3_, mat4 as mat4_} from '../utils/matrix';\nimport {utils as utils_} from '../utils/utils';\nimport {math as math_} from '../utils/math';\nimport BBox_ from '../renderer/bbox';\n\n//get rid of compiler mess\nvar vec3 = vec3_, mat4 = mat4_;\nvar BBox = BBox_;\nvar math = math_;\nvar utils = utils_;\n\n\nvar MapMetanode = function(metatile, id, stream, divisionNode) {\n    this.metatile = metatile;\n    this.map = metatile.map;\n    this.id = id;\n    this.credits = [];\n    this.alien = false;\n    this.ready = false;\n    this.heightReady = false;\n    this.divisionNode = divisionNode;\n\n    this.diskPos = new Array(3);\n    this.diskDistance = 1; \n    this.diskNormal = new Array(3); \n    this.diskAngle = 1;\n    this.diskAngle2 = 1;\n    this.diskAngle2A = 1;\n    //this.bboxHeight = 1;\n    this.bbox2 = new Array(24);\n\n    //this.flagsGeometryPresent =  1;\n    //this.flagsNavtilePresent =  3;\n    //this.flagsInternalTexturePresent =  7;\n    //this.flagsCoarsenessControl =  15;\n    //this.flagsChildShift =  3;\n\n    if (stream) {\n        this.parseMetanode(stream);\n    }\n};\n\n\nMapMetanode.prototype.kill = function() {\n};\n\n\nMapMetanode.prototype.hasChild = function(index) {\n    return ((this.flags & (1<<(index+4))) != 0);\n};\n\n\nMapMetanode.prototype.hasChildById = function(id) {\n    var ix = id[1] - (this.id[1]<<1); \n    var iy = id[2] - (this.id[2]<<1);\n    \n    //ul,ur,ll,lr\n    return this.hasChild((iy<<1) + ix); \n};\n\n\nMapMetanode.prototype.hasChildren = function() {\n    return ((this.flags & ((15)<<4)) != 0);\n};\n\n\nMapMetanode.prototype.parseExtentBits = function(extentBytes, extentBits, index) {\n    var value = 0;\n\n    for (var i = 0, li = extentBits; i < li; i++) {\n        var byteIndex = index >> 3;\n        var bitIndex = index & 0x7;\n\n        if (extentBytes[byteIndex] & (1 << (7-bitIndex))) {\n            value = value | (1 << (li - i - 1));\n        }\n\n        index ++;\n    }\n\n    value /= (1 << li) - 1;\n//    value *= maxExtent;\n\n    return value;\n};\n\n\nMapMetanode.prototype.hasGeometry = function() {\n    return ((this.flags & 1) != 0);\n};\n\n\nMapMetanode.prototype.hasNavtile = function() {\n    return ((this.flags & (1 << 1)) != 0);\n};\n\n\nMapMetanode.prototype.usedTexelSize = function() {\n    return ((this.flags & (1 << 2)) != 0);\n};\n\n\nMapMetanode.prototype.usedDisplaySize = function() {\n    return ((this.flags & (1 << 3)) != 0);\n};\n\nMapMetanode.prototype.parseMetanode = function(stream) {\n\n/*\nstruct Metanode {\n    char flags;                   // #0 - geometry present, #1 - navtile present #2 - applyTexelSize,\n                                  // #3 - applyPixelSize, #4,5,6,7 - ul,ur,ll,lr child exists\n    char geomExtents[];           // a packed array of 6 bit sequences, each lod+2 long, in the following order:\n                                  // minx,maxx,miny,maxy,minz,maxz, undefined if no geometry present\n    uchar internalTextureCount;   // number of internal textures in geometry\n    hfloat texelSize;             // internal texel size in physical srs units, undef unless applyTexelSize is set\n    ushort displaySize;           // desired display size, undef unless applyDisplay size is set\n    short minHeight, maxHeight;   // navigation tile value range, undef if no navtile present\n}\n*/\n\n    var streamData = stream.data;\n    //var lastIndex = stream.index;\n    var version = this.metatile.version;\n\n    this.flags = streamData.getUint8(stream.index, true); stream.index += 1;\n\n    if (version < 5) {\n        var extentsSize = (((this.id[0] + 2) * 6 + 7) >> 3);\n        var extentsBytes = this.map.metanodeBuffer;//new Uint8Array(extentsSize);\n    \n        for (var i = 0, li = extentsSize; i < li; i++) {\n            extentsBytes[i] = streamData.getUint8(stream.index, true); stream.index += 1;\n        }\n    \n        var extentBits = this.id[0] + 2;\n    \n        var minExtents = [0,0,0];\n        var maxExtents = [0,0,0];\n    \n        var index = 0;\n        var spaceExtentSize = this.map.spaceExtentSize;\n        var spaceExtentOffset = this.map.spaceExtentOffset;\n    \n        for (i = 0; i < 3; i++) {\n            minExtents[i] = this.parseExtentBits(extentsBytes, extentBits, index) * spaceExtentSize[i] + spaceExtentOffset[i];\n            //minExtents[i] = this.parseExtentBits(extentsBytes, extentBits, index, 1.0);\n            index += extentBits;\n            maxExtents[i] = this.parseExtentBits(extentsBytes, extentBits, index) * spaceExtentSize[i] + spaceExtentOffset[i];\n            //maxExtents[i] = this.parseExtentBits(extentsBytes, extentBits, index, 1.0);\n            index += extentBits;\n        }\n    \n        //check zero bbox\n        var extentsBytesSum = 0;\n        for (i = 0, li = extentsBytes.length; i < li; i++) {\n            extentsBytesSum += extentsBytes[i];\n        }\n        \n        //extent bytes are empty and therefore bbox is empty also\n        if (extentsBytesSum == 0 ) {\n            //console.log(\"empty-node: id: \" + JSON.stringify(this.id));\n            //console.log(\"empty-node: surafce: \" + this.metatile.surface.id);\n    \n            minExtents[0] = Number.POSITIVE_INFINITY;\n            minExtents[1] = Number.POSITIVE_INFINITY;\n            minExtents[2] = Number.POSITIVE_INFINITY;\n            maxExtents[0] = Number.NEGATIVE_INFINITY;\n            maxExtents[1] = Number.NEGATIVE_INFINITY;\n            maxExtents[2] = Number.NEGATIVE_INFINITY;\n        }\n    \n        this.bbox = new BBox(minExtents[0], minExtents[1], minExtents[2], maxExtents[0], maxExtents[1], maxExtents[2]);\n    }    \n\n    //this.surrogatezHeight = 0;\n\n    if (version >= 4) {\n        this.minZ = streamData.getFloat32(stream.index, true); stream.index += 4;\n        this.maxZ = streamData.getFloat32(stream.index, true); stream.index += 4;\n        this.surrogatez = streamData.getFloat32(stream.index, true); stream.index += 4;\n\n        //if (!(this.minZ > this.maxZ || this.surrogatez == Number.NEGATIVE_INFINITY)) {\n          //  this.surrogatezHeight = this.surrogatez; //have to converted to nav srs height\n        //}\n    }\n\n\n\n    this.internalTextureCount = streamData.getUint8(stream.index, true); stream.index += 1;\n\n    this.pixelSize = utils.decodeFloat16( streamData.getUint16(stream.index, true) ); stream.index += 2;\n    this.displaySize = streamData.getUint16(stream.index, true); stream.index += 2;\n    this.displaySize = this.metatile.surface.displaySize; //1024;\n    if ((this.flags & (1 << 2)) == 0) {\n        this.pixelSize = Number.POSITIVE_INFINITY;\n    }\n\n    if ((this.flags & (1 << 3)) == 0) {\n        this.displaySize = 256;\n    }\n\n    this.minHeight = streamData.getInt16(stream.index, true); stream.index += 2;\n    this.maxHeight = streamData.getInt16(stream.index, true); stream.index += 2;\n\n    if (version < 4) {\n        this.minZ = this.minHeight;\n        this.maxZ = this.maxHeight;\n        this.surrogatez =this.minHeight;\n    }\n\n    this.minZ2 = this.minZ;\n    this.maxZ2 = this.maxZ;\n\n    \n    if (this.metatile.version >= 3) {\n        if (this.metatile.flags & (1<<7)) {\n            this.sourceReference = streamData.getUint16(stream.index, true); stream.index += 2;\n        } else if (this.metatile.flags & (1<<6)) {\n            this.sourceReference = streamData.getUint8(stream.index, true); stream.index += 1;\n        }\n    }\n\n    this.heightReady = this.hasNavtile();\n    \n    this.alien = false;\n\n    //var nodeSize2 = stream.index - lastIndex;\n\n    //if (!this.map.config.mapSmartNodeParsing) {\n    this.generateCullingHelpers();\n    //}    \n};\n\n\nMapMetanode.prototype.clone = function() {\n    var node = new  MapMetanode(this.metatile, this.id);\n    node.flags = this.flags;\n    node.minHeight = this.minHeight;\n    node.maxHeight = this.maxHeight;\n    node.minZ = this.minZ;\n    node.maxZ = this.maxZ;\n    node.minZ2 = this.minZ2;\n    node.maxZ2 = this.maxZ2;\n    node.llx = this.llx;\n    node.lly = this.lly;\n    node.urx = this.urx;\n    node.ury = this.ury;\n    node.surrogatez = this.surrogatez;\n    node.internalTextureCount = this.internalTextureCount;\n    node.pixelSize = this.pixelSize;\n    node.displaySize = this.displaySize;\n    node.ready = this.ready;\n    node.stream = this.stream;\n    node.heightReady = this.heightReady;\n    \n    //copy credits\n    node.credits = new Array(this.credits.length);\n    \n    for (var i = 0, li = this.credits.length; i < li; i++) {\n        node.credits[i] = this.credits[i];\n    }\n\n    if (this.bbox) {\n        node.bbox = this.bbox.clone();\n    }\n\n\n//    if (this.map.config.mapGeocentCulling) {\n    node.diskPos = this.diskPos;\n    node.diskNormal = this.diskNormal; \n    node.diskAngle = this.diskAngle;\n    node.diskAngle2 = this.diskAngle2;\n    node.diskAngle2A = this.diskAngle2A;\n    node.diskDistance = this.diskDistance; \n    node.bbox2 = this.bbox2;  \n\n    node.divisionNode = this.divisionNode;\n\n //   }\n\n    if (this.plane) {\n        node.plane = this.plane.slice();\n    }\n\n    return node;\n};\n\n\nMapMetanode.prototype.generateCullingHelpers = function(virtual) {\n    this.ready = true;\n    \n    var map = this.map;\n    var draw = map.draw;\n    var geocent = map.isGeocent;\n    var version = this.metatile.useVersion;\n\n    if (this.id[0] < map.measure.minDivisionNodeDepth || (!geocent && version < 4)) {\n        return;\n    }\n\n    if (map.config.mapPreciseCulling || version >= 4) { //use division node srs\n        if (virtual) {\n            return; //result is same for each tile id\n        }\n\n        var divisionNode;\n        var llx, lly, urx, ury;\n        var pos = draw.tmpVec3;\n        \n        if (this.id[0] > map.measure.maxDivisionNodeDepth) {\n            var pos2 = draw.tmpVec5;\n            \n            divisionNode = map.measure.getSpatialDivisionNodeFromId(this.id);\n\n            if (!divisionNode) {\n                return;\n            }\n\n            map.measure.getSpatialDivisionNodeAndExtents2(this.id, pos2, divisionNode);\n            //var node = pos2[0]; \n            llx = pos2[1];\n            lly = pos2[2];\n            urx = pos2[3];\n            ury = pos2[4];\n\n            this.divisionNode = divisionNode;\n\n            /*if (this.id[0] == 2 && this.id[1] == 0 && this.id[2] == 2) {\n                var res = this.map.measure.getSpatialDivisionNodeAndExtents(this.id);\n                res = res;\n            }*/\n            \n        } else {\n            var res = map.measure.getSpatialDivisionNodeAndExtents(this.id);\n            divisionNode = res ? res[0] : null; \n\n            if (!divisionNode) {\n                return;\n            }\n                        \n            llx = res[1][0][0];\n            lly = res[1][0][1];\n            urx = res[1][1][0];\n            ury = res[1][1][1];\n            this.divisionNode = divisionNode;\n        }\n\n        this.llx = llx;\n        this.lly = lly;\n        this.urx = urx;\n        this.ury = ury;\n        \n        var h = this.minZ;\n        //var middle = [(ur[0] + ll[0])* 0.5, (ur[1] + ll[1])* 0.5, h];\n        //var normal = [0,0,0];\n        \n        pos[0] = (urx + llx)* 0.5; \n        pos[1] = (ury + lly)* 0.5; \n        pos[2] = h; \n        \n        divisionNode.getPhysicalCoordsFast(pos, true, this.diskPos, 0, 0);\n        \n        if (geocent) {\n            this.diskDistance = vec3.length(this.diskPos); \n            vec3.normalize(this.diskPos, this.diskNormal);\n        } else {\n            this.diskNormal[0] = 0;\n            this.diskNormal[1] = 0;\n            this.diskNormal[2] = 1;\n        }\n        //this.diskNormal = normal;   \n        var normal = this.diskNormal;\n        \n        \n        //if (divisionNode.id[0] == 1 && divisionNode.id[1] ==  1 && divisionNode.id[2] == 0) {   //???? debug?????\n          //  var res = this.map.getSpatialDivisionNodeAndExtents(this.id);\n          //  node = node;\n        //}\n        \n        pos[0] = urx; \n        pos[1] = ury; \n        pos[2] = h; \n\n        /*if (this.id[0] == 17 && this.id[1] == 53306 && this.id[2] == 30754) {\n            normal = normal;\n        }*/\n        \n        var bbox = this.bbox2;\n\n        divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 0);\n\n        pos[1] = lly; \n        divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 3);\n        \n        pos[0] = llx; \n        divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 6);\n        \n        pos[1] = ury; \n        divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 9);\n\n        var height;\n\n        if (!geocent) {\n            height = this.maxZ - h;\n            \n            bbox[12] = bbox[0];\n            bbox[13] = bbox[1];\n            bbox[14] = bbox[2] + height;\n            \n            bbox[15] = bbox[3];\n            bbox[16] = bbox[4];\n            bbox[17] = bbox[5] + height;\n        \n            bbox[18] = bbox[6];\n            bbox[19] = bbox[7];\n            bbox[20] = bbox[8] + height;\n        \n            bbox[21] = bbox[9];\n            bbox[22] = bbox[10];\n            bbox[23] = bbox[11] + height;\n            return;        \n        }\n\n        var normalize;\n        var dot = vec3.dot;\n        var d1, d2, d3, d4, maxDelta;\n\n        if (map.config.mapPreciseBBoxTest || version >= 4) { \n        //if (true) { \n            height = this.maxZ - h;\n\n            if (this.id[0] <= 3) { //get aabbox for low lods\n                normalize = vec3.normalize2; \n\n                normalize(bbox, 0, pos);\n                d1 = dot(normal, pos);\n                \n                normalize(bbox, 3, pos);\n                d2 = dot(normal, pos);\n        \n                normalize(bbox, 6, pos);\n                d3 = dot(normal, pos);\n        \n                normalize(bbox, 9, pos);\n                d4 = dot(normal, pos);\n\n                maxDelta = Math.min(d1, d2, d3, d4);\n\n                pos[0] = (urx + llx)* 0.5; \n                pos[1] = ury; \n                pos[2] = h; \n                \n                divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 12);\n\n                pos[1] = lly; \n                divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 15);\n\n                pos[0] = urx; \n                pos[1] = (ury + lly)* 0.5; \n                divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 18);\n\n                pos[0] = llx; \n                divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 21);\n\n                var mpos = this.diskPos;\n                var maxX = Math.max(bbox[0], bbox[3], bbox[6], bbox[9], bbox[12], bbox[15], bbox[18], bbox[21], mpos[0]);\n                var minX = Math.min(bbox[0], bbox[3], bbox[6], bbox[9], bbox[12], bbox[15], bbox[18], bbox[21], mpos[0]);\n                \n                var maxY = Math.max(bbox[1], bbox[4], bbox[7], bbox[10], bbox[13], bbox[16], bbox[19], bbox[22], mpos[1]);\n                var minY = Math.min(bbox[1], bbox[4], bbox[7], bbox[10], bbox[13], bbox[16], bbox[19], bbox[22], mpos[1]);\n                \n                var maxZ = Math.max(bbox[2], bbox[5], bbox[8], bbox[11], bbox[14], bbox[17], bbox[20], bbox[23], mpos[2]);\n                var minZ = Math.min(bbox[2], bbox[5], bbox[8], bbox[11], bbox[14], bbox[17], bbox[20], bbox[23], mpos[2]);\n                \n                if (this.id[0] <= 1) {\n                    pos[0] = urx + (llx-urx )* 0.25; \n                    pos[1] = (ury + lly)* 0.5; \n                    \n                    divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 12);\n    \n                    pos[0] = urx + (llx-urx )* 0.75; \n                    divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 15);\n    \n                    pos[0] = (urx + llx)* 0.5; \n                    pos[1] = ury + (lly-ury )* 0.25; \n                    divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 18);\n    \n                    pos[1] = ury + (lly-ury )* 0.75; \n                    divisionNode.getPhysicalCoordsFast(pos, true, bbox, 0, 21);\n\n                    maxX =  Math.max(maxX, bbox[12], bbox[15], bbox[18], bbox[21]);\n                    minX =  Math.min(minX, bbox[12], bbox[15], bbox[18], bbox[21]);\n                    \n                    maxY =  Math.max(maxY, bbox[13], bbox[16], bbox[19], bbox[22]);\n                    minY =  Math.min(minY, bbox[13], bbox[16], bbox[19], bbox[22]);\n                    \n                    maxZ =  Math.max(maxZ, bbox[14], bbox[17], bbox[20], bbox[23]);\n                    minZ =  Math.min(minZ, bbox[14], bbox[17], bbox[20], bbox[23]);\n\n                    maxDelta = -1;//full circle;\n                }\n\n                bbox[0] = minX; bbox[1] = minY; bbox[2] = minZ;\n                bbox[3] = maxX; bbox[4] = minY; bbox[5] = minZ;\n                bbox[6] = maxX; bbox[7] = maxY; bbox[8] = minZ;\n                bbox[9] = minX; bbox[10] = maxY; bbox[11] = minZ;\n\n                bbox[12] = minX; bbox[13] = minY; bbox[14] = maxZ;\n                bbox[15] = maxX; bbox[16] = minY; bbox[17] = maxZ;\n                bbox[18] = maxX; bbox[19] = maxY; bbox[20] = maxZ;\n                bbox[21] = minX; bbox[22] = maxY; bbox[23] = maxZ;\n            } else {\n\n                normalize = vec3.normalize3; \n                dot = vec3.dot2;\n\n                normalize(bbox, 0, bbox, 12);\n                d1 = dot(normal, bbox, 12);\n                \n                normalize(bbox, 3, bbox, 15);\n                d2 = dot(normal, bbox, 15);\n        \n                normalize(bbox, 6, bbox, 18);\n                d3 = dot(normal, bbox, 18);\n        \n                normalize(bbox, 9, bbox, 21);\n                d4 = dot(normal, bbox, 21);\n    \n                maxDelta = Math.min(d1, d2, d3, d4);\n\n                if (this.id[0] <= 8) { //extend bbox because of lon curvature\n                    pos = this.diskPos;\n\n                    var expand = 0.12 / (9-4) * (5-(this.id[0]-4));\n\n                    bbox[0] += (bbox[0] - pos[0]) * expand;\n                    bbox[1] += (bbox[1] - pos[1]) * expand;\n                    bbox[2] += (bbox[2] - pos[2]) * expand;\n\n                    bbox[3] += (bbox[3] - pos[0]) * expand;\n                    bbox[4] += (bbox[4] - pos[1]) * expand;\n                    bbox[5] += (bbox[5] - pos[2]) * expand;\n\n                    bbox[6] += (bbox[6] - pos[0]) * expand;\n                    bbox[7] += (bbox[7] - pos[1]) * expand;\n                    bbox[8] += (bbox[8] - pos[2]) * expand;\n\n                    bbox[9] += (bbox[9] - pos[0]) * expand;\n                    bbox[10] += (bbox[10] - pos[1]) * expand;\n                    bbox[11] += (bbox[11] - pos[2]) * expand;\n                }\n\n                //extend bbox height by tile curvature \n                height += draw.planetRadius - (draw.planetRadius * maxDelta);  \n                \n                bbox[12] = bbox[0] + bbox[12] * height;\n                bbox[13] = bbox[1] + bbox[13] * height;\n                bbox[14] = bbox[2] + bbox[14] * height;\n                \n                bbox[15] = bbox[3] + bbox[15] * height;\n                bbox[16] = bbox[4] + bbox[16] * height;\n                bbox[17] = bbox[5] + bbox[17] * height;\n            \n                bbox[18] = bbox[6] + bbox[18] * height;\n                bbox[19] = bbox[7] + bbox[19] * height;\n                bbox[20] = bbox[8] + bbox[20] * height;\n            \n                bbox[21] = bbox[9] + bbox[21] * height;\n                bbox[22] = bbox[10] + bbox[22] * height;\n                bbox[23] = bbox[11] + bbox[23] * height;\n            }\n        \n        } else {\n            normalize = vec3.normalize2; \n\n            normalize(bbox, 0, pos);\n            d1 = dot(normal, pos);\n            \n            normalize(bbox, 3, pos);\n            d2 = dot(normal, pos);\n    \n            normalize(bbox, 6, pos);\n            d3 = dot(normal, pos);\n    \n            normalize(bbox, 9, pos);\n            d4 = dot(normal, pos);\n\n            maxDelta = Math.min(d1, d2, d3, d4);\n        }\n\n        //get cos angle based at 90deg\n        this.diskAngle = Math.cos(Math.max(0,(Math.PI * 0.5) - Math.acos(maxDelta)));\n        this.diskAngle2 = maxDelta;\n        this.diskAngle2A = Math.acos(maxDelta); //optimalization\n\n        //shift center closer to earth\n        //var factor = this.bbox.maxSize * 0.2; \n        //this.diskPos = [this.diskPos[0] - normal[0] * factor, this.diskPos[1]  - normal[1] * factor, this.diskPos[2] - normal[2] * factor];   \n    } \n};\n\n\nMapMetanode.prototype.getWorldMatrix = function(geoPos, matrix) {\n    // Note: the current camera geographic position (geoPos) is not necessary\n    // here, in theory, but for numerical stability (OpenGL ES is float only)\n    // we get rid of the large UTM numbers in the following subtractions. The\n    // camera effectively stays in the position [0,0] and the tiles travel\n    // around it. (The Z coordinate is fine and is not handled in this way.)\n\n    var m = matrix;\n\n    if (m != null) {\n        m[0] = this.bbox.side(0); m[1] = 0; m[2] = 0; m[3] = 0;\n        m[4] = 0; m[5] = this.bbox.side(1); m[6] = 0; m[7] = 0;\n        m[8] = 0; m[9] = 0; m[10] = this.bbox.side(2); m[11] = 0;\n        m[12] = this.bbox.min[0] - geoPos[0]; m[13] = this.bbox.min[1] - geoPos[1]; m[14] = this.bbox.min[2] - geoPos[2]; m[15] = 1;\n    } else {\n        m = mat4.create();\n\n        mat4.multiply( math.translationMatrix(this.bbox.min[0] - geoPos[0], this.bbox.min[1] - geoPos[1], this.bbox.min[2] - geoPos[2]),\n                       math.scaleMatrix(this.bbox.side(0), this.bbox.side(1), this.bbox.side(2)), m);\n    }\n\n    return m;\n};\n\n\nMapMetanode.prototype.drawBBox = function(cameraPos) {\n    if (this.metatile.useVersion >= 4) {\n        return this.drawBBox2(cameraPos);\n    }\n\n    var renderer = this.map.renderer;\n\n    renderer.gpu.useProgram(renderer.progBBox, ['aPosition']);\n\n    var mvp = mat4.create();\n    var mv = mat4.create();\n\n    mat4.multiply(renderer.camera.getModelviewMatrix(), this.getWorldMatrix(cameraPos), mv);\n\n    var proj = renderer.camera.getProjectionMatrix();\n    mat4.multiply(proj, mv, mvp);\n\n    renderer.progBBox.setMat4('uMVP', mvp);\n\n    //draw bbox\n    renderer.bboxMesh.draw(renderer.progBBox, 'aPosition');\n};\n\n\nMapMetanode.prototype.drawBBox2 = function() {\n    //var spoints = []; \n    //for (var i = 0, li = this.bbox2.length; i < li; i++) {\n        //var pos = this.bbox2[i];\n        //pos = [\"obj\", pos[0], pos[1], \"fix\", pos[2], 0, 0, 0, 10, 90 ];\n        \n    var bbox = this.bbox2;\n    var buffer = this.map.draw.bboxBuffer;\n    var camPos = this.map.camera.position;\n    var renderer = this.map.renderer;\n    var prog = renderer.progBBox2;\n\n    for (var i = 0, li = 8*3; i < li; i+=3) {\n        //var pos = [\"obj\", bbox[i], bbox[i+1], \"fix\", bbox[i+2], 0, 0, 0, 10, 90 ];\n        //var coords = this.map.convert.getPositionCameraCoords((new MapPosition(pos)), null, true);\n\n        buffer[i] = bbox[i] - camPos[0];\n        buffer[i+1] = bbox[i+1] - camPos[1];\n        buffer[i+2] = bbox[i+2] - camPos[2];\n    }\n    \n\n    renderer.gpu.useProgram(prog, ['aPosition']);\n\n    prog.setFloatArray('uPoints', buffer);\n\n    //var mvp = mat4.create();\n    //var mv = mat4.create();\n\n    //mat4.multiply(renderer.camera.getModelviewMatrix(), this.getWorldMatrix(cameraPos), mv);\n\n    //var proj = renderer.camera.getProjectionMatrix();\n    //mat4.multiply(proj, mv, mvp);\n\n    var mvp = renderer.camera.getMvpMatrix();\n\n    prog.setMat4('uMVP', mvp);\n\n    //draw bbox\n    renderer.bboxMesh2.draw(prog, 'aPosition');\n};\n\nMapMetanode.prototype.drawPlane = function(cameraPos, tile) {\n    var renderer = this.map.renderer;\n    var buffer = this.map.draw.planeBuffer;\n    var points = this.plane;\n    \n    if (!points) {\n        return;\n    }\n\n    renderer.gpu.useProgram(renderer.progPlane, ['aPosition', 'aTexCoord']);\n\n    var mvp = mat4.create();\n    var mv = renderer.camera.getModelviewMatrix();\n    var proj = renderer.camera.getProjectionMatrix();\n    mat4.multiply(proj, mv, mvp);\n    \n    var sx = cameraPos[0];\n    var sy = cameraPos[1];\n    var sz = cameraPos[2];\n\n    for (var i = 0; i < 9; i++) {\n        var index = i*3;\n        buffer[index] = points[index] - sx; \n        buffer[index+1] = points[index+1] - sy; \n        buffer[index+2] = points[index+2] - sz; \n    }\n    \n    var prog = renderer.progPlane; \n\n    prog.setMat4('uMV', mv);\n    prog.setMat4('uProj', proj);\n    prog.setFloatArray('uPoints', buffer);\n\n    //var minTile = 32;\n    var embed = 8;\n    var altitude = Math.max(10, tile.distance + 20);\n    var gridSelect = (Math.log(altitude) / Math.log(embed));\n    var step1 = 4;//(Math.pow(embed, Math.floor(gridSelect)));\n    var step2 = 8;//(Math.pow(embed, Math.ceil(gridSelect)));\n    var blend = (gridSelect - Math.floor(gridSelect));\n    //var blend = 0;\n\n    //prog.setVec4(\"uParams\", [0,0,1/15,0]);\n    //prog.setVec4(\"uParams\", [(minTile / step1),0,1/15,(minTile / step2)]);\n    prog.setVec4('uParams', [step1, 0, 1/15, step2]);\n\n    //prog.setVec4(\"uParams2\", [(minTile / step1), (minTile / step2), blend, 0]);\n    prog.setVec4('uParams2', [0, 0, blend, 0]);\n\n    renderer.gpu.bindTexture(renderer.heightmapTexture);\n    \n    //draw bbox\n    renderer.planeMesh.draw(renderer.progPlane, 'aPosition', 'aTexCoord');\n};\n\n\nMapMetanode.prototype.getGridHeight = function(coords, data, dataWidth) {\n    var x = coords[0] - this.llx;\n    //var y = this.ury - coords[1];\n    var y = coords[1]  - this.lly;\n    var maxX = (dataWidth-1);\n    var maxY = (dataWidth-1);\n    \n    //data coords\n    x = (maxX) * (x / (this.urx - this.llx));\n    y = (maxY) * (y / (this.ury - this.lly));\n\n    if (x < 0) { x = 0; }\n    if (y < 0) { y = 0; }\n    if (x > maxX) { x = maxX; }\n    if (y > maxY) { y = maxY; }\n\n    var ix = Math.floor(x);\n    var iy = Math.floor(y);\n    var fx = x - ix;\n    var fy = y - iy;\n\n    var index = iy * dataWidth;\n    var index2 = (iy == maxY) ? index : index + dataWidth;\n    var ix2 = (ix == maxX) ? ix : ix + 1; \n    var h00 = data[index + ix];\n    var h01 = data[index + ix2];\n    var h10 = data[index2 + ix];\n    var h11 = data[index2 + ix2];\n    var w0 = (h00 + (h01 - h00)*fx);\n    var w1 = (h10 + (h11 - h10)*fx);\n    var height = (w0 + (w1 - w0)*fy);\n\n    return height;\n};\n\nexport default MapMetanode;\n\n","\nimport {utils as utils_} from '../utils/utils';\nimport MapMetanode_ from './metanode';\n\n//get rid of compiler mess\nvar utils = utils_;\nvar MapMetanode = MapMetanode_;\n\n\nvar MapMetatile = function(metaresources, surface, tile) {\n    this.metaresources= metaresources; //this is metastorage tile\n    this.map = metaresources.map;\n    this.surface = surface;\n    this.id = metaresources.id;\n    this.tile = tile; // used only for stats\n    this.nodes = [];\n    this.drawCounter = 0;\n    this.loadState = 0;\n    this.loadErrorTime = null;\n    this.loadErrorCounter = 0;\n    this.size = 0;\n    this.cacheItem = null;\n};\n\n\nMapMetatile.prototype.kill = function(killedByCache) {\n    if (killedByCache !== true && this.cacheItem != null) {\n        this.map.metatileCache.remove(this.cacheItem);\n    }\n\n    if (this.metaresources) {\n        this.metaresources.removeMetatile(this);\n        //this.metaresources.validate();\n        //this.metaresources = null;\n    }\n\n    this.loadState = 0;\n    this.surface = 0;\n    this.cacheItem = null;\n\n    this.nodes = [];\n};\n\n\nMapMetatile.prototype.clone = function(surface) {\n    var metatile = new MapMetatile(this.metaresources, surface);\n    metatile.nodes = this.nodes;\n    metatile.loadState = this.loadState;\n    metatile.nodes = this.nodes;\n    metatile.size = this.size;\n\n    metatile.lod = this.lod;\n    metatile.metatileIdx = this.metatileIdx;\n    metatile.metatileIdy = this.metatileIdy;\n    metatile.offsetx = this.offsetx;\n    metatile.offsety = this.offsety;\n    metatile.sizex = this.sizex;\n    metatile.sizey = this.sizey;\n    metatile.version = this.version;\n    metatile.credits = this.credits;\n\n    if (this.version < 2) {\n        metatile.nodeSize = this.nodeSize;\n    } else {\n        metatile.flags = this.flags;\n        metatile.creditCount = this.creditCount;\n        metatile.flagPlanes = this.flagPlanes;\n    }\n\n    metatile.cacheItem= this.map.metatileCache.insert(metatile.kill.bind(metatile, true), metatile.size);\n    return metatile;\n};\n\n\nMapMetatile.prototype.isReady = function (/*doNotLoad,*/ priority) {\n    //if (this.id[0] == 18 &&\n    //    this.id[1] == 130400 &&\n    //    this.id[2] == 129088) {\n    //    debugger;\n    //}\n\n    if (this.loadState == 2) { //loaded\n        return true;\n    } else {\n\n        if (this.loadState == 0) { \n            //if (doNotLoad) {\n                //remove from queue\n                //if (this.mapLoaderUrl) {\n                  //  this.map.loader.remove(this.mapLoaderUrl);\n                //}\n            //} else {\n                //not loaded\n                //add to loading queue or top position in queue\n            if (this.loadState == 3) { //loadError\n                if (this.loadErrorCounter <= this.map.config.mapLoadErrorMaxRetryCount &&\n                        performance.now() > this.loadErrorTime + this.map.config.mapLoadErrorRetryTime) {\n\n                    this.scheduleLoad(priority);                    \n                }\n            } else {\n                this.scheduleLoad(priority);\n            }\n            //}\n        } //else load in progress\n        \n        return false;\n    }\n};\n\n\nMapMetatile.prototype.used = function() {\n    if (this.cacheItem != null) {\n        this.map.metatileCache.updateItem(this.cacheItem);\n    }\n};\n\n\nMapMetatile.prototype.getNode = function(id) {\n    var x = id[1] - this.id[1] - this.offsetx;\n    var y = id[2] - this.id[2] - this.offsety;\n    \n    if (x < 0 || y < 0 || x >= this.sizex || y >= this.sizey) {\n        return null;\n    }\n    \n    var node = this.nodes[this.sizex * y + x];\n\n    if (!node) {\n        var index = this.sizex * y + x;\n        var stream = {data:this.data, index:this.metanodesIndex + (index * this.metanodeSize)};\n        node = (new MapMetanode(this, [this.lod, this.metatileIdx + this.offsetx + x, this.metatileIdy + this.offsety + y], stream, this.divisionNode)); \n        this.nodes[index] = node;\n        this.applyMetanodeCredits(x, y);\n        this.applyMetatanodeBitplanes(x, y); \n    }\n\n/*    \n    if (!node.ready) {\n        node.generateCullingHelpers();\n        node.ready = true;\n    }\n*/\n    \n    return node;\n};\n\n\nMapMetatile.prototype.scheduleLoad = function() {\n    if (this.mapLoaderUrl == null) {\n        this.mapLoaderUrl = this.surface.getMetaUrl(this.id);\n    }\n\n    this.map.loader.load(this.mapLoaderUrl, this.onLoad.bind(this), null, this.tile, 'metatile');\n};\n\n\nMapMetatile.prototype.onLoad = function(url, onLoaded, onError) {\n    this.mapLoaderCallLoaded = onLoaded;\n    this.mapLoaderCallError = onError;\n\n    this.map.loader.processLoadBinary(url, this.onLoaded.bind(this), this.onLoadError.bind(this), null, 'metadata');\n    //utils.loadBinary(url, this.onLoaded.bind(this), this.onLoadError.bind(this), (utils.useCredentials ? (this.mapLoaderUrl.indexOf(this.map.url.baseUrl) != -1) : false), this.map.core.xhrParams);\n    this.loadState = 1;\n};\n\n\nMapMetatile.prototype.onLoadError = function() {\n    if (this.map.killed){\n        return;\n    }\n\n    this.loadState = 3;\n    this.loadErrorTime = performance.now();\n    this.loadErrorCounter ++;\n\n    //make sure we try to load it again\n    if (this.loadErrorCounter <= this.map.config.mapLoadErrorMaxRetryCount) { \n        setTimeout((function(){ if (!this.map.killed) { this.map.markDirty(); } }).bind(this), this.map.config.mapLoadErrorRetryTime);\n    }    \n\n    this.mapLoaderCallError();\n};\n\n\nMapMetatile.prototype.onLoaded = function(data, task) {\n    if (this.map.killed){\n        return;\n    }\n\n    if (!task) {\n    //if (this.map.stats.renderBuild > this.map.config.mapMaxProcessingTime) {\n        this.map.markDirty();\n        this.map.addProcessingTask(this.onLoaded.bind(this, data, true));\n        return;\n    }\n\n    data = new DataView(data);\n\n    this.size += data.byteLength * 4;\n    \n    this.data = data;\n\n    var t = performance.now();\n    this.parseMetatatile({data:data, index: 0});\n    this.map.stats.renderBuild += performance.now() - t; \n\n    this.cacheItem= this.map.metatileCache.insert(this.kill.bind(this, true), this.size);\n\n    this.map.markDirty();\n    this.loadState = 2;\n    this.loadErrorTime = null;\n    this.loadErrorCounter = 0;\n    this.mapLoaderCallLoaded();\n};\n\n\nMapMetatile.prototype.parseMetatatile = function(stream) {\n\n/*\n    struct Header {\n\n        char magic[2];                         // letters \"MT\"\n        ushort version;                        // version\n        uchar lod;                             // common lod\n        uint metatileIdx, metatileIdy;         // id of upper left tile corner (reflected in tile name)\n        ushort offsetx, offsety;               // offset of valid data block\n        ushort sizex, sizey;                   // dimensions of metanode grid\n        uchar nodeSize;                        // size of a metanode in bytes\n        uchar creditCount;                     // total number of credit blocks (= number of attributions used by nodes)\n        ushort creditSize;                     // size of credit block in bytes\n    };\n*/\n\n    var streamData = stream.data;\n    var magic = '';\n\n    magic += String.fromCharCode(streamData.getUint8(stream.index, true)); stream.index += 1;\n    magic += String.fromCharCode(streamData.getUint8(stream.index, true)); stream.index += 1;\n\n    if (magic != 'MT') {\n        return;\n    }\n\n    this.version = streamData.getUint16(stream.index, true); stream.index += 2;\n\n    if (this.version > 5) {\n        return;\n    }\n\n    this.lod = streamData.getUint8(stream.index, true); stream.index += 1;\n\n    this.metatileIdx = streamData.getUint32(stream.index, true); stream.index += 4;\n    this.metatileIdy = streamData.getUint32(stream.index, true); stream.index += 4;\n\n    this.offsetx = streamData.getUint16(stream.index, true); stream.index += 2;\n    this.offsety = streamData.getUint16(stream.index, true); stream.index += 2;\n\n    this.sizex = streamData.getUint16(stream.index, true); stream.index += 2;\n    this.sizey = streamData.getUint16(stream.index, true); stream.index += 2;\n    \n    this.flagPlanes = new Array(8);\n\n    if (this.version < 2) {\n        this.nodeSize = streamData.getUint8(stream.index, true); stream.index += 1;\n    } else {\n        this.flags = streamData.getUint8(stream.index, true); stream.index += 1;\n        this.creditCount = streamData.getUint8(stream.index, true); stream.index += 1;\n        this.parseFlagPlanes(stream);\n    }\n\n    this.parseMetatatileCredits(stream);\n    this.parseMetatatileNodes(stream);\n    \n    this.useVersion = (this.map.config.mapForceMetatileV3 && this.version < 5) ? 3 : this.version; \n};\n\n\nMapMetatile.prototype.parseFlagPlanes = function(stream) {\n    var streamData = stream.data;\n\n    //rounded to bytes\n    var bitplaneSize = ((this.sizex * this.sizey + 7) >> 3);\n\n    for (var i = 0; i < 6; i++) {\n        if ((this.flags & (1 << i)) != 0) {\n\n            var bitplane = new Uint8Array(bitplaneSize);\n    \n            for (var j = 0; j < bitplaneSize; j++) {\n                bitplane[j] = streamData.getUint8(stream.index, true); stream.index += 1;\n            }\n    \n            this.flagPlanes[i] = bitplane; \n        }\n    }\n};\n\n\nMapMetatile.prototype.parseMetatatileCredits = function(stream) {\n\n/*\n    struct CreditBlock {\n       ushort creditId;       // numerical creditId\n       char creditMask[];     // bitfield of size header.sizex * header.sizey, row major, row padded\n    };\n*/\n\n    var streamData = stream.data;\n    \n    if (this.version < 2) {\n        this.creditCount = streamData.getUint8(stream.index, true); stream.index += 1;\n        this.creditSize = streamData.getUint16(stream.index, true); stream.index += 2;\n    }\n    \n    if (this.creditCount == 0) {\n        this.credits = [];\n        return;\n    }\n\n    //rounded to bytes\n    var bitfieldSize = ((this.sizex * this.sizey + 7) >> 3);\n\n    this.credits = new Array(this.creditCount);\n\n    for (var i = 0, li = this.credits.length; i < li; i++) {\n        var creditId = streamData.getUint16(stream.index, true); stream.index += 2;\n        var bitfield = new Uint8Array(bitfieldSize);\n\n        for (var j = 0; j < bitfieldSize; j++) {\n            bitfield[j] = streamData.getUint8(stream.index, true); stream.index += 1;\n        }\n    \n        var credit = this.map.getCreditByNumber(creditId);\n        var stringId = credit ? credit.key : null;\n\n        this.credits[i] = { creditId : stringId, creditMask: bitfield};\n    }\n};\n\n\nMapMetatile.prototype.applyMetatatileBitplanes = function() {\n    for (var i = 0; i < 1; i++) {\n        if (this.flagPlanes[i]) {\n            \n            var bitplane = this.flagPlanes[i]; \n    \n            for (var y = 0; y < this.sizey; y++) {\n                for (var x = 0; x < this.sizex; x++) {\n                    var byteIndex = this.sizex * y + x;\n                    var bitIndex = byteIndex & 7;\n                    var bitMask = 1 << bitIndex;\n                    byteIndex >>= 3;\n                    \n                    if (bitplane[byteIndex] & bitMask) {\n                        switch(i) {\n                        case 0:\n                            this.nodes[y*this.sizex+x].alien = true;\n                            break;       \n                        }\n                    }\n                }\n            }\n        }\n    }\n};\n\n\nMapMetatile.prototype.applyMetatanodeBitplanes = function(x, y) {\n    for (var i = 0; i < 1; i++) {\n        if (this.flagPlanes[i]) {\n            var bitplane = this.flagPlanes[i]; \n            var byteIndex = this.sizex * y + x;\n            var bitIndex = byteIndex & 7;\n            var bitMask = 1 << bitIndex;\n            byteIndex >>= 3;\n            \n            if (bitplane[byteIndex] & bitMask) {\n                switch(i) {\n                case 0:\n                    this.nodes[y*this.sizex+x].alien = true;\n                    break;       \n                }\n            }\n        }\n    }\n};\n\n\nMapMetatile.prototype.applyMetatatileCredits = function() {\n    for (var y = 0; y < this.sizey; y++) {\n        for (var x = 0; x < this.sizex; x++) {\n            var byteIndex = this.sizex * y + x;\n            var bitIndex = byteIndex & 7;\n            var bitMask = 1 << bitIndex;\n            byteIndex >>= 3;\n\n            for (var i = 0, li = this.credits.length; i < li; i++) {\n                if (this.credits[i].creditMask[byteIndex] & bitMask) {\n                    var id = this.credits[i].creditId;\n                    if (id) {\n                        this.nodes[y*this.sizex+x].credits.push(id);\n                    }\n                }\n            }\n        }\n    }\n};\n\n\nMapMetatile.prototype.applyMetanodeCredits = function(x, y) {\n    var byteIndex = this.sizex * y + x;\n    var bitIndex = byteIndex & 7;\n    var bitMask = 1 << bitIndex;\n    byteIndex >>= 3;\n\n    for (var i = 0, li = this.credits.length; i < li; i++) {\n        if (this.credits[i].creditMask[byteIndex] & bitMask) {\n            var id = this.credits[i].creditId;\n            if (id) {\n                this.nodes[y*this.sizex+x].credits.push(id);\n            }\n        }\n    }\n};\n\n\nMapMetatile.prototype.parseMetatatileNodes = function(stream) {\n    this.metanodesIndex = stream.index;\n    this.metanodeSize = 1 + 1 + 2 + 2 + 2 + 2;\n    \n    if (this.version >= 5) {\n        this.metanodeSize += 3 * 4;\n    } else {\n        this.metanodeSize += Math.floor((6 * (this.id[0] + 2) + 7) / 8);\n\n        if (this.version == 4) {\n            this.metanodeSize += 3 * 4;\n        }\n    }\n\n    if (this.version >= 3) {\n        if (this.flags & (1<<7)) {\n            this.metanodeSize += 2;\n        } else if (this.flags & (1<<6)) {\n            this.metanodeSize += 1;\n        }\n    }\n\n    if (this.lod >= this.map.measure.minDivisionNodeDepth) {\n        this.divisionNode = this.map.measure.getSpatialDivisionNodeAndExtents([this.lod, this.metatileIdx + this.offsetx, this.metatileIdy + this.offsety]);\n        if (this.divisionNode) {\n            this.divisionNode = this.divisionNode[0];\n        }\n    } else {\n        this.divisionNode = null;\n    }\n    \n    this.nodes = new Array(this.sizex*this.sizey);\n    \n    /*\n    var index = 0;\n\n    for (var y = 0; y < this.sizey; y++) {\n        for (var x = 0; x < this.sizex; x++) {\n            this.nodes[index] = (new MapMetanode(this, [this.lod, this.metatileIdx + this.offsetx + x, this.metatileIdy + this.offsety + y], stream, divisionNode));\n            index++;\n        }\n    }\n    \n    this.applyMetatatileCredits();\n    this.applyMetatatileBitplanes();\n    */\n};\n\n\nexport default MapMetatile;\n","\nvar GpuMesh = function(gpu, meshData, fileSize, core, direct, use16bit, verticesUnnormalized) {\n    this.gpu = gpu;\n    this.gl = gpu.gl;\n    this.bbox = meshData.bbox; //< bbox copy from Mesh\n    this.fileSize = fileSize; //used for stats\n    this.core = core;\n    this.vertexBuffer = null;\n    this.uvBuffer = null;\n    this.uv2Buffer = null;\n    this.use16bit = use16bit ? true : false;\n    this.verticesUnnormalized = verticesUnnormalized ? true : false;\n    this.size = 0;\n\n    var vertices = meshData.vertices;\n    var uvs = meshData.uvs;\n    var uvs2 = meshData.uvs2;\n    var indices = meshData.indices;\n    var vertexSize = meshData.vertexSize || 3;\n    var uvSize = meshData.uvSize || 2;\n    var uv2Size = meshData.uv2Size || 2;\n\n    var gl = this.gl;\n\n    if (!vertices || !gl) {\n        return;\n    }\n\n    //create vertex buffer\n    this.vertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n\n    //when direct mode is used vertices can be also unit16\n    gl.bufferData(gl.ARRAY_BUFFER, direct ? vertices : (new Float32Array(vertices)), gl.STATIC_DRAW);\n    this.vertexBuffer.itemSize = vertexSize;\n    this.vertexBuffer.numItems = vertices.length / vertexSize;\n\n    if (uvs != null) {\n        //create texture coords buffer\n        this.uvBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);\n\n        gl.bufferData(gl.ARRAY_BUFFER, direct ? uvs : (new Float32Array(uvs)), gl.STATIC_DRAW);\n        this.uvBuffer.itemSize = uvSize;\n        this.uvBuffer.numItems = uvs.length / uvSize;\n    }\n\n    if (uvs2 != null) {\n        //create texture coords buffer\n        this.uv2Buffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.uv2Buffer);\n\n        gl.bufferData(gl.ARRAY_BUFFER, direct ? uvs2 : (new Float32Array(uvs2)), gl.STATIC_DRAW);\n        this.uv2Buffer.itemSize = uv2Size;\n        this.uv2Buffer.numItems = uvs2.length / uv2Size;\n    }\n\n    if (indices != null) {\n        //create index buffer\n        this.indexBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n\n        gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, direct ? indices : (new Uint16Array(indices)), gl.STATIC_DRAW);\n        this.indexBuffer.itemSize = 1;\n        this.indexBuffer.numItems = indices.length;\n    }\n\n    var varSize = this.use16bit ? 2 : 4;\n    this.size = this.vertexBuffer.numItems * vertexSize * varSize;\n    this.size += (uvs) ? this.uvBuffer.numItems * uvSize * varSize : 0;\n    this.size += (uvs2) ? this.uv2Buffer.numItems * uv2Size * varSize : 0;\n    this.size += (indices) ? indices.length * 2 : 0;\n    this.polygons = (indices) ? indices.length / 3 : this.vertexBuffer.numItems / 3;\n\n    this.valid = true;\n};\n\n//destructor\nGpuMesh.prototype.kill = function() {\n    if (!this.gl || !this.valid) {\n        return;\n    }\n\n    if (this.vertexBuffer) {\n        this.gl.deleteBuffer(this.vertexBuffer);\n    }\n    \n    if (this.uvBuffer) {\n        this.gl.deleteBuffer(this.uvBuffer);\n    }\n\n    if (this.uv2Buffer) {\n        this.gl.deleteBuffer(this.uv2Buffer);\n    }\n\n    if (this.indexBuffer) {\n        this.gl.deleteBuffer(this.indexBuffer);\n    }\n    \n    this.vertexBuffer = null;\n    this.uvBuffer = null;\n    this.uv2Buffer = null;\n    this.indexBuffer = null;\n};\n\n// Draws the mesh, given the two vertex shader attributes locations.\nGpuMesh.prototype.draw = function(program, attrVertex, attrUV, attrUV2, attrBarycenteric, skipDraw) {\n    var gl = this.gl;\n    if (gl == null || !this.valid) {\n        return;\n    }\n\n    if (this.use16bit) {\n        //bind vetex positions\n        var vertexAttribute = program.getAttribute(attrVertex);\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n        gl.vertexAttribPointer(vertexAttribute, this.vertexBuffer.itemSize, gl.UNSIGNED_SHORT, !this.verticesUnnormalized, 0, 0);\n\n        //bind texture coords\n        if (this.uvBuffer && attrUV) {\n            var uvAttribute = program.getAttribute(attrUV);\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);\n            gl.vertexAttribPointer(uvAttribute, this.uvBuffer.itemSize, gl.UNSIGNED_SHORT, true, 0, 0);\n        }\n\n        if (this.uv2Buffer && attrUV2) {\n            var uv2Attribute = program.getAttribute(attrUV2);\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.uv2Buffer);\n            gl.vertexAttribPointer(uv2Attribute, this.uv2Buffer.itemSize, gl.UNSIGNED_SHORT, true, 0, 0);\n        }\n    } else {\n        //bind vetex positions\n        var vertexAttribute = program.getAttribute(attrVertex);\n        gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n        gl.vertexAttribPointer(vertexAttribute, this.vertexBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n        //bind texture coords\n        if (this.uvBuffer && attrUV) {\n            var uvAttribute = program.getAttribute(attrUV);\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.uvBuffer);\n            gl.vertexAttribPointer(uvAttribute, this.uvBuffer.itemSize, gl.FLOAT, false, 0, 0);\n        }\n\n        if (this.uv2Buffer && attrUV2) {\n            var uv2Attribute = program.getAttribute(attrUV2);\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.uv2Buffer);\n            gl.vertexAttribPointer(uv2Attribute, this.uv2Buffer.itemSize, gl.FLOAT, false, 0, 0);\n        }\n    }\n\n    if (attrBarycenteric && attrBarycenteric) {\n        var barycentericAttribute = program.getAttribute(attrBarycenteric);\n        \n        if (barycentericAttribute != -1) {\n            gl.bindBuffer(gl.ARRAY_BUFFER, this.gpu.barycentricBuffer);\n            gl.vertexAttribPointer(barycentericAttribute, this.gpu.barycentricBuffer.itemSize, gl.FLOAT, false, 0, 0);\n        }\n    }\n\n    //draw polygons\n    if (this.indexBuffer) {\n        gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, this.indexBuffer);\n\n        if (!skipDraw) gl.drawElements(gl.TRIANGLES, this.indexBuffer.numItems, gl.UNSIGNED_SHORT, 0);\n    }  else {\n        if (!skipDraw) gl.drawArrays(gl.TRIANGLES, 0, this.vertexBuffer.numItems);\n    }\n};\n\n\n// Returns GPU RAM used, in bytes.\nGpuMesh.prototype.getSize = function(){ return this.size; };\n\n\nGpuMesh.prototype.getBBox = function(){ return this.bbox; };\n\n\nGpuMesh.prototype.getPolygons = function(){ return this.polygons; };\n\n\nexport default GpuMesh;\n\n","// An index-less mesh. Each triangle has three items in the array 'vertices'.\n\nimport {mat4 as mat4_} from '../utils/matrix';\nimport {math as math_} from '../utils/math';\nimport GpuMesh_ from '../renderer/gpu/mesh';\nimport BBox_ from '../renderer/bbox';\n\n//get rid of compiler mess\nvar mat4 = mat4_;\nvar math = math_;\nvar GpuMesh = GpuMesh_;\nvar BBox = BBox_;\n\n\nvar MapSubmesh = function(mesh, stream) {\n    this.generateLines = true;\n    this.map = mesh.map;\n    this.vertices = null;\n    this.internalUVs = null;\n    this.externalUVs = null;\n    this.indices = null;\n    this.mesh = mesh;\n    this.statsCounter = 0;\n    this.valid = true;\n    this.killed = false;\n    this.use16bit = mesh.use16bit;\n\n    this.bbox = new BBox();\n    this.size = 0;    \n    this.faces = 0;\n    this.uvArea = 0;\n    this.uvAreaComputed = false;\n\n    this.flagsInternalTexcoords =  1;\n    this.flagsExternalTexcoords =  2;\n    this.flagsPerVertexUndulation =  4;\n    this.flagsTextureMode =  8;\n\n    if (stream) {\n        this.parseSubmesh(stream);\n    }\n};\n\n\nMapSubmesh.prototype.kill = function () {\n    this.killed = true;\n    this.vertices = null;\n    this.internalUVs = null;\n    this.externalUVs = null;\n    this.indices = null;\n};\n\n\n// Reads the mesh from the binary representation.\nMapSubmesh.prototype.parseSubmesh = function (stream) {\n\n/*\nstruct MapSubmesh {\n    struct MapSubmeshHeader header;\n    struct VerticesBlock vertices;\n    struct TexcoordsBlock internalTexcoords;   // if header.flags & ( 1 << 0 )\n    struct FacesBlock faces;\n};\n*/\n    this.parseHeader(stream);\n    if (this.mesh.version >= 3) {\n        this.parseVerticesAndFaces2(stream);\n    } else {\n        this.parseVerticesAndFaces(stream);\n    }\n};\n\n\nMapSubmesh.prototype.parseHeader = function (stream) {\n\n/*\nstruct MapSubmeshHeader {\n    char flags;                    // bit 0 - contains internal texture coords\n                                   // bit 1 - contains external texture coords\n                                   // bit 2 - contains per vertex undulation\n                                   // bit 3 - texture mode (0 - internal, 1 - external)\n    \n    uchar surfaceReference;        // reference to the surface of origin, see bellow\n    ushort textureLayer;           // applicable if texture mode is external: texture layer numeric id\n    double boundingBox[2][3];      // read more about bounding box bellow\n};\n*/\n\n    var streamData = stream.data;\n\n    this.flags = streamData.getUint8(stream.index, true); stream.index += 1;\n\n    if (this.mesh.version > 1) {\n        this.surfaceReference = streamData.getUint8(stream.index, true); stream.index += 1;\n    } else {\n        this.surfaceReference = 0;\n    }\n\n    this.textureLayer = streamData.getUint16(stream.index, true); stream.index += 2;\n    this.textureLayer2 = this.textureLayer; //hack for presentation\n\n    var bboxMin = this.bbox.min;\n    var bboxMax = this.bbox.max;\n\n    bboxMin[0] = streamData.getFloat64(stream.index, true); stream.index += 8;\n    bboxMin[1] = streamData.getFloat64(stream.index, true); stream.index += 8;\n    bboxMin[2] = streamData.getFloat64(stream.index, true); stream.index += 8;\n\n    bboxMax[0] = streamData.getFloat64(stream.index, true); stream.index += 8;\n    bboxMax[1] = streamData.getFloat64(stream.index, true); stream.index += 8;\n    bboxMax[2] = streamData.getFloat64(stream.index, true); stream.index += 8;\n    \n    this.bbox.updateMaxSize();\n};\n\n\nMapSubmesh.prototype.parseVerticesAndFaces = function (stream) {\n/*\nstruct VerticesBlock {\n    ushort numVertices;              // number of vertices\n\n    struct Vertex {                  // array of vertices, size of array is defined by numVertices property\n        // vertex coordinates\n        ushort x;\n        ushort y;\n        ushort z;\n\n        // if header.flags & ( 1 << 1 ): external texture coordinates\n        // values in 2^16^ range represents the 0..1 normalized texture space\n        ushort eu;\n        ushort ev;\n\n        // if header.flags & ( 1 << 2 ): undulation delta\n        float16 undulationDelta;\n    } vertices[];\n};\n*/\n\n    var data = stream.data;\n    var index = stream.index;\n    var uint8Data = stream.uint8Data;\n\n    var numVertices = data.getUint16(index, true); index += 2;\n\n    if (!numVertices) {\n        this.valid = false;\n    }\n\n    var internalUVs = null;\n    var externalUVs = null;\n    var onlyOneUVs = this.map.config.mapOnlyOneUVs && (this.flags & this.flagsInternalTexcoords);\n\n    var vertices = this.use16bit ? (new Uint16Array(numVertices * 3)) : (new Float32Array(numVertices * 3));\n\n    if (this.flags & this.flagsExternalTexcoords) {\n        if (onlyOneUVs) {\n            externalUVs = true;\n        } else {\n            externalUVs = this.use16bit ? (new Uint16Array(numVertices * 2)) : (new Float32Array(numVertices * 2));\n        }\n    }\n\n    var uvfactor = this.use16bit ? 1.0 : (1.0 / 65535);\n    var vindex = 0;\n    var uvindex = 0;\n    var i, li;\n\n    for (i = 0; i < numVertices; i++) {\n        vertices[vindex] = (uint8Data[index] + (uint8Data[index + 1]<<8)) * uvfactor;\n        vertices[vindex+1] = (uint8Data[index+2] + (uint8Data[index + 3]<<8)) * uvfactor;\n        vertices[vindex+2] = (uint8Data[index+4] + (uint8Data[index + 5]<<8)) * uvfactor;\n        vindex += 3;\n\n        if (externalUVs) {\n            if (!onlyOneUVs) {\n                externalUVs[uvindex] = (uint8Data[index+6] + (uint8Data[index + 7]<<8)) * uvfactor;\n                externalUVs[uvindex+1] = (65535 - (uint8Data[index+8] + (uint8Data[index + 9]<<8))) * uvfactor;\n                uvindex += 2;\n            }\n            index += 10;\n        } else {\n            index += 6;\n        }\n    }\n\n\n    this.tmpVertices = vertices;\n    this.tmpExternalUVs = externalUVs;\n   \n/*\nstruct TexcoorsBlock {\n    ushort numTexcoords;              // number of texture coordinates\n\n    struct TextureCoords {            // array of texture coordinates, size of array is defined by numTexcoords property\n\n        // internal texture coordinates\n        // values in 2^16^ range represents the 0..1 normalized texture space\n        ushort u;\n        ushort v;\n    } texcoords[];\n};\n*/\n\n    if (this.flags & this.flagsInternalTexcoords) {\n        var numUVs = data.getUint16(index, true); index += 2;\n    \n        internalUVs = this.use16bit ? (new Uint16Array(numUVs * 2)) : (new Float32Array(numUVs * 2));\n        //var uvfactor = 1.0 / 65535;\n    \n        for (i = 0, li = numUVs * 2; i < li; i+=2) {\n            internalUVs[i] = (uint8Data[index] + (uint8Data[index + 1]<<8)) * uvfactor;\n            internalUVs[i+1] = (65535 - (uint8Data[index+2] + (uint8Data[index + 3]<<8))) * uvfactor;\n            index += 4;\n        }\n    \n        this.tmpInternalUVs = internalUVs;\n    }\n\n/*\nstruct FacesBlock {\n    ushort numFaces;              // number of faces\n\n    struct Face {                 // array of faces, size of array is defined by numFaces property\n\n        ushort v[3]; // array of indices to stored vertices\n        ushort t[3]; // if header.flags & ( 1 << 0 ): array of indices to stored internal texture coords\n\n    } faces[];\n};\n*/\n\n    var numFaces = data.getUint16(index, true); index += 2;\n    var indices = null;\n\n    internalUVs = null;\n    externalUVs = null;\n\n    var onlyExternalIndices = (this.map.config.mapIndexBuffers && this.map.config.mapOnlyOneUVs && !(this.flags & this.flagsInternalTexcoords));\n    var onlyInternalIndices = (this.map.config.mapIndexBuffers && this.map.config.mapOnlyOneUVs && (this.flags & this.flagsInternalTexcoords));\n    var onlyIndices = onlyExternalIndices || onlyInternalIndices;\n\n    if (onlyIndices) {\n        indices = new Uint16Array(numFaces * 3);\n    } else {\n        vertices = this.use16bit ? (new Uint16Array(numFaces * 3 * 3)) : (new Float32Array(numFaces * 3 * 3));\n\n        if (this.flags & this.flagsInternalTexcoords) {\n            internalUVs = this.use16bit ? (new Uint16Array(numFaces * 3 * 2)) : (new Float32Array(numFaces * 3 * 2));\n        }\n\n        if (!onlyOneUVs && (this.flags & this.flagsExternalTexcoords)) {\n            externalUVs = this.use16bit ? (new Uint16Array(numFaces * 3 * 2)) : (new Float32Array(numFaces * 3 * 2));\n        }\n    }\n\n    var vtmp = this.tmpVertices;\n    var eUVs = this.tmpExternalUVs;\n    var iUVs = this.tmpInternalUVs;\n    var v1, v2, v3, vv1, vv2, vv3, sindex;\n\n    if (onlyExternalIndices) {\n        vertices = this.tmpVertices;\n        externalUVs = this.tmpExternalUVs;\n    }\n\n    if (onlyInternalIndices) {\n        vertices = this.use16bit ? (new Uint16Array((iUVs.length / 2) * 3)) : (new Float32Array((iUVs.length / 2) * 3));\n        internalUVs = this.tmpInternalUVs;\n    }\n\n    for (i = 0; i < numFaces; i++) {\n        v1 = (uint8Data[index] + (uint8Data[index + 1]<<8));\n        v2 = (uint8Data[index+2] + (uint8Data[index + 3]<<8));\n        v3 = (uint8Data[index+4] + (uint8Data[index + 5]<<8));\n\n        if (onlyIndices) {\n            vindex = i * 3;\n\n            if (internalUVs != null) {\n                vv1 = (uint8Data[index+6] + (uint8Data[index + 7]<<8));\n                vv2 = (uint8Data[index+8] + (uint8Data[index + 9]<<8));\n                vv3 = (uint8Data[index+10] + (uint8Data[index + 11]<<8));\n\n                vertices[vv1*3] = vtmp[v1*3];\n                vertices[vv1*3+1] = vtmp[v1*3+1];\n                vertices[vv1*3+2] = vtmp[v1*3+2];\n\n                vertices[vv2*3] = vtmp[v2*3];\n                vertices[vv2*3+1] = vtmp[v2*3+1];\n                vertices[vv2*3+2] = vtmp[v2*3+2];\n\n                vertices[vv3*3] = vtmp[v3*3];\n                vertices[vv3*3+1] = vtmp[v3*3+1];\n                vertices[vv3*3+2] = vtmp[v3*3+2];\n\n                indices[vindex] = vv1;\n                indices[vindex+1] = vv2;\n                indices[vindex+2] = vv3;\n\n                index += 12;\n            } else {\n                indices[vindex] = v1;\n                indices[vindex+1] = v2;\n                indices[vindex+2] = v3;\n\n                index += 6;\n            }\n\n        } else {\n            vindex = i * (3 * 3);\n\n            sindex = v1 * 3;\n            vertices[vindex] = vtmp[sindex];\n            vertices[vindex+1] = vtmp[sindex+1];\n            vertices[vindex+2] = vtmp[sindex+2];\n\n            sindex = v2 * 3;\n            vertices[vindex+3] = vtmp[sindex];\n            vertices[vindex+4] = vtmp[sindex+1];\n            vertices[vindex+5] = vtmp[sindex+2];\n\n            sindex = v3 * 3;\n            vertices[vindex+6] = vtmp[sindex];\n            vertices[vindex+7] = vtmp[sindex+1];\n            vertices[vindex+8] = vtmp[sindex+2];\n\n            if (externalUVs != null) {\n                vindex = i * (3 * 2);\n                externalUVs[vindex] = eUVs[v1*2];\n                externalUVs[vindex+1] = eUVs[v1*2+1];\n                externalUVs[vindex+2] = eUVs[v2*2];\n                externalUVs[vindex+3] = eUVs[v2*2+1];\n                externalUVs[vindex+4] = eUVs[v3*2];\n                externalUVs[vindex+5] = eUVs[v3*2+1];\n            }\n\n            if (internalUVs != null) {\n                v1 = (uint8Data[index+6] + (uint8Data[index + 7]<<8));\n                v2 = (uint8Data[index+8] + (uint8Data[index + 9]<<8));\n                v3 = (uint8Data[index+10] + (uint8Data[index + 11]<<8));\n                index += 12;\n\n                vindex = i * (3 * 2);\n                internalUVs[vindex] = iUVs[v1*2];\n                internalUVs[vindex+1] = iUVs[v1*2+1];\n                internalUVs[vindex+2] = iUVs[v2*2];\n                internalUVs[vindex+3] = iUVs[v2*2+1];\n                internalUVs[vindex+4] = iUVs[v3*2];\n                internalUVs[vindex+5] = iUVs[v3*2+1];\n            } else {\n                index += 6;\n            }\n        }\n    }\n\n    this.vertices = vertices;\n    this.internalUVs = internalUVs;\n    this.externalUVs = externalUVs;\n    this.indices = indices;\n\n    this.tmpVertices = null;\n    this.tmpInternalUVs = null;\n    this.tmpExternalUVs = null;\n\n    stream.index = index;\n\n    this.size = this.vertices.byteLength;\n    if (this.internalUVs) this.size += this.internalUVs.byteLength;\n    if (this.externalUVs) this.size += this.externalUVs.byteLength;\n    if (this.indices) this.size += this.indices.byteLength;\n    this.faces = numFaces;\n};\n\n\nMapSubmesh.prototype.parseWord = function (data, res) {\n    var value = data[res[1]];\n    \n    if (value & 0x80) {\n        res[0] = (value & 0x7f) | (data[res[1]+1] << 7);\n        res[1] += 2;\n    } else {\n        res[0] = value;\n        res[1] ++;\n    }\n};\n\n\nMapSubmesh.prototype.parseDelta = function (data, res) {\n    var value = data[res[1]];\n    \n    if (value & 0x80) {\n        value = (value & 0x7f) | (data[res[1]+1] << 7);\n\n        if (value & 1) {\n            res[0] = -((value >> 1)+1); \n            res[1] += 2;\n        } else {\n            res[0] = (value >> 1); \n            res[1] += 2;\n        }\n    } else {\n        if (value & 1) {\n            res[0] = -((value >> 1)+1); \n            res[1] ++;\n        } else {\n            res[0] = (value >> 1); \n            res[1] ++;\n        }\n    }\n};\n\n\nMapSubmesh.prototype.parseVerticesAndFaces2 = function (stream) {\n/*\nstruct VerticesBlock {\n    ushort numVertices;              // number of vertices\n    ushort geomQuantCoef;            // geometry quantization coefficient\n\n    struct Vertex {                  // array of vertices, size of array is defined by numVertices property\n        // vertex coordinates\n        delta x;\n        delta y;\n        delta z;\n    } vertices[];\n};\n*/\n\n    var data = stream.data;\n    var index = stream.index;\n    var uint8Data = stream.uint8Data;\n    var onlyOneUVs = this.map.config.mapOnlyOneUVs && (this.flags & this.flagsInternalTexcoords);\n\n    var numVertices = data.getUint16(index, true); index += 2;\n    var quant = data.getUint16(index, true); index += 2;\n\n    if (!numVertices) {\n        this.valid = false;\n    }\n\n    var center = this.bbox.center();\n    var scale = this.bbox.maxSize;\n\n    var multiplier = 1.0 / quant;\n    var externalUVs = null;\n\n    var vertices = this.use16bit ? (new Uint16Array(numVertices * 3)) : (new Float32Array(numVertices * 3));\n    var vindex;\n    \n    var x = 0, y = 0,z = 0;\n    var cx = center[0], cy = center[1], cz = center[2];\n    var mx = this.bbox.min[0];\n    var my = this.bbox.min[1];\n    var mz = this.bbox.min[2];\n    var sx = 1.0 / (this.bbox.max[0] - this.bbox.min[0]);\n    var sy = 1.0 / (this.bbox.max[1] - this.bbox.min[1]);\n    var sz = 1.0 / (this.bbox.max[2] - this.bbox.min[2]);\n    \n    var res = [0, index];\n    var i, li, t;\n\n    if (this.use16bit) {\n        for (i = 0; i < numVertices; i++) {\n            this.parseDelta(uint8Data, res);\n            x += res[0];\n            this.parseDelta(uint8Data, res);\n            y += res[0];\n            this.parseDelta(uint8Data, res);\n            z += res[0];\n            \n            vindex = i * 3;\n            t = ((x * multiplier * scale + cx) - mx) * sx;\n            if (t < 0) t = 0; if (t > 1.0) t = 1.0;\n            vertices[vindex] = t * 65535;\n            t = ((y * multiplier * scale + cy) - my) * sy;\n            if (t < 0) t = 0; if (t > 1.0) t = 1.0;\n            vertices[vindex+1] = t * 65535;\n            t = ((z * multiplier * scale + cz) - mz) * sz;\n            if (t < 0) t = 0; if (t > 1.0) t = 1.0;\n            vertices[vindex+2] = t * 65535;\n        }\n    } else {\n        for (i = 0; i < numVertices; i++) {\n            this.parseDelta(uint8Data, res);\n            x += res[0];\n            this.parseDelta(uint8Data, res);\n            y += res[0];\n            this.parseDelta(uint8Data, res);\n            z += res[0];\n            \n            vindex = i * 3;\n            vertices[vindex] = ((x * multiplier * scale + cx) - mx) * sx;\n            vertices[vindex+1] = ((y * multiplier * scale + cy) - my) * sy;\n            vertices[vindex+2] = ((z * multiplier * scale + cz) - mz) * sz;\n        }\n    }\n    \n    index = res[1];\n\n    if (this.flags & this.flagsExternalTexcoords) {\n        quant = data.getUint16(index, true); index += 2;\n        res[1] = index;\n\n        if (onlyOneUVs) {\n\n            for (i = 0; i < numVertices; i++) {\n                this.parseDelta(uint8Data, res);\n                this.parseDelta(uint8Data, res);\n            }\n\n        } else {\n            multiplier = (this.use16bit) ? (65535 / quant) : (1.0 / quant);\n            externalUVs = this.use16bit ? (new Uint16Array(numVertices * 2)) : (new Float32Array(numVertices * 2));\n            x = 0, y = 0;\n\n            if (this.use16bit) {\n                for (i = 0; i < numVertices; i++) {\n                    this.parseDelta(uint8Data, res);\n                    x += res[0];\n                    this.parseDelta(uint8Data, res);\n                    y += res[0];\n\n                    var uvindex = i * 2;\n                    t = x * multiplier;\n                    if (t < 0) t = 0; if (t > 65535) t = 65535;\n                    externalUVs[uvindex] = t;\n                    t = y * multiplier;\n                    if (t < 0) t = 0; if (t > 65535) t = 65535;\n                    externalUVs[uvindex+1] = 65535 - t;\n                }\n            } else {\n                for (i = 0; i < numVertices; i++) {\n                    this.parseDelta(uint8Data, res);\n                    x += res[0];\n                    this.parseDelta(uint8Data, res);\n                    y += res[0];\n\n                    var uvindex = i * 2;\n                    externalUVs[uvindex] = x * multiplier;\n                    externalUVs[uvindex+1] = 1 - (y * multiplier);\n                }\n            }\n        }\n    }\n\n    index = res[1];\n\n    this.tmpVertices = vertices;\n    this.tmpExternalUVs = externalUVs;\n    \n/*\nstruct TexcoorsBlock {\n    ushort numTexcoords;              // number of texture coordinates\n\n    struct TextureCoords {            // array of texture coordinates, size of array is defined by numTexcoords property\n\n        // internal texture coordinates\n        // values in 2^16^ range represents the 0..1 normalized texture space\n        ushort u;\n        ushort v;\n    } texcoords[];\n};\n*/\n\n    if (this.flags & this.flagsInternalTexcoords) {\n        var numUVs = data.getUint16(index, true); index += 2;\n        var quantU = data.getUint16(index, true); index += 2;\n        var quantV = data.getUint16(index, true); index += 2;\n        var multiplierU = (this.use16bit) ? (65536.0 / quantU) : (1.0 / quantU);\n        var multiplierV = (this.use16bit) ? (65536.0 / quantV) : (1.0 / quantV);\n        x = 0, y = 0;\n    \n        var internalUVs = this.use16bit ? (new Uint16Array(numUVs * 2)) : (new Float32Array(numUVs * 2));\n        res[1] = index;7\n\n        if (this.use16bit) {\n            for (i = 0, li = numUVs * 2; i < li; i+=2) {\n                this.parseDelta(uint8Data, res);\n                x += res[0];\n                this.parseDelta(uint8Data, res);\n                y += res[0];\n\n                t = x * multiplierU;\n                if (t < 0) t = 0; if (t > 65535) t = 65535;\n                internalUVs[i] = t;\n                t = y * multiplierV;\n                if (t < 0) t = 0; if (t > 65535) t = 65535;\n                internalUVs[i+1] = 65535 - t;\n            }\n        } else {\n            for (i = 0, li = numUVs * 2; i < li; i+=2) {\n                this.parseDelta(uint8Data, res);\n                x += res[0];\n                this.parseDelta(uint8Data, res);\n                y += res[0];\n\n                internalUVs[i] = x * multiplierU;\n                internalUVs[i+1] = 1 - (y * multiplierV);\n            }\n        }\n\n        index = res[1];\n    \n        this.tmpInternalUVs = internalUVs;\n    }\n\n/*\nstruct FacesBlock {\n    ushort numFaces;              // number of faces\n\n    struct Face {                 // array of faces, size of array is defined by numFaces property\n\n        ushort v[3]; // array of indices to stored vertices\n        ushort t[3]; // if header.flags & ( 1 << 0 ): array of indices to stored internal texture coords\n\n    } faces[];\n};\n*/\n\n    var numFaces = data.getUint16(index, true); index += 2;\n    var indices = null;\n\n    internalUVs = null;\n    externalUVs = null;\n\n    var onlyExternalIndices = (this.map.config.mapIndexBuffers && this.map.config.mapOnlyOneUVs && !(this.flags & this.flagsInternalTexcoords));\n    var onlyInternalIndices = (this.map.config.mapIndexBuffers && this.map.config.mapOnlyOneUVs && (this.flags & this.flagsInternalTexcoords));\n    var onlyIndices = onlyExternalIndices || onlyInternalIndices;\n\n    if (onlyIndices) {\n        indices = new Uint16Array(numFaces * 3);\n    } else {\n        vertices = this.use16bit ? (new Uint16Array(numFaces * 3 * 3)) : (new Float32Array(numFaces * 3 * 3));\n\n        if (this.flags & this.flagsInternalTexcoords) {\n            internalUVs = this.use16bit ? (new Uint16Array(numFaces * 3 * 2)) : (new Float32Array(numFaces * 3 * 2));\n        }\n\n        if (!onlyOneUVs && (this.flags & this.flagsExternalTexcoords)) {\n            externalUVs = this.use16bit ? (new Uint16Array(numFaces * 3 * 2)) : (new Float32Array(numFaces * 3 * 2));\n        }\n    }\n\n    var vtmp = this.tmpVertices;\n    var eUVs = this.tmpExternalUVs;\n    var iUVs = this.tmpInternalUVs;\n    var high = 0;\n    var v1, v2, v3, vv1, vv2, vv3;\n    res[1] = index;\n\n    for (i = 0; i < numFaces; i++) {\n        this.parseWord(uint8Data, res);\n        v1 = high - res[0];\n        if (!res[0]) { high++; }\n\n        this.parseWord(uint8Data, res);\n        v2 = high - res[0];\n        if (!res[0]) { high++; }\n\n        this.parseWord(uint8Data, res);\n        v3 = high - res[0];\n        if (!res[0]) { high++; }\n\n        if (onlyIndices) {\n            vindex = i * 3;\n            indices[vindex] = v1;\n            indices[vindex+1] = v2;\n            indices[vindex+2] = v3;\n        } else {\n            vindex = i * (3 * 3);\n            var sindex = v1 * 3;\n            vertices[vindex] = vtmp[sindex];\n            vertices[vindex+1] = vtmp[sindex+1];\n            vertices[vindex+2] = vtmp[sindex+2];\n\n            sindex = v2 * 3;\n            vertices[vindex+3] = vtmp[sindex];\n            vertices[vindex+4] = vtmp[sindex+1];\n            vertices[vindex+5] = vtmp[sindex+2];\n\n            sindex = v3 * 3;\n            vertices[vindex+6] = vtmp[sindex];\n            vertices[vindex+7] = vtmp[sindex+1];\n            vertices[vindex+8] = vtmp[sindex+2];\n\n            if (externalUVs != null) {\n                vindex = i * (3 * 2);\n                externalUVs[vindex] = eUVs[v1*2];\n                externalUVs[vindex+1] = eUVs[v1*2+1];\n                externalUVs[vindex+2] = eUVs[v2*2];\n                externalUVs[vindex+3] = eUVs[v2*2+1];\n                externalUVs[vindex+4] = eUVs[v3*2];\n                externalUVs[vindex+5] = eUVs[v3*2+1];\n            }\n        }\n    }\n\n    if (onlyExternalIndices) {\n        vertices = this.tmpVertices;\n        externalUVs = this.tmpExternalUVs;\n    }\n\n    if (onlyInternalIndices) {\n        vertices = this.use16bit ? (new Uint16Array((iUVs.length / 2) * 3)) : (new Float32Array((iUVs.length / 2) * 3));\n        internalUVs = this.tmpInternalUVs;\n    }\n\n    high = 0;\n\n    if (internalUVs != null) {\n        for (i = 0; i < numFaces; i++) {\n            this.parseWord(uint8Data, res);\n            v1 = high - res[0];\n            if (!res[0]) { high++; }\n    \n            this.parseWord(uint8Data, res);\n            v2 = high - res[0];\n            if (!res[0]) { high++; }\n    \n            this.parseWord(uint8Data, res);\n            v3 = high - res[0];\n            if (!res[0]) { high++; }\n\n            if (onlyInternalIndices) {\n                vindex = i * 3;\n\n                vv1 = indices[vindex] * 3;\n                vv2 = indices[vindex+1] * 3;\n                vv3 = indices[vindex+2] * 3;\n\n                vertices[v1*3] = vtmp[vv1];\n                vertices[v1*3+1] = vtmp[vv1+1];\n                vertices[v1*3+2] = vtmp[vv1+2];\n\n                vertices[v2*3] = vtmp[vv2];\n                vertices[v2*3+1] = vtmp[vv2+1];\n                vertices[v2*3+2] = vtmp[vv2+2];\n\n                vertices[v3*3] = vtmp[vv3];\n                vertices[v3*3+1] = vtmp[vv3+1];\n                vertices[v3*3+2] = vtmp[vv3+2];\n\n                indices[vindex] = v1;\n                indices[vindex+1] = v2;\n                indices[vindex+2] = v3;\n            } else {\n                vindex = i * (3 * 2);\n                internalUVs[vindex] = iUVs[v1*2];\n                internalUVs[vindex+1] = iUVs[v1*2+1];\n                internalUVs[vindex+2] = iUVs[v2*2];\n                internalUVs[vindex+3] = iUVs[v2*2+1];\n                internalUVs[vindex+4] = iUVs[v3*2];\n                internalUVs[vindex+5] = iUVs[v3*2+1];\n            }\n        }\n    }\n\n    index = res[1];\n\n    this.vertices = vertices;\n    this.internalUVs = internalUVs;\n    this.externalUVs = externalUVs;\n    this.indices = indices;\n\n    this.tmpVertices = null;\n    this.tmpInternalUVs = null;\n    this.tmpExternalUVs = null;\n\n    stream.index = index;\n\n    this.size = this.vertices.byteLength;\n    if (this.internalUVs) this.size += this.internalUVs.byteLength;\n    if (this.externalUVs) this.size += this.externalUVs.byteLength;\n    if (this.indices) this.size += this.indices.byteLength;\n    this.faces = numFaces;\n};\n\n\n// Returns RAM usage in bytes.\nMapSubmesh.prototype.getSize = function () {\n    return this.size;\n};\n\n\nMapSubmesh.prototype.getFileSize = function () {\n    return this.fileSize;\n};\n\n\nMapSubmesh.prototype.buildGpuMesh = function () {\n    return new GpuMesh(this.map.renderer.gpu, {\n        bbox: this.bbox,\n        vertices: this.vertices,\n        uvs: this.internalUVs,\n        uvs2: this.externalUVs,\n        indices: this.indices\n    }, 1, this.map.core, true, this.use16bit);\n};\n\n\nMapSubmesh.prototype.computeUVArea = function (texture) {\n    var uvs = this.internalUVs || this.externalUVs;\n    var area = 0;\n    var fx = texture.width / 65535;\n    var fy = texture.height / 65535;\n\n    var faceArea = function(i1, i2, i3) {\n        var dx = (uvs[i2] - uvs[i1])*fx, dy = (uvs[i2+1] - uvs[i1+1])*fy;\n        var l1 = Math.sqrt(dx*dx+dy*dy);\n        dx = (uvs[i3] - uvs[i2])*fx, dy = (uvs[i3+1] - uvs[i2+1])*fy;\n        var l2 = Math.sqrt(dx*dx+dy*dy);\n        dx = (uvs[i1] - uvs[i3])*fy, dy = (uvs[i1+1] - uvs[i3+1])*fy;\n        var l3 = Math.sqrt(dx*dx+dy*dy);\n\n        var sp = (l1+l2+l3)*0.5; //semi perimeter\n\n        return Math.sqrt(Math.max(0.0,sp*(sp-l1)*(sp-l2)*(sp-l3)));\n    }\n\n    if (uvs) {\n        var indices = this.indices;\n\n        if (indices) {\n            for (var i = 0, ii = 0, li = this.faces; i < li; i++, ii+=3) {\n                area += faceArea(indices[i*3]*2, indices[i*3+1]*2, indices[i*3+2]*2);\n            }\n        } else {\n            for (var i = 0, ii = 0, li = this.faces; i < li; i++, ii+=3) {\n                area += faceArea(i*3*2, i*3*2 + 1, i*3*2 +2);\n            }\n        }\n    }\n\n    this.uvAreaComputed = true;\n    this.uvArea = area;\n};\n\n\nMapSubmesh.prototype.getWorldMatrix = function(geoPos, matrix) {\n    // Note: the current camera geographic position (geoPos) is not necessary\n    // here, in theory, but for numerical stability (OpenGL ES is float only)\n    // we get rid of the large UTM numbers in the following subtractions. The\n    // camera effectively stays in the position [0,0] and the tiles travel\n    // around it. (The Z coordinate is fine and is not handled in this way.)\n\n    var m = matrix;\n\n    if (m) {\n        m[0] = this.bbox.side(0); m[1] = 0; m[2] = 0; m[3] = 0;\n        m[4] = 0; m[5] = this.bbox.side(1); m[6] = 0; m[7] = 0;\n        m[8] = 0; m[9] = 0; m[10] = this.bbox.side(2); m[11] = 0;\n        m[12] = this.bbox.min[0] - geoPos[0]; m[13] = this.bbox.min[1] - geoPos[1]; m[14] = this.bbox.min[2] - geoPos[2]; m[15] = 1;\n    } else {\n        m = mat4.create();\n\n        mat4.multiply( math.translationMatrix(this.bbox.min[0] - geoPos[0], this.bbox.min[1] - geoPos[1], this.bbox.min[2] - geoPos[2]),\n                       math.scaleMatrix(this.bbox.side(0), this.bbox.side(1), this.bbox.side(2)), m);\n    }\n\n    return m;\n};\n\n\nMapSubmesh.prototype.getWorldMatrixSE = function(geoPos, matrix) {\n    var m = matrix;\n\n    if (m) {\n        m[0] = 1; m[1] = 0; m[2] = 0; m[3] = 0;\n        m[4] = 0; m[5] = 1; m[6] = 0; m[7] = 0;\n        m[8] = 0; m[9] = 0; m[10] = 1; m[11] = 0;\n        m[12] = this.bbox.min[0] - geoPos[0]; m[13] = this.bbox.min[1] - geoPos[1]; m[14] = this.bbox.min[2] - geoPos[2]; m[15] = 1;\n    } else {\n        m = math.translationMatrix(this.bbox.min[0] - geoPos[0], this.bbox.min[1] - geoPos[1], this.bbox.min[2] - geoPos[2]);\n    }\n\n    return m;\n};\n\n\nMapSubmesh.prototype.drawBBox = function(cameraPos) {\n    var renderer = this.map.renderer;\n\n    renderer.gpu.useProgram(renderer.progBBox, ['aPosition']);\n\n    var mvp = mat4.create();\n    var mv = mat4.create();\n\n    mat4.multiply(renderer.camera.getModelviewMatrix(), this.getWorldMatrix(cameraPos), mv);\n\n    var proj = renderer.camera.getProjectionMatrix();\n    mat4.multiply(proj, mv, mvp);\n\n    renderer.progBBox.setMat4('uMVP', mvp);\n\n    //draw bbox\n    renderer.bboxMesh.draw(renderer.progBBox, 'aPosition');\n};\n\n\nexport default MapSubmesh;\n","\nvar GpuProgram = function(gpu, vertex, fragment, variants) {\n    this.gpu = gpu;\n    this.gl = gpu.gl;\n    this.vertex = vertex;\n    this.fragment = fragment;\n    this.program = null;\n    this.uniformLocationCache = [];\n    this.attributeLocationCache = [];\n    this.m = new Float32Array(16);\n    this.ready = false;\n    this.createProgram(vertex, fragment);\n    this.variants = variants || [];\n    this.programs = {};\n};\n\n\nGpuProgram.prototype.createShader = function(source, vertexShader) {\n    var gl = this.gl;\n\n    if (!source || !gl) {\n        return null;\n    }\n\n    var shader;\n\n    if (vertexShader !== true) {\n        shader = gl.createShader(gl.FRAGMENT_SHADER);\n    } else {\n        shader = gl.createShader(gl.VERTEX_SHADER);\n    }\n\n    gl.shaderSource(shader, source);\n    gl.compileShader(shader);\n\n    if (!gl.getShaderParameter(shader, gl.COMPILE_STATUS)) {\n        var info = gl.getShaderInfoLog(shader);\n        console.log('An error occurred compiling the ' + ((vertexShader !== true) ? 'fragment' : 'vertex') + ' shaders: ' + info);\n        this.gpu.renderer.core.callListener('renderer-shader-error', { 'where':'compilation', 'info' : info });\n        return null;\n    }\n\n    return shader;\n};\n\n\nGpuProgram.prototype.createProgram = function(vertex, fragment) {\n    var gl = this.gl;\n    if (gl == null) return;\n\n    var vertexShader = this.createShader(vertex, true);\n    var fragmentShader = this.createShader(fragment, false);\n\n    if (!vertexShader ||  !fragmentShader) {\n        return;\n    }\n\n    var program = gl.createProgram();\n    gl.attachShader(program, vertexShader);\n    gl.attachShader(program, fragmentShader);\n    gl.linkProgram(program);\n\n    if (!gl.getProgramParameter(program, gl.LINK_STATUS)) {\n        console.log('Unable to initialize the shader program.');\n        this.gpu.renderer.core.callListener('renderer-shader-error', { 'where':'linking' });\n    }\n\n    gl.useProgram(program);\n\n    this.program = program;\n    this.ready = true;\n};\n\n\nGpuProgram.prototype.setSampler = function(name, index) {\n    var gl = this.gl;\n    if (gl == null || this.program == null) return;\n\n    var key = this.getUniform(name);\n    if (key != null) {\n        gl.uniform1i(key, index);\n    }\n};\n\nGpuProgram.prototype.isReady = function(name, index) {\n    return this.ready;\n};\n\nGpuProgram.prototype.setMat4 = function(name, m, zoffset) {\n    var gl = this.gl;\n    if (gl == null || this.program == null) return;\n\n    var key = this.getUniform(name);\n    if (key != null) {\n        if (zoffset) {\n            zoffset = ((1+zoffset)*2)-1;\n           \n            var m3 = this.m;\n            \n            m3[0] = m[0];  \n            m3[1] = m[1];  \n            m3[2] = m[2] * zoffset;  \n            m3[3] = m[3];  \n\n            m3[4] = m[4];  \n            m3[5] = m[5];  \n            m3[6] = m[6] * zoffset;  \n            m3[7] = m[7];  \n\n            m3[8] = m[8];\n            m3[9] = m[9];\n            m3[10] = m[10] * zoffset;  \n            m3[11] = m[11];\n\n            m3[12] = m[12];  \n            m3[13] = m[13];  \n            m3[14] = m[14] * zoffset;  \n            m3[15] = m[15];  \n\n            gl.uniformMatrix4fv(key, false, m3);\n            \n        } else {\n            gl.uniformMatrix4fv(key, false, m);\n        }\n    }\n};\n\n\nGpuProgram.prototype.setMat3 = function(name, m) {\n    var gl = this.gl;\n    if (gl == null || this.program == null) return;\n\n    var key = this.getUniform(name);\n    if (key != null) {\n        gl.uniformMatrix3fv(key, false, m);\n    }\n};\n\n\nGpuProgram.prototype.setVec2 = function(name, m) {\n    var gl = this.gl;\n    if (gl == null || this.program == null) return;\n\n    var key = this.getUniform(name);\n    if (key != null) {\n        gl.uniform2fv(key, m);\n    }\n};\n\n\nGpuProgram.prototype.setVec3 = function(name, m) {\n    var gl = this.gl;\n    if (gl == null || this.program == null) return;\n\n    var key = this.getUniform(name);\n    if (key != null) {\n        gl.uniform3fv(key, m);\n    }\n};\n\n\nGpuProgram.prototype.setVec4 = function(name, m) {\n    var gl = this.gl;\n    if (gl == null || this.program == null) return;\n\n    var key = this.getUniform(name);\n    if (key != null) {\n        gl.uniform4fv(key, m);\n    }\n};\n\n\nGpuProgram.prototype.setFloat = function(name, value) {\n    var gl = this.gl;\n    if (gl == null || this.program == null) return;\n\n    var key = this.getUniform(name);\n    if (key != null) {\n        gl.uniform1f(key, value);\n    }\n};\n\n\nGpuProgram.prototype.setFloatArray = function(name, array) {\n    var gl = this.gl;\n    if (gl == null || this.program == null) return;\n\n    var key = this.getUniform(name);\n    if (key != null) {\n        gl.uniform1fv(key, array);\n    }\n};\n\n\nGpuProgram.prototype.getAttribute = function(name) {\n    var gl = this.gl;\n    if (gl == null || this.program == null) return;\n\n    var location = this.attributeLocationCache[name];\n\n    if (location == null) {\n        location = gl.getAttribLocation(this.program, name);\n        this.attributeLocationCache[name] = location;\n    }\n\n    return location;\n};\n\n\nGpuProgram.prototype.getUniform = function(name) {\n    var gl = this.gl;\n    if (gl == null || this.program == null) return;\n\n    var location = this.uniformLocationCache[name];\n\n    if (location == null) {\n        location = gl.getUniformLocation(this.program, name);\n        this.uniformLocationCache[name] = location;\n    }\n    \n    return location;\n};\n\n\nexport default GpuProgram;\n","\nvar GpuShaders = {};\n\nGpuShaders.bboxVertexShader =\n    'attribute vec3 aPosition;\\n'+\n    'uniform mat4 uMVP;\\n'+\n    'void main(){ \\n'+\n        'gl_Position = uMVP * vec4(aPosition, 1.0);\\n'+\n    '}';\n\n\nGpuShaders.bbox2VertexShader =\n    'attribute vec3 aPosition;\\n'+\n    'uniform mat4 uMVP;\\n'+\n    'uniform float uPoints[8*3];\\n'+\n    'void main(){ \\n'+\n        'int index = int(aPosition.z) * 3; \\n'+\n        'gl_Position = uMVP * vec4(uPoints[index], uPoints[index+1], uPoints[index+2], 1.0);\\n'+\n    '}';\n\n\nGpuShaders.bboxFragmentShader = 'precision mediump float;\\n'+\n    'void main() {\\n'+\n        'gl_FragColor = vec4(0.0, 0.0, 1.0, 1.0);\\n'+\n    '}';\n\nGpuShaders.text2VertexShader =\n    'attribute vec4 aPosition;\\n'+\n    'void main(){ \\n'+\n    '}';\n\n\nGpuShaders.lineVertexShader = //line\n    '#ifndef dataPoints2\\n'+\n        'uniform mat4 uMVP;\\n'+\n    '#else\\n'+\n        'uniform mat4 uMV, uProj;\\n'+\n    '#endif\\n'+\n\n    '#ifdef pixelLine\\n'+\n        '#ifdef dataPoints2\\n'+\n            'attribute vec3 aPosition;\\n'+\n        '#else\\n'+\n            'attribute vec4 aPosition;\\n'+\n            'attribute vec4 aNormal;\\n'+\n        '#endif\\n'+\n\n        '#ifdef dataPoints\\n'+\n            'uniform vec3 uScale;\\n'+\n            'uniform vec3 uPoints[32];\\n'+\n        '#else\\n'+\n            'uniform vec2 uScale;\\n'+\n        '#endif\\n'+\n\n        '#ifdef dataPoints2\\n'+\n\n        'vec4 getClippedPixelLinePoint(vec3 p1, vec3 p2, vec3 params) {\\n'+\n            'vec2 pp1, pp2, n;\\n'+\n            'vec4 wp0 = (uMV * vec4(p1.xyz, 1.0)), pp0, pp3;\\n'+\n            'float near = gl_DepthRange.near + 0.1;\\n'+\n            //'float near = gl_DepthRange.near + 0.1 + 30000.0;\\n'+\n            'if (params.y < 0.0) {\\n'+\n                //'return vec4(8.0, 0.0, 0.0, 1.0);\\n'+\n                'if (wp0.z > -near) return vec4(8.0, 0.0, 0.0, 1.0);\\n'+\n                'pp0 = uProj * wp0;\\n'+\n                'if (params.y == -1.0) return pp0;\\n'+\n                'return pp0 + vec4((vec3(-sin(params.z)*uScale.x*uScale.z*pp0.w, cos(params.z)*uScale.y*uScale.z*pp0.w, 0.0)), 0.0);\\n'+\n            '} else {\\n'+\n                'vec3 p2 = uPoints[int(params.y)];\\n'+\n                'vec4 wp3 = (uMV * vec4(p2.xyz, 1.0));\\n'+\n                'if (wp0.z > -near) {\\n'+\n                    'vec3 dir = (wp3.xyz - wp0.xyz);\\n'+\n                    'float l = length(dir);\\n'+\n                    'dir = normalize(dir);\\n'+\n                    'float denominator = -dir.z;\\n'+\n                    'if (abs(denominator) < 0.0000001) return vec4(8.0, 0.0, 0.0, 1.0);\\n'+\n                    'float t = (near + wp0.z) / denominator;\\n'+\n                    'if (t < 0.0 || t > l) return vec4(8.0, 0.0, 0.0, 1.0);\\n'+\n                    'wp0.xyz = wp0.xyz + (dir * t);\\n'+\n                '}\\n'+\n                'pp0 = uProj * wp0;\\n'+\n                'pp3 = uProj * wp3;\\n'+\n                'pp1 = pp0.xy / pp0.w;\\n'+\n                'pp2 = pp3.xy / pp3.w;\\n'+\n                //'pp1 = pp0.xy;\\n'+\n                //'pp2 = pp3.xy;\\n'+\n                'n = normalize(pp2 - pp1);\\n'+\n                'return pp0 + vec4((vec3(-n.y*uScale.x*params.z*uScale.z*pp0.w, n.x*uScale.y*params.z*uScale.z*pp0.w, 0.0)), 0.0);\\n'+\n            '}\\n'+\n        '}\\n'+\n\n        '#endif\\n'+\n\n    '#else\\n'+\n\n        '#ifdef lineLabel2\\n'+\n\n            'attribute vec2 aPosition;\\n'+\n            'uniform vec4 uData[DSIZE];\\n'+\n            'uniform float uFile;\\n'+\n            'varying vec2 vTexCoord;\\n'+\n\n        '#else\\n'+\n\n            '#ifdef lineLabel\\n'+\n                'attribute vec4 aPosition;\\n'+\n                'attribute vec4 aTexCoord;\\n'+\n                'uniform vec4 uVec;\\n'+\n                'uniform float uFile;\\n'+\n                'varying vec2 vTexCoord;\\n'+\n            '#else\\n'+\n                'attribute vec3 aPosition;\\n'+\n            '#endif\\n'+\n\n            '#ifdef dynamicWidth\\n'+\n                'attribute vec4 aNormal;\\n'+\n                'uniform vec4 uParams;\\n'+\n            '#endif\\n'+\n\n        '#endif\\n'+\n\n    '#endif\\n'+\n\n    '#ifdef applySE\\n'+\n        'uniform mat4 uParamsSE;\\n'+\n    '#endif\\n'+\n\n    '#ifdef withElements\\n'+\n        'attribute float aElement;\\n'+\n        'varying float vElement;\\n'+\n    '#endif\\n'+\n\n\n    'void main() {\\n'+\n\n        '#ifdef withElements\\n'+\n            'vElement = aElement;\\n'+\n        '#endif\\n'+\n\n        '#ifdef dataPoints\\n'+\n            'vec3 p1 = uPoints[int(aPosition.x)];\\n'+\n        '#else \\n'+\n            '#ifndef lineLabel2\\n'+\n                'vec3 p1 = aPosition.xyz;\\n'+\n            '#endif\\n'+\n        '#endif\\n'+\n\n        '#ifdef pixelLine\\n'+\n            '#ifndef dataPoints\\n'+\n                'vec3 p2 = aNormal.xyz;\\n'+\n            '#endif\\n'+\n        '#endif\\n'+\n\n        '#ifdef applySE\\n'+\n            'vec3 geoPos2 = p1.xyz*vec3(uParamsSE[0][3],uParamsSE[1][0],uParamsSE[1][1]);\\n'+\n            'vec3 geoPos = geoPos2+vec3(uParamsSE[0][0],uParamsSE[0][1],uParamsSE[0][2]);\\n'+\n            'geoPos.z *= uParamsSE[3][3];\\n'+\n            'float ll = length(geoPos);\\n'+\n            'vec3 v = geoPos * (1.0/(ll+0.0001));\\n'+\n            'float h = ll - uParamsSE[3][2];\\n'+\n            'float h2 = clamp(h, uParamsSE[2][1], uParamsSE[2][3]);\\n'+\n            'float h3 = h;\\n'+\n            'h *= (uParamsSE[2][2] + ((h2 - uParamsSE[2][1]) * uParamsSE[3][0]) * uParamsSE[3][1]);\\n'+\n            'geoPos2.xyz += v * (h - h3);\\n'+\n\n            '#ifdef pixelLine\\n'+\n\n                'vec4 pp0 = uMVP * vec4(geoPos2, 1.0);\\n'+\n\n                'if (aNormal.w == 0.0) {\\n'+\n                    'gl_Position = pp0 + vec4((vec3(aNormal.x*uScale.x*pp0.w, aNormal.y*uScale.y*pp0.w, 0.0)), 0.0);\\n'+\n                '} else {\\n'+\n                    'geoPos2 = p2.xyz*vec3(uParamsSE[0][3],uParamsSE[1][0],uParamsSE[1][1]);\\n'+\n                    'geoPos = geoPos2+vec3(uParamsSE[0][0],uParamsSE[0][1],uParamsSE[0][2]);\\n'+\n                    'geoPos.z *= uParamsSE[3][3];\\n'+\n                    'll = length(geoPos);\\n'+\n                    'v = geoPos * (1.0/(ll+0.0001));\\n'+\n                    'h = ll - uParamsSE[3][2];\\n'+\n                    'h2 = clamp(h, uParamsSE[2][1], uParamsSE[2][3]);\\n'+\n                    'h3 = h;\\n'+\n                    'h *= (uParamsSE[2][2] + ((h2 - uParamsSE[2][1]) * uParamsSE[3][0]) * uParamsSE[3][1]);\\n'+\n                    'geoPos2.xyz += v * (h - h3);\\n'+\n\n                    'vec4 pp3 = uMVP * vec4(geoPos2, 1.0);\\n'+\n                    'vec2 pp1 = pp0.xy / pp0.w;\\n'+\n                    'vec2 pp2 = pp3.xy / pp3.w;\\n'+\n                    'vec2 n = normalize(pp2 - pp1);\\n'+\n                    'gl_Position = pp0 + vec4((vec3(-n.y*uScale.x*aNormal.w*pp0.w, n.x*uScale.y*aNormal.w*pp0.w, 0.0)), 0.0);\\n'+\n                '}\\n'+\n\n            '#else\\n'+\n\n                '#ifdef lineLabel\\n'+\n\n                    'vTexCoord = aTexCoord.xy;\\n'+\n                    'if (dot(uVec.xyz, vec3(aTexCoord.z, aTexCoord.w, aPosition.w)) < 0.0) {\\n'+\n                        'gl_Position = uMVP * vec4(8.0, 0.0, 0.0, 1.0);\\n'+\n                    '}else{\\n'+\n                        'float file = floor(aTexCoord.y/4.0);\\n'+\n                        'vTexCoord.y = mod(aTexCoord.y,4.0);\\n'+\n                        'if (file != floor(uFile)) {\\n'+\n                            'gl_Position = uMVP * vec4(8.0, 0.0, 0.0, 1.0);\\n'+\n                        '}else{\\n'+\n                            'gl_Position = uMVP * vec4(geoPos2, 1.0);\\n'+\n                        '}\\n'+\n                    '}\\n'+\n\n                '#else\\n'+\n\n                    'gl_Position = uMVP * vec4(geoPos2, 1.0);\\n'+\n\n                '#endif\\n'+\n\n            '#endif\\n'+\n\n        '#else\\n'+\n\n            '#ifdef pixelLine\\n'+\n\n                '#ifdef dataPoints2\\n'+\n\n                    'vec3 p2 = uPoints[int(aPosition.y)];\\n'+\n                    'gl_Position = getClippedPixelLinePoint(p1.xyz, p2.xyz, aPosition.xyz);\\n'+\n\n                '#else\\n'+\n\n                    'vec4 pp0 = (uMVP * vec4(p1.xyz, 1.0));\\n'+\n\n                    '#ifdef dataPoints\\n'+\n\n                        'if (aPosition.y < 0.0) {\\n'+\n                            'if (aPosition.y == -1.0) {\\n'+\n                                'gl_Position = pp0;\\n'+\n                            '} else {\\n'+\n                                'gl_Position = pp0 + vec4((vec3(-sin(aPosition.z)*uScale.x*uScale.z, cos(aPosition.z)*uScale.y*uScale.z, 0.0)), 0.0);\\n'+\n                            '}\\n'+\n                        '} else {\\n'+\n                            'vec3 p2 = uPoints[int(aPosition.y)];\\n'+\n                            'vec4 pp3 = (uMVP * vec4(p2.xyz, 1.0));\\n'+\n                            'vec2 pp1 = pp0.xy / pp0.w;\\n'+\n                            'vec2 pp2 = pp3.xy / pp3.w;\\n'+\n                            'vec2 n = normalize(pp2 - pp1);\\n'+\n                            'gl_Position = pp0 + vec4((vec3(-n.y*uScale.x*aPosition.z*uScale.z, n.x*uScale.y*aPosition.z*uScale.z, 0.0)), 0.0);\\n'+\n                        '}\\n'+\n\n                    '#else\\n'+\n\n                        'if (aNormal.w == 0.0) {\\n'+\n                            'gl_Position = pp0 + vec4((vec3(aNormal.x*uScale.x*pp0.w, aNormal.y*uScale.y*pp0.w, 0.0)), 0.0);\\n'+\n                        '} else {\\n'+\n                            'vec4 pp3 = (uMVP * vec4(p2.xyz, 1.0));\\n'+\n                            'vec2 pp1 = pp0.xy / pp0.w;\\n'+\n                            'vec2 pp2 = pp3.xy / pp3.w;\\n'+\n                            'vec2 n = normalize(pp2 - pp1);\\n'+\n                            'gl_Position = pp0 + vec4((vec3(-n.y*uScale.x*aNormal.w*pp0.w, n.x*uScale.y*aNormal.w*pp0.w, 0.0)), 0.0);\\n'+\n                        '}\\n'+\n\n                    '#endif\\n'+\n\n                '#endif\\n'+\n\n            '#else\\n'+\n\n                '#ifdef lineLabel2\\n'+\n\n                    'int index = int(aPosition.x) * 3;\\n'+\n                    'vec4 data = uData[index];\\n'+\n                    'vec4 data2 = uData[index+1];\\n'+\n                    'vec4 data3 = uData[index+2];\\n'+\n\n                    'vec3 pos = vec3(data[0],data[1],data[2]);\\n'+\n                    'vec4 q = vec4(data[3],data2[0],data2[1],data2[2]);\\n'+\n                    'vec2 factor = vec2(data2[3],data3[0]);\\n'+\n                    'vec2 uv = vec2(data3[1],data3[2]);\\n'+\n                    'float duv = data3[3];\\n'+\n//                    'vec3 up = vec3(1.0,0.0,0.0);\\n'+\n  //                  'vec3 right = vec3(0.0,1.0,0.0);\\n'+\n\n                    //get up, right vectors from quaternion\n                    'float x=q[0], y=q[1], z=q[2], w=q[3];\\n'+\n                    'float x2=x+x, y2=y+y, z2=z+z, xx=x*x2, yx=y*x2, yy=y*y2;\\n'+\n                    'float zx=z*x2, zy=z*y2, zz=z*z2, wx=w*x2, wy=w*y2, wz=w*z2;\\n'+\n\n                    'vec3 right = vec3(1.0-yy-zz, yx-wz, zx+wy) * factor.x;\\n'+\n                    'vec3 up = vec3(yx+wz, 1.0-xx-zz, zy-wx) * (-factor.y);\\n'+\n\n                    /*\n                      out[0] = 1 - yy - zz;\n                      out[3] = yx - wz;\n                      out[6] = zx + wy;\n                      out[1] = yx + wz;\n                      out[4] = 1 - xx - zz;\n                      out[7] = zy - wx;\n                      out[2] = zx - wy;\n                      out[5] = zy + wx;\n                      out[8] = 1 - xx - yy;\n                    */\n\n                    'float file = floor(uv.y/4.0);\\n'+\n                    'uv.y = (uv.y-file*4.0);\\n'+\n\n                    'int corner = int(aPosition.y);\\n'+\n                    'if (corner==1){ pos+=right; uv.x+=floor(duv)*(1.0/1024.0);  }\\n'+\n                    'if (corner==2){ pos+=right; pos+=up; uv.x+=floor(duv)*(1.0/1024.0); uv.y+=fract(duv); }\\n'+\n                    'if (corner==3){ pos+=up; uv.y+=fract(duv); }\\n'+\n\n                    'vTexCoord = uv;\\n'+\n\n                    'if (file != floor(uFile)) {\\n'+\n                        'gl_Position = uMVP * vec4(8.0, 0.0, 0.0, 1.0);\\n'+\n                    '}else{\\n'+\n                        'gl_Position = uMVP * vec4(pos.xyz, 1.0);\\n'+\n                    '}\\n'+\n\n                '#else\\n'+\n\n                    '#ifdef lineLabel\\n'+\n\n                        'vTexCoord = aTexCoord.xy;\\n'+\n                        'if (dot(uVec.xyz, vec3(aTexCoord.z, aTexCoord.w, aPosition.w)) < 0.0) {\\n'+\n                            'gl_Position = uMVP * vec4(8.0, 0.0, 0.0, 1.0);\\n'+\n                        '}else{\\n'+\n                            'float file = floor(aTexCoord.y/4.0);\\n'+\n                            'vTexCoord.y = mod(aTexCoord.y,4.0);\\n'+\n                            'if (file != floor(uFile)) {\\n'+\n                                'gl_Position = uMVP * vec4(8.0, 0.0, 0.0, 1.0);\\n'+\n                            '}else{\\n'+\n                                'gl_Position = uMVP * vec4(aPosition.xyz, 1.0);\\n'+\n                            '}\\n'+\n                        '}\\n'+\n\n                    '#else\\n'+\n\n                        '#ifdef dynamicWidth\\n'+\n                            'gl_Position = uMVP * vec4(aPosition.xyz + aNormal.xyz*(abs(aNormal.w)*uParams[3]), 1.0);\\n'+\n                        '#else\\n'+\n                            'gl_Position = uMVP * vec4(aPosition, 1.0);\\n'+\n                        '#endif\\n'+\n\n                    '#endif\\n'+\n\n                '#endif\\n'+\n\n            '#endif\\n'+\n\n        '#endif\\n'+\n\n    '}';\n\n\nGpuShaders.lineFragmentShader = 'precision mediump float;\\n'+ //line\n\n    'uniform vec4 uColor;\\n'+\n\n    '#ifdef withElements\\n'+\n        'varying float vElement;\\n'+\n    '#endif\\n'+\n\n    'void main() {\\n'+\n\n        '#ifdef withElements\\n'+\n            'gl_FragColor.xyz = fract(vec3(1.0/255.0, 1.0/65025.0, 1.0/16581375.0) * vElement) + (-0.5/255.0);\\n'+\n            'gl_FragColor.w = 1.0;\\n'+\n        '#else\\n'+\n            'gl_FragColor = uColor;\\n'+\n        '#endif\\n'+\n\n    '}';\n\nGpuShaders.tlineVertexShader = // textured line\n    'attribute vec4 aPosition;\\n'+\n    'attribute vec4 aNormal;\\n'+\n    'uniform mat4 uMVP;\\n'+\n    'uniform vec2 uScale;\\n'+\n    'uniform vec4 uParams;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'void main(){ \\n'+\n        'vec4 p=vec4(aPosition.xyz, 1.0);\\n'+\n        'p.xyz+=aNormal.xyz*(abs(aNormal.w)*uParams[3]);\\n'+\n        'if (aNormal.w < 0.0){\\n'+\n            'vTexCoord=vec2(abs(aPosition.w)*uParams[0], (uParams[1]+uParams[2])*0.5);\\n'+\n        '} else {\\n'+\n            'vTexCoord=vec2(abs(aPosition.w)*uParams[0], aPosition.w < 0.0 ? uParams[1] : uParams[2]);\\n'+\n        '}\\n'+\n\n        'gl_Position = uMVP * p;\\n'+\n    '}';\n\n\nGpuShaders.etlineVertexShader = // textured line elements\n    'attribute vec4 aPosition;\\n'+\n    'attribute vec4 aNormal;\\n'+\n    'attribute float aElement;\\n'+\n    'uniform mat4 uMVP;\\n'+\n    'uniform vec2 uScale;\\n'+\n    'uniform vec4 uParams;\\n'+\n    'varying float vElement;\\n'+\n    'void main(){ \\n'+\n        'vec4 p=vec4(aPosition.xyz, 1.0);\\n'+\n        'p.xyz+=aNormal.xyz*(abs(aNormal.w)*uParams[3]);\\n'+\n        'vElement = aElement;\\n'+\n        'gl_Position = uMVP * p;\\n'+\n    '}';\n\nGpuShaders.tplineVertexShader = // textured pixel line\n    'attribute vec4 aPosition;\\n'+\n    'attribute vec4 aNormal;\\n'+\n    'uniform mat4 uMVP;\\n'+\n    'uniform vec2 uScale;\\n'+\n    'uniform vec4 uParams;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'void main(){ \\n'+\n        'vec4 pp0 = (uMVP * vec4(aPosition.xyz, 1.0));\\n'+\n        'vTexCoord=vec2(abs(aPosition.w)*uParams[0], aPosition.w < 0.0 ? uParams[1] : uParams[2]);\\n'+\n        'if (aNormal.w == 0.0) {\\n'+\n            'gl_Position = pp0 + vec4((vec3(aNormal.x*uParams[3]*uScale.x*pp0.w, aNormal.y*uParams[3]*uScale.y*pp0.w, 0.0)), 0.0);\\n'+\n        '} else {\\n'+\n            'vec2 pp1 = pp0.xy / pp0.w;\\n'+\n            'vec4 pp3 = (uMVP * vec4(aNormal.xyz, 1.0));\\n'+\n            'vec2 pp2 = pp3.xy / pp3.w;\\n'+\n            'vec2 n = normalize(pp2 - pp1);\\n'+\n            'gl_Position = pp0 + vec4((vec3(-n.y*uParams[3]*uScale.x*aNormal.w*pp0.w, n.x*uParams[3]*uScale.y*aNormal.w*pp0.w, 0.0)), 0.0);\\n'+\n        '}\\n'+\n    '}';\n\nGpuShaders.etplineVertexShader = // textured pixel line elements\n    'attribute vec4 aPosition;\\n'+\n    'attribute vec4 aNormal;\\n'+\n    'attribute float aElement;\\n'+\n    'uniform mat4 uMVP;\\n'+\n    'uniform vec2 uScale;\\n'+\n    'uniform vec4 uParams;\\n'+\n    'varying float vElement;\\n'+\n    'void main(){ \\n'+\n        'vec4 pp0 = (uMVP * vec4(aPosition.xyz, 1.0));\\n'+\n        'vElement = aElement;\\n'+\n        'if (aNormal.w == 0.0) {\\n'+\n            'gl_Position = pp0 + vec4((vec3(aNormal.x*uParams[3]*uScale.x*pp0.w, aNormal.y*uParams[3]*uScale.y*pp0.w, 0.0)), 0.0);\\n'+\n        '} else {\\n'+\n            'vec2 pp1 = pp0.xy / pp0.w;\\n'+\n            'vec4 pp3 = (uMVP * vec4(aNormal.xyz, 1.0));\\n'+\n            'vec2 pp2 = pp3.xy / pp3.w;\\n'+\n            'vec2 n = normalize(pp2 - pp1);\\n'+\n            'gl_Position = pp0 + vec4((vec3(-n.y*uParams[3]*uScale.x*aNormal.w*pp0.w, n.x*uParams[3]*uScale.y*aNormal.w*pp0.w, 0.0)), 0.0);\\n'+\n        '}\\n'+\n    '}';\n\nGpuShaders.tlineFragmentShader = 'precision mediump float;\\n'+ // textured line\n    'uniform sampler2D uSampler;\\n'+\n    'uniform vec4 uColor;\\n'+\n    'uniform vec4 uColor2;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'void main() {\\n'+\n        'vec4 c=texture2D(uSampler, vTexCoord)*uColor;\\n'+\n        'gl_FragColor = c;\\n'+\n    '}';\n\n\nGpuShaders.tblineFragmentShader = 'precision mediump float;\\n'+  // textured line with background color\n    'uniform sampler2D uSampler;\\n'+\n    'uniform vec4 uColor;\\n'+\n    'uniform vec4 uColor2;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'void main() {\\n'+\n        'vec4 c1=texture2D(uSampler, vTexCoord)*uColor;\\n'+\n        'vec4 c2=uColor2,c=c1;\\n'+\n        'c.xyz*=c.w; c2.xyz*=c2.w;\\n'+\n        'c=mix(c,c2,1.0-c.w);\\n'+\n        'c.xyz/=(c.w+0.00001);\\n'+\n        'c.w=max(c1.w,c2.w);\\n'+\n        'gl_FragColor = c;\\n'+\n    '}';\n\n\nGpuShaders.polygonVertexShader =\n    'attribute vec3 aPosition;\\n'+\n    'attribute vec3 aNormal;\\n'+\n    'uniform mat4 uMVP;\\n'+\n    'uniform mat4 uRot;\\n'+\n    'uniform vec4 uColor;\\n'+\n    'varying vec4 vColor;\\n'+\n    'void main(){ \\n'+\n        'float l = dot((uRot*vec4(aNormal,1.0)).xyz, vec3(0.0,0.0,1.0)) * 0.5;\\n'+\n        'vec3 c = uColor.xyz;\\n'+\n        'c = (l > 0.0) ? mix(c,vec3(1.0,1.0,1.0),l) : mix(vec3(0.0,0.0,0.0),c,1.0+l);\\n'+\n        'vColor = vec4(c, uColor.w);\\n'+\n        'gl_Position = uMVP * vec4(aPosition, 1.0);\\n'+\n    '}';\n\n\nGpuShaders.polygonFragmentShader = 'precision mediump float;\\n'+\n    'varying vec4 vColor;\\n'+\n    'void main() {\\n'+\n        'gl_FragColor = vColor;\\n'+\n    '}';\n\n\nGpuShaders.iconVertexShader =\n    'attribute vec4 aPosition;\\n'+\n    'attribute vec4 aTexCoord;\\n'+\n    'attribute vec3 aOrigin;\\n'+\n    'uniform mat4 uMVP;\\n'+\n    'uniform vec4 uScale;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'void main(){ \\n'+\n        'vTexCoord = aTexCoord.xy * uScale[2];\\n'+\n        'vec4 pos = (uMVP * vec4(aOrigin, 1.0));\\n'+\n        'gl_Position = pos + vec4(aPosition.x*uScale.x*pos.w, (aPosition.y+uScale.w)*uScale.y*pos.w, 0.0, 0.0);\\n'+\n    '}';\n\nGpuShaders.icon2VertexShader =\n    'attribute vec4 aPosition;\\n'+\n    'attribute vec4 aTexCoord;\\n'+\n    'attribute vec3 aOrigin;\\n'+\n    'uniform mat4 uMVP;\\n'+\n    'uniform vec4 uScale;\\n'+\n    'uniform float uFile;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    //'float round(float x) { return floor(x + 0.5); }\\n'+\n    'void main(){ \\n'+\n        'vTexCoord = aTexCoord.xy * uScale[2];\\n'+\n        'float file = floor(aTexCoord.y/4.0);\\n'+\n        'vTexCoord.y = mod(aTexCoord.y,4.0);\\n'+\n        'if (file != floor(uFile)) {\\n'+\n            'gl_Position = uMVP * vec4(8.0, 0.0, 0.0, 1.0);\\n'+\n        '}else{\\n'+\n            'vec4 pos = (uMVP * vec4(aOrigin, 1.0));\\n'+\n            //'pos.x = (floor((pos.x/pos.w)*800.0+0.5)/800.0)*pos.w;\\n'+\n            //'pos.y = (floor((pos.y/pos.w)*410.0+0.5)/410.0)*pos.w;\\n'+\n            'gl_Position = pos + vec4(aPosition.x*uScale.x*pos.w, (aPosition.y+uScale.w)*uScale.y*pos.w, 0.0, 0.0);\\n'+\n        '}'+\n    '}';\n\n\nGpuShaders.icon3VertexShader =\n    'attribute vec2 aPosition;\\n'+\n    'uniform mat4 uProjectionMatrix;\\n'+\n    'uniform vec4 uScale;\\n'+\n    'uniform vec3 uOrigin;\\n'+\n    'uniform vec4 uData[DSIZE];\\n'+\n    'uniform float uFile;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'void main(){ \\n'+\n        'int index = int(aPosition.x);\\n'+\n        'vec4 data = uData[index];\\n'+\n        'vec4 data2 = uData[index+1];\\n'+\n        'vec4 v;\\n'+\n        'int corner = int(aPosition.y);\\n'+\n        'if (corner==0) v = vec4(data.x, data.y, data2.x, data2.y);\\n'+\n        'if (corner==1) v = vec4(data.z, data.y, data2.z, data2.y);\\n'+\n        'if (corner==2) v = vec4(data.z, data.w, data2.z, data2.w);\\n'+\n        'if (corner==3) v = vec4(data.x, data.w, data2.x, data2.w);\\n'+\n        'vTexCoord = vec2(v.z, v.w);\\n'+\n        'float file = floor(v.w/4.0);\\n'+\n        //'vTexCoord.y = mod(v.w,4.0);\\n'+\n        'vTexCoord.y = (v.w-file*4.0);\\n'+\n\n        'if (file != floor(uFile)) {\\n'+\n            'gl_Position = uProjectionMatrix * vec4(2.0, 0.0, 0.0, 2.0);\\n'+\n        '}else{\\n'+\n            'vec4 pos = (uProjectionMatrix * vec4(uOrigin.xyz, 1.0));\\n'+\n            'gl_Position = pos + vec4(v.x*uScale.x*pos.w, v.y*uScale.y*pos.w, 0.0, 0.0);\\n'+\n        '}'+\n    '}';\n\nGpuShaders.textFragmentShader = 'precision mediump float;\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'uniform vec4 uColor;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'void main() {\\n'+\n        'vec4 c=texture2D(uSampler, vTexCoord);\\n'+\n        'if(c.w < 0.01){ discard; }\\n'+\n        'gl_FragColor = c*uColor;\\n'+\n    '}';\n\nGpuShaders.text2FragmentShader = 'precision mediump float;\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'uniform vec4 uColor;\\n'+\n    'uniform vec2 uParams;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'float round(float x) { return floor(x + 0.5); }\\n'+\n\n    'void main() {\\n'+\n        'vec2 uv=(vTexCoord);\\n'+\n        'uv.y=fract(uv.y);\\n'+\n        'vec4 c=texture2D(uSampler, uv);\\n'+\n\n        'float r = 0.0;\\n'+\n        'int i=int(floor(vTexCoord.y));\\n'+\n\n        'if (i == 0) r=c.x;else\\n'+\n        'if (i == 1) r=c.y;else\\n'+\n        'if (i == 2) r=c.z;else\\n'+\n        'if (i == 3) r=c.w;\\n'+\n\n        'float u_buffer = uParams[0];\\n'+\n        'float u_gamma = uParams[1];\\n'+\n        'float alpha = uColor.a * smoothstep(u_buffer - u_gamma, u_buffer + u_gamma, r);\\n'+\n\n        //'gl_FragColor = vec4(0.0,0.0,1.0,1.0);\\n'+\n\n        'if(alpha < 0.01){ discard; }\\n'+\n        'gl_FragColor = vec4(uColor.rgb, alpha);\\n'+\n    '}';\n\nGpuShaders.skydomeVertexShader =\n    'attribute vec3 aPosition;\\n'+\n    'attribute vec2 aTexCoord;\\n'+\n    'uniform mat4 uMVP;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'void main(){ \\n'+\n        'gl_Position = uMVP * vec4(aPosition, 1.0);\\n'+\n        'vTexCoord = aTexCoord;\\n'+\n    '}';\n\n\nGpuShaders.skydomeFragmentShader = 'precision mediump float;\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'const vec4 gray = vec4(0.125, 0.125, 0.125, 1.0);\\n'+\n    'void main() {\\n'+\n        'float fade = smoothstep(0.51, 0.55, vTexCoord.t);\\n'+\n        'gl_FragColor = mix(texture2D(uSampler, vTexCoord), gray, fade);\\n'+\n    '}';\n\n\nGpuShaders.stardomeFragmentShader = 'precision mediump float;\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'void main() {\\n'+\n        'gl_FragColor = texture2D(uSampler, vTexCoord);\\n'+\n    '}';\n\n\nGpuShaders.atmoVertexShader =\n    'attribute vec3 aPosition;\\n'+\n    'attribute vec2 aTexCoord;\\n'+\n    'uniform mat4 uMV, uProj;\\n'+\n    'uniform mat3 uNorm;\\n'+\n    'varying vec3 vNormal;\\n'+\n    'varying vec4 vPosition;\\n'+\n    'void main(){ \\n'+\n        'vec4 camSpacePos = uMV * vec4(aPosition, 1.0);\\n'+\n        'gl_Position = uProj * camSpacePos;\\n'+\n        'vec4 c = uMV * vec4(aPosition, 1.0);\\n'+\n        'vNormal = (aPosition.xyz - vec3(0.5));\\n'+\n        'vPosition = camSpacePos;\\n'+\n    '}';\n\n\nGpuShaders.atmoFragmentShader = 'precision mediump float;\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'uniform vec4 uParams;\\n'+       //[radius, atmoSize, 0 ,0]\n    'uniform vec4 uParams2;\\n'+       //[radius, atmoSize, 0 ,0]\n    'varying vec4 vPosition;\\n'+\n    'varying vec3 vNormal;\\n'+\n    'uniform vec4 uFogColor;\\n'+ //= vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\\n'+\n    'uniform vec4 uFogColor2;\\n'+ //= vec4(72.0/255.0, 154.0/255.0, 255.0/255.0, 1.0);\\n'+\n    'void main() {\\n'+\n        'float l = dot(normalize(vNormal),-uParams2.xyz);\\n'+\n        'l = (1.0-pow(abs(l),uParams.x));\\n'+\n        'vec4 c = mix(uFogColor2, uFogColor, l);\\n'+\n        'gl_FragColor = vec4(c.xyz, c.w*l);\\n'+\n    '}';\n\n\nGpuShaders.atmoFragmentShader2 = 'precision mediump float;\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'uniform float uNFactor;\\n'+\n    'uniform vec2 uRadius;\\n'+\n    'uniform vec3 uPos;\\n'+\n    'varying vec4 vPosition;\\n'+\n    'varying vec3 vNormal;\\n'+\n    'uniform vec4 uFogColor;\\n'+ //= vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\\n'+\n    'void main() {\\n'+\n        'vec3 ldir = normalize(-vPosition.xyz);\\n'+\n        'vec3 diff = uPos;\\n'+\n        'float a = dot(ldir, ldir);\\n'+\n        'float b = 2 * dot(ldir, diff);\\n'+\n        'float c = dot(diff, diff) - (uRadius[0] * uRadius[0]);\\n'+\n        'float i = 0;\\n'+\n        'float discr = b * b - 4 * a * c;\\n'+\n        'if (discr > 0.0) {}\\n'+\n\n        '}\\n'+\n        'gl_FragColor = uFogColor;\\n'+\n    '}';\n\n\nGpuShaders.atmoVertexShader3 =\n    'attribute vec3 aPosition;\\n'+\n    //'attribute vec2 aTexCoord;\\n'+\n    'uniform mat4 uMV, uProj;\\n'+\n    //\"uniform mat3 uNorm;\\n\"+\n    'uniform vec4 uParams;\\n'+       //[surfaceRadius, surfaceRadius, strech ,safetyfactor]\n    'uniform vec4 uParams2;\\n'+       //[cameraPos, 1]\n\n    'varying vec2 vTexcoords;\\n'+\n\n    'void main(){ \\n'+\n        'gl_Position = uProj * (uMV * vec4(aPosition, 1.0));\\n'+\n\n        'vec3 position = (aPosition.xyz - vec3(0.5)) * vec3(uParams.w * 2.0);\\n'+\n        'vec4 camPos = uParams2;\\n'+\n        'float SurfaceRadius = uParams.x;\\n'+\n        'float AtmosphereRadius = uParams.y;\\n'+\n        'float StretchAmt = uParams.z;\\n'+\n\n        'float camHeight = length(camPos.xyz);\\n'+\n        'vec3 camToPos = position - camPos.xyz;\\n'+\n        'float farDist = length(camToPos);\\n'+\n\n        // get distance to surface horizon\n        'float altitude = max(0.0,camHeight - SurfaceRadius);\\n'+\n        'float horizonDist = sqrt((altitude*altitude) + (2.0 * SurfaceRadius * altitude));\\n'+\n        'float maxDot = horizonDist / camHeight;\\n'+\n\n        // get distance to atmosphere horizon - use max(0,...) because we can go into the atmosphere\n        'altitude = max(0.0,camHeight - AtmosphereRadius);\\n'+\n        'horizonDist = sqrt((altitude*altitude) + (2.0 * AtmosphereRadius * altitude));\\n'+\n\n        // without this, the shift between inside and outside atmosphere is  jarring\n        'float tweakAmount = 0.1;\\n'+\n        'float minDot = max(tweakAmount,horizonDist / camHeight);\\n'+\n\n        // scale minDot from 0 to -1 as we enter the atmosphere\n        'float minDot2 = ((camHeight - SurfaceRadius) * (1.0 / (AtmosphereRadius  - SurfaceRadius))) - (1.0 - tweakAmount);\\n'+\n        'minDot = min(minDot, minDot2);\\n'+\n\n        // get dot product of the vertex we're looking out\n        'float posDot = dot(camToPos / farDist,-camPos.xyz / camHeight) - minDot;\\n'+\n\n        // calculate the height from surface in range 0..1\n        'float height = posDot * (1.0 / (maxDot - minDot));\\n'+\n\n        'vTexcoords.y = height;\\n'+\n\n        'height -= min(0.0,minDot2 + ((1.0 + StretchAmt) * minDot2));\\n'+\n        'vTexcoords.x = height;\\n'+\n    '}';\n\n\nGpuShaders.atmoFragmentShader3 = 'precision mediump float;\\n'+\n    'varying vec2 vTexcoords;\\n'+\n    'uniform vec4 uParams3;\\n'+       //[treshold, mutiplier, 0,0]\n    'uniform vec4 uFogColor;\\n'+ // = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\\n'+\n    'uniform vec4 uFogColor2;\\n'+ // = vec4(72.0/255.0, 154.0/255.0, 255.0/255.0, 1.0);\\n'+\n    'const vec4 fogColor3 = vec4(0.0/255.0, 0.0/255.0, 0.0/255.0, 1.0);\\n'+\n\n    'void main() {\\n'+\n        'float l = vTexcoords.y;\\n'+\n        'if (l > uParams3.z){ discard; } else {\\n'+\n            'float l2 = clamp((l*l)*0.9+0.1, 0.0, 1.5);\\n'+\n            'vec4 c = mix(uFogColor2, uFogColor, l2);\\n'+\n            'gl_FragColor = vec4(c.xyz, c.w*l);\\n'+\n\n            'if (l > uParams3.x){ gl_FragColor.xyz = mix(gl_FragColor.xyz, fogColor3.xyz, (l-uParams3.x)*uParams3.y); }\\n'+\n        '}'+\n\n    '}';\n\n\n//heightmap tile\nGpuShaders.heightmapVertexShader =\n    'attribute vec3 aPosition;\\n'+\n    'attribute vec2 aTexCoord;\\n'+\n    'uniform mat4 uMV, uProj;\\n'+\n    'uniform float uFogDensity;\\n'+\n    'uniform mat4 uGridMat;\\n'+\n    'uniform float uGridStep1, uGridStep2;\\n'+\n    'const int HMSize = 5;\\n'+\n    'const float HMSize1 = float(HMSize-1);\\n'+\n    'uniform float uHeight[HMSize*HMSize];\\n'+\n    'varying vec2 vTexCoord1;\\n'+\n    'varying vec2 vTexCoord2;\\n'+\n    'varying float vFogFactor;\\n'+\n    'float round(float x) { return floor(x + 0.5); }\\n'+\n    'void main() {\\n'+\n        'vec3 pos = aPosition;\\n'+\n        'float z = uHeight[int(round(pos.y*HMSize1)*float(HMSize) + round(pos.x*HMSize1))];\\n'+\n        'vec4 camSpacePos = uMV * vec4(pos.xy, z, 1.0);\\n'+\n        'gl_Position = uProj * camSpacePos;\\n'+\n        'float camDist = length(camSpacePos.xyz);\\n'+\n        'vFogFactor = exp(uFogDensity * camDist);\\n'+\n        'vec4 gridCoord = uGridMat * vec4(pos, 1.0);\\n'+\n        'vTexCoord1 = aTexCoord;\\n'+\n        'vTexCoord1 = gridCoord.xy * vec2(uGridStep1);\\n'+\n        'vTexCoord2 = gridCoord.xy * vec2(uGridStep2);\\n'+\n    '}';\n\n\nGpuShaders.heightmapFragmentShader = 'precision mediump float;\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'uniform float uGridBlend;\\n'+\n    'varying vec2 vTexCoord1;\\n'+\n    'varying vec2 vTexCoord2;\\n'+\n    'varying float vFogFactor;\\n'+\n    'uniform vec4 uFogColor;\\n'+ // = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\\n'+\n    'void main() {\\n'+\n        'vec4 gridColor = mix(texture2D(uSampler, vTexCoord1), texture2D(uSampler, vTexCoord2), uGridBlend);\\n'+\n        'gl_FragColor = mix(uFogColor, gridColor, vFogFactor);\\n'+\n    '}';\n\n\n//depth encoded heightmap tile\nGpuShaders.heightmapDepthVertexShader =\n    'attribute vec3 aPosition;\\n'+\n    'attribute vec2 aTexCoord;\\n'+\n    'uniform mat4 uMV, uProj;\\n'+\n    'uniform float uFogDensity;\\n'+\n    'uniform mat4 uGridMat;\\n'+\n    'uniform float uGridStep1, uGridStep2;\\n'+\n    'const int HMSize = 5;\\n'+\n    'const float HMSize1 = float(HMSize-1);\\n'+\n    'uniform float uHeight[HMSize*HMSize];\\n'+\n    'varying vec2 vTexCoord1;\\n'+\n    'varying vec2 vTexCoord2;\\n'+\n    'varying float vDepth;\\n'+\n    'float round(float x) { return floor(x + 0.5); }\\n'+\n    'void main() {\\n'+\n        'vec3 pos = aPosition;\\n'+\n        'float z = uHeight[int(round(pos.y*HMSize1)*float(HMSize) + round(pos.x*HMSize1))];\\n'+\n        'vec4 camSpacePos = uMV * vec4(pos.xy, z, 1.0);\\n'+\n        'gl_Position = uProj * camSpacePos;\\n'+\n        'float camDist = length(camSpacePos.xyz);\\n'+\n        'vDepth = camDist;\\n'+\n        'vec4 gridCoord = uGridMat * vec4(pos, 1.0);\\n'+\n        'vTexCoord1 = aTexCoord;\\n'+\n        'vTexCoord1 = gridCoord.xy * vec2(uGridStep1);\\n'+\n        'vTexCoord2 = gridCoord.xy * vec2(uGridStep2);\\n'+\n    '}';\n\n\nGpuShaders.heightmapDepthFragmentShader = 'precision mediump float;\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'uniform float uGridBlend;\\n'+\n    'varying vec2 vTexCoord1;\\n'+\n    'varying vec2 vTexCoord2;\\n'+\n    'varying float vDepth;\\n'+\n    'void main() {\\n'+\n        'gl_FragColor = fract(vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0) * vDepth) + (-0.5/255.0);\\n'+\n    '}';\n\nGpuShaders.quadPoint =\n    'vec3 quadPoint(int i1, int i2, int i3, float t, float t2) {\\n'+\n        'float p1x = uPoints[i1], p1y = uPoints[i1+1], p1z = uPoints[i1+2];\\n'+\n        'float p3x = uPoints[i3], p3y = uPoints[i3+1], p3z = uPoints[i3+2];\\n'+\n        'float p2x = 2.0*uPoints[i2]-p1x*0.5-p3x*0.5;\\n'+\n        'float p2y = 2.0*uPoints[i2+1]-p1y*0.5-p3y*0.5;\\n'+\n        'float p2z = 2.0*uPoints[i2+2]-p1z*0.5-p3z*0.5;\\n'+\n        'return vec3(t2*t2*p1x+2.0*t2*t*p2x+t*t*p3x, t2*t2*p1y+2.0*t2*t*p2y+t*t*p3y, t2*t2*p1z+2.0*t2*t*p2z+t*t*p3z); }\\n';\n\nGpuShaders.planeVertexShader =\n    'attribute vec3 aPosition;\\n'+\n    'attribute vec2 aTexCoord;\\n'+\n    'uniform mat4 uMV, uProj;\\n'+\n    'uniform vec4 uParams;\\n'+    //[uGridStep1, fogDensity, indexFactor, uGridStep2]\n    'uniform vec4 uParams3;\\n'+    //[px, py, sx, sy]\n    'uniform float uPoints[9*3];\\n'+\n\n    '#ifndef poles\\n'+\n        'uniform vec3 uVector;\\n'+\n        'uniform float uHeights[9];\\n'+\n    '#endif\\n'+\n\n    'varying vec2 vTexCoord;\\n'+\n    'varying vec2 vTexCoord2;\\n'+\n    'varying float vFogFactor;\\n'+ GpuShaders.quadPoint +\n\n    '#ifndef poles\\n'+\n        'float linearHeight(float x, float y) {\\n'+\n            'int ix = int(x);\\n'+\n            'int iy = int(y);\\n'+\n            'int index = (2-iy)*3+ix;\\n'+\n            'int index2 = (2-(iy+1))*3+ix;\\n'+\n            'float fx = fract(x);\\n'+\n            'float fy = fract(y);\\n'+\n            'float w0 = (uHeights[index] + (uHeights[index+1] - uHeights[index])*fx);\\n'+\n            'float w1 = (uHeights[index2] + (uHeights[index2+1] - uHeights[index2])*fx);\\n'+\n            'return (w0 + (w1 - w0)*fy);\\n'+\n        '}\\n'+\n    '#endif\\n'+\n\n    'void main() {\\n'+\n        'vec3 indices = aPosition;\\n'+\n        'float t = aPosition.y * uParams[2];\\n'+  //vertical index\n        'float tt = t;\\n'+\n        'float t2 = (1.0-t);\\n'+\n        'vec3 p1 = quadPoint(0, 3, 6, t, t2);\\n'+\n        'vec3 p2 = quadPoint(9, 9+3, 9+6, t, t2);\\n'+\n        'vec3 p3 = quadPoint(18, 18+3, 18+6, t, t2);\\n'+\n        't = aPosition.x * uParams[2];\\n'+  //horizontal index\n        'float tt2 = t;\\n'+\n        't2 = (1.0-t);\\n'+\n        'float p2x = 2.0*p2.x-p1.x*0.5-p3.x*0.5;\\n'+\n        'float p2y = 2.0*p2.y-p1.y*0.5-p3.y*0.5;\\n'+\n        'float p2z = 2.0*p2.z-p1.z*0.5-p3.z*0.5;\\n'+\n        'vec4 p = vec4(t2*t2*p1.x+2.0*t2*t*p2x+t*t*p3.x, t2*t2*p1.y+2.0*t2*t*p2y+t*t*p3.y, t2*t2*p1.z+2.0*t2*t*p2z+t*t*p3.z, 1);\\n'+\n\n        '#ifndef poles\\n'+\n            '#ifndef flat\\n'+\n                'p.xyz += uVector * linearHeight(tt*2.0, tt2*2.0);\\n'+\n            '#endif\\n'+\n        '#endif\\n'+\n\n        'vec4 camSpacePos = uMV * p;\\n'+\n        'gl_Position = uProj * camSpacePos;\\n'+\n        'float camDist = length(camSpacePos.xyz);\\n'+\n\n        '#ifdef depth\\n'+\n            'vFogFactor = camDist;\\n'+\n        '#else\\n'+\n            'vFogFactor = exp(uParams[1] * camDist);\\n'+\n        '#endif\\n'+\n\n        'vec2 uv;\\n'+\n        'uv.x = aTexCoord.y * uParams3[2] + uParams3[0];\\n'+\n        'uv.y = (1.0-aTexCoord.x) * uParams3[3] + uParams3[1];\\n'+\n        'vTexCoord = uv;\\n'+\n        'vTexCoord2 = p.xy;\\n'+\n    '}';\n\nGpuShaders.planeFragmentShader = 'precision mediump float;\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'uniform vec4 uParams2;\\n'+    //[uGridStep1, uGridStep2, uGridBlend, 0]\n\n    '#ifdef poles\\n'+\n        'uniform vec4 uParams4;\\n'+    //[pole-x, pole-y, pole-radius, 0]\n        'varying vec2 vTexCoord2;\\n'+\n    '#endif\\n'+\n\n    'varying vec2 vTexCoord;\\n'+\n    'varying float vFogFactor;\\n'+\n    'uniform vec4 uFogColor;\\n'+ // = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\\n'+\n    'void main() {\\n'+\n        '#ifdef poles\\n'+\n            'if (length(uParams4.xy - vTexCoord2.xy) > uParams4.z){ discard; }\\n'+\n        '#endif\\n'+\n\n        '#ifdef depth\\n'+\n            'gl_FragColor = fract(vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0) * vFogFactor) + (-0.5/255.0);\\n'+\n        '#else\\n'+\n            'vec4 c = mix(texture2D(uSampler, vTexCoord), texture2D(uSampler, vTexCoord*8.0), uParams2[2]);\\n'+\n            'gl_FragColor = mix(uFogColor, c, vFogFactor);\\n'+\n        '#endif\\n'+\n    '}';\n\nGpuShaders.getHFNormal =\n    'vec3 getHFNormal(vec2 uv, float texelSize, float heightDelta) {\\n'+\n        'vec4 h;\\n'+\n        'h[0] = texture2D(uSampler2, uv + (texelSize * vec2( 0.0,-1.0))).r * heightDelta;\\n'+\n        'h[1] = texture2D(uSampler2, uv + (texelSize * vec2(-1.0, 0.0))).r * heightDelta;\\n'+\n        'h[2] = texture2D(uSampler2, uv + (texelSize * vec2( 1.0, 0.0))).r * heightDelta;\\n'+\n        'h[3] = texture2D(uSampler2, uv + (texelSize * vec2( 0.0, 1.0))).r * heightDelta;\\n'+\n        'return normalize(vec3(h[1] - h[2], h[3] - h[0], 2.0));}\\n';\n\nGpuShaders.getHFNormal2 =\n    'vec2 getHFNormal2(vec2 uv, float texelSize, float heightDelta) {\\n'+\n        'vec4 h;\\n'+\n        'h[0] = texture2D(uSampler2, uv + (texelSize * vec2( 0.0,-1.0))).r * heightDelta;\\n'+\n        'h[1] = texture2D(uSampler2, uv + (texelSize * vec2(-1.0, 0.0))).r * heightDelta;\\n'+\n        'h[2] = texture2D(uSampler2, uv + (texelSize * vec2( 1.0, 0.0))).r * heightDelta;\\n'+\n        'h[3] = texture2D(uSampler2, uv + (texelSize * vec2( 0.0, 1.0))).r * heightDelta;\\n'+\n        'return vec2(h[1] - h[2], h[3] - h[0]);}\\n';\n\nGpuShaders.planeVertex4Shader =\n    '#define newspace\\n'+\n    'uniform sampler2D uSampler2;\\n'+\n    'attribute vec3 aPosition;\\n'+\n    //'attribute vec2 aTexCoord;\\n'+\n    //'attribute vec3 aBarycentric;\\n'+\n    'uniform mat4 uMV, uProj;\\n'+\n    'uniform vec4 uParams;\\n'+    //[uGridStep1, fogDensity, indexFactor, uGridStep2]\n    'uniform vec4 uParams3;\\n'+    //[px, py, sx, sy]\n    'uniform float uPoints[9*3];\\n'+\n    'uniform vec3 uVector;\\n'+\n    'uniform vec3 uHeights;\\n'+   //[hmin, hmax]\n    'uniform vec4 uTransform;\\n'+\n    //'uniform vec4 uTransform2;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'varying vec2 vTexCoord2;\\n'+\n    'varying vec3 vBarycentric;\\n'+\n\n    '#ifdef newspace\\n'+\n        'varying mat3 vTBN;\\n'+\n    '#else\\n'+\n        'varying vec3 vNormal;\\n'+\n    '#endif\\n'+\n\n    'varying float vFogFactor;\\n'+ GpuShaders.quadPoint +  GpuShaders.getHFNormal + GpuShaders.getHFNormal2 +\n    //'float random(vec2 p) { return fract(cos(dot(p,vec2( 23.14069263277926, 2.665144142690225)))*12345.6789);}\\n'+\n\n    'void main() {\\n'+\n        'vec3 indices = aPosition;\\n'+\n        'float t = aPosition.y * uParams[2];\\n'+  //vertical index\n        'float tt = t;\\n'+\n        'float t2 = (1.0-t);\\n'+\n        'vec3 p1 = quadPoint(0, 3, 6, t, t2);\\n'+\n        'vec3 p2 = quadPoint(9, 9+3, 9+6, t, t2);\\n'+\n        'vec3 p3 = quadPoint(18, 18+3, 18+6, t, t2);\\n'+\n        't = aPosition.x * uParams[2];\\n'+  //horizontal index\n        'float tt2 = t;\\n'+\n        't2 = (1.0-t);\\n'+\n        'float p2x = 2.0*p2.x-p1.x*0.5-p3.x*0.5;\\n'+\n        'float p2y = 2.0*p2.y-p1.y*0.5-p3.y*0.5;\\n'+\n        'float p2z = 2.0*p2.z-p1.z*0.5-p3.z*0.5;\\n'+\n        'vec4 p = vec4(t2*t2*p1.x+2.0*t2*t*p2x+t*t*p3.x, t2*t2*p1.y+2.0*t2*t*p2y+t*t*p3.y, t2*t2*p1.z+2.0*t2*t*p2z+t*t*p3.z, 1);\\n'+\n        'vec2 uv2 = vec2(tt, 1.0-tt2);\\n'+\n        'uv2 = vec2(uTransform[0] * uv2[0] + uTransform[2], uTransform[1] * uv2[1] + uTransform[3]);\\n'+\n\n        'p.xyz += uVector * (uHeights[0] + (uHeights[1]-uHeights[0])*texture2D(uSampler2, uv2).x);\\n'+\n\n        'vec4 camSpacePos = uMV * p;\\n'+\n        'gl_Position = uProj * camSpacePos;\\n'+\n        'float camDist = length(camSpacePos.xyz);\\n'+\n        'vFogFactor = exp(uParams[1] * camDist);\\n'+\n\n        'vec2 uv = vec2(tt, 1.0-tt2);\\n'+\n        'uv.x = uv.x * uParams3[0] + uParams3[2];\\n'+\n        'uv.y = uv.y * uParams3[1] + uParams3[3];\\n'+\n        'vTexCoord = uv;\\n'+\n\n        'vBarycentric = camSpacePos.xyz;\\n'+\n\n        '#ifdef newspace\\n'+\n            'vec2 d = getHFNormal2(uv2, 1.0/(128.0), (uHeights[1]-uHeights[0]) * uHeights[2]);\\n'+\n            'vec3 T = vec3(2.0,0.0,-d.x); vec3 B = vec3(0.0,2.0,-d.y);\\n'+\n            'vTBN = mat3(normalize(T), normalize(B), cross(T,B));\\n'+\n        '#else\\n'+\n            'vec3 n = getHFNormal(uv2, 1.0/(128.0), (uHeights[1]-uHeights[0]) * uHeights[2]);\\n'+\n            'vNormal = normalize(n);\\n'+\n        '#endif\\n'+\n\n    '}';\n\nGpuShaders.planeFragmentShader2 = 'precision mediump float;\\n'+\n    '#extension GL_OES_standard_derivatives : enable\\n'+\n    '#define newspace\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'uniform vec4 uParams2;\\n'+    //[uGridStep1, uGridStep2, uGridBlend, 0]\n    'uniform mat3 uSpace;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'varying float vFogFactor;\\n'+\n    'varying vec3 vBarycentric;\\n'+\n\n    '#ifdef newspace\\n'+\n        'varying mat3 vTBN;\\n'+\n    '#else\\n'+\n        'varying vec3 vNormal;\\n'+\n    '#endif\\n'+\n\n    'uniform vec4 uFogColor;\\n'+ // = vec4(216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0);\\n'+\n    'void main() {\\n'+\n        'vec3 ldir = normalize(-vBarycentric);\\n'+\n\n        '#ifdef flat\\n'+\n            'vec3 nx = dFdx(vBarycentric);\\n'+\n            'vec3 ny = dFdy(vBarycentric);\\n'+\n            'vec3 normal2 = normalize(cross(nx,ny));\\n'+\n            'vec4 c2 = vec4(vec3(max(0.0,normal2.z*(204.0/255.0))+(32.0/255.0)),1.0);\\n'+\n        '#else\\n'+\n\n            '#ifdef newspace\\n'+\n                //'vec3 normal = cross(normalize(vTangent), normalize(vBitangent));\\n'+\n\n                '#ifdef nmix\\n'+\n                    'vec3 normal = vTBN * normalize((texture2D(uSampler, vTexCoord).xyz-0.5)*2.0);\\n'+\n                '#else\\n'+\n                    'vec3 normal = vTBN * vec3(0.0,0.0,1.0);\\n'+\n                '#endif\\n'+\n\n            '#else\\n'+\n                'vec3 normal = vNormal;\\n'+\n            '#endif\\n'+\n\n            'normal = normalize(uSpace * normal);\\n'+\n\n            'vec3 eyeDir = ldir;\\n'+\n            'vec3 refDir = reflect(-ldir, normal);\\n'+\n            'float specW = min(1.0, pow(max(dot(refDir, eyeDir), 0.0), 90.0));\\n'+\n            'float diffW = min(1.0, max(dot(normal, ldir), 0.0));\\n'+\n            'float lcolor = (dot(normal, ldir) + 1.0) * 0.5;\\n'+\n            //'float lcolor = 0.25+(0.5*diffW)+(0.25*specW);\\n'+\n            //'float lcolor = 0.25+(0.75*diffW);\\n'+\n\n            '#ifdef normals\\n'+\n                'vec4 c2 = vec4(normal*0.5+0.5,1.0);\\n'+\n            '#else\\n'+\n                'vec4 c2 = vec4(vec3(dot(vec3(0.0,0.0,1.0), normal)),1.0);\\n'+\n            '#endif\\n'+\n            //'vec4 c2 = vec4(normalize(ldir)*0.5+0.5,1.0);\\n'+\n            //'vec4 c2 = vec4(vec3(lcolor),1.0);\\n'+\n        '#endif\\n'+\n\n        '#ifdef grid\\n'+\n            'vec4 c = mix(texture2D(uSampler, vTexCoord), texture2D(uSampler, vTexCoord*8.0), uParams2[2]);\\n'+\n            'c = mix(c, c2, 0.5);\\n'+\n        '#else\\n'+\n            '#ifdef exmap\\n'+\n\n                'vec4 c = texture2D(uSampler, vTexCoord);\\n'+\n\n                '#ifdef classmap\\n'+\n                    'int i = int(c.x*255.0);\\n'+\n\n                    /*\n                    'if (i == 0) c = vec4(0.3, 0.44, 0.64, 1.0);\\n'+\n                    'if (i == 1) c = vec4(0.0, 0.24, 0.0, 1.0);\\n'+\n                    'if (i == 2) c = vec4(0.58, 0.61, 0.44, 1.0);\\n'+\n                    'if (i == 3) c = vec4(0.0, 0.39, 0.0, 1.0);\\n'+\n                    'if (i == 4) c = vec4(0.12, 0.67, 0.02, 1.0);\\n'+\n                    'if (i == 5) c = vec4(0.08, 0.55, 0.24, 1.0);\\n'+\n                    'if (i == 6) c = vec4(0.36, 0.46, 0.17, 1.0);\\n'+\n                    'if (i == 7) c = vec4(0.7, 0.62, 0.18, 1.0);\\n'+\n                    'if (i == 8) c = vec4(0.7, 0.54, 0.2, 1.0);\\n'+\n                    'if (i == 9) c = vec4(0.91, 0.86, 0.37, 1.0);\\n'+\n                    'if (i == 10) c = vec4(0.88, 0.81, 0.54, 1.0);\\n'+\n                    'if (i == 11) c = vec4(0.61, 0.46, 0.33, 1.0);\\n'+\n                    'if (i == 12) c = vec4(0.73, 0.83, 0.56, 1.0);\\n'+\n                    'if (i == 13) c = vec4(0.25, 0.54, 0.45, 1.0);\\n'+\n                    'if (i == 14) c = vec4(0.42, 0.64, 0.54, 1.0);\\n'+\n                    'if (i == 15) c = vec4(0.9, 0.68, 0.4, 1.0);\\n'+\n                    'if (i == 16) c = vec4(0.66, 0.67, 0.68, 1.0);\\n'+\n                    'if (i == 17) c = vec4(0.86, 0.13, 0.15, 1.0);\\n'+\n                    'if (i == 18) c = vec4(0.3, 0.44, 0.64, 1.0);\\n'+\n                    'if (i == 19) c = vec4(1.0, 0.98, 1.0, 1.0);\\n'+\n                    'c = c * c2;\\n'+\n                    */\n\n                    'if (i == 1 || i == 2 || i == 5 || i == 6) c = vec4(146.0, 178.0, 144.0, 255.0);\\n'+\n                    'if (i == 3 || i == 4) c = vec4(94.0, 169.0, 133.0, 255.0);\\n'+\n                    'if (i == 8 || i == 11) c = vec4(238.0, 221.0, 185.0, 255.0);\\n'+\n                    'if (i == 7) c = vec4(226.0, 192.0, 154.0, 255.0);\\n'+\n                    'if (i == 9 || i == 10 || i == 12) c = vec4(250.0, 246.0, 167.0, 255.0);\\n'+\n                    'if (i == 13 || i == 16) c = vec4(245.0, 236.0, 211.0, 255.0);\\n'+\n                    'if (i == 14) c = vec4(139.0, 185.0, 166.0, 255.0);\\n'+\n                    'if (i == 15) c = vec4(199.0, 219.0, 155.0, 255.0);\\n'+\n                    'if (i == 17) c = vec4(149.0, 132.0, 162.0, 255.0);\\n'+\n                    'if (i == 18 || i == 0) c = vec4(188.0, 221.0, 255.0, 255.0);\\n'+\n                    'if (i == 19) c = vec4(255.0, 255.0, 255.0, 255.0);\\n'+\n                    'c = (c*(1.0/255.0)) * c2;\\n'+\n                '#endif\\n'+\n\n            '#else\\n'+\n                'vec4 c = c2;\\n'+\n            '#endif\\n'+\n        '#endif\\n'+\n\n        '#ifdef fog\\n'+\n            'gl_FragColor = mix(uFogColor, c, vFogFactor);\\n'+\n        '#else\\n'+\n            'gl_FragColor = c;\\n'+\n        '#endif\\n'+\n    '}';\n\n\n//textured tile mesh\nGpuShaders.tileVertexShader =\n    'attribute vec3 aPosition;\\n'+\n\n    '#ifdef onlyFog\\n'+\n        'varying float vFogFactor;\\n'+\n    '#else\\n'+\n\n        '#ifdef externalTex\\n'+\n            'attribute vec2 aTexCoord2;\\n'+\n        '#else\\n'+\n            'attribute vec2 aTexCoord;\\n'+\n        '#endif\\n'+\n\n        'varying vec3 vTexCoord;\\n'+  //u,v,fogFactor\n\n    '#endif\\n'+\n\n    '#ifdef clip4\\n'+\n        '#ifndef externalTex\\n'+\n            'attribute vec2 aTexCoord2;\\n'+\n        '#endif\\n'+\n\n        'varying vec2 vClipCoord;\\n'+\n    '#endif\\n'+\n\n    '#ifdef clip8\\n'+\n        '#ifndef externalTex\\n'+\n            'attribute vec2 aTexCoord2;\\n'+\n        '#endif\\n'+\n\n        'varying vec3 vClipCoord;\\n'+\n\n        'uniform mat4 uParamsC8;\\n'+  //c,x,y,z\n\n        'float getLinePointParametricDist(vec3 c, vec3 v, vec3 p) {\\n'+\n            'vec3 w = p - c;\\n'+\n            'float c1 = dot(w,v);\\n'+\n            'if (c1 <= 0.0) return 0.0;\\n'+\n            'float c2 = dot(v,v);\\n'+\n            'if (c2 <= c1) return 1.0;\\n'+\n            'return c1 / c2;\\n'+\n        '}\\n'+\n\n    '#endif\\n'+\n\n    '#ifdef depth\\n'+\n        'varying float vDepth;\\n'+\n    '#endif\\n'+\n\n    '#ifdef flatShadeVar\\n'+\n        ///'attribute vec3 aBarycentric;\\n'+\n        'varying vec3 vBarycentric;\\n'+\n    '#endif\\n'+\n\n                                             //0-3                            4-7          8-11            12-15\n    'uniform mat4 uMV, uProj, uParams;\\n'+  //[zfactor, fogDensity, scale.xy][camVec.xyzw][transform.xyzw][scale.z, trans.xyz]\n\n    '#ifdef applySE\\n'+\n        'uniform mat4 uParamsSE;\\n'+\n    '#endif\\n'+\n\n    'void main() {\\n'+\n\n        '#ifdef applySE\\n'+\n            'vec3 geoPos2 = aPosition*vec3(uParamsSE[0][3],uParamsSE[1][0],uParamsSE[1][1]);\\n'+\n            'vec3 geoPos = geoPos2+vec3(uParamsSE[0][0],uParamsSE[0][1],uParamsSE[0][2]);\\n'+\n            'geoPos.z *= uParamsSE[3][3];\\n'+\n            'float ll = length(geoPos);\\n'+\n            'vec3 v = geoPos * (1.0/(ll+0.0001));\\n'+\n            'float h = ll - uParamsSE[3][2];\\n'+\n            'float h2 = clamp(h, uParamsSE[2][1], uParamsSE[2][3]);\\n'+\n            'float h3 = h;\\n'+\n            'h *= (uParamsSE[2][2] + ((h2 - uParamsSE[2][1]) * uParamsSE[3][0]) * uParamsSE[3][1]);\\n'+\n            'geoPos2.xyz += v * (h - h3);\\n'+\n            'vec4 camSpacePos = uMV * vec4(geoPos2, 1.0);\\n'+\n            'float l = dot(v, vec3(uParams[1][0],uParams[1][1],uParams[1][2]));\\n'+\n        '#else\\n'+\n            'vec4 camSpacePos = uMV * vec4(aPosition, 1.0);\\n'+\n            'vec3 worldPos = vec3(aPosition.x * uParams[0][2] + uParams[3][1], aPosition.y * uParams[0][3] + uParams[3][2], aPosition.z * uParams[3][0] + uParams[3][3]);\\n'+\n            'float l = dot(normalize(worldPos.xyz), vec3(uParams[1][0],uParams[1][1],uParams[1][2]));\\n'+\n        '#endif\\n'+\n\n        'gl_Position = uProj * camSpacePos;\\n'+\n        'float camDist = length(camSpacePos.xyz);\\n'+\n\n        '#ifdef depth\\n'+\n            'vDepth = camDist;\\n'+\n        '#endif\\n'+\n\n        '#ifdef flatShadeVar\\n'+\n            'vBarycentric = camSpacePos.xyz;\\n'+\n        '#endif\\n'+\n\n        'float fogFactor = 1.0-exp(uParams[0][1] * camDist);\\n'+\n        'fogFactor = clamp((1.0-abs(l))*uParams[1][3] + fogFactor, 0.0, 1.0);\\n'+\n\n        '#ifdef onlyFog\\n'+\n            'vFogFactor = fogFactor;\\n'+\n        '#else\\n'+\n            'vTexCoord.z = fogFactor;\\n'+\n\n            '#ifdef externalTex\\n'+\n                'vTexCoord.xy = vec2(uParams[2][0] * aTexCoord2[0] + uParams[2][2], uParams[2][1] * aTexCoord2[1] + uParams[2][3]);\\n'+\n            '#else\\n'+\n                'vTexCoord.xy = aTexCoord;\\n'+\n            '#endif\\n'+\n\n        '#endif\\n'+\n\n        '#ifdef clip4\\n'+\n            'vClipCoord.xy = aTexCoord2.xy;\\n'+\n        '#endif\\n'+\n\n        '#ifdef clip8\\n'+\n            //'vClipCoord.x = getLinePointParametricDist(vec3(uParamsC8[0][0],uParamsC8[0][1],uParamsC8[0][2]), vec3(uParamsC8[1][0],uParamsC8[1][1],uParamsC8[1][2]), camSpacePos.xyz);\\n'+\n            //'vClipCoord.y = getLinePointParametricDist(vec3(uParamsC8[0][0],uParamsC8[0][1],uParamsC8[0][2]), vec3(uParamsC8[2][0],uParamsC8[2][1],uParamsC8[2][2]), camSpacePos.xyz);\\n'+\n            //'vClipCoord.z = getLinePointParametricDist(vec3(uParamsC8[0][0],uParamsC8[0][1],uParamsC8[0][2]), vec3(uParamsC8[3][0],uParamsC8[3][1],uParamsC8[3][2]), camSpacePos.xyz);\\n'+\n\n            'vec3 worldPos2 = vec3(aPosition.x * uParams[0][2] + uParamsC8[0][3], aPosition.y * uParams[0][3] + uParamsC8[1][3], aPosition.z * uParams[3][0] + uParamsC8[2][3]);\\n'+\n\n            'vClipCoord.x = getLinePointParametricDist(vec3(uParamsC8[0][0],uParamsC8[0][1],uParamsC8[0][2]), vec3(uParamsC8[1][0],uParamsC8[1][1],uParamsC8[1][2]), worldPos2.xyz);\\n'+\n            'vClipCoord.y = getLinePointParametricDist(vec3(uParamsC8[0][0],uParamsC8[0][1],uParamsC8[0][2]), vec3(uParamsC8[2][0],uParamsC8[2][1],uParamsC8[2][2]), worldPos2.xyz);\\n'+\n            'vClipCoord.z = 1.0-getLinePointParametricDist(vec3(uParamsC8[0][0],uParamsC8[0][1],uParamsC8[0][2]), vec3(uParamsC8[3][0],uParamsC8[3][1],uParamsC8[3][2]), worldPos2.xyz);\\n'+\n            //'vClipCoord.xyz = vec3(0.0, 0.0, 1.0);\\n'+\n        '#endif\\n'+\n    '}';\n\nGpuShaders.tileFragmentShader = 'precision mediump float;\\n'+\n\n    '#ifdef clip4\\n'+\n        'uniform float uClip[4];\\n'+\n        'varying vec2 vClipCoord;\\n'+\n    '#endif\\n'+\n\n    '#ifdef clip8\\n'+\n        'uniform float uClip[8];\\n'+\n        'varying vec3 vClipCoord;\\n'+\n    '#endif\\n'+\n\n\n    '#ifdef onlyFog\\n'+\n        'varying float vFogFactor;\\n'+\n    '#else\\n'+\n\n        'varying vec3 vTexCoord;\\n'+\n        'uniform sampler2D uSampler;\\n'+\n\n        '#ifdef mask\\n'+\n            'uniform sampler2D uSampler2;\\n'+\n        '#endif\\n'+\n\n    '#endif\\n'+\n\n    '#ifdef depth\\n'+\n        'varying float vDepth;\\n'+\n    '#endif\\n'+\n\n    '#ifdef flatShadeVar\\n'+\n        'varying vec3 vBarycentric;\\n'+\n\n        '#ifdef fogAndColor\\n'+\n            'uniform vec4 uColor;\\n'+\n        '#endif\\n'+\n\n    '#endif\\n'+\n\n    'uniform vec4 uParams2;\\n'+\n    'void main() {\\n'+\n\n        '#ifdef clip4_nomargin\\n'+\n            'if (vClipCoord.y > 0.5){\\n'+\n                'if (vClipCoord.x > 0.5){\\n'+\n                    'if (uClip[3] == 0.0) discard;\\n'+\n                '} else {\\n'+\n                    'if (uClip[2] == 0.0) discard;\\n'+\n                '}\\n'+\n            '} else {\\n'+\n                'if (vClipCoord.x > 0.5){\\n'+\n                    'if (uClip[1] == 0.0) discard;\\n'+\n                '} else {\\n'+\n                    'if (uClip[0] == 0.0) discard;\\n'+\n                '}\\n'+\n            '}\\n'+\n        '#endif\\n'+\n\n        '#ifdef clip4\\n'+\n            'if (vClipCoord.y > 0.5){\\n'+\n                'if (vClipCoord.x > 0.5){\\n'+\n                    'if (uClip[3] == 0.0 && !(vClipCoord.x < TMAX && uClip[2] != 0.0) && !(vClipCoord.y < TMAX && uClip[1] != 0.0)) discard;\\n'+\n                '} else {\\n'+\n                    'if (uClip[2] == 0.0 && !(vClipCoord.x > TMIN && uClip[3] != 0.0) && !(vClipCoord.y < TMAX && uClip[0] != 0.0)) discard;\\n'+\n                '}\\n'+\n            '} else {\\n'+\n                'if (vClipCoord.x > 0.5){\\n'+\n                    'if (uClip[1] == 0.0 && !(vClipCoord.x < TMAX && uClip[0] != 0.0) && !(vClipCoord.y > TMIN && uClip[3] != 0.0)) discard;\\n'+\n                '} else {\\n'+\n                    'if (uClip[0] == 0.0 && !(vClipCoord.x > TMIN && uClip[1] != 0.0) && !(vClipCoord.y > TMIN && uClip[2] != 0.0)) discard;\\n'+\n                '}\\n'+\n            '}\\n'+\n        '#endif\\n'+\n\n        '#ifdef clip8\\n'+\n            'if (vClipCoord.z > 0.5){\\n'+\n                'if (vClipCoord.y > 0.5){\\n'+\n                    'if (vClipCoord.x > 0.5){\\n'+\n                        'if (uClip[5] == 0.0) discard;\\n'+\n                    '} else {\\n'+\n                        'if (uClip[4] == 0.0) discard;\\n'+\n                    '}\\n'+\n                '} else {\\n'+\n                    'if (vClipCoord.x > 0.5){\\n'+\n                        'if (uClip[7] == 0.0) discard;\\n'+\n                    '} else {\\n'+\n                        'if (uClip[6] == 0.0) discard;\\n'+\n                    '}\\n'+\n                '}\\n'+\n            '} else {\\n'+\n                'if (vClipCoord.y > 0.5){\\n'+\n                    'if (vClipCoord.x > 0.5){\\n'+\n                        'if (uClip[1] == 0.0) discard;\\n'+\n                    '} else {\\n'+\n                        'if (uClip[0] == 0.0) discard;\\n'+\n                    '}\\n'+\n                '} else {\\n'+\n                    'if (vClipCoord.x > 0.5){\\n'+\n                        'if (uClip[3] == 0.0) discard;\\n'+\n                    '} else {\\n'+\n                        'if (uClip[2] == 0.0) discard;\\n'+\n                    '}\\n'+\n                '}\\n'+\n            '}\\n'+\n        '#endif\\n'+\n\n        '#ifdef flatShadeVar\\n'+\n\n            '#ifdef flatShadeVarFallback\\n'+\n                'vec4 flatShadeData = vec4(1.0);\\n'+\n            '#else\\n'+\n                '#ifdef GL_OES_standard_derivatives\\n'+\n                    'vec3 nx = dFdx(vBarycentric);\\n'+\n                    'vec3 ny = dFdy(vBarycentric);\\n'+\n                    'vec3 normal=normalize(cross(nx,ny));\\n'+\n                    'vec4 flatShadeData = vec4(vec3(max(0.0,normal.z*(204.0/255.0))+(32.0/255.0)),1.0);\\n'+\n                '#else\\n'+\n                    'vec4 flatShadeData = vec4(1.0);\\n'+\n                '#endif\\n'+\n            '#endif\\n'+\n\n        '#endif\\n'+\n\n        '#ifdef flatShade\\n'+\n\n            '#ifdef fogAndColor\\n'+\n               // 'gl_FragColor = vec4(mix(uColor.xyz * flatShadeData.xyz, uParams2.xyz, vTexCoord.z), uColor.w);\\n'+\n                'gl_FragColor = vec4(uColor.xyz * flatShadeData.xyz, uColor.w);\\n'+\n            '#else\\n'+\n                'gl_FragColor = vec4(flatShadeData.xyz, 1.0);\\n'+\n            '#endif\\n'+\n\n        '#else\\n'+\n\n            'vec4 fogColor = vec4(uParams2.xyz, 1.0);\\n'+\n\n            '#ifdef onlyFog\\n'+\n                'gl_FragColor = vec4(fogColor.xyz, vFogFactor);\\n'+\n            '#else\\n'+\n\n                '#ifdef depth\\n'+\n                    'gl_FragColor = fract(vec4(1.0, 1.0/255.0, 1.0/65025.0, 1.0/16581375.0) * vDepth) + (-0.5/255.0);\\n'+\n                '#else\\n'+\n\n                    '#ifdef externalTex\\n'+\n                        'vec4 c = texture2D(uSampler, vTexCoord.xy);\\n'+'__FILTER__' +\n                        'vec4 cc = mix(c, fogColor, vTexCoord.z);\\n'+\n                        '#ifdef mask\\n'+\n                            'vec4 c2 = texture2D(uSampler2, vTexCoord.xy);\\n'+\n                            'cc.w = c.w * uParams2.w * c2.x;\\n'+\n                        '#else\\n'+\n                            'cc.w = c.w * uParams2.w;\\n'+\n                        '#endif\\n'+\n\n                        'gl_FragColor = cc;\\n'+\n                    '#else\\n'+\n                        'gl_FragColor = mix(texture2D(uSampler, vTexCoord.xy), fogColor, vTexCoord.z);\\n'+\n                    '#endif\\n'+\n\n                '#endif\\n'+\n\n            '#endif\\n'+\n\n        '#endif\\n'+\n\n        // '#ifdef clip8\\n'+\n          //  'gl_FragColor = vec4(vClipCoord.x, vClipCoord.y, vClipCoord.z, 1.0);\\n'+\n        // '#endif\\n'+\n    '}';\n\n\nGpuShaders.shadedMeshVertexShader =\n    'attribute vec3 aPosition;\\n'+\n    'attribute vec2 aTexCoord;\\n'+\n    'attribute vec3 aNormal;\\n'+\n    'uniform mat4 uMV, uProj;\\n'+\n    'uniform mat3 uNorm;\\n'+\n    'uniform float uFogDensity;\\n'+\n    'varying vec2 vTexCoord;\\n'+\n    'varying vec4 vPosition;\\n'+\n    'varying vec3 vNormal;\\n'+\n    'varying float vFogFactor;\\n'+\n    'void main() {\\n'+\n        'vec4 camSpacePos = uMV * vec4(aPosition, 1.0);\\n'+\n        'gl_Position = uProj * camSpacePos;\\n'+\n        'float camDist = length(camSpacePos.xyz);\\n'+\n        'vFogFactor = exp(uFogDensity * camDist);\\n'+\n        'vTexCoord = aTexCoord;\\n'+\n        'vPosition = camSpacePos;\\n'+\n        'vNormal = aNormal * uNorm;\\n'+\n    '}';\n\n\nGpuShaders.shadedMeshFragmentShader = 'precision mediump float;\\n'+\n    '#ifdef textured\\n'+\n        'uniform sampler2D uSampler;\\n'+\n        'varying vec2 vTexCoord;\\n'+\n    '#endif\\n'+\n    'varying vec4 vPosition;\\n'+\n    'varying vec3 vNormal;\\n'+\n    'uniform mat4 uMaterial;\\n'+\n    'varying float vFogFactor;\\n'+\n    'uniform vec4 uFogColor;\\n'+\n    'void main() {\\n'+\n        'vec3 ldir = normalize(-vPosition.xyz);\\n'+\n        'vec3 normal = normalize(vNormal);\\n'+\n        'vec3 eyeDir = ldir;\\n'+\n        'vec3 refDir = reflect(-ldir, normal);\\n'+\n        'float specW = min(1.0, pow(max(dot(refDir, eyeDir), 0.0), uMaterial[3][0]));\\n'+\n        'float diffW = min(1.0, max(dot(normal, ldir), 0.0));\\n'+\n        'vec4 lcolor = uMaterial[0]+(uMaterial[1]*diffW)+(uMaterial[2]*specW);\\n'+\n        '#ifdef textured\\n'+\n            'vec4 tcolor = texture2D(uSampler, vTexCoord);\\n'+\n            'gl_FragColor = mix(uFogColor, vec4(lcolor.xyz*(1.0/255.0), 1.0) * tcolor, vFogFactor); gl_FragColor.w *= uMaterial[3][1];\\n'+\n        '#else\\n'+\n            'gl_FragColor = mix(uFogColor, vec4(lcolor.xyz*(1.0/255.0), 1.0), vFogFactor);  gl_FragColor.w = uMaterial[3][1];\\n'+\n        '#endif\\n'+\n\n    '}';\n\nGpuShaders.tileWireFrameBasicShader = 'precision mediump float;\\n'+\n    'uniform vec4 uColor;\\n'+\n    'void main() {\\n'+\n        'gl_FragColor = uColor;\\n'+\n    '}';\n\n\n//used for 2d images\nGpuShaders.imageVertexShader = '\\n'+\n    'attribute vec4 aPosition;\\n'+\n    'uniform mat4 uProjectionMatrix;\\n'+\n    'uniform mat4 uData;\\n'+\n    'uniform vec4 uColor;\\n'+\n    'uniform float uDepth;\\n'+\n    'varying vec4 vColor;\\n'+\n    'varying vec2 vTexcoords;\\n'+\n    'void main(void){\\n'+\n        'int i=int(aPosition.x);\\n'+\n        //\"gl_Position=uProjectionMatrix*vec4(floor(uData[i][0]+0.1),floor(uData[i][1]+0.1),0.0,1.0);\\n\"+\n        //IE11 :(\n\n        'vec4 p;\\n'+\n\n        'if(i==0) p = vec4(floor(uData[0][0]+0.1),floor(uData[0][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[0][2], uData[0][3]);\\n'+\n        'if(i==1) p = vec4(floor(uData[1][0]+0.1),floor(uData[1][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[1][2], uData[1][3]);\\n'+\n        'if(i==2) p = vec4(floor(uData[2][0]+0.1),floor(uData[2][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[2][2], uData[2][3]);\\n'+\n        'if(i==3) p = vec4(floor(uData[3][0]+0.1),floor(uData[3][1]+0.1),uDepth,1.0), vTexcoords=vec2(uData[3][2], uData[3][3]);\\n'+\n\n        'gl_Position=uProjectionMatrix*p;\\n'+\n        'vec4 c=uColor;\\n'+\n        'c.w*=1.0;\\n'+\n        'vColor=c;\\n'+\n    '}';\n\n\nGpuShaders.imageFragmentShader = 'precision mediump float;\\n'+\n    'varying vec4 vColor;\\n'+\n    'varying vec2 vTexcoords;\\n'+\n    'uniform sampler2D uSampler;\\n'+\n    'void main(void){\\n'+\n        'vec4 c=texture2D(uSampler, vec2(vTexcoords.x, vTexcoords.y) );\\n'+\n        'c*=vColor;\\n'+\n        'if(c.w < 0.01){ discard; }\\n'+\n        'gl_FragColor = c;\\n'+\n    '}';\n\n\nexport default GpuShaders;\n","\nimport {mat4 as mat4_} from '../utils/matrix';\nimport {utils as utils_} from '../utils/utils';\nimport MapSubmesh_ from './submesh';\nimport BBox_ from '../renderer/bbox';\nimport GpuProgram_ from '../renderer/gpu/program';\nimport GpuShaders_ from '../renderer/gpu/shaders';\n\n//get rid of compiler mess\nvar mat4 = mat4_;\nvar BBox = BBox_;\nvar MapSubmesh = MapSubmesh_;\nvar utils = utils_;\nvar GpuProgram = GpuProgram_;\nvar GpuShaders = GpuShaders_;\n\nvar MapMesh = function(map, url, tile) {\n    this.generateLines = true;\n    this.map = map;\n    this.stats = map.stats;\n    this.mapLoaderUrl  = url;\n    this.tile = tile; // used only for stats\n    this.use16bit = map.config.map16bitMeshes;\n\n    this.bbox = new BBox();\n    this.size = 0;\n    this.gpuSize = 0;\n    this.fileSize = 0;\n    this.faces = 0;\n\n    this.cacheItem = null;  //store killSubmeshes\n    this.gpuCacheItem = null; //store killGpuSubmeshes\n\n    this.loadState = 0;\n    this.loadErrorTime = null;\n    this.loadErrorCounter = 0;\n\n    this.mBuffer = new Float32Array(16);\n    this.mBuffer2 = new Float32Array(16);\n    this.vBuffer = new Float32Array(4);\n\n    this.submeshes = [];\n    this.gpuSubmeshes = [];\n    this.submeshesKilled = false;\n};\n\n\nMapMesh.prototype.kill = function() {\n    this.bbox = null;\n    this.killSubmeshes();\n    this.killGpuSubmeshes();\n};\n\n\nMapMesh.prototype.killSubmeshes = function(killedByCache) {\n    for (var i = 0, li = this.submeshes.length; i < li; i++) {\n        this.submeshes[i].kill();\n    }\n    //this.submeshes = [];\n    this.submeshesKilled = true;\n\n    if (killedByCache !== true && this.cacheItem) {\n        this.map.resourcesCache.remove(this.cacheItem);\n        //this.tile.validate();\n    }\n\n    if (this.gpuSubmeshes.length == 0) {\n        this.loadState = 0;\n    }\n\n    this.cacheItem = null;\n};\n\n\nMapMesh.prototype.killGpuSubmeshes = function(killedByCache) {\n    var size = 0;\n    for (var i = 0, li = this.gpuSubmeshes.length; i < li; i++) {\n        this.gpuSubmeshes[i].kill();\n        size += this.gpuSubmeshes[i].getSize();\n    }\n\n    if (li > 0) {\n        this.stats.gpuMeshes -= size;\n        this.stats.graphsFluxMesh[1][0]++;\n        this.stats.graphsFluxMesh[1][1] += size;\n    }\n\n    this.gpuSubmeshes = [];\n\n    if (killedByCache !== true && this.gpuCacheItem) {\n        this.map.gpuCache.remove(this.gpuCacheItem);\n        //this.tile.validate();\n    }\n\n    //console.log(\"kill: \" + this.stats.counter + \"   \" + this.mapLoaderUrl);\n\n//    if (this.submeshes.length == 0) {\n    if (this.submeshesKilled) {\n        this.loadState = 0;\n    }\n\n    this.gpuCacheItem = null;\n};\n\n\nMapMesh.prototype.isReady = function(doNotLoad, priority, doNotCheckGpu) {\n    var doNotUseGpu = (this.map.stats.gpuRenderUsed >= this.map.draw.maxGpuUsed);\n    doNotLoad = doNotLoad || doNotUseGpu;\n\n    //if (doNotUseGpu) {\n      //  doNotUseGpu = doNotUseGpu;\n    //}\n\n    //if (this.mapLoaderUrl == \"https://cdn.vts.com/mario/proxy/melown2015/surface/vts/cz10/12-1107-688.bin?0\") {\n      //  this.mapLoaderUrl = this.mapLoaderUrl;\n    //}\n\n    if (this.loadState == 2) { //loaded\n        if (this.cacheItem) {\n            this.map.resourcesCache.updateItem(this.cacheItem);\n        }\n\n        if (doNotCheckGpu) {\n            return true;\n        }\n\n        if (this.gpuSubmeshes.length == 0) {\n            if (this.map.stats.gpuRenderUsed >= this.map.draw.maxGpuUsed) {\n                return false;\n            }\n\n            /*if (this.stats.renderBuild > this.map.config.mapMaxProcessingTime) {\n                this.map.markDirty();\n                return false;\n            }*/\n\n            if (doNotUseGpu) {\n                return false;\n            }\n\n            var t = performance.now();\n            this.buildGpuSubmeshes();\n            this.stats.renderBuild += performance.now() - t;\n        }\n\n        if (!doNotLoad && this.gpuCacheItem) {\n            this.map.gpuCache.updateItem(this.gpuCacheItem);\n        }\n        return true;\n    } else {\n        if (this.loadState == 0) {\n            if (doNotLoad) {\n                //remove from queue\n                //if (this.mapLoaderUrl) {\n                  //  this.map.loader.remove(this.mapLoaderUrl);\n                //}\n            } else {\n                //not loaded\n                //add to loading queue or top position in queue\n                this.scheduleLoad(priority);\n            }\n        } else if (this.loadState == 3) { //loadError\n            if (this.loadErrorCounter <= this.map.config.mapLoadErrorMaxRetryCount &&\n                performance.now() > this.loadErrorTime + this.map.config.mapLoadErrorRetryTime) {\n\n                this.scheduleLoad(priority);\n            }\n        } //else load in progress\n    }\n\n    return false;\n};\n\n\nMapMesh.prototype.scheduleLoad = function(priority) {\n    if (!this.mapLoaderUrl) {\n        this.mapLoaderUrl = this.map.url.makeUrl(this.tile.resourceSurface.meshUrl, {lod:this.tile.id[0], ix:this.tile.id[1], iy:this.tile.id[2] });\n    }\n\n    this.map.loader.load(this.mapLoaderUrl, this.onLoad.bind(this), priority, this.tile, 'mesh');\n};\n\n\nMapMesh.prototype.onLoad = function(url, onLoaded, onError) {\n    this.mapLoaderCallLoaded = onLoaded;\n    this.mapLoaderCallError = onError;\n\n    this.map.loader.processLoadBinary(url, this.onLoaded.bind(this), this.onLoadError.bind(this), null, 'mesh');\n    this.loadState = 1;\n};\n\n\nMapMesh.prototype.onLoadError = function() {\n    if (this.map.killed){\n        return;\n    }\n\n    this.loadState = 3;\n    this.loadErrorTime = performance.now();\n    this.loadErrorCounter ++;\n\n    //make sure we try to load it again\n    if (this.loadErrorCounter <= this.map.config.mapLoadErrorMaxRetryCount) {\n        setTimeout((function(){ if (!this.map.killed) { this.map.markDirty(); } }).bind(this), this.map.config.mapLoadErrorRetryTime);\n    }\n\n    this.mapLoaderCallError();\n};\n\n\nMapMesh.prototype.onLoaded = function(data, task, direct) {\n    if (this.map.killed){\n        return;\n    }\n\n    if (!task) {\n        //this.map.stats.renderBuild > this.map.config.mapMaxProcessingTime) {\n        this.map.markDirty();\n        this.map.addProcessingTask(this.onLoaded.bind(this, data, true, direct));\n        return;\n    }\n\n    var t = performance.now();\n\n    if (direct) {\n        this.parseWorkerData(data);\n    } else {\n        this.fileSize = data.byteLength;\n        var stream = {data: new DataView(data), buffer:data, index:0};\n        this.parseMapMesh(stream);\n    }\n\n    this.map.stats.renderBuild += performance.now() - t;\n\n    this.submeshesKilled = false;\n\n    this.cacheItem = this.map.resourcesCache.insert(this.killSubmeshes.bind(this, true), this.size);\n\n    this.map.markDirty();\n    this.loadState = 2;\n    this.loadErrorTime = null;\n    this.loadErrorCounter = 0;\n    this.mapLoaderCallLoaded();\n};\n\n\n// Returns RAM usage in bytes.\n//MapMesh.prototype.getSize = function () {\n  //  return this.size;\n//};\n\n//MapMesh.prototype.fileSize = function () {\n    //return this.fileSize;\n//};\n\n\nMapMesh.prototype.parseWorkerData = function (data) {\n    this.faces = data['faces'];\n    this.gpuSize = data['gpuSize'];\n    this.meanUndulation = data['meanUndulation'];\n    this.numSubmeshes = data['numSubmeshes'];\n    this.size = data['size'];\n    this.version = data['version'];\n    this.submeshes = [];\n\n    var submeshes = data['submeshes'];\n\n    for (var i = 0, li = submeshes.length; i < li; i++) {\n        var submesh = new MapSubmesh(this);\n        var submeshData = submeshes[i];\n\n        submesh.bbox.min = submeshData['bboxMin'];\n        submesh.bbox.max = submeshData['bboxMax'];\n        submesh.externalUVs = submeshData['externalUVs'];\n        submesh.faces = submeshData['faces'];\n        submesh.flags = submeshData['flags'];\n        submesh.gpuSize = submeshData['gpuSize'];\n        submesh.indices = submeshData['indices'];\n        submesh.internalUVs = submeshData['internalUVs'];\n        submesh.size = submeshData['size'];\n        submesh.surfaceReference = submeshData['surfaceReference'];\n        submesh.textureLayer = submeshData['textureLayer'];\n        submesh.textureLayer2 = submeshData['textureLayer2'];\n        submesh.vertices = submeshData['vertices'];\n\n        this.submeshes.push(submesh);\n    }\n\n    this.bbox.updateMaxSize();\n};\n\nMapMesh.prototype.parseMapMesh = function (stream) {\n/*\n    struct MapMesh {\n        struct MapMeshHeader {\n            char magic[2];                // letters \"ME\"\n            ushort version;               // currently 1\n            double meanUndulation;        // read more about undulation below\n            ushort numSubmeshes;          // number of submeshes\n        } header;\n        struct Submesh submeshes [];      // array of submeshes, size of array is defined by numSubmeshes property\n    };\n*/\n    this.killSubmeshes(); //just in case\n\n    //parase header\n    var streamData = stream.data;\n    var magic = '';\n\n    if (streamData.length < 2) {\n        return false;\n    }\n\n    magic += String.fromCharCode(streamData.getUint8(stream.index, true)); stream.index += 1;\n    magic += String.fromCharCode(streamData.getUint8(stream.index, true)); stream.index += 1;\n\n    if (magic != 'ME') {\n        return false;\n    }\n\n    this.version = streamData.getUint16(stream.index, true); stream.index += 2;\n\n    if (this.version > 3) {\n        return false;\n    }\n\n    //if (this.version >= 3) {\n    stream.uint8Data = new Uint8Array(stream.buffer);\n    //}\n\n    this.meanUndulation = streamData.getFloat64(stream.index, true); stream.index += 8;\n    this.numSubmeshes = streamData.getUint16(stream.index, true); stream.index += 2;\n\n    this.submeshes = [];\n    this.gpuSize = 0;\n    this.faces = 0;\n\n    for (var i = 0, li = this.numSubmeshes; i < li; i++) {\n        var submesh = new MapSubmesh(this, stream);\n        if (submesh.valid) {\n            this.submeshes.push(submesh);\n            this.size += submesh.getSize();\n            this.faces += submesh.faces;\n\n            //aproximate size\n            this.gpuSize += submesh.getSize();\n        }\n    }\n\n    this.numSubmeshes = this.submeshes.length;\n};\n\n\nMapMesh.prototype.addSubmesh = function(submesh) {\n    this.submeshes.push(submesh);\n    this.size += submesh.size;\n    this.faces += submesh.faces;\n};\n\n\nMapMesh.prototype.buildGpuSubmeshes = function() {\n    var size = 0;\n    this.gpuSubmeshes = new Array(this.submeshes.length);\n\n    for (var i = 0, li = this.submeshes.length; i < li; i++) {\n        this.gpuSubmeshes[i] = this.submeshes[i].buildGpuMesh();\n        size += this.gpuSubmeshes[i].getSize();\n    }\n\n    this.stats.gpuMeshes += size;\n    this.stats.graphsFluxMesh[0][0]++;\n    this.stats.graphsFluxMesh[0][1] += size;\n\n    this.gpuCacheItem = this.map.gpuCache.insert(this.killGpuSubmeshes.bind(this, true), size);\n    this.gpuSize = size;\n\n    //console.log(\"build: \" + this.stats.counter + \"   \" + this.mapLoaderUrl);\n};\n\n\nMapMesh.prototype.generateTileShader = function (progs, v, useSuperElevation, splitMask) {\n    var str = '';\n    if (splitMask) {\n        if (!this.map.config.mapSplitMargin) {\n            if (splitMask.length == 4){ str += '#define clip4_nomargin\\n' } else { str += '#define clip8\\n' };\n        } else {\n            if (splitMask.length == 4){ str += '#define clip4\\n' } else { str += '#define clip8\\n' };\n            str += '#define TMIN ' + (0.5-this.map.config.mapSplitMargin) + '\\n' + '#define TMAX ' + (0.5+this.map.config.mapSplitMargin) + '\\n';\n        }\n    }\n    if (useSuperElevation) str += '#define applySE\\n';\n    var prog = (new GpuProgram(this.map.renderer.gpu, progs[0].vertex.replace('#define variants\\n', str), progs[0].fragment.replace('#define variants\\n', str)));\n    progs[v] = prog;\n    return prog;\n};\n\n\nMapMesh.prototype.drawSubmesh = function (cameraPos, index, texture, type, alpha, layer, surface, splitMask, splitSpace) {\n    if (this.gpuSubmeshes[index] == null && this.submeshes[index] != null && !this.submeshes[index].killed) {\n        this.gpuSubmeshes[index] = this.submeshes[index].buildGpuMesh();\n    }\n\n    var submesh = this.submeshes[index];\n    var gpuSubmesh = this.gpuSubmeshes[index];\n\n    if (!gpuSubmesh) {\n        return;\n    }\n\n    var renderer = this.map.renderer;\n    var draw = this.map.draw;\n    var program = null;\n    var gpuMask = null;\n\n    var texcoordsAttr = null;\n    var texcoords2Attr = null;\n    var drawWireframe = draw.debug.drawWireframe;\n    var useSuperElevation = renderer.useSuperElevation;\n    //var attributes = (drawWireframe != 0) ?  ['aPosition', 'aBarycentric'] : ['aPosition'];\n    var attributes = ['aPosition'];\n    var v = (useSuperElevation) ? VTS_TILE_SHADER_SE : 0;\n\n    if (splitMask) {\n        v |= VTS_TILE_SHADER_CLIP4;\n\n        if (type != VTS_MATERIAL_EXTERNAL && type != VTS_MATERIAL_INTERNAL_NOFOG) {\n            texcoords2Attr = 'aTexCoord2';\n            attributes.push('aTexCoord2');\n        }\n    }\n\n    if (texture && draw.debug.meshStats) {\n        if (!submesh.uvAreaComputed) {\n            submesh.computeUVArea(texture.getGpuTexture());\n        }\n\n        this.stats.meshesUVArea += submesh.uvArea;\n        this.stats.meshesFaces += submesh.faces;\n    }\n\n    if (type == VTS_MATERIAL_DEPTH) {\n        program = renderer.progDepthTile[v];\n\n        if (!program) {\n            program = this.generateTileShader(renderer.progDepthTile, v, useSuperElevation, splitMask);\n        }\n\n    } else if (type == VTS_MATERIAL_FLAT) {\n        program = renderer.progFlatShadeTile[v];\n\n        if (!program) {\n            program = this.generateTileShader(renderer.progFlatShadeTile, v, useSuperElevation, splitMask);\n        }\n\n    } else {\n        if (drawWireframe > 0 && type == VTS_MATERIAL_FOG) {\n            return;\n        }\n\n        if (drawWireframe == 1 || drawWireframe == 3) {\n            program = renderer.progFlatShadeTile[v];\n\n            if (!program) {\n                program = this.generateTileShader(renderer.progFlatShadeTile, v, useSuperElevation, splitMask);\n            }\n\n        } else {\n            switch(type) {\n            case VTS_MATERIAL_INTERNAL:\n            case VTS_MATERIAL_INTERNAL_NOFOG:\n\n                texcoordsAttr = 'aTexCoord';\n                attributes.push('aTexCoord');\n\n                program = renderer.progTile[v];\n\n                if (!program) {\n                    program = this.generateTileShader(renderer.progTile, v, useSuperElevation, splitMask);\n                }\n\n                break;\n\n            case VTS_MATERIAL_EXTERNAL:\n            case VTS_MATERIAL_EXTERNAL_NOFOG:\n\n                var prog = renderer.progTile2;\n\n                if (texture) {\n                    gpuMask = texture.getGpuMaskTexture();\n                    if (gpuMask) {\n                        prog = renderer.progTile3;\n                    }\n                }\n\n                program = prog[v];\n\n                if (!program) {\n                    program = this.generateTileShader(prog, v, useSuperElevation, splitMask);\n                }\n\n\n                if (layer && (layer.shaderFilters || layer.shaderFilter)) {\n                    var filter, id, flatShade;\n\n                    if (surface && layer.shaderFilters) {\n                        filter = layer.shaderFilters[surface.id];\n\n                        if (filter) {\n                            if (filter.varFlatShade) {\n                                flatShade = true;\n                            }\n\n                            filter = filter.filter;\n                        }\n                    }\n\n                    if (!filter) {\n                        filter = layer.shaderFilter;\n                    }\n\n                    if (filter) {\n                        var id = (gpuMask) ? 'progTile3' : 'progTile2';\n                        var renderer = this.map.renderer;\n\n                        if (useSuperElevation) {\n                            id += 'se';\n                        }\n\n                        if (flatShade) {\n                            id += 'fs';\n                        }\n\n                        if (splitMask) {\n                            id += 'c4';\n                        }\n\n                        id += filter;\n\n                        program = renderer.progMap[id];\n\n                        if (!program) {\n                            var gpu = renderer.gpu, pixelShader, variations = '';\n\n                            if (splitMask) {\n                                if (!this.map.config.mapSplitMargin) {\n                                    variations += '#define clip4_nomargin\\n';\n                                } else {\n                                    variations += '#define clip4\\n';\n                                    variations += '#define TMIN ' + (0.5-this.map.config.mapSplitMargin) + '\\n' + '#define TMAX ' + (0.5+this.map.config.mapSplitMargin) + '\\n';\n                                }\n                            }\n\n                            var vertexShader = '#define externalTex\\n' + variations + ((useSuperElevation) ? '#define applySE\\n' : '') + GpuShaders.tileVertexShader;\n\n                            if (gpuMask) {\n                                pixelShader = '#define externalTex\\n#define mask\\n' + variations + GpuShaders.tileFragmentShader;\n                            } else {\n                                pixelShader = '#define externalTex\\n' + variations + GpuShaders.tileFragmentShader;\n                            }\n\n                            if (flatShade) {\n                                pixelShader =  '#extension GL_OES_standard_derivatives : enable\\n#define flatShadeVar\\n' + pixelShader;\n                                vertexShader = '#define flatShadeVar\\n' + vertexShader;\n\n                                //if (this.map.mobile) {\n                                    //pixelShader = '#define flatShadeVarFallback\\n' + pixelShader;\n                                    pixelShader = pixelShader.replace('mediump', 'highp');\n                                //}\n                            }\n\n                            program = new GpuProgram(gpu, vertexShader, pixelShader.replace('__FILTER__', filter));\n                            renderer.progMap[id] = program;\n                        }\n                    }\n                }\n\n                texcoords2Attr = 'aTexCoord2';\n                attributes.push('aTexCoord2');\n                break;\n\n            case VTS_MATERIAL_FOG:\n                program = renderer.progFogTile[v];\n\n                if (!program) {\n                    program = this.generateTileShader(renderer.progFogTile, v, useSuperElevation, splitMask);\n                }\n\n                break;\n            }\n        }\n    }\n\n    if (!program || !program.isReady()) {\n        return;\n    }\n\n    renderer.gpu.useProgram(program, attributes, gpuMask);\n\n    if (texture) {\n        var gpuTexture = texture.getGpuTexture();\n\n        if (gpuTexture) {\n            if (texture.statsCoutner != this.stats.counter) {\n                texture.statsCoutner = this.stats.counter;\n                this.stats.gpuRenderUsed += gpuTexture.getSize();\n            }\n\n            renderer.gpu.bindTexture(gpuTexture);\n\n            if (gpuMask) {\n                renderer.gpu.bindTexture(gpuMask, 1);\n            }\n\n        } else {\n            return;\n        }\n    } else if (type != VTS_MATERIAL_FOG && type != VTS_MATERIAL_DEPTH && type != VTS_MATERIAL_FLAT) {\n        return;\n    }\n\n    var mv = this.mBuffer, m = this.mBuffer2, v = this.vBuffer;\n\n    if (useSuperElevation) {\n\n        var m = this.mBuffer;\n        var se = renderer.superElevation;\n\n        m[0] = submesh.bbox.min[0];\n        m[1] = submesh.bbox.min[1];\n        m[2] = submesh.bbox.min[2];\n\n        m[3] = submesh.bbox.side(0);\n        m[4] = submesh.bbox.side(1);\n        m[5] = submesh.bbox.side(2);\n\n        //m[6] = 0;\n        //m[7] = 0;\n        //m[8] = 0;\n\n        m[9] = se[0]; // h1\n        m[10] = se[1]; // f1\n        m[11] = se[2]; // h2\n        m[12] = se[6]; // inv dh\n        m[13] = se[5]; // df\n\n        m[14] = renderer.earthRadius;\n        m[15] = renderer.earthERatio;\n\n        program.setMat4('uParamsSE', m);\n\n        //mv = renderer.camera.getModelviewFMatrix();\n        mat4.multiply(renderer.camera.getModelviewFMatrix(), submesh.getWorldMatrixSE(cameraPos, m), mv);\n\n    } else {\n        mat4.multiply(renderer.camera.getModelviewFMatrix(), submesh.getWorldMatrix(cameraPos, m), mv);\n    }\n\n\n    var proj = renderer.camera.getProjectionFMatrix();\n\n    program.setMat4('uMV', mv);\n\n    if (draw.zbufferOffset) {\n        program.setMat4('uProj', proj, renderer.getZoffsetFactor(draw.zbufferOffset));\n    } else {\n        program.setMat4('uProj', proj);\n    }\n\n    if (splitMask /*&& type != VTS_MATERIAL_FLAT*/) {\n        program.setFloatArray('uClip', splitMask);\n\n        //var fx = this.getLinePointParametricDist(points[0], points[1], point);\n        //var fy = this.getLinePointParametricDist(points[1], points[2], point);\n        //var fz = this.getLinePointParametricDist(points[4], points[0], point);\n\n        var p = this.map.camera.position;\n        var s = splitSpace;\n        //var c = [s[0][0] - p[0], s[0][1] - p[1], s[0][2] - p[2]];\n        //var px = [s[1][0] - p[0], s[1][1] - p[1], s[1][2] - p[2]];\n        //var py = [s[2][0] - p[0], s[2][1] - p[1], s[2][2] - p[2]];\n        //var pz = [s[4][0] - p[0], s[4][1] - p[1], s[4][2] - p[2]];\n\n        if (splitSpace) {\n            m[0] = s[0][0] - p[0]; m[1] = s[0][1] - p[1]; m[2] = s[0][2] - p[2];\n            m[4] = s[1][0] - s[0][0]; m[5] = s[1][1] - s[0][1]; m[6] = s[1][2] - s[0][2];\n            m[8] = s[2][0] - s[1][0]; m[9] = s[2][1] - s[1][1]; m[10] = s[2][2] - s[1][2];\n            //m[12] = s[0][0] - s[4][0]; m[13] = s[0][1] - s[4][1]; m[14] = s[0][2] - s[4][2];\n            m[12] = s[4][0] - s[0][0]; m[13] = s[4][1] - s[0][1]; m[14] = s[4][2] - s[0][2];\n\n            var bmin = submesh.bbox.min, bmax = submesh.bbox.max;\n\n            m[3] = bmin[0] - p[0];\n            m[7] = bmin[1] - p[1];\n            m[11] = bmin[2] - p[2];\n\n            program.setMat4('uParamsC8', m);\n        }\n    }\n\n    if (drawWireframe == 0) {\n        var cv = this.map.camera.vector2, c = draw.atmoColor, t, bmin = submesh.bbox.min, bmax = submesh.bbox.max;\n\n        switch(type) {\n        case VTS_MATERIAL_INTERNAL:\n        case VTS_MATERIAL_FOG:\n        case VTS_MATERIAL_INTERNAL_NOFOG:\n\n            m[0] = draw.zFactor, m[1] = (type == VTS_MATERIAL_INTERNAL_NOFOG) ? 0 : draw.fogDensity;\n            m[2] = bmax[0] - bmin[0], m[3] = bmax[1] - bmin[1],\n            m[4] = cv[0], m[5] = cv[1], m[6] = cv[2], m[7] = cv[3],\n            m[12] = bmax[2] - bmin[2], m[13] = bmin[0], m[14] = bmin[1], m[15] = bmin[2];\n\n            program.setMat4('uParams', m);\n\n            v[0] = c[0], v[1] = c[1], v[2] = c[2];\n            program.setVec4('uParams2', v);\n\n            break;\n\n        case VTS_MATERIAL_EXTERNAL:\n        case VTS_MATERIAL_EXTERNAL_NOFOG:\n\n            t = texture.getTransform();\n\n            m[0] = draw.zFactor, m[1] = (type == VTS_MATERIAL_EXTERNAL) ? draw.fogDensity : 0;\n            m[2] = bmax[0] - bmin[0], m[3] = bmax[1] - bmin[1],\n            m[4] = cv[0], m[5] = cv[1], m[6] = cv[2], m[7] = cv[3],\n            m[8] = t[0], m[9] = t[1], m[10] = t[2], m[11] = t[3],\n            m[12] = bmax[2] - bmin[2], m[13] = bmin[0], m[14] = bmin[1], m[15] = bmin[2];\n\n            program.setMat4('uParams', m);\n\n            v[0] = c[0], v[1] = c[1], v[2] = c[2]; v[3] = (type == VTS_MATERIAL_EXTERNAL) ? 1 : alpha;\n            program.setVec4('uParams2', v);\n\n            break;\n        }\n    }\n\n    if (submesh.statsCoutner != this.stats.counter) {\n        submesh.statsCoutner = this.stats.counter;\n        this.stats.gpuRenderUsed += gpuSubmesh.getSize();\n    }\n\n    gpuSubmesh.draw(program, 'aPosition', texcoordsAttr, texcoords2Attr, drawWireframe != 0 ? 'aBarycentric' : null, (drawWireframe == 2));\n\n\n    if (drawWireframe == 1 || drawWireframe == 2) { //very slow debug only\n        program = renderer.progWireFrameBasic[v];\n\n        if (!program) {\n            program = this.generateTileShader(renderer.progWireFrameBasic, v, useSuperElevation, splitMask);\n        }\n\n        renderer.gpu.useProgram(program, attributes, gpuMask);\n\n        if (useSuperElevation) {\n            program.setMat4('uParamsSE', m);\n        }\n\n        program.setMat4('uMV', mv);\n        program.setVec4('uColor', [0,0,0,1]);\n\n        program.setMat4('uProj', proj, renderer.getZoffsetFactor([-0.001,0,0]));\n\n        if (splitMask) {\n            program.setFloatArray('uClip', splitMask);\n        }\n\n        var gl = gpuSubmesh.gl;\n\n        if (gpuSubmesh.indexBuffer) {\n            for (var i = 0, li = gpuSubmesh.indexBuffer.numItems*2; i < li; i+=3) {\n                gl.drawElements(gl.LINE_LOOP, 3, gl.UNSIGNED_SHORT, i);\n            }\n        }  else {\n            for (var i = 0, li = gpuSubmesh.vertexBuffer.numItems*2; i < li; i+=3) {\n                gl.drawArrays(gl.LINE_LOOP, i, 3);\n            }\n        }\n    }\n\n    this.stats.drawnFaces += this.faces;\n    this.stats.drawCalls ++;\n};\n\n\nexport default MapMesh;\n","\nimport {vec3 as vec3_} from '../utils/matrix';\n/*import {math as math_} from '../utils/math';*/\n\n//get rid of compiler mess\nvar vec3 = vec3_;\n/*var math = math_;*/\n\n\nvar MapGeodataGeometry = function(map, data) {\n    this.map = map;\n    this.data = data;\n    this.camera = map.camera;\n    this.renderer = map.renderer;\n\n    switch (data.type) {\n        case 'point-geometry':   \n            this.type = 1;\n            this.vertexBuffer = this.data.geometryBuffer;\n            break;\n        case 'line-geometry':\n            this.type = 2;\n            this.vertexBuffer = this.data.geometryBuffer;\n            this.indicesBuffer = this.data.indicesBuffer;\n            break;\n        case 'polygon-geometry':\n            this.type = 3;\n            this.vertexBuffer = this.data.geometryBuffer;\n            this.surface = this.data.surface;\n            this.borders = this.data.borders;\n            break;\n    }\n};\n\nMapGeodataGeometry.prototype.getType = function() {\n    switch(this.type) {\n        case 1: return 'point';\n        case 2: return 'line';\n        case 3: return 'polygon';\n    }\n};\n\nMapGeodataGeometry.prototype.getElement = function(index) {\n    var v = this.vertexBuffer, i = index * 3;\n    switch(this.type) {\n        case 1: return [v[i], v[i+1], v[i+2]]; //point\n        case 2: return [[v[i], v[i+1], v[i+2]],  [v[i+3], v[i+4], v[i+5]]]; //line\n        case 3: \n            var s = this.surface;\n            var i1 = s[i], i2 = s[i+1], i3 = s[i+2];\n            return [[v[i1][0], v[i1][1], v[i1][2]],  [v[i2][0], v[i2][1], v[i2][2]],  [v[i3][0], v[i3][1], v[i3][2]]]; //polygon\n    }\n};\n\nMapGeodataGeometry.prototype.getElements = function(pathIndex) {\n    switch(this.type) {\n        case 1: //point\n        case 3: return this.surface.length / 3; //polygon\n        case 2:  //line\n            \n            pathIndex = pathIndex || 0;\n            var si = (this.indicesBuffer[pathIndex]) * 3;\n            var ei = ((pathIndex + 1) >= this.indicesBuffer.length) ? this.vertexBuffer.length : (this.indicesBuffer[pathIndex] * 3);\n\n            return Math.max(0, ((ei - si) / 3) - 1);\n    }\n};\n\nMapGeodataGeometry.prototype.getRelationToCanvasPoint = function(index, screenX, screenY) {\n    var v = this.vertexBuffer, i = index * 3;\n    var c1, cv, p, r = [0,0,0];\n    var a, b, c, d, e, D, sc, tc, u, v, w;\n\n    c1 = this.camera.position;\n    //cv = this.camera.vector;\n\n    cv = this.renderer.getScreenRay(screenX, screenY);\n\n    //console.log(JSON.stringify(c1) + \"  \" + JSON.stringify(cv));\n\n    switch(this.type) {\n        case 1: \n\n            //get point\n            var p = [v[i], v[i+1], v[i+2]];\n\n            var cp = [p[0] - c[0], p[0] - c[0],]\n\n            //distance = vec3.coss(ray.direction, point - ray.origin).magnitude;\n            vec3.cross(cv, cp, r)\n            d = vec3.length(p);\n\n            return {\n                'distance' : d,\n                'point' : p\n            }\n\n        case 2: \n\n            //line points\n            var p1 = [v[i], v[i+1], v[i+2]];\n            var p2 = [v[i+3], v[i+4], v[i+5]]; \n\n            //distance = http://geomalgorithms.com/a07-_distance.html\n\n            u = cv;\n            v = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n            w = [c1[0] - p1[0], c1[1] - p1[1], c1[2] - p1[2]];\n            a = vec3.dot(u,u);    // always >= 0\n            b = vec3.dot(u,v);\n            c = vec3.dot(v,v);    // always >= 0\n            d = vec3.dot(u,w);\n            e = vec3.dot(v,w);\n            D = a*c - b*b;        // always >= 0\n\n            // compute the line parameters of the two closest points\n            if (D < 0.0000001) {          // the lines are almost parallel\n                sc = 0.0;\n                tc = (b>c ? d/b : e/c);    // use the largest denominator\n            }\n            else {\n                sc = (b*e - c*d) / D;\n                tc = (a*e - b*d) / D;\n            }\n\n            // get the difference of the two closest points\n            var dP = [ w[0] + (u[0] * sc) - (v[0] * tc),\n                       w[1] + (u[1] * sc) - (v[1] * tc),\n                       w[2] + (u[2] * sc) - (v[2] * tc) ];\n\n            return {\n                'closest' : [ p1[0] + (v[0] * tc), p1[1] + (v[1] * tc), p1[2] + (v[2] * tc) ],\n                'line-distance' : vec3.length(dP),\n                'distance' : tc,\n                'line' : [p1, p2]\n            }\n    }\n};\n\nMapGeodataGeometry.prototype.getPathElement = function(index, pathIndex) {\n    if (this.type != 2) {\n        return null;\n    }\n\n    var i = (this.indicesBuffer[pathIndex || 0] + index) * 3, v = this.vertexBuffer;\n    return [[v[i], v[i+1], v[i+2]],  [v[i+3], v[i+4], v[i+5]]];\n};\n\nMapGeodataGeometry.prototype.getPathPoint = function(distance, pathIndex) {\n    pathIndex = pathIndex || 0;\n\n    var si = (this.indicesBuffer[pathIndex]) * 3;\n    var ei = ((pathIndex + 1) >= this.indicesBuffer.length) ? this.vertexBuffer.length : (this.indicesBuffer[pathIndex] * 3);\n\n    var totalLength = 0, delta, length, v = this.vertexBuffer;\n\n    for (var i = si; i < (ei-3); i+=3) {\n        delta = [v[i+3] - v[i], v[i+4] - v[i+1], v[i+5] - v[i+2]];\n        length = vec3.length(delta);\n\n        if (totalLength + length > distance) {\n            var factor =  (distance - totalLength) / length;\n            return [v[i] + delta[0] * factor, v[i+1] + delta[1] * factor, v[i+2] + delta[2] * factor];\n        }\n\n        totalLength += length;    \n    }\n\n    return [v[ei-3], v[ei-2], v[ei-1]];\n};\n\nMapGeodataGeometry.prototype.getPathNED = function(distance, withoutSlope, pathIndex) {\n    pathIndex = pathIndex || 0;\n\n    var si = (this.indicesBuffer[pathIndex]) * 3;\n    var ei = ((pathIndex + 1) >= this.indicesBuffer.length) ? this.vertexBuffer.length : (this.indicesBuffer[pathIndex] * 3);\n\n    var totalLength = 0, p, delta, length, v = this.vertexBuffer;\n\n    for (var i = si; i < (ei-5); i+=3) {\n        delta = [v[i+3] - v[i], v[i+4] - v[i+1], v[i+5] - v[i+2]];\n        length = vec3.length(delta);\n\n        if (totalLength + length > distance) {\n            var factor = (totalLength + length) / distance;\n            p = [v[i] + d[0] * factor, v[i+1] + d[1] * factor, v[i+2] + d[2] * factor];\n            break;\n        }\n\n        totalLength += length;    \n    }\n\n    if (!p) {\n        p = [v[ei-3], v[ei-2], v[ei-1]];\n    }\n\n    var vv = [0, 0, 0];\n    var nn = [0, 0, 0];\n    var pp = [0, 0, 0];\n\n    vec3.nomalize(delta, vv);\n    vec3.nomalize(p, pp);\n    vec3.cross(pp, vv, nn);    \n\n    if (withoutSlope) {\n        vec3.cross(pp, nn, vv);    \n    }\n\n    var east = nn;\n    var direction = vv;\n    var north = pp;\n\n    return {\n        'east'  : east, \n        'direction' : direction,\n        'north' : north,\n        'position' : p,\n        'matrix' : [\n            east[0], east[1], east[2], 0,\n            north[0], north[1], north[2], 0,\n            direction[0], direction[1], direction[2], 0,\n            0, 0, 0, 1\n        ] \n    };    \n};\n\n\nMapGeodataGeometry.prototype.getPathLengthToElement = function(index, pathIndex) {\n    pathIndex = pathIndex || 0;\n\n    var si = (this.indicesBuffer[pathIndex]) * 3;\n    var ei = ((pathIndex + 1) >= this.indicesBuffer.length) ? this.vertexBuffer.length : (this.indicesBuffer[pathIndex] * 3);\n\n    var totalLength = 0, delta, length, v = this.vertexBuffer, elementIndex = 0;\n\n    for (var i = si; i < (ei-5); i+=3) {\n        delta = [v[i+3] - v[i], v[i+4] - v[i+1], v[i+5] - v[i+2]];\n        length = vec3.length(delta);\n\n        if (index == elementIndex) {\n            return {\n                'lengthToElement' : totalLength,\n                'elementLengh' : length\n            }\n        }\n\n        elementIndex++\n        totalLength += length;\n    }\n\n    return totalLength;\n};\n\n\nMapGeodataGeometry.prototype.getPathLength = function(pathIndex) {\n    pathIndex = pathIndex || 0;\n\n    var si = (this.indicesBuffer[pathIndex]) * 3;\n    var ei = ((pathIndex + 1) >= this.indicesBuffer.length) ? this.vertexBuffer.length : (this.indicesBuffer[pathIndex] * 3);\n\n    var totalLength = 0, delta, length, v = this.vertexBuffer;\n\n    for (var i = si; i < (ei-5); i+=3) {\n        delta = [v[i+3] - v[i], v[i+4] - v[i+1], v[i+5] - v[i+2]];\n        length = vec3.length(delta);\n\n        totalLength += length;\n    }\n\n    return totalLength;\n};\n\n\nMapGeodataGeometry.prototype.getPathsCount = function() {\n    if (this.type != 2) {\n        return 0;\n    }\n\n    return this.indicesBuffer.length;\n};\n\n\nMapGeodataGeometry.prototype.getSurfaceArea = function() {\n    if (this.type != 3) {\n        return 0;\n    }\n\n    if (!this.surfaceArea) {\n        var v = this.vertexBuffer, s = this.surface;\n        var p1, p2, p3, l1, l2, l3, dx, dy, dz, perimeter, area;\n\n        this.surfaceArea = 0;\n        for (var i = 0, li = s.length; i < li; i+= 3) {\n            p1 = v[s[i]];\n            p2 = v[s[i+1]];\n            p3 = v[s[i+2]];\n\n            dx = p2[0] - p1[0];\n            dy = p2[1] - p1[1];\n            dz = p2[2] - p1[2];\n            l1 = Math.sqrt(dx*dx + dy*dy + dz*dz); \n\n            dx = p2[0] - p3[0];\n            dy = p2[1] - p3[1];\n            dz = p2[2] - p3[2];\n            l2 = Math.sqrt(dx*dx + dy*dy + dz*dz); \n\n            dx = p3[0] - p1[0];\n            dy = p3[1] - p1[1];\n            dz = p3[2] - p1[2];\n            l3 = Math.sqrt(dx*dx + dy*dy + dz*dz); \n\n            //Heron's formula\n            perimeter = (l1 + l2 + l3)/2;\n            area =  Math.sqrt(perimeter*((perimeter-l1)*(perimeter-l2)*(perimeter-l3)));\n\n            this.surfaceArea += area;\n        }\n    }\n\n    return this.surfaceArea;\n};\n\nexport default MapGeodataGeometry;\n\n\n","\nvar MapGeodataImportGeoJSON = function(builder, heightMode, srs, options) {\n    this.builder = builder;\n    this.map = builder.map;\n    this.heightMode = heightMode || 'float';\n    this.srs = srs;\n\n    options = options || {};\n\n    this.groupIdPrefix = options['groupIdPrefix'] || '';\n    this.dontCreateGroups = options['dontCreateGroups'];\n    this.tesselation = options['tesselation'];\n};\n\nMapGeodataImportGeoJSON.prototype.processGeometry = function(geometry, feature) {\n    var coords = geometry['coordinates'];\n    if (!coords) {\n        return;\n    }\n\n    switch(geometry['type']) {\n        case 'Point':\n            this.builder.addPoint(coords, this.heightMode, feature['properties'], feature['properties'] ? feature['properties']['id'] : null, this.srs);\n            break;\n\n        case 'MultiPoint':\n            this.builder.addPointArray(coords, this.heightMode, feature['properties'], feature['properties'] ? feature['properties']['id'] : null, this.srs);\n            break;\n\n        case 'LineString':\n            this.builder.addLineString(coords, this.heightMode, feature['properties'], feature['properties'] ? feature['properties']['id'] : null, this.srs);\n            break;\n\n        case 'MultiLineString':\n            this.builder.addLineStringArray(coords, this.heightMode, feature['properties'], feature['properties'] ? feature['properties']['id'] : null, this.srs);\n            break;\n\n        case 'Polygon':\n            if (coords.length > 0) {\n                this.builder.addPolygon(coords[0], (coords.length > 1) ? coords.slice(1) : [], null, this.heightMode, feature['properties'], feature['properties'] ? feature['properties']['id'] : null, this.srs, this.tesselation);\n            }\n            break;\n\n        case 'MultiPolygon':\n            for (var i = 0, li = coords.length; i < li; i++) {\n                var coords2 = coords[i];\n                if (coords2.length > 0) {\n                    this.builder.addPolygon(coords2[0], (coords2.length > 1) ? coords2.slice(1) : [], null, this.heightMode, feature['properties'], feature['properties'] ? feature['properties']['id'] : null, this.srs, this.tesselation);\n                }\n            }\n            break;\n\n        case 'GeometryCollection':\n\n            var geometries = geometry['gemetries'];\n\n            if (geometries) {\n                for (var i = 0, li = geometries.length; i < li; i++) {\n                    this.processGeometry(geometries[i], feature);\n                }\n            }\n    }\n};\n\nMapGeodataImportGeoJSON.prototype.processFeature = function(json) {\n    var geometry = json['geometry'];\n\n    if (geometry) {\n        this.processGeometry(geometry, json);\n    }\n};\n\nMapGeodataImportGeoJSON.prototype.processCollection = function(json) {\n    var features = json['features'];\n\n    if (!features) {\n        return;\n    }\n\n    for (var i = 0, li = features.length; i < li; i++) {\n        this.processFeature(features[i]);\n    }\n};\n\nMapGeodataImportGeoJSON.prototype.processJSON = function(json) {\n    if (!json) {\n        return;\n    }\n\n    if (json['type']) {\n\n        switch (json['type']) {\n            case 'FeatureCollection':\n\n                if (!this.dontCreateGroups) {\n                    this.builder.addGroup(this.groupIdPrefix != '' ? this.groupIdPrefix : null);\n                }\n\n                this.processCollection(json);\n                break;\n            case 'Feature':\n\n                if (!this.dontCreateGroups) {\n                    this.builder.addGroup(this.groupIdPrefix != '' ? this.groupIdPrefix : null);\n                }\n\n                this.processFeature(json);\n                break;\n        }\n\n    } else {\n\n        for (var key in json) {\n            var item = json[key];\n\n            if (!this.dontCreateGroups) {\n                this.builder.addGroup(this.groupIdPrefix + key);\n            }\n\n            switch (json['type']) {\n                case 'FeatureCollection':\n                    this.processCollection(item);\n                    break;\n                case 'Feature':\n                    this.processFeature(item);\n                    break;\n            }\n        }\n    }\n\n};\n\nexport default MapGeodataImportGeoJSON;\n\n","\nvar MapGeodataImportVTSGeodata = function(builder, groupIdPrefix, dontCreateGroups) {\n    this.builder = builder;\n    this.map = builder.map;\n    this.groupIdPrefix = groupIdPrefix || '';\n    this.dontCreateGroups = dontCreateGroups;\n    //this.processJSON(json);\n};\n\nMapGeodataImportVTSGeodata.prototype.processJSON = function(json) {\n    if (!json) {\n        return;\n    }\n\n    var groups = json['groups'], i, li, j, lj, k, lk, p;\n    var builder = this.builder, newPoints, points;\n\n    if (!groups) {\n        return;\n    }\n\n    for (i = 0, li = groups.length; i < li; i++) {\n        var group = groups[i];\n\n        var bbox = group['bbox'],\n            resolution = group['resolution'];\n\n        if (!bbox || !resolution) {\n            continue;\n        }\n\n        var bboxMin = bbox[0];\n        var bboxMax = bbox[1];\n\n        if (!bboxMin || !bboxMax) {\n            continue;\n        }\n\n        if (!this.dontCreateGroups) {\n            builder.addGroup(this.groupIdPrefix + (group['id'] || ''));\n        }\n\n        var fx = (bboxMax[0] - bboxMin[0]) / resolution;\n        var fy = (bboxMax[1] - bboxMin[1]) / resolution;\n        var fz = (bboxMax[2] - bboxMin[2]) / resolution;\n\n        //import group points\n        var pointsFeatures = group['points'];\n        if (pointsFeatures) {\n\n            points = pointsFeatures['points']\n\n            for (j = 0, lj = pointsFeatures.length; j < lj; j++) {\n                var point = pointsFeatures[j];\n                var subpoints = point['points'];\n                var newSubpoints = new Array(subpoints.length);\n\n                for (k = 0, lk = subpoints.length; k < lk; k++) {\n                    p = subpoints[k];\n                    newSubpoints[k] = [bboxMin[0] + p[0] * fx, bboxMin[1] + p[1] * fy, bboxMin[2] + p[2] * fz];\n                }\n\n                builder.addPointArray(newSubpoints, 'fix', point['properties'], point['id'], null, true);\n            }\n        }\n\n        //import group lines\n        var linesFeatures = group['lines'];\n        if (linesFeatures) {\n            for (j = 0, lj = linesFeatures.length; j < lj; j++) {\n                var line = linesFeatures[j];\n                var sublines = line['lines'];\n                var newSublines = new Array(sublines.length);\n\n                for (k = 0, lk = sublines.length; k < lk; k++) {\n\n                    points = sublines[k];\n                    newPoints = new Array(points.length);\n\n                    for (var l  = 0, ll = points.length; l < ll; l++) {\n                        p = points[l];\n                        newPoints[l] = [bboxMin[0] + p[0] * fx, bboxMin[1] + p[1] * fy, bboxMin[2] + p[2] * fz];\n                    }\n\n                    newSublines[k] = newPoints;\n                }\n\n                builder.addLineStringArray(newSublines, 'fix', line['properties'], line['id'], null, true);\n            }\n        }\n\n        var polygonsFeatures = group['polygons'];\n        if (polygonsFeatures) {\n            var transform = { sx: fx, sy:fy, sz:fz, px:bboxMin[0], py:bboxMin[1], pz:bboxMin[2] };\n\n            for (j = 0, lj = polygonsFeatures.length; j < lj; j++) {\n                var polygon = polygonsFeatures[j];\n\n                builder.addPolygonRAW(polygon['vertices'], polygon['surface'], polygon['borders'], polygon['middle'], 'fix', polygon['properties'], polygon['id'], null, true, transform);\n            }\n        }\n\n    }\n\n};\n\nexport default MapGeodataImportVTSGeodata;\n\n\n","\nimport {math as math_} from '../../utils/math';\nimport {vec3 as vec3_} from '../../utils/matrix';\nimport {utils as utils_} from '../../utils/utils';\nimport {utilsUrl as utilsUrl_} from '../../utils/url';\n\n\n\n//get rid of compiler mess\nvar math = math_;\nvar vec3 = vec3_;\nvar utils = utils_;\nvar utilsUrl = utilsUrl_;\n\nvar MapGeodataImport3DTiles = function(builder, options) {\n    this.builder = builder;\n    this.map = builder.map;\n    //this.heightMode = heightMode || 'float';\n    this.navSrs = this.map.getNavigationSrs();\n    this.physSrs = this.map.getPhysicalSrs();\n    this.srs = this.navSrs;\n    this.rootPath = '';\n    this.filesToLoad = 0;\n    options = options || {};\n};\n\nMapGeodataImport3DTiles.prototype.processNode = function(builderNode, node, onlyChildren) {\n    var boundingVolume = node['boundingVolume'], volume;\n\n    if (boundingVolume) {\n\n        if (boundingVolume['region']) {\n            var v = boundingVolume['region'];\n            var min = [math.degrees(v[0]), math.degrees(v[1]), v[4]];\n            var max = [math.degrees(v[2]), math.degrees(v[3]), v[5]];\n\n            var p = [], r;\n\n            p[0] = this.physSrs.convertCoordsFrom([min[0], max[1], max[2]], this.srs);\n            p[1] = this.physSrs.convertCoordsFrom([max[0], max[1], max[2]], this.srs);\n            p[2] = this.physSrs.convertCoordsFrom([max[0], min[1], max[2]], this.srs);\n            p[3] = this.physSrs.convertCoordsFrom([min[0], min[1], max[2]], this.srs);\n\n            p[4] = this.physSrs.convertCoordsFrom([min[0], max[1], min[2]], this.srs);\n            p[5] = this.physSrs.convertCoordsFrom([max[0], max[1], min[2]], this.srs);\n            p[6] = this.physSrs.convertCoordsFrom([max[0], min[1], min[2]], this.srs);\n            p[7] = this.physSrs.convertCoordsFrom([min[0], min[1], min[2]], this.srs);\n\n            //var center = this.physSrs.convertCoordsFrom([(max[0] + min[0]) * 0.5, (max[1] + min[1]) * 0.5, (max[2] + min[2]) * 0.5], this.srs);\n\n            var center = [ (p[0][0]+p[1][0]+p[2][0]+p[3][0]+p[4][0]+p[5][0]+p[6][0]+p[7][0])/8,\n                           (p[0][1]+p[1][1]+p[2][1]+p[3][1]+p[4][1]+p[5][1]+p[6][1]+p[7][1])/8,\n                           (p[0][2]+p[1][2]+p[2][2]+p[3][2]+p[4][2]+p[5][2]+p[6][2]+p[7][2])/8 ];\n\n            //var axisX = [p[1][0] - p[0][0], p[1][1] - p[0][1], p[1][2] - p[0][2]];\n            //var axisY = [p[2][0] - p[1][0], p[2][1] - p[1][1], p[2][2] - p[1][2]];\n            //var axisZ = [p[0][0] - p[4][0], p[0][1] - p[4][1], p[0][2] - p[4][2]];\n\n            r = vec3.length([p[0][0] - center[0], p[0][1] - center[1], p[0][2] - center[2]]);\n\n            volume = {\n                points : p,\n                center : center,\n                radius: r,\n                halfAxis : [\n                    [(p[1][0] - p[0][0]) * 0.5, (p[1][1] - p[0][1]) * 0.5, (p[1][2] - p[0][2]) * 0.5 ],\n                    [(p[2][0] - p[1][0]) * 0.5, (p[2][1] - p[1][1]) * 0.5, (p[2][2] - p[1][2]) * 0.5 ],\n                    [(p[4][0] - p[0][0]) * 0.5, (p[4][1] - p[0][1]) * 0.5, (p[4][2] - p[0][2]) * 0.5 ]\n                ]\n            }\n        }\n    }\n\n\n    var precision = node['geometricError'];\n\n    if (!onlyChildren) {\n        builderNode = this.builder.addNode(builderNode, volume, precision, onlyChildren);\n    }\n\n    var content = node['content'];\n\n    if (content && content['uri']) {\n        var path = content['uri'];\n\n        path = utilsUrl.getProcessUrl(path, this.rootPath);\n\n        if (path.indexOf('.json') != -1) {\n            this.loadJSON(path, { internal: true, node: builderNode } );\n        }\n\n        else if (path.indexOf('.mesh') != -1) {\n            this.builder.addMesh(builderNode, path);\n        }\n    }\n\n    var children = node['children'];\n\n    if (children) {\n        for (var i = 0, li = children.length; i < li; i++) {\n            this.processNode(builderNode, children[i]);\n        }\n    }\n};\n\nMapGeodataImport3DTiles.prototype.processJSON = function(json) {\n    if (!json) {\n        return;\n    }\n\n    this.rootPath = rootPath || '';\n    this.processNode(null, json['root']);\n};\n\n\nMapGeodataImport3DTiles.prototype.loadJSON = function(path, options, onLoaded) {\n    this.filesToLoad++;\n\n    options = options || {};\n\n    if (!(options.internal)) {\n        this.onFinished = onLoaded;\n        this.baseOptions = options;\n        options = { internal:true, node: null };\n    }\n\n    utils.loadJSON(path, this.onLoaded.bind(this, path, options), this.onError.bind(this, options));\n};\n\n\nMapGeodataImport3DTiles.prototype.onLoaded = function(path, options, json) {\n    this.rootPath = utilsUrl.makeAbsolute(path);\n    this.rootPath = utilsUrl.getBase(this.rootPath);\n\n    this.processNode(options.node, json['root'], options.node ? true : false);\n\n    this.filesToLoad--;\n\n    if (!this.filesToLoad && this.onFinished) {\n        this.onFinished();\n    }\n}\n\nMapGeodataImport3DTiles.prototype.onError = function() {\n    this.filesToLoad--;\n\n    if (!this.filesToLoad && this.onFinished) {\n        this.onFinished();\n    }\n}\n\n\nexport default MapGeodataImport3DTiles;\n\n\n\n\n\n\n\n\n\n","\n//import Delaunator_ from './geodata-utils';\nimport MapGeodataGeometry_ from './geodata-geometry';\nimport MapGeodataImportGeoJSON_ from './geodata-import/geojson';\nimport MapGeodataImportVTSGeodata_ from './geodata-import/vts-geodata';\nimport MapGeodataImport3DTiles_ from './geodata-import/3dtiles';\n//import GeographicLib_ from 'geographiclib';\nimport {vec3 as vec3_, mat4 as mat4_,} from '../utils/matrix';\n\n//get rid of compiler mess\n//var Delaunator = Delaunator_;\nvar MapGeodataGeometry = MapGeodataGeometry_;\nvar MapGeodataImportGeoJSON = MapGeodataImportGeoJSON_;\nvar MapGeodataImportVTSGeodata = MapGeodataImportVTSGeodata_;\nvar MapGeodataImport3DTiles = MapGeodataImport3DTiles_;\n\n//var GeographicLib = GeographicLib_;\nvar vec3 = vec3_;\nvar mat4 = mat4_;\n\n\nvar MapGeodataBuilder = function(map) {\n    this.map = map;\n    this.groups = [];\n    this.nodes = [];\n    this.currentGroup = null;\n    this.bboxMin = [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY];\n    this.bboxMax = [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY];\n\n    this.navSrs = this.map.getNavigationSrs();\n    //this.navSrs = this.map.getPublicSrs();\n    this.physSrs = this.map.getPhysicalSrs();\n\n    this.heightsToProcess = 0;\n    this.heightsProcessBuffer = null;\n    this.heightsProcessBufferFirst = null;\n    this.heightsProcessBufferLast = null;\n\n    this.heightsLod = 8;\n    this.heightsSource = \"heightmap-by-precision\";\n    this.updateCallback = null;\n    this.processingHeights = false;\n    this.processHeightsCalls = [];\n};\n\n\nMapGeodataBuilder.prototype.addToHeightsBuffer = function(coords) {\n\n    var item = { coords: coords, prev: null, next: this.heightsProcessBufferFirst };\n\n    if (this.heightsProcessBufferFirst != null) {\n        this.heightsProcessBufferFirst.prev = item;\n    }\n\n    //add item as first in list\n    this.heightsProcessBufferFirst = item;\n\n    if (this.heightsProcessBufferLast == null) {\n        this.heightsProcessBufferLast = item;\n    }\n};\n\n\nMapGeodataBuilder.prototype.removeFromHeightsBuffer = function(item) {\n    var hit = false;\n\n    if (item == this.heightsProcessBufferFirst) {\n        this.heightsProcessBufferFirst = item.next;\n        hit = true;\n\n        if (this.heightsProcessBufferFirst != null) {\n            this.heightsProcessBufferFirst.prev = null;\n        }\n    }\n\n    if (item == this.heightsProcessBufferLast) {\n        this.heightsProcessBufferLast = item.prev;\n        hit = true;\n\n        if (this.heightsProcessBufferLast != null) {\n            this.heightsProcessBufferLast.next = null;\n        }\n    }\n\n    if (!hit) {\n        if (!item.prev) {\n            //debugger;\n        } else {\n            item.prev.next = item.next;\n        }\n        \n        if (!item.next) {\n            //debugger;\n        } else {\n            item.next.prev = item.prev;\n        }\n    }\n};\n\n\nMapGeodataBuilder.prototype.addGroup = function(id) {\n    this.groups.push({\n        points: [],\n        lines: [],\n        polygons: [],\n        id: id\n    });\n\n    this.currentGroup = this.groups[this.groups.length - 1];\n\n    return this;\n};\n\n\nMapGeodataBuilder.prototype.addNode = function(parentNode, volume, precision, tileset) {\n    var node = {\n        meshes: [],\n        precision : precision,\n        volume : volume,\n        tileset: tileset ? true : false,\n        nodes : []\n    };\n\n    if(!parentNode) {\n        parentNode = this;\n    }\n\n    parentNode.nodes.push(node);\n\n    return node;\n};\n\n\nMapGeodataBuilder.prototype.addMesh = function(node, path) {\n    if (node) {\n        node.meshes.push(path);\n    }\n};\n\n\nMapGeodataBuilder.prototype.addPoint = function(point, heightMode, properties, id, srs, directCopy) {\n    if (!this.currentGroup) {\n        this.addGroup('some-group');\n    }\n\n    var floatHeight = (!heightMode || heightMode == \"float\"), coords;\n\n    var feature = {\n        id : id,\n        properties : properties\n    };\n\n    if (floatHeight) {\n        coords = [point[0], point[1], point[2] || 0, feature, null, null ];\n        this.addToHeightsBuffer(coords);\n\n        feature.points = [ coords ];\n        feature.floatHeights = true;\n        feature.srs = srs ? srs : this.navSrs;\n        feature.heightsToProcess = 1;\n        this.heightsToProcess++;\n    } else {\n        if (directCopy) {\n            feature.points = [ [point[0], point[1], point[2]] ];\n        } else {\n            feature.points = [ this.physSrs.convertCoordsFrom(point, srs ? srs : this.navSrs) ];\n        }\n    }\n\n    this.currentGroup.points.push(feature);\n\n    return this;\n};\n\n\nMapGeodataBuilder.prototype.addPointArray = function(points, heightMode, properties, id, srs, directCopy) {\n    if (!this.currentGroup) {\n        this.addGroup('some-group');\n    }\n\n    var floatHeight = (!heightMode || heightMode == \"float\"), i, li, point, coords;\n    srs = srs ? srs : this.navSrs;\n\n    var feature = {\n        id : id,\n        properties : properties\n    };\n\n    var featurePoints = new Array(points.length);\n\n    if (floatHeight) {\n        \n        for (i = 0, li = points.length; i < li; i++) {\n            point = points[i];\n            coords = [point[0], point[1], point[2] || 0, feature, null, null ];\n            this.addToHeightsBuffer(coords);\n\n            featurePoints[i] = coords;\n        }\n\n        feature.floatHeights = true;\n        feature.srs = srs;\n        feature.heightsToProcess = li;\n        this.heightsToProcess++;\n    } else {\n        if (directCopy) {\n            for (i = 0, li = points.length; i < li; i++) {\n                point = points[i];\n                featurePoints[i] = [point[0], point[1], point[2]];\n            }\n        } else {\n            for (i = 0, li = points.length; i < li; i++) {\n                featurePoints[i] = this.physSrs.convertCoordsFrom(points[i], srs);\n            }\n        }\n    }\n\n    feature.points = featurePoints;\n    this.currentGroup.points.push(feature);\n\n    return this;\n};\n\n\nMapGeodataBuilder.prototype.addLineString = function(linePoints, heightMode, properties, id, srs, directCopy) {\n    if (!this.currentGroup) {\n        this.addGroup('some-group');\n    }\n\n    var floatHeight = (!heightMode || heightMode == \"float\"), i, li, point, coords;\n    srs = srs ? srs : this.navSrs;\n\n    var feature = {\n        id : id,\n        properties : properties\n    };\n\n    var featurePoints = new Array(linePoints.length);\n\n    if (floatHeight) {\n        \n        for (i = 0, li = linePoints.length; i < li; i++) {\n            point = linePoints[i];\n            coords = [point[0], point[1], point[2] || 0, feature, null, null ];\n            this.addToHeightsBuffer(coords);\n\n            featurePoints[i] = coords;\n        }\n\n        feature.floatHeights = true;\n        feature.srs = srs;\n        feature.heightsToProcess = li;\n        this.heightsToProcess += li;\n    } else {\n        if (directCopy) {\n            for (i = 0, li = linePoints.length; i < li; i++) {\n                point = linePoints[i];\n                featurePoints[i] = [point[0], point[1], point[2]];\n            }\n        } else {\n            for (i = 0, li = linePoints.length; i < li; i++) {\n                featurePoints[i] = this.physSrs.convertCoordsFrom(linePoints[i], srs);\n            }\n        }\n    }\n\n    feature.lines = [featurePoints];\n    this.currentGroup.lines.push(feature);\n\n    return this;\n};\n\n\nMapGeodataBuilder.prototype.addLineStringArray = function(lines, heightMode, properties, id, srs, directCopy) {\n    if (!this.currentGroup) {\n        this.addGroup('some-group');\n    }\n\n    var floatHeight = (!heightMode || heightMode == \"float\");\n    var subline, points, i, li, j, lj, point, coords;\n    srs = srs ? srs : this.navSrs;\n\n    var feature = {\n        id : id,\n        properties : properties\n    };\n\n    var featureLines = new Array(lines.length);\n\n    if (floatHeight) {\n        var totalHeights = 0;\n        \n        for (i = 0, li = lines.length; i < li; i++) {\n            subline = lines[i];\n            points = new Array(subline.length);\n\n            for (j = 0, lj = subline.length; j < lj; j++) {\n                point = subline[j];\n                coords = [point[0], point[1], point[2] || 0, feature, null, null];\n                this.addToHeightsBuffer(coords);\n                points[j] = coords;\n            }\n\n            totalHeights += lj;\n            featureLines[i] = points;\n        }\n\n        feature.floatHeights = true;\n        feature.srs = srs;\n        feature.heightsToProcess = totalHeights;\n        this.heightsToProcess += totalHeights;\n    } else {\n\n        for (i = 0, li = lines.length; i < li; i++) {\n            subline = lines[i];\n            points = new Array(subline.length);\n\n            if (directCopy) {\n                for (j = 0, lj = subline.length; j < lj; j++) {\n                    point = subline[j];\n                    points[j] = [point[0], point[1], point[2]];\n                }\n            } else {\n                for (j = 0, lj = subline.length; j < lj; j++) {\n                    points[j] = this.physSrs.convertCoordsFrom(subline[j], srs);\n                }\n            }\n\n            featureLines[i] = points;\n        }\n    }\n\n    feature.lines = featureLines;\n    this.currentGroup.lines.push(feature);\n\n    return this;\n};\n\n\nMapGeodataBuilder.prototype.addPolygon = function(shape, holes, middle, heightMode, properties, id, srs, tesselation) {\n    //older versions are in github history 2.20.x\n    return this.addPolygon3(shape, holes, middle, heightMode, properties, id, srs, tesselation);\n};\n\n\nMapGeodataBuilder.prototype.getPolygonCenter = function(shape, projected, proj) {\n    if (shape && !shape.length) {\n        return [0,0];\n    }\n\n    var sumX = 0, sumY = 0, sumZ = 0; //, convertLong = false;\n\n    if (projected) {\n        for (var i = 0, li = shape.length; i < li; i++) {\n            var coords = shape[i];\n            sumX += coords[0];\n            sumY += coords[1];\n            sumZ += coords[2];\n        }\n\n        return [sumX / li, sumY / li, sumZ / li];\n    } else {\n        for (var i = 0, li = shape.length; i < li; i++) {\n            var coords = shape[i];\n            var coords2 = proj.forward(coords);\n            sumX += coords2[0];\n            sumY += coords2[1];\n            sumZ += coords2[2];\n        }\n\n        var avgX = sumX / li;\n        var avgY = sumY / li;\n        var avgZ = sumZ / li;\n\n        // convert average x, y, z coordinate to latitude and longtitude\n\n        coords = proj.inverse([avgX, avgY, avgZ]);\n\n        return [coords[0], coords[1], 0];\n    }\n};\n\n\nMapGeodataBuilder.prototype.insidePolygon = function(point, vertices, verticesLength) {\n    // ray-casting algorithm based on\n    // https://github.com/substack/point-in-polygon/blob/master/index.js\n    \n    var x = point[0], y = point[1];\n\n    verticesLength = (verticesLength || Math.round(vertices.length/3));\n\n    var inside = false;\n    for (var i = 0, j = verticesLength - 1, li = verticesLength; i < li; j = i++) {\n        var xi = vertices[i*3], yi = vertices[i*3+1];\n        var xj = vertices[j*3], yj = vertices[j*3+1];\n        \n        var intersect = ((yi > y) != (yj > y))\n            && (x < (xj - xi) * (y - yi) / (yj - yi) + xi);\n        if (intersect) inside = !inside;\n    }\n    \n    return inside;\n};    \n\n\n//same as addPolygon but works on poles\n/*\nMapGeodataBuilder.prototype.addPolygon2 = function(shape, holes, middle, heightMode, properties, id, srs) {\n    srs = srs ? srs : this.navSrs.srsProj4;\n    holes = holes || [];\n\n    var flatShape = shape, flatHoles = holes, i, li, j, lj, k, lk, l, hole, coords, coords2, proj, holesIndices, vertices;\n    var projected = true;\n\n    //convert shape and holes to flat space\n    if (srs.indexOf('+proj=longlat') != -1) {\n        projected = false;\n        //proj = this.map.proj4(srs, '+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs');\n        //proj = this.map.proj4(srs, '+proj=merc +lat_ts=' + center[1] + ' +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs');\n        proj = this.map.proj4(srs, '+proj=geocent +datum=WGS84 +units=m +no_defs');\n    }\n\n    var c = document.getElementById(\"dbg-canvas\");\n    var ctx = c.getContext(\"2d\");\n    var sx = 300;\n    var fx = 300 / 7500000;\n\n\n    for (i = 0, li = shape.length; i < li; i++) {\n        shape[i][2] = shape[i][2] || 0; //add third coord\n    }\n\n    for (i = 0, li = holes.length; i < li; i++) {\n        hole = holes[i];\n        totalPoints += hole.length*3;\n\n        for (j = 0, lj = hole.length; j < lj; j++) {\n            hole[j][2] = hole[j][2] || 0; //add third coord\n        }\n    }\n\n    var center = this.getPolygonCenter(shape, projected, proj), north, east, dir;\n\n    this.addPoint(center.slice(), 'fix', {}, 'aaa');\n\n    var ned = this.map.measure.getNewNED(center);\n\n    dir = ned.direction;\n    north = ned.north;\n    east = ned.east;\n\n    var totalPoints = shape.length*3;\n\n    for (i = 0, li = shape.length; i < li; i++) {\n        shape[i][2] = shape[i][2] || 0; //add third coord\n    }\n\n    for (i = 0, li = holes.length; i < li; i++) {\n        hole = holes[i];\n        totalPoints += hole.length*3;\n\n        for (j = 0, lj = hole.length; j < lj; j++) {\n            hole[j][2] = hole[j][2] || 0; //add third coord\n        }\n    }\n\n    flatShape = new Array(totalPoints);\n    vertices = new Array(totalPoints);\n    j = 0;\n\n    var borders = new Array(holes.length + 1);\n    var border = new Array(shape.length);\n    borders[0] = border;\n\n    ctx.beginPath();\n\n    for (i = 0, li = shape.length; i < li; i++) {\n        border[i] = i;\n        coords = shape[i];\n        vertices[j] = coords[0]; \n        vertices[j+1] = coords[1]; \n        vertices[j+2] = coords[2];\n\n        if (proj) {\n            coords2 = proj.forward(shape[i]);\n            coords= [ east[0] * coords2[0] + east[1] * coords2[1] + east[2] * coords2[2],\n                      dir[0] * coords2[0] + dir[1] * coords2[1] + dir[2] * coords2[2], 0];\n        } else {\n            coords = shape[i];\n        }\n\n        if (i ==0) {\n            ctx.moveTo(coords[0]*fx+sx,coords[1]*fx+sx);\n        } else {\n            ctx.lineTo(coords[0]*fx+sx,coords[1]*fx+sx);\n        }\n\n        flatShape[j] = coords[0]; \n        flatShape[j+1] = coords[1]; \n        flatShape[j+2] = coords[2]; \n        j+=3;\n    }\n\n    flatHoles = new Array(holes.length);\n    holesIndices = new Array(holes.length);\n\n    for (i = 0, li = holes.length; i < li; i++) {\n        hole = holes[i];\n        holesIndices[i] = Math.round(j/3);\n\n        border = new Array(hole.length);\n        borders[i + 1] = border;\n\n        l = Math.floor(j /3);\n\n        for (k = 0, lk = hole.length; k < lk; k++) {\n            coords = hole[k];\n            vertices[j] = coords[0]; \n            vertices[j+1] = coords[1]; \n            vertices[j+2] = coords[2]; \n\n            if (proj) {\n                coords2 = proj.forward(hole[k]);\n                coords = [east[0] * coords2[0] + east[1] * coords2[1] + east[2] * coords2[2],\n                          dir[0] * coords2[0] + dir[1] * coords2[1] + dir[2] * coords2[2], 0];\n            } else {\n                coords = hole[k];\n            }\n\n            if (k ==0) {\n                ctx.moveTo(coords[0]*fx+sx,coords[1]*fx+sx);\n            } else {\n                ctx.lineTo(coords[0]*fx+sx,coords[1]*fx+sx);\n            }\n\n\n            flatShape[j] = coords[0]; \n            flatShape[j+1] = coords[1]; \n            flatShape[j+2] = coords[2]; \n            j+=3;\n            border[k] = l++;\n        }\n    }\n\n    ctx.strokeStyle = \"#ff0000\";\n    ctx.stroke();\n\n\n    var surface = vts.earcut(flatShape, holesIndices, 3);\n\n    this.addPolygonRAW(vertices, surface, borders, middle, heightMode, properties, id, srs);\n\n    ctx.beginPath();\n\n    for (i = 0, li = surface.length; i < li; i+=3) {\n        var v1 = surface[i]*3;\n        var v2 = surface[i+1]*3;\n        var v3 = surface[i+2]*3;\n\n        ctx.moveTo(flatShape[v1]*fx+sx,flatShape[v1+1]*fx+sx);\n        ctx.lineTo(flatShape[v2]*fx+sx,flatShape[v2+1]*fx+sx);\n        ctx.lineTo(flatShape[v3]*fx+sx,flatShape[v3+1]*fx+sx);\n        ctx.lineTo(flatShape[v1]*fx+sx,flatShape[v1+1]*fx+sx);\n    }\n\n    ctx.strokeStyle = \"#0000ff\";\n    ctx.stroke();\n\n    return this;\n};\n*/\n\n//same as addPolygon3 but with Delaunator sudivision\n/*\nMapGeodataBuilder.prototype.addPolygon4 = function(shape, holes, middle, heightMode, properties, id, srs) {\n    srs = srs ? srs : this.navSrs.srsProj4;\n    holes = holes || [];\n    holes = [];\n\n    var flatShape = shape, flatHoles = holes, i, li, j, lj, k, lk, l, hole, coords = [], coords2 = [], proj, holesIndices, vertices;\n    var projected = true, dx, dy, dz, dd, maxDistance = 0, maxDistanceCoords, flatCenter, trueHolesCount = holes.length;\n    var density = 20;\n\n    //convert shape and holes to flat space\n    if (srs.indexOf('+proj=longlat') != -1) {\n        projected = false;\n        proj = this.map.proj4(srs, '+proj=geocent +datum=WGS84 +units=m +no_defs');\n    }\n\n    var totalPoints = shape.length*3;\n\n    for (i = 0, li = shape.length; i < li; i++) {\n        shape[i][2] = shape[i][2] || 0; //add third coord\n    }\n\n    for (i = 0, li = holes.length; i < li; i++) {\n        hole = holes[i];\n        totalPoints += hole.length*3;\n\n        for (j = 0, lj = hole.length; j < lj; j++) {\n            hole[j][2] = hole[j][2] || 0; //add third coord\n        }\n    }\n\n    var center = this.getPolygonCenter(shape, projected, proj), north, east, dir, geod;\n\n    var ned = this.map.measure.getNewNED(center);\n\n   // dir = ned.direction;\n    north = ned.direction;\n    east = ned.east;\n\n     geod = this.map.measure.getGeodesic(); \n\n    flatShape = new Array(totalPoints);\n    vertices = new Array(totalPoints);\n    j = 0;\n\n    var borders = new Array(holes.length + 1);\n    var border = new Array(shape.length);\n    borders[0] = border;\n\n\n    var gcenter;\n\n    if (proj) {\n        gcenter = proj.forward(center);\n    } else {\n        gcenter = center;\n    }\n\n    for (i = 0, li = shape.length; i < li; i++) {\n        border[i] = i;\n        coords = shape[i];\n        vertices[j] = coords[0]; \n        vertices[j+1] = coords[1]; \n        vertices[j+2] = coords[2];\n\n        if (proj) {\n            coords2 = proj.forward(shape[i]);\n            coords = [east[0] * coords2[0] + east[1] * coords2[1] + east[2] * coords2[2],\n                      north[0] * coords2[0] + north[1] * coords2[1] + north[2] * coords2[2], 0];\n        } else {\n            coords2 = shape[i];\n            coords = coords2;\n        }\n\n        dx = coords2[0] - gcenter[0];\n        dy = coords2[1] - gcenter[1];\n        dz = coords2[2] - gcenter[2];\n        dd = dx * dx + dy * dy + dz*dz;\n        if (dd > maxDistance) {\n            maxDistance = dd;\n            maxDistanceCoords = shape[i]\n        }\n\n        flatShape[j] = coords[0]; \n        flatShape[j+1] = coords[1]; \n        flatShape[j+2] = coords[2]; \n        j+=3;\n    }\n\n    maxDistance = Math.sqrt(maxDistance);\n\n    var inPoints = new Array(density * density * 3);\n    var inPointsFlat = new Array(density * density * 3);\n    var inPointsIndex = 0;\n    var inPointsFlatIndex = 0;\n\n    if (proj) {\n\n        if (!projected) {\n            //maxDistanceCoords = proj.inverse(maxDistanceCoords); maxDistanceCoords[2] = 0;\n            maxDistance = this.map.measure.getDistance(center, maxDistanceCoords, false)[0];\n        }\n        \n        density = Math.round(density * 0.5);\n\n        var r, ncoords, ecoords, lastJ = j;\n        var geod = this.map.measure.getGeodesic();\n        \n        for (i = -density; i < density; i++) {\n            r = geod.Direct(center[1], center[0], 0, (maxDistance / (density)) * i);\n            ncoords = [r.lon2, r.lat2];\n\n            for (j = -density; j < density; j++) {\n                r = geod.Direct(ncoords[1], ncoords[0], 90, (maxDistance / (density)) * j);\n\n                ecoords = [r.lon2, r.lat2, 0];\n                coords2 = proj.forward(ecoords);\n                coords = [east[0] * coords2[0] + east[1] * coords2[1] + east[2] * coords2[2],\n                          north[0] * coords2[0] + north[1] * coords2[1] + north[2] * coords2[2], 0];\n               \n                if (this.insidePolygon(coords, flatShape, shape.length)) {\n                    //this.addPoint(ecoords.slice(), 'fix', {}, 'bbb', srs);\n                    //holes.push([ecoords]);\n\n                    inPoints[inPointsIndex] = ecoords[0];\n                    inPoints[inPointsIndex+1] = ecoords[1];\n                    inPoints[inPointsIndex+2] = ecoords[2];\n                    inPointsIndex += 3;\n\n                    inPointsFlat[inPointsFlatIndex] = coords[0];\n                    inPointsFlat[inPointsFlatIndex+1] = coords[1];\n                    inPointsFlat[inPointsFlatIndex+2] = coords[2];\n                    inPointsFlatIndex += 3;\n\n                } else {\n                    //this.addPoint(ecoords.slice(), 'fix', {}, 'aaa', srs);\n                }\n            }\n        }\n\n        j = lastJ; \n\n        inPoints = inPoints.slice(0, inPointsIndex);\n        inPointsFlat = inPointsFlat.slice(0, inPointsFlatIndex);\n\n        vertices = vertices.concat(inPoints);\n        flatShape = flatShape.concat(inPointsFlat);\n\n    }\n\n    if (false) {\n        flatHoles = new Array(holes.length);\n        holesIndices = new Array(holes.length);\n\n        for (i = 0, li = holes.length; i < li; i++) {\n            hole = holes[i];\n            holesIndices[i] = Math.round(j/3);\n\n            if (i < trueHolesCount) {\n                border = new Array(hole.length);\n                borders[i + 1] = border;\n            }\n\n            l = Math.floor(j /3);\n\n            for (k = 0, lk = hole.length; k < lk; k++) {\n                coords = hole[k];\n                vertices[j] = coords[0]; \n                vertices[j+1] = coords[1]; \n                vertices[j+2] = coords[2]; \n\n                if (proj) {\n                    coords2 = proj.forward(hole[k]);\n                    coords = [east[0] * coords2[0] + east[1] * coords2[1] + east[2] * coords2[2],\n                              north[0] * coords2[0] + north[1] * coords2[1] + north[2] * coords2[2], 0];\n                } else {\n                    coords = hole[k];\n                }\n\n                flatShape[j] = coords[0]; \n                flatShape[j+1] = coords[1]; \n                flatShape[j+2] = coords[2]; \n                j+=3;\n\n                if (i < trueHolesCount) {\n                    border[k] = l++;\n                }\n            }\n        }\n    }\n\n    var flatShape2 = new Array((flatShape.length / 3) *2);\n\n    for (i = 0, j =0, li = flatShape.length; i < li; i+=3, j+=2) {\n        flatShape2[j] = flatShape[i];\n        flatShape2[j+1] = flatShape[i+1];\n    }\n\n    var delaunay = new Delaunator(flatShape2);\n\n    var surface2 = delaunay.triangles;\n    var smax = 30;//vertices.length / 3;\n\n    var surface = new Array(surface2.length);\n\n    j = 0;\n\n    for (i = 0, li = surface.length; i < li; i+=3) {\n        var v1 = surface2[i]*2;\n        var v2 = surface2[i+1]*2;\n        var v3 = surface2[i+2]*2;\n\n        var mid = [(flatShape2[v1]+flatShape2[v2]+flatShape2[v3])/3,\n                   (flatShape2[v1+1]+flatShape2[v2+1]+flatShape2[v3+1])/3,0];\n\n        if (this.insidePolygon(mid, flatShape, shape.length)) {\n            surface[j] = surface2[i+2];\n            surface[j+1] = surface2[i+1];\n            surface[j+2] = surface2[i];\n            j+=3;\n        }\n    }\n\n    surface = surface.slice(0,j);\n\n    //var surface = vts.earcut(flatShape, holesIndices, 3);\n    //var surface = vts.earcut(flatShape2, holesIndices, 2);\n\n    var c = document.getElementById(\"dbg-canvas\");\n    var ctx = c.getContext(\"2d\");\n    var sx = 300;\n    var fx = 300 / 7500000; fx*=30;\n\n\n    ctx.beginPath();\n\n    for (i = 0, li = surface2.length; i < li; i+=3) {\n        var v1 = surface2[i]*2;\n        var v2 = surface2[i+1]*2;\n        var v3 = surface2[i+2]*2;\n\n        ctx.moveTo(flatShape2[v1]*fx+sx,flatShape2[v1+1]*fx+sx);\n        ctx.lineTo(flatShape2[v2]*fx+sx,flatShape2[v2+1]*fx+sx);\n        ctx.lineTo(flatShape2[v3]*fx+sx,flatShape2[v3+1]*fx+sx);\n        ctx.lineTo(flatShape2[v1]*fx+sx,flatShape2[v1+1]*fx+sx);\n    }\n\n    ctx.strokeStyle = \"#0000ff\";\n    ctx.stroke();\n\n\n    ctx.beginPath();\n\n    for (i = 0, li = surface.length; i < li; i+=3) {\n        var v1 = surface[i]*2;\n        var v2 = surface[i+1]*2;\n        var v3 = surface[i+2]*2;\n\n        ctx.moveTo(flatShape2[v1]*fx+sx,flatShape2[v1+1]*fx+sx);\n        ctx.lineTo(flatShape2[v2]*fx+sx,flatShape2[v2+1]*fx+sx);\n        ctx.lineTo(flatShape2[v3]*fx+sx,flatShape2[v3+1]*fx+sx);\n        ctx.lineTo(flatShape2[v1]*fx+sx,flatShape2[v1+1]*fx+sx);\n    }\n\n    ctx.strokeStyle = \"#ff00ff\";\n    ctx.stroke();\n\n    this.addPolygonRAW(vertices, surface, borders, middle, heightMode, properties, id, srs);\n\n    return this;\n};*/\n\n//same as addPolygon but works on poles and is subivided\nMapGeodataBuilder.prototype.addPolygon3 = function(shape, holes, middle, heightMode, properties, id, srs, tesselation) {\n    srs = srs ? srs : this.navSrs.srsProj4;\n    holes = holes || [];\n\n    var flatShape = shape, flatHoles = holes, i, li, j, lj, k, lk, l, hole, coords = [], coords2 = [], proj, holesIndices, vertices;\n    var projected = true, dx, dy, dz, dd, maxDistance = 0, maxDistanceCoords, flatCenter, trueHolesCount = holes.length;\n\n    tesselation = tesselation || {};\n    tesselation.mode = tesselation['mode'] || 'auto';\n\n    if (tesselation.mode == 'by-length') {\n        tesselation.length = tesselation['length'] || 200000;\n    }\n\n    var density = 19;\n\n    //convert shape and holes to flat space\n    if (srs.indexOf('+proj=longlat') != -1) {\n        projected = false;\n        proj = this.map.proj4(srs, '+proj=geocent +datum=WGS84 +units=m +no_defs');\n        //proj = this.map.proj4(srs, '+proj=merc +a=6378137 +b=6378137 +lat_ts=0.0 +lon_0=0.0 +x_0=0.0 +y_0=0 +k=1.0 +units=m +nadgrids=@null +wktext +no_defs');\n    }\n\n    var totalPoints = shape.length*3;\n\n    for (i = 0, li = shape.length; i < li; i++) {\n        shape[i][2] = shape[i][2] || 0; //add third coord\n    }\n\n    for (i = 0, li = holes.length; i < li; i++) {\n        hole = holes[i];\n        totalPoints += hole.length*3;\n\n        for (j = 0, lj = hole.length; j < lj; j++) {\n            hole[j][2] = hole[j][2] || 0; //add third coord\n        }\n    }\n\n    var center = this.getPolygonCenter(shape, projected, proj), north, east, dir, geod;\n\n    var ned = this.map.measure.getNewNED(center);\n\n    dir = ned.direction;\n    north = ned.direction;\n    east = ned.east;\n\n    flatShape = new Array(totalPoints);\n    vertices = new Array(totalPoints);\n    j = 0;\n\n    var borders = new Array(holes.length + 1);\n    var border = new Array(shape.length);\n    borders[0] = border;\n\n    var gcenter;\n\n    if (proj) {\n        gcenter = proj.forward(center);\n    } else {\n        gcenter = center;\n    }\n\n    for (i = 0, li = shape.length; i < li; i++) {\n        border[i] = i;\n        coords = shape[i];\n        vertices[j] = coords[0]; \n        vertices[j+1] = coords[1]; \n        vertices[j+2] = coords[2];\n\n        if (proj) {\n            coords2 = proj.forward(shape[i]);\n            coords = [east[0] * coords2[0] + east[1] * coords2[1] + east[2] * coords2[2],\n                      north[0] * coords2[0] + north[1] * coords2[1] + north[2] * coords2[2], 0];\n        } else {\n            coords2 = shape[i];\n            coords = coords2;\n        }\n\n        dx = coords2[0] - gcenter[0];\n        dy = coords2[1] - gcenter[1];\n        dz = coords2[2] - gcenter[2];\n        dd = dx * dx + dy * dy + dz*dz;\n        if (dd > maxDistance) {\n            maxDistance = dd;\n            maxDistanceCoords = shape[i]\n        }\n\n        flatShape[j] = coords[0]; \n        flatShape[j+1] = coords[1]; \n        flatShape[j+2] = coords[2]; \n        j+=3;\n    }\n\n    //check curve orientation (have to be clockwise)\n    var angle = 0, x1, y1, x2, y2, index;\n    for (i = 0, li = shape.length * 3; i < li; i+=3) {\n        x1 = flatShape[i]; \n        y1 = flatShape[i+1]; \n\n        if (i < li - 3) {\n            x2 = flatShape[i+3]; \n            y2 = flatShape[i+4]; \n        } else {\n            x2 = flatShape[0]; \n            y2 = flatShape[1]; \n        }\n\n        //angle += (x2 - x1) * (y2 + y1);\n        angle += (x1 * y2);\n        angle -= (x2 * y1);\n    }    \n    \n    if (angle < 0) { //convert to clokwise\n        var vertices2 = vertices.slice();\n        var flatShape2 = flatShape.slice();\n\n        for (i = 0, li = shape.length * 3; i < li; i+=3) {\n            vertices[i] = vertices2[li - i - 3];\n            vertices[i+1] = vertices2[li - i - 2];\n            vertices[i+2] = vertices2[li - i - 1];\n\n            flatShape[i] = flatShape2[li - i - 3];\n            flatShape[i+1] = flatShape2[li - i - 2];\n            flatShape[i+2] = flatShape2[li - i - 1];\n        }\n    }\n\n\n    flatHoles = new Array(holes.length);\n    holesIndices = new Array(holes.length);\n\n    for (i = 0, li = holes.length; i < li; i++) {\n        hole = holes[i];\n        index = Math.round(j/3);\n        holesIndices[i] = index;\n\n        if (i < trueHolesCount) {\n            border = new Array(hole.length);\n            borders[i + 1] = border;\n        }\n\n        l = index;\n\n        for (k = 0, lk = hole.length; k < lk; k++) {\n            coords = hole[k];\n            vertices[j] = coords[0]; \n            vertices[j+1] = coords[1]; \n            vertices[j+2] = coords[2]; \n\n            if (proj) {\n                coords2 = proj.forward(hole[k]);\n                //cords = [coords2[0], coords2[1], 0];\n                coords = [east[0] * coords2[0] + east[1] * coords2[1] + east[2] * coords2[2],\n                          dir[0] * coords2[0] + dir[1] * coords2[1] + dir[2] * coords2[2], 0];\n            } else {\n                coords = hole[k];\n            }\n\n            flatShape[j] = coords[0]; \n            flatShape[j+1] = coords[1]; \n            flatShape[j+2] = coords[2]; \n            j+=3;\n\n            if (i < trueHolesCount) {\n                border[k] = l;\n                l++;\n            }\n        }\n\n        //check curve orientation (have to be clockwise)\n        angle = 0;\n        index *= 3;\n        for (k = 0, lk = hole.length * 3; k < lk; k+=3) {\n            x1 = flatShape[index + k]; \n            y1 = flatShape[index + k+1]; \n\n            if (k < lk - 3) {\n                x2 = flatShape[index + k+3]; \n                y2 = flatShape[index + k+4]; \n            } else {\n                x2 = flatShape[index + 0]; \n                y2 = flatShape[index + 1]; \n            }\n\n            //angle += (x2 - x1) * (y2 + y1);\n            angle += (x1 * y2);\n            angle -= (x2 * y1);\n        }    \n        \n        if (angle > 0) { //convert to clokwise\n            var vertices2 = vertices.slice();\n            var flatShape2 = flatShape.slice();\n\n            for (k = 0, lk = hole.length * 3; k < lk; k+=3) {\n                vertices[index + k] = vertices2[index + lk - k - 3];\n                vertices[index + k+1] = vertices2[index + lk - k - 2];\n                vertices[index + k+2] = vertices2[index + lk - k - 1];\n\n                flatShape[index + k] = flatShape2[index + lk - k - 3];\n                flatShape[index + k+1] = flatShape2[index + lk - k - 2];\n                flatShape[index + k+2] = flatShape2[index + lk - k - 1];\n            }\n        }\n\n    }\n\n    var surface = vts.earcut(flatShape, holesIndices, 3);\n\n    var maxFaceLength = Number.POSITIVE_INFINITY;\n\n    switch (tesselation.mode) {\n        case 'auto':      maxFaceLength = Math.sqrt(maxDistance) / density; break;\n        case 'by-length': maxFaceLength = tesselation.length; break;\n    }\n\n    var v1, v2, v3, p1, p2, p3, p4, p5, p6;\n\n    //copy bordes\n    var borders2 = new Array(borders.length), border2; \n    for (i = 0, li = borders.length; i < li; i++) {\n        borders2[i] = borders[i].slice();\n    }\n\n    var sbuffer = new Array(65536*3);\n    var sbuffer2 = new Array(65536*3);\n    var sbuffer3 = new Array(65536*3);\n\n    var sbufferIndex = 0, l1, l2, l3, vv1, vv2, vv3;\n    var sbufferIndex2 = 0;//, i1, i2, i3;\n    var sbufferIndex3 = 0;\n\n    var vbuffer = new Array(65536*3);\n\n    //copy vertices\n    for (i = 0, li = vertices.length; i < li; i +=3) { \n        vbuffer[i] = vertices[i];\n        vbuffer[i+1] = vertices[i+1];\n        vbuffer[i+2] = vertices[i+2];\n    }\n\n    var m = Math.round(li / 3);\n\n\n    var lastMaxFaceLength = maxFaceLength;\n\n    for (i = 0, li = surface.length; i < li; i +=3) { \n\n        v1 = surface[i];\n        v2 = surface[i+1];\n        v3 = surface[i+2];\n        sbufferIndex = 3;\n\n        //find face edges in borders\n        var edge1 = null, edge2 = null, edge3 = null;\n        //var edge1, edge2, edge3;\n        for (j = 0, lj = borders.length; j < lj; j++) { \n            border = borders[j];\n            border2 = borders2[j];\n\n            for (k = 0, lk = border.length; k < lk; k++) {\n                var k2 = (k < border.length - 1) ? k + 1 : 0;\n\n                if ((v1 == border[k] && v2 == border[k2]) || (v1 == border[k2] && v2 == border[k])) {\n                    border2[k] = [border[k]];\n                    edge1 = border2[k];\n                }\n\n                if ((v2 == border[k] && v3 == border[k2]) || (v2 == border[k2] && v3 == border[k])) {\n                    border2[k] = [border[k]];\n                    edge2 = border2[k];\n                }\n\n                if ((v3 == border[k] && v1 == border[k2]) || (v1 == border[k2] && v3 == border[k])) {\n                    border2[k] = [border[k]];\n                    edge3 = border2[k];\n                }\n            }\n        }\n\n        sbuffer[0] = [v1, edge1];\n        sbuffer[1] = [v2, edge2];\n        sbuffer[2] = [v3, edge3];\n\n        var depth = 0, r;\n\n        //loop until subdivision is finished\n        do {\n\n            for (j = 0, lj = sbufferIndex; j < lj; j+=3) {\n                //face indices//\n                vv1 = sbuffer[j][0];\n                vv2 = sbuffer[j+1][0];\n                vv3 = sbuffer[j+2][0];\n                //face edges\n                edge1 = sbuffer[j][1];\n                edge2 = sbuffer[j+1][1];\n                edge3 = sbuffer[j+2][1];\n\n                /*console.log('v1: ' + vv1 + ' v2:' + vv2 + ' v3:' + vv3);\n                console.log('e1: ' + (Array.isArray(edge1) ? 'a' : '') + edge1 + ' e2:' + (Array.isArray(edge2) ? 'a' : '') + edge2 + ' e3:' + (Array.isArray(edge3) ? 'a' : '') + edge3);\n                */\n\n                //get face vertices\n                p1 = [vbuffer[vv1*3], vbuffer[vv1*3+1], vbuffer[vv1*3+2]];\n                p2 = [vbuffer[vv2*3], vbuffer[vv2*3+1], vbuffer[vv2*3+2]];\n                p3 = [vbuffer[vv3*3], vbuffer[vv3*3+1], vbuffer[vv3*3+2]];\n\n                //covert coords to geocent\n                if (proj) {\n                    p1 = proj.forward(p1);\n                    p2 = proj.forward(p2);\n                    p3 = proj.forward(p3);\n                }\n\n                //get face edges lengths\n                l1 = vec3.length([p1[0] - p2[0], p1[1] - p2[1], p1[2] - p2[2]]);\n                l2 = vec3.length([p2[0] - p3[0], p2[1] - p3[1], p2[2] - p3[2]]);\n                l3 = vec3.length([p3[0] - p1[0], p3[1] - p1[1], p3[2] - p1[2]]);\n\n                //get max length\n                l = Math.max(l1,l2,l3);\n\n                //console.log('ll:' + l);\n\n                //is length below threshold\n                if (l < maxFaceLength) {  \n                    //add to final buffer\n                    sbuffer3[sbufferIndex3] = vv1;\n                    sbuffer3[sbufferIndex3+1] = vv2;\n                    sbuffer3[sbufferIndex3+2] = vv3;\n                    sbufferIndex3 += 3;\n                } else {\n\n                    //crete new vertices in the midle of edges and convert coords back to long lat\n                    //if (l1 > 200000 && !projected) {\n                     //   r = geod.Inverse(vbuffer[vv1*3+1], vbuffer[vv1*3], vbuffer[vv2*3+1], vbuffer[vv2*3]);\n                     //   r = geod.Direct(vbuffer[vv1*3+1], vbuffer[vv1*3], r.azi1, r.s12 *0.5);\n                    //    p4 = [r.lon2, r.lat2, (vbuffer[vv1*3+2]+vbuffer[vv2*3+2])*0.5];\n                    //} else {\n                        p4 = [(p1[0]+p2[0])*0.5, (p1[1]+p2[1])*0.5, (p1[2]+p2[2])*0.5];\n                    if (proj) {\n                        p4 = proj.inverse(p4); p4[2] = (vbuffer[vv1 * 3 + 2] + vbuffer[vv2 * 3 + 2]) * 0.5;\n                    }\n                    //}\n\n                    //if (l2 > 200000 && !projected) {\n                     //   r = geod.Inverse(vbuffer[vv2*3+1], vbuffer[vv2*3], vbuffer[vv3*3+1], vbuffer[vv3*3]);\n                     //   r = geod.Direct(vbuffer[vv2*3+1], vbuffer[vv2*3], r.azi1, r.s12 *0.5);\n                     //   p5 = [r.lon2, r.lat2, (vbuffer[vv2*3+2]+vbuffer[vv3*3+2])*0.5];\n                    //} else {\n                        p5 = [(p2[0]+p3[0])*0.5, (p2[1]+p3[1])*0.5, (p2[2]+p3[2])*0.5];\n                    if (proj) {\n                        p5 = proj.inverse(p5); p5[2] = (vbuffer[vv2 * 3 + 2] + vbuffer[vv3 * 3 + 2]) * 0.5;\n                    }\n                    //}\n\n                    //if (l3 > 200000 && !projected) {\n                     //   r = geod.Inverse(vbuffer[vv3*3+1], vbuffer[vv3*3], vbuffer[vv1*3+1], vbuffer[vv1*3]);\n                     //   r = geod.Direct(vbuffer[vv3*3+1], vbuffer[vv3*3], r.azi1, r.s12 *0.5);\n                     //   p6 = [r.lon2, r.lat2, (vbuffer[vv3*3+2]+vbuffer[vv1*3+2])*0.5];\n                    //} else {\n                        p6 = [(p3[0]+p1[0])*0.5, (p3[1]+p1[1])*0.5, (p3[2]+p1[2])*0.5];\n                    if (proj) {\n                        p6 = proj.inverse(p6); p6[2] = (vbuffer[vv3 * 3 + 2] + vbuffer[vv1 * 3 + 2]) * 0.5;\n                    }\n                    //}\n\n                    var mm = m * 3;\n\n                    if (l1 == l) {\n                        //console.log('l1');\n\n                        //add new vertices to the buffer\n                        vbuffer[mm] = p4[0];\n                        vbuffer[mm+1] = p4[1];\n                        vbuffer[mm+2] = p4[2];\n\n                        //create new edges\n                        if (edge1) {\n                            edge1[0] = [[edge1[0]], [-m]];\n                            edge1 = edge1[0];\n                        }\n\n                        l = sbufferIndex2;\n\n                        //store new faces with edges\n                        sbuffer2[l] = [vv1, edge1 ? edge1[0] : null];\n                        sbuffer2[l+1] = [m, null];\n                        sbuffer2[l+2] = [vv3, edge3 ? edge3 : null];\n                        /*console.log('-v1: ' + sbuffer2[l][0] + ' v2:' + sbuffer2[l+1][0] + ' v3:' + sbuffer2[l+2][0]);\n                        console.log('p1: ' + (Array.isArray(sbuffer2[l][1]) ? 'a' : '') + sbuffer2[l][1] + \n                                   ' p2:' + (Array.isArray(sbuffer2[l+1][1]) ? 'a' : '') + sbuffer2[l+1][1] +\n                                   ' p3:' + (Array.isArray(sbuffer2[l+2][1]) ? 'a' : '') + sbuffer2[l+2][1]);*/\n\n\n                        sbuffer2[l+3] = [m, edge1 ? edge1[1] : null];\n                        sbuffer2[l+4] = [vv2, edge2 ? edge2 : null];\n                        sbuffer2[l+5] = [vv3, null];\n                        /*console.log('-v1: ' + sbuffer2[l+3][0] + ' v2:' + sbuffer2[l+4][0] + ' v3:' + sbuffer2[l+5][0]);\n                        console.log('p4: ' + (Array.isArray(sbuffer2[l+3][1]) ? 'a' : '') + sbuffer2[l+3][1] + \n                                   ' p5:' + (Array.isArray(sbuffer2[l+4][1]) ? 'a' : '') + sbuffer2[l+4][1] +\n                                   ' p6:' + (Array.isArray(sbuffer2[l+5][1]) ? 'a' : '') + sbuffer2[l+5][1]);*/\n\n                    } else if (l2 == l) {\n                        //console.log('l2');\n\n                        //add new vertices to the buffer\n                        vbuffer[mm] = p5[0];\n                        vbuffer[mm+1] = p5[1];\n                        vbuffer[mm+2] = p5[2];\n\n                        //create new edges\n                        if (edge2) {\n                            edge2[0] = [[edge2[0]], [-m]];\n                            edge2 = edge2[0];\n                        }\n\n                        l = sbufferIndex2;\n\n                        //store new faces with edges\n                        sbuffer2[l] = [vv1, edge1 ? edge1 : null];\n                        sbuffer2[l+1] = [vv2, edge2 ? edge2[0] : null];\n                        sbuffer2[l+2] = [m, null];\n                        /*console.log('-v1: ' + sbuffer2[l][0] + ' v2:' + sbuffer2[l+1][0] + ' v3:' + sbuffer2[l+2][0]);\n                        console.log('p1: ' + (Array.isArray(sbuffer2[l][1]) ? 'a' : '') + sbuffer2[l][1] + \n                                   ' p2:' + (Array.isArray(sbuffer2[l+1][1]) ? 'a' : '') + sbuffer2[l+1][1] +\n                                   ' p3:' + (Array.isArray(sbuffer2[l+2][1]) ? 'a' : '') + sbuffer2[l+2][1]);*/\n\n                        sbuffer2[l+3] = [m, edge2 ? edge2[1] : null];\n                        sbuffer2[l+4] = [vv3, edge3 ? edge3 : null];\n                        sbuffer2[l+5] = [vv1, null];\n                        /*console.log('-v1: ' + sbuffer2[l+3][0] + ' v2:' + sbuffer2[l+4][0] + ' v3:' + sbuffer2[l+5][0]);\n                        console.log('p4: ' + (Array.isArray(sbuffer2[l+3][1]) ? 'a' : '') + sbuffer2[l+3][1] + \n                                   ' p5:' + (Array.isArray(sbuffer2[l+4][1]) ? 'a' : '') + sbuffer2[l+4][1] +\n                                   ' p6:' + (Array.isArray(sbuffer2[l+5][1]) ? 'a' : '') + sbuffer2[l+5][1]);*/\n\n                    } else if (l3 == l) {\n                        //console.log('l3');\n\n                        //add new vertices to the buffer\n                        vbuffer[mm] = p6[0];\n                        vbuffer[mm+1] = p6[1];\n                        vbuffer[mm+2] = p6[2];\n\n                        //create new edges\n                        if (edge3) {\n                            edge3[0] = [[edge3[0]], [-m]];\n                            edge3 = edge3[0];\n                        }\n\n                        l = sbufferIndex2;\n\n                        //store new faces with edges\n                        sbuffer2[l] = [vv1, edge1 ? edge1 : null];\n                        sbuffer2[l+1] = [vv2, null];\n                        sbuffer2[l+2] = [m, edge3 ? edge3[1] : null];\n                        /*console.log('-v1: ' + sbuffer2[l][0] + ' v2:' + sbuffer2[l+1][0] + ' v3:' + sbuffer2[l+2][0]);\n                        console.log('p1: ' + (Array.isArray(sbuffer2[l][1]) ? 'a' : '') + sbuffer2[l][1] + \n                                   ' p2:' + (Array.isArray(sbuffer2[l+1][1]) ? 'a' : '') + sbuffer2[l+1][1] +\n                                   ' p3:' + (Array.isArray(sbuffer2[l+2][1]) ? 'a' : '') + sbuffer2[l+2][1]);*/\n\n                        sbuffer2[l+3] = [m, null]; \n                        sbuffer2[l+4] =  [vv2, edge2 ? edge2 : null]; \n                        sbuffer2[l+5] = [vv3, edge3 ? edge3[0] : null];\n                        /*console.log('-v1: ' + sbuffer2[l+3][0] + ' v2:' + sbuffer2[l+4][0] + ' v3:' + sbuffer2[l+5][0]);\n                        console.log('p4: ' + (Array.isArray(sbuffer2[l+3][1]) ? 'a' : '') + sbuffer2[l+3][1] + \n                                   ' p5:' + (Array.isArray(sbuffer2[l+4][1]) ? 'a' : '') + sbuffer2[l+4][1] +\n                                   ' p6:' + (Array.isArray(sbuffer2[l+5][1]) ? 'a' : '') + sbuffer2[l+5][1]);*/\n\n                    }\n\n                    m += 1;\n                    sbufferIndex2 += 6;\n                }\n            }\n\n            var tmp = sbuffer;\n            sbuffer = sbuffer2;\n            sbuffer2 = tmp;\n            sbufferIndex = sbufferIndex2;\n            sbufferIndex2 = 0;\n\n            //if (sbufferIndex3 > 1000) {\n                //break;\n            //}\n\n            depth++;\n\n            //if (depth == 1) {\n              //  maxFaceLength = Number.POSITIVE_INFINITY;\n            //}\n\n\n        } while(sbufferIndex > 0);\n\n        maxFaceLength = lastMaxFaceLength;\n\n    }\n\n    var ebuffer = new Array(65536*3), ebufferIndex = 0;\n\n    var unrollBorder = (function(borderArray) {\n        for (var o = 0, lo = borderArray.length; o < lo; o++) {\n            if (Array.isArray(borderArray[o])) {\n                unrollBorder(borderArray[o]);\n            } else {\n                ebuffer[ebufferIndex] = borderArray[o];\n                ebufferIndex++;\n            }\n        }\n    });\n\n    var lastEbufferIndex = 0;\n\n    //unroll edges\n    for (i = 0, li = borders2.length; i < li; i++) {\n        unrollBorder(borders2[i]);\n        borders2[i] = ebuffer.slice(lastEbufferIndex, ebufferIndex);\n        lastEbufferIndex = ebufferIndex;\n    }\n\n    surface = new Array(sbufferIndex);\n\n    for (i = 0, li = sbufferIndex3; i < li; i+=3) {\n        surface[i] = sbuffer3[i];\n        surface[i+1] = sbuffer3[i+1];\n        surface[i+2] = sbuffer3[i+2];\n    }\n\n    vertices = new Array(m * 3);\n    j = 0;\n\n    for (i = 0, li = m*3; i < li; i+=3) {\n        vertices[i] = vbuffer[i];\n        vertices[i+1] = vbuffer[i+1];\n        vertices[i+2] = vbuffer[i+2];\n        //this.addPoint([vertices[i], vertices[i+1], vertices[i+2]], 'fix', {name:(''+j)}, 'aaa');\n        j++;\n    }\n\n    this.addPolygonRAW(vertices, surface, borders2, middle, heightMode, properties, id, srs);\n};\n\n\nMapGeodataBuilder.prototype.addPolygonRAW = function(vertices, surface, borders, middle, heightMode, properties, id, srs, directCopy, transform) {\n    if (!this.currentGroup) {\n        this.addGroup('some-group');\n    }\n\n    var floatHeight = (!heightMode || heightMode == \"float\");\n    var i, li, j = 0, coords;\n    srs = srs ? srs : this.navSrs;\n\n    var feature = {\n        id : id,\n        properties : properties\n    };\n\n    var featureVertices = new Array(Math.round(vertices.length/3));\n\n    if (floatHeight) {\n        for (i = 0, li = vertices.length; i < li; i+=3) {\n            coords = [vertices[i], vertices[i+1], vertices[i+2], feature, null, null];\n            this.addToHeightsBuffer(coords);\n            featureVertices[j++] = coords;\n        }\n\n        feature.floatHeights = true;\n        feature.srs = srs;\n        feature.heightsToProcess = featureVertices.length;\n        this.heightsToProcess += featureVertices.length;\n    } else {\n\n        for (i = 0, li = vertices.length; i < li; i+=3) {\n\n            if (directCopy) {\n                if (transform) {\n                    featureVertices[j++] = [vertices[i]*transform.sx+transform.px, vertices[i+1]*transform.sy+transform.py, vertices[i+2]*transform.sz+transform.pz];\n                } else {\n                    featureVertices[j++] = [vertices[i], vertices[i+1], vertices[i+2]];\n                }\n            } else {\n                featureVertices[j++] = this.physSrs.convertCoordsFrom(coords, srs);\n            }\n        }\n    }\n\n    var featureSurface = surface.slice();\n    var featureBorders = new Array(borders.length);\n\n    for (i = 0, li = borders.length; i < li; i++) {\n        featureBorders[i] = borders[i].slice();\n    }\n\n    feature.vertices = featureVertices;\n    feature.surface = featureSurface;\n    feature.borders = featureBorders;\n    this.currentGroup.polygons.push(feature);\n\n    return this;\n};\n\n\nMapGeodataBuilder.prototype.importVTSGeodata = function(json, groupIdPrefix, dontCreateGroups) {\n    var importer = new MapGeodataImportVTSGeodata(this, groupIdPrefix, dontCreateGroups);\n    return importer.processJSON(json);\n};\n\n\nMapGeodataBuilder.prototype.importGeoJson = function(json, heightMode, srs, options) {\n    var importer = new MapGeodataImportGeoJSON(this, heightMode, srs, options);\n    return importer.processJSON(json);\n};\n\n\nMapGeodataBuilder.prototype.import3DTiles = function(json, options) {\n    var importer = new MapGeodataImport3DTiles(this, options);\n    return importer.processJSON(json);\n};\n\nMapGeodataBuilder.prototype.load3DTiles = function(path, options, onLoaded) {\n    var importer = new MapGeodataImport3DTiles(this, options);\n    importer.loadJSON(path, options, onLoaded);\n};\n\nMapGeodataBuilder.prototype.processHeights = function(heightsSource, precision, onProcessed) {\n    if (this.heightsToProcess <= 0) {\n        if (onProcessed) {\n            onProcessed(this);\n        }\n\n        return;\n    }\n\n    if (this.processingHeights) {\n        this.processHeightsCalls.push(this.processHeights.bind(this, heightsSource, precision));\n    }\n\n    this.processingHeights = true;\n    this.heightsSource = heightsSource;\n    this.heightsLod = precision;\n\n    var item = this.heightsProcessBufferFirst, lastItem;\n    //var item = this.heightsProcessBuffer, lastItem;\n    var p, res, nodeOnly, heightsLod, nodeOnly, coords, noSource;\n\n    if (item) {\n\n        switch (heightsSource) {\n            case \"node-by-precision\":\n                nodeOnly = true;\n            case \"heightmap-by-precision\":\n\n                coords = item.coords;\n\n                if (coords[3].srs) {\n                    p = this.navSrs.convertCoordsFrom(coords, coords[3].srs);\n                } else {\n                    p = coords;\n                }\n\n                heightsLod = this.map.measure.getOptimalHeightLodBySampleSize(p, precision);\n                break;\n\n            case \"node-by-lod\":\n                nodeOnly = true;\n                precision -= 8;\n            case \"heightmap-by-lod\":\n                heightsLod = precision;\n                break;\n            case \"none\":\n                noSource = true;\n                break;\n        }\n\n        do {\n            coords = item.coords;\n\n            if (!noSource && coords[4] == null) {\n                if (coords[3].srs) {\n                    p = this.navSrs.convertCoordsFrom(coords, coords[3].srs);\n                } else {\n                    p = coords;\n                }\n\n                res = this.map.measure.getSpatialDivisionNode(p);\n\n                coords[4] = res[0];\n                coords[5] = res[1];\n\n                //coords[4] = p;\n            }\n\n\n            if (noSource) {\n                res = [0,true,true];\n            } else {\n                res = this.map.measure.getSurfaceHeight(coords, heightsLod, null, coords[4], coords[5], null, nodeOnly);\n            }\n\n            //res = this.map.measure.getSurfaceHeight(coords[4], heightsLod, null, null, null, null, nodeOnly);\n\n            //console.log(JSON.stringify(res));\n\n            //if (res[1] || res[2]) { //precisin reached or not aviable\n                //res = this.map.measure.getSurfaceHeight(coords[4], heightsLod, null, null, null, null, nodeOnly);\n                //res = this.map.measure.getSurfaceHeight(coords, heightsLod, null, coords[4], coords[5], null, nodeOnly);\n            //}\n\n            if (res[1] || res[2]) { //precision reached or not aviable\n\n                //console.log(JSON.stringify(res));\n\n                coords[2] += res[0]; //convet float height to fixed\n                this.removeFromHeightsBuffer(item, lastItem);\n                coords[3].heightsToProcess--;\n                this.heightsToProcess--;\n\n                if (coords[3].heightsToProcess <= 0) { //this prevents multiple conversions\n                    coords[3].floatHeights = false;\n                }\n\n                p = [coords[0], coords[1], coords[2]];\n\n                //console.log(JSON.stringify(p) + \"  srs  \" + coords[3].srs);\n\n                p = this.physSrs.convertCoordsFrom(p, coords[3].srs);\n\n                coords[0] = p[0];\n                coords[1] = p[1];\n                coords[2] = p[2];\n            }\n\n            lastItem = item;\n            item = item.next;\n\n        } while(item);\n    }\n\n    if (this.heightsToProcess <= 0) {\n        if (this.updateCallback) {\n            this.updateCallback(); //remove callback\n        }\n\n        this.processingHeights = false;\n\n        if (onProcessed) {\n            onProcessed(this);\n        }\n\n        if (this.processHeightsCalls.length > 1) {\n            (this.processHeightsCalls.shift())();\n        }\n\n    } else {\n        if (!this.updateCallback) {\n            this.updateCallback = this.map.core.on(\"map-update\", this.processHeights.bind(this, this.heightsSource, this.heightsLod, onProcessed));\n        }\n    }\n\n};\n\nMapGeodataBuilder.prototype.extractGeometry = function(id) {\n    var feature, i, li, j, lj, points, lines,\n        vertexBuffer, indexBuffer, index, p;\n\n\n    for (var i = 0, li = this.groups.length; i < li; i++) {\n        var group = this.groups[i];\n\n        var groupPoints = group.points;\n        var groupLines = group.lines;\n        var groupPolygons = group.polygons, j, lj;\n\n        //get group bbox\n        for (j = 0, lj = groupPoints.length; j < lj; j++) {\n            if (groupPoints[j].id == id) {\n                feature = groupPoints[j];\n            }\n        }\n\n        for (j = 0, lj = groupLines.length; j < lj; j++) {\n            if (groupLines[j].id == id) {\n                feature = groupLines[j];\n            }\n        }\n\n        for (j = 0, lj = groupPolygons.length; j < lj; j++) {\n            if (groupPolygons[j].id == id) {\n                feature = groupPolygons[j];\n            }\n        }\n    }\n\n    if (feature) {\n        if (feature.points) {\n\n            points = feature.points;\n\n            if (points.length > 0) {\n                vertexBuffer = new Float64Array(points.length * 3);\n\n                for (i = 0, li = points.length; i < li; i++) {\n                    index = i * 3;\n                    p = points[i];\n                    vertexBuffer[index] = p[0];\n                    vertexBuffer[index+1] = p[1];\n                    vertexBuffer[index+2] = p[2];\n                }\n            }\n\n            return new MapGeodataGeometry(this.map, {'type': 'point-geometry', 'id':feature.id, 'geometryBuffer': vertexBuffer });\n\n        } else if (feature.lines) {\n\n            lines = feature.lines;\n\n            if (lines.length > 0) {\n                \n                var totalPoints = 0;\n\n                for (i = 0, li = lines.length; i < li; i++) {\n                    totalPoints += lines[i].length;\n                }\n\n                vertexBuffer = new Float64Array(totalPoints * 3);\n                indexBuffer = new Uint32Array(li);\n                index = 0;\n\n                for (i = 0, li = lines.length; i < li; i++) {\n\n                    var points = lines[i];\n\n                    for (j = 0, lj = points.length; j < lj; j++) {\n                        p = points[j];\n                        vertexBuffer[index] = p[0];\n                        vertexBuffer[index+1] = p[1];\n                        vertexBuffer[index+2] = p[2];\n                        index += 3;\n                    }\n                }\n            }\n\n            return new MapGeodataGeometry(this.map, {'type': 'line-geometry', 'id':feature.id, 'geometryBuffer': vertexBuffer, 'indicesBuffer': indexBuffer });\n        } else if (feature.vertices) {\n\n            /*feature.vertices = featureVertices;\n            feature.surface = featureSurface;\n            feature.borders = featureBorders;*/\n\n            return new MapGeodataGeometry(this.map, {'type': 'polygon-geometry', 'id':feature.id, 'geometryBuffer': feature.vertices, 'surface': feature.surface });\n        }\n\n        return;\n    }\n\n};\n\n\nMapGeodataBuilder.prototype.compileGroup = function(group, resolution) {\n    var bboxMin = [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY];\n    var bboxMax = [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY];\n    var geodataGroup = {};\n    var groupPoints = group.points, points, p, feature, finalFeature;\n    var groupLines = group.lines, lines, line, i, li, j, lj, k, lk;\n    var groupPolygons = group.polygons, borders;\n\n    geodataGroup.id = group.id;\n\n    //get group bbox\n    for (i = 0, li = groupPoints.length; i < li; i++) {\n        points = groupPoints[i].points;\n\n        for (j = 0, lj = points.length; j < lj; j++) {\n            p = points[j];\n\n            if (p[0] > bboxMax[0]) { bboxMax[0] = p[0]; }\n            if (p[1] > bboxMax[1]) { bboxMax[1] = p[1]; }\n            if (p[2] > bboxMax[2]) { bboxMax[2] = p[2]; }\n\n            if (p[0] < bboxMin[0]) { bboxMin[0] = p[0]; }\n            if (p[1] < bboxMin[1]) { bboxMin[1] = p[1]; }\n            if (p[2] < bboxMin[2]) { bboxMin[2] = p[2]; }\n        }\n    }\n\n    for (i = 0, li = groupLines.length; i < li; i++) {\n        lines = groupLines[i].lines;\n\n        for (j = 0, lj = lines.length; j < lj; j++) {\n            line = lines[j];\n\n            for (k = 0, lk = line.length; k < lk; k++) {\n                p = line[k];\n\n                if (p[0] > bboxMax[0]) { bboxMax[0] = p[0]; }\n                if (p[1] > bboxMax[1]) { bboxMax[1] = p[1]; }\n                if (p[2] > bboxMax[2]) { bboxMax[2] = p[2]; }\n\n                if (p[0] < bboxMin[0]) { bboxMin[0] = p[0]; }\n                if (p[1] < bboxMin[1]) { bboxMin[1] = p[1]; }\n                if (p[2] < bboxMin[2]) { bboxMin[2] = p[2]; }\n            }\n        }\n    }\n\n    for (i = 0, li = groupPolygons.length; i < li; i++) {\n        points = groupPolygons[i].vertices;\n\n        for (j = 0, lj = points.length; j < lj; j++) {\n            p = points[j];\n\n            if (p[0] > bboxMax[0]) { bboxMax[0] = p[0]; }\n            if (p[1] > bboxMax[1]) { bboxMax[1] = p[1]; }\n            if (p[2] > bboxMax[2]) { bboxMax[2] = p[2]; }\n\n            if (p[0] < bboxMin[0]) { bboxMin[0] = p[0]; }\n            if (p[1] < bboxMin[1]) { bboxMin[1] = p[1]; }\n            if (p[2] < bboxMin[2]) { bboxMin[2] = p[2]; }\n        }\n    }\n\n    if (!resolution) {\n        var maxDelta = Math.max((bboxMax[0] - bboxMin[0]) + 1, (bboxMax[1] - bboxMin[1]) + 1, (bboxMax[2] - bboxMin[2]) + 1);\n\n        //25cm resolution\n        resolution = maxDelta / 0.25;\n        resolution = Math.max(resolution, 1024);\n        resolution = Math.min(resolution, (2<<20));\n    }\n\n    geodataGroup.resolution = resolution;\n\n    //process coords to resolution\n    var bboxScaleFactor = [resolution/((bboxMax[0] - bboxMin[0]) + 1),\n                           resolution/((bboxMax[1] - bboxMin[1]) + 1),\n                           resolution/((bboxMax[2] - bboxMin[2]) + 1)];\n\n    geodataGroup.points = new Array(groupPoints.length);\n\n    for (i = 0, li = groupPoints.length; i < li; i++) {\n        feature = groupPoints[i]; \n        points = feature.points;\n\n        var finalPoints = new Array(points.length);\n\n        for (j = 0, lj = points.length; j < lj; j++) {\n            p = points[j];\n\n            finalPoints[j] = [ Math.round((p[0] - bboxMin[0]) * bboxScaleFactor[0]),\n                               Math.round((p[1] - bboxMin[1]) * bboxScaleFactor[1]),\n                               Math.round((p[2] - bboxMin[2]) * bboxScaleFactor[2]) ];\n        }\n\n        finalFeature = {\n            points : finalPoints\n        };\n\n        if (feature.id) {\n            finalFeature.id = feature.id;\n        }\n\n        if (feature.properties) {\n            finalFeature.properties = feature.properties;\n        }\n\n        geodataGroup.points[i] = finalFeature;\n    }\n\n    geodataGroup.lines = new Array(groupLines.length);\n\n    for (i = 0, li = groupLines.length; i < li; i++) {\n        feature = groupLines[i]; \n        lines = feature.lines;\n\n        var finalLines = new Array(lines.length);\n\n        for (j = 0, lj = lines.length; j < lj; j++) {\n            line = lines[j];\n\n            finalPoints = new Array(line.length);\n\n            for (k = 0, lk = line.length; k < lk; k++) {\n                p = line[k];\n\n                finalPoints[k] = [ Math.round((p[0] - bboxMin[0]) * bboxScaleFactor[0]),\n                                   Math.round((p[1] - bboxMin[1]) * bboxScaleFactor[1]),\n                                   Math.round((p[2] - bboxMin[2]) * bboxScaleFactor[2]) ];\n            }\n\n            finalLines[j] = finalPoints;\n        }\n\n        finalFeature = {\n            lines : finalLines\n        };\n\n        if (feature.id) {\n            finalFeature.id = feature.id;\n        }\n\n        if (feature.properties) {\n            finalFeature.properties = feature.properties;\n        }\n\n        geodataGroup.lines[i] = finalFeature;\n    }\n\n\n    geodataGroup.polygons = new Array(groupPolygons.length);\n\n    for (i = 0, li = groupPolygons.length; i < li; i++) {\n        feature = groupPolygons[i]; \n        points = feature.vertices;\n\n        var finalVertices = new Array(points.length);\n        k = 0;\n\n        for (j = 0, lj = points.length; j < lj; j++) {\n            p = points[j];\n            finalVertices[k++] = Math.round((p[0] - bboxMin[0]) * bboxScaleFactor[0]);\n            finalVertices[k++] = Math.round((p[1] - bboxMin[1]) * bboxScaleFactor[1]);\n            finalVertices[k++] = Math.round((p[2] - bboxMin[2]) * bboxScaleFactor[2]);\n        }\n\n        finalFeature = {\n            vertices : finalVertices,\n            surface : feature.surface.slice()\n        };\n\n        borders = feature.borders;\n        var finalBorders = new Array(borders.length);\n\n        for (j = 0, lj = finalBorders.length; j < lj; j++) {\n            finalBorders[j] = borders[j].slice();\n        }\n\n        finalFeature.borders = finalBorders;\n\n        if (feature.id) {\n            finalFeature.id = feature.id;\n        }\n\n        if (feature.properties) {\n            finalFeature.properties = feature.properties;\n        }\n\n        geodataGroup.polygons[i] = finalFeature;\n    }\n\n    geodataGroup.bbox = [ bboxMin, bboxMax ];\n\n    if (bboxMax[0] > this.bboxMax[0]) { this.bboxMax[0] = bboxMax[0]; }\n    if (bboxMax[1] > this.bboxMax[1]) { this.bboxMax[1] = bboxMax[1]; }\n    if (bboxMax[2] > this.bboxMax[2]) { this.bboxMax[2] = bboxMax[2]; }\n\n    if (bboxMin[0] < this.bboxMin[0]) { this.bboxMin[0] = bboxMin[0]; }\n    if (bboxMin[1] < this.bboxMin[1]) { this.bboxMin[1] = bboxMin[1]; }\n    if (bboxMin[2] < this.bboxMin[2]) { this.bboxMin[2] = bboxMin[2]; }\n\n    return geodataGroup;\n};\n\n\nMapGeodataBuilder.prototype.makeGeodata = function(resolution) {\n    this.bboxMin = [Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY, Number.POSITIVE_INFINITY];\n    this.bboxMax = [Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY, Number.NEGATIVE_INFINITY];\n\n    var geodata = {\n        \"version\" : 1,\n        \"groups\" : [],\n    }\n\n    for (var i = 0, li = this.groups.length; i < li; i++) {\n        geodata[\"groups\"].push(this.compileGroup(this.groups[i], resolution));\n    }\n\n    if (this.nodes.length > 0) {\n        geodata.nodes = [];\n        for (i = 0, li = this.nodes.length; i < li; i++) {\n            geodata[\"nodes\"].push(this.nodes[i]);\n        }\n    }\n\n    return geodata;\n};\n\n\nMapGeodataBuilder.prototype.makeFreeLayer = function(style, resolution, geodata) {\n    if (!geodata) {\n        geodata = this.makeGeodata(resolution);\n    }\n\n    if (!style) {\n        style = {\n            \"layers\" : {\n                \"my-lines\" : {\n                    \"filter\" : [\"==\", \"#type\", \"line\"],\n                    \"line\": true,\n                    \"line-width\" : 4,\n                    \"line-color\": [255,0,255,255],\n                    \"zbuffer-offset\" : [-5,0,0]\n                },\n                \"my-points\" : {\n                    \"filter\" : [\"==\", \"#type\", \"point\"],\n                    \"point\": true,\n                    \"point-radius\" : 10,\n                    \"point-color\": [0,0,255,255],\n                    \"zbuffer-offset\" : [-5,0,0]\n                }\n            }\n        }        \n    }\n\n    var freeLayer = {\n            'credits' : [],\n            'displaySize' : 1024,\n            'extents' : {\n                'll' : this.bboxMin,\n                'ur' : this.bboxMax\n            },\n            'geodata' : geodata,\n            'style' : style,\n            'type' : 'geodata'\n        };\n\n    return freeLayer;        \n};\n\nexport default MapGeodataBuilder;\n\n","\nimport BBox_ from '../renderer/bbox';\nimport {utils as utils_} from '../utils/utils';\nimport MapGeodataBuilder_ from './geodata-builder';\n\n//get rid of compiler mess\nvar BBox = BBox_;\nvar utils = utils_;\nvar MapGeodataBuilder = MapGeodataBuilder_;\n\n\nvar MapGeodata = function(map, url, extraInfo) {\n    this.map = map;\n    this.stats = map.stats;\n    this.mapLoaderUrl  = url;\n    this.extraInfo = extraInfo;\n\n    this.bbox = new BBox();\n    this.size = 0;\n    this.fileSize = 0;\n    this.geodata = null;\n    this.type = 'geodata';\n\n    this.cacheItem = null;\n\n    this.loadState = 0;\n    this.loadErrorTime = null;\n    this.loadErrorCounter = 0;\n\n    this.map.markDirty();\n};\n\n\nMapGeodata.prototype.kill = function() {\n    this.bbox = null;\n    this.killGeodata();\n};\n\n\nMapGeodata.prototype.killGeodata = function(killedByCache) {\n    if (this.geodata) {\n        this.geodata = null;\n    }\n    \n    if (killedByCache !== true && this.cacheItem != null) {\n        this.map.resourcesCache.remove(this.cacheItem);\n    }\n\n    //if (this.gpuSubmeshes.length == 0) {\n    this.loadState = 0;\n    //}\n\n    this.size = 0;\n    this.fileSize = 0;\n    this.cacheItem = null;\n};\n\n\nMapGeodata.prototype.isReady = function(doNotLoad, priority) {\n    var doNotUseGpu = (this.map.stats.gpuRenderUsed >= this.map.maxGpuUsed);\n    doNotLoad = doNotLoad || doNotUseGpu;\n\n    if (this.loadState == 2) { //loaded\n        this.map.resourcesCache.updateItem(this.cacheItem);\n        return true;\n    } else {\n        if (this.loadState == 0) { \n            if (doNotLoad) {\n                //remove from queue\n                //if (this.mapLoaderUrl) {\n                  //  this.map.loader.remove(this.mapLoaderUrl);\n                //}\n            } else {\n                //not loaded\n                //add to loading queue or top position in queue\n\n                /*if (typeof this.mapLoaderUrl !== 'object' || this..mapLoaderUrl.indexOf('tileset.json')) { \n\n                    var geodata = new MapGeodataBuilder(this.map);\n                    geodata.load3DTiles(this..mapLoaderUrl, {}, (function(){ \n\n                        //TODO:\n                    }));\n\n                }\n                else*/ if (typeof this.mapLoaderUrl === 'object') { //use geodata directly\n                    this.geodata = JSON.stringify(this.mapLoaderUrl);\n                    this.loadState = 2;\n                    this.size = this.geodata.length;\n                    this.cacheItem = this.map.resourcesCache.insert(this.killGeodata.bind(this, true), this.size);\n                    this.map.resourcesCache.updateItem(this.cacheItem);\n                    return true;\n                } else {\n                    this.scheduleLoad(priority);\n                }\n            }\n        } else if (this.loadState == 3) { //loadError\n            if (this.loadErrorCounter <= this.map.config.mapLoadErrorMaxRetryCount &&\n                performance.now() > this.loadErrorTime + this.map.config.mapLoadErrorRetryTime) {\n\n                this.scheduleLoad(priority);                    \n            }\n        }  //else load in progress\n    }\n\n    return false;\n};\n\n\nMapGeodata.prototype.scheduleLoad = function(priority) {\n    //if (this.mapLoaderUrl == null) {\n        //this.mapLoaderUrl = this.map.url.makeUrl(this.tile.surface.meshUrl, {lod:this.tile.id[0], ix:this.tile.id[1], iy:this.tile.id[2] });\n    //}\n\n    this.map.loader.load(this.mapLoaderUrl, this.onLoad.bind(this), priority, this.extraInfo.tile, 'geodata');\n};\n\n\nMapGeodata.prototype.onLoad = function(url, onLoaded, onError) {\n    this.mapLoaderCallLoaded = onLoaded;\n    this.mapLoaderCallError = onError;\n\n    this.loadState = 1;\n    \n    if (this.map.config.mapGeodataBinaryLoad) {\n        this.map.loader.processLoadBinary(url, this.onLoaded.bind(this), this.onLoadError.bind(this), null, 'geodata');\n    } else {\n        utils.loadJSON(url, this.onLoaded.bind(this), this.onLoadError.bind(this), true, (utils.useCredentials ? (this.mapLoaderUrl.indexOf(this.map.url.baseUrl) != -1) : false), this.map.core.xhrParams);\n    }\n\n    return;\n};\n\n\nMapGeodata.prototype.onLoadError = function() {\n    if (this.map.killed){\n        return;\n    }\n\n    this.loadState = 3;\n    this.loadErrorTime = performance.now();\n    this.loadErrorCounter ++;\n\n    //make sure we try to load it again\n    if (this.loadErrorCounter <= this.map.config.mapLoadErrorMaxRetryCount) { \n        setTimeout((function(){ if (!this.map.killed) { this.map.markDirty(); } }).bind(this), this.map.config.mapLoadErrorRetryTime);\n    }    \n\n    this.mapLoaderCallError();\n};\n\n\nMapGeodata.prototype.onLoaded = function(data) {\n    if (this.map.killed){\n        return;\n    }\n\n    var size = data.length || data.byteLength;\n    if (!size) {\n        size = 0;\n    }\n\n    this.size = size;\n    this.fileSize = size;\n\n    this.geodata = data;\n\n    this.cacheItem = this.map.resourcesCache.insert(this.killGeodata.bind(this, true), size);\n\n    this.map.markDirty();\n    this.loadState = 2;\n    this.loadErrorTime = null;\n    this.loadErrorCounter = 0;\n    this.mapLoaderCallLoaded();\n};\n\n// Returns RAM usage in bytes.\n//MapGeodata.prototype.getSize = function () {\n  //  return this.size;\n//};\n\n//MapGeodata.prototype.getFileSize = function () {\n  //  return this.fileSize;\n//};\n\nexport default MapGeodata;\n\n\n","\nimport MapTexture_ from './texture';\nimport MapSubtexture_ from './subtexture';\nimport MapMetatile_ from './metatile';\nimport MapMesh_ from './mesh';\nimport MapGeodata_ from './geodata';\n\n//get rid of compiler mess\nvar MapTexture = MapTexture_;\nvar MapSubtexture = MapSubtexture_;\nvar MapMetatile = MapMetatile_;\nvar MapMesh = MapMesh_;\nvar MapGeodata = MapGeodata_;\n\n\nvar MapResourceNode = function(map, parent, id) {\n    this.map = map;\n    this.id = id;\n    this.parent = parent;\n\n    this.metatiles = {};\n    this.meshes = {};\n    this.textures = {};\n    this.subtextures = {};\n    this.geodata = {};\n    this.credits = {};\n\n    this.children = [null, null, null, null];\n};\n\n\nMapResourceNode.prototype.kill = function() {\n    //kill children\n    for (var i = 0; i < 4; i++) {\n        if (this.children[i] != null) {\n            this.children[i].kill();\n        }\n    }\n\n    this.children = [null, null, null, null];\n\n    var parent = this.parent;\n    this.parent = null;\n\n    if (parent != null) {\n        parent.removeChild(this);\n    }\n    \n    //kill resources?\n};\n\n\nMapResourceNode.prototype.addChild = function(index) {\n    if (this.children[index]) {\n        return;\n    }\n    \n    var id = this.id;\n    var childId = [id[0] + 1, id[1] << 1, id[2] << 1];\n\n    switch (index) {\n    case 1: childId[1]++; break;\n    case 2: childId[2]++; break;\n    case 3: childId[1]++; childId[2]++; break;\n    }\n\n    this.children[index] = new MapResourceNode(this.map, this, childId);\n};\n\n\nMapResourceNode.prototype.removeChildByIndex = function(index) {\n    if (this.children[index] != null) {\n        this.children[index].kill();\n        this.children[index] = null;\n    }\n};\n\n\nMapResourceNode.prototype.removeChild = function(tile) {\n    for (var i = 0; i < 4; i++) {\n        if (this.children[i] == tile) {\n            this.children[i].kill();\n            this.children[i] = null;\n        }\n    }\n};\n\n\n// Meshes ---------------------------------\n\nMapResourceNode.prototype.getMesh = function(path, tile) {\n    var mesh = this.meshes[path];\n    \n    if (!mesh) {\n        mesh = new MapMesh(this.map, path, tile);\n        this.meshes[path] = mesh;\n    }\n    \n    return mesh;\n};\n\n\n// Geodata ---------------------------------\n\nMapResourceNode.prototype.getGeodata = function(path, extraInfo) {\n    var geodata = this.geodata[path];\n    \n    if (!geodata) {\n        geodata = new MapGeodata(this.map, path, extraInfo);\n        this.geodata[path] = geodata;\n    }\n    \n    return geodata;\n};\n\n\n// Textures ---------------------------------\n\nMapResourceNode.prototype.getTexture = function(path, type, extraBound, extraInfo, tile, internal) {\n    var texture;\n    if (extraInfo && (extraInfo.layer || extraInfo.hmap)) {\n        var id = path + (extraInfo.hmap ? '' : extraInfo.layer.id);\n        texture = this.textures[id];\n        \n        if (!texture) {\n            texture = new MapTexture(this.map, path, type, extraBound, extraInfo, tile, internal);\n            this.textures[id] = texture;\n        }\n    } else {\n        texture = this.textures[path];\n        \n        if (!texture) {\n            texture = new MapTexture(this.map, path, type, extraBound, extraInfo, tile, internal);\n            this.textures[path] = texture;\n        }\n    }\n    \n    return texture;\n};\n\n\n// SubTextures ---------------------------------\n\nMapResourceNode.prototype.getSubtexture = function(texture, path, type, extraBound, extraInfo, tile, internal) {\n    texture = this.subtextures[path];\n    \n    if (!texture) {\n        texture = new MapSubtexture(this.map, path, type, extraBound, extraInfo, tile, internal);\n        this.subtextures[path] = texture;\n    }\n    \n    return texture;\n};\n\n\n// Metatiles ---------------------------------\n\nMapResourceNode.prototype.addMetatile = function(path, metatile) {\n    this.metatiles[path] = metatile;\n};\n\n\nMapResourceNode.prototype.removeMetatile = function(metatile) {\n    for (var key in this.metatiles) {\n        if (this.metatiles[key] == metatile) {\n            delete this.metatiles[key];\n        }\n    }\n};\n\n\nMapResourceNode.prototype.getMetatile = function(surface, allowCreation, tile) {\n    var metatiles = this.metatiles, metatile; \n    for (var key in metatiles) {\n        if (metatiles[key].surface == surface) {\n            return metatiles[key];\n        } \n    }\n    \n    var path = surface.getMetaUrl(this.id);\n\n    if (metatiles[path]) {\n        metatile = metatiles[path].clone(surface);\n        this.addMetatile(path, metatile);\n        return metatile;\n    }\n\n    if (allowCreation) {\n        metatile = new MapMetatile(this, surface, tile);\n        this.addMetatile(path, metatile);\n        return metatile; \n    } else {\n        return null;\n    }\n};\n\n\nexport default MapResourceNode;\n\n\n","\nimport MapResourceNode_ from './resource-node';\n\n//get rid of compiler mess\nvar MapResourceNode = MapResourceNode_;\n\n\nvar MapResourceTree = function(map) {\n    this.map = map;\n    this.tree = new MapResourceNode(map, null, [0,0,0]); \n};\n\n\nMapResourceTree.prototype.kill = function() {\n    this.tree.kill();\n};\n\n\nMapResourceTree.prototype.findNode = function(id, createNonexisted) {\n    var node = this.tree; //TODO: fix is it same way as findNavTile\n\n    //console.log(\"--------------findNode: \" + JSON.stringify(id));\n\n//    for (var lod = 1; lod <= id[0]; lod++) {\n    for (var lod = id[0]; lod > 0; lod--) {\n        var mask = 1 << (lod-1);\n        var index = 0;\n\n        if ((id[1] & mask) != 0) {\n            index += 1;\n        }\n\n        if ((id[2] & mask) != 0) {\n            index += 2;\n        }\n        \n        if (!node.children[index]) {\n            if (createNonexisted) {\n                node.addChild(index);\n                //console.log(\"addNode: \" + JSON.stringify(node.children[index].id));\n            } else {\n                return null;\n            }\n        } \n\n        node = node.children[index];\n    }\n    \n    return node;\n};\n\n\nMapResourceTree.prototype.findAgregatedNode = function(id, agregation, createNonexisted) {\n    //var rootLod = 0;  //TODO: fix is it same way as findNavTile\n    var node = this.tree;\n    var ix = ((id[1] >> agregation) << agregation);\n    var iy = ((id[2] >> agregation) << agregation);\n\n\n//    for (var lod = id[0]; lod > rootLod; lod--) {\n//        var i = lod - rootLod;\n//        var index = 0;\n//        var mask = 1 << (i-1);\n\n    for (var lod = id[0]; lod > 0; lod--) {\n        var mask = 1 << (lod-1);\n        var index = 0;\n\n        if ((ix & mask) != 0) {\n            index += 1;\n        }\n\n        if ((iy & mask) != 0) {\n            index += 2;\n        }\n\n        if (!node.children[index]) {\n            if (createNonexisted) {\n                node.addChild(index);\n            } else {\n                return null;\n            }\n        } \n\n        node = node.children[index];\n    }\n\n    return node;\n};\n\n\nexport default MapResourceTree;\n\n\n","\nimport MapTexture_ from './texture';\nimport {math as math_} from '../utils/math';\nimport GeographicLib_ from 'geographiclib';\n\n//get rid of compiler mess\nvar MapTexture = MapTexture_;\nvar math = math_;\nvar GeographicLib = GeographicLib_;\n\n\nvar MapSrs = function(map, id, json) {\n    this.map = map;\n    this.id = id;\n    this.proj4 = map.proj4;\n    this.comment = json['comment'] || null;\n    this.srsDef = json['srsDef'] || null;\n    this.srsModifiers = json['srsModifiers'] || [];\n    this.type = json['type'] || 'projected';\n    this.vdatum = json['vdatum'] || 'orthometric';\n    //this.srsDefEllps = json[\"srsDefEllps\"] || \"\";\n    this.srsDef = json['srsDefEllps'] || this.srsDef;\n    this.periodicity = this.parsePeriodicity(json['periodicity']);\n    this.srsInfo = this.proj4(this.srsDef).info();\n    this.geoidGrid = null;\n    this.geoidGridMap = null;\n    this.srsProj4 = this.proj4(this.srsDef, null, null, true); \n    this.latlonProj4 = null; \n    this.proj4Cache = {};\n\n    if (json['geoidGrid']) {\n        var geoidGridData = json['geoidGrid'];\n\n        this.geoidGrid = {\n            definition : geoidGridData['definition'] || null,\n            srsDefEllps : geoidGridData['srsDefEllps'] || null,\n            valueRange : geoidGridData['valueRange'] || [0,1]\n        };\n\n        if (geoidGridData['extents']) {\n            this.geoidGrid.extents = {\n                ll : geoidGridData['extents']['ll'],\n                ur : geoidGridData['extents']['ur']\n            };\n        } else {\n            this.geoidGrid.extents = {\n                ll : [0,0],\n                ur : [1,1]\n            };\n        }\n\n        if (this.geoidGrid.definition) {\n            var url = this.map.url.makeUrl(this.geoidGrid.definition, {}, null);\n            this.geoidGridMap = new MapTexture(this.map, url, true);\n        }\n        \n        if (this.geoidGrid.srsDefEllps) {\n            this.geoidGrid.srsProj4 = this.proj4(this.geoidGrid.srsDefEllps, null, null, true);        \n        }\n    }\n\n    if (this.type == 'geographic') {\n        this.spheroid = json['spheroid'] || null;\n\n        if (this.spheroid == null) {\n            //TODO: return error\n        }\n    }\n};\n\n\nMapSrs.prototype.parsePeriodicity = function(periodicityData) {\n    if (periodicityData == null) {\n        return null;\n    }\n\n    var periodicity = {\n        'type' : periodicityData['type'] || '',\n        'period' : periodicityData['period'] || 0\n    };\n\n    return periodicity;\n};\n\n\nMapSrs.prototype.getInfo = function() {\n    return {\n        'comment' : this.comment,\n        'srsDef' : this.srsDef,\n        'srsModifiers' : this.srsModifiers,\n        'type' : this.type,\n        'vdatum' : this.vdatum,\n        'srsDefEllps' : this.srsDef,\n        'a' : this.srsInfo['a'],\n        'b' : this.srsInfo['b']\n    };\n};\n\n\nMapSrs.prototype.getSrsInfo = function() {\n    return this.srsInfo;\n};\n\n\nMapSrs.prototype.isReady = function() {\n    return this.isGeoidGridReady();\n};\n\n\nMapSrs.prototype.isGeoidGridReady = function() {\n    return (this.geoidGrid == null ||\n           (this.geoidGridMap != null && this.geoidGridMap.isReady()));\n};\n\n\nMapSrs.prototype.isProjected = function() {\n    return (this.type == 'projected');\n};\n\n\nMapSrs.prototype.getOriginalHeight = function(coords) {\n    var height = coords[2] || 0;\n    height /= this.getVerticalAdjustmentFactor(coords);\n    height += this.getGeoidGridDelta(coords);\n    return height;\n};\n\n\nMapSrs.prototype.getFinalHeight = function(coords) {\n    var height = coords[2] || 0;\n    height -= this.getGeoidGridDelta(coords);\n    height *= this.getVerticalAdjustmentFactor(coords);\n    return height;\n};\n\n\nMapSrs.prototype.getGeoidGridDelta = function(coords) {\n    if (this.geoidGridMap != null && this.isGeoidGridReady()) {\n        //get cooords in geoidGrid space\n        var mapCoords = this.proj4(this.srsProj4, this.geoidGrid.srsProj4, [coords[0], coords[1]]);\n\n        //get image coords\n        var px = mapCoords[0] - this.geoidGrid.extents.ll[0];\n        var py = this.geoidGrid.extents.ur[1] - mapCoords[1];\n\n        var imageExtens = this.geoidGridMap.getImageExtents();\n\n        px *= imageExtens[0] / (this.geoidGrid.extents.ur[0] - this.geoidGrid.extents.ll[0]);\n        py *= imageExtens[1] / (this.geoidGrid.extents.ur[1] - this.geoidGrid.extents.ll[1]);\n\n        px = math.clamp(px, 0, imageExtens[0] - 2);\n        py = math.clamp(py, 0, imageExtens[1] - 2);\n\n        //get bilineary interpolated value from image\n        var ix = Math.floor(px);\n        var iy = Math.floor(py);\n        var fx = px - ix;\n        var fy = py - iy;\n\n        var data = this.geoidGridMap.getImageData();\n        var index = iy * imageExtens[0];\n        var index2 = index + imageExtens[0];\n        var h00 = data[(index + ix)*4];\n        var h01 = data[(index + ix + 1)*4];\n        var h10 = data[(index2 + ix)*4];\n        var h11 = data[(index2 + ix + 1)*4];\n        var w0 = (h00 + (h01 - h00)*fx);\n        var w1 = (h10 + (h11 - h10)*fx);\n        var delta = (w0 + (w1 - w0)*fy);\n\n        //strech deta into value range\n        delta = this.geoidGrid.valueRange[0] + (delta * ((this.geoidGrid.valueRange[1] - this.geoidGrid.valueRange[0]) / 255));\n\n        return delta;\n    }\n\n    return 0;\n};\n\n\nMapSrs.prototype.getVerticalAdjustmentFactor = function(coords) {\n    if (this.srsModifiers.indexOf('adjustVertical') != -1) {\n        var info = this.getSrsInfo();\n\n        //convert coords to latlon\n        var latlonProj = '+proj=longlat ' +\n                          ' +alpha=0' +\n                          ' +gamma=0 +a=' + info['a'] +\n                          ' +b=' + info['b'] +\n                          ' +x0=0 +y0=0';\n\n        if (!this.latlonProj4) {\n            this.latlonProj4 = this.proj4(latlonProj, null, null, true); \n        }\n\n        var coords2 = this.proj4(this.srsProj4, this.latlonProj4, [coords[0], coords[1]]);\n\n        //move coors 1000m\n        var geod = new GeographicLib.Geodesic.Geodesic(info['a'],\n                                                       (info['a'] / info['b']) - 1.0);\n\n\n        var r = geod.Direct(coords2[1], coords2[0], 90, 1000);\n        coords2 = [r.lon2, r.lat2];\n\n        //convet coords from latlon back to projected\n        coords2 = this.proj4(this.latlonProj4, this.srsProj4, coords2);\n\n        //get distance between coords\n        var dx = coords2[0] - coords[0];\n        var dy = coords2[1] - coords[1];\n\n        var distance = Math.sqrt(dx * dx + dy* dy);\n\n        //get factor\n        var factor = distance / 1000;\n\n        return factor;\n    }\n\n    return 1.0;\n};\n\n\nMapSrs.prototype.convertCoordsTo = function(coords, srs, skipVerticalAdjust) {\n    this.isReady();\n    if (typeof srs !== 'string') {\n        if (srs.id == this.id) {\n            return coords.slice();\n        }\n\n        srs.isReady();\n    }\n\n    coords = coords.slice();\n\n    var stringSrs = (typeof srs === 'string');\n\n    //if (!skipVerticalAdjust && stringSrs) {\n    coords[2] = this.getOriginalHeight(coords);\n    //}\n\n    var srsDef = (stringSrs) ? srs : srs.srsProj4;\n\n    /*\n    if (srsDef.isGeocent && this.srsProj4.projName == \"merc\") {\n        var coords3 = coords.slice();\n        this.convertMercToWGS(coords3);\n        this.convertWGSToGeocent(coords3, srsDef);\n        return coords3;\n    }*/\n\n\n    var srsDef2 = (stringSrs) ? srs : srs.srsDef;\n    //var coords2 = this.proj4(this.srsProj4, srsDef, coords);\n\n    var proj = this.proj4Cache[srsDef2];\n    \n    if (!proj) {\n        proj = this.proj4(this.srsProj4, srsDef);\n        this.proj4Cache[srsDef2] = proj;\n    }\n\n    var coords2 = proj.forward(coords);\n\n    if (!skipVerticalAdjust && !stringSrs) {\n        coords2[2] = srs.getFinalHeight(coords2);\n    }\n\n    return coords2;\n};\n\n\nMapSrs.prototype.convertCoordsToFast = function(coords, srs, skipVerticalAdjust, coords2, index, index2) {\n\n    //if (!skipVerticalAdjust && stringSrs) {\n        //coords[2] = this.getOriginalHeight(coords);\n    //}\n\n    var srsDef = srs.srsProj4;\n    \n    /*\n    if (srsDef.isGeocent && this.srsProj4.projName == \"merc\") {\n        this.convertMercToWGS(coords, coords2, index, index2);\n        this.convertWGSToGeocent(coords2, srsDef, coords2, index2, index2);\n        return;\n    }*/\n\n    var srsDef2 = srs.srsDef;\n\n    var proj = this.proj4Cache[srsDef2];\n    \n    if (!proj) {\n        proj = this.proj4(this.srsProj4, srsDef);\n        this.proj4Cache[srsDef2] = proj;\n    }\n\n    var coords3 = proj.forward(coords);\n    \n    coords2[index2] = coords3[0];\n    coords2[index2+1] = coords3[1];\n    coords2[index2+2] = coords3[2];\n    \n\n    //if (!skipVerticalAdjust && stringSrs) {\n        //coords2[2] = srs.getFinalHeight(coords2);\n    //}\n    \n    if (srs.geoidGrid) {\n        coords2[index2+2] -= srs.getGeoidGridDelta(coords);\n    }\n};\n\n\nMapSrs.prototype.convertCoordsFrom = function(coords, srs) {\n    this.isReady();\n    if (typeof srs !== 'string') {\n        if (srs.id == this.id) {\n            return coords.slice();\n        }\n\n        srs.isReady();\n    }\n\n    coords = coords.slice();\n\n    if (typeof srs !== 'string') {\n        coords[2] = srs.getOriginalHeight(coords);\n    }\n\n    var srsDef = (typeof srs === 'string') ? srs : srs.srsProj4;\n    var srsDef2 = (typeof srs === 'string') ? srs : srs.srsDef;\n\n    //var coords2 = this.proj4(srsDef, this.srsProj4, coords);\n\n    var proj = this.proj4Cache[srsDef2];\n    \n    if (!proj) {\n        proj = this.proj4(this.srsProj4, srsDef);\n        this.proj4Cache[srsDef2] = proj;\n    }\n\n    var coords2 = proj.inverse(coords);\n\n    coords2[2] = this.getFinalHeight(coords2);\n\n    return coords2;\n};\n\n\nMapSrs.prototype.phi2z = function(eccent, ts) {\n    var HALFPI = Math.PI*0.5;\n    var eccnth = 0.5 * eccent;\n    var con, dphi;\n    var phi = HALFPI - 2 * Math.atan(ts);\n    for (var i = 0; i <= 15; i++) {\n        con = eccent * Math.sin(phi);\n        dphi = HALFPI - 2 * Math.atan(ts * (Math.pow(((1 - con) / (1 + con)), eccnth))) - phi;\n        phi += dphi;\n        if (Math.abs(dphi) <= 0.0000000001) {\n            return phi;\n        }\n    }\n  //console.log(\"phi2z has NoConvergence\");\n    return -9999;\n};\n\n\nMapSrs.prototype.convertMercToWGS = function(coords, coords2, index, index2) {\n    var TWOPI = Math.PI * 2;\n    var HALFPI = Math.PI*0.5;\n    var proj = this.srsProj4;\n    var x = coords[index] - proj.x0;\n    var y = coords[index+1] - proj.y0;\n\n    if (proj.sphere) {\n        coords2[index2+1] = HALFPI - 2 * Math.atan(Math.exp(-y / (proj.a * proj.k0)));\n    } else {\n        var ts = Math.exp(-y / (proj.a * proj.k0));\n        var yy = this.phi2z(proj.e, ts);\n        coords2[index2+1] = yy;\n        if (yy === -9999) {\n            return;\n        }\n    }\n    \n    //coords[0] = adjustlon(proj.long0 + x / (proj.a * proj.k0));\n    x = proj.long0 + x / (proj.a * proj.k0);\n    var SPI = 3.14159265359;\n    coords2[index2] = (Math.abs(x) <= SPI) ? x : (x - ((x < 0) ? -1 : 1) * TWOPI);\n    coords2[index2+2] = coords[index+2];\n};\n\n\nMapSrs.prototype.convertWGSToGeocent = function(coords, srs, coords2, index, index2) {\n    var datum = srs.datum;\n\n    var HALFPI = Math.PI*0.5;\n    var Longitude = coords[index];\n    var Latitude = coords[index+1];\n    var Height = coords[index+2]; //Z value not always supplied\n\n    var Rn; /*  Earth radius at location  */\n    var SinLat; /*  Math.sin(Latitude)  */\n    var Sin2Lat; /*  Square of Math.sin(Latitude)  */\n    var CosLat; /*  Math.cos(Latitude)  */\n\n    /*\n     ** Don't blow up if Latitude is just a little out of the value\n     ** range as it may just be a rounding issue.  Also removed longitude\n     ** test, it should be wrapped by Math.cos() and Math.sin().  NFW for PROJ.4, Sep/2001.\n     */\n    if (Latitude < -HALFPI && Latitude > -1.001 * HALFPI) {\n        Latitude = -HALFPI;\n    }\n    else if (Latitude > HALFPI && Latitude < 1.001 * HALFPI) {\n        Latitude = HALFPI;\n    }\n    else if ((Latitude < -HALFPI) || (Latitude > HALFPI)) {\n      /* Latitude out of range */\n      //..reportError('geocent:lat out of range:' + Latitude);\n        return null;\n    }\n\n    if (Longitude > Math.PI) {\n        Longitude -= (2 * Math.PI);\n    }\n\n    SinLat = Math.sin(Latitude);\n    CosLat = Math.cos(Latitude);\n    Sin2Lat = SinLat * SinLat;\n    Rn = datum.a / (Math.sqrt(1.0e0 - datum.es * Sin2Lat));\n    coords2[index2] = (Rn + Height) * CosLat * Math.cos(Longitude);\n    coords2[index2+1] = (Rn + Height) * CosLat * Math.sin(Longitude);\n    coords2[index2+2] = ((Rn * (1 - datum.es)) + Height) * SinLat;\n};\n\n\nexport default MapSrs;\n\n","\n\nvar MapCache = function(map, maxCost) {\n    this.map = map;\n    this.maxCost = (maxCost != null) ? maxCost : Number.MAX_VALUE;\n    this.skipCostCheck = false;\n    this.last = null;\n    this.first = null;\n\n    this.totalCost = 0;\n    this.totalItems = 0;\n};\n\n\nMapCache.prototype.updateItem = function(item) {\n    if (item == null) {\n        return;\n    }\n\n    if (this.first == item) {\n        return;\n    }\n\n    //remove item from list\n    if (item.prev != null) {\n        item.prev.next = item.next;\n    }\n\n    if (item.next != null) {\n        item.next.prev = item.prev;\n    }\n\n    if (this.last == item) {\n        this.last = item.prev;\n    }\n\n    var first = this.first;\n\n    //add item as first\n    this.first = item;\n    this.first.next = first;\n    this.first.prev = null;\n\n    first.prev = this.first;\n};\n\n\nMapCache.prototype.getMaxCost = function() {\n    return this.maxCost;\n};\n\n\nMapCache.prototype.setMaxCost = function(cost) {\n    this.maxCost = cost;\n    this.checkCost();\n};\n\n\nMapCache.prototype.clear = function() {\n    var item = this.first;\n\n    while (item != null) {\n        if (item.destructor != null) {\n            item.destructor();\n        }\n        item = item.next;\n    }\n\n    this.last = null;\n    this.first = null;\n\n    this.totalCost = 0;\n    this.totalItems = 0;\n};\n\n\nMapCache.prototype.insert = function(destructor, cost) {\n    this.totalItems++;\n\n    //console.log(\"insert: \" + hash + \" items: \" + this.totalItems);\n\n    var item = { destructor:destructor, cost:cost, prev: null, next:this.first };\n\n    if (this.first != null) {\n        this.first.prev = item;\n    }\n\n    //add item as first in list\n    this.first = item;\n\n    if (this.last == null) {\n        this.last = item;\n    }\n\n    this.totalCost += cost;\n\n    //console.log(\"MapCache.prototype.insert:\" + this.totalCost + \" / \" + this.maxCost);\n\n    this.checkCost();\n\n    return item;\n};\n\n\nMapCache.prototype.remove = function(item) {\n    this.totalItems++;\n    var hit = false;\n\n    if (item == this.first) {\n        this.first = item.next;\n        hit = true;\n\n        if (this.first != null) {\n            this.first.prev = null;\n        }\n    }\n\n    if (item == this.last) {\n        this.last = item.prev;\n        hit = true;\n\n        if (this.last != null) {\n            this.last.next = null;\n        }\n    }\n\n    if (!hit) {\n    //if (item != this.last && item != this.first) {\n\n        if (!item.prev) {\n            //debugger;\n        } else {\n            item.prev.next = item.next;\n        }\n        \n        if (!item.next) {\n            //debugger;\n        } else {\n            item.next.prev = item.prev;\n        }\n        \n    }\n\n    this.totalCost -= item.cost;\n\n    //destroy item\n    item.destructor();\n\n    //console.log(\"MapCache.prototype.remove:\" + this.totalCost + \" / \" + this.maxCost);\n\n    this.checkCost();\n};\n\n\nMapCache.prototype.checkCost = function() {\n    if (this.skipCostCheck) {\n        return;\n    }\n\n    while (this.totalCost > this.maxCost) {\n\n        this.totalItems--;\n\n        //console.log(\"remove: \" + this.last.hash + \" prev: \" + this.last.prev + \" items: \" + this.totalItems);\n\n        var last = this.last;\n\n        if (last != null) {\n            //set new last\n            this.last = this.last.prev;\n\n            if (this.last != null) {\n                this.last.next = null;\n            }\n\n            this.totalCost -= last.cost;\n\n            //destroy item\n            last.destructor();\n\n        } else {\n            break;\n        }\n    }\n};\n\n\nMapCache.prototype.addItem = function(cost, destructor) {\n    return this.insert(destructor, cost);\n};\n\n\nMapCache.prototype.removeItem = function(item) {\n    return this.remove(item);\n};\n\n\nMapCache.prototype.itemUsed = function(item) {\n    return this.updateItem(item);\n};\n\n/*\nMapCache.prototype[\"addItem\"] = MapCache.prototype.addItem;\nMapCache.prototype[\"removeItem\"] = MapCache.prototype.removeItem;\nMapCache.prototype[\"itemUsed\"] = MapCache.prototype.itemUsed;\n*/\n\nexport default MapCache;","\nimport {vec3 as vec3_} from '../utils/matrix';\nimport {math as math_} from '../utils/math';\n\n//get rid of compiler mess\nvar vec3 = vec3_;\nvar math = math_;\n\n\nvar MapCamera = function(map) {\n    this.map = map;\n    this.camera = map.renderer.camera;\n    this.distance = 10;\n    this.distance2 = 10;\n    this.position = [0,0,0];\n    this.vector = [0,0,1];\n    this.vector2 = [0,0,1,1];\n    this.center = [0,0,0];\n    this.height = 0;\n    this.terrainHeight = 0;\n    this.lastTerrainHeight = 0;\n    this.near = 2;\n};\n\n\nMapCamera.prototype.update = function() {\n    var map = this.map;\n\n    //check position orientaion ...\n    map.position.check();\n\n    //var height = 227;\n    var height = map.position.getHeight();\n\n    var lod =  map.measure.getOptimalHeightLod(map.position.getCoords(), map.position.getViewExtent(), map.config.mapNavSamplesPerViewExtent);\n    //var surfaceHeight = [226,true,true]; //map.getSurfaceHeight(map.position.getCoords(), lod, true);\n    var surfaceHeight = map.measure.getSurfaceHeight(map.position.getCoords(), lod, true);\n    \n    map.stats.heightTerrain = surfaceHeight[0];\n    map.stats.heightDelta = height;\n\n    //console.log(\"terrain height:\" + surfaceHeight[0] + \"  pos height:\" + map.position.getHeight());\n\n    if (map.position.getHeightMode() == 'float') {\n        height += surfaceHeight[0];\n    }\n\n    if (map.renderer.useSuperElevation) {\n        height = map.renderer.getSuperElevatedHeight(height);\n    }\n\n    var camInfo = map.measure.getPositionCameraInfo(map.position, map.getNavigationSrs().isProjected());\n\n    this.camera.setPosition(camInfo.orbitCoords);\n    this.camera.setRotationMatrix(camInfo.rotMatrix);\n    this.vector = camInfo.vector;\n    this.vector2 = camInfo.vector2;\n    this.position = camInfo.orbitCoords;\n    this.height = camInfo.orbitHeight + height;\n    this.terrainHeight = this.height - surfaceHeight[0];\n\n    //console.log(''+this.height + ' ' + this.terrainHeight + ' ' + surfaceHeight[0]);\n\n    //get camera distance\n    this.distance2 = map.position.getViewDistance();\n    this.distance = Math.max(this.terrainHeight, this.distance2);\n    this.distance = math.clamp(this.distance, 0.1, this.camera.getFar());\n\n    this.distanceFactor = Math.tan(math.radians(map.position.getFov()*0.5)); \n\n    this.perceivedDistance = Math.max(this.terrainHeight, this.distance2 * this.distanceFactor);\n    \n    //this.renderer.cameraDistance = camInfo.distance; //needed for fog\n    map.renderer.cameraDistance = this.distance; //needed for fog\n    map.renderer.viewExtent = map.position.getViewExtent();\n\n    this.camera.setViewHeight(map.position.getViewExtent());\n    //this.camera.setOrtho(true);\n\n    //convert nav coords to physical\n    var coords = map.position.getCoords();\n    var worldPos = map.convert.convertCoords([coords[0], coords[1], height], 'navigation', 'physical');\n    this.center = [worldPos[0], worldPos[1], worldPos[2]];\n    worldPos[0] += camInfo.orbitCoords[0];\n    worldPos[1] += camInfo.orbitCoords[1];\n    worldPos[2] += camInfo.orbitCoords[2];\n    this.camera.setPosition([0,0,0]); //always zeros\n    this.position = worldPos;\n\n    this.vector2 = [-worldPos[0], -worldPos[1], -worldPos[2], 1];\n    vec3.normalize(this.vector2);\n\n    this.mapIsProjected = map.getNavigationSrs().isProjected();\n\n    if (!this.mapIsProjected) { //HACK!!!!!!!!\n        this.geocentDistance = vec3.length(this.position);\n\n        var n = [0,0,0];\n        vec3.normalize(this.position, n);\n        this.geocentNormal = n;\n    } else {\n        this.vector2[3] = 0;\n    }\n    \n    //console.log(\"word-pos: \" + JSON.stringify(worldPos));\n\n    //set near and far of camera by distance of orbit\n    var factor = Math.max(this.height, this.distance) / 600000;\n\n    var near = Math.max(this.near, this.near * (factor * 20));\n    factor = Math.max(1.0, factor);\n    var far = 600000 * (factor * 10);\n\n    //console.log(\"near: \" + near + \"  far: \" + far);\n\n    this.camera.setParams(map.position.getFov()*0.5, near, far * 2.0);\n    \n    return camInfo;\n};\n\n\nMapCamera.prototype.getCameraHeight = function() {\n    //TODO: get camera height\n    //var cameraPos = this.camera.position;\n    //return (this.camera.getPosition()[2] - this.planet.surfaceHeight([this.position[0] + cameraPos[0], this.position[1] + cameraPos[1]])[0]);\n\n    //hack - distance intead of height\n    //return this.cameraDistance;\n    return this.cameraHeight;\n};\n\n\nMapCamera.prototype.getMvpMatrix = function() {\n    return this.camera.getMvpMatrix();\n};\n\n\nMapCamera.prototype.getRotationMatrix = function() {\n    return this.camera.getRotationMatrix();\n};\n\n\nMapCamera.prototype.getRotationviewMatrix = function() {\n    return this.camera.getRotationviewMatrix();\n};\n\n\nMapCamera.prototype.getFar = function() {\n    return this.camera.getFar();\n};\n\n\nMapCamera.prototype.getFov = function() {\n    return this.camera.getFov();\n};\n\n\nMapCamera.prototype.getAspect = function() {\n    return this.camera.getAspect();\n};\n\n\nexport default MapCamera;\n\n\n","\nimport {utils as utils_} from '../utils/utils';\n\n//get rid of compiler mess\nvar utils = utils_;\n\nvar MapCredit = function(map, json) {\n    this.map = map;\n    this.id = json['id'] || null;\n    this.notice = json['notice'] || null;\n    this.copyrighted = json['copyrighted'] || true;\n    this.url = json['url'] || null;\n    this.html = utils.simpleWikiLinks(this.notice);\n    this.plain = utils.simpleWikiLinks(this.notice);\n};\n\n\nMapCredit.prototype.getInfo = function() {\n    return {\n        'id' : this.id,\n        'notice' : this.notice,\n        //\"copyrighted\" : this.copyrighted,\n        //\"url\" : this.url\n        'html' : this.html,\n        'plain' : this.plain\n    };\n};\n\n\nexport default MapCredit;\n\n","\nimport MapCredit_ from './credit';\nimport {utils as utils_} from '../utils/utils';\nimport {utilsUrl as utilsUrl_} from '../utils/url';\n\n//get rid of compiler mess\nvar utils = utils_;\nvar utilsUrl = utilsUrl_;\nvar MapCredit = MapCredit_;\n\n\nvar MapBoundLayer = function(map, json, id) {\n    this.map = map;\n    this.id = id;\n    this.currentAlpha = 1.0;\n\n    this.tileSize = [256,256];\n    this.lodRange = [0,100];\n    this.credits = [];\n    this.tileRange = [[0,0],[0,0]];\n    this.jsonUrl = null;\n    this.baseUrl = this.map.url.baseUrl;\n    this.baseUrlSchema = this.map.url.baseUrlSchema;\n    this.baseUrlOrigin = this.map.url.baseUrlOrigin;\n    this.ready = false;\n    this.dataType = VTS_TEXTURETYPE_COLOR;\n    this.shaderFilters = null;\n\n    //hack\n    if (id == 'esri-world-imagery') {\n        json['availability'] = {\n             // \"type\" : \"negative-type\",\n             // \"mime\": \"image/png\"\n             // \"type\" : \"negative-code\",\n             // \"codes\": [301, 302, 404]\n            'type' : 'negative-size',\n            'size': 2521\n        };  \n    }\n    \n    if (typeof json === 'string') {\n        this.jsonUrl = this.map.url.processUrl(json);\n        this.baseUrl = utilsUrl.getBase(this.jsonUrl);\n        this.baseUrlSchema = utilsUrl.getSchema(this.jsonUrl);\n        this.baseUrlOrigin = utilsUrl.getOrigin(this.jsonUrl);\n        \n        var onLoaded = (function(data){\n            this.parseJson(data);            \n            this.ready = true;\n            this.map.refreshView();\n        }).bind(this);\n        \n        var onError = (function(){ }).bind(this);\n\n        utils.loadJSON(this.jsonUrl, onLoaded, onError, null, (utils.useCredentials ? (this.jsonUrl.indexOf(this.map.url.baseUrl) != -1) : false), this.map.core.xhrParams);\n        //utils.loadJSON(this.url, onLoaded, onError, null, utils.useCredentials);\n    } else {\n        this.parseJson(json);\n        this.ready = true;\n    }\n    \n};\n\n\nMapBoundLayer.prototype.parseJson = function(json) {\n    this.numberId = json['id'] || null;\n    this.type = json['type'] || 'raster';\n    this.url = this.processUrl(json['url'], '');\n    this.tileSize = json['tileSize'] || [256,256];\n    this.lodRange = json['lodRange'] || [0,0];\n    this.tileRange = json['tileRange'] || [[0,0],[0,0]];\n    this.metaUrl = this.processUrl(json['metaUrl']);\n    this.maskUrl = this.processUrl(json['maskUrl']);\n    this.isTransparent = json['isTransparent'] || false;\n    this.options = json['options'] || {};\n    this.credits = json['credits'] || [];\n    this.creditsUrl = null;\n\n    this.shaderFilter = this.options['shaderFilter'] || null;\n\n    switch(json['dataType']) {\n        default:\n        case 'color':          this.dataType = VTS_TEXTURETYPE_COLOR;  break;\n        case 'height':         this.dataType = VTS_TEXTURETYPE_HEIGHT; break;\n        case 'classification': this.dataType = VTS_TEXTURETYPE_CLASS;  break;\n    }\n\n    this.specificity = Math.pow(2,this.lodRange[0]) / ((this.tileRange[1][0] - this.tileRange[1][0]+1)*(this.tileRange[1][1] - this.tileRange[1][1]+1));    \n\n    this.availability = json['availability'] ? {} : null;\n\n    if (this.availability) {\n        var p = json['availability'];\n\n        switch(p['type']) {\n            case 'negative-type': this.availability.type = VTS_TEXTURECHECK_TYPE; break;\n            case 'negative-code': this.availability.type = VTS_TEXTURECHECK_CODE; break;\n            case 'negative-size': this.availability.type = VTS_TEXTURECHECK_SIZE; break;\n        }\n\n        this.availability.mime = p['mime'];\n        this.availability.codes = p['codes'];\n        this.availability.size = p['size'];\n        //this.availability.coverageUrl = p[\"coverageUrl\"];\n    }\n\n    if (this.metaUrl && this.maskUrl) {\n        this.availability = {\n            type : VTS_TEXTURECHECK_MEATATILE\n        };\n    }\n\n    switch(typeof this.credits) {\n    case 'string':\n        this.creditsUrl = this.credits;\n        this.credits = [];\n        break;\n\n    case 'object':\n        \n        if (!Array.isArray(this.credits)) {\n            var credits = this.credits;\n            this.credits = [];\n                \n            for (var key in credits){\n                this.map.addCredit(key, new MapCredit(this.map, credits[key]));\n                this.credits.push(key);\n            }\n        }\n\n        /*\n        for (var i = 0, li = this.credits.length; i < li; i++) {\n            var credit = this.map.getCreditById(this.credits[i]);\n                //this.creditsNumbers.push(credit ? credit.id : null); \n        }*/\n        \n        break;\n    }\n};\n\n\nMapBoundLayer.prototype.kill = function() {\n};\n\n\nMapBoundLayer.prototype.setOptions = function() {\n};\n\n\nMapBoundLayer.prototype.getOptions = function() {\n    return this.getInfo();\n};\n\n\nMapBoundLayer.prototype.getInfo = function() {\n    return {\n        'type' : this.type,\n        'url' : this.url,\n        'tileSize' : this.tileSize,\n        'credits' : this.credits,\n        'lodRange' : this.lodRange,\n        'tileRange' : this.tileRange,\n        'mataUrl' : this.metaUrl,\n        'maskUrl' : this.maskUrl,\n        'isTransparent' : this.isTransparent\n    };\n};\n\n\nMapBoundLayer.prototype.processUrl = function(url, fallback) {\n    if (!url) {\n        return fallback;\n    }\n\n    url = url.trim();\n    \n    if (url.indexOf('://') != -1) { //absolute\n        return url;\n    } else if (url.indexOf('//') == 0) {  //absolute without schema\n        return this.baseUrlSchema + url;\n    } else if (url.indexOf('/') == 0) {  //absolute without host\n        return this.baseUrlOrigin + url;\n    } else {  //relative\n        return this.baseUrl + url; \n    }\n};\n\n\nMapBoundLayer.prototype.hasTile = function(id) {\n    var shift = id[0] - this.lodRange[0];\n\n    if (shift < 0) {\n        return false;\n    }\n\n    var x = id[1] >> shift;\n    var y = id[2] >> shift;\n\n    if (id[0] < this.lodRange[0] || id[0] > this.lodRange[1] ||\n        x < this.tileRange[0][0] || x > this.tileRange[1][0] ||\n        y < this.tileRange[0][1] || y > this.tileRange[1][1] ) {\n        return false;\n    }\n\n    return true;\n};\n\n\nMapBoundLayer.prototype.hasTileOrInfluence = function(id) {\n    var shift = id[0] - this.lodRange[0];\n\n    if (shift < 0) {\n        return false;\n    }\n\n    var x = id[1] >> shift;\n    var y = id[2] >> shift;\n\n    if (x < this.tileRange[0][0] || x > this.tileRange[1][0] ||\n        y < this.tileRange[0][1] || y > this.tileRange[1][1] ) {\n        return 0;\n    }\n\n    return (id[0] > this.lodRange[1]) ? 1 : 2;\n};\n\n\nMapBoundLayer.prototype.getUrl = function(id, skipBaseUrl) {\n    return this.map.url.makeUrl(this.url, {lod:id[0], ix:id[1], iy:id[2] }, null, skipBaseUrl);\n};\n\n\nMapBoundLayer.prototype.getMetatileUrl = function(id, skipBaseUrl) {\n    return this.map.url.makeUrl(this.metaUrl, {lod:id[0], ix:id[1], iy:id[2] }, null, skipBaseUrl);\n};\n\n\nMapBoundLayer.prototype.getMaskUrl = function(id, skipBaseUrl) {\n    return this.map.url.makeUrl(this.maskUrl, {lod:id[0], ix:id[1], iy:id[2] }, null, skipBaseUrl);\n};\n\n\nexport default MapBoundLayer;\n\n\n","\nvar MapDivisionNode = function(map, id, srs, extents, heightRange, partitioning) {\n    this.map = map;\n    this.id = id;\n    this.srs = this.map.getMapsSrs(srs);\n    this.extents = extents;\n    this.heightRange =  heightRange;\n    this.partitioning = partitioning;\n    this.isPole = (id[0] == 1 && ((id[1] == 0 && id[2] == 1)||(id[1] == 1 && id[2] == 0)));\n};\n\n\nMapDivisionNode.prototype.getInnerCoords = function (coords) {\n    return this.srs.convertCoordsFrom(coords, this.map.getNavigationSrs());\n};\n\n\nMapDivisionNode.prototype.getOuterCoords = function (coords) {\n    return this.srs.convertCoordsTo(coords, this.map.getNavigationSrs());\n};\n\n\nMapDivisionNode.prototype.getPhysicalCoords = function (coords, skipVerticalAdjust) {\n    return this.srs.convertCoordsTo(coords, this.map.getPhysicalSrs(), skipVerticalAdjust);\n};\n\n\nMapDivisionNode.prototype.getPhysicalCoordsFast = function (coords, skipVerticalAdjust, coords2, index, index2) {\n    return this.srs.convertCoordsToFast(coords, this.map.getPhysicalSrs(), skipVerticalAdjust, coords2, index, index2);\n};\n\n\nMapDivisionNode.prototype.getExtents = function (coords) {\n    return this.srs.convertCoordsFrom(coords, this.map.getNavigationSrs());\n};\n\n\nexport default MapDivisionNode;\n","\nimport MapDivisionNode_ from './division-node';\n\n//get rid of compiler mess\nvar MapDivisionNode = MapDivisionNode_;\n\n\nvar MapRefFrame = function(map, json) {\n    this.map = map;\n    this.proj4 = map.proj4;\n    this.valid = false;\n    this.id = json['id'] || null;\n    this.description = json['description'] || '';\n    this.nodesMap = [];\n\n    var model = json['model'];\n\n    if (model == null) {\n        return;\n    }\n\n    this.model = {\n        physicalSrs : map.getMapsSrs(model['physicalSrs']),\n        navigationSrs : map.getMapsSrs(model['navigationSrs']),\n        publicSrs : map.getMapsSrs(model['publicSrs'])\n    };\n\n    this.body = json['body'] ? map.getBody(json['body']) : null;\n\n    this.params = {};\n\n    if (json['parameters'] != null) {\n        var params = json['parameters'];\n        this.params.metaBinaryOrder = params['metaBinaryOrder'] || 1;\n        this.params.navDelta = params['navDelta'] || 8;\n    }\n\n    var division = json['division'];\n\n    if (division == null) {\n        return;\n    }\n\n    this.division = {\n        rootLod : division['rootLod'] || 0,\n        arity : division['arity'] || null,\n        heightRange : division['heightRange'] || [0,1]\n    };\n\n    var extents = this.parseSpaceExtents(division['extents']);\n    this.division.extents = extents;\n\n    map.spaceExtentSize = [extents.ur[0] - extents.ll[0], extents.ur[1] - extents.ll[1], extents.ur[2] - extents.ll[2]];\n    map.spaceExtentOffset = extents.ll;\n\n    var divisionNodes = division['nodes'];\n    this.division.nodes = [];\n\n    if (divisionNodes == null) {\n        return;\n    }\n\n    this.hasPoles = (divisionNodes.length == 4); \n\n    for (var i = 0, li = divisionNodes.length; i < li; i++) {\n        var node = this.parseNode(divisionNodes[i]);\n        this.nodesMap['' + node.id[0] + '.'  + node.id[1] + '.' + node.id[2]] = node;\n        this.division.nodes.push(node);\n    }\n\n    this.valid = true;\n};\n\n\nMapRefFrame.prototype.getInfo = function() {\n    return {\n        'id' : this.id,\n        'physicalSrs' : this.model.physicalSrs.id,\n        'navigationSrs' : this.model.navigationSrs.id,\n        'publicSrs' : this.model.publicSrs.id\n    };\n};\n\n\nMapRefFrame.prototype.getGlobalHeightRange = function() {\n    return this.division.heightRange;     \n};\n\n\nMapRefFrame.prototype.parseNode = function(nodeData) {\n    var node = {\n        srs : nodeData['srs'],\n        partitioning : nodeData['partitioning']\n    };\n\n    node.extents = this.parseExtents(nodeData['extents']);\n\n    var nodeId = nodeData['id'];\n\n    if (nodeId == null) {\n        return;\n    }\n\n    node.id = {\n        lod : nodeId['lod'] || 0,\n        position : nodeId['position'] || [0,0]\n    };\n\n    return new MapDivisionNode(this.map, [node.id.lod, node.id.position[0], node.id.position[1]],\n                                           node.srs, node.extents, this.heightRange, node.partitioning);\n};\n\n\nMapRefFrame.prototype.parseExtents = function(extentsData) {\n    if (extentsData == null) {\n        return { ll : [0,0], ur : [1,1] };\n    }\n\n    return {\n        ll : extentsData['ll'] || [0,0],\n        ur : extentsData['ur'] || [1,1]\n    };\n};\n\n\nMapRefFrame.prototype.parseSpaceExtents = function(extentsData) {\n    if (extentsData == null) {\n        return { ll : [0,0,0], ur : [1,1,1] };\n    }\n\n    return {\n        ll : extentsData['ll'] || [0,0,0],\n        ur : extentsData['ur'] || [1,1,1]\n    };\n};\n\n\nMapRefFrame.prototype.getSpatialDivisionNodes = function() {\n    return this.division.nodes;\n};\n\n\nMapRefFrame.prototype.convertCoords = function(coords, source, destination) {\n    var sourceSrs, destinationSrs;\n\n    switch(source) {\n    case 'public':     sourceSrs = this.model.publicSrs;     break;\n    case 'physical':   sourceSrs = this.model.physicalSrs;   break;\n    case 'navigation': sourceSrs = this.model.navigationSrs; break;\n    }\n\n    switch(destination) {\n    case 'public':     destinationSrs = this.model.publicSrs;     break;\n    case 'physical':   destinationSrs = this.model.physicalSrs;   break;\n    case 'navigation': destinationSrs = this.model.navigationSrs; break;\n    }\n\n    return sourceSrs.convertCoordsTo(coords, destinationSrs);\n};\n\n\nexport default MapRefFrame;\n\n\n","\nvar MapBody = function(map, json) {\n    //this.map = map;\n    //this.id = json[\"id\"] || null;\n    this.parse(json);\n};\n\n\nMapBody.prototype.parse = function(json) {\n    this.class = json['class'] || '';\n    this.comment = json['comment'] || '';\n    this.parent = json['parent'] || '';\n    this.atmosphere = json['atmosphere'] || null;\n\n    if (this.atmosphere) {\n        if (!this.atmosphere['colorHorizon']) this.atmosphere['colorHorizon'] = [0,0,0,0];\n        if (!this.atmosphere['colorZenith']) this.atmosphere['colorZenith'] = [0,0,0,0];\n        if (!this.atmosphere['thickness'])  this.atmosphere['thickness'] = 100000;\n        if (!this.atmosphere['visibility'])  this.atmosphere['visibility'] = 100000;\n    }\n};\n\n\nMapBody.prototype.getInfo = function() {\n    return {\n        'class' : this.class,\n        'comment' : this.comment,\n        'parent' : this.parent,\n        'atmosphere' : JSON.parse(JSON.stringify(this.atmosphere)),\n    };\n};\n\n\nexport default MapBody;","\nimport {utils as utils_} from '../utils/utils';\n\n//get rid of compiler mess\nvar utils = utils_;\n\n\nvar MapStylesheet = function(map, id, url, freeLayer) {\n    this.generateLines = true;\n    this.map = map;\n    this.renderer = this.map.renderer;\n    this.stats = map.stats;\n    this.id  = id;\n    this.url  = null;\n    this.data = null;\n    this.loadState = 0;\n    this.size = 0;\n    this.fileSize = 0;\n    this.freeLayer = freeLayer;\n    this.fonts = {};\n    this.fontsReady = false;\n    \n    if (typeof url === 'object') {\n        this.data = url;\n        this.setFonts(this.data);\n        this.loadState = 2;\n        this.map.markDirty();\n    } else {\n        if (this.freeLayer) {\n            this.url = this.freeLayer.processUrl(url, '');\n        } else {\n            this.url = this.map.url.processUrl(url);\n        }\n\n        //load style directly\n        utils.loadJSON(this.url, this.onLoaded.bind(this), this.onLoadError.bind(this), null, (utils.useCredentials ? (this.url.indexOf(this.map.url.baseUrl) != -1) : false), this.map.core.xhrParams);\n        this.loadState = 1;\n    }\n};\n\n\nMapStylesheet.prototype.kill = function() {\n};\n\n\nMapStylesheet.prototype.setData = function(data) {\n    this.data = data;\n    this.setFonts(data);\n    this.loadState = 2;\n    this.checkFonts();\n};\n\nMapStylesheet.prototype.checkFonts = function() {\n    var ready = true;\n    for (var key in this.fonts) {\n        ready = (ready && this.renderer.getFont(this.fonts[key]).isReady());\n    }\n\n    this.fontsReady = ready;\n\n    return ready;\n};\n\nMapStylesheet.prototype.isReady = function(doNotLoad, priority) {\n    if (this.loadState == 2) { //loaded\n        if (this.fontsReady) {\n            return true;\n        } else {\n            return this.checkFonts();\n        }\n\n    } else {\n        if (this.loadState == 0) { \n            if (doNotLoad) {\n                //remove from queue\n                //if (this.mapLoaderUrl) {\n                  //  this.map.loader.remove(this.mapLoaderUrl);\n                //}\n            } else {\n                //not loaded\n                //add to loading queue or top position in queue\n                this.scheduleLoad(priority);\n            }\n        } //else load in progress\n    }\n\n    return false;\n};\n\n\nMapStylesheet.prototype.scheduleLoad = function(priority) {\n    this.map.loader.load(this.url, this.onLoad.bind(this), priority);\n};\n\n\nMapStylesheet.prototype.onLoad = function() {\n    //this.mapLoaderCallLoaded = onLoaded;\n    //this.mapLoaderCallError = onError;\n\n    this.loadState = 1;\n};\n\n\nMapStylesheet.prototype.onLoadError = function() {\n    if (this.map.killed){\n        return;\n    }\n\n    //this.mapLoaderCallError();\n    //this.loadState = 2;\n};\n\nMapStylesheet.prototype.setFonts = function(data) {\n    this.fonts = data['fonts'] || {};\n    \n    if (!this.fonts['#default']) {\n        this.fonts['#default'] = this.map.core.config.mapDefaultFont;\n    }\n};\n\nMapStylesheet.prototype.onLoaded = function(data) {\n    if (this.map.killed){\n        return;\n    }\n    \n    this.data = data;\n    this.setFonts(data);\n\n    //this.mapLoaderCallLoaded();\n    this.loadState = 2;\n    this.map.markDirty();\n};\n\n\n// Returns RAM usage in bytes.\n//MapStylesheet.prototype.getSize = function () {\n  //  return this.size;\n//};\n\n//MapStylesheet.prototype.getFileSize = function () {\n  //  return this.fileSize;\n//};\n\nexport default MapStylesheet;\n\n","import MapCredit_ from './credit';\nimport MapStylesheet_ from './stylesheet';\nimport MapSurfaceTree_ from './surface-tree';\nimport BBox_ from '../renderer/bbox';\nimport {utils as utils_} from '../utils/utils';\nimport {utilsUrl as utilsUrl_} from '../utils/url';\n\n//get rid of compiler mess\nvar MapCredit = MapCredit_;\nvar MapStylesheet = MapStylesheet_;\nvar MapSurfaceTree = MapSurfaceTree_;\nvar BBox = BBox_;\nvar utils = utils_;\nvar utilsUrl = utilsUrl_;\n\n\nvar MapSurface = function(map, json, type) {\n    this.map = map;\n    this.id = null;\n    this.type = 'basic';\n    this.metaBinaryOrder = 1;\n    this.metaUrl = '';\n    this.navUrl = '';\n    this.navDelta = 1;\n    this.meshUrl = '';\n    this.textureUrl = '';\n    this.baseUrl = this.map.url.baseUrl;\n    this.baseUrlSchema = this.map.url.baseUrlSchema;\n    this.baseUrlOrigin = this.map.url.baseUrlOrigin;\n    this.lodRange = [0,0];\n    this.tileRange = [[0,0],[0,0]];\n    this.textureLayer = null;\n    this.boundLayerSequence = [];\n    this.glue = (type == 'glue');\n    this.free = (type == 'free');\n    this.virtual = false;\n    this.zFactor = 0;\n    this.ready = false;\n    this.geodataProcessor = null;\n    this.geodataCounter = 0;\n    this.geodataNavtileInfo = false;\n    this.monoGeodata = null;\n    this.monoGeodataView = null;\n    this.monoGeodataCounter = -1;\n    this.creditsNumbers = [];\n    this.surfaceCounter = map.surfaceCounter;\n    map.surfaceCounter++;\n\n    this.style = null;\n    this.stylesheet = null;\n    this.originalStyle = null;\n    this.originalStylesheet = null;\n    this.styleChanged = true;\n    \n    if (this.free) { //each free layer has its own data tree\n        this.tree = new MapSurfaceTree(this.map, true, this);\n    } else {\n        this.tree = null;\n    }\n    \n    if (typeof json === 'string') {\n        this.jsonUrl = this.map.url.processUrl(json);\n        this.baseUrl = utilsUrl.getBase(this.jsonUrl);\n        this.baseUrlSchema = utilsUrl.getSchema(this.jsonUrl);\n        this.baseUrlOrigin = utilsUrl.getOrigin(this.jsonUrl);\n        \n        var onLoaded = (function(data){\n            this.parseJson(data);            \n            this.ready = true;\n            this.map.refreshView();\n        }).bind(this);\n        \n        var onError = (function(){ }).bind(this);\n\n        utils.loadJSON(this.jsonUrl, onLoaded, onError, null,(utils.useCredentials ? (this.jsonUrl.indexOf(this.map.url.baseUrl) != -1) : false), this.map.core.xhrParams);\n        //utils.loadJSON(this.url, onLoaded, onError, null, utils.useCredentials);\n    } else {\n        this.parseJson(json);\n        this.ready = true;\n    }\n};\n\n\nMapSurface.prototype.parseJson = function(json) {\n    this.id = json['id'] || null;\n    this.type = json['type'] || 'basic';\n    this.metaBinaryOrder = json['metaBinaryOrder'] || 1;\n    this.metaUrl = this.processUrl(json['metaUrl'], '');\n    this.navUrl = this.processUrl(json['navUrl'], '');\n    this.hmapUrl = this.processUrl(json['hmapUrl'], json['navUrl'] + '00');\n    //this.cmapUrl = this.processUrl(json['cmapUrl'], '');\n    this.pipeline = this.map.config.mapForcePipeline ? this.map.config.mapForcePipeline : (json['pipeline']); // || VTS_PIPELINE_HMAP);//VTS_PIPELINE_BASIC);\n    //this.pipeline = json['pipeline'] || VTS_PIPELINE_BASIC;\n    this.navDelta = json['navDelta'] || 1;\n    this.meshUrl = this.processUrl(json['meshUrl'], '');\n    this.textureUrl = this.processUrl(json['textureUrl'], '');\n    this.geodataUrl = this.processUrl(json['geodataUrl'] || json['geodata'], '');\n    this.lodRange = json['lodRange'] || [0,0];\n    this.tileRange = json['tileRange'] || [[0,0],[0,0]];\n    this.textureLayer = json['textureLayer'] || null;\n    this.geodata = (this.type == 'geodata' || this.type == 'geodata-tiles');\n    this.credits = json['credits'] || [];\n    this.creditsUrl = null;\n    this.displaySize = json['displaySize'] || 1024;\n\n    var i, li;\n    \n    if (json['extents']) {\n        var ll = json['extents']['ll'];\n        var ur = json['extents']['ur'];\n        this.extents = new BBox(ll[0], ll[1], ll[2], ur[0], ur[1], ur[2]);\n    } else {\n        this.extents = new BBox(0,0,0,1,1,1);\n    }\n\n    this.specificity = Math.pow(2,this.lodRange[0]) / ((this.tileRange[1][0] - this.tileRange[1][0]+1)*(this.tileRange[1][1] - this.tileRange[1][1]+1));    \n    \n    switch(typeof this.credits) {\n    case 'string':\n        this.creditsUrl = this.credits;\n        this.credits = [];\n        break;\n\n    case 'object':\n        \n        if (!Array.isArray(this.credits)) {\n            var credits = this.credits;\n            this.credits = [];\n                \n            for (var key in credits){\n                this.map.addCredit(key, new MapCredit(this.map, credits[key]));\n                this.credits.push(key);\n            }\n        }\n\n        for (i = 0, li = this.credits.length; i < li; i++) {\n            var credit = this.map.getCreditById(this.credits[i]);\n            this.creditsNumbers.push(credit ? credit.id : null); \n        }\n        \n        break;\n    }    \n\n\n    if (this.geodataUrl && (typeof this.geodataUrl === 'string') && this.geodataUrl.indexOf('{geonavtile}') != -1) {\n        //this.geodataNavtileInfo = true;\n        this.geodataNavtileInfo = false;\n    }\n\n    //load stylesheet\n    if (this.geodata) {\n        var style = json['style'];\n\n        if (typeof this.credits === 'string') {\n            style = this.processUrl(style, '');\n        }\n\n        this.originalStyle = style;\n        \n        if (style) {\n            this.setStyle(style);\n            this.originalStylesheet = this.stylesheet;\n        }\n    }\n\n    this.surfaceReference = [];\n    if (this.glue) {\n        for (i = 0, li = this.id.length; i < li; i++) {\n            this.surfaceReference.push(this.map.getSurface(this.id[i]));\n        }\n    }\n};\n\n\nMapSurface.prototype.kill = function() {\n    if (this.geodataProcessor) {\n        this.geodataProcessor.kill();\n        this.geodataProcessor = null;\n    }\n\n    this.geodataUrl = null;\n    this.style = null;\n    this.stylesheet = null;\n    this.originalStyle = null;\n    this.originalStylesheet = null;\n};\n\n\nMapSurface.prototype.setOptions = function() {\n};\n\n\nMapSurface.prototype.getOptions = function() {\n    return this.getInfo();\n};\n\n\nMapSurface.prototype.getInfo = function() {\n    if (this.geodata) {\n        return {\n            'type' : this.type,\n            'metaUrl' : this.metaUrl,\n            'geodataUrl' : this.geodataUrl,\n            'lodRange' : this.lodRange,\n            'tileRange' : this.tileRange,\n            'style' : this.originalStyle\n        };\n    } else {\n        return {\n            'type' : this.type,\n            'metaUrl' : this.metaUrl,\n            'navUrl' : this.navUrl,\n            'meshUrl' : this.meshUrl,\n            'textureUrl' : this.textureUrl,\n            'lodRange' : this.lodRange,\n            'tileRange' : this.tileRange,\n            'textureLayer' : this.textureLayer\n        };\n    }\n};\n\n\nMapSurface.prototype.processUrl = function(url, fallback) {\n    if (!url) {\n        return fallback;\n    }\n\n    if (typeof url !== 'string') {\n        return url;\n    }\n\n    url = url.trim();\n    \n    if (url.indexOf('://') != -1) { //absolute\n        return url;\n    } else if (url.indexOf('//') == 0) {  //absolute without schema\n        return this.baseUrlSchema + url;\n    } else if (url.indexOf('/') == 0) {  //absolute without host\n        return this.baseUrlOrigin + url;\n    } else {  //relative\n        return this.baseUrl + url; \n    }\n};\n\n\nMapSurface.prototype.hasTile = function(id) {\n    var shift = id[0] - this.lodRange[0];\n\n    if (shift < 0) {\n        return false;\n    }\n\n    var x = id[1] >> shift;\n    var y = id[2] >> shift;\n\n    if (id[0] < this.lodRange[0] || id[0] > this.lodRange[1] ||\n        x < this.tileRange[0][0] || x > this.tileRange[1][0] ||\n        y < this.tileRange[0][1] || y > this.tileRange[1][1] ) {\n        return false;\n    }\n\n    return true;\n};\n\n\nMapSurface.prototype.hasTile2 = function(id) {\n    var shift = id[0] - this.lodRange[0];\n    var above = (shift < 0);\n\n    if (id[0] < this.lodRange[0]) {\n        shift = -shift;\n        var x1 = this.tileRange[0][0] >> shift;\n        var y1 = this.tileRange[0][1] >> shift;\n        var x2 = this.tileRange[1][0] >> shift;\n        var y2 = this.tileRange[1][1] >> shift;\n    \n        if (id[0] > this.lodRange[1] ||\n            id[1] < x1 || id[1] > x2 ||\n            id[2] < y1 || id[2] > y2 ) {\n            return [false , false];\n        }\n    } else {\n        var x = id[1] >> shift;\n        var y = id[2] >> shift;\n    \n        if (id[0] > this.lodRange[1] ||\n            x < this.tileRange[0][0] || x > this.tileRange[1][0] ||\n            y < this.tileRange[0][1] || y > this.tileRange[1][1] ) {\n            return [false , false];\n        }\n    }\n\n    return [true, above];\n};\n\n\nMapSurface.prototype.hasMetatile = function(id) {\n    if (id[0] > this.lodRange[1]) {\n        return false;\n    }\n\n    var shift = id[0] - this.lodRange[0];\n\n    if (shift >= 0) {\n        var x = id[1] >> shift;\n        var y = id[2] >> shift;\n\n        if (x < this.tileRange[0][0] || x > this.tileRange[1][0] ||\n            y < this.tileRange[0][1] || y > this.tileRange[1][1] ) {\n            return false;\n        }\n    } else {\n        shift = -shift;\n\n        if (id[1] < (this.tileRange[0][0]>>shift) || id[1] > (this.tileRange[1][0]>>shift) ||\n            id[2] < (this.tileRange[0][1]>>shift) || id[2] > (this.tileRange[1][1]>>shift) ) {\n            return false;\n        }\n    }\n\n    return true;\n};\n\n\nMapSurface.prototype.setStyle = function(style) {\n    if (this.style == style) {\n        return;\n    }\n\n    var id = style;\n\n    if (typeof id !== 'object') {\n        id = this.processUrl(id, '');\n    } else {\n        id = JSON.stringify(id);\n        id = utils.getHash(id);\n        id = \"#obj#\" + id.toString(16); \n    }\n    \n    this.stylesheet = this.map.getStylesheet(id);\n    \n    if (!this.stylesheet) {\n        this.stylesheet = new MapStylesheet(this.map, id, style, this);\n        this.map.addStylesheet(id, this.stylesheet); \n    } \n\n    this.style = style;\n    this.styleChanged = true;\n    this.geodataCounter++;\n\n    //this.map.setStylesheetData(id); //force update\n    \n    this.map.markDirty();\n};\n\n\n//used only for glues\nMapSurface.prototype.getSurfaceReference = function(index) {\n    return this.surfaceReference[index - 1];\n};\n\n\nMapSurface.prototype.getMetaUrl = function(id, skipBaseUrl) {\n    return this.map.url.makeUrl(this.metaUrl, {lod:id[0], ix:id[1], iy:id[2] }, null, skipBaseUrl);\n};\n\n\nMapSurface.prototype.getNavUrl = function(id, skipBaseUrl) {\n    return this.map.url.makeUrl(this.navUrl, {lod:id[0], ix:id[1], iy:id[2] }, null, skipBaseUrl);\n};\n\n\nMapSurface.prototype.getHMapUrl = function(id, skipBaseUrl) {\n    return this.map.url.makeUrl(this.hmapUrl, {lod:id[0], ix:id[1], iy:id[2] }, null, skipBaseUrl);\n};\n\nMapSurface.prototype.getMeshUrl = function(id, skipBaseUrl) {\n    return this.map.url.makeUrl(this.meshUrl, {lod:id[0], ix:id[1], iy:id[2] }, null, skipBaseUrl);\n};\n\n\nMapSurface.prototype.getTextureUrl = function(id, subId, skipBaseUrl) {\n    return this.map.url.makeUrl(this.textureUrl, {lod:id[0], ix:id[1], iy:id[2] }, subId, skipBaseUrl);\n};\n\n\nMapSurface.prototype.getGeodataUrl = function(id, navtileStr, skipBaseUrl) {\n//    return this.map.makeUrl(this.geodataUrl + \"&v=1\", {lod:id[0], ix:id[1], iy:id[2] }, navtileStr, skipBaseUrl);\n    return this.map.url.makeUrl(this.geodataUrl, {lod:id[0], ix:id[1], iy:id[2] }, navtileStr, skipBaseUrl);\n};\n\n\nMapSurface.prototype.getMonoGeodataUrl = function(id, skipBaseUrl) {\n    return this.map.url.makeUrl(this.geodataUrl, {}, null, skipBaseUrl);\n};\n\n\nexport default MapSurface;\n\n\n\n  ","\nimport {utils as utils_} from '../utils/utils';\nimport BBox_ from '../renderer/bbox';\n\n//get rid of compiler mess\nvar BBox = BBox_;\nvar utils = utils_;\n\n\nvar MapVirtualSurface = function(map, json) {\n    this.map = map;\n    this.id = null;\n    this.metaUrl = '';\n    this.mappingUrl = '';\n    this.baseUrl = this.map.url.baseUrl;\n    this.baseUrlSchema = this.map.url.baseUrlSchema;\n    this.baseUrlOrigin = this.map.url.baseUrlOrigin;\n    this.lodRange = [0,0];\n    this.tileRange = [[0,0],[0,0]];\n    this.surfaces = [];\n    this.parseJson(json);\n    this.virtual = true;\n    this.ready = false;\n};\n\n\nMapVirtualSurface.prototype.parseJson = function(json) {\n    this.id = json['id'] || null;\n    this.metaUrl = this.processUrl(json['metaUrl'], '');\n    this.mappingUrl = this.processUrl(json['mapping'], '');\n    this.lodRange = json['lodRange'] || [0,0];\n    this.tileRange = json['tileRange'] || [[0,0],[0,0]];\n    this.strId = this.id ? this.id.join(';') : null;\n\n    if (this.id) {\n        var tmp = this.id.slice();\n        tmp.sort(); \n        this.strId = tmp.join(';');\n    }\n\n    if (json['extents']) {\n        var ll = json['extents']['ll'];\n        var ur = json['extents']['ur'];\n        this.extents = new BBox(ll[0], ll[1], ll[2], ur[0], ur[1], ur[2]);\n    } else {\n        this.extents = new BBox(0,0,0,1,1,1);\n    }\n\n    this.specificity = Math.pow(2,this.lodRange[0]) / ((this.tileRange[1][0] - this.tileRange[1][0]+1)*(this.tileRange[1][1] - this.tileRange[1][1]+1));    \n\n    utils.loadBinary(this.mappingUrl, this.onMappingFileLoaded.bind(this), this.onMappingFileLoadError.bind(this), (utils.useCredentials ? (this.jsonUrl.indexOf(this.map.url.baseUrl) != -1) : false), this.map.core.xhrParams);\n};\n\n\nMapVirtualSurface.prototype.onMappingFileLoaded = function(data) {\n    this.parseMappingFile(new DataView(data));            \n    this.ready = true;\n    this.map.refreshView();\n};\n\n\nMapVirtualSurface.prototype.onMappingFileLoadError = function() {\n};\n\n\nMapVirtualSurface.prototype.parseMappingFile = function(data) {\n    var index = 0;\n\n    var magic = '';\n    magic += String.fromCharCode(data.getUint8(index, true)); index += 1;\n    magic += String.fromCharCode(data.getUint8(index, true)); index += 1;\n\n    if (magic != 'TM') {\n        return false;\n    }\n\n    var count = data.getUint16(index, true); index += 2;\n\n    for (var i = 0; i < count; i++) {\n        var size = data.getUint8(index, true); index += 1;\n        var id = [];\n\n        for (var j = 0; j < size; j++) {\n            var s = data.getUint16(index, true); index += 2;\n            s = this.id[s];\n            \n            if (s) {\n                id.push(s);\n            }\n        }\n        \n        if (id.length == 1) { //get surface\n            this.surfaces.push(this.map.getSurface(id[0]));\n        } else { //get glue\n            this.surfaces.push(this.map.getGlue(id.join(';')));\n        }\n    }\n\n    return true;    \n};\n\n\nMapVirtualSurface.prototype.getInfo = function() {\n    return {\n        'metaUrl' : this.metaUrl,\n        'mapping' : this.mappingUrl,\n        'lodRange' : this.lodRange,\n        'tileRange' : this.tileRange\n    };\n};\n\n\nMapVirtualSurface.prototype.processUrl = function(url, fallback) {\n    if (!url) {\n        return fallback;\n    }\n\n    url = url.trim();\n    \n    if (url.indexOf('://') != -1) { //absolute\n        return url;\n    } else if (url.indexOf('//') == 0) {  //absolute without schema\n        return this.baseUrlSchema + url;\n    } else if (url.indexOf('/') == 0) {  //absolute without host\n        return this.baseUrlOrigin + url;\n    } else {  //relative\n        return this.baseUrl + url; \n    }\n};\n\n\nMapVirtualSurface.prototype.hasTile = function(id) {\n    var shift = id[0] - this.lodRange[0];\n\n    if (shift < 0) {\n        return false;\n    }\n\n    var x = id[1] >> shift;\n    var y = id[2] >> shift;\n\n    if (id[0] < this.lodRange[0] || id[0] > this.lodRange[1] ||\n        x < this.tileRange[0][0] || x > this.tileRange[1][0] ||\n        y < this.tileRange[0][1] || y > this.tileRange[1][1] ) {\n        return false;\n    }\n\n    return true;\n};\n\n\nMapVirtualSurface.prototype.hasTile2 = function(id) {\n    var shift = id[0] - this.lodRange[0];\n    var above = (shift < 0);\n\n    if (id[0] < this.lodRange[0]) {\n        shift = -shift;\n        var x1 = this.tileRange[0][0] >> shift;\n        var y1 = this.tileRange[0][1] >> shift;\n        var x2 = this.tileRange[1][0] >> shift;\n        var y2 = this.tileRange[1][1] >> shift;\n    \n        if (id[0] > this.lodRange[1] ||\n            id[1] < x1 || id[1] > x2 ||\n            id[2] < y1 || id[2] > y2 ) {\n            return [false , false];\n        }\n    } else {\n        var x = id[1] >> shift;\n        var y = id[2] >> shift;\n    \n        if (id[0] > this.lodRange[1] ||\n            x < this.tileRange[0][0] || x > this.tileRange[1][0] ||\n            y < this.tileRange[0][1] || y > this.tileRange[1][1] ) {\n            return [false , false];\n        }\n    }\n\n    return [true, above];\n};\n\n\nMapVirtualSurface.prototype.hasMetatile = function(id) {\n    if (id[0] > this.lodRange[1]) {\n        return false;\n    }\n\n    var shift = id[0] - this.lodRange[0];\n\n    if (shift >= 0) {\n        var x = id[1] >> shift;\n        var y = id[2] >> shift;\n\n        if (x < this.tileRange[0][0] || x > this.tileRange[1][0] ||\n            y < this.tileRange[0][1] || y > this.tileRange[1][1] ) {\n            return false;\n        }\n\n    } else {\n        shift = -shift;\n\n        if (id[1] < (this.tileRange[0][0]>>shift) || id[1] > (this.tileRange[1][0]>>shift) ||\n            id[2] < (this.tileRange[0][1]>>shift) || id[2] > (this.tileRange[1][1]>>shift) ) {\n            return false;\n        }\n    }\n\n    return true;\n};\n\n\n//used only for glues\nMapVirtualSurface.prototype.getSurface = function(index) {\n    return this.surfaces[index - 1];\n};\n\n\nMapVirtualSurface.prototype.getMetaUrl = function(id, skipBaseUrl) {\n    return this.map.url.makeUrl(this.metaUrl, {lod:id[0], ix:id[1], iy:id[2] }, null, skipBaseUrl);\n};\n\n\nexport default MapVirtualSurface;\n\n","\nimport MapBoundLayer_ from './bound-layer';\nimport MapCredit_ from './credit';\nimport MapRefFrame_ from './refframe';\nimport MapView_ from './view';\nimport MapSrs_ from './srs';\nimport MapBody_ from './body';\nimport MapSurface_ from './surface';\nimport MapVirtualSurface_ from './virtual-surface';\nimport MapStylesheet_ from './stylesheet';\n\n//get rid of compiler mess\nvar MapCredit = MapCredit_;\nvar MapBoundLayer = MapBoundLayer_;\nvar MapRefFrame = MapRefFrame_;\nvar MapView = MapView_;\nvar MapSrs = MapSrs_;\nvar MapBody = MapBody_;\nvar MapSurface = MapSurface_;\nvar MapVirtualSurface = MapVirtualSurface_;\nvar MapStylesheet = MapStylesheet_;\n\n\nvar MapConfig = function(map, config) {\n    this.map = map;\n    this.mapConfig = config;\n    this.parseConfig();\n};\n\n\nMapConfig.prototype.parseConfig = function() {\n    if (!(this.parseSrses() && this.parseBodies() && this.parseReferenceFrame() &&\n          this.parseCredits() && this.parseStylesheets() && \n          this.parseSurfaces() && this.parseGlues() && \n          this.parseVirtualSurfaces() && this.parseBoundLayers() &&\n          this.parseFreeLayers() && this.parseViews() &&\n          this.parseParams() && this.parseBrowserOptions() )) {\n        //wrong config file\n    }\n\n    var stats = this.map.stats;\n    stats.loadedCount = 0;\n    stats.loadErrorCount = 0;\n    stats.loadFirst = performance.now();\n    stats.loadLast = this.map.loadFirst;\n};\n\n\nMapConfig.prototype.afterConfigParsed = function() {\n    if (this.mapConfig['position'] != null) {\n        this.map.setPosition(this.mapConfig['position'], false);\n    }\n\n    this.map.setView(this.map.initialView);\n};\n\n\nMapConfig.prototype.parseSrses = function() {\n    var srses = this.mapConfig['srses'];\n    this.map.srses = {};\n\n    if (srses == null) {\n        return false;\n    }\n\n    for (var key in srses) {\n        this.map.addSrs(key, new MapSrs(this.map, key, srses[key]));\n    }\n\n    return true;\n};\n\n\nMapConfig.prototype.parseBodies = function() {\n    var bodies = this.mapConfig['bodies'];\n    this.map.bodies = {};\n\n    if (bodies == null) {\n        return true;//false;\n    }\n\n    for (var key in bodies) {\n        this.map.addBody(key, new MapBody(this.map, bodies[key]));\n    }\n\n    return true;\n};\n\n\nMapConfig.prototype.parseReferenceFrame = function() {\n    var rf = this.mapConfig['referenceFrame'];\n\n    if (rf == null) {\n        return false;\n    }\n\n    this.map.referenceFrame = new MapRefFrame(this.map, rf);\n\n    if (!this.map.referenceFrame.valid) {\n        return false;\n    }\n\n    return true;\n};\n\n\nMapConfig.prototype.parseCredits = function() {\n    var credits = this.mapConfig['credits'];\n    this.map.credits = {};\n\n    if (credits == null) {\n        return false;\n    }\n\n    for (var key in credits) {\n        this.map.addCredit(key, new MapCredit(this.map, credits[key]));\n    }\n\n    return true;\n};\n\n\nMapConfig.prototype.parseSurfaces = function() {\n    var surfaces = this.mapConfig['surfaces'];\n    this.map.surfaces = [];\n\n    if (surfaces == null) {\n        return false;\n    }\n\n    for (var i = 0, li = surfaces.length; i < li; i++) {\n        var surface = new MapSurface(this.map, surfaces[i]);\n        this.map.addSurface(surface.id, surface);\n    }\n\n    return true;\n};\n\n\nMapConfig.prototype.parseVirtualSurfaces = function() {\n    var surfaces = this.mapConfig['virtualSurfaces'];\n    this.map.virtualSurfaces = [];\n\n    if (!this.map.config.mapVirtualSurfaces) {\n        return true;\n    }\n\n    if (surfaces == null) {\n        return true;\n    }\n\n    for (var i = 0, li = surfaces.length; i < li; i++) {\n        var surface = new MapVirtualSurface(this.map, surfaces[i]);\n        this.map.virtualSurfaces[surface.strId] = surface;\n    }\n\n    return true;\n};\n\n\nMapConfig.prototype.parseViews = function() {\n    var views = this.mapConfig['namedViews'];\n    this.map.namedViews = [];\n\n    if (views) {\n        for (var key in views) {\n            this.map.addNamedView(key, new MapView(this.map, views[key], true));\n        }\n    }\n\n    var view = this.mapConfig['view'];\n\n    if (typeof view === 'string') {\n        view = this.map.namedViews[view];\n    }\n\n    if (!view) {\n        return true;\n    }\n\n    view = new MapView(this.map, view, true);\n\n    this.map.initialView = view.getInfo();\n    return true;\n};\n\n\nMapConfig.prototype.parseGlues = function() {\n    var glues = this.mapConfig['glue'];\n    this.map.glues = [];\n\n    if (glues == null) {\n        return true;\n    }\n\n    for (var i = 0, li = glues.length; i < li; i++) {\n        var surface = new MapSurface(this.map, glues[i], 'glue');\n        this.map.addGlue(surface.id.join(';'), surface);\n    }\n\n    return true;\n};\n\n\nMapConfig.prototype.parseBoundLayers = function() {\n    var layers = this.mapConfig['boundLayers'];\n    this.map.boundLayers = [];\n\n    if (layers == null) {\n        return true;\n    }\n\n    for (var key in layers) {\n        var layer = new MapBoundLayer(this.map, layers[key], key);\n        this.map.addBoundLayer(key, layer);\n    }\n\n    return true;\n};\n\n\nMapConfig.prototype.parseFreeLayers = function() {\n    var layers = this.mapConfig['freeLayers'];\n    this.map.freeLayers = [];\n\n    if (layers == null) {\n        return true;\n    }\n\n    for (var key in layers) {\n        var layer = new MapSurface(this.map, layers[key], 'free');\n        this.map.addFreeLayer(key, layer);\n    }\n\n    return true;\n};\n\n\nMapConfig.prototype.parseStylesheets = function() {\n    var styles = this.mapConfig['stylesheets'];\n    this.map.stylesheets = [];\n\n    if (styles == null) {\n        return true;\n    }\n\n    for (var key in styles) {\n        var style = new MapStylesheet(this.map, key, styles[key]);\n        this.map.addStylesheet(key, style);\n    }\n\n    return true;\n};\n\n\nMapConfig.prototype.parseParams = function() {\n    return true;\n};\n\n\nMapConfig.prototype.parseBrowserOptions = function() {\n    var options = this.mapConfig['browserOptions'];\n    this.map.browserOptions = {};\n    \n    if (options == null) {\n        return true;\n    }\n    \n    this.map.browserOptions = JSON.parse(JSON.stringify(options));\n    return true;\n};\n\n\nMapConfig.prototype.cloneConfig = function() {\n    var json = JSON.parse(JSON.stringify(this.mapConfig));\n    return json;\n};\n\n\nexport default MapConfig;\n","\nimport {mat4 as mat4_} from '../utils/matrix';\nimport {math as math_} from '../utils/math';\nimport GeographicLib_ from 'geographiclib';\n\n//get rid of compiler mess\nvar mat4 = mat4_;\nvar math = math_;\nvar GeographicLib = GeographicLib_;\n\n\nvar MapConvert = function(map) {\n    this.map = map;\n    this.renderer = map.renderer;\n    this.config = map.config;\n    this.measure = map.measure;\n    this.isProjected = this.map.getNavigationSrs().isProjected();\n};\n\n\nMapConvert.prototype.convertCoords = function(coords, source, destination) {\n    return this.map.referenceFrame.convertCoords(coords, source, destination);\n};\n\n\nMapConvert.prototype.movePositionCoordsTo = function(position, azimuth, distance, azimuthCorrectionFactor) {\n    var coords = position.getCoords();\n    var navigationSrsInfo = this.map.getNavigationSrs().getSrsInfo();\n    azimuthCorrectionFactor = (azimuthCorrectionFactor == null) ? 1 : azimuthCorrectionFactor; \n\n    if (this.isProjected) {\n        var yaw = math.radians(azimuth);\n        var forward = [-Math.sin(yaw), Math.cos(yaw)];\n\n        position.setCoords2([coords[0] + (forward[0]*distance),\n            coords[1] + (forward[1]*distance)]);\n    } else {\n        var geod = this.measure.getGeodesic();\n\n        var r = geod.Direct(coords[1], coords[0], azimuth, distance);\n        position.setCoords2([r.lon2, r.lat2]);\n\n        var orientation = position.getOrientation();\n\n        //console.log(\"corerction: \" + (r.azi1 - r.azi2));\n\n        orientation[0] -= (r.azi1 - r.azi2) * azimuthCorrectionFactor;\n        //orientation[0] -= (r.azi1 - r.azi2); \n\n        //if (!skipOrientation) {\n        position.setOrientation(orientation);\n        //}\n        \n        //console.log(\"azimuthCorrection: \" + azimuthCorrectionFactor);\n        //console.log(\"oldpos: \" + JSON.stringify(this));\n        //console.log(\"newpos: \" + JSON.stringify(pos2));\n    }\n    \n    return position;\n};\n\n\nMapConvert.prototype.convertPositionViewMode = function(position, mode) {\n    if (mode == position.pos[0]) {\n        return position;\n    }\n\n    if (mode == 'obj') {\n        if (position.getHeightMode() == 'float') {\n            var covertToFloat = true;\n            this.convertPositionHeightMode(position, 'fix', true);\n        }\n        \n        var distance = position.getViewDistance(), coords;\n        var orientation = position.getOrientation();\n        \n        //get height delta\n        var pich = math.radians(-orientation[1]);\n        var heightDelta = distance * Math.sin(pich);\n\n        //reduce distance by pich\n        distance *= Math.cos(pich);\n\n        if (this.isProjected) {\n            //get forward vector\n            var yaw = math.radians(orientation[0]);\n            var forward = [-Math.sin(yaw), Math.cos(yaw)];\n    \n            //get center coords \n            coords = position.getCoords();\n            coords[0] = coords[0] + (forward[0] * distance);\n            coords[1] = coords[1] + (forward[1] * distance);\n        } else {\n            this.movePositionCoordsTo(position, -orientation[0], distance);\n            coords = position.getCoords();\n        }\n        \n        coords[2] -= heightDelta;\n        position.setCoords(coords);\n\n        if (covertToFloat) {\n            this.convertPositionHeightMode(position, 'float', true);\n        }\n        \n    } else if (mode == 'subj') {\n        coords = this.getPositionCameraCoords(position, position.getHeightMode());\n        position.setCoords(coords);\n                \n        //TODO: take in accout planet ellipsoid\n    }\n\n    position.pos[0] = mode;\n\n    return position;\n};\n\n\nMapConvert.prototype.convertPositionHeightMode = function(position, mode, noPrecisionCheck) {\n    if (position.pos[3] == mode) {\n        return position;\n    }\n\n    var lod =  this.measure.getOptimalHeightLod(position.getCoords(), position.getViewExtent(), this.config.mapNavSamplesPerViewExtent);\n    var height = this.measure.getSurfaceHeight(position.getCoords(), lod);\n\n    if (!height[1] && !noPrecisionCheck) {\n        //return null;\n    }\n\n    //set new height\n    if (mode == 'float') {\n        position.pos[3] = mode;\n        position.pos[4] = position.pos[4] - height[0];\n    } else if (mode == 'fix') {\n        position.pos[3] = mode;\n        position.pos[4] = position.pos[4] + height[0];\n    }\n\n    return position;\n};\n\n\nMapConvert.prototype.getPositionCameraCoords = function(position, heightMode) {\n    var orientation = position.getOrientation();\n    var rotMatrix = mat4.create();\n    mat4.multiply(math.rotationMatrix(2, math.radians(-orientation[0])), math.rotationMatrix(0, math.radians(orientation[1])), rotMatrix);\n\n    var coords, terrainHeight = 0, surfaceHeight, lod = -1;\n\n    if (position.getViewMode() == 'obj') {\n        coords = position.getCoords();\n\n        //convert height to fix\n        if (position.getHeightMode() == 'float') {\n            lod = this.measure.getOptimalHeightLod(coords, position.getViewExtent(), this.config.mapNavSamplesPerViewExtent);\n            surfaceHeight = this.measure.getSurfaceHeight(coords, lod);\n            terrainHeight = surfaceHeight[0];\n        }\n\n        var camInfo = this.measure.getPositionCameraInfo(position, this.isProjected);\n\n        if (this.isProjected) {\n            //var distance = (this.getViewExtent()) / Math.tan(math.radians(this.getFov()*0.5));\n            //var orbitPos = [0, -distance, 0];\n            //math.mat4.multiplyVec3(rotMatrix, orbitPos);\n\n            coords[0] += camInfo.orbitCoords[0];\n            coords[1] += camInfo.orbitCoords[1];\n            coords[2] += camInfo.orbitCoords[2] + terrainHeight;\n        } else {\n            var worldPos = this.convertCoords([coords[0], coords[1], coords[2] + terrainHeight], 'navigation', 'physical');\n            worldPos[0] += camInfo.orbitCoords[0];\n            worldPos[1] += camInfo.orbitCoords[1];\n            worldPos[2] += camInfo.orbitCoords[2];// + terrainHeight;\n\n            coords = this.convertCoords(worldPos, 'physical', 'navigation');\n        }\n\n        if (heightMode == 'fix') {\n            return coords;\n        } else {\n            //get float height for new coords\n            if (lod == -1) {\n                lod =  this.measure.getOptimalHeightLod(coords, position.getViewExtent(), this.config.mapNavSamplesPerViewExtent);\n            }\n            \n            surfaceHeight = this.measure.getSurfaceHeight(coords, lod);\n            coords[2] -= surfaceHeight[0];\n\n            return coords;\n        }\n\n    } else {\n\n        if (position.getHeightMode() == heightMode) {\n            return position.getCoords();\n        } else {\n            lod =  this.measure.getOptimalHeightLod(position.getCoords(), position.getViewExtent(), this.config.mapNavSamplesPerViewExtent);\n            surfaceHeight = this.measure.getSurfaceHeight(position.getCoords(), lod);\n            //height += surfaceHeight[0];\n\n            coords = position.getCoords();\n\n            if (heightMode == 'fix') {\n                coords[2] += surfaceHeight[0];\n            } else {\n                coords[2] -= surfaceHeight[0];\n            }\n\n            return coords;\n        }\n    }\n};\n\n\nMapConvert.prototype.getPositionNavCoordsFromPublic = function(position, lod) {\n    var coords = position.getCoords();\n\n    if (position.getHeightMode() == 'float') {\n        lod =  (lod != null) ? lod : this.measure.getOptimalHeightLod(position.getCoords(), position.getViewExtent(), this.config.mapNavSamplesPerViewExtent);\n        var surfaceHeight = this.measure.getSurfaceHeight(position.getCoords(), lod);\n        coords[2] += surfaceHeight[0]; \n    }\n\n    return this.convertCoords(coords, 'public', 'navigation');\n};\n\nMapConvert.prototype.getPositionPublicCoords = function(position, lod) {\n    var coords = position.getCoords();\n\n    if (position.getHeightMode() == 'float') {\n        lod =  (lod != null) ? lod : this.measure.getOptimalHeightLod(position.getCoords(), position.getViewExtent(), this.config.mapNavSamplesPerViewExtent);\n        var surfaceHeight = this.measure.getSurfaceHeight(position.getCoords(), lod);\n        coords[2] += surfaceHeight[0]; \n    }\n\n    return this.convertCoords(coords, 'navigation', 'public');\n};\n\n\nMapConvert.prototype.getPositionPhysCoords = function(position, lod, includeSE) {\n    var coords = position.getCoords();\n\n    if (position.getHeightMode() == 'float') {\n        lod =  (lod != null) ? lod : this.measure.getOptimalHeightLod(position.getCoords(), position.getViewExtent(), this.config.mapNavSamplesPerViewExtent);\n        var surfaceHeight = this.measure.getSurfaceHeight(position.getCoords(), lod);\n        coords[2] += surfaceHeight[0]; \n    }\n\n    if (this.renderer.useSuperElevation && includeSE) {\n        coords[2] = this.renderer.getSuperElevatedHeight(coords[2]);\n    }\n\n    return this.convertCoords(coords, 'navigation', 'physical');\n};\n\n\nMapConvert.prototype.getPositionCameraSpaceCoords = function(position, lod) {\n    var coords = position.getCoords();\n\n    if (position.getHeightMode() == 'float') {\n        lod =  (lod != null) ? lod : this.measure.getOptimalHeightLod(position.getCoords(), position.getViewExtent(), this.config.mapNavSamplesPerViewExtent);\n        var surfaceHeight = this.measure.getSurfaceHeight(position.getCoords(), lod);\n        coords[2] += surfaceHeight[0]; \n    }\n\n    if (this.renderer.useSuperElevation) {\n        coords[2] = this.renderer.getSuperElevatedHeight(coords[2]);\n    }\n\n    var worldPos = this.convertCoords(coords, 'navigation', 'physical');\n    var camPos = this.map.camera.position;\n    worldPos[0] -= camPos[0];\n    worldPos[1] -= camPos[1];\n    worldPos[2] -= camPos[2];\n  \n    return worldPos;\n};\n\n\nMapConvert.prototype.getPositionCanvasCoords = function(position, lod, physical, containsSE) {\n    var worldPos;\n    if (physical) {\n        var camPos = this.map.camera.position;\n        var coords = position.getCoords();\n\n        if (this.renderer.useSuperElevation && !containsSE) {\n            coords = this.renderer.transformPointBySE(coords);\n        }\n\n        worldPos = [coords[0] - camPos[0], coords[1] - camPos[1], coords[2] - camPos[2]];\n    } else {\n        worldPos = this.getPositionCameraSpaceCoords(position, lod);\n    }\n    \n    return this.map.renderer.project2(worldPos, this.map.camera.getMvpMatrix());\n};\n\n\nMapConvert.prototype.transformPhysCoordsBySE = function(coords) {\n    if (!this.renderer.useSuperElevation) {\n        return coords;\n    }\n\n    return this.renderer.transformPointBySE(coords);\n};\n\n\nMapConvert.prototype.convertCoordsFromPhysToNav = function(coords, mode, lod, containsSE) {\n    coords = this.convertCoords(coords, 'physical', 'navigation');\n\n    if (this.renderer.useSuperElevation && containsSE) {\n        coords[2] = this.renderer.getUnsuperElevatedHeight(coords[2]);\n    }\n\n    if (mode == 'float') {\n        lod =  (lod != null) ? lod : this.measure.getOptimalHeightLod(coords, 10, this.config.mapNavSamplesPerViewExtent);\n        var surfaceHeight = this.measure.getSurfaceHeight(coords, lod);\n        coords[2] -= surfaceHeight[0]; \n    } \n\n    return coords;\n};\n\n\nMapConvert.prototype.getGeodesicLinePoints = function(coords, coords2, height, density) {\n    var geod, r, length, azimuth, minStep, d;\n    var navigationSrsInfo = this.measure.navigationSrsInfo;\n    var dx = coords2[0] - coords[0];\n    var dy = coords2[1] - coords[1];\n    var dz = coords2[2] - coords[2];\n\n    if (this.isProjected) {\n        length = Math.sqrt(dx*dx + dy*dy + dz*dz);\n        minStep = 1000000; //just big number\n    } else {\n        geod = this.measure.getGeodesic();\n        r = geod.Inverse(coords[1], coords[0], coords2[1], coords2[0]);\n        length = r.s12;\n        azimuth = r.azi1;\n        minStep = 10 * ((navigationSrsInfo['a'] * 2 * Math.PI) / 4007.5); //aprox 100km for earth\n    }\n\n    var points = [coords];\n    var distance = minStep;\n\n    for (;distance < length; distance += minStep) {\n        d = distance / length;\n\n        if (this.isProjected) {\n            points.push([ coords[0] + dx * d, coords[1] + dy * d, coords[2] + dz * d ]);\n        } else {\n            r = geod.Direct(coords[1], coords[0], azimuth, distance);\n            points.push([r.lon2, r.lat2, coords[2] + dz * d]);\n        }\n    }\n\n    points.push(coords2);\n\n    return points;\n};\n\nexport default MapConvert;\n","\nimport {vec3 as vec3_, mat4 as mat4_} from '../utils/matrix';\nimport {math as math_} from '../utils/math';\nimport GeographicLib_ from 'geographiclib';\n\n//get rid of compiler mess\nvar vec3 = vec3_, mat4 = mat4_;\nvar math = math_;\nvar GeographicLib = GeographicLib_;\n\n\nvar MapMeasure = function(map) {\n    this.map = map;\n    this.config = map.config;\n    this.convert = map.convert;\n    this.getPhysicalSrs = this.map.getPhysicalSrs();\n    this.navigationSrs = this.map.getNavigationSrs();\n    this.publicSrs = this.map.getPublicSrs();\n    this.navigationSrsInfo = this.navigationSrs.getSrsInfo();\n    this.isProjected = this.navigationSrs.isProjected();\n\n    var res = this.getSpatialDivisionNodeDepths();\n\n    this.minDivisionNodeDepth = res[0];\n    this.maxDivisionNodeDepth = res[1];\n};\n\nMapMeasure.prototype.getSurfaceAreaGeometry = function(coords, radius, mode, limit, loadMeshes, loadTextures) {\n    var tree = this.map.tree;\n\n    if (tree.surfaceSequence.length == 0) {\n        reurn [true, []];\n    }\n\n    var center = this.convert.convertCoords(coords, 'navigation', 'physical');\n    var coneVec = [0,0,0];\n\n    vec3.normalize(center, coneVec);\n\n    var distance = vec3.length(center);\n    var coneAngle = Math.atan(Math.tan(radius / distance));\n\n    tree.params = {\n        coneVec : coneVec,\n        coneAngle : coneAngle,\n        mode : mode,\n        limit : limit,\n        loaded : true,\n        areaTiles : [],\n        loadMeshes: (loadMeshes === true),\n        loadTextures: (loadTextures === true)\n    };\n\n    //priority = 0, noReadInly = false\n    tree.traceAreaTiles(tree.surfaceTree, 0, false);\n\n    return [tree.params.loaded, tree.params.areaTiles];\n};\n\nMapMeasure.prototype.getSurfaceHeight = function(coords, lod, storeStats, node, nodeCoords, coordsArray, useNodeOnly) {\n    var tree = this.map.tree;\n\n    if (tree.surfaceSequence.length == 0) {\n        return [0, true, true, null, null, null];\n    }\n\n    if (!node) {\n        var result = this.getSpatialDivisionNode(coords);\n        node = result[0];\n        nodeCoords = result[1];\n    }\n    \n    if (!this.config.mapHeightLodBlend) {\n        lod = Math.floor(lod);\n    }\n\n    if (useNodeOnly || this.config.mapIgnoreNavtiles) {\n        return this.getSurfaceHeightNodeOnly(null, lod + 8, storeStats, lod, null, node, nodeCoords, coordsArray);        \n    }\n\n    if (node != null && lod !== null) {\n        var root = tree.findSurfaceTile(node.id);\n\n        var extents = {\n            ll : node.extents.ll.slice(),\n            ur : node.extents.ur.slice()\n        };\n        var params = {\n            coords : nodeCoords,\n            desiredLod : Math.ceil(lod),\n            extents : extents,\n            metanode : null,\n            heightMap : null,\n            heightMapExtents : null,\n            traceHeight : true,\n            waitingForNode : false,\n            finalNode : false,\n            bestHeightMap : 999\n        };\n\n        tree.traceHeight(root, params, false);\n\n        var metanode = params.metanode, i, li, height;\n\n        if (params.heightMap) {\n            if (storeStats) {\n                var stats = this.map.stats;\n                stats.heightClass = 2;\n                stats.heightLod = lod;\n                stats.heightNode = metanode.id[0];                        \n            }\n            \n            var res = metanode.id[0] >= Math.ceil(lod);\n            var arrayRes, height1, height2;\n           \n            if (this.config.mapHeightLodBlend && metanode.id[0] > 0 &&\n                params.parent && params.parent.heightMap && lod <= metanode.id[0]) {\n                height1 = this.getHeightmapValue(nodeCoords, params.parent.metanode, params.parent);  \n                height2 = this.getHeightmapValue(nodeCoords, metanode, params);  \n                var factor = lod - Math.floor(lod);\n                height = height1 + (height2 - height1) * factor;\n\n                if (coordsArray) {\n                    arrayRes = new Array(coordsArray.length);\n                    \n                    for (i = 0, li = coordsArray.length; i < li; i++) {\n                        var nodeCoords2 = coordsArray[i];//node.getInnerCoords(coordsArray[i]);\n                        height1 = this.getHeightmapValue(nodeCoords2, params.parent.metanode, params.parent);  \n                        height2 = this.getHeightmapValue(nodeCoords2, metanode, params);  \n\n                        arrayRes[i] = [height1 + (height2 - height1) * factor, res, true];\n                    }\n                }\n                \n                //console.log(\"lod: \" + lod + \" h1: \" + height1 + \" h2: \" + height2 + \" h: \" + height);  \n            } else {\n                height = this.getHeightmapValue(nodeCoords, metanode, params);  \n\n                if (coordsArray) {\n                    arrayRes = new Array(coordsArray.length);\n                    \n                    for (i = 0, li = coordsArray.length; i < li; i++) {\n                        height2 = this.getHeightmapValue(coordsArray[i], metanode, params);  \n\n                        arrayRes[i] = [height2, res, true];\n                    }\n                }\n            }\n\n            return [height, res, true, null, null, arrayRes];\n\n        } else if (metanode /*&& metanode.id[0] == lod && !metanode.hasNavtile()*/){\n            res = this.getSurfaceHeightNodeOnly(coords, lod + 8, storeStats, lod, null, node, nodeCoords, coordsArray);\n\n            //console.log(\"lod2: \" + lod + \" h: \" + height[0]);  \n            //return [res[0], res[1], true, null, null, res[5]];\n\n            return [res[0], res[1], res[2], null, null, res[5]];\n        }\n\n        /*\n        if (metanode != null) {\n            var height = metanode.minHeight + (metanode.maxHeight - metanode.minHeight) * 0.5;\n            return [height, metanode.id[0] >= lod, true];\n        }*/\n    }\n\n    return [0, false, false, null, null, null];\n};\n\n\nMapMeasure.prototype.getSurfaceHeightNodeOnly = function(coords, lod, storeStats, statsLod, deltaSample, node, nodeCoords, coordsArray) {\n    var arrayRes, height, stats = this.map.stats; \n\n    var tree = this.map.tree;\n\n    if (tree.surfaceSequence.length == 0) {\n        return [0, true, true, null, null, null];\n    }\n    \n    if (!deltaSample) {\n        if (!node) {\n            var result = this.getSpatialDivisionNode(coords);\n            node = result[0];\n            nodeCoords = result[1];\n        }\n        \n        if (coordsArray) {\n            arrayRes = new Array(coordsArray.length);\n            \n            for (var i = 0, li = coordsArray.length; i < li; i++) {\n                arrayRes[i] = this.getSurfaceHeightNodeOnly(null, lod, storeStats, statsLod, deltaSample, node, coordsArray[i]);\n            }\n        }\n        \n    } else {\n        node = deltaSample[0];\n        nodeCoords = deltaSample[1];\n    }\n\n    if (!this.config.mapHeightLodBlend) {\n        lod = Math.floor(lod);\n    }\n\n    if (!deltaSample && this.config.mapHeightNodeBlend) {\n        var res1 = this.getSurfaceHeightNodeOnly(null, lod, storeStats, statsLod, [node, [nodeCoords[0], nodeCoords[1], nodeCoords[2]]]);\n        \n        if (res1[2]) {\n            var sx = res1[3].ur[0] - res1[3].ll[0];\n            var sy = res1[3].ur[1] - res1[3].ll[1];\n            \n            var fx = (nodeCoords[0] - res1[3].ll[0]) / sx;\n            var fy = (nodeCoords[1] - res1[3].ll[1]) / sy;\n            \n            /*\n            var c2 = node.getOuterCoords([nodeCoords[0] + sx, nodeCoords[1], nodeCoords[2]]);\n            var c3 = node.getOuterCoords([nodeCoords[0], nodeCoords[1] + sy, nodeCoords[2]]);\n            var c4 = node.getOuterCoords([nodeCoords[0] + sx, nodeCoords[1] + sy, nodeCoords[2]]);\n    \n            var res2 = this.getSurfaceHeightNodeOnly(c2, lod, storeStats, statsLod, true);\n            var res3 = this.getSurfaceHeightNodeOnly(c3, lod, storeStats, statsLod, true);\n            var res4 = this.getSurfaceHeightNodeOnly(c4, lod, storeStats, statsLod, true);\n            */\n            \n            var res2 = this.getSurfaceHeightNodeOnly(null, lod, storeStats, statsLod, [node, [nodeCoords[0] + sx, nodeCoords[1], nodeCoords[2]]]);\n            var res3 = this.getSurfaceHeightNodeOnly(null, lod, storeStats, statsLod, [node, [nodeCoords[0], nodeCoords[1] + sy, nodeCoords[2]]]);\n            var res4 = this.getSurfaceHeightNodeOnly(null, lod, storeStats, statsLod, [node, [nodeCoords[0] + sx, nodeCoords[1] + sy, nodeCoords[2]]]);\n\n            var w0 = (res1[0] + (res2[0] - res1[0])*fx);\n            var w1 = (res3[0] + (res4[0] - res3[0])*fx);\n            height = (w0 + (w1 - w0)*fy);\n            \n            //console.log(\"h: \" + height + \"fx: \" + fx + \"fy: \" + fy + \"s1234: \" + res1[0] + \" \"  + res2[0] + \" \"  + res3[0] + \" \"  + res4[0]);            \n            /*\n            if (res1[4] && res2[4] && res3[4] && res4[4]){\n                console.log(\"h: \" + height + \"fx: \" + fx + \"fy: \" + fy + \"s1234: \" + JSON.stringify(res1[4].id) + \" \"  + JSON.stringify(res2[4].id) + \" \"  + JSON.stringify(res3[4].id) + \" \"  + JSON.stringify(res4[4].id));            \n            }*/\n\n            return [height, res1[1], res1[2], res1[3], null, arrayRes];                \n        } else {\n            return [res1[0], res1[1], res1[2], res1[3], null, arrayRes];                \n        }\n        //convert new coords to nav coords\n        //blend values\n    }\n\n    if (node != null && lod !== null) {\n        var root = tree.findSurfaceTile(node.id);\n\n        var extents = {\n            ll : node.extents.ll.slice(),\n            ur : node.extents.ur.slice()\n        };\n        var params = {\n            coords : nodeCoords,\n            desiredLod : Math.ceil(lod),\n            extents : extents,\n            metanode : null,\n            heightMap : null,\n            heightMapExtents : null,\n            traceHeight : true,\n            waitingForNode : false,\n            finalNode : false,\n            bestHeightMap : 999\n        };\n\n        tree.traceHeight(root, params, true);\n\n        var metanode = params.metanode, center, center2;\n\n        if (metanode != null) { // && metanode.id[0] == lod){\n\n            if (metanode.bbox.maxSize < 8000) { // use bbox only when bbox is reasonable small\n                center = metanode.bbox.center();\n                center = this.convert.convertCoords(center, 'physical', 'navigation');\n            } else {\n                center = [0,0,nodeCoords[2]];\n            }\n\n            //console.log(\"lod2: \" + lod + \" nodelod: \" + metanode.id[0] + \" h: \" + center[2]/1.55);  \n\n            if (storeStats) {\n                stats.heightClass = 1;\n                stats.heightLod = statsLod;\n                stats.heightNode = metanode.id[0];                        \n            }\n\n            if (this.config.mapHeightLodBlend && metanode.id[0] > 0 &&\n                params.parent && params.parent.metanode) {\n\n                if (params.parent.metanode.bbox.maxSize < 8000) { // use bbox only when bbox is reasonable small\n                    center2 = this.convert.convertCoords(params.parent.metanode.bbox.center(), 'physical', 'navigation');\n                } else {\n                    center2 = [0,0,nodeCoords[2]];\n                }\n\n                var factor = lod - Math.floor(lod);\n                height = center[2] + (center2[2] - center[2]) * factor;\n               \n                //extetnts = params.extents;\n                //return [height, true, true, params.extents, metanode, arrayRes];\n\n                return [height, (metanode.id[0] >= Math.floor(lod) || params.finalNode), \n                        (!params.waitingForNode || metanode.id[0] >= Math.floor(lod) || params.finalNode),\n                        params.extents, metanode, arrayRes];\n                                      \n\n                //console.log(\"lod: \" + lod + \" h1: \" + center[2] + \" h2: \" + center2[2] + \" h: \" + height);  \n            } else {\n                return [center[2], (metanode.id[0] >= Math.floor(lod) || params.finalNode), \n                        (!params.waitingForNode || metanode.id[0] >= Math.floor(lod) || params.finalNode),\n                        params.extents, metanode, arrayRes];\n\n                //return [center[2], true, true, params.extents, metanode, arrayRes];\n            }\n        }\n\n        /*\n        if (metanode != null) {\n            var height = metanode.minHeight + (metanode.maxHeight - metanode.minHeight) * 0.5;\n            return [height, metanode.id[0] >= lod, true];\n        }*/\n    }\n\n    //coords\n    //console.log(\"lod3: \" + lod + \" h: 0\");  \n\n    if (storeStats) {\n        stats.heightClass = 0;\n        stats.heightLod = statsLod;\n        stats.heightNode = 0;                        \n    }\n\n\n    return [0, false, false, null, null, arrayRes];\n};\n\n\nMapMeasure.prototype.getHeightmapValue = function(coords, node, params) {\n    var heightMap = params.heightMap;\n    var data = heightMap.getImageData();\n    var dataExtents = heightMap.getImageExtents();\n    var mapExtents = params.heightMapExtents;\n\n    //relative tile coords\n    var x = coords[0] - mapExtents.ll[0];\n    //var y = nodeCoords[1] - mapExtents.ll[1];\n    var y = mapExtents.ur[1] - coords[1];\n\n    var maxX = (dataExtents[0]-1);\n    var maxY = (dataExtents[1]-1);\n    \n    //data coords\n    x = (maxX) * (x / (mapExtents.ur[0] - mapExtents.ll[0]));\n    y = (maxY) * (y / (mapExtents.ur[1] - mapExtents.ll[1]));\n\n    if (x < 0) { x = 0; }\n    if (y < 0) { y = 0; }\n    if (x > maxX) { x = maxX; }\n    if (y > maxY) { y = maxY; }\n\n    var ix = Math.floor(x);\n    var iy = Math.floor(y);\n    var fx = x - ix;\n    var fy = y - iy;\n\n    var index = iy * dataExtents[0];\n    var index2 = (iy == maxY) ? index : index + dataExtents[0];\n    var ix2 = (ix == maxX) ? ix : ix + 1; \n    var h00 = data[(index + ix)*4];\n    var h01 = data[(index + ix2)*4];\n    var h10 = data[(index2 + ix)*4];\n    var h11 = data[(index2 + ix2)*4];\n    var w0 = (h00 + (h01 - h00)*fx);\n    var w1 = (h10 + (h11 - h10)*fx);\n    var height = (w0 + (w1 - w0)*fy);\n\n    height = node.minHeight + (node.maxHeight - node.minHeight) * (height/255);\n    \n    return height;\n};\n\n\nMapMeasure.prototype.getSpatialDivisionNode = function(coords) {\n    var nodes = this.map.referenceFrame.getSpatialDivisionNodes();\n\n    var bestNode = null;\n    var bestLod = -1;\n    var bestCoords = [0,0];\n\n    for (var i = 0, li = nodes.length; i < li; i++) {\n        var node = nodes[i];\n        var nodeCoords = node.getInnerCoords(coords);\n        var extents = node.extents;\n\n        if (nodeCoords[0] >= extents.ll[0] && nodeCoords[0] <= extents.ur[0] &&\n            nodeCoords[1] >= extents.ll[1] && nodeCoords[1] <= extents.ur[1]) {\n\n            if (node.id[0] > bestLod) {\n                bestNode = node;\n                bestLod = node.id[0];\n                bestCoords = nodeCoords;\n            }\n        }\n    }\n\n    return [bestNode, bestCoords];\n};\n\n\nMapMeasure.prototype.getSpatialDivisionNodeAndExtents = function(id) {\n    var nodes = this.map.referenceFrame.getSpatialDivisionNodes();\n\n    var bestNode = null;\n    //var bestLod = -1;\n    var bestNodeCoords = [0,0], shift;\n    //var bestExtents = {ll:[0,0], ur:[1,1]};\n\n    for (var i = 0, li = nodes.length; i < li; i++) {\n        var node = nodes[i];\n        \n        //has division node this tile node \n        //var shift = node.id[0] - this.lodRange[0];\n        shift = id[0] - node.id[0];\n\n        if (shift >= 0) {\n            var x = id[1] >> shift;\n            var y = id[2] >> shift;\n            \n            if (node.id[1] == x && node.id[2] == y) {\n                bestNode = node;\n                //bestLod = node.id[0];\n                //bestExtents = node.extents;\n                bestNodeCoords = [node.id[1] << shift, node.id[2] << shift];                \n            }\n        }\n    }\n    \n    if (!bestNode) {\n        return null;\n    }\n    \n    shift = id[0] - bestNode.id[0];\n    \n    var factor = 1.0 / Math.pow(2, shift);\n    var ur = bestNode.extents.ur;\n    var ll = bestNode.extents.ll;\n    \n    //extents ll ur but tiles are ul lr!!!! \n    \n    var dx = (ur[0] - ll[0]) * factor; \n    var dy = (ll[1] - ur[1]) * factor;\n    \n    var nx = id[1] - bestNodeCoords[0];\n    var ny = id[2] - bestNodeCoords[1];\n\n    return [bestNode, [[ll[0] + dx * nx, ur[1] + dy * ny], [ll[0] + dx * (nx+1), ur[1] + dy * (ny+1)] ]];\n};\n\n\nMapMeasure.prototype.getSpatialDivisionNodeFromId = function(id) {\n    var shift = id[0] - this.maxDivisionNodeDepth;\n    var nx = id[1] >> shift;\n    var ny = id[2] >> shift;\n    \n    return this.map.referenceFrame.nodesMap['' + this.maxDivisionNodeDepth + '.'  + nx + '.' + ny];\n};\n\n\nMapMeasure.prototype.getSpatialDivisionNodeAndExtents2 = function(id, res, divisionNode) {\n    if (!divisionNode) {\n        return [null, 0,0,0,0];\n    }\n    \n    var shift = id[0] - divisionNode.id[0];\n    var factor = 1.0 / Math.pow(2, shift);\n    var ur = divisionNode.extents.ur;\n    var ll = divisionNode.extents.ll;\n    \n    //extents ll ur but tiles are ul lr!!!! \n    \n    var dx = (ur[0] - ll[0]) * factor; \n    var dy = (ll[1] - ur[1]) * factor;\n    \n    var nx = id[1] - (divisionNode.id[1] << shift);\n    var ny = id[2] - (divisionNode.id[2] << shift);\n    \n    res[0] = divisionNode;\n    res[1] = ll[0] + dx * nx;\n    res[2] = ur[1] + dy * ny;\n    res[3] = ll[0] + dx * (nx+1);\n    res[4] = ur[1] + dy * (ny+1);\n};\n\n\nMapMeasure.prototype.getSpatialDivisionNodeDepths = function() {\n    var nodes = this.map.referenceFrame.getSpatialDivisionNodes();\n    var maxLod = -1;\n    var minLod = Number.MAX_VALUE;\n\n    for (var i = 0, li = nodes.length; i < li; i++) {\n        var node = nodes[i];\n\n        if (node.id[0] < minLod) {\n            minLod = node.id[0];\n        } \n        \n        if (node.id[0] > maxLod) {\n            maxLod = node.id[0];\n        } \n    }\n\n    return [minLod, maxLod];\n};\n\n\nMapMeasure.prototype.getOptimalHeightLodBySampleSize = function(coords, desiredSamplesSize) {\n    var result = this.getSpatialDivisionNode(coords);\n    var node = result[0];\n\n    if (node != null) {\n        var nodeLod = node.id[0];\n        var nodeExtent = node.extents.ur[1] - node.extents.ll[1];\n\n        var lod = Math.log(nodeExtent / desiredSamplesSize) / Math.log(2);\n        //lod = Math.round(lod) - 8 + nodeLod;\n        lod = lod - 8 + nodeLod;\n\n        return Math.max(0, lod);\n    }\n\n    return null;\n};\n\n\nMapMeasure.prototype.getOptimalHeightLod = function(coords, viewExtent, desiredSamplesPerViewExtent) {\n    var result = this.getSpatialDivisionNode(coords);\n    var node = result[0];\n\n    if (node != null) {\n        var nodeLod = node.id[0];\n        var nodeExtent = node.extents.ur[1] - node.extents.ll[1];\n\n        var lod = Math.log((desiredSamplesPerViewExtent * nodeExtent) / viewExtent) / Math.log(2);\n        //lod = Math.round(lod) - 8 + nodeLod;\n        lod = lod - 8 + nodeLod;\n\n        return Math.max(0, lod);\n    }\n\n    return null;\n};\n\n\nMapMeasure.prototype.getDistance = function(coords, coords2, includingHeight, usePublic) {\n    var sourceSrs = usePublic ? this.publicSrs : this.navigationSrs;\n    var p1 = this.getPhysicalSrs.convertCoordsFrom(coords,  sourceSrs);\n    var p2 = this.getPhysicalSrs.convertCoordsFrom(coords2, sourceSrs);\n    var d = 0;\n\n    var dx = p2[0] - p1[0];\n    var dy = p2[1] - p1[1];\n    var dz = p2[2] - p1[2];\n\n    var dd = Math.sqrt(dx*dx + dy*dy + dz*dz);\n    var navigationSrsInfo = this.navigationSrsInfo;\n\n    if (!this.isProjected) {\n        var geod = this.getGeodesic(); //new GeographicLib[\"Geodesic\"][\"Geodesic\"](navigationSrsInfo[\"a\"],\n                                       //                   (navigationSrsInfo[\"a\"] / navigationSrsInfo[\"b\"]) - 1.0);\n\n        var r = geod.Inverse(coords[1], coords[0], coords2[1], coords2[0]);\n\n        if (r.s12 > (navigationSrsInfo['a'] * 2 * Math.PI) / 4007.5) { //aprox 10km for earth\n            if (includingHeight) {\n                return [Math.sqrt(r.s12*r.s12 + dz*dz), -r.azi1, dd];\n            } else {\n                return [r.s12, -r.azi1, dd];\n            }\n        } else {\n            if (includingHeight) {\n                return [Math.sqrt(dx*dx + dy*dy + dz*dz), -r.azi1, dd];\n            } else {\n                return [r.s12, -r.azi1, dd];\n            }\n        }\n\n    } else {\n        return [Math.sqrt(dx*dx + dy*dy), math.degrees(Math.atan2(dx, dy)), dd];\n    }\n};\n\n\nMapMeasure.prototype.getGeodesic = function() {\n    var navigationSrsInfo = this.navigationSrsInfo;\n\n    var geodesic = new GeographicLib.Geodesic.Geodesic(navigationSrsInfo['a'],\n                                                      (navigationSrsInfo['a'] / navigationSrsInfo['b']) - 1.0);\n\n    return geodesic;\n};\n\n\nMapMeasure.prototype.getAzimuthCorrection = function(coords, coords2) {\n    if (!this.getNavigationSrs().isProjected()) {\n        var geodesic = this.getGeodesic();\n        var r = geodesic.Inverse(coords[0], coords[1], coords2[0], coords2[1]);\n        var ret = (r.azi1 - r.azi2);\n        if (isNaN(ret)) {\n            ret = 0;\n        } \n        return ret; \n    }\n    return 0;\n};\n\n\nMapMeasure.prototype.getNED = function(coords) {\n    var centerCoords = this.convert.convertCoords([coords[0], coords[1], 0], 'navigation', 'physical');\n    var upCoords, rightCoords;\n\n    if (this.isProjected) {\n        upCoords = this.convert.convertCoords([coords[0], coords[1] + 100, 0], 'navigation', 'physical');\n        rightCoords = this.convert.convertCoords([coords[0] + 100, coords[1], 0], 'navigation', 'physical');\n    } else {\n        var cy = (coords[1] + 90) - 0.0001;\n        var cx = (coords[0] + 180) + 0.0001;\n\n        if (cy < 0 || cx > 180) { //if we are out of bounds things start to be complicated\n            var geodesic = this.getGeodesic();\n        \n            //up coords\n            var r = geodesic.Direct(coords[1], coords[0], 0, -100);\n            upCoords = this.convert.convertCoords([r.lon2, r.lat2, 0], 'navigation', 'physical');\n    \n            //right coords\n            r = geodesic.Direct(coords[1], coords[0], 90, 100);\n            rightCoords = this.convert.convertCoords([r.lon2, r.lat2, 0], 'navigation', 'physical');\n        } else {\n            // substraction instead of addition is probably case of complicated view matrix calculation\n            upCoords = this.convert.convertCoords([coords[0], coords[1] - 0.0001, 0], 'navigation', 'physical');\n            rightCoords = this.convert.convertCoords([coords[0] + 0.0001, coords[1], 0], 'navigation', 'physical');\n        }\n    }\n\n    var up = [upCoords[0] - centerCoords[0],\n        upCoords[1] - centerCoords[1],\n        upCoords[2] - centerCoords[2]]; \n\n    var right = [rightCoords[0] - centerCoords[0],\n        rightCoords[1] - centerCoords[1],\n        rightCoords[2] - centerCoords[2]]; \n\n    var dir = [0,0,0];\n    vec3.normalize(up);\n    vec3.normalize(right);\n    vec3.cross(up, right, dir);\n    vec3.normalize(dir);\n\n    return {\n        east  : right, \n        direction : up,\n        north : dir        \n    };\n};\n\nMapMeasure.prototype.getNewNED = function(coords, returnMatrix) {\n    var centerCoords = this.convert.convertCoords([coords[0], coords[1], 0], 'navigation', 'physical');\n    var upCoords, rightCoords;\n\n    if (this.isProjected) {\n        upCoords = this.convert.convertCoords([coords[0], coords[1] + 100, 0], 'navigation', 'physical');\n        rightCoords = this.convert.convertCoords([coords[0] + 100, coords[1], 0], 'navigation', 'physical');\n    } else {\n        //get NED for latlon coordinates\n        //http://www.mathworks.com/help/aeroblks/directioncosinematrixeceftoned.html\n        /*        \n        var coords = this.position.getCoords();\n        var lon = math.radians(coords[0]);\n        var lat = math.radians(coords[1]);\n\n        //NED vectors for sphere\n        var east = [-Math.sin(lat)*Math.cos(lon), -Math.sin(lat)*Math.sin(lon), Math.cos(lat)];\n        var direction = [-Math.sin(lon), Math.cos(lon), 0];\n        var north = [-Math.cos(lat)*Math.cos(lon), -Math.cos(lat)*Math.sin(lon), -Math.sin(lat)];\n\n        north = vec3.negate(north);\n        east  = vec3.negate(east);\n        \n        //get elipsoid factor\n        var navigationSrsInfo = this.getNavigationSrs().getSrsInfo();\n        var factor = navigationSrsInfo[\"b\"] / navigationSrsInfo[\"a\"];\n\n        //flaten vectors\n        north[2] *= factor;\n        east[2] *= factor;\n        direction[2] *= factor;\n\n        //normalize vectors\n        north = vec3.normalize(north);\n        east  = vec3.normalize(east);\n        direction = vec3.normalize(direction);\n        */\n\n        var cy = (coords[1] + 90) + 0.0001;\n        var cx = (coords[0] + 180) + 0.0001;\n\n        if (cy < 0 || cx > 180) { //if we are out of bounds things start to be complicated\n            var geodesic = this.getGeodesic();\n        \n            //up coords\n            var r = geodesic.Direct(coords[1], coords[0], 0, -100);\n            upCoords = this.convert.convertCoords([r.lon2, r.lat2, 0], 'navigation', 'physical');\n    \n            //right coords\n            r = geodesic.Direct(coords[1], coords[0], 90, -100);\n            rightCoords = this.convert.convertCoords([r.lon2, r.lat2, 0], 'navigation', 'physical');\n        } else {\n            // substraction instead of addition is probably case of complicated view matrix calculation\n            upCoords = this.convert.convertCoords([coords[0], coords[1] + 0.0001, 0], 'navigation', 'physical');\n            rightCoords = this.convert.convertCoords([coords[0] + 0.0001, coords[1], 0], 'navigation', 'physical');\n        }\n    }\n\n    var up = [upCoords[0] - centerCoords[0],\n        upCoords[1] - centerCoords[1],\n        upCoords[2] - centerCoords[2]]; \n\n    var right = [rightCoords[0] - centerCoords[0],\n        rightCoords[1] - centerCoords[1],\n        rightCoords[2] - centerCoords[2]]; \n\n    var dir = [0,0,0];\n    vec3.normalize(up);\n    vec3.normalize(right);\n    vec3.cross(up, right, dir);\n    vec3.normalize(dir);\n\n    if (returnMatrix) {\n        var east = right;\n        var direction = up;\n        var north = dir;\n\n        return [\n            east[0], east[1], east[2], 0,\n            north[0], north[1], north[2], 0,\n            direction[0], direction[1], direction[2], 0,\n            0, 0, 0, 1\n        ];        \n    }\n\n    return {\n        east  : right, \n        direction : up,\n        north : dir        \n    };\n};\n\n//TODO: use getNewNED \nMapMeasure.prototype.getPositionCameraInfo = function(position, projected, clampTilt) {\n    //var position = [0,0,0];\n    var orientation = position.getOrientation();\n    var distance = position.getViewDistance();\n    \n    if (clampTilt) { //used for street labels\n        orientation[1] = math.clamp(orientation[1], -89.0, 90.0);\n    }\n\n    var roty = math.clamp(orientation[1], -89.5, 89.5);\n\n    var tmpMatrix = mat4.create();\n    mat4.multiply(math.rotationMatrix(2, math.radians(-orientation[0])), math.rotationMatrix(0, math.radians(roty)), tmpMatrix);\n    var orbitPos, ned, north, east, direction, spaceMatrix, rotationMatrix;\n    var east2, north2, direction2, dir, up, right;\n\n    if (position.getViewMode() == 'obj') {\n        orbitPos = [0, -distance, 0];\n        mat4.multiplyVec3(tmpMatrix, orbitPos);\n    } else {\n        orbitPos = [0, 0, 0];\n    }\n\n    //this.cameraVector = [0, 0, 1];\n    //mat4.multiplyVec3(this.updateCameraMatrix, this.cameraVector);\n\n    var ret = {\n        orbitCoords : null,\n        distance : distance,\n        rotMatrix : null,\n        vector : null,\n        orbitHeight : orbitPos[2]  \n    };\n\n    var coords = position.getCoords();\n\n    if (projected) {\n        \n        tmpMatrix = mat4.create();\n        mat4.multiply(math.rotationMatrix(0, math.radians(-roty - 90.0)), math.rotationMatrix(2, math.radians(orientation[0])), tmpMatrix);\n\n        ned = this.getNED(coords);\n        north = ned.north;\n        east  = ned.east;\n        direction = ned.direction;\n\n        spaceMatrix = [\n            east[0], east[1], east[2], 0,\n            direction[0], direction[1], direction[2], 0,\n            north[0], north[1], north[2], 0,\n            0, 0, 0, 1\n        ];\n        \n        east2  = [1,0,0];\n        direction2 = [0,1,0];\n        north2 = [0,0,1];\n\n        dir = [1,0,0];\n        up = [0,0,-1];\n        right = [0,0,0];\n        vec3.cross(dir, up, right);\n\n        //rotate vectors according to eulers\n        mat4.multiplyVec3(tmpMatrix, north2);\n        mat4.multiplyVec3(tmpMatrix, east2);\n        mat4.multiplyVec3(tmpMatrix, direction2);\n\n        mat4.multiplyVec3(tmpMatrix, dir);\n        mat4.multiplyVec3(tmpMatrix, up);\n        mat4.multiplyVec3(tmpMatrix, right);\n\n        var t = 0;\n        t = dir[0]; dir[0] = dir[1]; dir[1] = t;\n        t = up[0]; up[0] = up[1]; up[1] = t;\n        t = right[0]; right[0] = right[1]; right[1] = t;\n        \n        dir[2] = -dir[2];\n        up[2] = -up[2];\n        right[2] = -right[2];\n\n        /*\n        mat4.multiplyVec3(spaceMatrix, north2);\n        mat4.multiplyVec3(spaceMatrix, east2);\n        mat4.multiplyVec3(spaceMatrix, direction2);\n        */\n\n        //get rotation matrix\n        rotationMatrix = [\n            east2[0], east2[1], east2[2], 0,\n            direction2[0], direction2[1], direction2[2], 0,\n            north2[0], north2[1], north2[2], 0,\n            0, 0, 0, 1\n        ];\n\n       // mat4.multiplyVec3(spaceMatrix, orbitPos);\n/*\n        //get rotation matrix\n        var rotationMatrix = [\n            east[0], east[1], east[2], 0,\n            direction[0], direction[1], direction[2], 0,\n            north[0], north[1], north[2], 0,\n            0, 0, 0, 1\n        ];\n*/\n        ret.vector = vec3.normalize([-orbitPos[0], -orbitPos[1], -orbitPos[2]]); \n        ret.vector2 = ret.vector; //vector2 is probably hack for tree.js bboxVisible \n        \n        ret.orbitCoords = orbitPos;\n        ret.rotMatrix = rotationMatrix; \n\n    } else { //geographics\n\n      \n        ned = this.getNED(coords);\n        north = ned.north;\n        east  = ned.east;\n        direction = ned.direction;\n        \n\n        spaceMatrix = [\n            east[0], east[1], east[2], 0,\n            direction[0], direction[1], direction[2], 0,\n            north[0], north[1], north[2], 0,\n            0, 0, 0, 1\n        ];\n        \n        //spaceMatrix = mat4.inverse(spaceMatrix);\n        \n        var localRotMatrix = mat4.create();\n        mat4.multiply(math.rotationMatrix(0, math.radians(-roty - 90.0)), math.rotationMatrix(2, math.radians(orientation[0])), localRotMatrix);\n\n        east2  = [1,0,0];\n        direction2 = [0,1,0];\n        north2 = [0,0,1];\n\n        coords = position.getCoords();\n        var latlonMatrix = mat4.create();\n        mat4.multiply(math.rotationMatrix(0, math.radians((coords[1] - 90.0))), math.rotationMatrix(2, math.radians((-coords[0]-90))), latlonMatrix);\n//      mat4.multiply(math.rotationMatrix(2, math.radians((coords[0]-90))), math.rotationMatrix(0, math.radians((coords[1] - 90.0))), latlonMatrix);\n\n\n        //mat4.multiply(math.rotationMatrix(0, math.radians(0)), math.rotationMatrix(2, math.radians(-(coords[0]+90))), latlonMatrix);\n        //mat4.multiply(math.rotationMatrix(0, math.radians(0)), math.rotationMatrix(2, math.radians(0)), latlonMatrix);\n\n        //rotate vectors according to latlon\n        mat4.multiplyVec3(latlonMatrix, north2);\n        mat4.multiplyVec3(latlonMatrix, east2);\n        mat4.multiplyVec3(latlonMatrix, direction2);\n\n\n        spaceMatrix = [\n            east2[0], east2[1], east2[2], 0,\n            direction2[0], direction2[1], direction2[2], 0,\n            north2[0], north2[1], north2[2], 0,\n            0, 0, 0, 1\n        ];\n\n        right = [1,0,0];\n        dir = [0,1,0];\n        up = [0,0,1];\n        //vec3.cross(dir, up, right);\n\n        //rotate vectors according to eulers\n        //mat4.multiplyVec3(this.updateCameraMatrix, north2);\n        //mat4.multiplyVec3(this.updateCameraMatrix, east2);\n        //mat4.multiplyVec3(this.updateCameraMatrix, direction2);\n\n        mat4.multiplyVec3(spaceMatrix, dir);\n        mat4.multiplyVec3(spaceMatrix, up);\n        mat4.multiplyVec3(spaceMatrix, right);\n\n        mat4.multiplyVec3(localRotMatrix, right);\n        mat4.multiplyVec3(localRotMatrix, dir);\n        mat4.multiplyVec3(localRotMatrix, up);\n        \n        //mat4.multiplyVec3(spaceMatrix, north2);\n        //mat4.multiplyVec3(spaceMatrix, east2);\n        //mat4.multiplyVec3(spaceMatrix, direction2);\n\n\n        //get rotation matrix\n/*        \n        var rotationMatrix = [\n            east2[0], east2[1], east2[2], 0,\n            direction2[0], direction2[1], direction2[2], 0,\n            north2[0], north2[1], north2[2], 0,\n            0, 0, 0, 1\n        ];\n*/        \n\n        rotationMatrix = [\n            right[0], right[1], right[2], 0,\n            dir[0], dir[1], dir[2], 0,\n            up[0], up[1], up[2], 0,\n            0, 0, 0, 1\n        ];\n\n        //get orbit pos\n        spaceMatrix = mat4.inverse(spaceMatrix);\n        mat4.multiplyVec3(spaceMatrix, orbitPos);\n\n        //ret.vector2 = [-spaceMatrix[8], -spaceMatrix[9], -spaceMatrix[10]]; //vector2 is probably hack for tree.js bboxVisible \n        ret.vector = [-rotationMatrix[2], -rotationMatrix[6], -rotationMatrix[10]];\n\n        //var ray = this.map.renderer.getScreenRay(800,400);\n\n        //get camera direction\n        //mat4.inverse(rotationMatrix, spaceMatrix);\n        //ret.vector = [-spaceMatrix[8], -spaceMatrix[9], -spaceMatrix[10]]; \n        \n        //console.log(\"cam vec: \" + JSON.stringify(this.cameraVector));\n         \n        //this.position.setHeight(0); !!!!!!!!!!!!!!!\n    }\n\n    ret.orbitCoords = orbitPos;\n    ret.rotMatrix = rotationMatrix;\n    return ret; \n};\n\n\nexport default MapMeasure;\n\n","\nimport {vec3 as vec3_, mat4 as mat4_} from '../../utils/matrix';\nimport BBox_ from '../bbox';\nimport {math as math_} from '../../utils/math';\nimport {utils as utils_} from '../../utils/utils';\nimport MapResourceNode_ from '../../map/resource-node';\n\n//get rid of compiler mess\nvar vec3 = vec3_, mat4 = mat4_;\nvar BBox = BBox_;\nvar math = math_;\nvar utils = utils_;\nvar MapResourceNode = MapResourceNode_;\n\n\nvar GpuGroup = function(id, bbox, origin, gpu, renderer) {\n    this.id = id;\n    this.bbox = null;\n    this.origin = origin || [0,0,0];\n    this.gpu = gpu;\n    this.gl = gpu.gl;\n    this.renderer = renderer;\n    this.jobs = [];\n    this.reduced = 0;\n    this.geometries = {};\n    this.subjob = null;\n    this.mv = new Float32Array(16);\n    this.mvp = new Float32Array(16);\n    this.loadMode = 0;\n    //this.geFactor = 1/38;\n    this.geFactor = 1/16;\n    this.geNormalized = false;\n\n    if (bbox != null && bbox[0] != null && bbox[1] != null) {\n        this.bbox = new BBox(bbox[0][0], bbox[0][1], bbox[0][2], bbox[1][0], bbox[1][1], bbox[1][2]);\n    }\n\n    this.size = 0;\n    this.polygons = 0;\n};\n\n//destructor\nGpuGroup.prototype.kill = function() {\n    for (var i = 0, li = this.jobs.length; i < li; i++) {\n        var job = this.jobs[i]; \n\n        switch(job.type) {\n        case VTS_JOB_FLAT_LINE:\n        case VTS_JOB_POLYGON:\n            if (job.vertexPositionBuffer) this.gl.deleteBuffer(job.vertexPositionBuffer);\n            if (job.vertexElementBuffer) this.gl.deleteBuffer(job.vertexElementBuffer);\n            break;\n\n        case VTS_JOB_FLAT_TLINE:\n        case VTS_JOB_FLAT_RLINE:\n        case VTS_JOB_PIXEL_LINE:\n        case VTS_JOB_PIXEL_TLINE:\n            if (job.vertexPositionBuffer) this.gl.deleteBuffer(job.vertexPositionBuffer);\n            if (job.vertexNormalBuffer) this.gl.deleteBuffer(job.vertexNormalBuffer);\n            if (job.vertexElementBuffer) this.gl.deleteBuffer(job.vertexElementBuffer);\n            break;\n\n        case VTS_JOB_LINE_LABEL:\n            if (job.vertexPositionBuffer) this.gl.deleteBuffer(job.vertexPositionBuffer);\n            if (job.vertexTexcoordBuffer) this.gl.deleteBuffer(job.vertexTexcoordBuffer);\n            if (job.vertexElementBuffer) this.gl.deleteBuffer(job.vertexElementBuffer);\n            break;\n\n        case VTS_JOB_ICON:\n        case VTS_JOB_LABEL:\n            if (job.vertexPositionBuffer) this.gl.deleteBuffer(job.vertexPositionBuffer);\n            if (job.vertexTexcoordBuffer) this.gl.deleteBuffer(job.vertexTexcoordBuffer);\n            if (job.vertexOriginBuffer) this.gl.deleteBuffer(job.vertexOriginBuffer);\n            if (job.vertexElementBuffer) this.gl.deleteBuffer(job.vertexElementBuffer);\n            break;\n        }\n    }\n\n    //remove geometries\n    for (var key in this.geometries) {\n        var geometries = this.geometries[key];\n        var globalGeometry = this.renderer.geometries[key];\n        this.geometries[key] = null;\n\n        //remove geometry from glbal stack\n        for (i = 0, li = geometries.length; i < li; i++) {\n            if (geometries[i] == globalGeometry) {\n                this.renderer.geometries[key] = null;\n            }\n        }\n    }\n};\n\n\nGpuGroup.prototype.getSize = function() {\n    return this.size;\n};\n\n\nGpuGroup.prototype.getZbufferOffset = function() {\n    return this.size;\n};\n\nGpuGroup.prototype.addGeometry = function(data) {\n    var id = data['id'];\n\n    if (!this.geometries[id]) {\n        this.geometries[id] = [data];\n    } else {\n        this.geometries[id].push(data);\n    }\n\n    this.renderer.geometries[id] = data;\n};\n\nGpuGroup.prototype.convertColor = function(c) {\n    var f = 1.0/255;\n    return [c[0]*f, c[1]*f, c[2]*f, c[3]*f];\n};\n\nGpuGroup.prototype.addLineJob = function(data) {\n    var gl = this.gl;\n\n    var vertices = data.vertexBuffer;\n\n    var job = {};\n\n    if (data.type == VTS_WORKER_TYPE_POLYGON) {\n        job.type = VTS_JOB_POLYGON;\n    } else {\n        job.type = VTS_JOB_FLAT_LINE;\n    }\n\n    job.program = this.renderer.progLine;\n    job.color = this.convertColor(data['color']);\n    job.zIndex = data['z-index'] + 256;\n    job.clickEvent = data['click-event'];\n    job.hoverEvent = data['hover-event'];\n    job.enterEvent = data['enter-event'];\n    job.leaveEvent = data['leave-event'];\n    job.advancedHit = data['advancedHit'];\n    job.hitable = data['hitable'];\n    job.eventInfo = data['eventInfo'];\n    job.style = data['style'] || 0;\n    job.stencil = (data['stencil'] === false) ? false : true;\n    job.culling = data['culling'] || 0;\n    job.state = data['state'];\n    job.center = data['center'];\n    job.lod = data['lod'];\n    job.lineWidth = data['line-width'];\n    job.zbufferOffset = data['zbuffer-offset'];\n    job.reduced = false;\n    job.ready = true;\n    job.bbox = this.bbox;\n\n    if (!job.program.isReady()) {\n        return;\n    }\n\n    if (job.advancedHit) {\n        job.program2 = this.renderer.progELine;\n\n        if (!job.program2.isReady()) {\n            return;\n        }\n    }\n\n    //create vertex buffer\n    job.vertexPositionBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexPositionBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n    job.vertexPositionBuffer.itemSize = 3;\n    job.vertexPositionBuffer.numItems = vertices.length / 3;\n\n    if (job.advancedHit) {\n        job.program = this.renderer.progLine;\n\n        var elements = data.elementBuffer;\n\n        job.vertexElementBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexElementBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, elements, gl.STATIC_DRAW);\n        job.vertexElementBuffer.itemSize = 1;\n        job.vertexElementBuffer.numItems = elements.length;\n    }\n\n    this.jobs.push(job);\n\n    this.size += vertices.length * 4;\n    this.polygons += vertices.length / (3 * 3);\n};\n\n\nGpuGroup.prototype.addExtentedLineJob = function(data) {\n    var gl = this.gl;\n\n    var vertices = data.vertexBuffer;\n    var normals = data.normalBuffer;\n\n    var job = {};\n    job.type = data['type'];\n\n    \n    switch(job.type) {\n    case VTS_WORKER_TYPE_FLAT_LINE:  job.type = VTS_JOB_FLAT_TLINE;  break;\n    case VTS_WORKER_TYPE_FLAT_RLINE:  job.type = VTS_JOB_FLAT_RLINE;  break;\n    case VTS_WORKER_TYPE_PIXEL_LINE:  job.type = VTS_JOB_PIXEL_LINE;  break;\n    case VTS_WORKER_TYPE_PIXEL_TLINE: job.type = VTS_JOB_PIXEL_TLINE; break;\n    }\n\n    job.color = this.convertColor(data['color']);\n    job.zIndex = data['z-index'] + 256;\n    job.clickEvent = data['click-event'];\n    job.hoverEvent = data['hover-event'];\n    job.hitable = data['hitable'];\n    job.eventInfo = data['eventInfo'];\n    job.enterEvent = data['enter-event'];\n    job.leaveEvent = data['leave-event'];\n    job.advancedHit = data['advancedHit'];\n    job.widthByRatio = data['width-units'] == 'ratio',\n    job.state = data['state'];\n    job.center = data['center'];\n    job.lod = data['lod'];\n    job.lineWidth = data['line-width'];\n    job.zbufferOffset = data['zbuffer-offset'];\n    job.reduced = false;\n    job.ready = true;\n    job.bbox = this.bbox;\n\n    if (data['texture'] != null) {\n        var texture = data['texture'];\n        var bitmap = texture[0];\n        job.texture = [this.renderer.getBitmap(bitmap['url'], bitmap['filter'] || 'linear', bitmap['tiled'] || false),\n            texture[1], texture[2], texture[3], texture[4]];\n        var background = this.convertColor(data['background']);\n\n        if (background[3] != 0) {\n            job.background = background;\n        }\n    }\n\n    switch(job.type) {\n    case VTS_JOB_FLAT_TLINE:   job.program = (background[3] != 0) ? this.renderer.progTBLine : this.renderer.progTLine;  break;\n    case VTS_JOB_FLAT_RLINE:   job.program = this.renderer.progRLine;  break;\n    case VTS_JOB_PIXEL_LINE:   job.program = this.renderer.progLine3;  break;\n    case VTS_JOB_PIXEL_TLINE:  job.program = (background[3] != 0) ? this.renderer.progTPBLine : this.renderer.progTPLine; break;\n    }\n\n    if (!job.program.isReady()) {\n        return;\n    }\n\n    if (job.advancedHit) {\n        switch(job.type) {\n        case VTS_JOB_FLAT_TLINE:   job.program2 = this.renderer.progETLine;  break;\n        case VTS_JOB_FLAT_RLINE:   job.program2 = this.renderer.progERLine;  break;\n        case VTS_JOB_PIXEL_LINE:   job.program2 = this.renderer.progELine3;  break;\n        case VTS_JOB_PIXEL_TLINE:  job.program2 = this.renderer.progETPLine; break;\n        }\n\n        if (!job.program2.isReady()) {\n            return;\n        }\n    }\n\n    //create vertex buffer\n    job.vertexPositionBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexPositionBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n    job.vertexPositionBuffer.itemSize = 4;\n    job.vertexPositionBuffer.numItems = vertices.length / 4;\n\n    //create normal buffer\n    job.vertexNormalBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexNormalBuffer);\n    gl.bufferData(gl.ARRAY_BUFFER, normals, gl.STATIC_DRAW);\n    job.vertexNormalBuffer.itemSize = 4;\n    job.vertexNormalBuffer.numItems = normals.length / 4;\n\n    if (job.advancedHit) {\n        var elements = data.elementBuffer;\n\n        job.vertexElementBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexElementBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, elements, gl.STATIC_DRAW);\n        job.vertexElementBuffer.itemSize = 1;\n        job.vertexElementBuffer.numItems = elements.length;\n    }\n\n    this.jobs.push(job);\n\n    this.size += vertices.length * 4 + normals.length * 4;\n    this.polygons += vertices.length / (4 * 3);\n};\n\n\nGpuGroup.prototype.processReduce = function(job) {\n    if (job.reduce) {\n        switch(job.reduce[0]) {\n            case 'tilt':       job.reduce[0] = 1; break;\n            case 'tilt-cos':   job.reduce[0] = 2; break;\n            case 'tilt-cos2':  job.reduce[0] = 3; break;\n            case 'scr-count':  job.reduce[0] = 4; break;\n            case 'scr-count2': job.reduce[0] = 5; this.renderer.drawnGeodataTilesUsed = true; break;\n            case 'scr-count3': job.reduce[0] = 6; this.renderer.drawnGeodataTilesUsed = true; break;\n            case 'scr-count4': job.reduce[0] = 7; break;\n            case 'scr-count5': job.reduce[0] = 8; break;\n            case 'scr-count6': job.reduce[0] = 9; break;\n            case 'scr-count7': job.reduce[0] = 10; break;\n            case 'scr-count8': job.reduce[0] = 11; break;\n        }\n\n        job.reduce[5] = 0; //zero debug value\n        job.reduce[6] = 0;\n        job.reduce[7] = 0;\n\n        if (job.reduce[0] >= 7 && job.reduce[0] <= 11) {\n\n            if (job.reduce[0] == 10 || job.reduce[0] == 11) {\n                job.reduce[1] = Math.abs(job.reduce[1]);\n                job.reduce[3] = job.reduce[1] * job.reduce[2];\n                job.reduce[2] = job.reduce[1];\n                job.reduce[4] = 0;\n            } else {\n                job.reduce[2] = Math.abs(job.reduce[1]); //copy prominence for prom / dist support\n\n                if (this.renderer.config.mapFeaturesReduceFactor >= 1) { // prom / dists\n                    job.reduce[1] = job.reduce[2];\n                } else {\n                    if (job.reduce[0] == 9) {\n                        job.reduce[1] = job.reduce[2];\n                    } else {\n                        job.reduce[1] = Math.floor((Math.log(job.reduce[2] * 500) / Math.log(1.0017)) + 5000);\n                    }\n                }\n            }\n        }\n    }\n};\n\n\nGpuGroup.prototype.addLineLabelJob = function(data) {\n    var gl = this.gl;\n\n    if (data.singleBuffer) {\n        var singleBuffer = data.singleBuffer;\n        var singleBuffer2 = data.singleBuffer2;\n    } else {\n        var vertices = data.vertexBuffer;\n        var texcoords = data.texcoordsBuffer;\n    }\n\n    var job = {};\n    job.type = VTS_JOB_LINE_LABEL;\n    job.program = this.renderer.progText;\n    job.color = this.convertColor(data['color']);\n    job.color2 = this.convertColor(data['color2']);\n    job.outline = data['outline'];\n    job.zIndex = data['z-index'] + 256;\n    job.visibility = data['visibility'];\n    job.culling = data['culling'];\n    job.clickEvent = data['click-event'];\n    job.hoverEvent = data['hover-event'];\n    job.enterEvent = data['enter-event'];\n    job.leaveEvent = data['leave-event'];\n    job.hitable = data['hitable'];\n    job.eventInfo = data['eventInfo'];\n    job.state = data['state'];\n    job.center = data['center'];\n    job.lod = data['lod'];\n    job.labelPoints = data['labelPoints'];\n    job.labelIndex = data['labelIndex'];\n    job.labelSize = data['labelSize'];\n    job.zbufferOffset = data['zbuffer-offset'];\n    job.hysteresis = data['hysteresis'];\n    job.noOverlap = data['noOverlap'];\n    job.labelPointsBuffer = { id: -1, points: [], points2: [] },\n    job.id = job.hysteresis ? job.hysteresis[2] : null;\n    job.reduced = false;\n    job.ready = true;\n    job.bbox = this.bbox;\n    job.reduce = data['reduce'];\n\n    this.processReduce(job);\n    \n    job.files = data['files'] || [];\n    var fonts = data['fonts'] || ['#default'];\n    job.fonts = fonts;\n\n    for (var i = 0, li = fonts.length; i < li; i++) {\n        fonts[i] = this.renderer.fonts[fonts[i]];\n    }\n\n    job.program = this.renderer.progText2;\n\n    if (!job.program.isReady()) {\n        return;\n    }\n\n    if (singleBuffer) {\n\n        job.singleBuffer = singleBuffer;\n        job.singleBuffer2 = singleBuffer2;\n        job.textVector = data['textVector'];\n\n        //this.size += vertices.length * 4 + texcoords.length * 4;\n        this.polygons += (singleBuffer.length / 12) * 2;\n\n    } else {\n        //create vertex buffer\n        job.vertexPositionBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexPositionBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n        job.vertexPositionBuffer.itemSize = 4;\n        job.vertexPositionBuffer.numItems = vertices.length / 4;\n\n        //create normal buffer\n        job.vertexTexcoordBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexTexcoordBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, texcoords, gl.STATIC_DRAW);\n        job.vertexTexcoordBuffer.itemSize = 4;\n        job.vertexTexcoordBuffer.numItems = texcoords.length / 4;\n\n        this.size += vertices.length * 4 + texcoords.length * 4;\n        this.polygons += vertices.length / (4 * 3);\n    }\n\n    this.jobs.push(job);\n};\n\n\nGpuGroup.prototype.addIconJob = function(data, label, tile) {\n    var gl = this.gl;\n\n    var vertices = data.vertexBuffer;\n    var texcoords = data.texcoordsBuffer;\n    var origins = data.originBuffer;\n    var singleBuffer = data.singleBuffer;\n    var s = data['stick'];\n    var f = 1.0/255;\n\n    var job = { tile: tile };\n    job.type = label ? VTS_JOB_LABEL : VTS_JOB_ICON;\n    job.program = this.renderer.progIcon;\n    job.color = this.convertColor(data['color']);\n    job.zIndex = data['z-index'] + 256;\n    job.visibility = data['visibility'];\n    job.culling = data['culling'];\n    job.clickEvent = data['click-event'];\n    job.hoverEvent = data['hover-event'];\n    job.enterEvent = data['enter-event'];\n    job.leaveEvent = data['leave-event'];\n    job.hitable = data['hitable'];\n    job.eventInfo = data['eventInfo'];\n    job.state = data['state'];\n    job.center = data['center'];\n    job.stick = [s[0], s[1], s[2], s[3]*f, s[4]*f, s[5]*f, s[6]*f, s[7]];\n    job.lod = data['lod'];\n    job.zbufferOffset = data['zbuffer-offset'];\n    job.hysteresis = data['hysteresis'];\n    job.noOverlap = data['noOverlap'];\n    job.id = job.hysteresis ? job.hysteresis[2] : null;\n    job.reduced = false;\n    job.ready = true;\n    job.reduce = data['reduce'];\n\n    this.processReduce(job);\n\n    if (!job.program.isReady()) {\n        return;\n    }\n\n    if (label !== true) {\n        var icon = data['icon'];\n        job.texture = this.renderer.getBitmap(null, icon['filter'] || 'linear', icon['tiled'] || false, icon['hash'], true);\n        job.files = [];\n    } else {\n        job.color2 = this.convertColor(data['color2']);\n        job.outline = data['outline'];\n        job.size = data['size'];\n        job.origin = data['origin'];\n        job.files = data['files'] || [];\n        job.index = data['index'] || 0;\n        var fonts = data['fonts'] || ['#default'];\n        job.fonts = fonts;\n        job.gamma = [job.outline[2] * 1.4142 / job.size, job.outline[3] * 1.4142 / job.size];\n\n        if (job.origin) {\n            job.origin = new Float32Array(job.origin);\n        }\n\n        for (var i = 0, li = fonts.length; i < li; i++) {\n            fonts[i] = this.renderer.fonts[fonts[i]];\n        }\n\n        job.program = this.renderer.progIcon2;\n    }\n\n    if (job.visibility != null && !Array.isArray(job.visibility)) {\n        job.visibility = [job.visibility];\n    }\n\n    if (singleBuffer) {\n        job.singleBuffer = singleBuffer;\n        this.polygons += 2;\n\n    } else {\n        //create vertex buffer\n        job.vertexPositionBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexPositionBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, vertices, gl.STATIC_DRAW);\n        job.vertexPositionBuffer.itemSize = 4;\n        job.vertexPositionBuffer.numItems = vertices.length / 4;\n\n        //create normal buffer\n        job.vertexTexcoordBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexTexcoordBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, texcoords, gl.STATIC_DRAW);\n        job.vertexTexcoordBuffer.itemSize = 4;\n        job.vertexTexcoordBuffer.numItems = texcoords.length / 4;\n\n        //create origin buffer\n        job.vertexOriginBuffer = gl.createBuffer();\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexOriginBuffer);\n        gl.bufferData(gl.ARRAY_BUFFER, origins, gl.STATIC_DRAW);\n        job.vertexOriginBuffer.itemSize = 3;\n        job.vertexOriginBuffer.numItems = origins.length / 3;\n\n        this.size += job.vertexPositionBuffer.numItems * 4 +\n                      job.vertexOriginBuffer.numItems * 4 +\n                      job.vertexTexcoordBuffer.numItems * 4;\n        this.polygons += job.vertexPositionBuffer.numItems / (4 * 3);\n    }\n\n\n    if (this.subjobs) {\n        this.subjobs.push(job);\n    } else {\n        if (this.vsjobs) {\n            this.vsjobs.push(job);\n        } else {\n            this.jobs.push(job);\n        }\n    }\n\n};\n\n\nGpuGroup.prototype.addPack = function(data) {\n    if (!this.subjobs.length) {\n        this.subjobs = null;\n        return;\n    }\n\n    var job = {\n        type : VTS_JOB_PACK,\n        subjobs: this.subjobs,\n        culling : 180,\n        zIndex : 0,\n        ready : true\n    };\n\n    //extract no overlap, remove it form subjobs\n    for (var i = 0, li = job.subjobs.length; i < li; i++) {\n        var subjob = job.subjobs[i];\n\n        if (subjob.noOverlap) {\n            \n            if (!job.noOverlap) {\n                job.noOverlap = subjob.noOverlap;\n            } else {\n                var o = job.noOverlap;\n                var o2 = subjob.noOverlap;\n\n                if (o2[0] < o[0]) o[0] = o2[0];\n                if (o2[1] < o[1]) o[1] = o2[1];\n                if (o2[2] > o[2]) o[2] = o2[2];\n                if (o2[3] > o[3]) o[3] = o2[3];\n            }\n\n            subjob.noOverlap = null;\n        }\n\n        if (subjob.culling <= job.culling) {\n            job.culling = subjob.culling;\n            subjob.culling = 180;\n        }\n\n        if (subjob.visibility) {\n            job.visibility = subjob.visibility;\n            subjob.visibility = null;\n        }\n\n        if (subjob.stick) {\n            job.stick = subjob.stick;\n            subjob.stick = [0,0,0,255,255,255,255,0];\n        }\n\n        if (subjob.zIndex > job.zIndex) {\n            job.zIndex = subjob.zIndex;\n        }\n\n        if (subjob.center) {\n            job.center = subjob.center;\n        }\n\n        job.eventInfo = subjob.eventInfo;\n        job.reduce = subjob.reduce;\n\n        job.hysteresis = subjob.hysteresis;\n        job.id = subjob.id;\n    }\n\n    if (this.vsjobs) {\n        this.vsjobs.push(job);\n    } else {\n        this.jobs.push(job);\n    }\n    \n    this.subjobs = null;\n};\n\n\nGpuGroup.prototype.addVSPoint = function(data, tile){\n    var job = { tile: tile };\n    job.type = VTS_JOB_VSPOINT;\n    job.zIndex = data['z-index'] + 256;\n    job.visibility = data['visibility'];\n    job.culling = data['culling'];\n    job.hitable = false;\n    job.eventInfo = data['eventInfo'];\n    job.state = data['state'];\n    job.center = data['center'];\n    job.lod = data['lod'];\n    job.hysteresis = data['hysteresis'];\n    job.id = job.hysteresis ? job.hysteresis[2] : null;\n    job.reduced = false;\n    job.ready = true;\n    job.reduce = data['reduce'];\n    job.vswitch = [];\n\n    this.vsjob = job;\n};\n\n\nGpuGroup.prototype.storeVSJobs = function(data){\n    this.vsjob.vswitch.push([data.viewExtent, this.vsjobs]);\n    this.vsjobs = [];\n};\n\n\nGpuGroup.prototype.addVSwitch = function(){\n    if (this.vsjob) {\n        this.jobs.push(this.vsjob);\n    }\n\n    this.vsjobs = null;\n};\n\nGpuGroup.prototype.addMeshJob = function(data, lod) {\n    var job = {};\n\n    job.type = VTS_JOB_MESH;\n    job.path = data['path'];\n    \n    job.textures = [];\n\n    job.resources = new MapResourceNode(this.renderer.core.map, null, null);\n\n    if (job.path) {\n        var stmp = job.path.split(\".\");\n        if (stmp.length > 1) {\n            stmp.pop();\n            job.texturePath = stmp.join('.');\n        }\n\n        job.mesh = job.resources.getMesh(job.path, null);\n    }\n\n    this.jobs.push(job);\n};\n\n\nGpuGroup.prototype.copyBuffer = function(buffer, source, index) {\n    var tmp = new Uint8Array(buffer.buffer);\n    tmp.set(new Uint8Array(source.buffer, index, buffer.byteLength));\n    return buffer;\n};\n\n\nGpuGroup.prototype.addRenderJob2 = function(buffer, index, tile) {\n    var data, str, length, tmp;\n    var view = new DataView(buffer.buffer);\n    var type = buffer[index]; index += 1;\n\n    if (type != VTS_WORKER_TYPE_PACK_BEGIN && type != VTS_WORKER_TYPE_PACK_END && \n        type != VTS_WORKER_TYPE_VSWITCH_BEGIN && type != VTS_WORKER_TYPE_VSWITCH_END && type != VTS_WORKER_TYPE_VSWITCH_STORE) {\n\n        length = view.getUint32(index); index += 4;\n        str = utils.unint8ArrayToString(new Uint8Array(buffer.buffer, index, length)); index+= length;\n        data = JSON.parse(str);\n    }\n\n    switch(type) {\n        case VTS_WORKER_TYPE_POLYGON:\n        case VTS_WORKER_TYPE_FLAT_LINE:\n            data.type = type;\n            length = view.getUint32(index); index += 4;\n            data.vertexBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.vertexBuffer.byteLength;\n\n            if (data['advancedHit']) {\n                length = view.getUint32(index); index += 4;\n                data.elementBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.elementBuffer.byteLength;\n            }\n\n            this.addLineJob(data);\n            break;\n\n        case VTS_WORKER_TYPE_FLAT_TLINE:\n        case VTS_WORKER_TYPE_FLAT_RLINE:\n        case VTS_WORKER_TYPE_PIXEL_LINE:\n        case VTS_WORKER_TYPE_PIXEL_TLINE:\n            data.type = type;\n            length = view.getUint32(index); index += 4;\n            data.vertexBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.vertexBuffer.byteLength;\n            length = view.getUint32(index); index += 4;\n            data.normalBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.normalBuffer.byteLength;\n\n            if (data['advancedHit']) {\n                length = view.getUint32(index); index += 4;\n                data.elementBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.elementBuffer.byteLength;\n            }\n\n            this.addExtentedLineJob(data);\n            break;\n\n        case VTS_WORKER_TYPE_LINE_LABEL:\n\n            length = view.getUint32(index); index += 4;\n            data.vertexBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.vertexBuffer.byteLength;\n            length = view.getUint32(index); index += 4;\n            data.texcoordsBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.texcoordsBuffer.byteLength;\n            this.addLineLabelJob(data);\n            break;\n\n        case VTS_WORKER_TYPE_LINE_LABEL2:\n\n            length = view.getUint32(index); index += 4;\n            data.singleBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.singleBuffer.byteLength;\n            length = view.getUint32(index); index += 4;\n            data.singleBuffer2 = this.copyBuffer(new Float32Array(length), buffer, index); index += data.singleBuffer2.byteLength;\n            this.addLineLabelJob(data);\n            break;\n\n        case VTS_WORKER_TYPE_ICON:\n        case VTS_WORKER_TYPE_LABEL:\n\n            length = view.getUint32(index); index += 4;\n            data.singleBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.singleBuffer.byteLength;\n            this.addIconJob(data, (type == VTS_WORKER_TYPE_LABEL), tile);\n            break;\n\n        case VTS_WORKER_TYPE_ICON2:\n        case VTS_WORKER_TYPE_LABEL2:\n\n            length = view.getUint32(index); index += 4;\n            data.vertexBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.vertexBuffer.byteLength;\n            length = view.getUint32(index); index += 4;\n            data.originBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.originBuffer.byteLength;\n            length = view.getUint32(index); index += 4;\n            data.texcoordsBuffer = this.copyBuffer(new Float32Array(length), buffer, index); index += data.texcoordsBuffer.byteLength;\n            this.addIconJob(data, (type == VTS_WORKER_TYPE_LABEL2), tile);\n            break;\n\n        case VTS_WORKER_TYPE_POINT_GEOMETRY:\n        case VTS_WORKER_TYPE_LINE_GEOMETRY:\n\n            length = view.getUint32(index); index += 4;\n            data.geometryBuffer = this.copyBuffer(new Float64Array(length), buffer, index); index += data.originBuffer.byteLength;\n            length = view.getUint32(index); index += 4;\n            data.indicesBuffer = this.copyBuffer(new Uint32Array(length), buffer, index); index += data.indicesBuffer.byteLength;\n            length = view.getUint32(index); index += 4;\n            this.addGeometry(data);\n            break;\n\n        case VTS_WORKER_TYPE_PACK_BEGIN:\n            this.subjobs = []; index += 4;\n            break;\n\n        case VTS_WORKER_TYPE_PACK_END:\n            this.addPack(); index += 4;\n            break;\n\n        case VTS_WORKER_TYPE_VSPOINT:\n            this.addVSPoint(data, tile);\n            break;\n\n        case VTS_WORKER_TYPE_VSWITCH_BEGIN:\n            this.vsjobs = []; this.vsjob = null; index += 4;\n            break;\n\n        case VTS_WORKER_TYPE_VSWITCH_END:\n            this.addVSwitch(); index += 4;\n            break;\n\n        case VTS_WORKER_TYPE_VSWITCH_STORE:\n            data = { viewExtent: view.getUint32(index) }; index += 4;\n            this.storeVSJobs(data);\n            break;\n\n        case VTS_WORKER_TYPE_NODE_BEGIN:\n\n            var node = data;\n            node.nodes = [];\n            node.jobs = [];\n            node.parent = this.currentNode;\n\n            if (node.volume) {\n                var p = node.volume.points;\n                var points = [\n                    p[0][0],p[0][1],p[0][2],\n                    p[1][0],p[1][1],p[1][2],\n                    p[2][0],p[2][1],p[2][2],\n                    p[3][0],p[3][1],p[3][2],\n                    p[4][0],p[4][1],p[4][2],\n                    p[5][0],p[5][1],p[5][2],\n                    p[6][0],p[6][1],p[6][2],\n                    p[7][0],p[7][1],p[7][2]\n                ];\n\n                node.volume.points2 = points;\n            }\n\n            if (this.rootNode) {\n                this.currentNode.nodes.push(node);\n                this.currentNode = node;\n            } else {\n                this.rootNode = node;\n                this.currentNode = node;\n\n                this.oldJobs = this.jobs;\n            }\n\n            this.jobs = node.jobs;\n\n            break;\n\n        case VTS_WORKER_TYPE_NODE_END:\n\n            if (this.currentNode.parent) {\n                this.currentNode = this.currentNode.parent;\n                this.jobs = this.currentNode.jobs;\n            } else {\n                this.currentNode = this.currentNode.parent;\n                this.jobs = this.oldJobs;\n            }\n\n            break;\n\n        case VTS_WORKER_TYPE_MESH:\n            this.addMeshJob(data, tile);\n            break;\n    }\n\n    return index;\n};\n\n\nGpuGroup.prototype.addRenderJob = function(data, tile) {\n    switch(data['type']) {\n    case 'polygon':\n    case 'flat-line':     this.addLineJob(data); break;\n    case 'flat-tline':\n    case 'flat-rline':\n    case 'pixel-line':\n    case 'pixel-tline':    this.addExtentedLineJob(data); break;\n    case 'line-label':     this.addLineLabelJob(data); break;\n    case 'icon':           this.addIconJob(data); break;\n    case 'label':          this.addIconJob(data, true, tile); break;\n    case 'point-geometry': this.addGeometry(data); break;\n    case 'line-geometry':  this.addGeometry(data); break;\n    case 'pack-begin':     this.subjobs = []; break;\n    case 'pack-end':       this.addPack(); break;\n    case 'vspoint':        this.addVSPoint(data, tile); break;\n    case 'vswitch-begin':  this.vsjobs = []; this.vsjob = null; break;\n    case 'vswitch-store':  this.storeVSJobs(data); break;\n    case 'vswitch-end':    this.addVSwitch(); break;\n    case 'node-begin':     this.nodeBegin(); break;\n    case 'node-end':       this.nodeEnd(); break;\n    case 'mesh':           this.addMesh(); break;\n    }\n};\n\n\nfunction drawLineString(options, renderer) {\n    if (options == null || typeof options !== 'object') {\n        return this;    \n    }\n\n    if (options['points'] == null) {\n        return this;    \n    }\n\n    var points = options['points'];\n    var color = options['color'] || [255,255,255,255];\n    var depthOffset = (options['depthOffset'] != null) ? options['depthOffset'] : null;\n    var size = options['size'] || 2;\n    var screenSpace = (options['screenSpace'] != null) ? options['screenSpace'] : true;\n    var depthTest = (options['depthTest'] != null) ? options['depthTest'] : false;\n    var blend = (options['blend'] != null) ? options['blend'] : false;\n    var writeDepth = (options['writeDepth'] != null) ? options['writeDepth'] : false;\n    var useState = (options['useState'] != null) ? options['useState'] : false;\n\n    color = [ color[0] * (1.0/255), color[1] * (1.0/255), color[2] * (1.0/255), color[3] * (1.0/255) ];\n\n    renderer.draw.drawLineString(points, screenSpace, size, color, depthOffset, depthTest, blend, writeDepth, useState);\n    return this;    \n};\n\n\nGpuGroup.prototype.getNodeLOD = function(node) {\n    var lod = 0;\n\n    while(node.parent) {\n        lod++;\n        node = node.parent;\n    }\n\n    return lod;\n};\n\n/*\nGpuGroup.prototype.getNodeTexelSize3 = function(node, screenPixelSize) {\n    var camera = this.map.camera;\n    var cameraDistance = camera.geocentDistance;// * factor;\n\n    var a = vec3.dot(camera.geocentNormal, node.diskNormal); //get angle between tile normal and cameraGeocentNormal\n    var d = cameraDistance - (node.diskDistance + (node.maxZ - node.minZ)), d2; //vertical distance from top bbox level\n\n    if (a < node.diskAngle2) { //is camera inside tile conus?\n        \n        //get horizontal distance\n        var a2 = Math.acos(a); \n        var a3 = node.diskAngle2A;\n        a2 = a2 - a3; \n        var l1 = Math.tan(a2) * node.diskDistance;// * factor;\n\n        if (d < 0) { //is camera is belown top bbox level?\n            d2 = cameraDistance - node.diskDistance;\n            if (d2 < 0) { //is camera is belown bottom bbox level?\n                d = -d2;\n                d = Math.sqrt(l1*l1 + d*d);\n            } else { //is camera inside bbox\n                d = l1;\n            }\n        } else {\n            d = Math.sqrt(l1*l1 + d*d);\n        }\n\n    } else {\n        if (d < 0) { //is camera is belown top bbox level?\n            d2 = cameraDistance - node.diskDistance;\n            if (d2 < 0) { //is camera is belown bottom bbox level?\n                d = -d2;\n            } else { //is camera inside bbox\n                return [Number.POSITIVE_INFINITY, 0.1];\n            }\n        } \n    }\n\n    return [camera.camera.scaleFactor2(d) * screenPixelSize, d];\n};\n\n\nGpuGroup.prototype.getNodeTexelSize2 = function(volume, cameraPos, screenPixelSize, returnDistance) {\n    //TODO: \n    //      make camera pos relative to volume center\n    //      convert camera pos to volume space\n    //      min = [-sizeX*0.5, -sizeY*0.5, -sizeZ*0.5]\n    //      max = [sizeX*0.5, sizeY*0.5, sizeZ*0.5]\n\n    var pos = volume.center;\n    cameraPos = [cameraPos[0] - pos[0], cameraPos[1] - pos[1], cameraPos[2] - pos[2]];\n\n    var min = cameraPos * volume.m;\n\n    var min = volume.min;\n    var min = volume.max;\n\n    var tilePos1x = min[0] - cameraPos[0];\n    var tilePos1y = min[1] - cameraPos[1];\n    var tilePos2x = max[0] - cameraPos[0];\n    var tilePos2y = min[1] - cameraPos[1];\n    var tilePos3x = max[0] - cameraPos[0];\n    var tilePos3y = max[1] - cameraPos[1];\n    var tilePos4x = min[0] - cameraPos[0];\n    var tilePos4y = max[1] - cameraPos[1];\n    var h1 = min[2] - cameraPos[2];\n    var h2 = max[2] - cameraPos[2];\n    \n    //camera inside bbox\n    if (cameraPos[0] > min[0] && cameraPos[0] < max[0] &&\n        cameraPos[1] > min[1] && cameraPos[1] < max[1] &&\n        cameraPos[2] > min[2] && cameraPos[2] < max[2]) {\n\n        if (returnDistance) {\n            return [Number.POSITIVE_INFINITY, 0.1];\n        }\n    \n        return Number.POSITIVE_INFINITY;\n    }\n\n    var factor = 0;\n    var camera = this.map.camera.camera;\n\n    //find bbox sector\n    if (0 < tilePos1y) { //top row - zero means camera position in y\n        if (0 < tilePos1x) { // left top corner\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos1x, tilePos1y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos1x, tilePos1y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos1x, tilePos1y, (h1 + h2)*0.5], returnDistance);\n            }\n        } else if (0 > tilePos2x) { // right top corner\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos2x, tilePos2y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos2x, tilePos2y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos2x, tilePos2y, (h1 + h2)*0.5], returnDistance);\n            }\n        } else { //top side\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, tilePos2y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, tilePos2y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, tilePos2y, (h1 + h2)*0.5], returnDistance);\n            }\n        }\n    } else if (0 > tilePos4y) { //bottom row\n        if (0 < tilePos4x) { // left bottom corner\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos4x, tilePos4y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos4x, tilePos4y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos4x, tilePos4y, (h1 + h2)*0.5], returnDistance);\n            }\n        } else if (0 > tilePos3x) { // right bottom corner\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos3x, tilePos3y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos3x, tilePos3y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos3x, tilePos3y, (h1 + h2)*0.5], returnDistance);\n            }\n        } else { //bottom side\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([(tilePos4x + tilePos3x)*0.5, tilePos3y, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([(tilePos4x + tilePos3x)*0.5, tilePos3y, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([(tilePos4x + tilePos3x)*0.5, tilePos3y, (h1 + h2)*0.5], returnDistance);\n            }\n        }\n    } else { //middle row\n        if (0 < tilePos4x) { // left side\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos1x, (tilePos2y + tilePos3y)*0.5, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos1x, (tilePos2y + tilePos3y)*0.5, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos1x, (tilePos2y + tilePos3y)*0.5, (h1 + h2)*0.5], returnDistance);\n            }\n        } else if (0 > tilePos3x) { // right side\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([tilePos2x, (tilePos2y + tilePos3y)*0.5, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([tilePos2x, (tilePos2y + tilePos3y)*0.5, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([tilePos2x, (tilePos2y + tilePos3y)*0.5, (h1 + h2)*0.5], returnDistance);\n            }\n        } else { //center\n            if (0 > h2) { // hi\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, (tilePos2y + tilePos3y)*0.5, h2], returnDistance);\n            } else if (0 < h1) { // low\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, (tilePos2y + tilePos3y)*0.5, h1], returnDistance);\n            } else { // middle\n                factor = camera.scaleFactor([(tilePos1x + tilePos2x)*0.5, (tilePos2y + tilePos3y)*0.5, (h1 + h2)*0.5], returnDistance);\n            }\n        }\n    }\n\n    //console.log(\"new: \" + (factor * screenPixelSize) + \" old:\" + this.tilePixelSize2(node) );\n\n    if (returnDistance) {\n        return [(factor[0] * screenPixelSize), factor[1]];\n    }\n\n    return (factor * screenPixelSize);\n};\n*/\n\n\nGpuGroup.prototype.getNodeTexelSize = function(node, screenPixelSize) {\n    var pos = node.volume.center;\n    var cameraPos = this.renderer.cameraPosition;\n    var d = vec3.length(\n        [pos[0] - cameraPos[0],\n         pos[1] - cameraPos[1],\n         pos[2] - cameraPos[2]]);\n\n    d -= node.volume.radius;\n\n    if (d <= 0) {\n        return [Number.POSITIVE_INFINITY, 0.1];\n    }\n\n    return [this.renderer.camera.scaleFactor2(d) * screenPixelSize, d];\n};\n\n\nGpuGroup.prototype.normalizeGE = function(node, ge, lod) {\n    node.precision = ge;\n    node.lod = lod;\n\n    for (var i = 0, li = node.nodes.length; i < li; i++) {\n        this.normalizeGE(node.nodes[i], ge * 0.5, lod+1);\n    }\n};\n\n\nGpuGroup.prototype.getLinePointParametricDist = function(p0, p1, p) {\n\n     var v = [p1[0] - p0[0], p1[1] - p0[1], p1[2] - p0[2]];\n     var w = [p[0] - p0[0], p[1] - p0[1], p[2] - p0[2]];\n\n     var c1 = vec3.dot(w,v);\n\n     if (c1 <= 0)\n          return 0;\n\n     var c2 = vec3.dot(v,v);\n     if (c2 <= c1)\n          return 1;\n\n     var b = c1 / c2;\n\n     return b;\n};\n\n\nGpuGroup.prototype.getOctant = function(point, points) {\n    var fx = this.getLinePointParametricDist(points[0], points[1], point);\n    var fy = this.getLinePointParametricDist(points[1], points[2], point);\n    var fz = this.getLinePointParametricDist(points[4], points[0], point);\n\n    if (fz > 0.5) {\n        if (fy > 0.5) {\n            if (fx > 0.5) {\n                return 5;\n            } else {\n                return 4;\n            }\n        } else {\n            if (fx > 0.5) {\n                return 7;\n            } else {\n                return 6;\n            }\n        }\n    } else {\n        if (fy > 0.5) {\n            if (fx > 0.5) {\n                return 1;\n            } else {\n                return 0;\n            }\n        } else {\n            if (fx > 0.5) {\n                return 3;\n            } else {\n                return 2;\n            }\n        }\n    }\n\n};\n\nGpuGroup.prototype.setDivisionSpace = function(node, points, octant) {\n    node.volume2 = { points: points, octant: octant };\n\n    var center = [0,0,0];\n    \n    for (var i = 0, li = points.length; i < li; i++) {\n        center[0] += points[i][0];\n        center[1] += points[i][1];\n        center[2] += points[i][2];\n    }\n\n    center[0] /= li;\n    center[1] /= li;\n    center[2] /= li;\n\n    var xv = [(points[1][0] - points[0][0])*0.5, (points[1][1] - points[0][1])*0.5, (points[1][2] - points[0][2])*0.5];\n    var yv = [(points[1][0] - points[2][0])*0.5, (points[1][1] - points[2][1])*0.5, (points[1][2] - points[2][2])*0.5];\n    var zv = [(points[0][0] - points[4][0])*0.5, (points[0][1] - points[4][1])*0.5, (points[0][2] - points[4][2])*0.5];\n    var xf, yf, zf;\n\n    for (var i = 0, li = node.nodes.length; i < li; i++) {\n\n        var octant = this.getOctant(node.nodes[i].volume.center, points);\n\n        switch(octant) {\n            case 0: xf = -1, yf = -1, zf = -1; break;\n            case 1: xf = 0, yf = -1, zf = -1; break;\n            case 2: xf = -1, yf = 0, zf = -1; break;\n            case 3: xf = 0, yf = 0, zf = -1; break;\n            case 4: xf = -1, yf = -1, zf = 0; break;\n            case 5: xf = 0, yf = -1, zf = 0; break;\n            case 6: xf = -1, yf = 0, zf = 0; break;\n            case 7: xf = 0, yf = 0, zf = 0; break;\n        }\n        \n        var p = [center[0] + xv[0] * xf + yv[0] * yf + zv[0] * zf,\n                 center[1] + xv[1] * xf + yv[1] * yf + zv[1] * zf,\n                 center[2] + xv[2] * xf + yv[2] * yf + zv[2] * zf];\n\n        this.setDivisionSpace(node.nodes[i], [\n\n            [p[0],\n             p[1],\n             p[2]],\n\n            [p[0] + xv[0],\n             p[1] + xv[1],\n             p[2] + xv[2]],\n\n            [p[0] + xv[0] + yv[0],\n             p[1] + xv[1] + yv[1],\n             p[2] + xv[2] + yv[2]],\n\n            [p[0] + yv[0],\n             p[1] + yv[1],\n             p[2] + yv[2]],\n\n            [p[0] + zv[0],\n             p[1] + zv[1],\n             p[2] + zv[2]],\n\n            [p[0] + xv[0] + zv[0],\n             p[1] + xv[1] + zv[1],\n             p[2] + xv[2] + zv[2]],\n\n            [p[0] + xv[0] + yv[0] + zv[0],\n             p[1] + xv[1] + yv[1] + zv[1],\n             p[2] + xv[2] + yv[2] + zv[2]],\n\n            [p[0] + yv[0] + zv[0],\n             p[1] + yv[1] + zv[1],\n             p[2] + yv[2] + zv[2]]\n\n        ], octant);\n\n    }\n};\n\n\nGpuGroup.prototype.traverseNode = function(node, visible, isready, skipRender) {\n\n    var renderer = this.renderer;\n    var points = node.volume.points2;\n    var cameraPos = this.renderer.cameraPosition;\n\n    if (!visible && !renderer.camera.pointsVisible(points, cameraPos)) {\n        return;        \n    }\n\n//    var res = this.getNodeTexelSize(node, node.precision * renderer.curSize[0] * (1/18) /*node.precision * 100*/);\n    var res = this.getNodeTexelSize(node, node.precision * renderer.curSize[0] * this.geFactor);\n\n    //this.loadMode = 0;\n\n    if (this.loadMode == 0) { // topdown\n\n        if (!node.nodes.length || res[0] <= this.map.draw.texelSizeFit) {\n\n            if (node.parent || this.isNodeReady(node)) { \n                this.drawNode(node);\n            }\n\n        } else {\n\n            //are nodes ready\n            var ready = true;\n            var nodes = node.nodes;\n            var visible = [];\n\n            for (var i = 0, li = nodes.length; i < li; i++) {\n                //visible[i] = renderer.camera.pointsVisible(nodes[i].volume.points2, cameraPos);\n\n                //if (visible[i]) {\n                    if (!this.isNodeReady(nodes[i])) {\n                        ready = false;\n                    }\n                //}\n            }\n\n\n            if (ready) {\n                for (var i = 0, li = nodes.length; i < li; i++) {\n                    //if (visible[i]) {\n                        //this.traverseNode(nodes[i], true, true);\n                        this.traverseNode(nodes[i]);\n                    //}\n                }\n            } else { // children are not ready, draw parent as fallback\n\n                //if (this.isNodeReady(node)) {\n                    this.drawNode(node);\n                //}\n\n            }\n\n        }\n\n    } else if (this.loadMode == 1) { // topdown with splitting\n\n        var priority = node.lod * res[1];\n\n        if (!node.nodes.length || res[0] <= this.map.draw.texelSizeFit) {\n\n            if (!skipRender && (/*node.parent ||*/ this.isNodeReady(node, null, priority))) { \n                this.drawNode(node);\n            }\n\n        } else {\n\n            //are nodes ready\n            var ready = true;\n            var nodes = node.nodes;\n            var mask = [0,0,0,0,0,0,0,0];\n            var useMask = false;\n            var readyCount = 0;\n            var splitLods = this.map.config.mapSplitLods;\n\n            var priority2 = (node.lod+1) * res[1];\n\n            for (var i = 0, li = nodes.length; i < li; i++) {\n\n                if (splitLods) {\n                    var node2 = nodes[i];\n                    var res2 = this.getNodeTexelSize(node2, node.precision * renderer.curSize[0] * this.geFactor);\n                    node2.goodLod = (res2[0] <= this.map.draw.texelSizeFit);\n                }\n\n                if (renderer.camera.pointsVisible(nodes[i].volume.points2, cameraPos)) {\n                    nodes[i].visible = true;\n                } else {\n                    nodes[i].visible = false;\n                    continue;\n                }\n\n                if (!this.isNodeReady(nodes[i], null, priority2, true) || (splitLods && node2.goodLod)) {\n                    //ready = false;\n                    useMask = true;\n                    mask[nodes[i].volume2.octant] = 1;\n                } else {\n                    readyCount++;\n                }\n            }\n\n            for (var i = 0, li = nodes.length; i < li; i++) {\n                if (nodes[i].visible && !(splitLods && nodes[i].goodLod)) {\n                    //this.traverseNode(nodes[i], true, true);\n                    var skipChildRender = (skipRender || (mask[nodes[i].volume2.octant] == 1));\n                    this.traverseNode(nodes[i], true, null, skipChildRender, skipChildRender);\n                }\n            }\n\n            if (useMask) { // some children are not ready, draw parent as fallback\n                if (!skipRender && this.isNodeReady(node, null, priority)) {\n                    if (readyCount > 0) {\n                        this.drawNode(node, null, mask, node.volume2.points);\n                    } else {\n                        this.drawNode(node);\n                    }\n                }\n            }\n\n        }\n\n    } else if (this.loadMode == 2) { // fit\n\n        if (!node.nodes.length || res[0] <= 1.1) {\n\n            if (isready || this.isNodeReady(node)) {\n                this.drawNode(node);\n            } else { //node is not ready, try childen\n\n                var nodes = node.nodes;\n\n                for (var i = 0, li = nodes.length; i < li; i++) {\n                    if (renderer.camera.pointsVisible(nodes[i].volume.points2, cameraPos)) {\n                        if (this.isNodeReady(nodes[i], true)) {\n                            this.drawNode(node);\n                        }\n                    }\n                }\n\n            }\n\n        } \n\n        else if (res[0] <= 2.2) {\n\n            //are nodes ready\n            var ready = true;\n            var nodes = node.nodes;\n            var visible = [];\n\n            for (var i = 0, li = nodes.length; i < li; i++) {\n                visible[i] = renderer.camera.pointsVisible(nodes[i].volume.points2, cameraPos);\n\n                if (visible[i]) {\n                    if (!this.isNodeReady(nodes[i])) {\n                        ready = false;\n                    }\n                }\n            }\n\n            if (ready) {\n                for (var i = 0, li = nodes.length; i < li; i++) {\n                    if (visible[i]) {\n                        this.traverseNode(nodes[i], true, true);\n                    }\n                }\n            } else { // children are not ready, draw parent as fallback\n\n                //if (this.isNodeReady(node)) {\n                    this.drawNode(node);\n                //}\n\n            }\n\n        } else {\n\n            for (var i = 0, li = node.nodes.length; i < li; i++) {\n                this.traverseNode(node.nodes[i]);\n            }\n        }\n\n    } else if (this.loadMode == 3) { // fitonly\n\n        if (!node.nodes.length || res[0] <= 1.1) {\n\n            if (this.isNodeReady(node)) {\n                this.drawNode(node);\n            }\n\n        } else {\n            for (var i = 0, li = node.nodes.length; i < li; i++) {\n                this.traverseNode(node.nodes[i]);\n            }\n        }\n    }\n\n};\n\n\nGpuGroup.prototype.isNodeReady = function(node, doNotLoad, priority, skipGpu) {\n    var jobs = node.jobs;\n    var ready = true;\n\n    //return true;\n\n    for (var i = 0, li = jobs.length; i < li; i++) {\n        var job = jobs[i];\n        \n        if (job.type == VTS_JOB_MESH) {\n            if (!this.isMeshReady(job, doNotLoad, priority, skipGpu)) {\n                ready = false;\n            }\n        }\n    }\n\n    return ready;\n};\n\nGpuGroup.prototype.drawNodeVolume = function(points, color) {\n    var renderer = this.renderer;\n\n    drawLineString({\n        points : [points[0], points[1], points[2], points[3], points[0],\n                  points[4], points[5], points[6], points[7], points[4]\n        ],\n        size : 1.0,\n        color : color,\n        depthTest : false,\n        //depthTest : true,\n        //depthOffset : [-0.01,0,0],\n        screenSpace : false, //switch to physical space\n        blend : false\n        }, renderer);\n\n    drawLineString({\n        points : [points[1], points[5]],\n        size : 1.0,\n        color : color,\n        depthTest : false,\n        //depthTest : true,\n        //depthOffset : [-0.01,0,0],\n        screenSpace : false, //switch to physical space\n        blend : false\n        }, renderer);\n\n    drawLineString({\n        points : [points[2], points[6]],\n        size : 1.0,\n        color : color,\n        depthTest : false,\n        //depthTest : true,\n        //depthOffset : [-0.01,0,0],\n        screenSpace : false, //switch to physical space\n        blend : false\n        }, renderer);\n\n    drawLineString({\n        points : [points[3], points[7]],\n        size : 1.0,\n        color : color,\n        depthTest : false,\n        //depthTest : true,\n        //depthOffset : [-0.01,0,0],\n        screenSpace : false, //switch to physical space\n        blend : false\n        }, renderer);\n}\n\nGpuGroup.prototype.drawNode = function(node, noSkip, splitMask, splitSpace) {\n    var renderer = this.renderer;\n    var debug = this.map.draw.debug;\n    var jobs = node.jobs;\n\n    renderer.drawnNodes++;\n\n    if (debug.drawNBBoxes) {\n        var points = node.volume.points;\n        var color = [255,0,255,255];\n\n        if (node.tileset) {\n        color = [0,255,0,255];           \n        }\n\n        if (noSkip) {\n            color = [255,255,0,255];\n        }\n                 \n        if (debug.drawSpaceBBox && node.volume2) {\n            this.drawNodeVolume(node.volume2.points, [255,0,0,255]);\n        } else {\n            this.drawNodeVolume(points, color);\n        }\n\n        /*\n        for (var i = 0, li = node.nodes.length; i < li; i++) {\n            var node2 = node.nodes[i];\n\n            if (node2.volume2.octant == 7) {\n                this.drawNodeVolume(node2.volume2.points, [255,0,0,255]);\n            }\n        }*/\n\n        var cameraPos = this.renderer.cameraPosition;\n        var pos = node.volume.center;\n\n        var shift = [cameraPos[0] - pos[0],\n               cameraPos[1] - pos[1],\n               cameraPos[2] - pos[2]];\n\n        vec3.normalize(shift);\n        vec3.scale(shift, node.volume.radius);\n\n        pos = [pos[0]+shift[0]-cameraPos[0],  \n               pos[1]+shift[1]-cameraPos[1],\n               pos[2]+shift[2]-cameraPos[2]];\n\n        /*pos = [pos[0]-cameraPos[0],  \n               pos[1]-cameraPos[1],\n               pos[2]-cameraPos[2]];*/\n\n        pos = this.renderer.core.getRendererInterface().getCanvasCoords(\n            pos,\n            /*[pos[0] - cameraPos[0],\n             pos[1] - cameraPos[1],\n             pos[2] - cameraPos[2]],*/\n             this.renderer.camera.getMvpMatrix());\n\n        var factor = 2, text;\n\n        if (debug.drawLods) {\n            text = '' + node.lod;//this.getNodeLOD(node);\n            renderer.draw.drawText(Math.round(pos[0]-renderer.draw.getTextSize(4*factor, text)*0.5), Math.round(pos[1]-4*factor), 4*factor, text, [1,0,0,1], pos[2]);\n        }\n        \n        if (debug.drawDistance) {\n            var res = this.getNodeTexelSize(node, node.precision * renderer.curSize[0] * this.geFactor);\n            text = '' + res[1].toFixed(2) + ' ' + res[0].toFixed(2) + ' ' + node.precision.toFixed(2);\n            renderer.draw.drawText(Math.round(pos[0]-renderer.draw.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+17*factor), 4*factor, text, [0.5,0.5,1,1], pos[2]);\n        }\n\n        if (debug.drawFaceCount) {\n            var mesh = (jobs[0] && jobs[0].type == VTS_JOB_MESH) ? jobs[0].mesh : null;\n            if (mesh) {\n                text = '' + mesh.faces + ' - ' + mesh.submeshes.length;\n                renderer.draw.drawText(Math.round(pos[0]-renderer.draw.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+10*factor), 4*factor, text, [0,1,0,1], pos[2]);\n            }\n        }\n\n        if (debug.drawResources && jobs[0]) {\n            text = '' + (this.getGpuSize(jobs[0])/(1024*1024)).toFixed(2) + 'MB';\n            renderer.draw.drawText(Math.round(pos[0]-renderer.draw.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+3*factor), 4*factor, text, [0,1,0,1], pos[2]);\n        }\n\n        if (debug.drawSurfaces && jobs[0]) {\n            var text = '';\n\n            if (jobs[0].texturePath) {\n                var parts = jobs[0].texturePath.split('/');\n\n                if (parts.length > 1) {\n                    text = parts[parts.length-2] + '/' + parts[parts.length-1];\n                } else {\n                    text = parts[0];\n                }\n            }\n\n            renderer.draw.drawText(Math.round(pos[0]-renderer.draw.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+10*factor), 4*factor, text, [0,1,0,1], pos[2]);\n        }\n\n        if (debug.drawTextureSize) {\n            var mesh = (jobs[0] && jobs[0].type == VTS_JOB_MESH) ? jobs[0].mesh : null;\n            if (mesh) {\n                var submeshes = mesh.submeshes;\n                for (i = 0, li = submeshes.length; i < li; i++) {\n\n                    if (submeshes[i].internalUVs) {\n                        var texture = jobs[0].textures[i];\n                        if (texture) {\n                            var gpuTexture = texture.getGpuTexture();\n                            if (gpuTexture) {\n                                text = '[' + i + ']: ' + gpuTexture.width + ' x ' + gpuTexture.height;\n                                renderer.draw.drawText(Math.round(pos[0]-renderer.draw.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+(17+i*4*2)*factor), 4*factor, text, [1,1,1,1], pos[2]);\n                            }\n                        }\n                    } else {\n                        text = '[' + i + ']: 256 x 256';\n                        renderer.draw.drawText(Math.round(pos[0]-renderer.draw.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+(17+i*4*2)*factor), 4*factor, text, [1,1,1,1], pos[2]);\n                    }\n                }\n            }\n        }\n    }\n\n    //debug.drawNBBoxes = true;\n\n    if (!noSkip) {\n        //return true;\n    }\n\n    for (var i = 0, li = jobs.length; i < li; i++) {\n        var job = jobs[i];\n        \n        if (job.type == VTS_JOB_MESH) {\n\n            if (this.isMeshReady(job)) {\n                this.drawMesh(job, node, splitMask, splitSpace);\n            }\n        }\n    }\n\n};\n\n\nGpuGroup.prototype.isMeshReady = function(job, doNotLoad, priority, skipGpu) {\n    var mesh = job.mesh;\n    var submeshes = mesh.submeshes;\n    var ready = true;\n    var stats = this.map.stats;\n\n    //console.log('' + stats.gpuNeeded + '  ' + job.texturePath);\n\n    if (mesh.isReady(doNotLoad, priority, skipGpu)) {\n        stats.gpuNeeded += mesh.gpuSize;\n\n        for (var i = 0, li = submeshes.length; i < li; i++) {\n            var submesh = submeshes[i];\n            \n            if (submesh.internalUVs && job.texturePath) {\n                if (job.textures[i] == null) {\n                    var path = job.texturePath + '-' + i + '.jpg';\n                    job.textures[i] = job.resources.getTexture(path, VTS_TEXTURETYPE_COLOR, null, null, null /*tile*/, true);\n                } \n\n                if (!job.textures[i].isReady(doNotLoad, priority, skipGpu)) {\n                    ready = false;\n                }\n\n                stats.gpuNeeded += job.textures[i].getGpuSize();\n            }\n        }\n\n    } else {\n        ready = false;\n    }\n\n    //console.log('' + stats.gpuNeeded + '  finish');\n\n    return ready;\n}\n\n\nGpuGroup.prototype.getGpuSize = function(job) {\n    var mesh = job.mesh;\n\n    if (!mesh) return 0;\n\n    var submeshes = mesh.submeshes;\n    var size = 0;\n    var doNotLoad = true;\n\n    if (mesh.isReady(doNotLoad)) {\n        size += mesh.gpuSize;\n\n        for (var i = 0, li = submeshes.length; i < li; i++) {\n            var submesh = submeshes[i];\n            \n            if (submesh.internalUVs && job.texturePath) {\n                if (job.textures[i]) {\n                    size += job.textures[i].getGpuSize();\n                }\n            }\n        }\n    }\n\n    return size;\n}\n\n\nGpuGroup.prototype.drawMesh = function(job ,node, splitMask, splitSpace) {\n    var mesh = job.mesh;\n    var submeshes = mesh.submeshes;\n    var cameraPos = this.renderer.cameraPosition;\n\n    for (var i = 0, li = submeshes.length; i < li; i++) {\n        var submesh = submeshes[i];\n        \n        if (job.textures[i]) {\n            //mesh.drawSubmesh(cameraPos, i, job.textures[i], VTS_MATERIAL_INTERNAL /*type*/, null /*alpha*/, null /*layer*/, null /*surface*/,  null /*splitMask*/);\n            //mesh.drawSubmesh(cameraPos, i, job.textures[i], VTS_MATERIAL_INTERNAL /*type*/, null /*alpha*/, null /*layer*/, null /*surface*/,  [0.1,1,2,3,4,5,6,0], node.volume2.points);\n            mesh.drawSubmesh(cameraPos, i, job.textures[i], VTS_MATERIAL_INTERNAL /*type*/, null /*alpha*/, null /*layer*/, null /*surface*/,  splitMask, splitSpace);\n        }\n    }\n}\n\n\n/*GpuGroup.prototype.testNodes = function(node) {\n    var p = node.volume.points;\n\n    var xa1 = p[7], xa2 = p[6];\n    var ya1 = p[7], ya2 = p[0];\n    var za1 = p[7], za2 = p[4];\n\n    p = p[7];\n\n    var getAxisPos = (function(pp, a1, a2){\n        var v = [a2[0] - a1[0], a2[1] - a1[1], a2[2] - a1[2] ];\n        var w = [pp[0] - a1[0], pp[1] - a1[1], pp[2] - a1[2] ];\n\n        var c1 = vec3.dot(w,v);\n        if (c1 <= 0) return 0;\n\n        var c2 = vec3.dot(v,v);\n        if (c2 <= c1) return 1;\n\n        return c1 / c2;\n    });\n\n    var getPos = (function(pp){\n        console.log('axis-x ' + getAxisPos(pp, xa1, xa2));\n        console.log('axis-y ' + getAxisPos(pp, ya1, ya2));\n        console.log('axis-z ' + getAxisPos(pp, za1, za2));\n    });\n\n    for (var i = 0, li = node.nodes.length; i < li; i++) {\n        console.log('node' + i);\n\n        var volume = node.nodes[i].volume;\n\n        getPos(volume.center);\n    }\n\n};\n\n\nGpuGroup.prototype.testNodes3 = function(node) {\n    this.drawNode(node);\n\n    for (var i = 0, li = node.nodes.length; i < li; i++) {\n        var node2 = node.nodes[i];\n\n        this.drawNode(node2);\n\n        for (var j = 0, lj = node2.nodes.length; j < lj; j++) {\n            var node3 = node2.nodes[j];\n\n            this.drawNode(node3);\n\n            for (var k = 0, lk = node3.nodes.length; k < lk; k++) {\n                this.drawNode(node3.nodes[k], k == 0);\n            }\n\n        }\n    }\n};\n\n\nGpuGroup.prototype.testNodes2 = function(node, depth) {\n    \n    if (depth == 0)\n        this.drawNode(node);\n\n    for (var i = 0, li = node.nodes.length; i < li; i++) {\n        var node2 = node.nodes[i];\n        this.testNodes2(node2, depth + 1)\n    }\n};*/\n\n\nGpuGroup.prototype.draw = function(mv, mvp, applyOrigin, tiltAngle, texelSize) {\n    if (this.id != null) {\n        if (this.renderer.layerGroupVisible[this.id] === false) {\n            return;\n        }\n    }\n\n    var renderer = this.renderer;\n    var renderCounter = [[renderer.geoRenderCounter, mv, mvp, this]];\n    this.map = renderer.core.map;\n\n    if (this.rootNode) {\n        renderer.drawnNodes = 0;\n\n        var mode = this.map.config.mapLoadMode; \n\n        switch(mode) {\n        case 'topdown': this.loadMode = ((this.map.config.mapSplitMeshes && this.map.config.mapSplitSpace) ? 1 : 0); break;\n        case 'fit':     this.loadMode = 2; break; \n        case 'fitonly': this.loadMode = 3; break;\n        }\n\n        if (!this.geNormalized) {\n            this.normalizeGE(this.rootNode, this.rootNode.precision, 0);\n\n            if (this.loadMode == 1) {\n                var s = this.map.config.mapSplitSpace;\n\n                //haag\n                //[0](3917010.907515,295581.570867,5007978.667312)\n                //[1](3916703.088682,295558.325137,5008219.156812)\n                //[2](3916673.621374,295948.529795,5008219.156812) \n                //[4](3917250.714190,295599.680484,5008287.362628) \n\n                // p0.x,p0.y,p0.z,p1.x,p1.y,p1.z,p2.x,p2.y,p2.z,p4.x,p4.y,p4.z\n                // mapSplitSpace=3917010.907515,295581.570867,5007978.667312,3916703.088682,295558.325137,5008219.156812,3916673.621374,295948.529795,5008219.156812,3917250.714190,295599.680484,5008287.362628\n\n                /*\n                var s = [\n                    [3917010.907515,295581.570867,5007978.667312],\n                    [3916703.088682,295558.325137,5008219.156812],\n                    [3916673.621374,295948.529795,5008219.156812],\n                    [3917250.714190,295599.680484,5008287.362628]\n                ];\n                */\n\n                /*\n                var s = [\n                    [3916942.895357,295576.434754,5008527.852128],\n                    [3916913.428049,295966.639412,5008527.852128],\n                    [3917221.246882,295989.885143,5008287.362628],\n                    [3917250.714190,295599.680484,5008287.362628],\n\n                    [3916703.088682,295558.325137,5008219.156812],\n                    [3916673.621374,295948.529795,5008219.156812],\n                    [3916981.440208,295971.775525,5007978.667312],\n                    [3917010.907515,295581.570867,5007978.667312],\n\n                    ];\n                */\n\n                var p = [s[0][0], s[0][1], s[0][2]];\n                var xv = [s[2][0] - s[1][0], s[2][1] - s[1][1], s[2][2] - s[1][2]];\n                var yv = [s[1][0] - p[0], s[1][1] - p[1], s[1][2] - p[2]];\n                var zv = [s[3][0] - p[0], s[3][1] - p[1], s[3][2] - p[2]];\n\n                s = [\n\n                    [p[0] + yv[0] + zv[0],\n                     p[1] + yv[1] + zv[1],\n                     p[2] + yv[2] + zv[2]],\n\n                    [p[0] + xv[0] + yv[0] + zv[0],\n                     p[1] + xv[1] + yv[1] + zv[1],\n                     p[2] + xv[2] + yv[2] + zv[2]],\n\n                    [p[0] + xv[0] + zv[0],\n                     p[1] + xv[1] + zv[1],\n                     p[2] + xv[2] + zv[2]],\n\n                    [p[0] + zv[0],\n                     p[1] + zv[1],\n                     p[2] + zv[2]],\n\n                    [p[0] + yv[0],\n                     p[1] + yv[1],\n                     p[2] + yv[2]],\n\n                    [p[0] + xv[0] + yv[0],\n                     p[1] + xv[1] + yv[1],\n                     p[2] + xv[2] + yv[2]],\n\n                    [p[0] + xv[0],\n                     p[1] + xv[1],\n                     p[2] + xv[2]],\n\n                    [p[0],\n                     p[1],\n                     p[2]],\n\n                ];\n\n                this.setDivisionSpace(this.rootNode, s);\n            }\n\n            this.geNormalized = true;\n        }\n\n        //this.testNodes(this.rootNode);\n        //this.testNodes2(this.rootNode, 0);\n\n        //console.clear();\n\n        this.traverseNode(this.rootNode, map);\n        return;\n    }\n\n\n    if (applyOrigin) {\n        var mvp2 = mat4.create();\n        var mv2 = mat4.create();\n        var pos = this.renderer.position;\n\n        /*\n        var transform = this.renderer.layerGroupTransform[this.id];\n\n        if (transform != null) {\n            origin = transform[1];\n            origin = [origin[0] - pos[0], origin[1] - pos[1], origin[2]];\n            mat4.multiply(math.translationMatrix(origin[0], origin[1], origin[2]), transform[0], mv2);\n            mat4.multiply(mv, mv2, mv2);\n        } else {*/\n            var origin = this.origin;\n            origin = [origin[0] - pos[0], origin[1] - pos[1], origin[2]];\n            mat4.multiply(mv, math.translationMatrix(origin[0], origin[1], origin[2]), mv2);\n        /*}*/\n\n        mat4.multiply(mvp, mv2, mvp2);\n        mv = mv2;\n        mvp = mvp2;\n    }\n\n    var cameraPos = renderer.cameraPosition;\n    var jobZBuffer = renderer.jobZBuffer;\n    var jobZBufferSize = renderer.jobZBufferSize;\n    var jobZBuffer2 = renderer.jobZBuffer2;\n    var jobZBuffer2Size = renderer.jobZBuffer2Size;\n\n    var onlyHitable = renderer.onlyHitLayers;\n\n    for (var i = 0, li = this.jobs.length; i < li; i++) {\n        var job = this.jobs[i];\n\n        if ((job.type == VTS_JOB_ICON || job.type == VTS_JOB_LABEL) && job.visibility > 0) {\n            var center = job.center;\n            if (vec3.length([center[0]-cameraPos[0],\n                center[1]-cameraPos[1],\n                center[2]-cameraPos[2]]) > job.visibility) {\n                continue;\n            }\n        }\n\n        if (onlyHitable && !job.hitable) {\n            continue;\n        }\n\n        job.mv = mv;\n        job.mvp = mvp;\n        job.renderCounter = renderCounter;\n        job.tiltAngle = tiltAngle;\n        job.texelSize = texelSize;\n\n        var zIndex = job.zIndex;\n\n        jobZBuffer[zIndex][jobZBufferSize[zIndex]] = job;\n        jobZBufferSize[zIndex]++;\n    }\n};\n\n\nexport default GpuGroup;\n","\nvar MapGeodataProcessor = function(surface, listener) {\n    this.layer = surface;\n    this.map = surface.map;\n    this.renderer = this.map.renderer;\n    this.killed = false;\n    this.listener = listener;\n    this.busy = false;\n    this.ready = true;\n    this.waitingForStylesheet = false;\n    this.stylesheet = null;\n    this.fonts = {};\n    this.processCounter = 0;\n\n\n    // eslint-disable-next-line\n    var worker = require('worker-loader?inline&fallback=false!./worker-main');\n    //var worker = require('worker-loader?!./worker-main');\n\n    //debug worker\n    this.processWorker = new worker;\n    \n    this.processWorker.onerror = function(event){\n        throw new Error(event.message + ' (' + event.filename + ':' + event.lineno + ')');\n    };\n\n    this.processWorker.onmessage = this.onMessage.bind(this);\n\n    this.processWorker.postMessage({'command':'config', 'data': this.map.config});\n};\n\n\nMapGeodataProcessor.prototype.kill = function() {\n    if (this.killed) {\n        return;\n    }\n\n    this.killed = true;\n\n    if (this.processWorker != null) {\n        this.processWorker.terminate();\n    }\n};\n\n\nMapGeodataProcessor.prototype.isReady = function() {\n    if (this.waitingForStylesheet) {\n        this.waitingForStylesheet = !(this.stylesheet.isReady());\n    }\n\n    return ((this.ready && !this.busy) || this.killed) && !this.waitingForStylesheet;\n};\n\n\nMapGeodataProcessor.prototype.onMessage = function(message, direct) {\n    if (this.killed) {\n        return;\n    }\n\n    if (!direct) {\n        message = message.data;\n    }\n    \n    var command = message['command'];\n\n    //console.log('onmessage ' + command);\n\n    //if (typeof message === \"string\" && message == \"ready\") {\n    if (command == 'ready') {\n        this.ready = true;\n        //console.log(\"ready\");\n    } else if (command == 'styleDone') {\n        this.busy = false;\n    } else if (command == 'loadBitmaps') {\n        var bitmaps = message['bitmaps'];\n\n        for (var key in bitmaps) {\n            var bitmap = bitmaps[key];\n            this.renderer.getBitmap(bitmap['url'], bitmap['filter'] || 'linear', bitmap['tiled'] || false, bitmap['hash'], true);\n        }\n    }\n\n    if (this.listener != null) {\n        if (command == 'packed-events') {\n            var messages = message['messages'];\n\n            for (var i = 0, li = messages.length; i < li; i++) {\n                this.onMessage(messages[i], true);\n            }\n\n            return;\n        } else {\n            this.listener(command, message);\n        }\n    }\n};\n\n\nMapGeodataProcessor.prototype.setListener = function(listener) {\n    this.listener = listener;\n};\n\n\nMapGeodataProcessor.prototype.sendCommand = function(command, data, tile, dpr) {\n    if (this.killed) {\n        return;\n    }\n\n    this.ready = false;\n    \n    var message = {'command': command, 'data':data};\n\n    //console.log('sendCommand ' + command);\n    \n    if (tile && tile.id) { \n        message['lod'] = tile.id[0];\n        message['ix'] = tile.id[1];\n        message['iy'] = tile.id[2];\n\n        if (tile.metanode) {\n            message['tileSize'] = Math.tan(tile.metanode.diskAngle2A) * tile.metanode.diskDistance;\n            message['pixelSize'] =  (message['tileSize'] * 0.70710678118) / tile.metanode.displaySize;\n        }\n    }\n\n    if (dpr) {\n        message['dpr'] = dpr;\n    }\n\n    this.processWorker.postMessage(message);\n};\n\nMapGeodataProcessor.prototype.setStylesheet = function(stylesheet, fontsOnly) {\n    this.stylesheet = stylesheet;\n\n    if (!stylesheet.isReady()) {\n        this.waitingForStylesheet = true;\n        return;\n    }\n\n    this.busy = true;\n\n    var ppi = 96 * (window.devicePixelRatio || 1);\n    var config = this.map.config;\n    var params = config.mapFeaturesReduceParams;\n    var isDef = (function(val){ return (typeof val !== 'undefined') });\n    var rmode = config.mapFeaturesReduceMode;\n\n\n    switch (rmode) {\n        case 'scr-count1':\n        case 'scr-count2':\n            if (!params) {\n                params = [1,50,0];\n            } else {\n                params[0] = isDef(params[0]) ? params[0] : 1;\n                params[1] = isDef(params[1]) ? params[1] : 50;\n                params[2] = isDef(params[2]) ? params[2] : 0;\n            }\n            config.mapFeaturesSortByTop = (rmode == 'scr-count2') ? true : false;\n            break;\n\n        case 'scr-count4':\n            if (!params) {\n                params = [0.18,0,0];\n            } else {\n                params[0] = isDef(params[0]) ? params[0] : 0.18;\n                params[1] = isDef(params[1]) ? params[1] : 0;\n                params[2] = isDef(params[2]) ? params[2] : 1;\n            }\n            config.mapFeaturesSortByTop = true;\n            break;\n\n        case 'scr-count5':\n            if (!params) {\n                params = [2,1,0];\n            } else {\n                params[0] = isDef(params[0]) ? params[0] : 2;\n                params[1] = isDef(params[1]) ? params[1] : 1;\n                params[2] = isDef(params[2]) ? params[2] : 1;\n            }\n            config.mapFeaturesSortByTop = true;\n            break;\n\n        case 'scr-count6':\n        case 'scr-count7':\n            if (!params) {\n                params = [0.2,0,((rmode == 'scr-count6') ? 1 : 2), 1, 1];\n            } else {\n                params[0] = (isDef(params[0]) ? params[0] : 0.2);\n                params[1] = isDef(params[1]) ? params[1] : 0;\n                params[2] = isDef(params[2]) ? params[2] : ((rmode == 'scr-count6') ? 1 : 2);\n                params[3] = isDef(params[3]) ? params[3] : 1;\n                params[4] = isDef(params[4]) ? params[4] : 1;\n                params[5] = ppi;\n                config.mapFeaturesSortByTop = true;\n            }\n            break;\n\n        case 'scr-count8':\n            if (!params) {\n                params = [0.2, 0.6, 11, 1, 1000, 5];\n            } else {\n                params[0] = (isDef(params[0]) ? params[0] : 0.2);\n                params[1] = isDef(params[1]) ? params[1] : 0.6;\n                params[2] = isDef(params[2]) ? params[2] : 11;\n                params[3] = isDef(params[3]) ? params[3] : 1;\n                params[4] = isDef(params[4]) ? params[4] : 1000;\n                params[5] = isDef(params[5]) ? params[5] : 5;\n                params[6] = ppi;\n                config.mapFeaturesSortByTop = true;\n            }\n            break;\n\n    }\n    \n    config.mapFeaturesReduceParams = params;\n    config.mapFeaturesReduceFactor = params[2];\n    config.mapFeaturesReduceFactor2 = params[3];\n    config.mapFeaturesReduceFactor3 = params[4];\n\n    //this.setFont('#default', this.renderer.font);\n    this.sendCommand('setStylesheet', { 'data' : stylesheet.data,\n                                        'geocent' : (!this.map.getNavigationSrs().isProjected()),\n                                        'metric': config.mapMetricUnits,\n                                        'language': config.mapLanguage,\n                                        'reduceMode': rmode,\n                                        'reduceParams': config.mapFeaturesReduceParams,\n                                        'log': config.mapLogGeodataStyles } );\n\n    var fonts = stylesheet.fonts;\n    var fontMap = {}; //'#default' : '#default' };\n\n    for (var key in fonts) {\n        var fontUrl = fonts[key];\n        var font = this.renderer.fonts[fontUrl];\n        fontMap[key] = fontUrl;\n\n        if (font) {\n            this.setFont(fontUrl, font);\n        }\n    }\n\n    this.processCounter++;\n    this.sendCommand('setFontMap', { 'map' : fontMap });\n};\n\n\nMapGeodataProcessor.prototype.setFont = function(url, font) {\n    if (!this.fonts[url]) {\n        this.fonts[url] = font;\n        this.sendCommand('setFont', {'url' : url, 'data': font.data}, [font.data]);\n    }\n};\n\n\nexport default MapGeodataProcessor;\n","\nimport {mat4 as mat4_} from '../utils/matrix';\nimport {math as math_} from '../utils/math';\nimport {utils as utils_} from '../utils/utils';\nimport GpuGroup_ from '../renderer/gpu/group';\nimport MapGeodataProcessor_ from './geodata-processor/processor';\n\n//get rid of compiler mess\nvar mat4 = mat4_, math = math_, utils = utils_;\nvar GpuGroup = GpuGroup_;\nvar MapGeodataProcessor = MapGeodataProcessor_;\n\n\nvar MapGeodataView = function(map, geodata, extraInfo) {\n    this.map = map;\n    this.stats = map.stats;\n    this.geodata = geodata;\n    this.gpu = this.map.renderer.gpu;\n    this.renderer = this.map.renderer;\n    this.gpuGroups = [];\n    this.currentGpuGroup = null;\n    this.tile = extraInfo.tile;\n    this.surface = extraInfo.surface;\n\n    if (!this.surface.geodataProcessor) {\n        var processor = new MapGeodataProcessor(this, this.onGeodataProcessorMessage.bind(this));\n        processor.setStylesheet(this.surface.stylesheet);\n        this.surface.geodataProcessor = processor;\n        this.map.geodataProcessors.push(processor);\n    } else {\n        if (this.surface.styleChanged) {\n            this.surface.geodataProcessor.setStylesheet(this.surface.stylesheet);\n            this.surface.styleChanged = false;\n        }\n    }\n\n    this.geodataProcessor = this.surface.geodataProcessor;\n    this.processing = false;\n    this.statsCounter = 0;\n    this.size = 0;\n    this.killed = false;\n    this.killedByCache = false;\n    this.ready = false;\n    this.isReady();\n};\n\n\nMapGeodataView.prototype.kill = function() {\n    this.killed = true;\n    this.geodata = null;\n    this.killGeodataView(false);\n};\n\n\nMapGeodataView.prototype.killGeodataView = function(killedByCache) {\n    this.killedByCache = killedByCache;\n\n    for (var i = 0, li = this.gpuGroups.length; i < li; i++) {\n        this.gpuGroups[i].kill();\n    }\n\n    this.gpuGroups = [];\n\n    if (killedByCache !== true && this.gpuCacheItem != null) {\n        this.map.gpuCache.remove(this.gpuCacheItem);\n    }\n\n    this.stats.gpuGeodata -= this.size;\n    this.stats.graphsFluxGeodata[1][0]++;\n    this.stats.graphsFluxGeodata[1][1] += this.size;\n    \n    this.ready = false;\n    this.size = 0;\n    this.gpuCacheItem = null;\n};\n\n\nMapGeodataView.prototype.processPackedCommands = function(buffer, index) {\n\n    var maxIndex = buffer.byteLength;\n    var maxTime = this.map.config.mapMaxGeodataProcessingTime;\n    var t = performance.now(), length, str, data;\n    var view = new DataView(buffer.buffer);\n\n    do {\n\n        var command = buffer[index]; index += 1;\n\n        switch(command) {\n            case VTS_WORKERCOMMAND_GROUP_BEGIN:\n                index += 1;\n                length = view.getUint32(index); index += 4;\n                str = utils.unint8ArrayToString(new Uint8Array(buffer.buffer, index, length)); index+= length;\n                data = JSON.parse(str);\n\n                this.currentGpuGroup = new GpuGroup(data['id'], data['bbox'], data['origin'], this.gpu, this.renderer);\n                this.gpuGroups.push(this.currentGpuGroup);\n\n                //console.log('VTS_WORKERCOMMAND_GROUP_BEGIN ' + (this.tile ? JSON.stringify(this.tile.id) : '[free]'));\n                break;\n\n            case VTS_WORKERCOMMAND_GROUP_END:\n                this.size += this.currentGpuGroup.size; index += 1 + 4;\n                //console.log('VTS_WORKERCOMMAND_GROUP_END ' + (this.tile ? JSON.stringify(this.tile.id) : '[free]'));\n                break;\n\n            case VTS_WORKERCOMMAND_ADD_RENDER_JOB:\n                index = this.currentGpuGroup.addRenderJob2(buffer, index, this.tile);\n                break;\n\n            case VTS_WORKERCOMMAND_ALL_PROCESSED:\n                this.map.markDirty();\n                this.gpuCacheItem = this.map.gpuCache.insert(this.killGeodataView.bind(this, true), this.size);\n\n                this.stats.gpuGeodata += this.size;\n                this.stats.graphsFluxGeodata[0][0]++;\n                this.stats.graphsFluxGeodata[0][1] += this.size;\n                this.ready = true;\n                this.processing = false;\n\n                //console.log('VTS_WORKERCOMMAND_ALL_PROCESSED ' + (this.tile ? JSON.stringify(this.tile.id) : '[free]'));\n\n                index += 1 + 4;\n                break;\n        }\n\n        if ((performance.now() - t) > maxTime) {\n            if (index < maxIndex) {\n                return index;\n            }\n        }\n\n    } while(index < maxIndex);\n\n\n    this.stats.renderBuild += performance.now() - t; \n\n    return -1;\n};\n\n\nMapGeodataView.prototype.onGeodataProcessorMessage = function(command, message, task) {\n    if (this.killed || this.killedByCache){\n        return;\n    }\n\n    switch (command) {\n\n    case 'addPackedCommands':\n\n        //console.log('pack size:' + message['buffer'].byteLength);\n\n        if (task) {\n            var index = this.processPackedCommands(message['buffer'], message.index);\n\n            if (index < 0) {\n                this.map.markDirty();\n                //console.log('addPackedCommandsB ' + (this.tile ? JSON.stringify(this.tile.id) : '[free]'));\n            } else {\n                //console.log('addPackedCommandsC ' + (this.tile ? JSON.stringify(this.tile.id) : '[free]'));\n                message.index = index;\n                return -123;\n            }\n\n        } else {\n            message.index = 0;\n            this.map.markDirty();\n            this.map.addProcessingTask2(this.onGeodataProcessorMessage.bind(this, command, message, true));\n\n            //console.log('addPackedCommandsA ' + (this.tile ? JSON.stringify(this.tile.id) : '[free]'));\n        }\n\n        break;\n\n    case 'ready':\n\n        if (this.geodataProcessor.processCounter > 0) {\n            this.geodataProcessor.processCounter--;\n\n            if (this.geodataProcessor.processCounter > 0) {\n                this.map.markDirty();\n                //console.log('ready2 ' + (this.tile ? JSON.stringify(this.tile.id) : '[free]'));\n\n                break;\n            }\n        }\n\n        if (message['geodata']) {\n            this.geodata.geodata = message['geodata'];\n        }\n\n        this.geodataProcessor.busy = false;\n        this.map.markDirty();\n        //console.log('ready ' + (this.tile ? JSON.stringify(this.tile.id) : '[free]'));\n\n            //this.ready = true;\n        break;\n    }\n};\n\n\nMapGeodataView.prototype.isReady = function(doNotLoad, priority, doNotCheckGpu) {\n    if (this.killed) {\n        return false;\n    }\n\n    //if (!(this.tile.id[0] == 21 && this.tile.id[1] == 566459 && this.tile.id[2] == 355240)) {\n      //  return false;\n    //}\n\n    var doNotUseGpu = (this.map.stats.gpuRenderUsed >= this.map.draw.maxGpuUsed);\n    doNotLoad = doNotLoad || doNotUseGpu;\n    \n    //if (!this.ready && !doNotUseGpu && this.geodataProcessor.isReady()) {\n    if (!this.ready && !this.processing && !doNotLoad && this.surface.stylesheet.isReady()) {\n        if (this.geodata.isReady(doNotLoad, priority, doNotCheckGpu) && this.geodataProcessor.isReady()) {\n            this.processing = true;\n            this.killedByCache = false;\n            this.geodataProcessor.setListener(this.onGeodataProcessorMessage.bind(this));\n\n            var geodata = this.geodata.geodata;\n\n            if (this.map.config.mapGeodataBinaryLoad && (typeof geodata !== 'string')) {\n                this.geodataProcessor.sendCommand('processGeodataRaw', geodata, this.tile, (window.devicePixelRatio || 1), [geodata]);\n            } else {\n                this.geodataProcessor.sendCommand('processGeodata', geodata, this.tile, (window.devicePixelRatio || 1));\n            }\n\n            this.geodataProcessor.busy = true;\n            //console.log('processGeodata ' + (this.tile ? JSON.stringify(this.tile.id) : '[free]'));\n        }\n    }\n\n    if (!doNotLoad && this.gpuCacheItem) {\n        this.map.gpuCache.updateItem(this.gpuCacheItem);\n    }\n\n    return this.ready;\n};\n\n\nMapGeodataView.prototype.getWorldMatrix = function(bbox, geoPos, matrix) {\n    var m = matrix;\n\n    if (m != null) {\n        m[0] = 1; m[1] = 0; m[2] = 0; m[3] = 0;\n        m[4] = 0; m[5] = 1; m[6] = 0; m[7] = 0;\n        m[8] = 0; m[9] = 0; m[10] = 1; m[11] = 0;\n        m[12] = bbox.min[0] - geoPos[0]; m[13] = bbox.min[1] - geoPos[1]; m[14] = bbox.min[2] - geoPos[2]; m[15] = 1;\n    } else {\n        m = mat4.create();\n\n        mat4.multiply( math.translationMatrix(bbox.min[0] - geoPos[0], bbox.min[1] - geoPos[1], bbox.min[2] - geoPos[2]),\n                       math.scaleMatrix(1, 1, 1), m);\n    }\n\n    return m;\n};\n\n\nMapGeodataView.prototype.draw = function(cameraPos) {\n    if (this.ready) {\n\n        var renderer = this.renderer;\n        var tiltAngle = this.tile ? Math.abs(this.tile.tiltAngle) : renderer.cameraTiltFator;\n        var useSuperElevation = renderer.useSuperElevation;\n\n        for (var i = 0, li = this.gpuGroups.length; i < li; i++) {\n            var group = this.gpuGroups[i]; \n\n            if (group.rootNode) {\n                group.draw(mv, mvp, null, tiltAngle, (this.tile ? this.tile.texelSize : 1));\n                continue;\n            }\n\n            if (!(group.jobs.length || group.rootNode)) {\n                continue; //TODO: remove empty groups\n            }\n\n            var mvp = group.mvp;\n            var mv = group.mv;\n            var mtmp = mvp; //use it as tmp matrix\n\n            if (useSuperElevation) {\n                //mat4.set(renderer.camera.getModelviewFMatrix(), mv);\n                mat4.multiply(renderer.camera.getModelviewFMatrix(), this.getWorldMatrix(group.bbox, cameraPos, mtmp), mv);\n            } else {\n                mat4.multiply(renderer.camera.getModelviewFMatrix(), this.getWorldMatrix(group.bbox, cameraPos, mtmp), mv);\n            }     \n        \n            var proj = renderer.camera.getProjectionFMatrix();\n            mat4.multiply(proj, mv, mvp);\n            \n            group.draw(mv, mvp, null, tiltAngle, (this.tile ? this.tile.texelSize : 1));\n\n            this.stats.drawnFaces += group.polygons;\n            this.stats.drawCalls += group.jobs.length;\n        }\n        \n        if (this.statsCoutner != this.stats.counter) {\n            this.statsCoutner = this.stats.counter;\n            this.stats.gpuRenderUsed += this.size;\n        }\n    }\n    return this.ready;\n};\n\n//MapGeodataView.prototype.getSize = function() {\n    //return this.size;\n//};\n\nexport default MapGeodataView;\n","\nimport MapGeodataView_ from './geodata-view';\nimport {utils as utils_} from '../utils/utils';\n\n//get rid of compiler mess\nvar MapGeodataView = MapGeodataView_;\nvar utils = utils_;\n\n\nvar MapDrawTiles = function(map, draw) {\n    this.map = map;\n    this.config = map.config;\n    this.isProjected = this.map.getNavigationSrs().isProjected();\n    this.stats = map.stats;\n    this.draw = draw;\n    this.debug = draw.debug;\n    this.core = map.core;\n    this.camera = map.camera;\n\n    this.renderer = map.renderer;\n\n    this.getTextSize = this.renderer.draw.getTextSize.bind(this.renderer.draw);\n    this.drawText = this.renderer.draw.drawText.bind(this.renderer.draw);\n};\n\n\nMapDrawTiles.prototype.drawSurfaceTile = function(tile, node, cameraPos, pixelSize, priority, preventRedener, preventLoad, doNotCheckGpu) {\n    if (this.stats.gpuRenderUsed >= this.draw.maxGpuUsed) {\n        return false;\n    }\n\n    tile.renderReady = false;\n    \n    if (tile.surface) {\n        if (node.hasGeometry()) {\n\n            if (this.debug.drawBBoxes && !preventRedener) {\n                if (tile.surface.geodata || !this.debug.drawGeodataOnly) {\n                    this.drawTileInfo(tile, node, cameraPos, tile.surfaceMesh, pixelSize);\n                }\n            }\n\n            if (this.debug.heightmapOnly && !preventRedener) {\n                if (!tile.surface.geodata) {\n                    tile.drawGrid(cameraPos);\n                }\n                return true;\n            }\n           \n            if (!preventRedener) {\n                this.stats.renderedLods[tile.id[0]]++;\n                this.stats.drawnTiles++;\n\n                if (tile.surface.geodata && this.renderer.drawnGeodataTilesUsed) {    //used in scr-count2 !!! legacy mode, do not remove\n\n                    var pp = this.renderer.project2(\n                        [(node.bbox2[12] + node.bbox2[15] + node.bbox2[18] + node.bbox2[21])*0.25 - cameraPos[0],\n                         (node.bbox2[13] + node.bbox2[16] + node.bbox2[19] + node.bbox2[22])*0.25 - cameraPos[1],\n                         (node.bbox2[14] + node.bbox2[17] + node.bbox2[20] + node.bbox2[23])*0.25 - cameraPos[2]],\n                         this.camera.getMvpMatrix());\n\n                    if (!(pp[0] < 0 || pp[1] < 0 || pp[0] > this.renderer.curSize[0] || pp[1] > this.renderer.curSize[1])) {\n                        this.stats.drawnGeodataTilesPerLayer++;\n                        this.stats.drawnGeodataTilesFactor += Math.pow(Math.abs(tile.tiltAngle * tile.texelSize), VTS_TILE_COUNT_FACTOR);\n                    }\n\n                    this.stats.drawnGeodataTiles++;\n                }\n            }\n\n            var count = 0;\n           \n            do {\n\n                if (tile.resetDrawCommands) {\n                    tile.drawCommands = [[], [], []];\n                    tile.updateBounds = true;\n            \n                    if (tile.bounds) {\n                        for (var key in tile.bounds) {\n                            tile.bounds[key].viewCoutner = 0; \n                        }\n                    }\n                    \n                    tile.resetDrawCommands = false;\n                }\n\n                var ret;\n\n                if (!tile.surface.geodata) {\n                    ret = this.drawMeshTile(tile, node, cameraPos, pixelSize, priority, preventRedener, preventLoad, doNotCheckGpu);\n                } else {\n                    ret = this.drawGeodataTile(tile, node, cameraPos, pixelSize, priority, preventRedener, preventLoad, doNotCheckGpu);\n                }\n\n                //if (count > 0) console.log('loop: ' + count);\n\n                count++;\n\n                if (count > 10) {\n                    break; //prevent infinite loop\n                }\n\n            } while(tile.resetDrawCommands);\n\n            return ret;\n        } else {\n            return true;\n        }\n    } else {\n        if (!preventRedener && tile.lastRenderState) {\n            var channel = this.draw.drawChannel;\n            this.draw.processDrawCommands(cameraPos, tile.lastRenderState.drawCommands[channel], priority, true, tile);\n            this.map.applyCredits(tile);\n            return true;\n        }\n    }\n};\n\n\n\nMapDrawTiles.prototype.drawMeshTile = function(tile, node, cameraPos, pixelSize, priority, preventRedener, preventLoad, doNotCheckGpu) {\n    var path;\n\n    if (!tile.surfaceMesh) {\n        if (tile.resourceSurface.virtual) {\n            return true;\n        }\n        \n        path = tile.resourceSurface.getMeshUrl(tile.id);\n        tile.surfaceMesh = tile.resources.getMesh(path, tile);\n    }\n\n    var draw = this.draw, texture, layer, credits;\n    var channel = draw.drawChannel;\n    var ret = false;\n\n    //we have commnad so we can draw them\n    if (tile.drawCommands[channel].length > 0 && this.draw.areDrawCommandsReady(tile.drawCommands[channel], priority, preventLoad, doNotCheckGpu)) {\n        if (!preventRedener) {\n            draw.processDrawCommands(cameraPos, tile.drawCommands[channel], priority, null, tile);\n            this.map.applyCredits(tile);\n        }\n\n        tile.lastRenderState = null;\n        return true;\n    } else if (tile.lastRenderState){ //we do not have cammnds or command are not redy yet, so we can draw last state if present and ready\n\n        if (tile.surfaceMesh.isReady(true, priority, doNotCheckGpu) && tile.drawCommands[channel].length > 0) {\n            if (this.draw.areDrawCommandsReady(tile.lastRenderState.drawCommands[channel], priority, preventLoad, doNotCheckGpu)) {\n                if (!preventRedener) {\n                    draw.processDrawCommands(cameraPos, tile.lastRenderState.drawCommands[channel], priority, true, tile);\n                    this.map.applyCredits(tile);\n                }\n                return true; // commands are generated so we can return from function here\n            } // else ret = false\n        } else {\n            if (this.draw.areDrawCommandsReady(tile.lastRenderState.drawCommands[channel], priority, preventLoad, doNotCheckGpu)) {\n                if (!preventRedener) {\n                    draw.processDrawCommands(cameraPos, tile.lastRenderState.drawCommands[channel], priority, true, tile);\n                    this.map.applyCredits(tile);\n                }\n                ret = true;\n            }\n        }\n    }\n\n    if (tile.drawCommands[channel].length > 0) {  //command are generated but not ready, we can return from the function\n\n        if (this.config.mapHeightfiledWhenUnloaded && !preventRedener) {\n            tile.drawGrid(cameraPos);\n            return false;\n        } else {\n            return false;\n        }\n    } \n\n    // information about support for extarnal or internal textures are present in the mesh,  \n    // so we have to wait until is mesh ready and then we can generate commands\n    if (tile.surfaceMesh.isReady(preventLoad, priority, doNotCheckGpu) && !preventLoad) {\n        var submeshes = tile.surfaceMesh.submeshes;\n\n        tile.drawCommands = [[], [], []]; //??\n        tile.imageryCredits = {};\n        tile.boundsDebug = {}; //used for inspector\n\n        var specificity = 0;\n        var i, li, j, lj, k, lk, surface;\n\n        surface = tile.resourceSurface;\n\n        if (!surface) {\n            surface = tile.surface;\n        }\n        \n        if (surface.glue) {\n\n            var surfaces = surface.id; \n            for (i = 0, li = surfaces.length; i < li; i++) {\n                var surface2 = this.map.getSurface(surfaces[i]);\n                if (surface2) {\n                    specificity = Math.max(specificity, surface2.specificity);\n                }\n            }\n\n            //set credits\n            for (k = 0, lk = node.credits.length; k < lk; k++) {\n                tile.glueImageryCredits[node.credits[k]] = specificity;  \n            }\n\n        } else {\n\n            specificity = surface.specificity;\n\n            //set credits\n            for (k = 0, lk = node.credits.length; k < lk; k++) {\n                tile.imageryCredits[node.credits[k]] = specificity;  \n            }\n        }\n\n\n        for (i = 0, li = submeshes.length; i < li; i++) {\n\n            var submesh = submeshes[i];\n            \n            //debug bbox\n            if (this.debug.drawBBoxes && this.debug.drawMeshBBox && !preventRedener) {\n                submesh.drawBBox(cameraPos);\n            }\n\n            if (submesh.externalUVs) {\n                if (tile.updateBounds) {\n                    tile.updateBounds = false;\n                    \n                    this.updateTileBounds(tile, submeshes);\n                }\n                \n                surface = tile.resourceSurface;\n                if (tile.resourceSurface.glue /*&& submesh.surfaceReference != 0*/) { //glue have multiple surfaces per tile\n                    surface = tile.resourceSurface.getSurfaceReference(submesh.surfaceReference);\n                }\n\n                if (surface != null) {\n                    var bounds = tile.bounds[surface.id];\n                    \n                    if (bounds) {\n                        if (submesh.externalUVs) {\n\n                            //draw bound layers\n                            if (bounds.sequence.length > 0) {\n                                if (bounds.transparent) {\n                                    if (submesh.internalUVs) {  //draw surface\n                                        if (tile.surfaceTextures[i] == null) {\n                                            path = tile.resourceSurface.getTextureUrl(tile.id, i);\n                                            tile.surfaceTextures[i] = tile.resources.getTexture(path, VTS_TEXTURETYPE_COLOR, null, null, tile, true);\n                                        }\n                                                \n                                        tile.drawCommands[0].push({\n                                            type : VTS_DRAWCOMMAND_SUBMESH,\n                                            mesh : tile.surfaceMesh,\n                                            submesh : i,\n                                            texture : tile.surfaceTextures[i],\n                                            material : VTS_MATERIAL_INTERNAL_NOFOG\n                                        });\n                                    }\n    \n                                    tile.drawCommands[0].push({\n                                        type : VTS_DRAWCOMMAND_STATE,\n                                        state : draw.drawBlendedTileState\n                                    });            \n                                    \n                                    var layers = bounds.sequence;\n                                    for (j = 0, lj = layers.length; j < lj; j++) {\n                                        texture = tile.boundTextures[layers[j]];\n                                        if (texture) {\n\n                                            //debug stuff\n                                            if (!tile.boundsDebug[surface.id]) {\n                                                tile.boundsDebug[surface.id] = [];\n                                            }\n                                            tile.boundsDebug[surface.id].push(layers[j]);\n\n                                            //set credits\n                                            layer = tile.boundLayers[layers[j]];\n                                            credits = layer.credits;\n                                            for (k = 0, lk = credits.length; k < lk; k++) {\n                                                tile.imageryCredits[credits[k]] = layer.specificity;  \n                                            }\n\n                                            tile.drawCommands[0].push({\n                                                type : VTS_DRAWCOMMAND_SUBMESH,\n                                                mesh : tile.surfaceMesh,\n                                                submesh : i,\n                                                texture : texture,\n                                                alpha : bounds.alpha[layers[j]][1],\n                                                material : VTS_MATERIAL_EXTERNAL_NOFOG,\n                                                layer : layer,\n                                                surface : surface\n                                            });\n                                        }\n                                    }\n                                    \n                                    tile.drawCommands[0].push({\n                                        type : VTS_DRAWCOMMAND_SUBMESH,\n                                        mesh : tile.surfaceMesh,\n                                        submesh : i,\n                                        texture : null,\n                                        material : VTS_MATERIAL_FOG\n                                    });                                                \n\n                                    tile.drawCommands[0].push({\n                                        type : VTS_DRAWCOMMAND_STATE,\n                                        state : draw.drawTileState\n                                    });  \n                                } else {\n                                    var layerId = bounds.sequence[bounds.sequence.length-1];\n                                    texture = tile.boundTextures[layerId];\n                                    if (texture) {\n\n                                        //debug stuff\n                                        if (!tile.boundsDebug[surface.id]) {\n                                            tile.boundsDebug[surface.id] = [];\n                                        }\n                                        tile.boundsDebug[surface.id].push(layerId);\n                                        \n                                        //set credits\n                                        layer = tile.boundLayers[layerId];\n                                        credits = layer.credits;\n                                        for (k = 0, lk = credits.length; k < lk; k++) {\n                                            tile.imageryCredits[credits[k]] = layer.specificity;  \n                                        }\n                                        \n                                        tile.drawCommands[0].push({\n                                            type : VTS_DRAWCOMMAND_SUBMESH,\n                                            mesh : tile.surfaceMesh,\n                                            submesh : i,\n                                            texture : texture,\n                                            material : VTS_MATERIAL_EXTERNAL,\n                                            layer : layer,\n                                            surface : surface\n                                        });\n                                    }\n                                }\n                               \n                            } else {\n                                if (submesh.textureLayer) {\n                                    \n                                    layer = this.map.getBoundLayerByNumber(submesh.textureLayer);\n                                    \n                                    if (layer) {\n                                        texture = tile.boundTextures[layer.id];\n                                        \n                                        if (texture) {\n                                            \n                                            //debug stuff\n                                            if (!tile.boundsDebug[surface.id]) {\n                                                tile.boundsDebug[surface.id] = [];\n                                            }\n                                            tile.boundsDebug[surface.id].push(layer.id);\n                                            \n                                            //set credits\n                                            layer = tile.boundLayers[layer.id];\n                                            credits = layer.credits;\n                                            for (k = 0, lk = credits.length; k < lk; k++) {\n                                                tile.imageryCredits[credits[k]] = layer.specificity;  \n                                            }\n                                            \n                                            //draw mesh\n                                            tile.drawCommands[0].push({\n                                                type : VTS_DRAWCOMMAND_SUBMESH,\n                                                mesh : tile.surfaceMesh,\n                                                submesh : i,\n                                                texture : texture,\n                                                material : VTS_MATERIAL_EXTERNAL,\n                                                layer : layer,\n                                                surface : surface\n                                            });\n                                        }\n                                    }\n                                   \n                                } else {\n    \n                                    if (submesh.internalUVs) {  //draw surface\n                                        if (tile.surfaceTextures[i] == null) {\n                                            path = tile.resourceSurface.getTextureUrl(tile.id, i);\n                                            tile.surfaceTextures[i] = tile.resources.getTexture(path, VTS_TEXTURETYPE_COLOR, null, null, tile, true);\n                                        }\n\n                                        //draw mesh\n                                        tile.drawCommands[0].push({\n                                            type : VTS_DRAWCOMMAND_SUBMESH,\n                                            mesh : tile.surfaceMesh,\n                                            submesh : i,\n                                            texture : tile.surfaceTextures[i],\n                                            material : VTS_MATERIAL_INTERNAL\n                                        });\n                                    } else {\n                                        tile.drawCommands[0].push({\n                                            type : VTS_DRAWCOMMAND_SUBMESH,\n                                            mesh : tile.surfaceMesh,\n                                            submesh : i,\n                                            texture : null,\n                                            material : VTS_MATERIAL_FLAT\n                                        });\n                                    }\n    \n                                }\n                            }\n    \n                        } else if (submesh.internalUVs) {\n    \n                            if (tile.surfaceTextures[i] == null) {\n                                path = tile.resourceSurface.getTextureUrl(tile.id, i);\n                                tile.surfaceTextures[i] = tile.resources.getTexture(path, VTS_TEXTURETYPE_COLOR, null, null, tile, true);\n                            } //else {\n                            tile.drawCommands[0].push({\n                                type : VTS_DRAWCOMMAND_SUBMESH,\n                                mesh : tile.surfaceMesh,\n                                submesh : i,\n                                texture : tile.surfaceTextures[i],\n                                material : VTS_MATERIAL_INTERNAL\n                            });                                                \n                            //}\n                        }\n                    }                            \n                }\n            } else if (submesh.internalUVs) {\n\n                if (tile.surfaceTextures[i] == null) {\n                    path = tile.resourceSurface.getTextureUrl(tile.id, i);\n                    tile.surfaceTextures[i] = tile.resources.getTexture(path, VTS_TEXTURETYPE_COLOR, null, null, tile, true);\n                } //else {\n                tile.drawCommands[0].push({\n                    type : VTS_DRAWCOMMAND_SUBMESH,\n                    mesh : tile.surfaceMesh,\n                    submesh : i,\n                    texture : tile.surfaceTextures[i],\n                    material : VTS_MATERIAL_INTERNAL\n                });                                                \n                //}\n            }\n            \n            //depth path\n            tile.drawCommands[1].push({\n                type : VTS_DRAWCOMMAND_SUBMESH,\n                mesh : tile.surfaceMesh,\n                submesh : i,\n                material : VTS_MATERIAL_DEPTH\n            });\n            \n        }\n\n        if (surface.pipeline > VTS_PIPELINE_BASIC) {\n            this.updateTileHmap(tile, node);\n\n            for (j = 0; j < 2; j++) {\n                var commands = tile.drawCommands[j];\n                for (i = 0, li = commands.length; i < li; i++) {\n                    if (commands[i].type == VTS_DRAWCOMMAND_SUBMESH) {\n                        commands[i].pipeline = surface.pipeline;\n                        commands[i].hmap = tile.hmap;\n                    }\n                }\n            }\n        }\n\n        if (tile.resetDrawCommands) {\n            return false;\n        }\n\n        if (draw.areDrawCommandsReady(tile.drawCommands[channel], priority, preventLoad, doNotCheckGpu)) {\n\n            if (tile.resetDrawCommands) {\n                return false;\n            }\n\n            if (!preventRedener) {\n                draw.processDrawCommands(cameraPos, tile.drawCommands[channel], priority, null, tile);\n                this.map.applyCredits(tile);\n            }\n\n            tile.lastRenderState = null;\n            ret = true;\n        } else if (tile.lastRenderState) {\n\n            if (this.draw.areDrawCommandsReady(tile.lastRenderState.drawCommands[channel], priority, preventLoad, doNotCheckGpu)) {\n                if (!preventRedener) {\n                    draw.processDrawCommands(cameraPos, tile.lastRenderState.drawCommands[channel], priority, true, tile);\n                    this.map.applyCredits(tile);\n                }\n                ret = true;\n            } //else ret = false\n        } else {\n\n            if (this.config.mapHeightfiledWhenUnloaded && !preventRedener) {\n\n                //node.drawPlane(cameraPos, tile);\n                tile.drawGrid(cameraPos);\n                ret = !(tile.drawCommands[channel].length > 0);\n            }\n        }\n        \n    } else {\n\n        if (!tile.lastRenderState && this.config.mapHeightfiledWhenUnloaded && !preventRedener) {\n            //node.drawPlane(cameraPos, tile);\n\n            tile.drawGrid(cameraPos);\n            ret = !(tile.drawCommands[channel].length > 0);\n        }        \n    }\n    \n    return ret;\n};\n\n\nMapDrawTiles.prototype.drawGeodataTile = function(tile, node, cameraPos, pixelSize, priority, preventRedener, preventLoad, doNotCheckGpu) {\n    if (tile.id[0] <= 1) {\n        return true;\n    }\n\n    if (tile.surfaceGeodata == null) {\n        var path;\n        \n        if (tile.surface.geodataNavtileInfo) {  //remove this code??? no longer used\n            var navtile = this.tree.findNavTile(tile.id);\n            \n            if (navtile && navtile.surface) {\n                var navtileStr = navtile.surface.getNavUrl(navtile.id) + ';'\n                                  + navtile.id[0] + '-' + navtile.id[1] + '-' + navtile.id[2] + ';'      \n                                  + navtile.metanode.minHeight + ';' + navtile.metanode.maxHeight;     \n                path = tile.surface.getGeodataUrl(tile.id, encodeURIComponent(navtileStr));\n            }\n        }\n        \n        if (!path) {\n            path = tile.resourceSurface.getGeodataUrl(tile.id, '');\n        }\n\n        tile.surfaceGeodata = tile.resources.getGeodata(path, {tile:tile, surface:tile.surface});\n    }\n\n    var channel = this.draw.drawChannel;\n    \n    if (tile.geodataCounter != tile.surface.geodataCounter) {\n        tile.drawCommands = [[],[],[]];\n\n        if (tile.surfaceGeodataView != null) {\n            tile.surfaceGeodataView.kill();\n        }\n        \n        tile.surfaceGeodataView = null;\n        tile.geodataCounter = tile.surface.geodataCounter;\n    }\n\n    if (tile.drawCommands[channel].length > 0 && this.draw.areDrawCommandsReady(tile.drawCommands[channel], priority, preventLoad, doNotCheckGpu)) {\n        if (!preventRedener) {\n            this.draw.processDrawCommands(cameraPos, tile.drawCommands[channel], priority, null, tile);\n            this.map.applyCredits(tile);\n        }\n        tile.lastRenderState = null;\n        return true;\n    }\n\n    if (!tile.surfaceGeodataView) {\n        if (tile.surfaceGeodata.isReady(preventLoad, priority, doNotCheckGpu) && !preventLoad) {\n            tile.surfaceGeodataView = new MapGeodataView(this.map, tile.surfaceGeodata, {tile:tile, surface:tile.surface});\n        }\n    }\n\n    if (tile.surfaceGeodataView) {\n        tile.mapdataCredits = {};\n        \n        var specificity = (tile.surface) ? tile.surface.specificity : 0;\n\n        //set credits\n        for (var k = 0, lk = node.credits.length; k < lk; k++) {\n            tile.mapdataCredits[node.credits[k]] = specificity;  \n        }\n\n        tile.drawCommands[channel][0] = {\n            type : VTS_DRAWCOMMAND_GEODATA,\n            geodataView : tile.surfaceGeodataView \n        };\n\n        return tile.surfaceGeodataView.isReady();\n    }\n\n    return false;\n};\n\n\nMapDrawTiles.prototype.updateTileHmap = function(tile, node) {\n    if (node && node.hasNavtile() && tile.surface) { \n\n        if (!tile.surface || !tile.resourceSurface) { //surface.virtual) {\n            return false; //is it best way how to do it?\n        }\n            \n        if (!tile.resourceSurface.getHMapUrl) { //virtual surface is as resource surface. Is it bug??!!\n            return false; //is it best way how to do it?\n        }\n            \n        var path = tile.resourceSurface.getHMapUrl(tile.id, true);\n        tile.hmap = tile.resources.getTexture(path);\n\n        //var path = tile.surface.getNavUrl(tile.id);\n        //tile.hmap = tile.resources.getTexture(path, null, null, null, tile, true);\n    } else {\n\n        //get parent with nav tile\n        var parent = tile.parent;\n        var extraBound = null; \n\n        while(parent && parent.id[0] > 0) {\n            if (parent.metanode && parent.metanode.hasNavtile()) {\n                extraBound = {\n                    sourceTile : parent,\n                    sourceTexture : null,\n                    hmap : true,\n                    tile : tile \n                };\n\n                break;\n            }\n\n            parent = parent.parent;\n        }\n\n        //does parent with navtile exist\n        if (extraBound) {\n            var path = tile.resourceSurface.getHMapUrl(tile.id, true);\n            tile.hmap = tile.resources.getTexture(path, null, extraBound, {tile: tile, hmap: true}, tile, false);\n\n            if (tile.hmap.neverReady) {\n                tile.hmap = null;\n            }\n        } else {\n            tile.hmap = null;\n        }\n    }\n};\n\n\nMapDrawTiles.prototype.updateTileBounds = function(tile, submeshes) {\n    for (var i = 0, li = submeshes.length; i < li; i++) {\n        var submesh = submeshes[i];\n        \n        if (submesh.externalUVs) {\n            var submeshSurface = tile.resourceSurface;\n\n            //if (tile.resourceSurface.glue) { //glue have multiple surfaces per tile\n              //  submeshSurface = tile.resourceSurface.getSurfaceReference(submesh.surfaceReference);\n            //}\n\n            if (tile.resourceSurface.glue) { //glue have multiple surfaces per tile\n                submeshSurface = tile.resourceSurface.getSurfaceReference(submesh.surfaceReference);\n            }\n\n            \n            if (submeshSurface) {\n                var bounds = tile.bounds[submeshSurface.id];\n                \n                if (!bounds) {\n                    bounds = {\n                        sequence : [],\n                        alpha : [],\n                        transparent : false,\n                        viewCoutner : 0\n                    };\n                    \n                    tile.bounds[submeshSurface.id] = bounds;\n                } \n                \n                if (bounds.viewCoutner != tile.viewCoutner) {\n                    this.updateTileSurfaceBounds(tile, submesh, submeshSurface, bounds, bounds.viewCoutner != tile.viewCoutner);\n                    //bounds.viewCoutner = tile.viewCoutner;\n                }  \n            }\n        }\n    }\n\n    for (var key in tile.bounds) {\n        tile.bounds[key].viewCoutner = tile.viewCoutner;\n    }\n};\n\n\nMapDrawTiles.prototype.getParentTile = function(tile, lod) {\n    while(tile && tile.id[0] > lod) {\n        tile = tile.parent;\n    }\n    \n    return tile;\n};\n\n\nMapDrawTiles.prototype.getTileTextureTransform = function(sourceTile, targetTile) {\n    var shift = targetTile.id[0] - sourceTile.id[0];\n    var x = sourceTile.id[1] << shift;\n    var y = sourceTile.id[2] << shift;\n    var s = 1.0 / Math.pow(2.0, shift);\n    return [ s, s, (targetTile.id[1] - x) * s, (targetTile.id[2] - y) * s ];\n};\n\n\nMapDrawTiles.prototype.updateTileSurfaceBounds = function(tile, submesh, surface, bound, fullUpdate) {\n    var path, extraBound, layer, texture;\n\n    if (this.config.mapNoTextures) {\n        return;\n    }\n\n    //search map view\n    if (surface.boundLayerSequence.length > 0) {\n        if (fullUpdate) {\n            bound.sequence = [];\n            var sequenceFullAndOpaque = [];\n            var sequenceMaskPosible = [];\n            var fullAndOpaqueCounter = 0;\n            \n            for (var j = 0, lj = surface.boundLayerSequence.length; j < lj; j++) {\n                layer = surface.boundLayerSequence[j][0];\n                \n                if (layer && layer.ready && layer.hasTileOrInfluence(tile.id) && surface.boundLayerSequence[j][1] > 0) {\n                    extraBound = null; \n                    \n                    if (tile.id[0] > layer.lodRange[1]) {\n                        extraBound = {\n                            sourceTile : this.getParentTile(tile, layer.lodRange[1]),\n                            sourceTexture : null,\n                            layer : layer,\n                            tile : tile \n                        };\n                    }\n\n                    texture = tile.boundTextures[layer.id];\n\n                    if (!texture) { //TODO: make sure that we load only textures which we need  \n                        path = layer.getUrl(tile.id);\n                        texture = tile.resources.getTexture(path, layer.dataType, extraBound, {tile: tile, layer: layer}, tile, false);\n\n                        if (texture.checkType == VTS_TEXTURECHECK_MEATATILE) {\n                            texture.checkMask = true;\n                        }\n\n                        texture.isReady(true); //check for mask but do not load\n                        tile.boundTextures[layer.id] = texture; \n                    } \n\n                    if (texture.neverReady) {\n                        continue; //do not use this layer\n                    }\n\n                    var maskPosible = false;\n                    var skipOther = false;\n\n                    if (texture.isMaskPosible()) {\n                        if (texture.isMaskInfoReady()) {\n                            if (texture.getMaskTexture()) {\n                                bound.transparent = true;\n                                maskPosible = true;\n                            }\n                        } else {\n                            skipOther = true;\n                            maskPosible = true;\n                        }\n                    }\n\n                    sequenceMaskPosible.push(maskPosible);\n                    \n                    //var fullAndOpaque = !((surface.boundLayerSequence[j][1] < 1.0) || texture.extraBound || texture.getMaskTexture() || layer.isTransparent);\n                    var fullAndOpaque = !((surface.boundLayerSequence[j][1] < 1.0) || maskPosible || layer.isTransparent);\n                    if (fullAndOpaque) {\n                        fullAndOpaqueCounter++;\n                    }\n                            \n                    sequenceFullAndOpaque.push(fullAndOpaque);\n                    \n                    bound.sequence.push(layer.id);\n                    bound.alpha[layer.id] = surface.boundLayerSequence[j];\n                    tile.boundLayers[layer.id] = layer;\n                    if (bound.alpha[layer.id][1] < 1.0 || layer.isTransparent) {\n                        bound.transparent = true;\n                    }\n\n                    if (skipOther) {\n                        break; //wait until mask info is loaded\n                    }\n                }\n            }\n\n            //filter out extra bounds if they are not needed\n            //and remove all layer after first FullAndOpaque \n            if (fullAndOpaqueCounter > 0) {\n                var newSequence = [];\n                \n                for (var i = bound.sequence.length - 1; i >= 0; i--) {\n                    var layerId = bound.sequence[i];\n                    \n                    if (sequenceFullAndOpaque[i]) {\n                        newSequence.unshift(layerId);   \n                        break;\n                    } else {\n                        texture = tile.boundTextures[layerId];\n\n                        if (bound.alpha[layerId][1] < 1.0 ||\n                            tile.boundLayers[layerId].isTransparent ||\n                            (sequenceMaskPosible[i] /*texture.getMaskTexture() /*&& !texture.extraBound*/)) {\n                            newSequence.unshift(layerId);    \n                        }\n                    }\n                }\n                \n                bound.sequence = newSequence; \n            }\n            \n        }\n    } else if (surface.textureLayer != null) { //search surface\n        if (fullUpdate) {\n            layer = this.map.getBoundLayerById(surface.textureLayer);\n            if (layer && layer.hasTileOrInfluence(tile.id)) {\n                extraBound = null; \n                \n                if (tile.id[0] > layer.lodRange[1]) {\n                    extraBound = {\n                        sourceTile : this.getParentTile(tile, layer.lodRange[1]),\n                        sourceTexture : null,\n                        layer : layer,\n                        tile : tile \n                    };\n                }\n\n                bound.sequence.push(layer.id);\n                tile.boundLayers[layer.id] = layer;\n                if (!tile.boundTextures[layer.id]) {\n                    path = layer.getUrl(tile.id);\n                    tile.boundTextures[layer.id] = tile.resources.getTexture(path, layer.dataType, extraBound, {tile: tile, layer: layer}, tile, false);\n                }\n            }\n        }\n    } else { //search submeshes\n        if (submesh.textureLayer != 0) {\n            layer = this.map.getBoundLayerByNumber(submesh.textureLayer);\n\n            if (layer && layer.hasTileOrInfluence(tile.id)) {\n                extraBound = null; \n                \n                if (tile.id[0] > layer.lodRange[1]) {\n                    extraBound = {\n                        sourceTile : this.getParentTile(tile, layer.lodRange[1]),\n                        sourceTexture : null,\n                        layer : layer,\n                        tile : tile \n                    };\n                }\n\n                //submeshes[j].textureLayerId = tile.id;\n                tile.boundLayers[layer.id] = layer;\n                if (!tile.boundTextures[layer.id]) {\n                    path = layer.getUrl(tile.id);\n                    tile.boundTextures[layer.id] = tile.resources.getTexture(path, layer.dataType, extraBound, {tile: tile, layer: layer}, tile, false);\n                }\n            }\n        }\n    }\n};\n\n\nMapDrawTiles.prototype.drawTileInfo = function(tile, node, cameraPos, mesh) {\n    var debug = this.debug, pos;\n\n    if (!debug.drawMeshBBox) {\n        node.drawBBox(cameraPos);\n    }\n\n    //get screen pos of node\n    if (node.metatile.useVersion < 4) {\n        var min = node.bbox.min;\n        var max = node.bbox.max;\n    \n        pos =  this.core.getRendererInterface().getCanvasCoords(\n            [(min[0] + (max[0] - min[0])*0.5) - cameraPos[0],\n                (min[1] + (max[1] - min[1])*0.5) - cameraPos[1],\n                (max[2]) - cameraPos[2]],\n             this.camera.getMvpMatrix());\n    \n        pos[2] = pos[2] * 0.9992;\n    } else {\n        var dx = node.bbox2[3] - node.bbox2[0]; \n        var dy = node.bbox2[4] - node.bbox2[1]; \n        var dz = node.bbox2[5] - node.bbox2[2]; \n    \n        var d = Math.sqrt(dx*dx + dy*dy + dz*dz);\n    \n        pos =  this.core.getRendererInterface().getCanvasCoords(\n            [(node.bbox2[12] + node.bbox2[15] + node.bbox2[18] + node.bbox2[21])*0.25 + node.diskNormal[0] * d*0.1 - cameraPos[0],\n                (node.bbox2[13] + node.bbox2[16] + node.bbox2[19] + node.bbox2[22])*0.25 + node.diskNormal[1] * d*0.1 - cameraPos[1],\n                (node.bbox2[14] + node.bbox2[17] + node.bbox2[20] + node.bbox2[23])*0.25 + node.diskNormal[2] * d*0.1 - cameraPos[2]],\n             this.camera.getMvpMatrix());\n        \n        /*\n            var pos =  this.core.getRendererInterface().getCanvasCoords(\n                            [(node.diskPos[0] + node.diskNormal[0] * node.bboxHeight) - cameraPos[0],\n                             (node.diskPos[1] + node.diskNormal[1] * node.bboxHeight) - cameraPos[1],\n                             (node.diskPos[2] + node.diskNormal[2] * node.bboxHeight) - cameraPos[2]],\n                             this.camera.getMvpMatrix());\n        */\n    }\n\n    var factor = debug.debugTextSize, text, i, li,c;\n\n    //draw lods\n    if (debug.drawLods) {\n        text = '' + tile.id[0]; // + ' ta:' + Math.abs(tile.tiltAngle).toFixed(3);\n        //text = '' + tile.id[0] + ' c:' + (50*(Math.pow(Math.abs(tile.tiltAngle * tile.texelSize), VTS_TILE_COUNT_FACTOR) / Math.max(0.00001, this.renderer.drawnGeodataTilesFactor))).toFixed(3) + \n          //     ' l:' + Math.pow(Math.abs(tile.tiltAngle * tile.texelSize), VTS_TILE_COUNT_FACTOR).toFixed(3) + ' g:' + this.renderer.drawnGeodataTilesFactor.toFixed(3);\n        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]-4*factor), 4*factor, text, [1,0,0,1], pos[2]);\n    }\n\n    //draw indices\n    if (debug.drawIndices) {\n        text = '' + tile.id[1] + ' ' + tile.id[2];\n        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]-11*factor), 4*factor, text, [0,1,1,1], pos[2]);\n    }\n\n    //draw positions\n    if (debug.drawPositions) {\n        //text = \"\" + min[0].toFixed(1) + \" \" + min[1].toFixed(1) + \" \" + min[2].toFixed(1);\n        //text = \"\" + Math.floor(node.corners[0]) + \" \" + Math.floor(node.corners[1]) + \" \" + Math.floor(node.corners[2]) + \" \" + Math.floor(node.corners[3]);\n        \n        var b = node.border2;\n        if (b) {\n            text = '' + Math.floor(b[0]) + ' ' + Math.floor(b[1]) + ' ' + Math.floor(b[2]) + ' ' + Math.floor(b[3]) + ' ' + Math.floor(b[4]) + ' ' + Math.floor(b[5]) + ' ' + Math.floor(b[6]) + ' ' + Math.floor(b[7]) + ' ' + Math.floor(b[8]);\n            this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+3*factor), 4*factor, text, [0,1,1,1], pos[2]);\n        }\n\n        b = node.border;\n        if (b) {\n            draw.getDrawCommandsGpuSize(tile.drawCommands[draw.drawChannel] || tile.lastRenderState.drawCommands[draw.drawChannel]); Math.floor(b[0]) + ' ' + Math.floor(b[1]) + ' ' + Math.floor(b[2]) + ' ' + Math.floor(b[3]) + ' ' + Math.floor(b[4]) + ' ' + Math.floor(b[5]) + ' ' + Math.floor(b[6]) + ' ' + Math.floor(b[7]) + ' ' + Math.floor(b[8]);\n            this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+10*factor), 4*factor, text, [0,1,1,1], pos[2]);\n        }\n\n        //text = 'llx:' + Math.floor(node.llx) + ' lly:' + Math.floor(node.lly) + ' urx:' + Math.floor(node.urx) + ' ury:' + Math.floor(node.ury);\n        //this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+3*factor), 4*factor, text, [0,1,1,1], pos[2]);\n    }\n\n    //draw resources\n    if (debug.drawResources && mesh) {\n        text = '' + (this.draw.getDrawCommandsGpuSize(tile.drawCommands[0] || tile.lastRenderState.drawCommands[0])/(1024*1024)).toFixed(2) + 'MB';\n        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+10*factor), 4*factor, text, [0,1,0,1], pos[2]);\n    }\n\n    //draw face count\n    if (debug.drawFaceCount && mesh) {\n        text = '' + mesh.faces + ' - ' + mesh.submeshes.length + ((tile.surface && tile.surface.glue) ? ' - 1' : ' - 0');\n        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+10*factor), 4*factor, text, [0,1,0,1], pos[2]);\n    }\n\n    //draw geodata pixel size\n    if (debug.drawGPixelSize) {\n        text = '' + ((Math.tan(tile.metanode.diskAngle2A) * tile.metanode.diskDistance * 0.70710678118) / node.displaySize).toFixed(2);\n        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+10*factor), 4*factor, text, [0,1,0,1], pos[2]);\n    }\n\n    //draw order\n    if (debug.drawOrder) {\n        text = '' + this.drawTileCounter + ' cmds: ' + (tile.drawCommands[0].length);\n        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+10*factor), 4*factor, text, [0,1,0,1], pos[2]);\n    }\n\n    if (debug.drawSurfaces || debug.drawSurfaces2) {\n        text = JSON.stringify(tile.surface.id);\n\n        if (debug.drawSurfaces2) {\n            //c = utils.getHashColor(text);\n            c = utils.getHashColor2(tile.surface.surfaceCounter);\n            //c = [c[0]/255,c[1]/255,c[2]/255,1];\n            c = [c[0],c[1],c[2],1];\n        } else {\n            c = [1,1,1,1];    \n        }\n\n        if (node.alien) {\n            text = '[A]' + text;\n        }\n\n        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+10*factor), 4*factor, text, c, pos[2]);\n    }\n\n    if (debug.drawBoundLayers) {\n        if (tile.boundsDebug) {\n            var surface = tile.resourceSurface;\n            if (surface.glue) { \n              \n                for (i = 0, li = surface.id.length; i < li; i++) {\n                    if (tile.boundsDebug[surface.id[i]]) {\n                        text = '< ' + surface.id[i] + ' >';\n                        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+(10+i*7*2)*factor), 4*factor, text, [1,1,1,1], pos[2]);\n                        text = JSON.stringify(tile.boundsDebug[surface.id[i]]);\n                        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+(17+i*7*2)*factor), 4*factor, text, [1,1,1,1], pos[2]);\n                    }\n                }\n                \n            } else if (tile.boundsDebug[surface.id]) {\n                text = '< ' + surface.id + ' >';\n                this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+10*factor), 4*factor, text, [1,1,1,1], pos[2]);\n    \n                text = JSON.stringify(tile.boundsDebug[surface.id]);\n                this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+17*factor), 4*factor, text, [1,1,1,1], pos[2]);\n            }\n        }\n    }\n\n    if (debug.drawCredits) {\n        text = '{ ';\n       \n        for (var key in tile.imageryCredits) {\n            if (tile.imageryCredits[key]) {\n                text += key + ':' + tile.imageryCredits[key] + ', ';\n            }\n        }\n\n        for (key in tile.glueImageryCredits) {\n            if (!tile.imageryCredits[key]) {\n                text += key + ':' + tile.glueImageryCredits[key] + ', ';\n                //text += key + \", \";\n            }\n        }\n\n        text += '}';\n\n        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+10*factor), 4*factor, text, [1,1,1,1], pos[2]);\n    }\n\n    //draw distance\n    if (debug.drawDistance) {\n        text = '' + tile.distance.toFixed(2) + '  ' + tile.texelSize.toFixed(3) + '  ' + node.pixelSize.toFixed(3);\n        text += '--' + tile.texelSize2.toFixed(3); \n        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+17*factor), 4*factor, text, [1,0,1,1], pos[2]);\n    }\n\n    //draw node info\n    if (debug.drawNodeInfo) {\n        var children = ((node.flags & ((15)<<4))>>4);\n        text = 'v' + node.metatile.version + '-' + node.flags.toString(2) + '-' + ((children & 1) ? '1' : '0') + ((children & 2) ? '1' : '0') + ((children & 4) ? '1' : '0') + ((children & 8) ? '1' : '0');\n        text += '-' + node.minHeight + '/' + node.maxHeight+ '-' + Math.floor(node.minZ) + '/' + Math.floor(node.maxZ)+ '-' + Math.floor(node.surrogatez);\n        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]-18*factor), 4*factor, text, [1,0,1,1], pos[2]);\n    }\n    \n    //draw texture size\n    if (debug.drawTextureSize && mesh) {\n        var submeshes = mesh.submeshes;\n        for (i = 0, li = submeshes.length; i < li; i++) {\n\n            if (submeshes[i].internalUVs) {\n                var texture = tile.surfaceTextures[i];\n                if (texture) {\n                    var gpuTexture = texture.getGpuTexture();\n                    if (gpuTexture) {\n                        text = '[' + i + ']: ' + gpuTexture.width + ' x ' + gpuTexture.height;\n                        this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+(17+i*4*2)*factor), 4*factor, text, [1,1,1,1], pos[2]);\n                    }\n                }\n            } else {\n                text = '[' + i + ']: 256 x 256';\n                this.drawText(Math.round(pos[0]-this.getTextSize(4*factor, text)*0.5), Math.round(pos[1]+(17+i*4*2)*factor), 4*factor, text, [1,1,1,1], pos[2]);\n            }\n        }\n    }\n\n};\n\n\nexport default MapDrawTiles;\n\n","\nimport {vec3 as vec3_} from '../utils/matrix';\nimport {math as math_} from '../utils/math';\nimport MapGeodata_ from './geodata';\nimport MapGeodataView_ from './geodata-view';\nimport MapDrawTiles_ from './draw-tiles';\n\n//get rid of compiler mess\nvar vec3 = vec3_;\nvar math = math_;\nvar MapDrawTiles = MapDrawTiles_;\nvar MapGeodataView = MapGeodataView_;\nvar MapGeodata = MapGeodata_;\n\nvar MapDraw = function(map) {\n    this.map = map;\n    this.config = map.config;\n    this.isProjected = map.getNavigationSrs().isProjected();\n    this.isGeocent = map.isGeocent;\n\n    this.renderer = map.renderer;\n    this.stats = map.stats;\n    this.camera = map.camera;\n    this.tree = map.tree;\n\n    this.ndcToScreenPixel = this.renderer.curSize[0] * 0.5;\n\n    this.debug = {\n        heightmapOnly : false,\n        blendHeightmap : true,\n        drawBBoxes : false,\n        drawNBBoxes : false,\n        drawSpaceBBox : false,        \n        drawMeshBBox : false,\n        drawLods : false,\n        drawPositions : false,\n        drawTexelSize : false,\n        drawWireframe : 0,\n        drawTestMode : 0,\n        drawTestData : 0,\n        drawFaceCount : false,\n        drawDistance : false,\n        drawMaxLod : false,\n        drawGeodataOnly : false,\n        drawTextureSize : false,\n        drawNodeInfo : false,\n        drawLayers : true,\n        drawBoundLayers : false,\n        drawSurfaces : false,\n        drawCredits : false,\n        drawOrder : false,\n        drawLabelBoxes : false,\n        drawAllLabels : false,\n        drawHiddenLabels : false,\n        drawEarth : true, \n        drawGridCells : false,\n        drawTileCounter : 0,\n        drawPolyWires : false,\n        drawFog : this.config.mapFog,\n        drawGPixelSize : false,\n        debugTextSize : 2.0,\n        ignoreTexelSize : false,\n        maxZoom : false\n    };\n\n    this.gridFlat = false;\n    this.gridGlues = false;\n    this.gridSkipped = false;\n\n    this.atmoColor = [216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0];\n    this.atmoColor2 = [72.0/255.0, 154.0/255.0, 255.0/255.0, 1.0];\n    this.atmoHeight = 50000;\n    this.atmoHeightFactor = 1; //this.atmoHeight / 50000;\n    this.atmoDensity = 1; //this.atmoHeight / 50000;\n\n    this.fogDensity = 0;\n    this.zFactor = 0;\n    //this.zFactor2 = 0.000012;\n    this.zFactor2 = 0.003;\n    this.zbufferOffset = null;    \n    this.zShift = 0;\n    this.zLastShift = 0;\n    this.bestMeshTexelSize = 1;\n    this.bestGeodataTexelSize = 1;\n    this.log8 = Math.log(8);\n    this.log2 = Math.log(2);\n\n    this.geodataTilesPerLayer = 0;\n\n    this.drawCounter = 0;\n    this.drawChannel = 0;\n    this.drawChannelNames = ['base', 'hit'];\n\n    this.planetRadius = this.isGeocent ? map.getNavigationSrs().getSrsInfo()['a'] : 100;\n    this.tileBuffer = new Array(500);\n    this.processBuffer = new Array(60000);\n    this.processBuffer2 = new Array(60000);\n    this.drawBuffer = new Array(60000);\n    this.drawBuffer2 = new Array(60000);\n    this.tmpVec3 = new Array(3);\n    this.tmpVec5 = new Array(5);\n    this.bboxBuffer = new Float32Array(8*3);\n    this.planeBuffer = new Float32Array(9*3);\n    //this.drawBufferIndex = 0;\n\n    var gpu = this.renderer.gpu;\n    this.drawTileState = gpu.createState({});\n    this.drawStardomeState = gpu.createState({zwrite:false, ztest:false});\n    this.drawBlendedTileState = gpu.createState({zequal:true, blend:true});\n    this.drawAuraState = gpu.createState({zwrite:false, blend:true});\n    this.drawAtmoState = gpu.createState({zwrite:false, ztest:false, blend:true});\n    this.drawAtmoState2 = gpu.createState({zwrite:false, ztest:true, blend:false});\n\n    this.degradeHorizonFactor = 0;\n    this.degradeHorizonTiltFactor = 0;\n\n    this.replay = {\n        camera : null,\n        drawnTiles : null,\n        drawnFreeTiles : null,\n        nodeBuffer : null,\n        tracedNodes : null,\n        tracedFreeNodes : null,\n        storeTiles : false,\n        storeFreeTiles : false,\n        storeNodes : false,\n        storeFreeNodes : false,\n        storeLoaded : this.config.mapStoreLoadStats,\n        drawGlobe : false,\n        drawTiles : false,\n        drawNodes : false,\n        drawFreeTiles : false,\n        drawFreeNodes : false,\n        drawLoaded : false,\n        lod : 30,\n        singleLod : false,\n        loadedIndex : 0,\n        singleLodedIndex : 0,\n        loaded : [],\n        loadFirst : 0,\n        loadLast : 0\n    };\n\n    this.drawTiles = new MapDrawTiles(map, this);\n};\n\n\nMapDraw.prototype.drawMap = function(skipFreeLayers) {\n    var map = this.map;\n    var renderer = this.renderer;\n    var camera = this.camera;\n    var replay = this.replay;\n    var gpu = renderer.gpu;\n    var debug = this.debug;\n\n    if (this.drawChannel != 1) {\n        gpu.setViewport();\n\n        map.visibleCredits = {\n            imagery : {},\n            glueImagery : {},\n            mapdata : {}\n        };\n    }\n\n    var projected = this.isProjected;\n\n    switch (this.config.mapGridMode) {\n        case 'none':       this.gridSkipped = true; this.gridFlat = false; this.gridGlues = false;  break;\n        case 'flat':       this.gridSkipped = false; this.gridFlat = true; this.gridGlues = false;  break;\n        case 'linear':     this.gridSkipped = false; this.gridFlat = false; this.gridGlues = true;  break;\n        case 'fastlinear': this.gridSkipped = false; this.gridFlat = false; this.gridGlues = false; break;\n    }\n\n    var drawTiles = this.drawTiles;\n    var camInfo = camera.update();\n    var renderer = this.renderer;\n\n    renderer.debugStr = 'AsyncImageDecode: ' + this.config.mapAsyncImageDecode;\n    renderer.dirty = true;\n    renderer.drawFog = this.debug.drawFog;\n    renderer.debug = this.debug; \n    renderer.mapHack = map;\n    renderer.benevolentMargins = this.config.mapBenevolentMargins;\n\n    if (this.config.mapForceFrameTime) {\n        if (this.config.mapForceFrameTime != -1) {\n            renderer.frameTime = this.config.mapForceFrameTime;\n        } else {\n            renderer.frameTime = 0;\n        }\n    } else {\n        renderer.frameTime = this.stats.frameTime;        \n    }\n\n    renderer.hoverFeatureCounter = 0;\n    renderer.hoverFeatureList = map.hoverFeatureList;\n    renderer.hoverFeature = map.hoverFeature;\n\n    renderer.cameraPosition = camera.position;\n    renderer.cameraOrientation = map.position.getOrientation();\n    renderer.cameraTiltFator = Math.cos(math.radians(renderer.cameraOrientation[1]));\n    renderer.cameraVector = camera.vector; \n    renderer.cameraViewExtent = map.position.getViewExtent();\n    renderer.cameraViewExtent2 = Math.pow(2.0, Math.max(1.0, Math.floor(Math.log(map.position.getViewExtent()) / Math.log(2))));\n    renderer.drawLabelBoxes = this.debug.drawLabelBoxes;\n    renderer.drawGridCells = this.debug.drawGridCells;\n    renderer.drawAllLabels = this.debug.drawAllLabels;\n    renderer.drawHiddenLabels = this.debug.drawHiddenLabels;\n    renderer.debug = this.debug;\n    renderer.fmaxDist = Number.NEGATIVE_INFINITY;\n    renderer.fminDist = Number.POSITIVE_INFINITY;\n\n\n    if (projected) {\n        var yaw = math.radians(renderer.cameraOrientation[0]);\n        renderer.labelVector = [-Math.sin(yaw), Math.cos(yaw), 0, 0, 0];\n    } else {\n        var v = camInfo.vector;\n        renderer.labelVector = [v[0], v[1], v[2], 0]; \n    }\n\n    renderer.distanceFactor = 1 / Math.max(1,Math.log(camera.distance) / Math.log(1.04));\n    renderer.tiltFactor = (Math.abs(renderer.cameraOrientation[1]/-90));\n    renderer.localViewExtentFactor = 2 * Math.tan(math.radians(map.position.getFov()*0.5));\n\n    this.degradeHorizonFactor = 200.0 * this.config.mapDegradeHorizonParams[0];\n    this.degradeHorizonTiltFactor = 0.5*(1.0+Math.cos(math.radians(Math.min(180,Math.abs(renderer.cameraOrientation[1]*2*3)))));\n   \n    if (this.drawChannel != 1) {\n        if (debug.drawWireframe == 2) {\n            gpu.clear(true, true, [255,255,255,255]);\n        } else {\n            gpu.clear(true, true, [0,0,0,255]);\n        }\n    } else { //render depth map\n        gpu.clear(true, true, [255,255,255,255]);\n    }\n\n    gpu.setState(this.drawStardomeState);\n\n    /*\n    if (this.drawChannel != 1) {\n        if (debug.drawWireframe == 2) {\n            renderer.draw.drawSkydome(renderer.whiteTexture, renderer.progStardome);\n        } else {\n            renderer.draw.drawSkydome(renderer.blackTexture, renderer.progStardome);\n        }\n    }*/\n\n    gpu.setState(this.drawTileState);\n\n    this.setupDetailDegradation();\n\n    map.loader.setChannel(0); //0 = hires channel\n    this.zFactor = 0;\n\n    this.ndcToScreenPixel = renderer.curSize[0] * 0.5;\n    this.updateFogDensity();\n    this.updateGridFactors();\n    this.maxGpuUsed = Math.max(32*102*1204, map.gpuCache.getMaxCost() - 32*102*1204); \n    //this.cameraCenter = this.position.getCoords();\n    this.stats.renderBuild = 0;\n    this.drawTileCounter = 0;\n    var cameraPos = camera.position;\n    var i, li, j, lj, tile, tiles, tmp, layer, drawnTiles, nodeBuffer;\n\n    if (map.freeLayersHaveGeodata && this.drawChannel == 0) {\n        renderer.draw.clearJobBuffer();\n    }\n\n    if (this.debug.drawEarth) {\n        if (replay.storeNodes || replay.storeFreeNodes) {\n            replay.nodeBuffer = [];\n        }\n        \n        if (replay.drawGlobe || replay.drawTiles || replay.drawFreeTiles||\n            replay.drawNodes || replay.drawFreeNodes || replay.drawLoaded) { //used only in inspector\n    \n            var lod = replay.lod; \n            var single = replay.singleLod; \n    \n            if (replay.drawTiles && replay.drawnTiles) {\n                tiles = replay.drawnTiles;\n                for (i = 0, li = tiles.length; i < li; i++) {\n                    if (!tiles[i][1]) { //skip grids\n                        tile = tiles[i][0];\n                        if (tile && ((single && tile.id[0] == lod) || (!single && tile.id[0] <= lod))) {\n                            drawTiles.drawSurfaceTile(tile, tile.metanode, cameraPos, tile.pixelSize, tile.priority, false, false);\n                        }\n                    } else {\n                        tile = tiles[i][0];\n                        if (drawTiles.debug.drawBBoxes) {\n                            drawTiles.drawTileInfo(tile, tile.metanode, cameraPos);\n                        }\n\n                        tile.drawGrid(cameraPos); \n                    }\n                }\n            }\n            \n            if (replay.drawFreeTiles && replay.drawnFreeTiles) {\n                tiles = replay.drawnFreeTiles;\n                for (i = 0, li = tiles.length; i < li; i++) {\n                    if (!tiles[i][1]) { //skip grids\n                        tile = tiles[i][0];\n                        if (tile && ((single && tile.id[0] == lod) || (!single && tile.id[0] <= lod))) {\n                            drawTiles.drawSurfaceTile(tile, tile.metanode, cameraPos, tile.pixelSize, tile.priority, false, false);\n                        }\n                    }\n                }\n            }\n    \n            if (replay.drawNodes && replay.tracedNodes) {\n                tiles = replay.tracedNodes;\n                tmp = debug.drawBBoxes;\n                debug.drawBBoxes = true;  \n                for (i = 0, li = tiles.length; i < li; i++) {\n                    tile = tiles[i];\n                    if (tile && ((single && tile.id[0] == lod) || (!single && tile.id[0] <= lod))) {\n                        drawTiles.drawTileInfo(tile, tile.metanode, cameraPos, tile.surfaceMesh, tile.pixelSize);\n                    }\n                }\n                debug.drawBBoxes = tmp;\n            }\n    \n            if (replay.drawFreeNodes && replay.tracedFreeNodes) {\n                tiles = replay.tracedFreeNodes;\n                tmp = debug.drawBBoxes;\n                debug.drawBBoxes = true;  \n                for (i = 0, li = tiles.length; i < li; i++) {\n                    tile = tiles[i];\n                    if ((single && tile.id[0] == lod) || (!single && tile.id[0] <= lod)) {\n                        drawTiles.drawTileInfo(tile, tile.metanode, cameraPos, tile.surfaceMesh, tile.pixelSize);\n                    }\n                }\n                debug.drawBBoxes = tmp;\n            }\n    \n            var index = replay.loadedIndex; \n            var singleIndex = replay.singleLodedIndex; \n    \n            if (replay.drawLoaded && replay.loaded) {\n                var  loaded = replay.loaded;\n                debug.drawBBoxes = true;  \n                for (i = 0, li = loaded.length; i < li; i++) {\n                    var file = loaded[i];\n                    if (file && file.tile && file.tile.id) {\n                        tile = file.tile;\n                        if (((singleIndex && i == index) || (!singleIndex && i <= index)) &&\n                             ((single && tile.id[0] == lod) || (!single && tile.id[0] <= lod)) ) {\n                            if (tile.metanode) {\n                                if (tile.metanode.hasGeometry()) {\n                                    drawTiles.drawSurfaceTile(tile, tile.metanode, cameraPos, tile.pixelSize, tile.priority, false, false);\n                                } else {\n                                    drawTiles.drawTileInfo(tile, tile.metanode, cameraPos, tile.surfaceMesh, tile.pixelSize);\n                                }\n                            }\n                        }\n                    }\n                }\n                debug.drawBBoxes = tmp;\n            }\n    \n            if ((replay.drawFreeTiles && replay.drawnFreeTiles) ||\n                (replay.drawLoaded && replay.loaded)) {\n                    \n                if (this.freeLayersHaveGeodata && this.drawChannel == 0) {\n                    renderer.drawnGeodataTiles = this.stats.drawnGeodataTilesPerLayer; //drawnGeodataTiles;\n                    renderer.drawnGeodataTilesFactor = this.stats.drawnGeodataTilesFactor;\n                    renderer.draw.drawGpuJobs();\n                }\n            }\n    \n            return;\n        }    \n        \n        for (i = 0, li = this.tileBuffer.length; i < li; i++) {  //todo remove this\n            this.tileBuffer[i] = null;    \n        }\n    \n        if (this.tree.surfaceSequence.length > 0) {\n            this.tree.draw();\n        }\n    \n        if (replay.storeTiles) { //used only in inspectors\n            drawnTiles = [];\n    \n            for (i = 0, li = this.tileBuffer.length; i < li; i++) {\n                tiles = this.tileBuffer[i];\n               \n                if (tiles) {\n                    for (j = 0, lj = tiles.length; j < lj; j++) {\n                        drawnTiles.push(tiles[j]);\n                    }\n                }\n            }\n            \n            replay.cameraPos = cameraPos; \n            replay.drawnTiles = drawnTiles;\n            replay.storeTiles = false; \n        }\n    \n        if (replay.storeNodes) { //used only in inspector\n            nodeBuffer = []; \n    \n            for (i = 0, li = replay.nodeBuffer.length; i < li; i++) {\n                tile = replay.nodeBuffer[i];\n                nodeBuffer.push(tile);\n            }\n    \n            replay.cameraPos = cameraPos; \n            replay.tracedNodes = nodeBuffer;\n            replay.storeNodes = false; \n        }\n    \n        //draw free layers    \n        for (i = 0, li = map.freeLayerSequence.length; i < li; i++) {\n            layer = map.freeLayerSequence[i];\n            if (layer.ready && layer.tree && \n                (!layer.geodata || (layer.stylesheet && layer.stylesheet.isReady())) && this.drawChannel == 0) {\n                \n                if (layer.zFactor) {\n                    this.zbufferOffset = layer.zFactor;\n                }\n\n                if (layer.type == 'geodata') {\n                    this.drawMonoliticGeodata(layer);\n                } else {\n                    layer.tree.draw();\n                }\n\n                this.zbufferOffset = null;\n            }\n        }\n    \n        if (replay.storeFreeTiles) { //used only in inspector\n            drawnTiles = [];\n    \n            for (i = 0, li = this.tileBuffer.length; i < li; i++) {\n                tiles = this.tileBuffer[i];\n               \n                if (tiles) {\n                    for (j = 0, lj = tiles.length; j < lj; j++) {\n                        tile = tiles[j];\n                        if (tile.surface && tile.surface.free) { //do no draw free layers\n                            drawnTiles.push(tile);\n                        }\n                    }\n                }\n            }\n            \n            replay.cameraPos = cameraPos; \n            replay.drawnFreeTiles = drawnTiles;\n            replay.storeFreeTiles = false; \n        }\n    \n        if (replay.storeFreeNodes) { //used only in inspector\n            nodeBuffer = []; \n    \n            for (i = 0, li = replay.nodeBuffer.length; i < li; i++) {\n                tile = replay.nodeBuffer[i];\n                if (tile.surface && tile.surface.free) { //do no draw free layers\n                    nodeBuffer.push(tile);\n                }\n            }\n    \n            replay.cameraPos = cameraPos; \n            replay.tracedFreeNodes = nodeBuffer;\n            replay.storeFreeNodes = false; \n        }\n    }\n\n    var body = map.referenceFrame.body;\n\n    //draw skydome before geodata\n    if (this.drawChannel != 1 && !projected && debug.drawFog &&\n        ((body && body.atmosphere) || map.referenceFrame.id == 'melown2015' || map.referenceFrame.id == 'mars-qsc' || map.referenceFrame.id == 'earth-qsc') &&\n        renderer.progAtmo.isReady() && renderer.progAtmo2.isReady()) {    \n\n        var navigationSrsInfo = map.getNavigationSrs().getSrsInfo();\n        var earthRadius =  navigationSrsInfo['a'];\n        var earthRadius2 =  navigationSrsInfo['b'];\n        var atmoSize = this.atmoHeight;\n        renderer.earthRadius = earthRadius;\n        renderer.earthRadius2 = earthRadius2;\n        renderer.earthERatio = earthRadius / earthRadius2;\n\n        var cameraPosToEarthCenter = [0,0,0,0];\n        vec3.normalize(camera.position, cameraPosToEarthCenter);\n\n        var pos = map.getPosition();\n        //var orientation = pos.getOrientation();\n        //var tiltFactor = (Math.max(5,-orientation[1])/90);\n\n        //var cameraHeight = Math.max(atmoSize * 0.1, camera.geocentDistance - earthRadius);\n        var heightFactor = 1-math.clamp(Math.max(atmoSize * 0.1, camera.geocentDistance - earthRadius) / (atmoSize*(10)), 0, 1);\n\n        var params = [Math.max(2,heightFactor*128),0,0,0], params2, params3;\n        \n        /*\n        if (cameraHeight > earthRadius*2) { //prevent foggy earth from larger distance\n            params[0] = 2-Math.min(1.0, (camera.height - earthRadius*2) / (earthRadius*2));\n        }*/\n\n        //gpu.setState(this.drawAtmoState);\n        //renderer.draw.drawBall([-camera.position[0], -camera.position[1], -camera.position[2]],\n          //                       earthRadius + 3000, earthRadius2 + 3000, renderer.progAtmo2, params,  cameraPosToEarthCenter, null, this.atmoColor3, this.atmoColor2, true);// this.cameraHeight > atmoSize ? 1 : -1);\n        \n        var safetyFactor = 2.0; \n        params = [safetyFactor, safetyFactor * ((earthRadius + atmoSize) / earthRadius), 0.25, safetyFactor* ((earthRadius + atmoSize) / earthRadius)];\n        var factor = (1 / (earthRadius) ) * safetyFactor;  \n        params2 = [camera.position[0] * factor, camera.position[1] * factor, camera.position[2] * factor, 1];\n        \n        var distance = (pos.getViewExtent()*0.5) / Math.tan(math.radians(pos.getFov()*0.5));\n        var a1 = (earthRadius / (distance + earthRadius)); //get angle to horion\n\n        //var n2 = 10.05;\n        var n2 = 5.00;\n\n        var t1 = math.mix(4.4, 1.01, a1);\n        var t2 = math.mix(n2, 1.05, a1); // * 1.0176;\n\n        params3 = [t1, 1 ,t2,0];\n\n        //console.log(\"a1: \" + a1 + \" t2: \" + t2);\n\n        gpu.setState(this.drawAuraState);\n        renderer.draw.drawBall([-camera.position[0], -camera.position[1], -camera.position[2]],\n                                 earthRadius + atmoSize, earthRadius2 + atmoSize, renderer.progAtmo, params,  params2, params3, this.atmoColor, this.atmoColor2);// this.camera.height > atmoSize ? 1 : -1);\n\n        gpu.setState(this.drawTileState);\n    }\n\n    if (debug.drawEarth) {\n        if (!skipFreeLayers) {\n            if (map.freeLayersHaveGeodata && this.drawChannel == 0) {\n                renderer.drawnGeodataTiles = this.stats.drawnGeodataTilesPerLayer; //drawnGeodataTiles;\n                renderer.drawnGeodataTilesFactor = this.stats.drawnGeodataTilesFactor;\n                renderer.draw.drawGpuJobs();\n            }\n        }\n    }\n\n    if (this.config.mapForceFrameTime) {\n        if (this.config.mapForceFrameTime != -1) {\n            renderer.frameTime = 0;\n            this.config.mapForceFrameTime = -1;\n        }\n    }\n};\n\nMapDraw.prototype.drawToTexture = function(texture) {\n    this.renderer.switchToFramebuffer('texture', texture);\n    this.drawChannel = 0;\n    this.map.renderSlots.processRenderSlots();\n    this.renderer.switchToFramebuffer('base');\n};\n\n\nMapDraw.prototype.drawHitmap = function() {\n    this.drawChannel = 1;\n    this.renderer.switchToFramebuffer('depth');\n    this.map.renderSlots.processRenderSlots();\n    this.renderer.switchToFramebuffer('base');\n\n    if (this.renderer.hitmapMode > 2) {\n        this.renderer.copyHitmap();\n    }\n\n    this.drawChannel = 0;\n    this.map.hitMapDirty = false;\n};\n\n\nMapDraw.prototype.drawGeodataHitmap = function() {\n    this.renderer.gpu.setState(this.drawTileState);\n    this.renderer.switchToFramebuffer('geo');\n    this.renderer.draw.drawGpuJobs();\n\n    if (this.renderer.advancedPassNeeded) {\n        this.renderer.switchToFramebuffer('geo2');\n        this.renderer.draw.drawGpuJobs();\n    }\n\n    this.renderer.switchToFramebuffer('base');\n    this.map.geoHitMapDirty = false;\n};\n\nMapDraw.prototype.getDrawCommandsGpuSize = function(commands) {\n    var gpuNeeded = 0;\n    \n    for (var i = 0, li = commands.length; i < li; i++) {\n        var command = commands[i];\n        \n        switch (command.type) {\n        case VTS_DRAWCOMMAND_SUBMESH:\n               \n            var mesh = command.mesh; \n            var texture = this.config.mapNoTextures ? 0 : command.texture; \n\n            if (mesh) {\n                gpuNeeded += mesh.gpuSize;\n            }\n\n            if (texture) {\n                gpuNeeded += texture.getGpuSize();\n            }\n                \n            break;\n\n        case VTS_DRAWCOMMAND_GEODATA:\n                \n            var geodataView = command.geodataView; \n                \n            if (geodataView) {\n                gpuNeeded += geodataView.size;\n            }\n                \n            break;\n        }\n    }\n    \n    return gpuNeeded;\n};\n\n\nMapDraw.prototype.areDrawCommandsReady = function(commands, priority, doNotLoad, doNotCheckGpu) {\n    var ready = true;\n    var checkGpu = doNotCheckGpu ? true : false;\n    \n    for (var i = 0, li = commands.length; i < li; i++) {\n        var command = commands[i];\n        \n        switch (command.type) {\n        case VTS_DRAWCOMMAND_SUBMESH:\n\n            var pipeline = command.pipeline;\n            if (pipeline) {\n                var hmap = command.hmap;\n    \n                if (!(hmap && hmap.isReady(doNotLoad, priority))) {\n                    ready = false;\n                }\n\n                if (this.debug.drawTestMode == 9) {\n                    var texture = command.texture; \n                    var textureReady = this.config.mapNoTextures ? true : (!texture  || (texture && texture.isReady(doNotLoad, priority, checkGpu)));\n                        \n                    if (!textureReady) {\n                        ready = false;   \n                    }\n                }\n\n                break;\n            }\n                \n            var mesh = command.mesh; \n            var texture = command.texture; \n                \n            var meshReady = (mesh && mesh.isReady(doNotLoad, priority, checkGpu));\n            var textureReady = this.config.mapNoTextures ? true : (!texture  || (texture && texture.isReady(doNotLoad, priority, checkGpu)));\n                \n            if (!(meshReady && textureReady) ) {\n                ready = false;   \n            }\n               \n            break;\n\n        case VTS_DRAWCOMMAND_GEODATA:\n                \n            var geodataView = command.geodataView; \n                \n            if (!(geodataView && geodataView.isReady(doNotLoad, priority, checkGpu))) {\n                ready = false;   \n            }\n                \n            break;\n        }\n    }\n    \n    return ready;\n};\n\n\nMapDraw.prototype.processDrawCommands = function(cameraPos, commands, priority, doNotLoad, tile) {\n    if (commands.length > 0) {\n        this.drawTileCounter++;\n    }\n\n    for (var i = 0, li = commands.length; i < li; i++) {\n        var command = commands[i];\n        \n        switch (command.type) {\n        case VTS_DRAWCOMMAND_STATE:\n            this.renderer.gpu.setState(command.state);\n            break;\n\n        case VTS_DRAWCOMMAND_SUBMESH:\n\n            var pipeline = command.pipeline;\n            if (pipeline) {\n                var hmap = command.hmap;\n    \n                if (this.debug.drawTestMode == 9) {\n                    var texture = command.texture; \n                    var textureReady = this.config.mapNoTextures ? true : (!texture  || (texture && texture.isReady(doNotLoad, priority)));\n                        \n                    if (textureReady) {\n                        if (hmap && hmap.isReady(doNotLoad, priority)) {\n                            tile.drawHmapTile(cameraPos, null, null, pipeline, texture);\n                        }\n                    }\n                } else {\n                    if (hmap && hmap.isReady(doNotLoad, priority)) {\n                        tile.drawHmapTile(cameraPos, null, null, pipeline);\n                    }\n                }\n\n                return;\n            }\n\n            var mesh = command.mesh; \n            var texture = command.texture;\n\n            var meshReady = (mesh && mesh.isReady(doNotLoad, priority)), textureReady;\n\n            if (this.config.mapNoTextures) {\n                textureReady = true;\n                texture = null;\n            } else {\n                textureReady = (!texture || (texture && texture.isReady(doNotLoad, priority)));\n            }\n                \n            if (meshReady && textureReady) {\n                    //debug bbox\n                if (this.debug.drawBBoxes && this.debug.drawMeshBBox) {\n                    mesh.submeshes[command.submesh].drawBBox(cameraPos);\n                }\n                    \n                if (!texture) {\n                    var material = command.material;\n                    switch (material) {\n                            //case \"fog\":\n                    case VTS_MATERIAL_EXTERNAL:\n                    case VTS_MATERIAL_INTERNAL:\n                        material = VTS_MATERIAL_FLAT;\n                        break; \n                    }\n                    mesh.drawSubmesh(cameraPos, command.submesh, texture, material, command.alpha, command.layer, command.surface, tile.splitMask);\n                } else {\n                    //tile.renderHappen = true;\n                    mesh.drawSubmesh(cameraPos, command.submesh, texture, command.material, command.alpha, command.layer, command.surface, tile.splitMask);\n                }\n\n            }\n                \n            break;\n                \n        case VTS_DRAWCOMMAND_GEODATA:\n                \n            var geodataView = command.geodataView; \n            //tile.renderHappen = true;\n                \n            if (geodataView && geodataView.isReady(doNotLoad, priority, true)) {\n                geodataView.draw(cameraPos);\n            }\n                \n            break;\n        }\n    }\n};\n\n\nMapDraw.prototype.drawMonoliticGeodata = function(surface) {\n    if (!surface || this.drawChannel != 0) {\n        return;\n    }\n\n    if (!this.camera.camera.bboxVisible(surface.extents, this.camera.position)) {\n        return;\n    }\n\n    var path;\n\n    if (surface.monoGeodata == null) {\n        if (typeof surface.geodataUrl === 'object') {\n            path = surface.geodataUrl;\n        } else {\n            path = surface.getMonoGeodataUrl(surface.id);\n        }\n\n        surface.monoGeodata = new MapGeodata(this.map, path, {tile:null, surface:surface});\n    }\n\n    if (surface.monoGeodataCounter != surface.geodataCounter) {\n        surface.monoGeodataView = null;\n        surface.monoGeodataCounter = surface.geodataCounter;\n    }\n\n    if (surface.monoGeodata.isReady()) {\n\n        if (!surface.monoGeodataView) {\n            surface.monoGeodataView = new MapGeodataView(this.map, surface.monoGeodata, {tile:null, surface:surface});\n        }\n        \n        if (surface.monoGeodataView.isReady()) {\n            var mapdataCredits = this.map.visibleCredits.mapdata\n\n            for (var i = 0, li = surface.credits.length; i < li; i++) {\n                var key = surface.credits[i]\n                var value = 10; //fixed specificity\n                var value2 = mapdataCredits[key];\n\n                if (value2) {\n                    mapdataCredits[key] = value > value2 ? value : value2;\n                } else {\n                    mapdataCredits[key] = value;\n                }\n            }\n\n            surface.monoGeodataView.draw(this.camera.position);\n        }\n    }\n};\n\n\nMapDraw.prototype.updateFogDensity = function() {\n    // the fog equation is: exp(-density*distance), this gives the fraction\n    // of the original color that is still visible at some distance\n\n    // we define visibility as a distance where only 5% of the original color\n    // is visible; from this it is easy to calculate the correct fog density\n\n    //var density = Math.log(0.05) / this.core.coreConfig.cameraVisibility;\n    var pos = this.map.getPosition();\n    var orientation = pos.getOrientation();\n    \n    var cameraVisibility = this.camera.getFar();\n    \n    var tiltFactor = (Math.max(5,-orientation[1])/90);\n    var density = Math.log(0.05) / ((this.atmoDensity * cameraVisibility * this.atmoHeightFactor * Math.max(1,this.camera.height*0.0001))* tiltFactor);\n    density *= (5.0) / (Math.min(50000, Math.max(this.camera.distance, 1000)) /5000);\n\n    if (!this.debug.drawFog) {\n        density = 0;\n    }\n    \n    //reduce fog when camera is facing down\n    //density *= 1.0 - (-this.orientation[0]/90)\n    \n    this.fogDensity = density;\n    this.renderer.fogDensity = density; \n};\n\n\nMapDraw.prototype.updateGridFactors = function() {\n    var nodes = this.map.referenceFrame.getSpatialDivisionNodes();\n\n    for (var i = 0, li = nodes.length; i < li; i++) {\n        var node = nodes[i]; \n        var embed = 8;\n\n        var altitude = Math.max(10, this.camera.distance + 20);\n        //var altitude = Math.max(1.1, this.cameraDistance);\n        var maxDistance = (node.extents.ur[0] - node.extents.ll[0])*2;\n        var gridSelect = Math.log(Math.min(maxDistance,altitude)) / this.log8;\n        var gridMax = Math.log(maxDistance) / this.log8;\n    \n        gridSelect = gridMax - gridSelect;\n    \n        node.gridBlend = (gridSelect - Math.floor(gridSelect));\n        \n        gridSelect = Math.floor(Math.floor(gridSelect))+1;\n        node.gridStep1 = Math.pow(embed, gridSelect);\n        node.gridStep2 = node.gridStep1 * 8; \n    }\n};\n\n\nMapDraw.prototype.setupDetailDegradation = function(degradeMore) {\n    var factor = 0;\n    \n    if (this.map.mobile) {\n        factor = this.config.mapMobileDetailDegradation;\n    }\n\n    if (degradeMore) {\n        factor += degradeMore;        \n    }\n\n    var dpiRatio = 1; //(window.devicePixelRatio || 1);\n\n    this.texelSizeFit = this.config.mapTexelSizeFit * Math.pow(2,factor) * dpiRatio;      \n};\n\n\nexport default MapDraw;\n\n","\nimport {utils as utils_} from '../../utils/utils';\n\n//get rid of compiler mess\nvar utils = utils_;\n\n\nvar MapLoader = function(map, maxThreads) {\n    this.map = map;\n    this.core = map.core;\n    this.killed = false;\n    this.config = map.config;\n\n    this.maxThreads = maxThreads || 1;\n    this.usedThreads = 0;\n    this.maxPending = this.maxThreads * 2;\n    this.fadeout = 19 / 20;\n\n    this.pending = [[],[]];\n    this.channel = 0;\n\n    this.downloading = [];\n    this.downloadingTime = [];\n    this.workerTask = {};\n\n    this.lastDownloadTime = 0;\n    this.downloaded = 0;\n    this.processWorker = null;\n    this.updateThreadCount();\n\n    if (this.config.mapSeparateLoader) {\n        // eslint-disable-next-line\n        var worker = require('worker-loader?inline&fallback=false!./worker-main');\n\n        this.processWorker = new worker;\n        \n        this.processWorker.onerror = function(event){\n            throw new Error(event.message + ' (' + event.filename + ':' + event.lineno + ')');\n        };\n\n        this.processWorker.onmessage = this.onWorkerMessage.bind(this);\n\n        this.processWorker.postMessage({'command':'config', 'data': this.config});\n    }\n\n};\n\n\nMapLoader.prototype.updateThreadCount = function() {\n    this.maxThreads = this.config.mapDownloadThreads;\n    this.maxPending = Math.max(20, this.maxThreads * 2);\n    this.fadeout = (this.maxPending-1) / this.maxPending;\n};\n\n\nMapLoader.prototype.setChannel = function(channel) {\n    this.channel = channel;\n};\n\n\nMapLoader.prototype.onWorkerMessage = function(message, direct) {\n    if (this.killed) {\n        return;\n    }\n\n    if (!direct) {\n        message = message.data;\n    }\n    \n    var command = message['command'];\n\n    if (command == 'packed-events') {\n        var messages = message['messages'];\n\n        for (var i = 0, li = messages.length; i < li; i++) {\n            this.onWorkerMessage(messages[i], true);\n        }\n\n        return;\n    }\n\n    var path = message['path'];\n\n    var task = this.workerTask[path];\n    if (task) {\n\n        switch(command) {\n\n            case 'on-loaded':\n\n                if (task.onLoaded) {\n\n                    switch(task.kind) {\n                        case 'direct-texture':\n                            task.onLoaded(message['data'], true, message['filesize']);\n                            break;\n\n                        case 'direct-mesh':\n                            task.onLoaded(message['data'], false, true, message['filesize']);\n                            break;\n\n                        case 'texture':\n                            task.onLoaded(new Blob([message['data']]));\n                            break;\n\n                        default:\n                            task.onLoaded(message['data']);\n                    }\n\n                }\n\n                break;\n\n            case 'on-error':\n                if (task.onError) {\n                    task.onError();\n                }\n\n                break;\n        }\n\n        /*\n        if (command == 'on-loaded') {\n\n            if (task.onLoaded) {\n                if (task.kind == 'texture') {\n                    task.onLoaded(new Blob([message['data']]));\n                } else {\n                    task.onLoaded(message['data']);\n                }\n            }\n\n        } else if (command == 'on-error') {\n\n            if (task.onError) {\n                task.onError();\n            }\n        }*/\n\n        delete this.workerTask[path];\n    }\n\n};\n\n\nMapLoader.prototype.processLoadBinary = function(path, onLoaded, onError, responseType, kind) {\n    var withCredentials = (utils.useCredentials ? (this.mapLoaderUrl.indexOf(this.map.url.baseUrl) != -1) : false);\n\n    if (this.processWorker) {\n\n        switch(kind) {\n            case 'texture':\n                if (this.config.mapAsyncImageDecode) {\n                    responseType = 'blob';\n                    kind = 'direct-texture';\n                }\n                break;\n\n            case 'mesh':\n                if (this.config.mapParseMeshInWorker) {\n                    kind = 'direct-mesh';\n                }\n                break;\n        }\n\n        switch(kind) {\n            case 'texture':\n            case 'direct-texture':\n            case 'mesh':\n            case 'direct-mesh':\n            case 'metadata':\n            case 'geodata':\n\n                //console.log(\"kind: \" + kind + \" \" + \"path: \" + path);\n\n                this.workerTask[path] = { onLoaded: onLoaded, onError: onError, kind: kind };\n                this.processWorker.postMessage({'command':'load-binary', 'path': path, 'withCredentials':withCredentials, 'xhrParams':this.map.core.xhrParams, 'responseType':responseType, 'kind': kind});\n                break;\n\n            default:\n                utils.loadBinary(path, onLoaded, onError, withCredentials, this.map.core.xhrParams, responseType);\n        }\n\n    } else {\n        if (kind == 'texture' && this.config.mapAsyncImageDecode) {\n            responseType = 'blob';\n        }\n\n        utils.loadBinary(path, onLoaded, onError, withCredentials, this.map.core.xhrParams, responseType);\n    }\n};\n\n\nMapLoader.prototype.load = function(path, downloadFunction, priority, id, kind) {\n    var index = this.downloading.indexOf(path);\n\n    if (index != -1) {\n        return;\n    }\n\n    // update the pending list\n    var pending = this.pending[this.channel];\n\n   // put the request to the beginning of the pending list\n    index = this.map.searchArrayIndexById(pending, path);\n    if (index != -1) {\n        pending[index].priority = priority; \n    } else {\n        pending.unshift({id:path, call: downloadFunction, priority : (priority || 0), tile:id, kind:kind });\n    }\n\n    //sort pending list by priority\n    do {\n        var sorted = true;\n        \n        for (var i = 0, li = pending.length - 1; i < li; i++) {\n            if (pending[i].priority > pending[i+1].priority) {\n                var t = pending[i];\n                pending[i] = pending[i+1];\n                pending[i+1] = t;\n    \n                sorted = false;\n            } \n        }\n        \n    } while(!sorted);\n\n    // keep the pending list at reasonable length\n    if (pending.length > this.maxPending) {\n        pending.pop();\n    }\n};\n\n\nMapLoader.prototype.remove = function(path) {\n    var index = this.map.searchArrayIndexById(this.pending[this.channel], path);\n    if (index != -1) {\n        this.pending[this.channel].splice(index, 1);\n    }\n};\n\n\nMapLoader.prototype.onLoaded = function(item) {\n    var index = this.downloading.indexOf(item.id);\n    var timer = performance.now();\n    var stats = this.map.stats;\n    var recordStats = this.map.draw.replay.storeLoaded;\n\n    if (recordStats) {\n        this.map.draw.replay.loaded.push({\n            url : item.id,\n            kind : item.kind,\n            tile: item.tile,\n            priority : item.priority,\n            time : timer,\n            duration : timer - this.downloadingTime[index],\n            interval : timer - this.lastDownloadTime,\n            threads : this.downloading.length\n        });\n\n        //var a = (timer - this.downloadingTime[index]);\n        //if (Number.isNaN(a)) {\n            //a = a; \n        //}\n\n    }\n\n    this.downloading.splice(index, 1);\n    this.downloadingTime.splice(index, 1);\n    //this.lastDownloadTime = Date.now();\n    this.lastDownloadTime = timer;\n    this.usedThreads--;\n    this.map.markDirty();\n    this.update(true);\n    stats.loadedCount++;\n    stats.loadLast = timer;\n};\n\n\nMapLoader.prototype.onLoadError = function(item) {\n    var index = this.downloading.indexOf(item.id);\n    var timer = performance.now();\n    var stats = this.map.stats;\n    var recordStats = this.map.draw.replay.storeLoaded;\n\n    if (recordStats) {\n        this.map.draw.replay.loaded.push({\n            url : item.id,\n            kind : item.kind,\n            tile: item.tile,\n            priority : item.priority,\n            time : timer,\n            duration : timer - this.downloadingTime[index],\n            interval : timer - this.lastDownloadTime,\n            threads : this.downloading.length\n        });\n    }\n\n    this.downloading.splice(index, 1);\n    this.downloadingTime.splice(index, 1);\n    //this.lastDownloadTime = Date.now();\n    this.lastDownloadTime = timer;\n    this.usedThreads--;\n    this.map.markDirty();\n    this.update(true);\n    stats.loadErrorCount++;\n    stats.loadLast = timer;\n};\n\n\nMapLoader.prototype.updateChannel = function(channel) {\n    var pending = this.pending[channel];\n    this.updateThreadCount();\n\n    //reduce priority for pending stuff\n    for (var i = 0, li = pending.length; i < li; i++) {\n        pending[i].priority *= this.fadeout;\n    }\n\n    var timer = performance.now();\n\n    while (pending.length > 0 && this.usedThreads < this.maxThreads) {\n        var item = pending.shift();\n\n        if (this.downloading.indexOf(item.id) == -1 && item.call != null) {\n            this.downloading.push(item.id);\n            this.downloadingTime.push(timer);\n            this.usedThreads++;\n            this.downloaded++;\n\n            item.call(item.id, this.onLoaded.bind(this, item), this.onLoadError.bind(this, item));\n        }\n    }\n};\n\n\nMapLoader.prototype.update = function(skipTick) {\n    if (this.map.loaderSuspended || this.core.contextLost) {\n        return;\n    }\n\n    if (!skipTick && this.processWorker && this.config.mapPackLoaderEvents && this.downloading.length) {\n        this.processWorker.postMessage({'command':'tick'});\n    }\n\n    for (var i = this.pending.length - 1; i >= 0; i--) {\n        if (this.pending[i].length > 0) {\n            this.updateChannel(i);\n            break;\n        }\n    }\n};\n\n\nexport default MapLoader;\n\n","\nimport {math as math_} from '../utils/math';\n\n//get rid of compiler mess\nvar math = math_;\n\nvar MapPosition = function(pos) {\n    if (pos instanceof MapPosition) {\n        this.pos = pos.pos.slice();\n    } else {\n        if (!(pos != null && (pos instanceof Array))) {\n            this.pos = [];\n        } else {\n            this.pos = pos.slice();\n        }\n\n        this.validate();\n    }\n};\n\n\nMapPosition.prototype.clone = function() {\n    return new MapPosition(this.pos);\n};\n\n\nMapPosition.prototype.getCoords = function() {\n    return [this.pos[1], this.pos[2], this.pos[4]];\n};\n\n\nMapPosition.prototype.getCoords2 = function() {\n    return [this.pos[1], this.pos[2]];\n};\n\n\nMapPosition.prototype.setCoords = function(coords) {\n    this.pos[1] = coords[0];\n    this.pos[2] = coords[1];\n    this.pos[4] = coords[2];\n    return this;\n};\n\n\nMapPosition.prototype.setCoords2 = function(coords) {\n    this.pos[1] = coords[0];\n    this.pos[2] = coords[1];\n    return this;\n};\n\n\nMapPosition.prototype.getHeight = function() {\n    return this.pos[4];\n};\n\n\nMapPosition.prototype.setHeight = function(height) {\n    this.pos[4] = height;\n    return this;\n};\n\n\nMapPosition.prototype.getOrientation = function() {\n    return [this.pos[5], this.pos[6], this.pos[7]];\n};\n\n\nMapPosition.prototype.setOrientation = function(orientation) {\n    this.pos[5] = orientation[0];\n    this.pos[6] = orientation[1];\n    this.pos[7] = orientation[2];\n    return this;\n};\n\n\nMapPosition.prototype.getFov = function() {\n    return this.pos[9];\n};\n\n\nMapPosition.prototype.setFov = function(fov) {\n    this.pos[9] = fov;\n    return this;\n};\n\n\nMapPosition.prototype.getViewExtent = function() {\n    return this.pos[8];\n};\n\n\nMapPosition.prototype.setViewExtent = function(extent) {\n    this.pos[8] = extent;\n    return this;\n};\n\n\nMapPosition.prototype.getViewDistance = function() {\n    return (this.getViewExtent()*0.5) / Math.tan(math.radians(this.getFov()*0.5));\n};\n\n\nMapPosition.prototype.getViewMode = function() {\n    return this.pos[0];\n};\n\n\nMapPosition.prototype.getHeightMode = function() {\n    return this.pos[3];\n};\n\n\nMapPosition.prototype.check = function() {\n    //check pich\n    if (this.getViewMode() == 'obj') {\n        this.pos[6] = math.clamp(this.pos[6], -90.0, 90.0);\n    } else {\n        this.pos[6] = math.clamp(this.pos[6], -90.0, 90.0);\n    }\n\n    this.pos[5] = this.pos[5] % 360;\n    this.pos[7] = this.pos[7] % 360;\n};\n\n\nMapPosition.prototype.isSame = function(pos) {\n    pos = pos.pos;\n    return (this.pos[0] == pos[0] &&\n             math.isEqual(this.pos[1], pos[1], 0.0000001) &&\n             math.isEqual(this.pos[2], pos[2], 0.0000001) &&\n             this.pos[3] == pos[3] &&\n             math.isEqual(this.pos[4], pos[4], 0.001) &&\n             math.isEqual(this.pos[5], pos[5], 0.001) &&\n             math.isEqual(this.pos[6], pos[6], 0.001) &&\n             math.isEqual(this.pos[7], pos[7], 0.001) &&\n             math.isEqual(this.pos[8], pos[8], 0.001) &&\n             math.isEqual(this.pos[9], pos[9], 0.001));\n};\n\n\nMapPosition.prototype.validate = function() {\n    var pos = this.pos;\n    if (pos[0] == 'fixed') { //old format\n        pos[0] = 'obj';\n        pos[9] = pos[8];\n        pos[8] = pos[7];\n        pos[7] = pos[6];\n        pos[6] = pos[5];\n        pos[5] = pos[4];\n        pos[4] = pos[3];\n        pos[3] = 'fix';\n    }\n\n    pos[0] = (pos[0] == 'obj' || pos[0] == 'subj') ? pos[0] : 'obj';\n    pos[1] = (pos[1] != null) ? pos[1] : 0;\n    pos[2] = (pos[2] != null) ? pos[2] : 0;\n    pos[3] = (pos[3] == 'fix' || pos[3] == 'fixed' || pos[3] == 'float') ? pos[3] : 'float';\n    pos[4] = (pos[4] != null) ? pos[4] : 0;\n    pos[5] = (pos[5] != null) ? pos[5] : 0;\n    pos[6] = (pos[6] != null) ? pos[6] : -90;\n    pos[7] = (pos[7] != null) ? pos[7] : 0;\n    pos[8] = (pos[8] != null) ? pos[8] : 900;\n    pos[9] = (pos[9] != null) ? pos[9] : 45;\n\n    pos[3] = (pos[3] == 'fixed') ? 'fix' : pos[3];\n};\n\n\nMapPosition.prototype.toString = function() {\n    var p = this.pos;\n    return p[0] + ', ' + p[1].toFixed(0) + ', ' + p[2].toFixed(0) + ', ' + p[3] + ', ' + p[4].toFixed(0)\n           + ', ' + p[5].toFixed(0) + ', ' + p[6].toFixed(0) + ', ' + p[7].toFixed(0) + ', ' \n           + ', ' + p[8].toFixed(0) + ', ' + p[9].toFixed(0); \n};\n\n\nMapPosition.prototype.toArray = function() {\n    return this.pos.slice();\n};\n\n\nexport default MapPosition;\n","\n\nvar MapRenderSlots = function(map) {\n    this.map = map;\n    this.draw = map.draw;\n    this.renderer = map.renderer;\n    this.config = map.config;\n    this.renderSlots = [];\n};\n\n\nMapRenderSlots.prototype.createRenderSlot = function(id, callback, enabled) {\n    return { id:id,\n        callback:callback,\n        enabled : enabled\n    };\n};\n\n\nMapRenderSlots.prototype.addRenderSlot = function(id, callback, enabled) {\n    this.renderSlots.push(this.createRenderSlot(id, callback, enabled));\n};\n\n\nMapRenderSlots.prototype.getRenderSlotIndex = function(id) {\n    return this.map.searchArrayIndexById(this.renderSlots, id); \n};\n\n\nMapRenderSlots.prototype.checkRenderSlotId = function(id) {\n    if (id == 'after-map-render') {\n        return 'map'; \n    } else {\n        return id;\n    }\n};\n\n\nMapRenderSlots.prototype.moveRenderSlotBefore = function(whichId, whereId) {\n    var from = this.getRenderSlotIndex(this.checkRenderSlotId(whichId));\n    var to = this.getRenderSlotIndex(whereId);\n    if (from != -1 && to != -1 && to != from-1) { \n        this.renderSlots.splice(to, 0, this.renderSlots.splice(from, 1)[0]);\n    }\n};\n\n\nMapRenderSlots.prototype.moveRenderSlotAfter = function(whichId, whereId) {\n    var from = this.getRenderSlotIndex(this.checkRenderSlotId(whichId));\n    var to = this.getRenderSlotIndex(whereId);\n    if (from != -1 && to != -1 && to != from+1) {\n        to++; \n        this.renderSlots.splice(to, 0, this.renderSlots.splice(from, 1)[0]);\n    }\n};\n\n\nMapRenderSlots.prototype.removeRenderSlot = function(id) {\n    var index = this.getRenderSlotIndex(id);\n    if (index != -1) {\n        this.renderSlots.splice(index, 1);\n    }\n};\n\n\nMapRenderSlots.prototype.setRenderSlotEnabled = function(id, state) {\n    var index = this.getRenderSlotIndex(id);\n    if (index != -1) {\n        this.renderSlots[index].enabled = state;\n    }\n};\n\n\nMapRenderSlots.prototype.getRenderSlotEnabled = function(id) {\n    var index = this.getRenderSlotIndex(id);\n    if (index != -1) {\n        return this.renderSlots[index].enabled;\n    }\n    \n    return false;\n};\n\n\nMapRenderSlots.prototype.processRenderSlots = function() {\n    if (this.draw.drawChannel != 1) {\n        this.renderer.gpu.setViewport(); //just in case\n    }\n\n    for (var i = 0, li = this.renderSlots.length; i < li; i++) {\n        var slot = this.renderSlots[i];\n\n        if (slot.enabled && slot.callback) {\n            this.renderer.gpu.setState(this.draw.drawTileState);\n            slot.callback(this.draw.drawChannelNames[this.draw.drawChannel]);\n        }\n    }\n};\n\n\nexport default MapRenderSlots;\n\n","\nvar MapStats = function(map) {\n    this.map = map;\n    this.core = map.core;\n    this.inspector = map.core.inspector;\n    this.drawnTiles = 0;\n    this.drawnGeodataTiles = 0;\n    this.drawnGeodataTilesFactor = 0;\n    this.drawnGeodataTilesPerLayer = 0;\n    this.drawnFaces = 0;\n    this.drawCalls = 0;    \n    this.usedNodes = 0;    \n    this.processedNodes = 0;    \n    this.processedMetatiles = 0;    \n    this.counter = 0;\n    this.statsCycle = 0;\n    this.fps = 0;\n    this.frameTime = 0;\n    this.renderTime = 0;\n    this.renderTimeTmp = 0;\n    this.renderTimeBegin = 0;\n    this.renderBuild = 0;\n    this.lastRenderTime = 0;\n    this.lastFrameTime = 0;\n    this.renderedLods = new Array(32);\n    this.debugIds = {};\n\n    this.recordGraphs = false;\n    this.graphsTimeIndex = 0;\n    this.graphsLastTimeIndex = 0;\n    this.graphsTimeSamples = 900;\n    this.graphsRenderTimes = new Array(this.graphsTimeSamples);\n    this.graphsCreateMeshTimes = new Array(this.graphsTimeSamples);\n    this.graphsCreateGpuMeshTimes = new Array(this.graphsTimeSamples);\n    this.graphsCreateTextureTimes = new Array(this.graphsTimeSamples);\n    this.graphsFrameTimes = new Array(this.graphsTimeSamples);\n    this.graphsCpuMemoryMetatiles = new Array(this.graphsTimeSamples);\n    this.graphsCpuMemoryUsed = new Array(this.graphsTimeSamples);\n    this.graphsGpuMemoryTextures = new Array(this.graphsTimeSamples);\n    this.graphsGpuMemoryMeshes = new Array(this.graphsTimeSamples);\n    this.graphsGpuMemoryGeodata = new Array(this.graphsTimeSamples);\n    this.graphsGpuMemoryRender = new Array(this.graphsTimeSamples);\n    this.graphsPolygons = new Array(this.graphsTimeSamples);\n    this.graphsLODs = new Array(this.graphsTimeSamples);\n    this.graphsBuild = new Array(this.graphsTimeSamples);\n    this.graphsFluxTextures = new Array(this.graphsTimeSamples);\n    this.graphsFluxMeshes = new Array(this.graphsTimeSamples);\n    this.graphsFluxGeodatas = new Array(this.graphsTimeSamples);\n    this.graphsFluxTexture = [[0,0],[0,0]];\n    this.graphsFluxMesh = [[0,0],[0,0]];\n    this.graphsFluxGeodata = [[0,0],[0,0]];\n    this.graphsCreateTextureTime = 0;\n    this.graphsCreateGpuMeshTime = 0;\n    this.graphsCreateMeshTime = 0;\n    this.resetGraphs();\n\n    this.meshesFaces = 0;\n    this.meshesUVArea = 0;\n    this.gpuMeshes = 0;\n    this.gpuTextures = 0;\n    this.gpuGeodata = 0;\n    this.gpuUsed = 0;\n    this.resourcesUsed = 0;\n    this.metaUsed = 0;\n    this.gpuRenderUsed = 0;\n    this.loadedCount = 0;\n    this.loadErrorCount = 0;\n    this.loadFirst = 0;\n    this.loadLast = 0;\n    this.gpuNeeded = 0;\n    this.gpuNeeded2 = 0;\n\n    this.heightClass = 0;\n    this.heightLod = 0;\n    this.heightNode = 0;\n    this.heightTerrain = 0;\n    this.heightDelta = 0;\n    this.debugStr = null;\n};\n\n//Object.defineProperty(MapStats.prototype, 'gpuNeeded', {\n    //get: function() { return this.gpuNeeded2; /*console.log(\"\"+this.gpuNeeded);*/ },\n    //set: function(value) { \n        //this.gpuNeeded2 = value; console.log(\"\"+this.gpuNeeded);\n    //}\n//});\n\n\nMapStats.prototype.resetGraphs = function() {\n    this.graphsTimeIndex = 0;\n\n    for (var i = 0; i < this.graphsTimeSamples; i++) {\n        this.graphsRenderTimes[i] = 0;\n        this.graphsCreateMeshTimes[i] = 0;\n        this.graphsCreateGpuMeshTimes[i] = 0;\n        this.graphsCreateTextureTimes[i] = 0;\n        this.graphsFrameTimes[i] = 0;\n        this.graphsCpuMemoryUsed[i] = 0;\n        this.graphsCpuMemoryMetatiles[i] = 0;\n        this.graphsGpuMemoryTextures[i] = 0;\n        this.graphsGpuMemoryMeshes[i] = 0;\n        this.graphsGpuMemoryGeodata[i] = 0;\n        this.graphsGpuMemoryRender[i] = 0;\n        this.graphsPolygons[i] = 0;\n        this.graphsLODs[i] = [0,[]];\n        this.graphsBuild[i] = 0;\n        this.graphsFluxTextures[i] = [[0,0],[0,0]];\n        this.graphsFluxMeshes[i] = [[0,0],[0,0]];\n        this.graphsFluxGeodatas[i] = [[0,0],[0,0]];\n    }\n};\n\n\nMapStats.prototype.begin = function(dirty) {\n    if (dirty) {\n        this.drawnTiles = 0;\n        this.drawnGeodataTiles = 0;\n        this.drawnGeodataTilesFactor = 0;\n        this.drawnGeodataTilesPerLayer = 0;\n        this.drawCalls = 0;        \n        this.drawnFaces = 0;\n        this.gpuRenderUsed = 0;\n        this.gpuNeeded = 0;\n        this.usedNodes = 0;    \n        this.processedNodes = 0;    \n        this.processedMetatiles = 0;    \n        this.meshesFaces = 0;\n        this.meshesUVArea = 0;\n\n        for (var i = 0, li = this.renderedLods.length; i < li; i++) {\n            this.renderedLods[i] = 0;\n        } \n    }\n\n    this.debugIds = {};\n\n    this.counter++;\n    this.statsCycle++;\n\n    this.renderTimeBegin = performance.now();\n\n    if (dirty) {\n        if (this.lastFrameTime) {\n            this.frameTime = this.renderTimeBegin - this.lastFrameTime;\n        }\n\n        this.lastFrameTime = this.renderTimeBegin;\n    }\n};\n\n\nMapStats.prototype.end = function(dirty) {\n    var timer = performance.now();\n\n    var renderTime = timer - this.renderTimeBegin;\n    //var frameTime = timer - this.frameTime;\n    //this.frameTime = timer;\n    if (dirty) { \n        this.renderTimeTmp += renderTime;\n        this.lastRenderTime = renderTime;\n    } else {\n        this.renderTimeTmp += this.lastRenderTime;\n    }\n\n    if (this.recordGraphs) {\n        var i = this.graphsTimeIndex;\n\n        this.graphsRenderTimes[i] = renderTime;\n        this.graphsCreateMeshTimes[i] = 0;\n        this.graphsCreateGpuMeshTimes[i] = 0;\n        this.graphsCreateTextureTimes[i] = 0;\n        this.graphsFrameTimes[i] = this.frameTime;\n        this.graphsCpuMemoryUsed[i] = this.map.resourcesCache.totalCost;\n        this.graphsCpuMemoryMetatiles[i] = this.map.metatileCache.totalCost;\n        this.graphsGpuMemoryTextures[i] = this.gpuTextures;\n        this.graphsGpuMemoryMeshes[i] = this.gpuMeshes;\n        this.graphsGpuMemoryGeodata[i] = this.gpuGeodata;\n        this.graphsGpuMemoryRender[i] = this.gpuRenderUsed;\n        this.graphsPolygons[i] = this.drawnFaces;\n        this.graphsFluxTextures[i] = [[this.graphsFluxTexture[0][0], this.graphsFluxTexture[0][1]], [this.graphsFluxTexture[1][0], this.graphsFluxTexture[1][1]] ];\n        this.graphsFluxMeshes[i] = [[this.graphsFluxMesh[0][0], this.graphsFluxMesh[0][1]], [this.graphsFluxMesh[1][0], this.graphsFluxMesh[1][1]] ];\n        this.graphsFluxGeodatas[i] = [[this.graphsFluxGeodata[0][0], this.graphsFluxGeodata[0][1]], [this.graphsFluxGeodata[1][0], this.graphsFluxGeodata[1][1]] ];\n        this.graphsLODs[i] = [this.drawnTiles, this.renderedLods.slice()];\n        this.graphsBuild[i] = this.renderBuild;\n\n        this.graphsTimeIndex = (this.graphsTimeIndex + 1) % this.graphsTimeSamples;\n        \n        if (this.inspector && this.inspector.graphs) {\n            this.inspector.graphs.updateGraphs(this);\n        }\n    }\n\n\n    if ((this.statsCycle % 50) == 0) {\n        this.renderTime = this.renderTimeTmp / 100;\n        this.fps = 1000 / this.renderTime;\n        this.renderTimeTmp = 0;\n\n        if (this.inspector && this.inspector.stats) {\n            this.gpuUsed = this.map.gpuCache.totalCost;\n            this.resourcesUsed = this.map.resourcesCache.totalCost;\n            this.metaUsed = this.map.metatileCache.totalCost;\n\n            this.inspector.stats.updateStatsPanel(this);\n        }\n    }\n    \n    //do not reset flux data in begin function, because we to collect data from events which     \n    this.graphsFluxTexture = [[0,0],[0,0]];\n    this.graphsFluxMesh = [[0,0],[0,0]];\n    this.graphsFluxGeodata = [[0,0],[0,0]];\n    this.debugStr = this.map.renderer.debugStr;\n};\n\n\nexport default MapStats;\n\n","\nvar MapSurfaceSequence = function(map) {\n    this.map = map;\n};\n\n\nMapSurfaceSequence.prototype.generateSurfaceSequence = function() {\n    var view = this.map.currentView;\n    var tree = this.map.tree;\n    \n    if (!tree) {\n        return;\n    }\n    \n    tree.surfaceSequence = [];\n    tree.surfaceSequenceIndices = []; //probably not used\n    tree.surfaceOnlySequence = [];\n\n    var vsurfaces = {}, surface, glue; \n    var vsurfaceCount = 0;\n    var list = [], listId, i, li, j , lj, key;\n    var strId = [];\n        \n    //add surfaces to the list\n    for (key in view.surfaces) {\n        surface = this.map.getSurface(key);\n        \n        if (surface) {\n            strId.push(surface.id);\n            vsurfaceCount++;\n            vsurfaces[key] = surface.index + 1; //add one to avoid zero \n            //list.push([\"\" + (surface.index + 1), surface, true]);    \n            list.push([ [(surface.index + 1)], surface, true, false]); //[surfaceId, surface, isSurface, isAlien]    \n        }\n    }\n\n\n    if (vsurfaceCount >= 1) { //do we have virtual surface?\n        strId.sort(); \n        strId = strId.join(';');\n\n        surface = this.map.virtualSurfaces[strId];\n        if (surface) {\n            list = [ [ [(surface.index + 1)], surface, true, false] ]; //[surfaceId, surface, isSurface, isAlien]    \n            vsurfaceCount = 1;\n        }\n    }\n    \n    if (vsurfaceCount > 1) {\n        \n        var glues = [];\n    \n        //add proper glues to the list\n        for (key in this.map.glues) {\n            glue = this.map.glues[key];\n\n            //add only glue which contains desired surfaces\n\n            if (!glue || !glue.id) continue;\n\n            var id = glue.id; \n            if (id.length <= vsurfaceCount) {\n    \n                var missed = false;\n                for (j = 0, lj = id.length; j < lj; j++) {\n                    if (!vsurfaces[id[j]]) {\n                        missed = true;\n                        break;\n                    }\n                }\n    \n                if (!missed) {\n                    //var listId = \"\";\n                    listId = [];\n                    \n                    //create glue id in reverse order for sorting\n                    for (j = 0, lj = id.length; j < lj; j++) {\n                        //listId = vsurfaces[id[j]] + (j ? \".\" : \"\") + listId;\n                        listId.unshift(vsurfaces[id[j]]);\n                    }\n    \n                    glues.push([listId, glue, false, false]); //[surfaceId, surface, isSurface, isAlien]   \n                }\n            }\n        }\n    \n        //process glue flags\n        for (i = 0, li = glues.length; i < li; i++) {\n            var item = glues[i];\n            glue = item[1];\n    \n            glue.flagProper = true;\n            glue.flagAlien = true;\n    \n            if (glue.flagProper) {\n                list.push(item);  \n            }\n                    \n            if (glue.flagAlien) {\n                //remove first surface from id\n                listId = item[0].slice(1);\n                            \n                //add same glue as alien\n                list.push([listId, item[1], false, true]); //[surfaceId, surface, isSurface, isAlien]   \n            }\n        }\n    \n        //sort list alphabetically\n        do {\n            var sorted = true;\n            \n            for (i = 0, li = list.length - 1; i < li; i++) {\n                var a1 = list[i][0];\n                var a2 = list[i+1][0];\n                \n                var lesser = false;\n                \n                for (j = 0, lj = Math.min(a1.length, a2.length); j < lj; j++) {\n                    if (a1[j] < a2[j] || (j == (lj -1) && a1[j] == a2[j] && a2.length > a1.length)) {\n                        lesser = true;\n                        break;                    \n                    }\n                }\n                \n                if (lesser) {\n                    var t = list[i];\n                    list[i] = list[i+1];\n                    list[i+1] = t;\n                    sorted = false;\n                } \n            }\n            \n        } while(!sorted);\n   \n        var lastIndex = vsurfaceCount - 1;\n    \n        //convert list to surface sequence\n        for (i = 0, li = list.length; i < li; i++) {\n            tree.surfaceSequence.push([list[i][1], list[i][3]]); //[surface, isAlien]\n            //this.surfaceSequence.push(list[i][1]); \n            list[i][1].viewSurfaceIndex = lastIndex; \n            \n            if (list[i][2]) {\n                lastIndex--;\n                tree.surfaceOnlySequence.push(list[i][1]);\n            }\n        }\n    \n        //this.generateSurfaceSequenceOld();\n        \n    } else {\n        if (vsurfaceCount == 1) {\n            tree.surfaceSequence.push([list[0][1], list[0][3]]); //[surface, isAlien]\n            list[0][1].viewSurfaceIndex = vsurfaceCount - 1;\n            tree.surfaceOnlySequence = [list[0][1]];\n        }\n    }\n\n    this.map.freeLayersHaveGeodata = false;\n\n    //free layers\n    for (key in view.freeLayers) {\n        var freeLayer = this.map.getFreeLayer(key);\n        if (freeLayer) {\n            freeLayer.surfaceSequence = [freeLayer];\n            freeLayer.surfaceOnlySequence = [freeLayer];\n            \n            if (freeLayer.geodata) {\n                this.map.freeLayersHaveGeodata = true;\n            }\n        }\n    }    \n\n    //just in case\n    this.map.renderer.draw.clearJobBuffer();\n};\n\n\nMapSurfaceSequence.prototype.generateBoundLayerSequence = function() {\n    var view = this.map.currentView;\n    var key, item, layer, alpha, i, li, item2;\n    \n    //zero bound layer filters\n    var layers = this.map.boundLayers;\n    for (var key in layers) {\n        layers[key].shaderFilters = null;\n    }\n\n    //surfaces\n    for (key in view.surfaces) {\n        var surfaceLayers = view.surfaces[key];\n        var surface = this.map.getSurface(key);\n        if (surface != null) {\n            surface.boundLayerSequence = [];\n            \n            for (i = 0, li = surfaceLayers.length; i < li; i++) {\n                item = surfaceLayers[i];\n        \n                if (typeof item === 'string') {\n                    layer = this.map.getBoundLayerById(item);\n                    if (layer) {\n                        surface.boundLayerSequence.push([layer, 1]);\n                    }\n                } else {\n                    layer = this.map.getBoundLayerById(item['id']);\n                    if (layer) {\n\n                        alpha = 1;\n                        if (typeof item['alpha'] !== 'undefined') {\n                            alpha = parseFloat(item['alpha']);\n                        }\n\n                        surface.boundLayerSequence.push([layer, alpha]);\n\n                        item2 = item['options'] || item;\n\n                        if (item2['shaderVarFlatShade']) {\n                            if (!layer.shaderFilters) {\n                                layer.shaderFilters = {};\n                            }\n                            \n                            if (!layer.shaderFilters[surface.id]) {\n                                layer.shaderFilters[surface.id] = {};\n                            }\n\n                            layer.shaderFilters[surface.id].varFlatShade = item2['shaderVarFlatShade'];\n                        }\n\n                        if (item2['shaderFilter']) {\n                            if (!layer.shaderFilters) {\n                                layer.shaderFilters = {};\n                            }\n                            \n                            if (!layer.shaderFilters[surface.id]) {\n                                layer.shaderFilters[surface.id] = {};\n                            }\n\n                            layer.shaderFilters[surface.id].filter = item2['shaderFilter'];\n                        }\n                    }\n                }\n            }\n        }\n    }\n\n    //free layers\n    for (key in view.freeLayers) {\n        var freeLayersProperties = view.freeLayers[key];\n        var freeLayer = this.map.getFreeLayer(key);\n        if (freeLayer != null && freeLayer.ready) {\n            freeLayer.boundLayerSequence = [];\n            \n            var boundLayers = freeLayersProperties['boundLayers'];\n            \n            if (boundLayers && Array.isArray(boundLayers)) {\n\n                for (i = 0, li = boundLayers.length; i < li; i++) {\n                    item = boundLayers[i];\n            \n                    if (typeof item === 'string') {\n                        layer = this.map.getBoundLayerById(item);\n                        if (layer) {\n                            freeLayer.boundLayerSequence.push([layer, 1]);\n                        }\n                    } else {\n                        layer = this.map.getBoundLayerById(item['id']);\n                        if (layer) {\n    \n                            alpha = 1;\n                            if (typeof item['alpha'] !== 'undefined') {\n                                alpha = parseFloat(item['alpha']);\n                            }\n    \n                            freeLayer.boundLayerSequence.push([layer, alpha]);\n\n                            if (item['shaderVarFlatShade']) {\n                                if (!layer.shaderFilters) {\n                                    layer.shaderFilters = {};\n                                }\n                                \n                                if (!layer.shaderFilters[surface.id]) {\n                                    layer.shaderFilters[surface.id] = {};\n                                }\n\n                                layer.shaderFilters[surface.id].varFlatShade = item['shaderVarFlatShade'];\n                            }\n\n                            if (item['shaderFilter']) {\n                                if (!layer.shaderFilters) {\n                                    layer.shaderFilters = {};\n                                }\n                                \n                                if (!layer.shaderFilters[surface.id]) {\n                                    layer.shaderFilters[surface.id] = {};\n                                }\n\n                                layer.shaderFilters[surface.id].filter = item['shaderFilter'];\n                            }\n                        }\n                    }\n                }\n            }  \n        }\n    }\n};\n\n\nexport default MapSurfaceSequence;\n\n","\nimport {vec3 as vec3_} from '../utils/matrix';\nimport {utils as utils_} from '../utils/utils';\nimport {platform as platform_} from '../utils/platform';\nimport MapView_ from './view';\nimport MapSurfaceTree_ from './surface-tree';\nimport MapResourceTree_ from './resource-tree';\nimport MapSrs_ from './srs';\nimport MapCache_ from './cache';\nimport MapCamera_ from './camera';\nimport MapConfig_ from './config';\nimport MapConvert_ from './convert';\nimport MapMeasure_ from './measure';\nimport MapDraw_ from './draw';\nimport MapLoader_ from './loader/loader';\nimport MapPosition_ from './position';\nimport MapRenderSlots_ from './render-slots';\nimport MapStats_ from './stats';\nimport MapSurfaceSequence_ from './surface-sequence';\nimport MapUrl_ from './url';\nimport GpuTexture_ from '../renderer/gpu/texture';\n\n//get rid of compiler mess\nvar vec3 = vec3_;\nvar utils = utils_;\nvar platform = platform_;\nvar MapView = MapView_;\nvar MapSurfaceTree = MapSurfaceTree_;\nvar MapResourceTree = MapResourceTree_;\nvar MapSrs = MapSrs_;\nvar MapCache = MapCache_;\nvar MapCamera = MapCamera_;\nvar MapConfig = MapConfig_;\nvar MapConvert = MapConvert_;\nvar MapMeasure = MapMeasure_;\nvar MapDraw = MapDraw_;\nvar MapLoader = MapLoader_;\nvar MapPosition = MapPosition_;\nvar MapRenderSlots = MapRenderSlots_;\nvar MapStats = MapStats_;\nvar MapSurfaceSequence = MapSurfaceSequence_;\nvar MapUrl = MapUrl_;\nvar GpuTexture = GpuTexture_;\n\n\nvar Map = function(core, mapConfig, path, config, configStorage) {\n    this.config = config || {};\n    this.setConfigParams(config);\n    this.setLoaderParams(mapConfig, configStorage);\n    this.core = core;\n    this.proj4 = this.core.getProj4();\n    this.coreConfig = core.coreConfig;\n    this.killed = false;\n    this.config = config || {};\n    this.loaderSuspended = false;\n\n    this.url = new MapUrl(this, path);\n\n    this.position = new MapPosition(['obj', 0, 0, 'fix', 0,  0, 0, 0,  0, 0]);\n    this.lastPosition = this.position.clone();\n\n    this.srses = {};\n    this.bodies = {};\n    this.referenceFrame = {};\n    this.credits = {};\n    this.creditsByNumber = {};\n    this.surfaces = {};\n    this.virtualSurfaces = {};\n    this.glues = {};\n    this.freeLayers = {};\n    this.boundLayers = {};\n    this.stylesheets = {};\n    this.processingTasks = [];\n    this.processingTasks2 = [];\n    this.geodataProcessors = [];\n\n    this.surfaceSequence = new MapSurfaceSequence(this);\n\n    this.initialView = null;\n    this.currentView = new MapView(this, {});\n    this.currentViewString = '';\n    this.namedViews = {};\n    this.viewCounter = 0;\n    this.srsReady = false;\n    this.surfaceCounter = 0;\n\n    this.freeLayerSequence = [];\n    this.freeLayersHaveGeodata = false;\n\n    this.visibleCredits = {\n        imagery : {},\n        glueImagery : {},\n        mapdata : {}\n    };\n    \n    this.mobile = false;\n    this.metanodeBuffer = new Uint8Array(1024);\n   \n    this.gpuCache = new MapCache(this, this.config.mapGPUCache*1024*1024);\n    this.resourcesCache = new MapCache(this, this.config.mapCache*1024*1024);\n    this.metatileCache = new MapCache(this, this.config.mapMetatileCache*1024*1024);\n\n    this.setupMobileMode(this.config.mapMobileMode);\n    this.setupCache();\n\n    this.loader = new MapLoader(this, this.config.mapDownloadThreads);\n\n    this.renderer = this.core.renderer;\n    this.camera = new MapCamera(this);\n\n    this.stats = new MapStats(this);\n    this.resourcesTree = new MapResourceTree(this);\n   \n    this.mapConfig = new MapConfig(this, mapConfig);\n    this.convert = new MapConvert(this);\n    this.measure = new MapMeasure(this);\n    this.convert.measure = this.measure;\n\n    this.isGeocent = !this.getNavigationSrs().isProjected();\n\n    this.tree = new MapSurfaceTree(this, false);\n    this.mapConfig.afterConfigParsed();\n\n    this.updateCoutner = 0;\n\n    this.dirty = true;\n    this.dirtyCountdown = 0;\n    this.hitMapDirty = true;\n    this.geoHitMapDirty = true;\n\n    this.clickEvent = null;\n    this.hoverEvent = null;\n    this.hoverFeature = null;\n    this.hoverFeatureId = null;\n    this.lastHoverFeature = null;\n    this.lastHoverFeatureId = null;\n    this.hoverFeatureCounter = 0;\n    this.hoverFeatureList = [];\n    \n    this.draw = new MapDraw(this);\n    this.draw.setupDetailDegradation();\n\n    var body = this.referenceFrame.body, c;\n\n    if (body && body.atmosphere) {\n        c = body.atmosphere.colorHorizon;\n        this.draw.atmoColor = [c[0]/255.0, c[1]/255.0, c[2]/255.0, c[3]/255.0];\n        c = body.atmosphere.colorZenith;\n        this.draw.atmoColor2 = [c[0]/255.0, c[1]/255.0, c[2]/255.0, c[3]/255.0];\n        this.draw.atmoHeight = 50000 * (body.atmosphere.thickness / 100000);\n        this.draw.atmoDensity = (body.atmosphere.visibility / 100000) * (100000 / body.atmosphere.thickness);\n    } else {\n        switch(this.referenceFrame.id) {\n            case 'melown2015':\n            case 'earth-qsc':\n                this.draw.atmoColor = [216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0];\n                this.draw.atmoColor2 = [72.0/255.0, 154.0/255.0, 255.0/255.0, 1.0];\n                //this.draw.atmoColor3 = [216.0/255.0, 232.0/255.0, 243.0/255.0, 1.0];\n                this.draw.atmoHeight = 50000;\n                break;\n\n            case 'mars-qsc':\n                this.draw.atmoColor = [255.0/255.0, 187.0/255.0, 157.0/255.0, 1.0];\n                this.draw.atmoColor2 = [255.0/255.0, 155.0/255.0, 113.0/255.0, 1.0];\n                //this.draw.atmoColor3 = [255.0/255.0, 187.0/255.0, 157.0/255.0, 0.5];\n                this.draw.atmoHeight = 25000;\n                this.draw.atmoDensity = 1.0 / 0.25;\n                break;\n        }\n    }\n\n    this.draw.atmoHeightFactor = this.draw.atmoHeight / 50000;\n\n    this.renderSlots = new MapRenderSlots(this);\n    this.renderSlots.addRenderSlot('map', this.drawMap.bind(this), true);\n};\n\n\nMap.prototype.kill = function() {\n    this.killed = true;\n    \n    if (this.tree) {\n        this.tree.kill();\n    }\n\n    for (var key in this.freeLayers) {\n        var layer = this.freeLayers[key];\n        if (layer && layer.tree) {\n            layer.tree.kill();\n        }\n    }\n\n    this.gpuCache.clear();\n    this.resourcesCache.clear();\n    this.metatileCache.clear();\n\n    if (this.renderer != null) {\n        this.renderer.kill();\n        this.renderer = null;\n    }\n};\n\n\nMap.prototype.setupMobileMode = function() {\n    this.mobile = this.config.mapMobileMode;\n\n    if (!this.mobile && this.config.mapMobileModeAutodect) {\n        this.mobile = platform.isMobile();        \n    }\n\n    this.setupCache();\n};\n\n\nMap.prototype.setupCache = function() {\n    if (!this.resourcesCache) {\n        return;\n    }\n\n    var factor = 1 / (this.mobile ? Math.pow(2, Math.max(0,this.config.mapMobileDetailDegradation-1)) : 1);\n    var factor2 = 1 / (this.mobile ? Math.pow(2, this.config.mapMobileDetailDegradation) : 1);\n    factor = (factor + factor2) * 0.5;\n    this.resourcesCache.setMaxCost(this.config.mapCache*1024*1024*factor);\n    this.gpuCache.setMaxCost(this.config.mapGPUCache*1024*1024*factor);\n    this.metatileCache.setMaxCost(this.config.mapMetatileCache*1024*1024*(factor < 0.8 ? 0.5 : 1));\n};\n\n\nMap.prototype.getCoreInterface = function() {\n    return this.core.interface;\n};\n\n\nMap.prototype.getRendererInterface = function() {\n    return this.core.interface.getRendererInterface();\n};\n\n\nMap.prototype.setOption = function(/*key, value*/) {\n};\n\n\nMap.prototype.getOption = function(/*key*/) {\n};\n\n\nMap.prototype.addSrs = function(id, srs) {\n    this.srses[id] = srs;\n};\n\n\nMap.prototype.getSrs = function(srsId) {\n    return this.srses[srsId];\n};\n\n\nMap.prototype.getSrses = function() {\n    return this.getMapKeys(this.srses);\n};\n\n\nMap.prototype.addBody = function(id, body) {\n    this.bodies[id] = body;\n};\n\n\nMap.prototype.getBody = function(id) {\n    return this.bodies[id];\n};\n\n\nMap.prototype.getBodies = function() {\n    return this.getMapKeys(this.bodies);\n};\n\n\nMap.prototype.setReferenceFrame = function(referenceFrame) {\n    this.referenceFrame = referenceFrame;\n};\n\n\nMap.prototype.addCredit = function(id, credit) {\n    this.credits[id] = credit;\n    this.creditsByNumber[credit.id] = credit;\n    credit.key = id;\n};\n\n\nMap.prototype.getCreditByNumber = function(id) {\n    return this.creditsByNumber[id];\n};\n\n\nMap.prototype.getCreditById = function(id) {\n    return this.credits[id];\n};\n\n\nMap.prototype.getCredits = function() {\n    return this.getMapKeys(this.credits);\n};\n\n\nMap.prototype.getVisibleCredits = function() {\n    var imagery = this.visibleCredits.imagery;\n    var glueImagery = this.visibleCredits.glueImagery;\n    var imageryArray = []; \n    var imagerySpecificity = [];\n    var i, li, t, sorted;\n\n    for (var key in glueImagery) {\n        if (!imagery[key]) {\n            imagery[key] = glueImagery[key];\n        }\n    }\n    \n    this.visibleCredits.glueImagery = {};\n    \n    for (key in imagery) {\n        imageryArray.push(key);\n        imagerySpecificity.push(imagery[key]); \n    }\n\n    //sort imagery\n    do {\n        sorted = true;\n        \n        for (i = 0, li = imagerySpecificity.length - 1; i < li; i++) {\n            if (imagerySpecificity[i] < imagerySpecificity[i+1]) {\n                t = imagerySpecificity[i];\n                imagerySpecificity[i] = imagerySpecificity[i+1];\n                imagerySpecificity[i+1] = t;\n                t = imageryArray[i];\n                imageryArray[i] = imageryArray[i+1];\n                imageryArray[i+1] = t;\n                sorted = false;\n            } \n        }\n        \n    } while(!sorted);\n\n    var mapdata = this.visibleCredits.mapdata;\n    var mapdataArray = []; \n    var mapdataSpecificity = []; \n\n    for (key in mapdata) {\n        mapdataArray.push(key);\n        mapdataSpecificity.push(mapdata[key]); \n    }\n    \n    //sort imagery\n    do {\n        sorted = true;\n        \n        for (i = 0, li = mapdataSpecificity.length - 1; i < li; i++) {\n            if (mapdataSpecificity[i] < mapdataSpecificity[i+1]) {\n                t = mapdataSpecificity[i];\n                mapdataSpecificity[i] = mapdataSpecificity[i+1];\n                mapdataSpecificity[i+1] = t;\n                t = mapdataArray[i];\n                mapdataArray[i] = mapdataArray[i+1];\n                mapdataArray[i+1] = t;\n                sorted = false;\n            } \n        }\n        \n    } while(!sorted);\n\n    return {\n        '3D' : [], \n        'imagery' : imageryArray, \n        'mapdata' : mapdataArray \n    };\n};\n\n\nMap.prototype.addSurface = function(id, surface) {\n    this.surfaces.push(surface);\n    surface.index = this.surfaces.length - 1; \n};\n\n\nMap.prototype.getSurface = function(id) {\n    return this.searchArrayById(this.surfaces, id);\n};\n\n\nMap.prototype.getSurfaces = function() {\n    var keys = [];\n    for (var i = 0, li = this.surfaces.length; i < li; i++) {\n        keys.push(this.surfaces[i].id);\n    }\n    return keys;\n};\n\n\nMap.prototype.addGlue = function(id, glue) {\n    this.glues[id] = glue;\n};\n\n\nMap.prototype.getGlue = function(id) {\n    return this.glues[id];\n};\n\n\nMap.prototype.addBoundLayer = function(id, layer) {\n    this.boundLayers[id] = layer;\n};\n\n\nMap.prototype.setBoundLayerOptions = function(id, options) {\n    if (this.boundLayers[id]) {\n        this.boundLayers[id].setOptions(options);\n    }\n};\n\n\nMap.prototype.getBoundLayerOptions = function(id) {\n    if (this.boundLayers[id]) {\n        return this.boundLayers[id].getOptions();\n    }\n    \n    return null;\n};\n\n\nMap.prototype.removeBoundLayer = function(id) {\n    if (this.boundLayers[id]) {\n        this.boundLayers[id].kill();\n        this.boundLayers[id] = null;\n    }\n};\n\n\nMap.prototype.getBoundLayerByNumber = function(number) {\n    var layers = this.boundLayers;\n    for (var key in layers) {\n        if (layers[key].numberId == number) {\n            return layers[key];\n        }\n    }\n\n    return null;\n};\n\n\nMap.prototype.getBoundLayerById = function(id) {\n    return this.boundLayers[id];\n};\n\n\nMap.prototype.getBoundLayers = function() {\n    return this.getMapKeys(this.boundLayers);\n};\n\n\nMap.prototype.addFreeLayer = function(id, layer) {\n    this.freeLayers[id] = layer;\n    this.setView(this.getView());\n    this.markDirty();\n};\n\n\nMap.prototype.removeFreeLayer = function(id) {\n    if (this.freeLayers[id]) {\n        this.freeLayers[id].kill();\n        this.freeLayers[id] = null;\n        this.setView(this.getView());\n        this.markDirty();\n    }\n};\n\n\nMap.prototype.setFreeLayerOptions = function(id, options) {\n    if (this.freeLayers[id]) {\n        this.freeLayers[id].setOptions(options);\n    }\n};\n\n\nMap.prototype.getFreeLayerOptions = function(id) {\n    if (this.freeLayers[id]) {\n        return this.freeLayers[id].getOptions();\n    }\n    \n    return null;\n};\n\n\nMap.prototype.getFreeLayer = function(id) {\n    return this.freeLayers[id];\n    //return this.searchArrayById(this.freeLayers, id);\n};\n\n\nMap.prototype.getFreeLayers = function() {\n    var keys = [];\n    for (var key in this.freeLayers) {\n        keys.push(key);\n    }\n    return keys;    \n};\n\n\nMap.prototype.getMapsSrs = function(srs) {\n    if (srs == null) {\n        return null;\n    }\n\n    //is it proj4 string?\n    if (srs.indexOf('+proj') != -1) {\n        return new MapSrs(this, {'srsDef':srs});\n    }\n\n    //search existing srs\n    return this.srses[srs];\n};\n\n\nMap.prototype.addNamedView = function(id, view) {\n    this.namedViews[id] = view;\n};\n\n\nMap.prototype.getNamedView = function(id) {\n    return this.namedViews[id];\n};\n\n\nMap.prototype.getNamedViews = function() {\n    return this.getMapKeys(this.namedViews);\n};\n\n\nMap.prototype.setView = function(view, forceRefresh, posToFixed) {\n    if (view == null) {\n        return;\n    }\n\n    if (posToFixed && this.convert) {\n        var p = this.getPosition();\n        p = this.convert.convertPositionHeightMode(p, 'fix', true);\n        this.setPosition(p);\n    }\n    \n    if (typeof view === 'string') {\n        view = view.trim();\n        \n        if (view.charAt(0) == '{') {\n            try {\n                view = JSON.parse(view);\n            } catch(e){\n                return;            \n            }\n        } else {\n            view = this.getNamedView(view);\n\n            if (!view) {\n                return;\n            }\n            \n            //view = JSON.parse(JSON.stringify(view));\n            view = view.getInfo();\n        }\n    }\n\n    //construct view string without options\n    var string = {};\n\n    if (view.surfaces) {\n        string.surfaces = view.surfaces;\n    }\n\n    if (view.freeLayers) {\n        string.freeLayers = view.freeLayers;\n    }\n\n    string = JSON.stringify(string);\n\n    var renderer = this.renderer;\n\n    //process options\n    if (view.options) {\n        var se = view.options.superelevation;\n\n        if (se && se[0] && se[1] && se[0].length >=2 && se[1].length >=2) {\n            renderer.setSuperElevationState(true);\n            renderer.setSuperElevation(se[0][0], se[1][0], se[0][1], se[1][1]);\n        } else {\n            renderer.setSuperElevationState(false);\n        }\n    } else {\n        renderer.setSuperElevationState(false);        \n    }\n\n    if (string != this.currentViewString || forceRefresh) {\n        this.currentView.parse(view);\n        this.currentViewString = string;\n        this.viewCounter++;  //this also cause rest of geodata\n        renderer.draw.clearJobHBuffer(); //hotfix - reset hysteresis buffer\n    }\n\n    this.surfaceSequence.generateSurfaceSequence();\n    this.surfaceSequence.generateBoundLayerSequence();\n\n    this.refreshFreelayesInView();\n\n    this.markDirty();\n};\n\n\nMap.prototype.addStylesheet = function(id, style) {\n    this.stylesheets[id] = style;\n};\n\n\nMap.prototype.getStylesheet = function(id) {\n    return this.stylesheets[id];\n    //return this.searchArrayById(this.stylesheets, id);\n};\n\n\nMap.prototype.getStylesheets = function() {\n    var keys = [];\n\n    for (var key in this.stylesheets) {\n        keys.push(key);\n    }\n    return keys;\n};\n\n\nMap.prototype.getStylesheetData = function(id) {\n    var stylesheet = this.getStylesheet(id);\n\n    if (stylesheet) {\n        return {'url':stylesheet.url, 'data': stylesheet.data};\n    }\n    \n    return {'url':null, 'data':{}};\n};\n\n\nMap.prototype.setStylesheetData = function(id, data) {\n    var stylesheet = this.getStylesheet(id);\n    \n    //if (stylesheet) {\n      //  stylesheet.data = data;\n    //}\n\n    this.renderer.draw.clearJobHBuffer();\n\n    if (stylesheet) {\n        if (data) {\n            stylesheet.setData(data);\n        }\n\n        for (var key in this.freeLayers) {\n            var freeLayer = this.getFreeLayer(key);\n            if (freeLayer && freeLayer.geodata && freeLayer.stylesheet == stylesheet) {\n                \n                if (freeLayer.geodataProcessor) {\n                    freeLayer.geodataProcessor.setStylesheet(freeLayer.stylesheet);\n                }\n\n                freeLayer.geodataCounter++;\n            }\n        }\n    }\n\n    this.markDirty();\n        \n    //TODO: reset geodatview in free layers\n};\n\n\nMap.prototype.getView = function() {\n    return this.currentView.getInfo();\n};\n\n\nMap.prototype.refreshFreelayesInView = function() {\n    var freeLayers = this.currentView.freeLayers;\n    this.freeLayerSequence = [];\n\n    for (var key in freeLayers) {\n        var freeLayer = this.getFreeLayer(key);\n        \n        if (freeLayer) {\n            \n            freeLayer.zFactor = freeLayers[key]['depthOffset'];\n            freeLayer.maxLod = freeLayers[key]['maxLod'];\n            \n            this.freeLayerSequence.push(freeLayer);\n            \n            if (freeLayers[key]['style']) {\n                freeLayer.setStyle(freeLayers[key]['style']);\n            } else {\n                freeLayer.setStyle(freeLayer.originalStyle);\n            }\n            \n            //TODO: generate bound layer seqence for      \n        }\n    }\n};\n\nMap.prototype.refreshView = function() {\n    this.viewCounter++;\n    this.surfaceSequence.generateSurfaceSequence();\n    this.surfaceSequence.generateBoundLayerSequence();\n    this.refreshFreelayesInView();\n    this.markDirty();\n};\n\n\nMap.prototype.searchArrayIndexById = function(array, id) {\n    for (var i = 0, li = array.length; i < li; i++) {\n        if (array[i].id == id) {\n            return i;\n        }\n    }\n\n    return -1;\n};\n\n\nMap.prototype.searchArrayById = function(array, id) {\n    for (var i = 0, li = array.length; i < li; i++) {\n        if (array[i].id == id) {\n            return array[i];\n        }\n    }\n\n    return null;\n};\n\n\nMap.prototype.searchMapByInnerId = function(map, id) {\n    for (var key in map) {\n        if (map[key].id == id) {\n            return map[key];\n        }\n    }\n\n    return null;\n};\n\n\nMap.prototype.getMapKeys = function(map) {\n    var keys = [];\n    for (var key in map) {\n        keys.push(key);\n    }\n\n    return keys;\n};\n\n\nMap.prototype.getMapIds = function(map) {\n    var keys = [];\n    for (var key in map) {\n        keys.push(key.id);\n    }\n\n    return keys;\n};\n\n\nMap.prototype.setPosition = function(pos) {\n    this.position = new MapPosition(pos);\n    this.markDirty();\n};\n\n\nMap.prototype.isReferenceFrameReady = function() {\n    return this.referenceFrame.model.physicalSrs.isReady() &&\n           this.referenceFrame.model.publicSrs.isReady() &&\n           this.referenceFrame.model.navigationSrs.isReady();\n};\n\n\nMap.prototype.getPhysicalSrs = function() {\n    return this.referenceFrame.model.physicalSrs;\n};\n\n\nMap.prototype.getPublicSrs = function() {\n    return this.referenceFrame.model.publicSrs;\n};\n\n\nMap.prototype.getNavigationSrs = function() {\n    return this.referenceFrame.model.navigationSrs;\n};\n\n\nMap.prototype.getPosition = function() {\n    return this.position.clone();\n};\n\n\nMap.prototype.setLoaderParams = function(mapConfig, configStorage) {\n    var sources = [];\n\n    if (mapConfig && mapConfig['browserOptions']) {\n        sources.push(mapConfig['browserOptions']);\n    }\n\n    if (configStorage) {\n        sources.push(configStorage);\n    }\n\n    for (var i = 0, li = sources.length; i < li; i++) {\n        var source = sources[i];\n        for (var key in source) {\n            switch(key) {\n                case 'mapSeparateLoader':\n                case 'mapGeodataBinaryLoad':\n                case 'mapPackLoaderEvents':\n                case 'mapParseMeshInWorker':\n                case 'mapPackGeodataEvents':\n                    this.setConfigParam(key, source[key]);\n                    break;\n            }\n        }\n    }\n};\n\n\nMap.prototype.setConfigParams = function(params) {\n    if (typeof params === 'object' && params !== null) {\n        for (var key in params) {\n            this.setConfigParam(key, params[key]);\n        }\n    }\n};\n\n\nMap.prototype.setConfigParam = function(key, value) {\n    switch (key) {\n    case 'map':                           this.config.map = utils.validateString(value, null); break;\n    case 'mapCache':                      this.config.mapCache = utils.validateNumber(value, 10, Number.MAXINTEGER, 900); this.setupCache(); break;\n    case 'mapGPUCache':                   this.config.mapGPUCache = utils.validateNumber(value, 10, Number.MAXINTEGER, 360); this.setupCache(); break;\n    case 'mapMetatileCache':              this.config.mapMetatileCache = utils.validateNumber(value, 10, Number.MAXINTEGER, 60); this.setupCache(); break;\n    case 'mapTexelSizeFit':               this.config.mapTexelSizeFit = utils.validateNumber(value, 0.0001, Number.MAXINTEGER, 1.1); break;\n    case 'mapDownloadThreads':            this.config.mapDownloadThreads = utils.validateNumber(value, 1, Number.MAXINTEGER, 6); break;\n    case 'mapMaxProcessingTime':          this.config.mapMaxProcessingTime = utils.validateNumber(value, 1, Number.MAXINTEGER, 1000/20); break;\n    case 'mapMaxGeodataProcessingTime':   this.config.mapMaxGeodataProcessingTime = utils.validateNumber(value, 1, Number.MAXINTEGER, 10); break;\n    case 'mapMobileMode':                 this.config.mapMobileMode = utils.validateBool(value, false); this.setupMobileMode(); break;\n    case 'mapMobileModeAutodect':         this.config.mapMobileModeAutodect = utils.validateBool(value, false); break;\n    case 'mapMobileDetailDegradation':    this.config.mapMobileDetailDegradation = utils.validateNumber(value, 1, Number.MAXINTEGER, 2); break;\n    case 'mapNavSamplesPerViewExtent':    this.config.mapNavSamplesPerViewExtent = utils.validateNumber(value, 0.00000000001, Number.MAXINTEGER, 4); break;\n    case 'mapFog':                        this.config.mapFog = utils.validateBool(value, false); if(this.draw){ this.draw.debug.drawFog = this.config.mapFog; this.dirty = true; } break;\n    case 'mapFlatshade':                  this.config.mapFlatshade = utils.validateBool(value, false); if(this.draw){ this.draw.debug.drawWireframe = this.config.mapFlatshade ? 3 : 0; this.dirty = true; } break;\n    case 'mapIgnoreNavtiles':             this.config.mapIgnoreNavtiles = utils.validateBool(value, false); break;\n    case 'mapAllowHires':                 this.config.mapAllowHires = utils.validateBool(value, true); break;\n    case 'mapAllowLowres':                this.config.mapAllowLowres = utils.validateBool(value, true); break;\n    case 'mapAllowSmartSwitching':        this.config.mapAllowSmartSwitching = utils.validateBool(value, true); break;\n    case 'mapDisableCulling':             this.config.mapDisableCulling = utils.validateBool(value, false); break;\n    case 'mapPreciseCulling':             this.config.mapPreciseCulling = utils.validateBool(value, false); break;\n    case 'mapHeightLodBlend':             this.config.mapHeightLodBlend = utils.validateBool(value, true); break;\n    case 'mapHeightNodeBlend':            this.config.mapHeightNodeBlend = utils.validateBool(value, true); break;\n    case 'mapBasicTileSequence':          this.config.mapBasicTileSequence = utils.validateBool(value, true); break;\n    case 'mapSmartNodeParsing':           this.config.mapSmartNodeParsing = utils.validateBool(value, true); break;\n    case 'mapStoreLoadStats':             this.config.mapStoreLoadStats = utils.validateBool(value, true);  if (this.draw && this.draw.replay) this.draw.replay.storeLoaded = this.config.mapStoreLoadStats; break;\n    case 'mapXhrImageLoad':               this.config.mapXhrImageLoad = utils.validateBool(value, false); break;\n    case 'mapLoadMode':                   this.config.mapLoadMode = utils.validateString(value, 'topdown'); break;\n    case 'mapGeodataLoadMode':            this.config.mapGeodataLoadMode = utils.validateString(value, 'fit'); break;\n    case 'mapGridMode':                   this.config.mapGridMode = utils.validateString(value, 'linear'); break;\n    case 'mapGridSurrogatez':             this.config.mapGridSurrogatez = utils.validateBool(value, false); break;\n    case 'mapGridUnderSurface':           this.config.mapGridUnderSurface = utils.validateNumber(value, -Number.MAXINTEGER, Number.MAXINTEGER, 0); break;\n    case 'mapGridTextureLevel':           this.config.mapGridTextureLevel = utils.validateNumber(value, -Number.MAXINTEGER, Number.MAXINTEGER, -1); break;\n    case 'mapGridTextureLayer':           this.config.mapGridTextureLayer = utils.validateString(value, ''); break;\n    case 'mapPreciseBBoxTest':            this.config.mapPreciseBBoxTest = utils.validateBool(value, true); break;\n    case 'mapPreciseDistanceTest':        this.config.mapPreciseDistanceTest = utils.validateBool(value, false); break;\n    case 'mapHeightfiledWhenUnloaded':    this.config.mapHeightfiledWhenUnloaded = utils.validateBool(value, false); break;\n    case 'mapForceMetatileV3':            this.config.mapForceMetatileV3 = utils.validateBool(value, false); break;\n    case 'mapVirtualSurfaces':            this.config.mapVirtualSurfaces = utils.validateBool(value, true); break;\n    case 'mapDegradeHorizon':             this.config.mapDegradeHorizon = utils.validateBool(value, true); break;\n    case 'mapDegradeHorizonParams':       this.config.mapDegradeHorizonParams = utils.validateNumberArray(value, 4, [0,1,1,1], [Number.MAX_VALUE, Number.MAX_VALUE, Number.MAX_VALUE], [1, 3000, 15000, 7000]); break;\n    case 'mapRefreshCycles':              this.config.mapRefreshCycles = utils.validateNumber(value, 0, Number.MAXINTEGER, 3); break;\n    case 'mapDefaultFont':                this.config.mapDefaultFont = utils.validateString(value, ''); break;\n    case 'mapMetricUnits':                this.config.mapMetricUnits = utils.validateBool(value, true); break;\n    case 'mapLanguage':                   this.config.mapLanguage = utils.validateString(value, 'en'); break;\n    case 'mapNoTextures':                 this.config.mapNoTextures = this.config.mapDisableCulling = utils.validateBool(value, false); break;\n    case 'mapForceFrameTime':             this.config.mapForceFrameTime = utils.validateNumber(value, -1, Number.MAXINTEGER, 0); break;\n    case 'mapForcePipeline':              this.config.mapForcePipeline = utils.validateNumber(value, 0, Number.MAXINTEGER, 0); break;\n    case 'mapFeatureGridCells':           this.config.mapFeatureGridCells = utils.validateNumber(value, -Number.MAXINTEGER, Number.MAXINTEGER, 0); break;\n    case 'mapFeaturesPerSquareInch':      this.config.mapFeaturesPerSquareInch = utils.validateNumber(value, 0.000001, Number.MAXINTEGER, 0); break;\n    case 'mapFeaturesSortByTop':          this.config.mapFeaturesSortByTop = utils.validateBool(value, false); break;\n    case 'mapFeaturesReduceParams':       this.config.mapFeaturesReduceParams = value; break;\n    case 'mapLogGeodataStyles':           this.config.mapLogGeodataStyles = utils.validateBool(value, true); break;\n    case 'map16bitMeshes':                this.config.map16bitMeshes = utils.validateBool(value, false); break;\n    case 'mapOnlyOneUVs':                 this.config.mapOnlyOneUVs = utils.validateBool(value, false); break;\n    case 'mapIndexBuffers':               this.config.mapIndexBuffers = utils.validateBool(value, false); break;\n    case 'mapSoftViewSwitch':             this.config.mapSoftViewSwitch = utils.validateBool(value, true); break;\n    case 'mapAsyncImageDecode':           this.config.mapAsyncImageDecode = (utils.validateBool(value, false) && (typeof createImageBitmap !== 'undefined')) ? true : false; break;\n    case 'mapFeatureStickMode':           this.config.mapFeatureStickMode = utils.validateNumberArray(value, 2, [0,1], [Number.MAX_VALUE, Number.MAX_VALUE], [0, 1]); break;\n    case 'mapSeparateLoader':             this.config.mapSeparateLoader = utils.validateBool(value, true); break;\n    case 'mapGeodataBinaryLoad':          this.config.mapGeodataBinaryLoad = utils.validateBool(value, true); break;\n    case 'mapPackLoaderEvents':           this.config.mapPackLoaderEvents = utils.validateBool(value, true); break;\n    case 'mapParseMeshInWorker':          this.config.mapParseMeshInWorker = utils.validateBool(value, true); break;\n    case 'mapPackGeodataEvents':          this.config.mapPackGeodataEvents = utils.validateBool(value, true); break;\n    case 'mapSortHysteresis':             this.config.mapSortHysteresis = utils.validateBool(value, false); break;\n    case 'mapHysteresisWait':             this.config.mapHysteresisWait = utils.validateNumber(value, 0, Number.MAXINTEGER, 0); break;\n    case 'mapBenevolentMargins':          this.config.mapBenevolentMargins = utils.validateBool(value, false); break;\n    case 'mapCheckTextureSize':           this.config.mapCheckTextureSize = utils.validateBool(value, false); break;\n    case 'mapDMapSize':                   this.config.mapDMapSize = utils.validateNumber(value, 16, Number.MAXINTEGER, 512); break; \n    case 'mapDMapMode':                   this.config.mapDMapMode = utils.validateNumber(value, 1, Number.MAXINTEGER, 1); break;\n    case 'mapSplitSpace':                 this.config.mapSplitSpace = value; break;\n    case 'mario':                         this.config.mario = utils.validateBool(value, true); break;\n    case 'mapFeaturesReduceMode':         \n        value = utils.validateString(value, 'scr-count4');\n        if (value == 'auto') value = 'scr-count2';\n        if (value == 'legacy') value = 'scr-count2';\n        if (value == 'gridcells') value = 'scr-count4';\n        if (value == 'singlepass') value = 'scr-count5';\n        if (value == 'margin') value = 'scr-count6';\n        //if (value == 'margin') value = 'scr-count7';\n        this.config.mapFeaturesReduceMode = value;\n        break;\n\n    }\n};\n\n\nMap.prototype.getConfigParam = function(key) {\n    switch (key) {\n    case 'map':                           return this.config.map;\n    case 'mapCache':                      return this.config.mapCache;\n    case 'mapGPUCache':                   return this.config.mapGPUCache;\n    case 'mapMetatileCache':              return this.config.mapMetatileCache;\n    case 'mapTexelSizeFit':               return this.config.mapTexelSizeFit;\n    case 'mapDownloadThreads':            return this.config.mapDownloadThreads;\n    case 'mapMaxProcessingTime':          return this.config.mapMaxProcessingTime;\n    case 'mapMaxGeodataProcessingTime':   return this.config.mapMaxGeodataProcessingTime;\n    case 'mapMobileMode':                 return this.config.mapMobileMode;\n    case 'mapMobileModeAutodect':         return this.config.mapMobileModeAutodect;\n    case 'mapMobileDetailDegradation':    return this.config.mapMobileDetailDegradation;\n    case 'mapNavSamplesPerViewExtent':    return this.config.mapNavSamplesPerViewExtent;\n    case 'mapFog':                        return this.config.mapFog;\n    case 'mapFlatshade':                  return this.config.mapFlatshade;\n    case 'mapIgnoreNavtiles':             return this.config.mapIgnoreNavtiles;\n    case 'mapAllowHires':                 return this.config.mapAllowHires;\n    case 'mapAllowLowres':                return this.config.mapAllowLowres;\n    case 'mapAllowSmartSwitching':        return this.config.mapAllowSmartSwitching;\n    case 'mapDisableCulling':             return this.config.mapDisableCulling;\n    case 'mapPreciseCulling':             return this.config.mapPreciseCulling;\n    case 'mapHeightLodBlend':             return this.config.mapHeightLodBlend;\n    case 'mapHeightNodeBlend':            return this.config.mapHeightNodeBlend;\n    case 'mapBasicTileSequence':          return this.config.mapBasicTileSequence;\n    case 'mapSmartNodeParsing':           return this.config.mapSmartNodeParsing;\n    case 'mapStoreLoadStats':             return this.config.mapStoreLoadStats;\n    case 'mapXhrImageLoad':               return this.config.mapXhrImageLoad;\n    case 'mapLoadMode':                   return this.config.mapLoadMode;\n    case 'mapGeodataLoadMode':            return this.config.mapGeodataLoadMode;\n    case 'mapGridMode':                   return this.config.mapGridMode;\n    case 'mapGridSurrogatez':             return this.config.mapGridSurrogatez;\n    case 'mapGridUnderSurface':           return this.config.mapGridUnderSurface;\n    case 'mapGridTextureLevel':           return this.config.mapGridTextureLevel;\n    case 'mapGridTextureLayer':           return this.config.mapGridTextureLayer;\n    case 'mapPreciseBBoxTest':            return this.config.mapPreciseBBoxTest;\n    case 'mapPreciseDistanceTest':        return this.config.mapPreciseDistanceTest;\n    case 'mapHeightfiledWhenUnloaded':    return this.config.mapHeightfiledWhenUnloaded;\n    case 'mapForceMetatileV3':            return this.config.mapForceMetatileV3;\n    case 'mapVirtualSurfaces':            return this.config.mapVirtualSurfaces;\n    case 'mapDegradeHorizon':             return this.config.mapDegradeHorizon;\n    case 'mapDegradeHorizonParams':       return this.config.mapDegradeHorizonParams;\n    case 'mapRefreshCycles':              return this.config.mapRefreshCycles;\n    case 'mapDefaultFont':                return this.config.mapDefaultFont;\n    case 'mapMetricUnits':                return this.config.mapMetricUnits;\n    case 'mapLanguage':                   return this.config.mapLanguage;\n    case 'mapNoTextures':                 return this.config.mapNoTextures;\n    case 'mapForceFrameTime':             return this.config.mapForceFrameTime;\n    case 'mapForcePipeline':              return this.config.mapForcePipeline;\n    case 'mapFeatureGridCells':           return this.config.mapFeatureGridCells;\n    case 'mapFeaturesPerSquareInch':      return this.config.mapFeaturesPerSquareInch;\n    case 'mapFeaturesSortByTop':          return this.config.mapFeaturesSortByTop;\n    case 'mapFeaturesReduceMode':         return this.config.mapFeaturesReduceMode;\n    case 'mapFeaturesReduceParams':       return this.config.mapFeaturesReduceParams;\n    case 'mapLogGeodataStyles':           return this.config.mapLogGeodataStyles;\n    case 'map16bitMeshes':                return this.config.map16bitMeshes;\n    case 'mapOnlyOneUVs':                 return this.config.mapOnlyOneUVs;\n    case 'mapIndexBuffers':               return this.config.mapIndexBuffers;\n    case 'mapSoftViewSwitch':             return this.config.mapSoftViewSwitch;\n    case 'mapAsyncImageDecode':           return this.config.mapAsyncImageDecode;\n    case 'mapFeatureStickMode':           return this.config.mapFeatureStickMode;\n    case 'mapSeparateLoader':             return this.config.mapSeparateLoader;\n    case 'mapGeodataBinaryLoad':          return this.config.mapGeodataBinaryLoad;\n    case 'mapPackLoaderEvents':           return this.config.mapPackLoaderEvents;\n    case 'mapParseMeshInWorker':          return this.config.mapParseMeshInWorker;\n    case 'mapPackGeodataEvents':          return this.config.mapPackGeodataEvents;\n    case 'mapSortHysteresis':             return this.config.mapSortHysteresis;\n    case 'mapHysteresisWait':             return this.config.mapHysteresisWait;\n    case 'mapBenevolentMargins':          return this.config.mapBenevolentMargins;\n    case 'mapDMapSize':                   return this.config.mapDMapSize; \n    case 'mapDMapMode':                   return this.config.mapDMapMode;\n    case 'mario':                         return this.config.mario;\n    }\n};\n\n\nMap.prototype.click = function(screenX, screenY, state) {\n    this.clickEvent = [screenX, screenY, state];\n};\n\n\nMap.prototype.hover = function(screenX, screenY, persistent, state) {\n    this.hoverEvent = [screenX, screenY, persistent, state];\n};\n\n\nMap.prototype.markDirty = function() {\n    this.dirty = true;\n    this.hitMapDirty = true;\n    this.geoHitMapDirty = true;\n};\n\n\nMap.prototype.getScreenRay = function(screenX, screenY) {\n    return this.renderer.getScreenRay(screenX, screenY);\n};\n\n\nMap.prototype.renderToImage = function(texture) {\n    //var renderer = this.renderer;\n    var canvas = this.renderer.gpu.canvas;\n    var w = canvas.width;\n    var h = canvas.height;\n    var w2 = utils.fitToPowerOfTwo(w);\n    var h2 = utils.fitToPowerOfTwo(h);\n\n    var data = new Uint8Array( w2 * h2 * 4 );\n\n    var texture = new GpuTexture(this.renderer.gpu);\n    texture.createFromData(w2, h2, data);\n    texture.createFramebuffer(w2, h2);\n\n    this.draw.drawToTexture(texture);\n\n    data = texture.readFramebufferPixels(0, 0, w, h);\n\n    texture.kill();\n\n    //flip vertically\n    var data2 = new Uint8Array( w * h * 4 );\n    for (var y = 0; y < h; y++) {\n        var index = y * w * 4;\n        var index2 = (h - y - 1) * w * 4; \n\n        for (var x = 0; x < w; x++) {\n            data2[index2] = data[index];\n            data2[index2+1] = data[index+1];\n            data2[index2+2] = data[index+2];\n            data2[index2+3] = data[index+3];\n            index += 4;\n            index2 += 4;\n        }\n    }\n\n    return { 'width': w, 'height': h, 'data': data2};\n};\n\n\nMap.prototype.getScreenDepth = function(screenX, screenY, useFallback) {\n\n    if (useFallback) {\n\n        var cameraPos = this.camera.position;\n        var ray = this.renderer.getScreenRay(screenX, screenY), a, d;\n\n        if (this.getNavigationSrs().isProjected()) { //plane fallback\n            var planePos = [0,0,Math.min(-1000,this.referenceFrame.getGlobalHeightRange()[0])];\n            var planeNormal = [0,0,1];\n\n            d = vec3.dot(planeNormal, ray); //minification is wrong there\n            a = [planePos[0] - cameraPos[0], planePos[1] - cameraPos[1], planePos[2] - cameraPos[2]];\n            t = vec3.dot(a, planeNormal) / d;\n\n            if (t >= 0) {\n                return [true, t];\n            } else {\n                return [false, 1];\n            }\n\n        } else { //elipsoid fallback\n            var navigationSrsInfo = this.getNavigationSrs().getSrsInfo();\n            var planetRadius = navigationSrsInfo['b'] + this.referenceFrame.getGlobalHeightRange()[0];\n        \n            var offset = [cameraPos[0], cameraPos[1], cameraPos[2]];\n            a = vec3.dot(ray, ray); //minification is wrong there\n            var b = 2 * vec3.dot(ray, offset);\n            var c = vec3.dot(offset, offset) - planetRadius * planetRadius;\n            d = b * b - 4 * a * c;\n            \n            if (d > 0) {\n                d = Math.sqrt(d);\n                var t1 = (-b - d) / (2*a);\n                var t2 = (-b + d) / (2*a);\n                var t = (t1 < t2) ? t1 : t2;\n\n                return [true, t];\n            } else {\n                return [false, 1];\n            }\n        }\n\n    } else {\n\n        if (this.hitMapDirty) {\n            var tmp1 = this.draw.ndcToScreenPixel;\n\n            this.draw.drawHitmap();\n\n            this.draw.ndcToScreenPixel = tmp1;\n\n            var width = this.renderer.curSize[0], height = this.renderer.curSize[1];\n\n            var m = new Float32Array(16);\n            m[0] = 2.0/width; m[1] = 0; m[2] = 0; m[3] = 0;\n            m[4] = 0; m[5] = -2.0/height; m[6] = 0; m[7] = 0;\n            m[8] = 0; m[9] = 0; m[10] = 1; m[11] = 0;\n            m[12] = -width*0.5*m[0]; m[13] = -height*0.5*m[5]; m[14] = 0; m[15] = 1;\n\n            this.renderer.imageProjectionMatrix = m;\n            this.renderer.camera.update();\n        }\n\n        var res = this.renderer.getDepth(screenX, screenY);\n    }\n\n    return res;\n};\n\n\nMap.prototype.getHitCoords = function(screenX, screenY, mode, lod) {\n    if (this.hitMapDirty) {\n        this.draw.drawHitmap();\n    }\n\n    var cameraSpaceCoords = this.renderer.hitTest(screenX, screenY);\n    \n    var fallbackUsed = false; \n    var cameraPos = this.camera.position;\n    var worldPos;\n\n    var ray = cameraSpaceCoords[4], a, d;\n\n    if (this.getNavigationSrs().isProjected()) { //plane fallback\n        var planePos = [0,0,Math.min(-1000,this.referenceFrame.getGlobalHeightRange()[0])];\n        var planeNormal = [0,0,1];\n\n        d = vec3.dot(planeNormal, ray); //minification is wrong there\n        //if (d > 1e-6) {\n        a = [planePos[0] - cameraPos[0], planePos[1] - cameraPos[1], planePos[2] - cameraPos[2]];\n        t = vec3.dot(a, planeNormal) / d;\n            \n            //var t = (vec3.dot(cameraPos, planeNormal) + (-500)) / d;            \n        if (t >= 0) {\n            if (!cameraSpaceCoords[3] || t < cameraSpaceCoords[5]) {\n                worldPos = [ (ray[0] * t) + cameraPos[0],\n                    (ray[1] * t) + cameraPos[1],\n                    (ray[2] * t) + cameraPos[2] ];\n    \n                fallbackUsed = true;\n            }\n        }\n        //}\n\n    } else /*if (false)*/ { //elipsoid fallback\n        var navigationSrsInfo = this.getNavigationSrs().getSrsInfo();\n        var planetRadius = navigationSrsInfo['b'] + this.referenceFrame.getGlobalHeightRange()[0];\n    \n        var offset = [cameraPos[0], cameraPos[1], cameraPos[2]];\n        a = vec3.dot(ray, ray); //minification is wrong there\n        var b = 2 * vec3.dot(ray, offset);\n        var c = vec3.dot(offset, offset) - planetRadius * planetRadius;\n        d = b * b - 4 * a * c;\n        \n        if (d > 0) {\n            d = Math.sqrt(d);\n            var t1 = (-b - d) / (2*a);\n            var t2 = (-b + d) / (2*a);\n            var t = (t1 < t2) ? t1 : t2;\n\n            //console.log(\"hit: \" + t + \",   \" + cameraSpaceCoords[5]);\n            \n            if (!cameraSpaceCoords[3] || t < cameraSpaceCoords[5]) {\n                worldPos = [ (ray[0] * t) + cameraPos[0],\n                    (ray[1] * t) + cameraPos[1],\n                    (ray[2] * t) + cameraPos[2] ];\n\n                fallbackUsed = true;\n            }\n        }   \n    }\n    \n    if (!cameraSpaceCoords[3] && !fallbackUsed) {\n        return null;\n    }\n    \n    if (!fallbackUsed) {\n        worldPos = [ cameraSpaceCoords[0] + cameraPos[0],\n            cameraSpaceCoords[1] + cameraPos[1],\n            cameraSpaceCoords[2] + cameraPos[2] ];\n    }\n\n    var navCoords = this.convert.convertCoords(worldPos, 'physical', 'navigation');\n\n    if (this.renderer.useSuperElevation) {\n        navCoords[2] = this.renderer.getUnsuperElevatedHeight(navCoords[2]);\n    }\n\n    if (mode == 'float') {\n        lod =  (lod != null) ? lod : this.measure.getOptimalHeightLod(navCoords, 100, this.config.mapNavSamplesPerViewExtent);\n        var surfaceHeight = this.measure.getSurfaceHeight(navCoords, lod);\n        navCoords[2] -= surfaceHeight[0]; \n    }\n\n    return navCoords;\n};\n\n\nMap.prototype.hitTestGeoLayers = function(screenX, screenY, mode) {\n    if (this.geoHitMapDirty) {\n        if (this.freeLayersHaveGeodata) {\n            this.draw.drawGeodataHitmap();\n        }\n    }\n\n    if (!this.freeLayersHaveGeodata) {\n        this.lastHoverFeature = null;\n        this.lastHoverFeatureId = null;\n        this.hoverFeature = null;\n        this.hoverFeatureId = null;\n\n        return [null, false, []];\n    }\n\n    var res = this.renderer.hitTestGeoLayers(screenX, screenY);\n    var relatedEvents, elementIndex;\n\n    if (res[0]) { //do we hit something?\n        //console.log(JSON.stringify([id, JSON.stringify(this.hoverFeatureList[id])]));\n       \n        var id = (res[1]) + (res[2]<<8);\n\t\t\n        var feature = this.hoverFeatureList[id];\n\n        if (!feature) {\n            return [null, false, [], elementIndex];\n        }\n\n        if (feature[6]) { //advanced hit feature?\n            res = this.renderer.hitTestGeoLayers(screenX, screenY, true);\n        \n            if (res[0]) { //do we hit something?\n                elementIndex = (res[1]) + (res[2]<<8);\n            }\n        }\n\n        if (mode == 'hover') {\n            this.lastHoverFeature = this.hoverFeature;\n            this.lastHoverFeatureId = this.hoverFeatureId;\n            \n            if (feature && feature[3]) {\n                this.hoverFeature = feature;\n                this.hoverFeatureId = (feature != null) ? feature[0]['#id'] : null;\n            } else {\n                this.hoverFeature = null;\n                this.hoverFeatureId = null;\n            }\n\n            relatedEvents = [];\n\n            if (this.hoverFeatureId != this.lastHoverFeatureId) {\n                if (this.lastHoverFeatureId != null) {\n                    relatedEvents.push(['leave', this.lastHoverFeature, this.lastHoverFeatureId]);\n                }\n\n                if (this.hoverFeatureId != null) {\n                    relatedEvents.push(['enter', this.hoverFeature, this.hoverFeatureId]);\n                }\n\n                this.dirty = true;\n            }\n\n            if (this.hoverFeature != null && this.hoverFeature[3]) {\n                return [this.hoverFeature, true, relatedEvents, elementIndex];\n            } else {\n                return [null, false, relatedEvents, elementIndex];\n            }\n        }\n\n        if (mode == 'click') {\n            if (feature != null && feature[2]) {\n                return [feature, true, [], elementIndex];\n            } else {\n                return [null, false, [], elementIndex];\n            }\n        }\n    } else {\n        relatedEvents = [];\n\n        if (mode == 'hover') {\n            this.lastHoverFeature = this.hoverFeature;\n            this.lastHoverFeatureId = this.hoverFeatureId;\n            this.hoverFeature = null;\n            this.hoverFeatureId = null;\n\n            if (this.lastHoverFeatureId != null) {\n                if (this.lastHoverFeatureId != null) {\n                    relatedEvents.push(['leave', this.lastHoverFeature, this.lastHoverFeatureId]);\n                }\n\n                this.dirty = true;\n            }\n        }\n\n        return [null, false, relatedEvents, elementIndex];\n    }\n};\n\nMap.prototype.getCurrentGeometry = function() {\n    if (this.draw.tree.surfaceSequence.length > 0) {\n        this.draw.tree.draw(true);\n        var res = this.storedTilesRes;\n        this.storedTilesRes = [];\n        return res;\n    }\n\n    return res;\n};\n\nMap.prototype.applyCredits = function(tile) {\n    var value, value2;\n    for (var key in tile.imageryCredits) {\n        value = tile.imageryCredits[key];\n        value2 = this.visibleCredits.imagery[key];\n\n        if (value2) {\n            this.visibleCredits.imagery[key] = value > value2 ? value : value2;\n        } else {\n            this.visibleCredits.imagery[key] = value;\n        }\n    }\n    for (key in tile.glueImageryCredits) {\n        value = tile.glueImageryCredits[key];\n        value2 = this.visibleCredits.imagery[key];\n\n        if (value2) {\n            this.visibleCredits.glueImagery[key] = value > value2 ? value : value2;\n        } else {\n            this.visibleCredits.glueImagery[key] = value;\n        }\n    }\n    for (key in tile.mapdataCredits) {\n        value = tile.mapdataCredits[key];\n        value2 = this.visibleCredits.mapdata[key];\n\n        if (value2) {\n            this.visibleCredits.mapdata[key] = value > value2 ? value : value2;\n        } else {\n            this.visibleCredits.mapdata[key] = value;\n        }\n    }\n    \n    /*if (this.drawBBoxes) {\n        console.log(JSON.stringify(tile.id) + \" \" + JSON.stringify(this.visibleCredits));\n    }*/\n};\n\n\nMap.prototype.drawMap = function() {\n    this.draw.drawMap(null);\n};\n\n\nMap.prototype.processProcessingTasks = function() {\n    while (this.processingTasks.length > 0) {\n        if (this.stats.renderBuild > this.config.mapMaxProcessingTime) {\n            this.markDirty();\n            return;\n        }\n\n        this.processingTasks[0]();\n        this.processingTasks.shift();\n    }\n\n    while (this.processingTasks2.length > 0) {\n        if (this.processingTasks2[0]() != -123) {\n            this.processingTasks2.shift();\n        } else {\n            break;\n        }\n    }\n\n};\n\n\nMap.prototype.addProcessingTask = function(task) {\n    this.processingTasks.push(task);\n};\n\nMap.prototype.addProcessingTask2 = function(task) {\n    this.processingTasks2.push(task);\n};\n\n/*\nMap.prototype.updateGeodataProcessors = function(task) {\n    var processors = this.map.geodataProcessors;\n    for (var i = 0, li = processors.length; i < li; i++) {\n        var processor = processors[i];\n\n        if (!processor.ready && processor.processing) {\n            processor.\n        }\n    }\n};*/\n\n\nMap.prototype.update = function() {\n    if (this.killed) {\n        return;\n    }\n\n    if (this.core.tokenExpiration) {\n        if (Date.now() > (this.core.tokenExpiration - (1000*60))) {\n            this.core.tokenExpirationCallback();\n        }\n    }\n\n    if (!this.srsReady) {\n        this.loader.update();\n        return;\n    }\n\n    if (this.div && this.div.style.visibility == 'hidden'){\n        //loop heartbeat\n        //window.requestAnimFrame(this.update.bind(this));\n        return;\n    }\n\n    if (!this.position.isSame(this.lastPosition)) {\n        this.core.callListener('map-position-changed', {'position':this.position.toArray(), 'last-position':this.lastPosition.toArray()});\n    }\n\n    if (this.camera.lastTerrainHeight != this.camera.terrainHeight) {\n        this.core.callListener('map-position-fixed-height-changed', {'height':this.camera.terrainHeight, 'last-height':this.camera.lastTerrainHeight});\n    }\n\n    this.lastPosition = this.position.clone();\n    this.camera.lastTerrainHeight = this.camera.terrainHeight;\n    this.drawFog = this.config.mapFog;\n\n    var rect = this.renderer.div.getBoundingClientRect();\n    var renderer = this.renderer, p;\n    var camPos = renderer.cameraPosition;\n\n    if (renderer.curSize[0] != rect.width || renderer.curSize[1] != rect.height) {\n        renderer.onResize();\n        this.dirty = true;\n    }\n\n    var dirty = (this.dirty || this.dirtyCountdown > 0), result;\n    this.stats.begin(dirty);\n\n    this.loader.update();\n\n    //this.updateGeodataProcessors();\n\n    this.processProcessingTasks();\n\n    if (dirty) {\n        if (this.dirty) {\n            this.dirtyCountdown = this.config.mapRefreshCycles;\n        } else {\n            this.dirtyCountdown--;\n        }\n\n        this.dirty = false;\n        this.bestMeshTexelSize = 0;//Number.MAX_VALUE;\n        this.bestGeodataTexelSize = 0;//Number.MAX_VALUE;\n        \n        this.renderSlots.processRenderSlots();\n\n        this.loader.update();\n        \n        this.core.callListener('map-update', {});\n\n        //this.renderer.gpu.setState(this.drawTileState);\n        //this.renderer.gpu.gl.disable(this.renderer.gpu.gl.BLEND);\n        //this.renderer.drawImage(300, 0, 256, 256, this.renderer.hitmapTexture, null, null, null, null, false);\n        //this.renderer.drawImage(558, 0, 256, 256, this.renderer.hitmapTexture, null, null, null, null, false);\n\n        //console.log(\"\" + this.stats.gpuRenderUsed);\n    }\n\n    //hover and click events\n    if (this.clickEvent != null || this.hoverEvent != null) {\n        //this.updateGeoHitmap = this.dirty;\n\n        if (this.hoverEvent != null) {\n            result = this.hitTestGeoLayers(this.hoverEvent[0], this.hoverEvent[1], 'hover');\n\n            var relatedEvents = result[2];\n\n            if (relatedEvents != null) {\n                for(var i = 0, li = relatedEvents.length; i < li; i++) {\n                    var event = relatedEvents[i];\n\n                    switch(event[0]) {\n                    case 'enter':\n                        p = event[1][1];\n                        this.core.callListener('geo-feature-enter', {'feature': event[1][0], 'canvas-coords':renderer.project2(event[1][1], renderer.camera.mvp, camPos),\n                            'physical-coords':[p[0] + camPos[0], p[1] + camPos[1], p[2] + camPos[2]], 'state': this.hoverEvent[3], 'element': result[3] });\n                        break;\n\n                    case 'leave':\n                        p = event[1][1];\n                        this.core.callListener('geo-feature-leave', {'feature':event[1][0], 'canvas-coords':renderer.project2(event[1][1], renderer.camera.mvp, camPos),\n                            'physical-coords':[p[0] + camPos[0], p[1] + camPos[1], p[2] + camPos[2]], 'state': this.hoverEvent[3], 'element': result[3] });\n                        break;\n                    }\n                }\n            }\n\n            if (result[1] && result[0] != null) {\n                p = result[0][1];\n                this.core.callListener('geo-feature-hover', {'feature': result[0][0], 'canvas-coords':renderer.project2(result[0][1], renderer.camera.mvp, camPos),\n                    'physical-coords':[p[0] + camPos[0], p[1] + camPos[1], p[2] + camPos[2]], 'state': this.hoverEvent[3], 'element': result[3]});\n            }\n\n            //is it persistent event?\n            if (this.hoverEvent[2] !== true) {\n                this.hoverEvent = null;\n            }\n        }\n\n        if (this.clickEvent != null) {\n            result = this.hitTestGeoLayers(this.clickEvent[0], this.clickEvent[1], 'click');\n\n            if (result[1] && result[0] != null) {\n                p = result[0][1];\n                this.core.callListener('geo-feature-click', {'feature': result[0][0], 'canvas-coords':renderer.project2(result[0][1], renderer.camera.mvp, camPos),\n                    'physical-coords':[p[0] + camPos[0], p[1] + camPos[1], p[2] + camPos[2]], 'state': this.clickEvent[2], 'element': result[3] });\n            }\n\n            this.clickEvent = null;\n        }\n\n    }\n\n\n    this.stats.end(dirty);\n};\n\nexport default Map;\n","\n\nvar InspectorInput = function(inspector) {\n    this.inspector = inspector;\n    this.core = inspector.core;\n};\n\n\nInspectorInput.prototype.init = function() {\n    //mouse events\n    //document.addEventListener(\"click\", this.onKeyClick.bind(this), false);\n\n    //keyboard events\n    document.addEventListener('keyup', this.onKeyUp.bind(this), false);\n    document.addEventListener('keypress', this.onKeyPress.bind(this), false);\n    document.addEventListener('keydown', this.onKeyDown.bind(this), false);\n};\n\n\n//keyboard events\nInspectorInput.prototype.onKeyDown = function(event) {\n    if (typeof event == 'undefined') {\n        event = window.event;\n    }\n\n    this.altDown = event.altKey;\n    this.ctrlDown = event.ctrlKey;\n    this.shiftDown = event.shiftKey;\n\n    this.onKeyUp(event, true);\n};\n\n\nInspectorInput.prototype.onKeyPress = function(event) {\n    this.onKeyUp(event, true);\n};\n\n\nInspectorInput.prototype.onKeyUp = function(event, press) {\n    if (typeof event == 'undefined') {\n        event = window.event;\n    }\n\n    var map = this.core.getMap();\n    var inspector = this.inspector;\n\n    if (!map) {\n        return;\n    }\n\n    var debug = map.draw.debug;\n\n    this.altDown = event.altKey;\n    this.ctrlDown = event.ctrlKey;\n    this.shiftDown = event.shiftKey;\n\n    var hit = false;\n    var blockHit = true;\n\n    if (event) {\n        var keyCode;\n\n        if (window.event) {         // eg. IE\n            keyCode = window.event.keyCode;\n        } else if (event.which) {   // eg. Firefox\n            keyCode = event.which;\n        } else {\n            keyCode = event.charCode;\n        }\n\n        if (this.shiftDown) {\n            if (this.ctrlDown) {\n                switch(keyCode) {\n                case 68:\n                case 100:\n                    inspector.preventDefault(event); break;  //key D pressed\n                }\n            }\n        }\n\n        if (this.shiftDown && press !== true) {\n\n            switch(keyCode) {\n            case 76:\n            case 108:\n                /*this.showMenu(); this.toolbarItemSelected('link'); done();*/  break;  //key L pressed\n\n            case 71:\n            case 103:\n                /*this.showMenu(); this.toolbarItemSelected('position'); done();*/ break; //key G pressed\n            }\n\n            if (this.ctrlDown) {\n\n                switch(keyCode) {\n                case 68:\n                case 100:\n                    \n                    inspector.enableInspector();\n                    this.diagnosticMode = true; hit = true; break;  //key D pressed\n                }\n            }\n\n            if (this.diagnosticMode) {\n                blockHit = true;\n\n                switch(keyCode) {\n\n                case 67:\n                case 99:\n                        inspector.shakeCamera = !inspector.shakeCamera;\n\n                        //map.config.mapDegradeHorizon = !map.config.mapDegradeHorizon;\n                        //this.measureMode = !this.measureMode;\n                        //this.measurePoints = [];\n                        //var pos = this.core.hitTest(this.mouseX, this.mouseY, \"all\");\n                        //console.log(\"hit pos: \" + pos[0] + \" \" + pos[1] + \" \" + pos[2] + \" \" + pos[3] + \" d \" + pos[4]); //key T pressed\n\n                    break; //key C pressed\n\n                case 49: /*this.core.setControlMode(\"manual\"); done();*/  break;  //key 1 pressed\n                case 50: /*this.core.setControlMode(\"drone\"); done();*/   break;  //key 2 pressed\n                case 51: /*this.core.setControlMode(\"observer\"); done();*/ break; //key 3 pressed\n\n                case 48:  //key 0 pressed\n                        /*this.core.setOption(\"noForwardMovement\" , !this.core.getOption(\"noForwardMovement\"));*/\n                    break;\n\n                    //case 84: //key T pressed\n                    //case 116:\n                        /*var pos = this.core.hitTest(this.mouseX, this.mouseY, \"all\");\n                        console.log(\"hit pos: \" + pos[0] + \" \" + pos[1] + \" \" + pos[2] + \" \" + pos[3] + \" d \" + pos[4]); //key T pressed\n                        this.core.logTile(pos);*/\n                        //break;\n\n                case 72:\n                case 104:\n                    debug.heightmapOnly = !debug.heightmapOnly;\n\n                        /*\n                        var pos = map.getPosition();\n                        pos.setHeight(pos.setHeight() * 0.9);\n                        map.setPosition(pos);*/\n\n                    break;  //key H pressed\n\n                case 81:\n                case 113:\n                    var pos = map.getPosition();\n                    // eslint-disable-next-line\n                    console.log('pos-before: ' + JSON.stringify(pos.pos));\n                    map.convert.convertPositionViewMode(pos, (pos.getViewMode() == 'obj') ? 'subj' : 'obj');\n                    // eslint-disable-next-line\n                    console.log('new mode: ' + pos.getViewMode());\n                    // eslint-disable-next-line\n                    console.log('pos-after: ' + JSON.stringify(pos.pos));\n                    map.setPosition(pos);\n                    /*this.core.saveScreenshot(pos);*/\n\n                    if (this.altDown && pos.getViewMode() != 'obj') {\n                        map.camera.near = 0.1;\n                    } else {\n                        map.camera.near = 2;\n                    }\n\n                    inspector.preventDefault(event);\n\n                    break;  //key Q pressed\n\n                case 80:\n                case 112:\n                    map.renderer.saveScreenshot('file', 'vts-screenshot.png', 'png'); break;  //key P pressed\n\n                case 83:\n                case 115:\n                    inspector.stats.switchPanel(); break; //key S pressed\n\n                case 86:\n                case 118:\n                    inspector.layers.switchPanel(); break; //key V pressed\n\n                case 69:\n                case 101:\n                    inspector.stylesheets.switchPanel(); break; //key E pressed\n\n                case 84:\n                case 116:\n                    inspector.replay.switchPanel(); break; //key T pressed\n\n                case 66:\n                case 98:\n                    debug.drawBBoxes = !debug.drawBBoxes; break; //key B pressed\n\n                case 65:\n                case 97:\n                    debug.drawLabelBoxes = !debug.drawLabelBoxes; break; //key A pressed\n\n                case 75:\n                case 107:\n                   debug.drawAllLabels = !debug.drawAllLabels; break; //key K pressed\n\n                case 73:\n                case 105:\n                    debug.drawHiddenLabels = !debug.drawHiddenLabels; break; //key I pressed\n                    //debug.drawGridCells = !debug.drawGridCells; break; //key I pressed\n\n                case 87:\n                case 119:\n                    \n                    if (debug.drawWireframe == 3) {\n                        debug.drawWireframe = 1;\n                    } else {\n                        var value = debug.drawWireframe + 1;\n                        debug.drawWireframe = value > 2 ? 0 : value;\n                    }\n                    break; //key W pressed\n\n                case 70:\n                case 102:\n                    debug.drawWireframe = debug.drawWireframe != 3 ? 3 : 0;\n                    break; //key F pressed\n\n                case 85:\n                case 117:\n                    map.renderer.setSuperElevationState(!map.renderer.useSuperElevation);\n                    break; //key U pressed\n\n                case 71:\n                case 103:\n                    debug.meshStats = !debug.meshStats; hit = true;\n                    break; //key G pressed\n\n                case 77:\n                case 109:\n                    map.loaderSuspended = !map.loaderSuspended;            \n                    // eslint-disable-next-line\n                    console.log('loader state ' + map.loaderSuspended);\n\n                    break; //key M pressed\n\n                case 74:\n                case 106:\n                    debug.drawEarth = !debug.drawEarth; hit = true; break; //key J pressed\n\n                case 88:\n                case 120:\n                    debug.drawFog = !debug.drawFog; hit = true; break; //key X pressed\n\n                case 89:\n                case 120:\n                    map.config.mapSplitLods = !map.config.mapSplitLods; hit = true; break; //key Y pressed\n\n                case 82:\n                case 114:\n                    inspector.graphs.switchPanel(); break; //key R pressed\n\n                case 79:\n                case 111:\n                    map.camera.camera.setOrtho(!map.camera.camera.getOrtho()); break; //key O pressed\n\n                case 76:\n                case 108:\n                    inspector.drawRadar = !inspector.drawRadar; break; //key L pressed\n\n                case 90:\n                case 122:\n                    debug.maxZoom = !debug.maxZoom; break; //key Z pressed\n\n                case 78:\n                case 110:\n                    debug.drawNBBoxes = !debug.drawNBBoxes; break; //key N pressed\n\n                default:\n                    blockHit = false;\n                    break;\n\n                }\n\n                if (blockHit) {\n                    hit = true;\n                }\n            }\n        }\n\n        if (this.diagnosticMode && debug.drawWireframe && !press) {\n            if (keyCode >= 96 && keyCode <= 105) {\n                if (this.altDown) {\n                    debug.drawTestData = keyCode - 96;\n                    if (this.ctrlDown) {\n                        debug.drawTestData += 10;\n                    }\n                } else {\n                    debug.drawTestMode = keyCode - 96;\n                }\n\n                hit = true;\n            } \n        }\n\n        if (this.diagnosticMode && inspector.drawRadar && !this.shiftDown && !press) {\n            blockHit = true;\n\n            switch(keyCode) {\n            case 43:\n            case 107:\n                if (inspector.radarLod == null) { inspector.radarLod = 8;}\n                inspector.radarLod++; /*console.log(\"radarLOD: \" + this.radarLod);*/ break; //key mun + pressed\n\n            case 45:\n            case 109:\n                if (inspector.radarLod == null) { inspector.radarLod = 8;}\n                inspector.radarLod = Math.max(0,inspector.radarLod-1); /*console.log(\"radarLOD: \" + this.radarLod);*/ break; //key mun - pressed\n\n            case 42:\n            case 106:\n                inspector.radarLod = null; /*console.log(\"radarLOD: auto\");*/ break; //key mun * pressed\n\n            default:\n                blockHit = false;\n                break;\n            }\n\n            if (blockHit) {\n                hit = true;\n            }\n        }\n\n        if (this.diagnosticMode && (debug.drawBBoxes || debug.drawNBBoxes) && !this.shiftDown && !press) {\n            blockHit = true;\n\n            switch(keyCode) {\n            case 76:\n            case 108:\n                debug.drawLods = !debug.drawLods; break; //key L pressed\n\n            case 80:\n            case 112:\n                debug.drawPositions = !debug.drawPositions; break; //key P pressed\n\n            case 84:\n            case 116:\n                debug.drawTextureSize = !debug.drawTextureSize; break; //key T pressed\n\n            case 70:\n            case 102:\n                debug.drawFaceCount = !debug.drawFaceCount; break; //key F pressed\n\n            case 71:\n            case 103:\n                debug.drawGeodataOnly = !debug.drawGeodataOnly; break; //key G pressed\n\n            case 68:\n            case 100:\n                debug.drawDistance = !debug.drawDistance; break; //key D pressed\n\n            case 86:\n            case 118:\n                debug.drawSpaceBBox = !debug.drawSpaceBBox; break; //key V pressed\n\n            case 78:\n            case 110:\n                debug.drawNodeInfo = !debug.drawNodeInfo; break; //key N pressed\n\n            case 77:\n            case 109:\n                debug.drawMeshBBox = !debug.drawMeshBBox; break; //key M pressed\n\n            case 73:\n            case 105:\n                debug.drawIndices = !debug.drawIndices; break; //key I pressed\n\n            case 66:\n            case 98:\n                debug.drawBoundLayers = !debug.drawBoundLayers; break; //key B pressed\n\n            case 82:\n            case 114:\n                debug.drawResources = !debug.drawResources; break; //key R pressed\n\n            case 83:\n            case 115:\n                debug.drawSurfaces = !debug.drawSurfaces; break; //key S pressed\n\n            case 90:\n            case 122:\n                debug.drawSurfaces2 = !debug.drawSurfaces2; break; //key Z pressed\n\n            case 67:\n            case 99:\n                debug.drawCredits = !debug.drawCredits; break; //key C pressed\n\n            case 79:\n            case 111:\n                debug.drawOrder = !debug.drawOrder; break; //key O pressed\n\n            case 69:\n            case 101:\n                debug.debugTextSize = (debug.debugTextSize == 2.0) ? 3.0 : 2.0; break; //key E pressed\n\n            case 88:\n            case 120:\n                map.config.mapPreciseBBoxTest = !map.config.mapPreciseBBoxTest; break; //key X pressed\n\n            case 87:\n            case 119:\n                debug.drawPolyWires = !debug.drawPolyWires; break; //key W pressed\n\n            case 90:\n            case 122:\n                map.config.mapPreciseDistanceTest = !map.config.mapPreciseDistanceTest; break; //key Z pressed\n\n            case 75:\n            case 107:\n                debug.drawGPixelSize = !debug.drawGPixelSize; break; //key K pressed\n\n            default:\n                blockHit = false;\n                break;\n            }\n\n            if (blockHit) {\n                hit = true;\n            }\n        }\n\n    }\n\n    if (hit) {\n        map.markDirty();\n        inspector.preventDefault(event);\n    }\n\n    //console.log(\"key\" + keyCode);\n};\n\n\nInspectorInput.prototype.setParameter = function(key, value) {\n    var map = this.core.getMap();\n    var inspector = this.inspector;\n\n    if (!map) {\n        return;\n    }\n\n    var debug = map.draw.debug;\n    var getBool = (function(a){ return (value === true || value == 'true' || value == '1') });\n\n    switch(key) {\n        case 'debugMode': this.diagnosticMode = true; break;\n        case 'debugBBox':\n            debug.drawBBoxes = true;\n        case 'debugNBBox':\n            if (key == 'debugNBBox') debug.drawNBBoxes = true;\n            var has = (function(a){ return (value.indexOf(a)!=-1); });\n            if (has('L')) debug.drawLods = true;\n            if (has('P')) debug.drawPositions = true;\n            if (has('T')) debug.drawTextureSize = true;\n            if (has('F')) debug.drawFaceCount = true;\n            if (has('G')) debug.drawGeodataOnly = true;\n            if (has('D')) debug.drawDistance = true;\n            if (has('N')) debug.drawNodeInfo = true;\n            if (has('V')) debug.drawSpaceBBox = true;\n            if (has('M')) debug.drawMeshBBox = true;\n            if (has('I')) debug.drawIndices = true;\n            if (has('B')) debug.drawBoundLayers = true;\n            if (has('S')) debug.drawSurfaces = true;\n            if (has('Z')) debug.drawSurfaces2 = true;\n            if (has('C')) debug.drawCredits = true;\n            if (has('O')) debug.drawOrder = true;\n            if (has('E')) debug.debugTextSize = 3.0;\n            if (has('K')) debug.drawGPixelSize = true;\n            break;\n        case 'debugLBox': debug.drawLabelBoxes = getBool(value); break;\n        case 'debugNoEarth': debug.drawEarth = !getBool(value); break;\n        case 'debugShader': debug.drawWireframe = parseInt(value); break;\n        case 'debugHeightmap': debug.heightmapOnly = getBool(value); break;\n        case 'debugGridCells': debug.drawGridCells = getBool(value); break;\n        case 'debugRadar':\n            inspector.enableInspector();\n            inspector.drawRadar = true;\n            inspector.radarLod = parseInt(value);\n            if (isNaN(inspector.radarLod)) {\n                inspector.radarLod = null;\n            } \n            break;\n\n    }\n\n    map.markDirty();\n};\n\nexport default InspectorInput;\n\n","\n\nimport {getCoreVersion} from '../core';\n\n\nvar InspectorStats = function(inspector) {\n    this.inspector = inspector;\n    this.core = inspector.core;\n};\n\n\nInspectorStats.prototype.init = function() {\n    var inspector = this.inspector;\n    inspector.addStyle(\n        '#vts-stats-panel {'\n            + 'font-family: Arial, \"Helvetica Neue\", Helvetica, sans-serif;'\n            + 'display: none;'\n            + 'padding:15px;'\n            + 'width: 305px;'\n            + 'font-size: 14px;'\n            + 'position: absolute;'\n            + 'right: 10px;'\n            + 'top: 10px;'\n            + 'cursor: default;'\n            + 'background-color: rgba(255,255,255,0.95);'\n            + 'border-radius: 5px;'\n            + 'border: solid 1px #ccc;'\n            + 'text-align: left;'\n            + 'z-index: 7;'\n            + 'padding: 10px;'\n        + '}'\n\n        + '#vts-stats-panel-info {'\n            + 'margin-top: 5px;'\n            + 'margin-bottom: 3px;'\n            + 'overflow: hidden;'\n        + '}'\n\n        + '#vts-stats-panel-info table {'\n            + 'color:#000000;'\n            + 'text-align: left;'\n            + 'font-size: 12px;'\n        + '}'\n\n        + '#vts-stats-panel-info table td {'\n            + 'vertical-align: top;'\n        + '}'\n\n        + '#vts-stats-panel-pos {'\n            + 'width: 100%;'\n        + '}'\n    );\n\n    this.element = document.createElement('div');\n    this.element.id = 'vts-stats-panel';\n    this.element.innerHTML =\n        '<span id=\"vts-stats-panel-title\">Render statistics &nbsp;&nbsp;&nbsp;v' + getCoreVersion() + '</h3>'+\n        '<p id=\"vts-stats-panel-info\"></p>'+\n        '<input id=\"vts-stats-panel-pos\" type=\"text\">';\n\n    this.core.element.appendChild(this.element);\n    this.infoElement = document.getElementById('vts-stats-panel-info');\n    this.posElement = document.getElementById('vts-stats-panel-pos');\n\n    this.element.addEventListener('mouseup', inspector.doNothing.bind(this), true);\n    this.element.addEventListener('mousedown', inspector.doNothing.bind(this), true);\n    this.element.addEventListener('mousewheel', inspector.doNothing.bind(this), false);\n    this.element.addEventListener('dblclick', inspector.doNothing.bind(this), false);\n\n    this.panelVisible = false;\n};\n\n\nInspectorStats.prototype.showPanel = function() {\n    this.element.style.display = 'block';\n    this.panelVisible = true;\n};\n\n\nInspectorStats.prototype.hidePanel = function() {\n    this.element.style.display = 'none';\n    this.panelVisible = false;\n};\n\n\nInspectorStats.prototype.switchPanel = function() {\n    if (this.panelVisible) {\n        this.hidePanel();\n    } else {\n        this.showPanel();\n    }\n};\n\n\nInspectorStats.prototype.updateStatsPanel = function(stats) {\n    if (!this.infoElement || !this.panelVisible) {\n        return;\n    }\n    var inspector = this.inspector;\n    \n    var text2 =\n            'FPS: ' + Math.round(stats.fps) + '<br/>' +\n            'Render time: ' + Math.round(stats.renderTime*1000) + '<br/>' +\n            ' - resources: ' + Math.round(stats.gpuRenderUsed/(1024*1024)) + 'MB<br/>' +\n            ' - topdown: ' + Math.round(stats.gpuNeeded/(1024*1024)) + 'MB<br/>' +\n            //\" - resources: \" + (stats.gpuRenderUsed) + \" --- \" + (stats.gpuRenderUsed / stats.drawnTiles) + \"<br/>\" +\n            'GPU Cache: ' + Math.round(stats.gpuUsed/(1024*1024)) + 'MB<br/>' +\n            ' - textures: ' + Math.round(stats.gpuTextures/(1024*1024)) + 'MB<br/>' +\n            ' - meshes: ' + Math.round(stats.gpuMeshes/(1024*1024)) + 'MB<br/>' +\n            ' - geodata: ' + Math.round(stats.gpuGeodata/(1024*1024)) + 'MB<br/>' +\n            'CPU Cache: ' + Math.round(stats.resourcesUsed/(1024*1024)) + 'MB<br/>' +\n            'Metaile Cache: ' + Math.round(stats.metaUsed/(1024*1024)) + 'MB<br/>' +\n//            \"FOV: \" + Math.round(this.core.getOption(\"fov\")) + \" deg<br/>\" +\n//            \"viewHeight: \" + Math.round(this.core.getOption(\"viewHeight\")) + \" m<br/>\" +\n//            \"distance: \" + Math.round(this.core.renderer.cameraDistance) + \" m<br/>\" +\n            'Draw calls: ' + (stats.drawCalls) + '<br/>' +\n            'Polygons: ' + (stats.drawnFaces) + '<br/><br/>' +\n            'Terrain Height: ' + (stats.heightTerrain.toFixed(2)) + '<br/>' +\n            '- float: ' + (stats.heightDelta.toFixed(2)) + '<br/>' +\n            '- desired lod: ' + (stats.heightLod.toFixed(2)) + '<br/>' +\n            '- used lod: ' + (stats.heightNode.toFixed(2)) + '<br/>' +\n            '- used source: ' + ((stats.heightClass == 2 ? 'navtile' : stats.heightClass == 1 ? 'node': '---') ) + '<br/>' +\n            'Terrain Radar Lod: ' + (inspector.radarLod) + '<br/><br/>' + \n            'Loaded/Errors: ' + (stats.loadedCount) + ' / ' + (stats.loadErrorCount) + '<br/>' +\n            'Load time: ' + ((stats.loadLast - stats.loadFirst)*0.001).toFixed(2) + 's <br/>';\n\n    var renderer = this.core.renderer;\n\n    if (renderer) {\n        text2 += '<br/>Render jobs: ' + renderer.totalJobs + '<br/>' +\n                 'Drawn jobs: ' + renderer.drawnJobs + '<br/>' +\n                 'Jobs total time: ' +  Math.round((renderer.jobsTimer2 - renderer.jobsTimer1)*1000) + '<br/>' +\n                 'Jobs reduce time: ' + Math.round((renderer.jobsTimer4)*1000) + '<br/>';\n    }\n\n    if (stats.debugStr) {\n        text2 += stats.debugStr + '<br/>';        \n    }\n\n    var text3 =  'PixelRatio: ' + (window.devicePixelRatio || 1).toFixed(3) +'<br/>'+\n                 'BFRate: ' + Math.round(1000 / (stats.frameTime+0.00001)) +'<br/><br/>';\n\n    var map = this.core.getMap();\n\n    if (map) {\n        text3 += 'ReduceMode: ' +'<br/>'+ map.config.mapFeaturesReduceMode +'<br/>'+\n                 'ReduceParams: ' +'<br/>'+ JSON.stringify(map.config.mapFeaturesReduceParams) +'<br/><br/>';\n\n        if (map.draw.debug.meshStats) {\n            text3 += 'TexelsPerPoly: ' + (stats.meshesUVArea / Math.max(1,stats.meshesFaces)).toFixed(2) +'<br/><br/>';\n        }\n    }\n\n    text3 += 'Metatiles: ' + (stats.processedMetatiles) +'<br/>'+\n             'Metanodes: ' + (stats.processedNodes) + ' / ' + (stats.usedNodes) + '<br/>'+\n             'GeodataTiles: ' + (stats.drawnGeodataTiles) + '<br/><br/>';\n\n    if (renderer) {\n        text3 += 'Nodes: ' + (renderer.drawnNodes) +'<br/><br/>';\n    }\n\n    text3 += 'Tiles: ' + (stats.drawnTiles) +'<br/>';\n\n    for (var i =0, li = stats.renderedLods.length; i < li; i++) {\n        if (stats.renderedLods[i]) {\n            text3 += 'LOD ' + i + ': ' + (stats.renderedLods[i]) +'<br/>';\n        }\n    }\n\n\n    var text = '<table style=\"width:305px\"><tr><td>' + text2 + '</td><td>' + text3 + '</td></tr></table>';\n\n    this.infoElement.innerHTML = text;\n\n    if (map) {\n        var p = map.getPosition();\n        var s = '';\n        s += p.getViewMode() + ',';\n        var c = p.getCoords();\n        s += c[0] + ',' + c[1] + ',' + p.getHeightMode() + ',' + c[2].toFixed(2) + ',';\n        var o = p.getOrientation();\n        s += o[0].toFixed(2) + ',' + o[1].toFixed(2) + ',' + o[2].toFixed(2) + ',';\n        s += p.getViewExtent().toFixed(2) + ',' + p.getFov().toFixed(2);\n        \n        //var value = JSON.stringify(p.pos);\n\n        if (this.posElement.value != s) {\n            this.posElement.value = s;\n        }\n    }\n};\n\n\nexport default InspectorStats;\n\n","\nvar InspectorGraphs = function(inspector) {\n    this.inspector = inspector;\n    this.core = inspector.core;\n};\n\n\nInspectorGraphs.prototype.init = function() {\n    var inspector = this.inspector;\n\n    inspector.addStyle( ''\n        + '#vts-graphs-panel {'\n            + 'position:absolute;'\n            + 'left:10px;'\n            + 'top:10px;'\n            + 'z-index: 7;'\n            + 'background-color: #FFFFFF;'\n            + 'padding: 5px;'\n            + 'border-radius: 4px;'\n            + 'font-family: Arial, \"Helvetica Neue\", Helvetica, sans-serif;'\n            + 'color:#000000;'\n            + 'text-align: left;'\n            + 'font-size: 12px;'\n            + 'display:none;'\n        + '}'\n\n        + '.vts-graphs-canvas {'\n            + 'border: solid 1px #bbb;'\n            + 'image-rendering : pixelated;'\n        + '}'\n\n        + '.vts-graphs-info {'\n            + 'padding: 5px 2px;'\n            + 'font-size: 10px;'\n        + '}'\n\n        + '.vts-graphs-button {'\n            + 'padding: 2px 5px;'\n            + 'display:inline-block;'\n            + 'margin-right: 4px;'\n            + 'border-radius: 4px;'\n            + 'cursor:pointer;'\n        + '}'\n\n        + '.vts-graphs-button:hover {'\n            + 'box-shadow: 0 0 1px #0066ff;'\n        + '}'\n    );\n\n    this.element = document.createElement('div');\n    this.element.id = 'vts-graphs-panel';\n    this.element.innerHTML = ''\n        + '<canvas id=\"vts-graphs-render\" class=\"vts-graphs-canvas\" width=\"900\" height=\"100\" ></canvas>'\n        + '<div id=\"vts-graphs-info\" class=\"vts-graphs-info\" >&FilledSmallSquare; Frame: 1234 &nbsp <span style=\"color:#ff0000\">&FilledSmallSquare;</span> Render: 1234 &nbsp <span style=\"color:#0000ff\">&FilledSmallSquare;</span> Textures: 1234 &nbsp <span style=\"color:#005500\">&FilledSmallSquare;</span> Mesh: 1234 &nbsp <span style=\"color:#00bb00\">&FilledSmallSquare;</span> GpuMesh: 1234</div>'\n        + '<canvas id=\"vts-graphs-cache\" class=\"vts-graphs-canvas\" width=\"900\" height=\"100\" ></canvas>'\n        + '<div id=\"vts-graphs-info2\" class=\"vts-graphs-info\" >&FilledSmallSquare; Cache: 1234 &nbsp <span style=\"color:#ff0000\">&FilledSmallSquare;</span> Used: 123 &nbsp <span style=\"color:#0000ff\">&FilledSmallSquare;</span> Textures: 1234 &nbsp <span style=\"color:#00bb00\">&FilledSmallSquare;</span> Mesh: &nbsp 1234</div>'\n        + '<div id=\"vts-graphs-rec\" class=\"vts-graphs-button\" >Recording On</div>'\n        + '<div id=\"vts-graphs-ref\" class=\"vts-graphs-button\" >Refresh On</div>'\n        + '<div id=\"vts-graphs-res\" class=\"vts-graphs-button\" >Reset</div>'\n        + '<div id=\"vts-graphs-zoom\" class=\"vts-graphs-button\" >Scale: Max value</div>'\n        + '<div id=\"vts-graphs-magnify\" class=\"vts-graphs-button\" >Magnify Off</div>'\n        + '<div id=\"vts-graphs-graph\" class=\"vts-graphs-button\" >Graph: Cache</div>';\n\n    this.core.element.appendChild(this.element);\n    this.canvasRender = document.getElementById('vts-graphs-render');\n    this.canvasCache = document.getElementById('vts-graphs-cache');\n    this.canvasRenderCtx = this.canvasRender.getContext('2d');\n    this.canvasCacheCtx = this.canvasCache.getContext('2d');\n\n    document.getElementById('vts-graphs-rec').onclick = this.recordingPressed.bind(this);\n\n    document.getElementById('vts-graphs-rec').onclick = this.recordingPressed.bind(this);\n    document.getElementById('vts-graphs-ref').onclick = this.refreshPressed.bind(this);\n    document.getElementById('vts-graphs-res').onclick = this.resetPressed.bind(this);\n    document.getElementById('vts-graphs-zoom').onclick = this.zoomPressed.bind(this);\n    document.getElementById('vts-graphs-magnify').onclick = this.magnifyPressed.bind(this);\n    document.getElementById('vts-graphs-graph').onclick = this.graphPressed.bind(this);\n\n    document.getElementById('vts-graphs-render').onmousemove = this.onMouseMove.bind(this);\n    document.getElementById('vts-graphs-render').onmouseout = this.onMouseOut.bind(this);\n    document.getElementById('vts-graphs-cache').onmousemove = this.onMouseMove.bind(this);\n    document.getElementById('vts-graphs-cache').onmouseout = this.onMouseOut.bind(this);\n\n    this.element.addEventListener('mouseup', inspector.doNothing.bind(this), true);\n    this.element.addEventListener('mousedown', inspector.doNothing.bind(this), true);\n    this.element.addEventListener('mousewheel', inspector.doNothing.bind(this), false);\n    this.element.addEventListener('dblclick', inspector.doNothing.bind(this), false);\n\n    this.zoom = 'max';\n    this.graph = 'Cache';\n    this.refresh = true;\n\n    this.panelVisible = false;\n};\n\n\nInspectorGraphs.prototype.showPanel = function() {\n    this.element.style.display = 'block';\n    this.panelVisible = true;\n    this.recordingPressed(true);\n};\n\n\nInspectorGraphs.prototype.hidePanel = function() {\n    this.element.style.display = 'none';\n    this.panelVisible = false;\n    this.recordingPressed(true);\n};\n\n\nInspectorGraphs.prototype.switchPanel = function() {\n    if (this.panelVisible) {\n        this.hidePanel();\n    } else {\n        this.showPanel();\n    }\n};\n\n\nInspectorGraphs.prototype.recordingPressed = function(state) {\n    var map = this.core.getMap();\n\n    if (!map) {\n        return;\n    }\n\n    map.stats.recordGraphs = (state == null) ? state : !map.stats.recordGraphs;\n    this.updateGraphsPanel();\n    this.updateGraphs(null, true);\n};\n\n\nInspectorGraphs.prototype.refreshPressed = function() {\n    this.refresh = !this.refresh;\n    this.updateGraphsPanel();\n    this.updateGraphs();\n};\n\n\nInspectorGraphs.prototype.resetPressed = function() {\n    var map = this.core.getMap();\n\n    if (!map) {\n        return;\n    }\n\n    map.stats.resetGraphs();\n    this.updateGraphs(null, true);\n};\n\n\nInspectorGraphs.prototype.zoomPressed = function() {\n    switch (this.zoom) {\n    case 'max':     this.zoom = '120avrg'; break;\n    case '120avrg': this.zoom = '180avrg'; break;\n    case '180avrg': this.zoom = 'max'; break;\n    }\n\n    this.updateGraphsPanel();\n    this.updateGraphs();\n};\n\n\nInspectorGraphs.prototype.graphPressed = function() {\n    switch (this.graph) {\n    case 'Cache':      this.graph = 'Polygons'; break;\n    case 'Polygons':   this.graph = 'Processing'; break;\n    case 'Processing': this.graph = 'LODs'; break;\n    case 'LODs':       this.graph = 'Flux'; break;\n    case 'Flux':       this.graph = 'Cache'; break;\n    }\n\n    this.updateGraphsPanel();\n    this.updateGraphs();\n};\n\n\nInspectorGraphs.prototype.magnifyPressed = function() {\n    this.magnify = !this.magnify;\n\n    if (this.magnify) {\n        this.canvasRender.style.width = '1400px';\n        this.canvasRender.style.height = '200px';\n        this.canvasCache.style.width = '1400px';\n        this.canvasCache.style.height = '200px';\n        document.getElementById('vts-graphs-magnify').innerHTML = 'Magnify On';\n    } else {\n        this.canvasRender.style.width = '900px';\n        this.canvasRender.style.height = '100px';\n        this.canvasCache.style.width = '900px';\n        this.canvasCache.style.height = '100px';\n        document.getElementById('vts-graphs-magnify').innerHTML = 'Magnify Off';\n    }\n\n    this.updateGraphsPanel();\n    this.updateGraphs();\n};\n\n\nInspectorGraphs.prototype.updateGraphsPanel = function() {\n    var map = this.core.getMap();\n\n    if (!map) {\n        return;\n    }\n\n    if (map.stats.recordGraphs) {\n        document.getElementById('vts-graphs-rec').innerHTML = 'Recording On';\n    } else {\n        document.getElementById('vts-graphs-rec').innerHTML = 'Recording Off';\n    }\n\n    if (this.refresh) {\n        document.getElementById('vts-graphs-ref').innerHTML = 'Refresh On';\n    } else {\n        document.getElementById('vts-graphs-ref').innerHTML = 'Refresh Off';\n    }\n\n    switch (this.zoom) {\n    case 'max':\n        document.getElementById('vts-graphs-zoom').innerHTML = 'Scale: Max value';\n        break;\n\n    case '120avrg':\n        document.getElementById('vts-graphs-zoom').innerHTML = 'Scale: 100% Avrg';\n        break;\n\n    case '180avrg':\n        document.getElementById('vts-graphs-zoom').innerHTML = 'Scale: 50% Avrg';\n        break;\n    }\n\n    document.getElementById('vts-graphs-graph').innerHTML = 'Graph: ' + this.graph;\n};\n\n\nInspectorGraphs.prototype.onMouseMove = function(event) {\n    var x = event.clientX - this.canvasRender.getBoundingClientRect().left;\n    this.showCursor = true;\n\n    if (this.magnify) {\n        x = Math.floor(x * 900/1400);\n    }\n\n    this.cursorIndex = x;\n\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    if (!map.stats.recordGraphs) {\n        this.updateGraphs(null);\n    }\n};\n\n\nInspectorGraphs.prototype.onMouseOut = function() {\n    this.showCursor = false;\n    this.updateGraphs(null);\n};\n\n\nInspectorGraphs.prototype.updateGraphs = function(stats, ignoreRefresh) {\n    var map = this.core.getMap();\n\n    if (!map || (!this.refresh && !ignoreRefresh) || !this.panelVisible) {\n        return;\n    }\n\n    stats = stats || map.stats;\n\n    var width = this.canvasRender.width;\n    var height = this.canvasRender.height;\n    var ctx = this.canvasRenderCtx;\n\n    var samples = stats.graphsTimeSamples;\n    var samplesIndex = stats.graphsTimeIndex;\n\n    var factorX = width / samples;\n\n    ctx.clearRect(0, 0, width, height);\n\n    var maxValue = 0;\n    var totalFrame = 0;\n    var totalRender = 0;\n    var totalTexture = 0;\n    var totalMeshes = 0;\n    var totalGpuMeshes = 0;\n    var realCount = 0, i, j, lj;\n    var index, value, values, str, y, factorY, max, min;\n\n    var valuesFrame = stats.graphsFrameTimes;\n    var valuesRender = stats.graphsRenderTimes;\n    var valuesTextures = stats.graphsCreateTextureTimes;\n    var valuesMeshes = stats.graphsCreateMeshTimes;\n    var valuesGpuMeshes = stats.graphsCreateGpuMeshTimes;\n    var valuesGeodata;\n\n    for (i = 0; i < samples; i++) {\n        totalFrame += valuesFrame[i];\n        totalRender += valuesRender[i];\n        totalTexture += valuesTextures[i];\n        totalMeshes += valuesMeshes[i];\n        totalGpuMeshes += valuesGpuMeshes[i];\n\n        var v = valuesFrame[i];\n\n        if (v > maxValue) {\n            maxValue = v;\n        }\n\n        if (v > 0) {\n            realCount++;\n        }\n    }\n\n    if (this.zoom == '120avrg') {\n        maxValue = (totalFrame / realCount) * 1.0;\n    }\n\n    if (this.zoom == '180avrg') {\n        maxValue = (totalFrame / realCount) * 0.5;\n    }\n\n    factorY = height / maxValue;\n\n    for (i = 0; i < samples; i++) {\n        index = samplesIndex + i;\n        index %= samples;\n\n        ctx.fillStyle='#000000';\n        ctx.fillRect(i*factorX, height, 1, -(valuesFrame[index])*factorY);\n        ctx.fillStyle='#ff0000';\n        ctx.fillRect(i*factorX, height, 1, -(valuesRender[index])*factorY);\n\n        ctx.fillStyle='#0000ff';\n        ctx.fillRect(i*factorX, height, 1, -(valuesTextures[index])*factorY);\n\n        y = height -(valuesTextures[index])*factorY;\n\n        ctx.fillStyle='#007700';\n        ctx.fillRect(i*factorX, y, 1, -(valuesMeshes[index])*factorY);\n\n        y -= (valuesMeshes[index])*factorY;\n\n        ctx.fillStyle='#00ff00';\n        ctx.fillRect(i*factorX, y, 1, -(valuesGpuMeshes[index])*factorY);\n\n    }\n\n    if (this.showCursor) {\n        ctx.fillStyle='#aa00aa';\n        index = (this.cursorIndex) % samples;\n        ctx.fillRect(Math.floor(index*factorX)-1, 0, 1, height);\n        ctx.fillRect(Math.floor(index*factorX)+1, 0, 1, height);\n        index = (this.cursorIndex + samplesIndex) % samples;\n\n        str = '&FilledSmallSquare; Frame: ' + valuesFrame[index].toFixed(2) +\n              ' &nbsp <span style=\"color:#ff0000\">&FilledSmallSquare;</span> Render: ' + valuesRender[index].toFixed(2) +\n              ' &nbsp <span style=\"color:#0000ff\">&FilledSmallSquare;</span> Textures: ' + valuesTextures[index].toFixed(2) +\n              ' &nbsp <span style=\"color:#005500\">&FilledSmallSquare;</span> Meshes: ' + valuesMeshes[index].toFixed(2) +\n              ' &nbsp <span style=\"color:#00bb00\">&FilledSmallSquare;</span> GpuMeshes: ' + valuesGpuMeshes[index].toFixed(2) + '</div>';\n    } else {\n        str = '&FilledSmallSquare; Frame: ' + Math.round(totalFrame) +\n              ' &nbsp <span style=\"color:#ff0000\">&FilledSmallSquare;</span> Render: ' + Math.round(totalRender) +\n              ' &nbsp <span style=\"color:#0000ff\">&FilledSmallSquare;</span> Textures: ' + Math.round(totalTexture) +\n              ' &nbsp <span style=\"color:#005500\">&FilledSmallSquare;</span> Meshes: ' + Math.round(totalMeshes) +\n              ' &nbsp <span style=\"color:#00bb00\">&FilledSmallSquare;</span> GpuMeshes: ' + Math.round(totalGpuMeshes) +'</div>';\n    }\n\n    document.getElementById('vts-graphs-info').innerHTML = str;\n\n    width = this.canvasCache.width;\n    height = this.canvasCache.height;\n    ctx = this.canvasCacheCtx;\n\n    factorX = width / samples;\n\n    ctx.clearRect(0, 0, width, height);\n\n    switch (this.graph) {\n    case 'Cache':\n        {\n            factorY = height / ((map.gpuCache.maxCost+map.resourcesCache.maxCost+map.metatileCache.maxCost));\n\n            var maxMetatiles = 0;\n            var maxResources = 0;\n            var maxTextures = 0;\n            var maxMeshes = 0;\n            var maxGeodata = 0;\n            var maxGpu = 0;\n\n            var valuesMetatiles = stats.graphsCpuMemoryMetatiles;\n            var valuesResources = stats.graphsCpuMemoryUsed;\n            var valuesGpu = stats.graphsGpuMemoryRender;\n            valuesGeodata = stats.graphsGpuMemoryGeodata;\n            valuesTextures = stats.graphsGpuMemoryTextures;\n            valuesMeshes = stats.graphsGpuMemoryMeshes;\n\n            for (i = 0; i < samples; i++) {\n                maxMetatiles = valuesMetatiles[i] > maxMetatiles ? valuesMetatiles[i] : maxMetatiles;\n                maxResources = valuesResources[i] > maxResources ? valuesResources[i] : maxResources;\n                maxTextures = valuesTextures[i] > maxTextures ? valuesTextures[i] : maxTextures;\n                maxMeshes = valuesMeshes[i] > maxMeshes ? valuesMeshes[i] : maxMeshes;\n                maxGeodata = valuesGeodata[i] > maxGeodata ? valuesGeodata[i] : maxGeodata;\n                maxGpu = valuesGpu[i] > maxGpu ? valuesGpu[i] : maxGpu;\n            }\n\n            for (i = 0; i < samples; i++) {\n                index = samplesIndex + i;\n                index %= samples;\n\n                value = valuesMetatiles[index] + valuesMeshes[index] + valuesTextures[index] + valuesGeodata[index] + valuesResources[index];\n                ctx.fillStyle='#000000';\n                ctx.fillRect(i*factorX, height, 1, -(value)*factorY);\n                value -= valuesResources[index];\n\n                ctx.fillStyle='#0000ff';\n                ctx.fillRect(i*factorX, height, 1, -(value)*factorY);\n                value -= valuesTextures[index];\n\n                ctx.fillStyle='#009999';\n                ctx.fillRect(i*factorX, height, 1, -(value)*factorY);\n                value -= valuesGeodata[index];\n\n                ctx.fillStyle='#007700';\n                ctx.fillRect(i*factorX, height, 1, -(value)*factorY);\n                value -= valuesMeshes[index];\n\n                ctx.fillStyle='#ff0000';\n                ctx.fillRect(i*factorX, height, 1, -(value)*factorY);\n\n                value = valuesGpu[index];\n                ctx.fillStyle='#ffff00';\n                ctx.fillRect(i*factorX, height -(value)*factorY, 1, 1);\n            }\n\n            if (this.showCursor) {\n                index = (this.cursorIndex + samplesIndex) % samples;\n                str = '<span style=\"color:#555\">&FilledSmallSquare;</span> Total: ' + Math.ceil((valuesMetatiles[index] + valuesResources[index] + valuesTextures[index] + valuesMeshes[index])/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#000000\">&FilledSmallSquare;</span> CPU: ' + Math.ceil(valuesResources[index]/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#000000\">&FilledSmallSquare;</span> GPU: ' + Math.ceil((valuesTextures[index] + valuesMeshes[index])/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#0000ff\">&FilledSmallSquare;</span> Te: ' + Math.ceil(valuesTextures[index]/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#005500\">&FilledSmallSquare;</span> Me: ' + Math.ceil(valuesMeshes[index]/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#009999\">&FilledSmallSquare;</span> Ge: ' + Math.ceil(valuesGeodata[index]/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#ff0000\">&FilledSmallSquare;</span> Met: ' + Math.ceil(valuesMetatiles[index]/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#ffff00\">&FilledSmallSquare;</span> Render: ' + Math.ceil(valuesGpu[index]/(1024*1024)) + 'MB' +'</div>';\n            } else {\n                str = '<span style=\"color:#555\">&FilledSmallSquare;</span> Total: ' + Math.round((maxMetatiles + maxResources + maxTextures + maxMeshes)/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#000000\">&FilledSmallSquare;</span> CPU: ' + Math.ceil(maxResources/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#000000\">&FilledSmallSquare;</span> GPU: ' + Math.ceil((maxTextures + maxMeshes)/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#0000ff\">&FilledSmallSquare;</span> Te ' + Math.ceil(maxTextures/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#005500\">&FilledSmallSquare;</span> Me: ' + Math.ceil(maxMeshes/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#009999\">&FilledSmallSquare;</span> Ge: ' + Math.ceil(maxGeodata/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#ff0000\">&FilledSmallSquare;</span> Met: ' + Math.ceil(maxMetatiles/(1024*1024)) + 'MB' +\n                      ' &nbsp <span style=\"color:#ffff00\">&FilledSmallSquare;</span> Render: ' + Math.ceil(maxGpu/(1024*1024)) + 'MB' +'</div>';\n            }\n\n        }\n        break;\n\n\n    case 'Polygons':\n    case 'Processing':\n        {\n            max = 0;\n            min = 99999999999;\n            realCount = 0;\n            values = (this.graph == 'Polygons') ? stats.graphsPolygons : stats.graphsBuild;\n            var total = 0;\n\n            for (i = 0; i < samples; i++) {\n                max = values[i] > max ? values[i] : max;\n\n                if (values[i] > 0) {\n                    min = values[i] < min ? values[i] : min;\n                    total += values[i];\n                    realCount++;\n                }\n            }\n\n            factorY = height / max;\n\n            for (i = 0; i < samples; i++) {\n                index = samplesIndex + i;\n                index %= samples;\n\n                ctx.fillStyle='#007700';\n                ctx.fillRect(i*factorX, height, 1, -(values[index])*factorY);\n            }\n\n            if (this.showCursor) {\n                index = (this.cursorIndex + samplesIndex) % samples;\n                str = '<span style=\"color:#007700\">&FilledSmallSquare;</span> ' + this.graph + ' Max: ' + Math.round(values[index]) +'</div>';\n            } else {\n                str = '<span style=\"color:#007700\">&FilledSmallSquare;</span> ' + this.graph + ' Max: ' + max +'</div>';\n                str += ' &nbsp Min: ' + min;\n                str += ' &nbsp Avrg: ' + Math.round(total / realCount) +'</div>';\n            }\n        }\n        break;\n\n\n    case 'LODs':\n        {\n            max = 0;\n            values = stats.graphsLODs;\n\n            for (i = 0; i < samples; i++) {\n                max = values[i][0] > max ? values[i][0] : max;\n            }\n\n            factorY = height / max;\n\n            ctx.fillStyle='#000000';\n            ctx.fillRect(0, 0, width, height);\n\n            var lods;\n\n            for (i = 0; i < samples; i++) {\n                index = samplesIndex + i;\n                index %= samples;\n\n                //ctx.fillStyle=\"#000000\";\n                //ctx.fillRect(i*factorX, height, 1, -(values[index][0])*factorY);\n\n                y = height;\n                \n                lods = values[index][1]; \n\n                for (j = 0, lj = lods.length; j < lj; j++) {\n                    if (lods[j]) {\n                        ctx.fillStyle='hsl('+((j*23)%360)+',100%,50%)';\n                        value = Math.round((lods[j])*factorY);\n                        ctx.fillRect(i*factorX, y, 1, -value);\n                        y -= value;\n                    }\n                }\n\n            }\n\n            if (this.showCursor) {\n                index = (this.cursorIndex + samplesIndex) % samples;\n\n                str = 'LODs:' + values[index][0];\n                lods = values[index][1]; \n\n                for (j = 0, lj = lods.length; j < lj; j++) {\n                    if (lods[j]) {\n                        str += '<span style=\"color:hsl('+((j*23)%360)+',100%,50%)\">&FilledSmallSquare;</span>'+j+':'+lods[j];\n                    }\n                }\n\n            } else {\n                str = 'LODs:' + values[index][0];\n            }\n\n            str += '</div>';\n        }\n        break;\n\n    case 'Flux':\n        {\n            var maxCount = 0;\n            var maxSize = 0;\n\n            var maxTexPlusCount = 0;\n            var maxTexPlusSize = 0;\n            var maxTexMinusCount = 0;\n            var maxTexMinusSize = 0;\n\n            var maxMeshPlusCount = 0;\n            var maxMeshPlusSize = 0;\n            var maxMeshMinusCount = 0;\n            var maxMeshMinusSize = 0;\n\n            var maxGeodataPlusCount = 0;\n            var maxGeodataPlusSize = 0;\n            var maxGeodataMinusCount = 0;\n            var maxGeodataMinusSize = 0;\n\n            valuesTextures = stats.graphsFluxTextures;\n            valuesMeshes = stats.graphsFluxMeshes;\n            valuesGeodata = stats.graphsFluxGeodatas;\n\n            for (i = 0; i < samples; i++) {\n                var tmp = valuesTextures[i][0][0] + valuesMeshes[i][0][0];\n                maxCount = tmp > maxCount ? tmp : maxCount;\n                tmp = valuesTextures[i][1][0] + valuesMeshes[i][1][0];\n                maxCount = tmp > maxCount ? tmp : maxCount;\n\n                tmp = valuesTextures[i][0][1] + valuesMeshes[i][0][1];\n                maxSize = tmp > maxSize ? tmp : maxSize;\n                tmp = valuesTextures[i][1][1] + valuesMeshes[i][1][1];\n                maxSize = tmp > maxSize ? tmp : maxSize;\n\n                maxTexPlusCount = valuesTextures[i][0][0] > maxTexPlusCount ? valuesTextures[i][0][0] : maxTexPlusCount;\n                maxTexPlusSize = valuesTextures[i][0][1] > maxTexPlusSize ? valuesTextures[i][0][1] : maxTexPlusSize;\n                maxTexMinusCount = valuesTextures[i][1][0] > maxTexMinusCount ? valuesTextures[i][1][0] : maxTexMinusCount;\n                maxTexMinusSize = valuesTextures[i][1][1] ? valuesTextures[i][1][1] : maxTexMinusSize;\n\n                maxMeshPlusCount = valuesMeshes[i][0][0] > maxMeshPlusCount ? valuesMeshes[i][0][0] : maxMeshPlusCount;\n                maxMeshPlusSize = valuesMeshes[i][0][1] > maxMeshPlusSize ? valuesMeshes[i][0][1] : maxMeshPlusSize;\n                maxMeshMinusCount = valuesMeshes[i][1][0] > maxMeshMinusCount ? valuesMeshes[i][1][0] : maxMeshMinusCount;\n                maxMeshMinusSize = valuesMeshes[i][1][1] > maxMeshMinusSize ? valuesMeshes[i][1][1] : maxMeshMinusSize;\n\n                maxGeodataPlusCount = valuesGeodata[i][0][0] > maxGeodataPlusCount ? valuesGeodata[i][0][0] : maxGeodataPlusCount;\n                maxGeodataPlusSize = valuesGeodata[i][0][1] > maxGeodataPlusSize ? valuesGeodata[i][0][1] : maxGeodataPlusSize;\n                maxGeodataMinusCount = valuesGeodata[i][1][0] > maxGeodataMinusCount ? valuesGeodata[i][1][0] : maxGeodataMinusCount;\n                maxGeodataMinusSize = valuesGeodata[i][1][1] > maxGeodataMinusSize ? valuesGeodata[i][1][1] : maxGeodataMinusSize;\n            }\n\n            factorY = (height*0.25-2) / maxCount;\n            var factorY2 = (height*0.25-2) / maxSize;\n\n            var base = Math.floor(height*0.25);\n            var base2 = Math.floor(height*0.75);\n\n            for (i = 0; i < samples; i++) {\n                index = samplesIndex + i;\n                index %= samples;\n                \n                var y1Up = base;\n                var y1Down = base+1;\n                var y2Up = base2;\n                var y2Down = base2+1;\n\n                ctx.fillStyle='#0000aa';\n                ctx.fillRect(i*factorX, y1Up, 1, -(valuesTextures[index][0][0])*factorY);\n                ctx.fillRect(i*factorX, y1Down, 1, (valuesTextures[index][1][0])*factorY);\n\n                ctx.fillRect(i*factorX, y2Up, 1, -(valuesTextures[index][0][1])*factorY2);\n                ctx.fillRect(i*factorX, y2Down, 1, (valuesTextures[index][1][1])*factorY2);\n\n                y1Up -= (valuesTextures[index][0][0])*factorY;\n                y1Down += (valuesTextures[index][1][0])*factorY;\n                y2Up -= (valuesTextures[index][0][1])*factorY2;\n                y2Down += (valuesTextures[index][1][1])*factorY2;\n\n                ctx.fillStyle='#007700';\n                ctx.fillRect(i*factorX, y1Up, 1, -(valuesMeshes[index][0][0])*factorY);\n                ctx.fillRect(i*factorX, y1Down, 1, (valuesMeshes[index][1][0])*factorY);\n\n                ctx.fillRect(i*factorX, y2Up, 1, -(valuesMeshes[index][0][1])*factorY2);\n                ctx.fillRect(i*factorX, y2Down, 1, (valuesMeshes[index][1][1])*factorY2);\n\n                y1Up -= (valuesMeshes[index][0][0])*factorY;\n                y1Down += (valuesMeshes[index][1][0])*factorY;\n                y2Up -= (valuesMeshes[index][0][1])*factorY2;\n                y2Down += (valuesMeshes[index][1][1])*factorY2;\n\n                ctx.fillStyle='#009999';\n                ctx.fillRect(i*factorX, y1Up, 1, -(valuesGeodata[index][0][0])*factorY);\n                ctx.fillRect(i*factorX, y1Down, 1, (valuesGeodata[index][1][0])*factorY);\n\n                ctx.fillRect(i*factorX, y2Up, 1, -(valuesGeodata[index][0][1])*factorY2);\n                ctx.fillRect(i*factorX, y2Down, 1, (valuesGeodata[index][1][1])*factorY2);\n\n                ctx.fillStyle='#aaaaaa';\n                ctx.fillRect(0, Math.floor(height*0.5), width, 1);\n                ctx.fillStyle='#dddddd';\n                ctx.fillRect(0, base, width, 1);\n                ctx.fillRect(0, base2, width, 1);\n            }\n\n\n            if (this.showCursor) {\n                index = (this.cursorIndex + samplesIndex) % samples;\n                str = '<span style=\"color:#007700\">&FilledSmallSquare;</span> Textures Count +/-: ' + valuesTextures[index][0][0] + '/' + valuesTextures[index][1][0];\n                str += ' &nbsp Size +/-: ' + (valuesTextures[index][0][1]/1024/1024).toFixed(2) + '/' + (valuesTextures[index][1][1]/1024/1024).toFixed(2);\n                str += ' &nbsp <span style=\"color:#0000aa\">&FilledSmallSquare;</span> Meshes Count +/-: ' + valuesMeshes[index][0][0] + '/' + valuesMeshes[index][1][0];\n                str += ' &nbsp Size +/-: ' + (valuesMeshes[index][0][1]/1024/1024).toFixed(2) + '/' + (valuesMeshes[index][1][1]/1024/1024).toFixed(2);\n                str += ' &nbsp <span style=\"color:#009999\">&FilledSmallSquare;</span> Geodata Count +/-: ' + valuesGeodata[index][0][0] + '/' + valuesGeodata[index][1][0];\n                str += ' &nbsp Size +/-: ' + (valuesGeodata[index][0][1]/1024/1024).toFixed(2) + '/' + (valuesGeodata[index][1][1]/1024/1024).toFixed(2);\n                str += '</div>';\n            } else {\n                str = '<span style=\"color:#007700\">&FilledSmallSquare;</span> Textures Count +/-: ' + maxTexPlusCount + '/' + maxTexMinusCount;\n                str += ' &nbsp Size +/-: ' + (maxTexPlusSize/1024/1024).toFixed(2) + '/' + (maxTexMinusSize/1024/1024).toFixed(2);\n                str += ' &nbsp <span style=\"color:#0000aa\">&FilledSmallSquare;</span> Meshes Count +/-: ' + maxMeshPlusCount + '/' + maxMeshMinusCount;\n                str += ' &nbsp Size +/-: ' + (maxMeshPlusSize/1024/1024).toFixed(2) + '/' + (maxMeshMinusSize/1024/1024).toFixed(2);\n                str += ' &nbsp <span style=\"color:#009999\">&FilledSmallSquare;</span> Geodata Count +/-: ' + maxGeodataPlusCount + '/' + maxGeodataMinusCount;\n                str += ' &nbsp Size +/-: ' + (maxGeodataPlusSize/1024/1024).toFixed(2) + '/' + (maxGeodataMinusSize/1024/1024).toFixed(2);\n                str += '</div>';\n            }\n\n        }\n        break;\n\n    }\n\n    if (this.showCursor) {\n        ctx.fillStyle='#aa00aa';\n        index = (this.cursorIndex) % samples;\n        ctx.fillRect(Math.floor(index*factorX)-1, 0, 1, height);\n        ctx.fillRect(Math.floor(index*factorX)+1, 0, 1, height);\n    }\n\n    document.getElementById('vts-graphs-info2').innerHTML = str;\n};\n\n\nexport default InspectorGraphs;\n\n","\nvar InspectorLayers = function(inspector) {\n    this.inspector = inspector;\n    this.core = inspector.core;\n};\n\n\nInspectorLayers.prototype.init = function() {\n    var inspector = this.inspector;\n    inspector.addStyle(\n        '#vts-layers-panel {'\n            + 'font-family: Arial, \"Helvetica Neue\", Helvetica, sans-serif;'\n            + 'display: none;'\n            + 'padding:15px;'\n            + 'font-size: 14px;'\n            + 'position: absolute;'\n            + 'right: 10px;'\n            + 'bottom: 10px;'\n            + 'cursor: default;'\n            + 'background-color: rgba(255,255,255,0.95);'\n            + 'border-radius: 5px;'\n            + 'border: solid 1px #ccc;'\n            + 'text-align: left;'\n            + 'z-index: 7;'\n            + 'padding: 10px;'\n        + '}'\n\n        + '#vts-layers-panel button {'\n            + 'max-width: 23px;'\n            + 'max-height: 21px;'\n        + '}'\n\n        + '#vts-layers-panel-title {'\n            + 'margin-bottom: 3px;'\n        + '}'\n\n        + '#vts-layers-views-panel {'\n            + 'margin-top: 5px;'\n            + 'float: left;'\n        + '}'\n\n        + '#vts-layers-views-items {'\n            + 'width: 191px;'\n            + 'overflow-y: scroll;'\n            + 'overflow-x: hidden;'\n            + 'height: 200px;'\n            + 'border: 1px solid #ddd;'\n        + '}'\n        \n        + '#vts-layers-surfaces-panel {'\n            + 'margin-top: 5px;'\n            + 'float: left;'\n        + '}'        \n        \n        + '#vts-layers-surfaces-items {'\n            + 'width: 150px;'\n            + 'overflow-y: scroll;'\n            + 'overflow-x: hidden;'\n            + 'height: 200px;'\n            + 'border-top: 1px solid #ddd;'\n            + 'border-bottom: 1px solid #ddd;'\n        + '}'\n         \n        + '#vts-layers-boundlayers-panel {'\n            + 'margin-top: 5px;'\n            + 'float: left;'\n        + '}'\n\n        + '#vts-layers-boundlayers-items {'\n            + 'width: 275px;'\n            + 'overflow-y: scroll;'\n            + 'overflow-x: hidden;'\n            + 'height: 200px;'\n            + 'border: 1px solid #ddd;'\n            + 'border-right: none;'\n        + '}'\n\n        + '#vts-layers-freelayers-panel {'\n            + 'margin-top: 5px;'\n            + 'float: left;'\n        + '}'\n\n        + '#vts-layers-freelayers-items {'\n            + 'width: 150px;'\n            + 'overflow-y: scroll;'\n            + 'overflow-x: hidden;'\n            + 'height: 200px;'\n            + 'border: 1px solid #ddd;'\n        + '}'\n\n        + '#vts-layers-fl-properties-panel {'\n            + 'margin-top: 5px;'\n            + 'float: left;'\n        + '}'\n\n        + '#vts-layers-fl-properties-items {'\n            + 'width: 250px;'\n            + 'overflow-y: scroll;'\n            + 'overflow-x: hidden;'\n            + 'height: 200px;'\n            + 'border: 1px solid #ddd;'\n            + 'border-right: none;'\n        + '}'\n\n        + '#vts-layers-json-panel {'\n            + 'margin-top: 5px;'\n            + 'float: right;'\n        + '}'\n\n        + '#vts-layers-json-text {'\n            + 'width: 200px;'\n            + 'resize: none;'\n            + 'height: 180px;'\n            + 'border: 1px solid #ddd;'\n            + 'white-space: pre;'\n            + 'padding: 0px;'\n        + '}'\n\n        + '#vts-layers-json-text2 {'\n            + 'width: 200px;'\n            + 'height: 21px;'\n            + 'border: 1px solid #ddd;'\n        + '}'\n        \n        + '.vts-layers-panel-title {'\n            + 'margin: 0px;'\n            + 'margin-bottom: 5px;'\n        + '}'\n\n        + '.vts-layers-item {'\n            + 'width: 100%;'\n        + '}'        \n        \n        + '.vts-layers-item input[type=number]{'\n            + 'width: 43px;'\n        + '}'\n        \n        + '.vts-layers-name {'\n            + 'width: 120px;'\n            + 'display: inline-block;'\n            + 'overflow: hidden;'\n            + 'text-overflow: ellipsis;'\n            + 'white-space: nowrap;'       \n        + '}'          \n\n        + '.vts-layers-name2 {'\n            + 'width: 126px;'\n            + 'display: inline-block;'\n            + 'overflow: hidden;'\n            + 'text-overflow: ellipsis;'\n            + 'white-space: nowrap;'       \n        + '}'\n         \n        + '#vts-layers-fl-properties-style {'\n            + 'width: 175px;'\n            + 'height: 21px;'\n        + '}'\n\n        + '.vts-surface-item {'\n            + 'width: 100%;'\n            + 'overflow: hidden;'\n            + 'text-overflow: ellipsis;'\n            + 'white-space: nowrap;'    \n        + '}' \n        \n    );\n\n    this.element = document.createElement('div');\n    this.element.id = 'vts-layers-panel';\n    this.element.innerHTML = ''\n        + '<div id=\"vts-layers-views-panel\"><p class=\"vts-layers-panel-title\">Named Views:</p>'\n           + '<div id=\"vts-layers-views-items\"></div></div>'\n        + '<div id=\"vts-layers-surfaces-panel\"><p class=\"vts-layers-panel-title\">Surfaces:</p>'\n           + '<div id=\"vts-layers-surfaces-items\"></div></div>'\n        + '<div id=\"vts-layers-boundlayers-panel\"><p class=\"vts-layers-panel-title\">Surface Bound Layers:</p>'\n           + '<div id=\"vts-layers-boundlayers-items\"></div></div>'\n        + '<div id=\"vts-layers-freelayers-panel\"><p class=\"vts-layers-panel-title\">Free Layers:</p>'\n           + '<div id=\"vts-layers-freelayers-items\"></div></div>'\n        + '<div id=\"vts-layers-fl-properties-panel\"><p class=\"vts-layers-panel-title\">Free Layer Properties:</p>'\n           + '<div id=\"vts-layers-fl-properties-items\"></div></div>'\n        + '<div id=\"vts-layers-json-panel\"><p class=\"vts-layers-panel-title\">Definition:</p>'\n           + '<textarea id=\"vts-layers-json-text\" cols=\"48\"></textarea><br/>'\n           + '<input id=\"vts-layers-json-text2\" type=\"text\"></div>';\n\n    this.core.element.appendChild(this.element);\n    this.viewItems = document.getElementById('vts-layers-views-items');\n    this.surfacesItems = document.getElementById('vts-layers-surfaces-items');\n    this.boundLayersItems = document.getElementById('vts-layers-boundlayers-items');\n    this.freeLayersItems = document.getElementById('vts-layers-freelayers-items');\n    this.freeLayersPropertiesItems = document.getElementById('vts-layers-fl-properties-items');\n    this.jsonText = document.getElementById('vts-layers-json-text');\n    this.jsonText2 = document.getElementById('vts-layers-json-text2');\n\n    this.element.addEventListener('mouseup', inspector.doNothing.bind(this), true);\n    this.element.addEventListener('mousedown', inspector.doNothing.bind(this), true);\n    this.element.addEventListener('mousewheel', inspector.doNothing.bind(this), false);\n    this.element.addEventListener('dblclick', inspector.doNothing.bind(this), false);\n\n    this.views = [];\n    \n    this.panelVisible = false;\n    this.panelInitialized = false;\n    this.currentView = '';\n    this.currentSurface = '';\n    this.currentFreeLayer = '';\n};\n\n\nInspectorLayers.prototype.initViews = function() {\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var views = map.getNamedViews(), freeLayer;\n    var id = '--initial--';\n    var i, li, j, lj, layers, states, index, view, surfaces, skey;\n\n\n    this.views[id] = {\n        surfaces : {},\n        freeLayers : {},\n        options : {},\n        original : JSON.parse(JSON.stringify(map.getView()))\n    };\n\n    for (i = 0, li = views.length; i < li; i++) {\n        view = views[i];\n        this.views[view] = {\n            surfaces : {},\n            freeLayers : {},\n            options : {},\n            original : JSON.parse(JSON.stringify(map.getNamedView(view).getInfo()))\n        };\n    }\n    \n    this.currentView = id;\n    views = this.views;\n    \n    for (var key in views) {\n        view = views[key];\n        surfaces = map.getSurfaces();   \n        \n        for (i = 0, li = surfaces.length; i < li; i++) {\n            id = surfaces[i];\n            surface = map.getSurface(id);\n            layers = map.getBoundLayers();\n            states = []; \n    \n            for (j = 0, lj = layers.length; j < lj; j++) {\n                //layer = map.getBoundLayerById(layers[j]);\n                \n                states.push({\n                    id : layers[j],\n                    alpha : 100,\n                    options : \"{}\",\n                    enabled : false\n                });\n            }\n            \n            view.surfaces[id] = {\n                enabled : false,\n                layers : states \n            };\n        }         \n\n        var freeLayers = map.getFreeLayers();   \n        \n        for (i = 0, li = freeLayers.length; i < li; i++) {\n            id = freeLayers[i];\n            layers = map.getBoundLayers();\n            states = []; \n    \n            for (j = 0, lj = layers.length; j < lj; j++) {\n                //layer = map.getBoundLayerById(layers[j]);\n                \n                states.push({\n                    id : layers[j],\n                    alpha : 100,\n                    options : \"{}\",\n                    enabled : false\n                });\n            }\n            \n            freeLayer = map.getFreeLayer(id);\n            var freeLayerInfo = freeLayer.getInfo(); \n            \n            view.freeLayers[id] = {\n                enabled : false,\n                style : null,\n                originalStyle : freeLayerInfo['style'],\n                depthShift : 0,\n                depthShift2 : 0,\n                depthShift3 : 0,\n                layers : states \n            };\n        }\n        \n        var viewSurfaces = view.original['surfaces'];\n        \n        for (skey in viewSurfaces) {\n            layers = viewSurfaces[skey];\n            \n            if (view.surfaces[skey]) {\n                var surface = view.surfaces[skey]; \n                surface.enabled = true;\n\n                for (i = 0, li = layers.length; i < li; i++) {\n                    if (typeof layers[i] === 'string') {\n                        index = this.findIdInArray(surface.layers, layers[i]);\n                        if (index != -1 && surface.layers[index]) {\n                            surface.layers[index].enabled = true;\n                            surface.layers.splice(i, 0, surface.layers.splice(index, 1)[0]);\n                        }    \n                    } else {\n                        id = layers[i]['id'];\n                        index = this.findIdInArray(surface.layers, id);\n                        if (index != -1 && surface.layers[index]) {\n                            surface.layers[index].enabled = true;\n                            surface.layers[index].alpha = layers[i]['alpha'] ? (parseFloat(layers[i]['alpha'])*100) : 100;\n                            surface.layers[index].options = layers[i]['options'] ? JSON.stringify(layers[i]['options']) : \"{}\";\n                            surface.layers.splice(i, 0, surface.layers.splice(index, 1)[0]);\n                        }    \n                    }\n                }\n            }\n        }\n\n        var viewfreeLayers = view.original['freeLayers'];\n        \n        for (skey in viewfreeLayers) {\n            var freeLayerProperties = viewfreeLayers[skey];\n            \n            if (view.freeLayers[skey]) {\n                freeLayer = view.freeLayers[skey]; \n                freeLayer.enabled = true;\n                var depthShift = freeLayerProperties['depthOffset'] || [0,0,0];\n                freeLayer.depthShift = depthShift[0];\n                freeLayer.depthShift2 = depthShift[1];\n                freeLayer.depthShift3 = depthShift[2];\n                freeLayer.style = freeLayerProperties['style'];\n                //freeLayer.originalStyle = freeLayer.style;\n                \n                layers = freeLayerProperties['boundLayers'] || [];\n                //freeLayer.layers = layers;\n                \n                for (i = 0, li = layers.length; i < li; i++) {\n                    if (typeof layers[i] === 'string') {\n                        index = this.findIdInArray(freeLayer.layers, layers[i]);\n                        if (index != -1 && freeLayer.layers[index]) {\n                            freeLayer.layers[index].enabled = true;\n                            freeLayer.layers.splice(i, 0, freeLayer.layers.splice(index, 1)[0]);\n                        }    \n                    } else {\n                        id = layers[i]['id'];\n                        index = this.findIdInArray(freeLayer.layers, id);\n                        if (index != -1 && surface.layers[index]) {\n                            freeLayer.layers[index].enabled = true;\n                            freeLayer.layers[index].alpha = layers[i]['alpha'] ? (parseFloat(layers[i]['alpha'])*100) : 100;\n                            freeLayer.layers[index].options = layers[i]['options'] ? JSON.stringify(layers[i]['options']) : \"{}\";\n                            freeLayer.layers.splice(i, 0, surface.layers.splice(index, 1)[0]);\n                        }    \n                    }\n                }\n            }\n        }        \n    }\n};\n\n\nInspectorLayers.prototype.findIdInArray = function(array, id) {\n    for (var i = 0, li = array.length; i < li; i++) {\n        if (array[i].id == id) {\n            return i;\n        } \n    }\n    \n    return -1;\n};\n\n\nInspectorLayers.prototype.buildViews = function() {\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var views = this.views;\n    var html = '';\n\n    for (var key in views) {\n        html += '<div class=\"vts-views-item\" id=\"vts-views-item-' + key + '\">'\n                 + '<div class=\"vts-layers-name2\">' + key + '</div>'\n                 + '<button id=\"vts-views-cbutton-' + key + '\" type=\"button\" title=\"Clone\">C</button>' \n                 + '<button id=\"vts-views-xbutton-' + key + '\" type=\"button\" title=\"Remove\">X</button>' \n                 + '</div>';\n    }\n\n    this.viewItems.innerHTML = html;\n\n    for (key in views) {\n        htmlId = 'vts-views-cbutton-' + key;\n        document.getElementById(htmlId).onclick = this.switchView.bind(this, key, htmlId, 'clone');\n        htmlId = 'vts-views-xbutton-' + key;\n        document.getElementById(htmlId).onclick = this.switchView.bind(this, key, htmlId, 'remove');\n        var htmlId = 'vts-views-item-' + key;\n        document.getElementById(htmlId).onclick = this.selectView.bind(this, key);\n    }\n};\n\n\nInspectorLayers.prototype.buildSurfaces = function() {\n    var view = this.views[this.currentView];\n    var surfaces = view.surfaces;\n    var html = '', htmlId;\n    var firstKey = null, key;\n    \n    for (key in surfaces) {\n        html += '<div id=\"vts-surface-item-' + key + '\" class=\"vts-surface-item\"><input id=\"vts-surface-checkbox-'\n                 + key + '\" type=\"checkbox\"/><span title=' + key + '>' + key + '</span></div>';\n                 \n        if (firstKey === null) {\n            firstKey = key;\n        }\n    }\n\n    this.surfacesItems.innerHTML = html;\n    this.currentSurface = firstKey;\n\n    for (key in surfaces) {\n        if (surfaces[key].enabled) {\n            htmlId = 'vts-surface-checkbox-' + key;\n            document.getElementById(htmlId).checked = true;\n        }\n    }\n\n    for (key in surfaces) {\n        htmlId = 'vts-surface-checkbox-' + key;\n        document.getElementById(htmlId).onchange = this.switchSurface.bind(this, key, htmlId);\n        htmlId = 'vts-surface-item-' + key;\n        document.getElementById(htmlId).onclick = this.selectSurface.bind(this, key);\n    }\n};\n\n\nInspectorLayers.prototype.buildBoundLayers = function(id) {\n    var view = this.views[this.currentView];\n    var html = '';\n\n    if (view.surfaces[id]) {\n        var layers = view.surfaces[id].layers;\n\n        for (var i = 0, li = layers.length; i < li; i++) {\n            var layer = layers[i];\n\n            html += '<div class=\"vts-layers-item\"><input id=\"vts-boundlayer-checkbox-' + layer.id + '\" type=\"checkbox\" ' + (layer.enabled ? 'checked' : '')   + '/>'\n                     + '<div class=\"vts-layers-name\">' + layer.id + '</div>'\n                     + '<input id=\"vts-boundlayer-spinner-' + layer.id + '\" type=\"number\" title=\"Alpha\" min=\"0\" max=\"100\" step=\"10\" value=\"' + layer.alpha + '\">'\n                     + '<button id=\"vts-boundlayer-obutton-' + layer.id + '\" type=\"button\" title=\"Options\">O</button>' \n                     + '<button id=\"vts-boundlayer-ubutton-' + layer.id + '\" type=\"button\" title=\"Move Above\">&uarr;</button>' \n                     + '<button id=\"vts-boundlayer-dbutton-' + layer.id + '\" type=\"button\" title=\"Move Bellow\">&darr;</button>' \n                     + '</div>';\n        }\n    }\n\n    this.boundLayersItems.innerHTML = html;\n\n    if (view.surfaces[id]) {\n        for (i = 0, li = layers.length; i < li; i++) {\n            var htmlId = 'vts-boundlayer-checkbox-' + layers[i].id;\n            document.getElementById(htmlId).onchange = this.switchBoundLayer.bind(this, layers[i].id, htmlId, 'enable');\n            htmlId = 'vts-boundlayer-spinner-' + layers[i].id;\n            document.getElementById(htmlId).onchange = this.switchBoundLayer.bind(this, layers[i].id, htmlId, 'alpha');\n            htmlId = 'vts-boundlayer-obutton-' + layers[i].id;\n            document.getElementById(htmlId).onclick = this.switchBoundLayer.bind(this, layers[i].id, htmlId, 'options');\n            htmlId = 'vts-boundlayer-ubutton-' + layers[i].id;\n            document.getElementById(htmlId).onclick = this.switchBoundLayer.bind(this, layers[i].id, htmlId, 'up');\n            htmlId = 'vts-boundlayer-dbutton-' + layers[i].id;\n            document.getElementById(htmlId).onclick = this.switchBoundLayer.bind(this, layers[i].id, htmlId, 'down');\n        }\n    }\n};\n\n\nInspectorLayers.prototype.buildFreeLayers = function() {\n    var view = this.views[this.currentView];\n    var layers = view.freeLayers;\n    var html = '';\n\n    for (var key in layers) {\n        //var layer = layers[key];\n        html += '<div class=\"vts-surface-item\" id=\"vts-freelayer-item-' + key\n                  + '\"><input id=\"vts-freelayer-checkbox-' + key + '\" type=\"checkbox\" '\n                  + (layers[key].enabled ? 'checked' : '') + '/><span title=' + key + '>' + key + '</span></div>';\n    }\n\n    this.freeLayersItems.innerHTML = html;\n\n    for (key in layers) {\n        var htmlId = 'vts-freelayer-checkbox-' + key;\n        document.getElementById(htmlId).onchange = this.switchFreeLayer.bind(this, key, htmlId);\n        htmlId = 'vts-freelayer-item-' + key;\n        document.getElementById(htmlId).onclick = this.selectFreeLayer.bind(this, key);\n    }\n};\n\n\nInspectorLayers.prototype.buildFreeLayerProperties = function(id) {\n    var map = this.core.getMap();\n    var view = this.views[this.currentView];\n    var layers = view.freeLayers[id].layers;\n    var html = '', i, li, htmlId;\n    \n    if (!map || !map.getFreeLayer(id)) {\n        return;\n    }\n\n    var layerInfo = map.getFreeLayer(id).getInfo();\n    var layerType = layerInfo['type']; \n\n    switch(layerType) {\n    case 'mesh':\n    case 'mesh-tiles':\n\n        html += '<div class=\"vts-layers-item\"><div class=\"vts-layers-name\" style=\"width:90px\">' + 'DepthOffset:' + '</div>'\n                     + '<input id=\"vts-fl-properties-depth-shift\" type=\"number\" min=\"-100\" max=\"100\" step=\"1\" value=\"' + view.freeLayers[id].depthShift + '\">'\n                     + '<input id=\"vts-fl-properties-depth-shift2\" type=\"number\" min=\"-100\" max=\"100\" step=\"1\" value=\"' + view.freeLayers[id].depthShift2 + '\">'\n                     + '<input id=\"vts-fl-properties-depth-shift3\" type=\"number\" min=\"-100\" max=\"100\" step=\"1\" value=\"' + view.freeLayers[id].depthShift3 + '\">'\n                     + '</div>';\n    \n        html += '<div class=\"vts-layers-item\"><div class=\"vts-layers-name\">' + 'BoundLayers:' + '</div></div>';\n        \n        for (i = 0, li = layers.length; i < li; i++) {\n            var layer = layers[i];\n        \n            html += '<div class=\"vts-layers-item\"><input id=\"vts-fl-properties-checkbox-' + layer.id + '\" type=\"checkbox\" ' + (layer.enabled ? 'checked' : '')   + '/>'\n                         + '<div class=\"vts-layers-name\">' + layer.id + '</div>'\n                         + '<input id=\"vts-fl-properties-spinner-' + layer.id + '\" type=\"number\" title=\"Alpha\" min=\"0\" max=\"100\" step=\"10\" value=\"' + layer.alpha + '\">'\n                         + '<button id=\"vts-fl-properties-ubutton-' + layer.id + '\" type=\"button\" title=\"Move Above\">&uarr;</button>' \n                         + '<button id=\"vts-fl-properties-dbutton-' + layer.id + '\" type=\"button\" title=\"Move Bellow\">&darr;</button>' \n                         + '</div>';\n        }\n        \n        this.freeLayersPropertiesItems.innerHTML = html;\n    \n        htmlId = 'vts-fl-properties-depth-shift';\n        document.getElementById(htmlId).onchange = this.switchFreeLayerProperty.bind(this, htmlId, 'depthShift');\n        htmlId = 'vts-fl-properties-depth-shift2';\n        document.getElementById(htmlId).onchange = this.switchFreeLayerProperty.bind(this, htmlId, 'depthShift2');\n        htmlId = 'vts-fl-properties-depth-shift3';\n        document.getElementById(htmlId).onchange = this.switchFreeLayerProperty.bind(this, htmlId, 'depthShift3');\n        \n        for (i = 0, li = layers.length; i < li; i++) {\n            htmlId = 'vts-fl-properties-checkbox-' + layers[i].id;\n            document.getElementById(htmlId).onchange = this.switchFreeLayerBoundLayer.bind(this, layers[i].id, htmlId, 'enable');\n            htmlId = 'vts-fl-properties-spinner-' + layers[i].id;\n            document.getElementById(htmlId).onchange = this.switchFreeLayerBoundLayer.bind(this, layers[i].id, htmlId, 'alpha');\n            htmlId = 'vts-fl-properties-ubutton-' + layers[i].id;\n            document.getElementById(htmlId).onclick = this.switchFreeLayerBoundLayer.bind(this, layers[i].id, htmlId, 'up');\n            htmlId = 'vts-fl-properties-dbutton-' + layers[i].id;\n            document.getElementById(htmlId).onclick = this.switchFreeLayerBoundLayer.bind(this, layers[i].id, htmlId, 'down');\n        }\n            \n        break;\n\n    case 'geodata':\n    case 'geodata-tiles':\n\n        html += '<div class=\"vts-layers-item\"><div class=\"vts-layers-name\" style=\"width:50px\">' + 'Style:' + '</div>'\n                    + '<select id=\"vts-layers-fl-properties-style\">';\n                    \n        var styles = map.getStylesheets();\n        var index = styles.indexOf(view.freeLayers[id].style || view.freeLayers[id].originalStyle); // || layerInfo[\"style\"]); \n            \n        for (i = 0, li = styles.length; i < li; i++) {\n            html += '<option value=\"' + styles[i] + '\" ' + ((i == index) ? 'selected' : '') + '>' + styles[i] + '</option>';\n        }\n                    \n        html += '</select>' + '</div>';\n\n        this.freeLayersPropertiesItems.innerHTML = html;\n\n        htmlId = 'vts-layers-fl-properties-style';\n        document.getElementById(htmlId).onchange = this.switchFreeLayerProperty.bind(this, htmlId, 'style');\n       \n        break;\n    }\n};\n\n\nInspectorLayers.prototype.selectView = function(id) {\n    if (!this.views[id]) {\n        return;\n    }\n\n    var element;\n\n    //deselect previous\n    if (this.currentView) {\n        element = document.getElementById('vts-views-item-' + this.currentView);\n        if (element) {\n            element.style.backgroundColor = 'initial';\n        }\n    }\n\n    //select new one\n    element = document.getElementById('vts-views-item-' + id);\n    element.style.backgroundColor = '#ddd';\n    this.currentView = id;\n    //this.buildBoundLayers(this.currentSurface);\n\n    this.buildSurfaces();\n    this.selectSurface(this.currentSurface);\n    this.buildFreeLayers();\n    this.applyMapView();\n};\n\n\nInspectorLayers.prototype.switchView = function(id, htmlId, action) {\n    //var element = document.getElementById(htmlId);\n    var views = this.views;\n    \n    for (var key in this.views) {\n        if (key == id) {\n            switch(action) {\n            case 'clone':\n                    //layers[i].enabled = element.checked;\n                var i = 2;\n                    \n                // eslint-disable-next-line\n                while(true) {\n                    if (!views[id + ' #' + i]) {\n                        views[id + ' #' + i] = JSON.parse(JSON.stringify(views[id]));\n                        break;\n                    } \n                    i++;\n                }\n                \n                this.buildViews();\n                    \n                break;\n            case 'remove':\n                \n                var count = 0;\n                \n                for (key in views) {\n                    count++;\n                }\n                \n                if (count > 1) {\n                    delete views[id];\n                    this.buildViews();\n\n                    if (this.currentView == id) {\n                        for (key in views) {\n                            this.selectView(key);\n                            break;\n                        }\n                    } else {\n                        this.selectView(this.currentView);\n                    }\n                }\n                    \n                break;\n            }\n            \n            break;\n        }\n    }\n};\n\n\nInspectorLayers.prototype.switchSurface = function(id, htmlId) {\n    var element = document.getElementById(htmlId);\n    var view = this.views[this.currentView];\n    view.surfaces[id].enabled = element.checked;\n    this.applyMapView();\n};\n\n\nInspectorLayers.prototype.selectSurface = function(id) {\n    var element;\n    //deselect previous\n    if (this.currentSurface) {\n        element = document.getElementById('vts-surface-item-' + this.currentSurface);\n        element.style.backgroundColor = 'initial';\n    }\n\n    //select new one\n    element = document.getElementById('vts-surface-item-' + id);\n    if (element) {\n        element.style.backgroundColor = '#ddd';\n    }\n    this.currentSurface = id;\n    this.buildBoundLayers(this.currentSurface);\n};\n\n\nInspectorLayers.prototype.switchBoundLayer = function(id, htmlId, action) {\n    var element = document.getElementById(htmlId);\n    var view = this.views[this.currentView];\n    var layers = view.surfaces[this.currentSurface].layers;\n    \n    for (var i = 0, li = layers.length; i < li; i++) {\n        if (layers[i].id == id) {\n            switch(action) {\n            case 'enable':\n                layers[i].enabled = element.checked;\n                break;\n            case 'alpha':\n                layers[i].alpha = parseInt(element.value, 10);\n                break;\n            case 'options':\n                //display popup               \n                break;\n            case 'up':\n                layers.splice(Math.max(0,i-1), 0, layers.splice(i, 1)[0]);\n                this.selectSurface(this.currentSurface);\n                break;\n            case 'down':\n                layers.splice(Math.max(0,i+1), 0, layers.splice(i, 1)[0]);\n                this.selectSurface(this.currentSurface);\n                break;\n            }\n            \n            break;\n        }\n    }\n    \n    this.applyMapView();\n};\n\n\nInspectorLayers.prototype.switchFreeLayer = function(id, htmlId) {\n    var element = document.getElementById(htmlId);\n    var view = this.views[this.currentView];\n    view.freeLayers[id].enabled = element.checked;\n    this.applyMapView();\n};\n\n\nInspectorLayers.prototype.selectFreeLayer = function(id) {\n    var element;\n    //deselect previous\n    if (this.currentFreeLayer) {\n        element = document.getElementById('vts-freelayer-item-' + this.currentFreeLayer);\n        element.style.backgroundColor = 'initial';\n    }\n\n    //select new one\n    element = document.getElementById('vts-freelayer-item-' + id);\n    element.style.backgroundColor = '#ddd';\n    this.currentFreeLayer = id;\n    this.buildFreeLayerProperties(this.currentFreeLayer);\n};\n\n\nInspectorLayers.prototype.switchFreeLayerBoundLayer = function(id, htmlId, action) {\n    var element = document.getElementById(htmlId);\n    var view = this.views[this.currentView];\n    var layers = view.freeLayers[this.currentFreeLayer].layers;\n    \n    for (var i = 0, li = layers.length; i < li; i++) {\n        if (layers[i].id == id) {\n            switch(action) {\n            case 'enable':\n                layers[i].enabled = element.checked;\n                break;\n            case 'alpha':\n                layers[i].alpha = parseInt(element.value, 10);\n                break;\n            case 'up':\n                layers.splice(Math.max(0,i-1), 0, layers.splice(i, 1)[0]);\n                this.selectFreeLayer(this.currentFreeLayer);\n                break;\n            case 'down':\n                layers.splice(Math.max(0,i+1), 0, layers.splice(i, 1)[0]);\n                this.selectFreeLayer(this.currentFreeLayer);\n                break;\n            }\n            \n            break;\n        }\n    }\n    \n    this.applyMapView();\n};\n\n\nInspectorLayers.prototype.switchFreeLayerProperty = function(htmlId, action) {\n    var element = document.getElementById(htmlId);\n    var view = this.views[this.currentView];\n    var layer = view.freeLayers[this.currentFreeLayer];\n\n    switch(action) {\n    case 'depthShift':  layer.depthShift = parseInt(element.value, 10); break;\n    case 'depthShift2': layer.depthShift2 = parseInt(element.value, 10); break;\n    case 'depthShift3': layer.depthShift3 = parseInt(element.value, 10); break;\n    case 'style':       layer.style = element.value; break;\n    }\n    \n    this.applyMapView();\n};\n\n\nInspectorLayers.prototype.applyMapView = function(jsonOnly) {\n    var view = {\n        'surfaces' : {},\n        'freeLayers' : {},\n        'options' : {}\n    };\n\n    var sourceView = this.views[this.currentView];\n    var surfaces = sourceView.surfaces, i, li, layers;\n\n    view['options'] = JSON.parse(JSON.stringify(sourceView.options));\n    \n    for (var key in surfaces) {\n        if (surfaces[key].enabled) {\n            var surfaceBoundLayers = [];\n            layers = surfaces[key].layers; //bound layers\n            \n            for (i = 0, li = layers.length; i < li; i++) {\n                if (layers[i].enabled) {\n\n                    var options = JSON.parse(JSON.stringify(layers[i].options));\n                    var options2 = JSON.stringify(options);\n\n                    if (layers[i].alpha < 100) {\n                        var item = {'id':layers[i].id, 'alpha':(layers[i].alpha*0.01).toFixed(2)};\n                        if (options2 != '{}') {\n                            item.options = options;\n                        }\n                        surfaceBoundLayers.push(item);\n                    } else {\n                        surfaceBoundLayers.push(layers[i].id);\n                    }\n                }\n            }\n            \n            view['surfaces'][key] = surfaceBoundLayers;\n        }\n    }\n\n    var freeLayers = sourceView.freeLayers;\n    \n    for (key in freeLayers) {\n        if (freeLayers[key].enabled) {\n            var freeLayerBoundLayers = [];\n            layers = freeLayers[key].layers; //bound layers\n            \n            for (i = 0, li = layers.length; i < li; i++) {\n                if (layers[i].enabled) {\n                    \n                    if (layers[i].alpha < 100) {\n                        var item = {'id':layers[i].id, 'alpha':(layers[i].alpha*0.01).toFixed(2)};\n                        if (options2 != '{}') {\n                            item.options = options;\n                        }\n                        freeLayerBoundLayers.push(item);\n                    } else {\n                        freeLayerBoundLayers.push(layers[i].id);\n                    }\n                }\n            }\n            \n            view['freeLayers'][key] = {};\n            \n            if (freeLayerBoundLayers.length > 0) {\n                view['freeLayers'][key]['boundLayers'] = freeLayerBoundLayers;\n            }\n\n            if (freeLayers[key].style && freeLayers[key].style != freeLayers[key].originalStyle) {\n                view['freeLayers'][key]['style'] = freeLayers[key].style;\n            }\n            \n            if (!(freeLayers[key].depthShift == 0 && freeLayers[key].depthShift2 == 0 && freeLayers[key].depthShift3 == 0)) {\n                view['freeLayers'][key]['depthOffset'] = [\n                    parseFloat((freeLayers[key].depthShift).toFixed(2)),\n                    parseFloat((freeLayers[key].depthShift2).toFixed(2)),\n                    parseFloat((freeLayers[key].depthShift3).toFixed(2)) ];\n            } \n            \n        }\n    }\n\n    this.jsonText.value = JSON.stringify(view, null, '  ');\n    this.jsonText2.value = encodeURIComponent(JSON.stringify(view));\n\n    if (!jsonOnly) {\n        var map = this.core.getMap();\n        if (!map) {\n            return;\n        }\n        \n        map.setView(view, null, true);\n    }\n};\n\n\nInspectorLayers.prototype.showPanel = function() {\n    this.element.style.display = 'block';\n    this.panelVisible = true;\n    this.updatePanel();\n};\n\n\nInspectorLayers.prototype.hidePanel = function() {\n    this.element.style.display = 'none';\n    this.panelVisible = false;\n};\n\n\nInspectorLayers.prototype.switchPanel = function() {\n    if (this.panelVisible) {\n        this.hidePanel();\n    } else {\n        this.showPanel();\n    }\n};\n\n\nInspectorLayers.prototype.updatePanel = function() {\n    if (!this.panelInitialized) {\n        this.panelInitialized = false;\n        this.initViews();\n        this.buildViews();\n        this.selectView(this.currentView);\n        /*\n        this.buildSurfaces();\n        this.selectSurface(this.currentSurface);\n        this.buildFreeLayers();\n        this.applyMapView(true);\n        */\n    }\n};\n\n\nexport default InspectorLayers;\n","\nimport GpuTexture_ from '../renderer/gpu/texture';\nimport {math as math_} from '../utils/math';\nimport {vec3 as vec3_, mat4 as mat4_} from '../utils/matrix';\n\n//get rid of compiler mess\nvar math = math_;\nvar GpuTexture = GpuTexture_;\nvar vec3 = vec3_, mat4 = mat4_;\n\n\nvar InspectorReplay = function(inspector) {\n    this.inspector = inspector;\n    this.core = inspector.core;\n};\n\n\nInspectorReplay.prototype.init = function() {\n    var inspector = this.inspector;\n    inspector.addStyle(\n        '#vts-replay-panel {'\n            + 'font-family: Arial, \\'Helvetica Neue\\', Helvetica, sans-serif;'\n            + 'display: none;'\n            + 'padding:15px;'\n            + 'width: 618px;'\n            + 'font-size: 14px;'\n            + 'position: absolute;'\n            + 'right: 10px;'\n            + 'top: 10px;'\n            + 'cursor: default;'\n            + 'background-color: rgba(255,255,255,0.95);'\n            + 'border-radius: 5px;'\n            + 'border: solid 1px #ccc;'\n            + 'text-align: left;'\n            + 'z-index: 7;'\n            + 'padding: 10px;'\n        + '}'\n\n        + '#vts-replay-panel-left {'\n            + 'width: 253px;'\n            + 'height: 100%;'\n            + 'float: left;'\n        + '}'\n\n        + '#vts-replay-panel-right {'\n            + 'width: 340px;'\n            + 'height: 100%;'\n            + 'float: right;'\n        + '}'\n\n        + '#vts-replay-items {'\n            + 'width: 240px;'\n            + 'overflow-x: hidden;'\n            + 'border: 1px solid #ddd;'\n            + 'padding-right: 5px;'\n        + '}'\n\n        + '.vts-replay-item {'\n            + 'width: 100%;'\n            + 'overflow: hidden;'\n            + 'text-overflow: ellipsis;'\n            + 'white-space: nowrap;'    \n        + '}' \n\n        + '#vts-replay-lod-slider {'\n            + 'width: 240px;'\n        + '}'\n\n        + '#vts-replay-lod-text {'\n            + 'width: 60px;'\n            + 'margin-left: 10px;'\n            + 'margin-right: 10px;'\n        + '}'\n\n        + '#vts-replay-lod-single {'\n            + 'margin-left: 10px;'\n        + '}'\n    \n        + '#vts-replay-time-slider {'\n            + 'width: 330px;'\n        + '}'\n\n        + '#vts-replay-time-text {'\n            + 'width: 60px;'\n            + 'margin-left: 10px;'\n            + 'margin-right: 10px;'\n        + '}'\n\n        + '#vts-replay-time-single {'\n            + 'margin-left: 10px;'\n        + '}'\n\n        + '#vts-replay-panel-gtime canvas{'\n            + 'border: 1px solid #555;'\n        + '}'\n\n        + '#vts-replay-panel-gtime span{'\n            + 'font-size: 10px;'\n        + '}'\n\n        + '#vts-replay-info {'\n            + 'width: 240px;'\n            + 'height: 140px;'\n            + 'overflow-x: hidden;'\n            + 'border: 1px solid #ddd;'\n            + 'padding-right: 5px;'\n            + 'margin-top: 10px;'            \n            + 'font-size: 12px;'\n            + 'word-wrap: break-word;'   \n        + '}'\n       \n    );\n\n    this.element = document.createElement('div');\n    this.element.id = 'vts-replay-panel';\n    this.element.innerHTML =\n            '<div id=\"vts-replay-panel-left\">'\n            + '<div id=\"vts-replay-items\"></div>'\n            + '<div id=\"vts-replay-panel-lod\">'  \n                + '<input id=\"vts-replay-lod-slider\" type=\"range\" min=\"0\" max=\"30\" step=\"1\" value=\"30\" /><br/>'\n                + '<span>LOD:</span>'\n                + '<input id=\"vts-replay-lod-text\" type=\"text\" value=\"30\"/>'\n                + '<input id=\"vts-replay-lod-up\" type=\"button\" value=\"<\"/>'\n                + '<input id=\"vts-replay-lod-down\" type=\"button\" value=\">\"/>'\n                + '<input id=\"vts-replay-lod-single\" type=\"checkbox\"/>'\n                + '<span>Single</span>'\n            + '</div>'\n            + '<div id=\"vts-replay-info\"></div>'\n          + '</div>'\n          + '<div id=\"vts-replay-panel-right\">'\n            + '<div id=\"vts-replay-panel-gtime\">'  \n                + '<span id=\"vts-replay-info-meshes\">Meshes Count: 0 Min/Max: 0/0 Avg. 0</span><br/>'\n                + '<canvas id=\"vts-replay-canvas-meshes\" width=340 height=30></canvas><br/>'  \n                + '<span id=\"vts-replay-info-textures\">Internal Textures Count: 0 Min/Max: 0/0 Avg. 0</span><br/>'\n                + '<canvas id=\"vts-replay-canvas-textures\" width=340 height=30></canvas><br/>'  \n                + '<span id=\"vts-replay-info-textures2\">External Textures Count: 0 Min/Max: 0/0 Avg. 0</span><br/>'\n                + '<canvas id=\"vts-replay-canvas-textures2\" width=340 height=30></canvas><br/>'  \n                + '<span id=\"vts-replay-info-geodata\">Geodata Count: 0 Min/Max: 0/0 Avg. 0</span><br/>'\n                + '<canvas id=\"vts-replay-canvas-geodata\" width=340 height=30></canvas><br/>'  \n                + '<span id=\"vts-replay-info-metatiles\">Metatiles Count: 0 Min/Max: 0/0 Avg. 0</span><br/>'\n                + '<canvas id=\"vts-replay-canvas-metatiles\" width=340 height=30></canvas><br/>'  \n                + '<span id=\"vts-replay-info-intervals\">Interval Count: 0 Min/Max: 0/0 Avg. 0</span><br/>'\n                + '<canvas id=\"vts-replay-canvas-intervals\" width=340 height=30></canvas><br/>'  \n                + '<span id=\"vts-replay-info-threads\">Threads Min/Max: 0/0 Avg. 0 </span><br/>'\n                + '<canvas id=\"vts-replay-canvas-threads\" width=340 height=30></canvas><br/>'  \n            + '</div>'\n\n            + '<div id=\"vts-replay-panel-time\">'  \n                + '<input id=\"vts-replay-time-slider\" type=\"range\" min=\"0\" max=\"2000\" value=\"0\" /><br/>'\n                + '<span>File:</span>'\n                + '<input id=\"vts-replay-time-text\" type=\"text\" value=\"0\"/>'\n                + '<input id=\"vts-replay-time-up\" type=\"button\" value=\"<\"/>'\n                + '<input id=\"vts-replay-time-down\" type=\"button\" value=\">\"/>'\n                + '<input id=\"vts-replay-time-single\" type=\"checkbox\"/>'\n                + '<span>Single</span>'\n            + '</div>'\n          + '</div>';\n\n    this.core.element.appendChild(this.element);\n\n    this.items = document.getElementById('vts-replay-items');\n\n    this.lodSlider = document.getElementById('vts-replay-lod-slider');\n    this.lodSlider.onchange = this.onSliderChange.bind(this, 'lod');\n    this.lodSlider.oninput = this.onSliderChange.bind(this, 'lod');\n\n    this.lodText = document.getElementById('vts-replay-lod-text');\n    this.lodText.onchange = this.onTextChange.bind(this, 'lod');\n    \n    document.getElementById('vts-replay-lod-up').onclick = this.onSliderChange.bind(this, 'lod', 'down');\n    document.getElementById('vts-replay-lod-down').onclick = this.onSliderChange.bind(this, 'lod', 'up');\n    document.getElementById('vts-replay-lod-single').onclick = this.onSliderChange.bind(this, 'lod', 'single');\n    \n    this.timeSlider = document.getElementById('vts-replay-time-slider');\n    this.timeSlider.onchange = this.onSliderChange.bind(this, 'time');\n    this.timeSlider.oninput = this.onSliderChange.bind(this, 'time');\n\n    this.timeText = document.getElementById('vts-replay-time-text');\n    this.timeText.onchange = this.onTextChange.bind(this, 'time');\n\n    this.timeInfo = document.getElementById('vts-replay-info');\n\n    document.getElementById('vts-replay-time-up').onclick = this.onSliderChange.bind(this, 'time', 'down');\n    document.getElementById('vts-replay-time-down').onclick = this.onSliderChange.bind(this, 'time', 'up');\n    document.getElementById('vts-replay-time-single').onclick = this.onSliderChange.bind(this, 'time', 'single');\n\n    this.element.addEventListener('mouseup', inspector.doNothing.bind(this), true);\n    this.element.addEventListener('mousedown', inspector.doNothing.bind(this), true);\n    this.element.addEventListener('mousewheel', inspector.doNothing.bind(this), false);\n    this.element.addEventListener('dblclick', inspector.doNothing.bind(this), false);\n\n    this.infoMeshes = document.getElementById('vts-replay-info-meshes');\n    this.ctxMeshes = document.getElementById('vts-replay-canvas-meshes').getContext('2d');  \n    this.infoTextures = document.getElementById('vts-replay-info-textures');\n    this.ctxTextures = document.getElementById('vts-replay-canvas-textures').getContext('2d');  \n    this.infoTextures2 = document.getElementById('vts-replay-info-textures2');\n    this.ctxTextures2 = document.getElementById('vts-replay-canvas-textures2').getContext('2d');  \n    this.infoGeodata = document.getElementById('vts-replay-info-geodata');\n    this.ctxGeodata = document.getElementById('vts-replay-canvas-geodata').getContext('2d');  \n    this.infoMetatiles = document.getElementById('vts-replay-info-metatiles');\n    this.ctxMetatiles = document.getElementById('vts-replay-canvas-metatiles').getContext('2d');  \n    this.infoIntervals = document.getElementById('vts-replay-info-intervals');\n    this.ctxIntervals = document.getElementById('vts-replay-canvas-intervals').getContext('2d');  \n    this.infoThreads = document.getElementById('vts-replay-info-threads');\n    this.ctxThreads = document.getElementById('vts-replay-canvas-threads').getContext('2d');  \n\n    this.cameraLines = [];\n    this.cameraLines2 = [];\n    this.cameraLines3 = [];\n    this.cameraGenarated = false;\n\n    this.panelVisible = false;\n};\n\n\nInspectorReplay.prototype.showPanel = function() {\n    this.buildReplayCombo();\n    this.element.style.display = 'block';\n    this.panelVisible = true;\n\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var replay = map.draw.replay;\n    this.updateFileInfo(replay.loadedIndex);\n    this.updateLoadGraphs();\n};\n\n\nInspectorReplay.prototype.hidePanel = function() {\n    this.element.style.display = 'none';\n    this.panelVisible = false;\n};\n\n\nInspectorReplay.prototype.switchPanel = function() {\n    if (this.panelVisible) {\n        this.hidePanel();\n    } else {\n        this.showPanel();\n    }\n};\n\n\nInspectorReplay.prototype.onSliderChange = function(type, button) {\n    if (type == 'lod') {\n        switch (button) {\n        case 'up':\n            this.lodSlider.stepUp();\n            this.lodText.value = this.lodSlider.value;    \n            break;\n            \n        case 'down':\n            this.lodSlider.stepDown();\n            this.lodText.value = this.lodSlider.value;    \n            break;\n\n        default:\n            this.lodText.value = this.lodSlider.value;    \n        } \n    } else {\n        switch (button) {\n        case 'up':\n            this.timeSlider.stepUp();\n            this.timeText.value = this.timeSlider.value;    \n            break;\n            \n        case 'down':\n            this.timeSlider.stepDown();\n            this.timeText.value = this.timeSlider.value;    \n            break;\n\n        default:\n            this.timeText.value = this.timeSlider.value;    \n        } \n    }\n\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var replay = map.draw.replay;\n\n    if (type == 'lod') {\n        replay.lod = parseFloat(this.lodText.value);\n        replay.singleLod = document.getElementById('vts-replay-lod-single').checked;\n    } else {\n        replay.loadedIndex = parseFloat(this.timeText.value);\n        replay.singleLodedIndex = document.getElementById('vts-replay-time-single').checked;\n        this.updateFileInfo(replay.loadedIndex);\n        this.updateLoadGraphs();\n    }\n\n    map.markDirty();\n};\n\n\nInspectorReplay.prototype.onTextChange = function(type) {\n    if (type == 'lod') {\n        this.lodSlider.value = this.lodText.value;    \n    } else {\n        this.timeSlider.value = this.timeText.value;    \n    }\n\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var replay = map.draw.replay;\n\n    if (type == 'lod') {\n        replay.lod = parseFloat(this.lodText.value);\n    } else {\n        replay.loadedIndex = parseFloat(this.timeText.value);\n        this.updateFileInfo(replay.loadedIndex);\n        this.updateLoadGraphs();\n    }\n\n    map.markDirty();\n};\n\n\nInspectorReplay.prototype.generateCameraLines = function(camera) {\n    var renderer = this.core.getRendererInterface();\n    var p1 = camera.position;\n    var p2 = camera.center;\n\n    this.cameraLines = [p1, p2];\n/*        \n    var screenSize = renderer.getCanvasSize();\n    \n    var v1 = map.getScreenRay(0+1,0+1);\n    var v2 = map.getScreenRay(screenSize[0]-1,0+1);\n    var v3 = map.getScreenRay(screenSize[0]-1,screenSize[1]-1);\n    var v4 = map.getScreenRay(0+1,screenSize[1]-1);\n    var v5 = map.getScreenRay(screenSize[0]*0.5,screenSize[1]*0.5);\n    \n    var l = camera.distance;\n    \n    //l = map.getPositionViewExtent(pos);    \n    \n    vec3.scale(v1, l*10);\n    //vec3.scale(v2, l);\n    //vec3.scale(v3, l);\n    //vec3.scale(v4, l);\n    //vec3.scale(v5, l);\n    \n    vec3.add(v1, p1);\n    //vec3.add(v2, p1);\n    //vec3.add(v3, p1);\n    //vec3.add(v4, p1);\n    //vec3.add(v5, p1);\n\n    this.cameraLines3 = [p1, v1]; //, p1, v2, p1, v3, p1, v4, v1, v2, v3, v4];//, v5, p1];\n    */\n/*\n    this.cameraLines2 = [p1];\n    \n    for (var y = 0; y < screenSize[1]*0.5; y += 100) {\n        for (var x = screenSize[0]*0.5; x < screenSize[0]; x += 100) {\n\n            var v1 = map.getScreenRay(x,y);\n            vec3.scale(v1, l);\n            vec3.add(v1, p1);\n            \n            this.cameraLines2.push(v1);\n        }\n    }    \n*/\n    this.cameraLines2 = [[p1], [p1], [p1], [p1]];\n    \n    var segments = 16;\n\n    var map2 = this.core.getMap();\n\n    var m2 = map2.camera.getRotationviewMatrix();\n    var m = mat4.create();\n    mat4.inverse(m2, m);\n    \n    this.cameraMatrix = m;\n    \n    var a = Math.tan(math.radians(map2.camera.getFov()));\n    var b = a * map2.camera.getAspect();\n    var c = Math.sqrt(a*a + b*b);\n    \n    var dfov = Math.atan(c/1);\n    \n    var l = camera.cameraDistance / segments;\n    var l2 = 0.5 * l * Math.tan(dfov);\n    var l3 = l2 * map2.camera.getAspect();\n    var v1, v2, v3, v4;\n\n    for (var i = 0; i < segments; i++) {\n        v1 = [-l3, -l2, -l];\n        v2 = [l3, -l2, -l];\n        v3 = [l3, l2, -l];\n        v4 = [-l3, l2, -l];\n\n        vec3.scale(v1, (i+1));\n        vec3.scale(v2, (i+1));\n        vec3.scale(v3, (i+1));\n        vec3.scale(v4, (i+1));\n        \n        mat4.multiplyVec3(m, v1);\n        mat4.multiplyVec3(m, v2);\n        mat4.multiplyVec3(m, v3);\n        mat4.multiplyVec3(m, v4);\n    \n        vec3.add(v1, p1);\n        vec3.add(v2, p1);\n        vec3.add(v3, p1);\n        vec3.add(v4, p1);\n        \n        this.cameraLines2[0].push(v1);\n        this.cameraLines2[1].push(v2);\n        this.cameraLines2[2].push(v3);\n        this.cameraLines2[3].push(v4);\n    }\n    \n    this.cameraLines3 = [[p1], [p1], [p1], [p1]];\n\n    segments = 256;\n    l = (camera.distance + 12742000 * 1.1) / segments;\n    //l = (camera.distance * 20.1) / segments;\n    l2 = 0.5 * l * Math.tan(dfov);\n    l3 = l2 * map2.camera.getAspect();\n    \n    for (i = 0; i < segments; i++) {\n        v1 = [-l3, -l2, -l];\n        v2 = [l3, -l2, -l];\n        v3 = [l3, l2, -l];\n        v4 = [-l3, l2, -l];\n\n        vec3.scale(v1, (i+1));\n        vec3.scale(v2, (i+1));\n        vec3.scale(v3, (i+1));\n        vec3.scale(v4, (i+1));\n        \n        mat4.multiplyVec3(m, v1);\n        mat4.multiplyVec3(m, v2);\n        mat4.multiplyVec3(m, v3);\n        mat4.multiplyVec3(m, v4);\n    \n        vec3.add(v1, p1);\n        vec3.add(v2, p1);\n        vec3.add(v3, p1);\n        vec3.add(v4, p1);\n        \n        this.cameraLines3[0].push(v1);\n        this.cameraLines3[1].push(v2);\n        this.cameraLines3[2].push(v3);\n        this.cameraLines3[3].push(v4);\n    }\n\n    v1 = [-l3, -l2, -l];\n    v2 = [l3, -l2, -l];\n    v3 = [l3, l2, -l];\n    v4 = [-l3, l2, -l];\n\n    vec3.scale(v1, segments);\n    vec3.scale(v2, segments);\n    vec3.scale(v3, segments);\n    vec3.scale(v4, segments);\n    \n    p1 = [0,0,0];\n    \n    var vertices = [ p1[0], p1[1], p1[2],\n        v1[0], v1[1], v1[2],\n        v2[0], v2[1], v2[2],\n\n        p1[0], p1[1], p1[2],\n        v2[0], v2[1], v2[2],\n        v3[0], v3[1], v3[2],\n\n        p1[0], p1[1], p1[2],\n        v3[0], v3[1], v3[2],\n        v4[0], v4[1], v4[2],\n\n        p1[0], p1[1], p1[2],\n        v4[0], v4[1], v4[2],\n        v1[0], v1[1], v1[2]\n    ];\n                      \n    var uvs = [ 0,0, 0,0, 0,0,\n        0,0, 0,0, 0,0,\n        0,0, 0,0, 0,0,\n        0,0, 0,0, 0,0 ];\n\n    var normals = [ 0,0,1, 0,0,1, 0,0,1,\n        0,0,1, 0,0,1, 0,0,1,\n        0,0,1, 0,0,1, 0,0,1,\n        0,0,1, 0,0,1, 0,0,1 ];\n\n    this.frustumState = renderer.createState({\n        'blend' : true,\n        'zwrite' : false,\n        'ztest' : true,\n        'culling' : false\n    });\n    \n    this.frustumMesh = renderer.createMesh({ 'vertices': vertices, 'uvs': uvs, 'normals': normals });\n    this.cameraGenarated = true;\n};\n\n\nInspectorReplay.prototype.itemButton = function(item, button) {\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var replay = map.draw.replay;    \n    \n    switch (item) {\n    case 'DrawnTiles':\n        replay.storeTiles = true;\n        break;\n\n    case 'DrawnTilesFreeLayers':\n        replay.storeFreeTiles = true;\n        break;\n\n    case 'TracedNodes':\n        replay.storeNodes = true;\n        break;\n\n    case 'TracedNodesFreeLayers':\n        replay.storeFreeNodes = true;\n        break;\n\n    case 'LoadSequence':\n        replay.storeLoaded = (button == 'S');\n\n        if (button == 'S') {\n            replay.loadedIndex = 0;\n            replay.loaded = [];\n        } else {\n            this.updateFileInfo(replay.loadedIndex);\n            this.updateLoadGraphs();\n        }\n        break;\n\n    case 'Camera':\n\n        if (button == 'S') {\n            var camera = replay.camera = {\n                distance : map.camera.distance,\n                position : map.camera.position.slice(),\n                vector : map.camera.vector.slice(),\n                center : map.camera.center.slice(),\n                height : map.camera.height\n            };\n\n            replay.cameraPos = map.getPosition();\n            this.generateCameraLines(camera);\n        } else {\n            if (replay.cameraPos) {\n                map.setPosition(replay.cameraPos);\n            }\n        }\n\n        break;\n            \n    case 'Globe':\n                        \n        break;\n    }\n\n    map.markDirty();\n};\n\n\nInspectorReplay.prototype.switchItem = function(item, htmlId) {\n    var element = document.getElementById(htmlId);\n    //element.checked;\n    //this.applyMapView();\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var replay = map.draw.replay;\n\n    switch (item) {\n    case 'DrawnTiles':\n        replay.drawTiles = element.checked;\n        break;\n\n    case 'DrawnTilesFreeLayers':\n        replay.drawFreeTiles = element.checked;\n        break;\n\n    case 'TracedNodes':\n        replay.drawNodes = element.checked;\n        break;\n\n    case 'TracedNodesFreeLayers':\n        replay.drawFreeNodes = element.checked;\n        break;\n\n    case 'LoadSequence':\n        replay.drawLoaded = element.checked;\n        break;\n\n    case 'Camera':\n        \n        if (!this.cameraGenarated) {\n            this.itemButton('Camera');\n        }\n        \n        this.drawCamera = element.checked;\n        break;\n            \n    case 'Globe':\n        var renderer = this.core.getRenderer();\n        \n        if (!this.globeTexture) {\n            var texture = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAgAAAAEACAMAAADyTj5VAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo0Mzk4RkVFMzlGNjUxMUU2OTBDM0I0OEM1NjU0RURBMyIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo0Mzk4RkVFNDlGNjUxMUU2OTBDM0I0OEM1NjU0RURBMyI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjQzOThGRUUxOUY2NTExRTY5MEMzQjQ4QzU2NTRFREEzIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjQzOThGRUUyOUY2NTExRTY5MEMzQjQ4QzU2NTRFREEzIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+5rvbhAAAAAZQTFRFwcHBLS0tMDfv/wAAAiZJREFUeNrs2LENAEEIA0HTf9ME5DTgIZn8ta+TnLjymzuW6kMIwIcQgA8hAAqAAmBdAM4O4E/wBPgQAqAAKAAKgAKgHcDZAegJoAAoAAqAAqAAaAdwdgB6AigACoACoAAoANoBnB2AngAKgAKgACgACoB2AGcHoCeAAqAAKAAKgAKgHcDZAegJoAAoAAqAAqAAaAdwdgB6AigACoACoAAoANoBnB2AngAKgAKgACgACoB2AGcHoCeAAqAAKAAKgAKgHcDZAegJoAAoAAqAAqAAaAdwdgB6AigACoACEIAPIQAfwg7g7AD0BFAAFAAFQAFQALQDODsAPQEUAAVAAVAAFADtAM4OQE8ABUABUAAUAAVAO4CzA9ATQAFQABQABUAB0A7g7AD0BFAAFAAFQAFQALQDODsAPQEUAAVAAVAAFADtAM4OQE8ABUABUAAUAAVAO4CzA9ATQAFQABQABUAB0A7g7AD0BFAAFAAFQAFQALQDODsAPQEUAAVAAVAAFADtAM4OQE8ABSAAH0IAPoQAfAgB0A7g7AD0BFAAFAAFQAFQALQDODsAPQEUAAVAAVAAFADtAM4OQE8ABUABUAAUAAVAO4CzA9ATQAFQABQABUAB0A7g7AD0BFAAFAAFQAFQALQDODsAPQEUAAVAAVAAFADtAM4OQE8ABUABUAAUAAVAO4CzA9ATQAFQABQABUAB0A7g7AD0BFAAFAAFQAFQAPxcAQYAZt2IEFFJhxsAAAAASUVORK5CYII=';        \n            this.globeTexture = new GpuTexture(renderer.gpu, texture, this.core, null, true);\n        }\n\n        this.drawGlobe = element.checked;\n        this.drawGlobe = this.drawGlobe;\n        break;\n    }\n\n    map.markDirty();\n};\n\n\nInspectorReplay.prototype.updateLoadGraphs = function() {\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var replay = map.draw.replay;\n    var loaded = replay.loaded;\n    var index = replay.loadedIndex;\n\n    this.timeSlider.max = loaded.length; \n\n    var ctx;   \n    var lx = 340;\n    var ly = 30;\n\n    this.ctxMeshes.fillStyle = '#000000';\n    this.ctxMeshes.fillRect(0, 0, lx, ly);\n    this.ctxTextures.fillStyle = '#000000';\n    this.ctxTextures.fillRect(0, 0, lx, ly);\n    this.ctxTextures2.fillStyle = '#000000';\n    this.ctxTextures2.fillRect(0, 0, lx, ly);\n    this.ctxGeodata.fillStyle = '#000000';\n    this.ctxGeodata.fillRect(0, 0, lx, ly);\n    this.ctxMetatiles.fillStyle = '#000000';\n    this.ctxMetatiles.fillRect(0, 0, lx, ly);\n    this.ctxIntervals.fillStyle = '#000000';\n    this.ctxIntervals.fillRect(0, 0, lx, ly);\n    this.ctxThreads.fillStyle = '#000000';\n    this.ctxThreads.fillRect(0, 0, lx, ly);\n\n    var i = Math.floor(replay.loadedIndex / lx) * lx, li = (lx-1);\n    var shift = i, file;\n    \n    for (i = 0; i < li; i++) {\n        file = loaded[i + shift];\n        \n        if (file) {\n            switch(file.kind) {\n            case 'mesh':       ctx = this.ctxMeshes; break;\n            case 'texture-in': ctx = this.ctxTextures; break;\n            case 'texture-ex': ctx = this.ctxTextures2; break;\n            case 'geodata':    ctx = this.ctxGeodata; break;\n            case 'metatile':   ctx = this.ctxMetatiles; break;\n            default:\n                continue;\n            }\n\n            var grey = Math.round(Math.min(255, 60+20 * Math.max(1, file.duration / 300)));\n            ctx.fillStyle='rgb('+grey+','+grey+','+grey+')';\n\n            var h = (file.duration / 300) * 30;                 \n            ctx.fillRect(i, ly, 1, -h);\n\n            //interval\n            grey = Math.round(Math.min(255, 60+20 * Math.max(1, file.interval / 300)));\n            this.ctxIntervals.fillStyle='rgb('+grey+','+grey+','+grey+')';\n            h = (file.interval / 300) * 30;                 \n            this.ctxIntervals.fillRect(i, ly, 1, -h);\n\n            //interval\n            this.ctxThreads.fillStyle='rgb(80,80,80)';\n            h = (file.threads / map.config.mapDownloadThreads) * 30;                 \n            this.ctxThreads.fillRect(i, ly, 1, -h);\n        }\n    }\n\n    var minMeshes = Number.MAX_VALUE, maxMeshes = 0, avgMeshes = 0, avgMeshesCount = 0;\n    var minTextures = Number.MAX_VALUE, maxTextures = 0, avgTextures = 0, avgTexturesCount = 0;\n    var minTextures2 = Number.MAX_VALUE, maxTextures2 = 0, avgTextures2 = 0, avgTextures2Count = 0;\n    var minGeodata = Number.MAX_VALUE, maxGeodata = 0, avgGeodata = 0, avgGeodataCount = 0;\n    var minMetatiles = Number.MAX_VALUE, maxMetatiles = 0, avgMetatiles = 0, avgMetatilesCount = 0;\n    var minThreads = Number.MAX_VALUE, maxThreads = 0, avgThreads = 0, avgThreadsCount = 0;\n    var minIntervals = Number.MAX_VALUE, maxIntervals = 0, avgIntervals = 0, avgIntervalsCount = 0;\n    \n    li = loaded.length;\n\n    for (i = 0; i < li; i++) {\n        file = loaded[i];\n        \n        if (file) {\n            \n            switch(file.kind) {\n            case 'mesh':\n                if (file.duration < minMeshes) minMeshes = file.duration; \n                if (file.duration > maxMeshes) maxMeshes = file.duration; \n                avgMeshes += file.duration;\n                avgMeshesCount++;  \n                break;\n                    \n            case 'texture-in':\n                if (file.duration < minTextures) minTextures = file.duration; \n                if (file.duration > maxTextures) maxTextures = file.duration; \n                avgTextures += file.duration;\n                avgTexturesCount++;  \n                break;\n                    \n            case 'texture-ex':\n                if (file.duration < minTextures2) minTextures2 = file.duration; \n                if (file.duration > maxTextures2) maxTextures2 = file.duration; \n                avgTextures2 += file.duration;\n                avgTextures2Count++;  \n                break;\n                    \n            case 'geodata':\n                if (file.duration < minGeodata) minGeodata = file.duration; \n                if (file.duration > maxGeodata) maxGeodata = file.duration; \n                avgGeodata += file.duration;\n                avgGeodataCount++;  \n                break;\n                    \n            case 'metatile':\n                if (file.duration < minMetatiles) minMetatiles = file.duration; \n                if (file.duration > maxMetatiles) maxMetatiles = file.duration; \n                avgMetatiles += file.duration;\n                avgMetatilesCount++;  \n                break;\n\n            default:\n                continue;\n            }\n                \n            if (file.threads < minThreads) minThreads = file.threads; \n            if (file.threads > maxThreads) maxThreads = file.threads; \n            avgThreads += file.threads;\n            avgThreadsCount++;  \n\n            if (file.threads < minIntervals) minIntervals = file.threads; \n            if (file.threads > maxIntervals) maxIntervals = file.threads; \n            avgIntervals += file.threads;\n            avgIntervalsCount++;  \n        }\n    }\n    \n    index -= shift;\n\n    this.ctxMeshes.fillStyle = '#ff0000';\n    this.ctxMeshes.fillRect(index - 1, 0, 1, ly);\n    this.ctxMeshes.fillRect(index + 1, 0, 1, ly);\n    this.ctxTextures.fillStyle = '#ff0000';\n    this.ctxTextures.fillRect(index - 1, 0, 1, ly);\n    this.ctxTextures.fillRect(index + 1, 0, 1, ly);\n    this.ctxTextures2.fillStyle = '#ff0000';\n    this.ctxTextures2.fillRect(index - 1, 0, 1, ly);\n    this.ctxTextures2.fillRect(index + 1, 0, 1, ly);\n    this.ctxGeodata.fillStyle = '#ff0000';\n    this.ctxGeodata.fillRect(index - 1, 0, 1, ly);\n    this.ctxGeodata.fillRect(index + 1, 0, 1, ly);\n    this.ctxMetatiles.fillStyle = '#ff0000';\n    this.ctxMetatiles.fillRect(index - 1, 0, 1, ly);\n    this.ctxMetatiles.fillRect(index + 1, 0, 1, ly);\n    this.ctxIntervals.fillStyle = '#ff0000';\n    this.ctxIntervals.fillRect(index - 1, 0, 1, ly);\n    this.ctxIntervals.fillRect(index + 1, 0, 1, ly);\n    this.ctxThreads.fillStyle = '#ff0000';\n    this.ctxThreads.fillRect(index - 1, 0, 1, ly);\n    this.ctxThreads.fillRect(index + 1, 0, 1, ly);\n\n    if (!avgMeshesCount) { minMeshes = 0, maxMeshes = 0; }\n    if (!avgTexturesCount) { minTextures = 0, maxTextures = 0; }\n    if (!avgTextures2Count) { minTextures2 = 0, maxTextures2 = 0; }\n    if (!avgGeodataCount) { minGeodata = 0, maxGeodata = 0; }\n    if (!avgMetatilesCount) { minMetatiles = 0, maxMetatiles = 0; }\n    if (!avgThreadsCount) { minThreads = 0, maxThreads = 0; }\n    if (!avgIntervalsCount) { minIntervals = 0, maxIntervals = 0; }\n\n    avgMeshes = avgMeshesCount ? (avgMeshes/avgMeshesCount) : 0;\n    avgTextures = avgTexturesCount ? (avgTextures/avgTexturesCount) : 0;\n    avgTextures2 = avgTextures2Count ? (avgTextures2/avgTextures2Count) : 0;\n    avgGeodata = avgGeodataCount ? (avgGeodata/avgGeodataCount) : 0;\n    avgMetatiles = avgMetatilesCount ? (avgMetatiles/avgMetatilesCount) : 0;\n    avgIntervals = avgIntervalsCount ? (avgIntervals/avgIntervalsCount) : 0;\n    avgThreads = avgThreadsCount ? (avgThreads/avgThreadsCount) : 0;\n\n    this.infoMeshes.innerHTML = 'Meshes Min/Max/Avg/Count: ' + minMeshes.toFixed(0) + '/' + maxMeshes.toFixed(0) + '/' + avgMeshes.toFixed(1) + '/' + avgMeshesCount;\n    this.infoTextures.innerHTML = 'Internal Textures Min/Max/Avg/Count: ' + minTextures.toFixed(0) + '/' + maxTextures.toFixed(0) + '/' + avgTextures.toFixed(1) + '/' + avgTexturesCount;\n    this.infoTextures2.innerHTML = 'External Textures Min/Max/Avg/Count: ' + minTextures2.toFixed(0) + '/' + maxTextures2.toFixed(0) + '/' + avgTextures2.toFixed(1) + '/' + avgTextures2Count;\n    this.infoGeodata.innerHTML = 'Geodata Min/Max/Avg/Count: ' + minGeodata.toFixed(0) + '/' + maxGeodata.toFixed(0) + '/' + avgGeodata.toFixed(1) + '/' + avgGeodataCount;\n    this.infoMetatiles.innerHTML = 'Metatiles Min/Max/Avg/Count: ' + minMetatiles.toFixed(0) + '/' + maxMetatiles.toFixed(0) + '/' + avgMetatiles.toFixed(1) + '/' + avgMetatilesCount;\n    this.infoIntervals.innerHTML = 'Intervals Min/Max/Avg: ' + minIntervals.toFixed(0) + '/' + maxIntervals.toFixed(0) + '/' + avgIntervals.toFixed(1);  \n    this.infoThreads.innerHTML = 'Threads Min/Max/Avg: ' + minThreads + '/' + maxThreads + '/' + avgThreads.toFixed(1);  \n};\n\n\nInspectorReplay.prototype.updateFileInfo = function(index) {\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var replay = map.draw.replay;\n    var file = replay.loaded[index];\n\n    if (file) {\n        this.timeInfo.innerHTML = ''\n            + 'Resource Kind: ' + file.kind + '<br/>'\n            + 'Time: ' + file.time.toFixed(2) + '<br/>'\n            + 'Duration: ' + file.duration.toFixed(2) + '<br/>'\n            + 'Interval: ' + file.interval.toFixed(2) + '<br/>'\n            + 'Priority: ' + file.priority.toFixed(2) + '<br/>'\n            + 'Threads: ' + file.threads + '<br/>'\n            + '' + file.url;\n    } else {\n        this.timeInfo.innerHTML = '';\n    }\n};\n\n\nInspectorReplay.prototype.buildReplayCombo = function() {\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var items = [\n        ['Drawn Tiles',1],\n        ['Drawn Tiles - Free Layers',1],\n        ['Traced Nodes',1],\n        ['Traced Nodes - Free Layers',1],\n        ['Load Sequence',2],\n        ['Camera',2],\n        ['Globe',0]\n    ];\n\n    var keys = [\n        'DrawnTiles',\n        'DrawnTilesFreeLayers',\n        'TracedNodes',\n        'TracedNodesFreeLayers',\n        'LoadSequence',\n        'Camera',\n        'Globe'\n    ];\n\n    var html = '', i, li, htmlId;\n\n    for (i = 0, li = items.length; i < li; i++) {\n        html += '<div id=\"vts-replay-item-' + keys[i] + '\" class=\"vts-replay-item\">'\n                 + '<input id=\"vts-replay-checkbox-' + keys[i] + '\" type=\"checkbox\"/>'\n                 + '<span title=' + items[i][0] + '>' + items[i][0] + '&nbsp;&nbsp;</span>';\n                 \n        if (items[i][1] > 0) {\n            html += '<input id=\"vts-replay-sbutton-' + keys[i] + '\" type=\"button\" value=\"S\"/>';\n        }\n        \n        if (items[i][1] > 1) {\n            html += '<input id=\"vts-replay-fbutton-' + keys[i] + '\" type=\"button\" value=\"' + ((keys[i] == 'Camera') ? 'R' : 'F') + '\"/>';\n        }\n        \n        html += '</div>';\n    }\n\n    this.items.innerHTML = html;\n    //this.currentItem = keys[0];\n\n    for (i = 0, li = items.length; i < li; i++) {\n        htmlId = 'vts-replay-checkbox-' + keys[i];\n        document.getElementById(htmlId).onchange = this.switchItem.bind(this, keys[i], htmlId);\n        //var htmlId = \"vts-replay-item-\" + keys[i];\n        //document.getElementById(htmlId).onclick = this.selectReplayItem.bind(this, keys[i]);\n\n        if (items[i][1] > 0) {\n            htmlId = 'vts-replay-sbutton-' + keys[i];\n            document.getElementById(htmlId).onclick = this.itemButton.bind(this, keys[i], 'S');\n        }\n\n        if (items[i][1] > 1) {\n            htmlId = 'vts-replay-fbutton-' + keys[i];\n            document.getElementById(htmlId).onclick = this.itemButton.bind(this, keys[i], ((keys[i] == 'Camera') ? 'R' : 'F'));\n        }\n    }\n};\n\n\nexport default InspectorReplay;\n\n","\nvar InspectorStylesheets = function(inspector) {\n    this.inspector = inspector;\n    this.core = inspector.core;\n};\n\n\nInspectorStylesheets.prototype.init = function() {\n    var inspector = this.inspector;\n    inspector.addStyle(\n        '#vts-stylesheets-panel * {'\n            + 'all: initial;'\n        + '}'\n\n        + '#vts-stylesheets-panel {'\n            + 'font-family: Arial, \"Helvetica Neue\", Helvetica, sans-serif;'\n            + 'display: none;'\n            + 'padding:15px;'\n            + 'width: 1200px;'\n            + 'height: 350px;'\n            + 'font-size: 14px;'\n            + 'position: absolute;'\n            + 'right: 10px;'\n            + 'bottom: 10px;'\n            + 'cursor: default;'\n            + 'background-color: rgba(255,255,255,0.95);'\n            + 'border-radius: 5px;'\n            + 'border: solid 1px #ccc;'\n            + 'text-align: left;'\n            + 'z-index: 7;'\n            + 'padding: 10px;'\n        + '}'\n\n        + '#vts-stylesheets-panel-header {'\n            + 'width: 100%;'\n            + 'height: 28px;'\n        + '}'\n\n        + '#vts-stylesheets-panel-combo {'\n            + 'font-family: Arial, \"Helvetica Neue\", Helvetica, sans-serif;'\n            + 'font-size: 13px;'\n            + 'border: 1px solid #a9a9a9;'\n            + 'width: 1070px;'\n            + 'height: 17px;'\n            + 'padding: 2px;'\n            + 'margin-bottom: 5px;'\n            + '-webkit-appearance: menulist;'\n            + '-moz-appearance: menulist;'\n        + '}'\n\n        + '#vts-stylesheets-panel-combo option {'\n            + 'font-family: Arial, \"Helvetica Neue\", Helvetica, sans-serif;'\n            + 'font-size: 13px;'\n        + '}'\n\n        + '#vts-stylesheets-panel-update-button {'\n            + 'font-family: Arial, \"Helvetica Neue\", Helvetica, sans-serif;'\n            + 'font-size: 14px;'\n            + 'float: right;'\n            + 'background-color: #dedede;'\n            + 'padding: 3px 2px 2px 2px;'\n            + 'border: 1px solid #a0a0a0;'\n            + 'border-radius: 2px;'\n            + 'margin-right: 5px;'\n        + '}'\n\n        + '#vts-stylesheets-panel-hide-button {'\n            + 'font-family: Arial, \"Helvetica Neue\", Helvetica, sans-serif;'\n            + 'font-size: 14px;'\n            + 'float: right;'\n            + 'background-color: #dedede;'\n            + 'padding: 3px 2px 2px 2px;'\n            + 'border: 1px solid #a0a0a0;'\n            + 'border-radius: 2px;'\n        + '}'\n\n        + '#vts-stylesheets-panel-text {'\n            + 'font-family: monospace;'\n            + 'border: 1px solid #a9a9a9;'\n            + 'padding: 2px 0px 0px 2px;'\n            + 'width: 100%;'\n            + 'height: 300px;'\n            + 'resize: none;'\n            + 'white-space: pre;'\n        + '}'\n    );\n\n    this.element = document.createElement('div');\n    this.element.id = 'vts-stylesheets-panel';\n    this.element.innerHTML =\n            '<div id=\"vts-stylesheets-panel-header\">'\n            + '<select id=\"vts-stylesheets-panel-combo\"></select>'\n            + '<button id=\"vts-stylesheets-panel-hide-button\" type=\"button\" title=\"Hide\">Hide</button>'\n            + '<button id=\"vts-stylesheets-panel-update-button\" type=\"button\" title=\"Update\">Update</button>'\n          + '</div>'\n          + '<textarea id=\"vts-stylesheets-panel-text\" rows=\"4\" cols=\"50\">aa\\naa\\n</textarea>';\n\n    //this.inspectorElement.appendChild(this.element);\n    this.core.element.appendChild(this.element);\n\n    this.optionsElement = document.getElementById('vts-stylesheets-panel-combo');\n    this.optionsElement.onchange = this.onComboSwitched.bind(this);\n\n    this.textElement = document.getElementById('vts-stylesheets-panel-text');\n    \n    document.getElementById('vts-stylesheets-panel-update-button').onclick = this.onUpdate.bind(this);\n    document.getElementById('vts-stylesheets-panel-hide-button').onclick = this.hidePanel.bind(this);\n\n    this.element.addEventListener('mouseup', inspector.doNothing.bind(this), true);\n    this.element.addEventListener('mousedown', inspector.doNothing.bind(this), true);\n    this.element.addEventListener('mousewheel', inspector.doNothing.bind(this), false);\n    this.element.addEventListener('dblclick', inspector.doNothing.bind(this), false);\n\n    this.textElement.addEventListener('keyup', inspector.doNothing.bind(this), false);\n    this.textElement.addEventListener('keydown', inspector.doNothing.bind(this), false);\n\n    this.panelVisible = false;\n};\n\n\nInspectorStylesheets.prototype.showPanel = function() {\n    this.buildStylesheetsCombo();\n    this.element.style.display = 'block';\n    this.panelVisible = true;\n};\n\n\nInspectorStylesheets.prototype.hidePanel = function() {\n    this.element.style.display = 'none';\n    this.panelVisible = false;\n};\n\n\nInspectorStylesheets.prototype.switchPanel = function() {\n    if (this.panelVisible) {\n        this.hidePanel();\n    } else {\n        this.showPanel();\n    }\n};\n\n\nInspectorStylesheets.prototype.onComboSwitched = function() {\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var stylesheet = map.getStylesheet(this.optionsElement.value);\n    this.textElement.value = this.niceStyleFormat(stylesheet);\n};\n\n\nInspectorStylesheets.prototype.onUpdate = function() {\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    map.setStylesheetData(this.optionsElement.value, JSON.parse(this.textElement.value));\n};\n\n\nInspectorStylesheets.prototype.niceStyleFormat = function(data) {\n    if (!data || !data.data) {\n        return '';\n    }\n    \n    data = data.data;\n\n    //return JSON.stringify(data, null, \"  \");\n    \n    var tmp = '';\n    tmp += '{\\n';\n\n    var elements = [];\n\n    if (data['constants']) {\n        elements.push('constants');\n    } \n\n    if (data['bitmaps']) {\n        elements.push('bitmaps');\n    } \n\n    if (data['fonts']) {\n        elements.push('fonts');\n    } \n\n    if (data['layers']) {\n        elements.push('layers');\n    } \n    \n    for (var j = 0, lj = elements.length; j < lj; j++) {\n        var type = elements[j];\n        tmp += '  \"' + type + '\": {\\n';\n\n        var element = data[type];\n\n        var buff = [];\n        for (var key in element) {\n            buff.push(key);\n        }\n\n        for (var i = 0, li = buff.length; i < li; i++) {\n            if (type == 'layers') {\n                \n                var element2 = element[buff[i]];\n                \n                var buff2 = [];\n                for (var key2 in element2) {\n                    buff2.push(key2);\n                }\n\n                tmp += '    \"' + buff[i] + '\": {\\n';\n\n                for (var k = 0, lk = buff2.length; k < lk; k++) {\n                    tmp += '      \"' + buff2[k] + '\": ' + JSON.stringify(element2[buff2[k]]) + (k == (lk - 1) ? '' : ',') + '\\n';\n                }\n                \n                tmp += '    }'  + (i == (li - 1) ? '' : ',\\n');\n            } else {\n                tmp += '    \"' + buff[i] + '\": ' + JSON.stringify(element[buff[i]]) + (i == (li - 1) ? '' : ',') + '\\n';\n            }\n        }\n        \n        tmp += '\\n  }' + (j == (lj - 1) ? '' : ',\\n');\n    }\n    \n    tmp += '\\n}';\n    \n    return tmp;\n};\n\n\nInspectorStylesheets.prototype.buildStylesheetsCombo = function() {\n    var map = this.core.getMap();\n    if (!map) {\n        return;\n    }\n\n    var html = '';\n\n    var styles = map.getStylesheets();\n    \n    for (var i = 0, li = styles.length; i < li; i++) {\n        html += '<option value=\"' + styles[i] + '\">' + styles[i] + '</option>';\n    }    \n    \n    this.optionsElement.innerHTML = html;\n    \n    var stylesheet = map.getStylesheet(styles[0]);\n    this.textElement.value = this.niceStyleFormat(stylesheet);\n};\n\n\nexport default InspectorStylesheets;\n\n","\nimport {mat4 as mat4_} from '../utils/matrix';\nimport {math as math_} from '../utils/math';\nimport {utils as utils_} from '../utils/utils';\nimport InspectorInput_ from './input';\nimport InspectorStats_ from './stats';\nimport InspectorGraphs_ from './graphs';\nimport InspectorLayers_ from './layers';\nimport InspectorReplay_ from './replay';\nimport InspectorStylesheets_ from './stylesheets';\n\n//get rid of compiler mess\nvar mat4 = mat4_;\nvar math = math_;\nvar utils = utils_;\nvar InspectorInput = InspectorInput_;\nvar InspectorStats = InspectorStats_;\nvar InspectorGraphs = InspectorGraphs_;\nvar InspectorLayers = InspectorLayers_;\nvar InspectorReplay = InspectorReplay_;\nvar InspectorStylesheets = InspectorStylesheets_;\n\n\nvar Inspector = function(core) {\n    this.core = core;\n    this.enabled = false;\n    this.input = new InspectorInput(this);\n    this.stats = new InspectorStats(this);\n    this.graphs = new InspectorGraphs(this);\n    this.layers = new InspectorLayers(this);\n    this.replay = new InspectorReplay(this);\n    this.stylesheets = new InspectorStylesheets(this);\n\n    if (this.core.config.inspector) {\n        this.input.init();\n    }\n\n    this.shakeCamera = false; \n    this.drawReplayCamera = false; \n    this.drawRadar = false;\n    this.radarLod = null;\n    this.debugValue = 0;\n    this.measureMode = false;\n    this.measurePoints = [];\n};\n\n\nInspector.prototype.enableInspector = function() {\n    if (!this.enabled) {\n        this.stats.init();\n        this.graphs.init();\n        this.layers.init();\n        this.replay.init();\n        this.stylesheets.init();\n\n        //load image    \n        if (!this.circleImage) {\n            this.circleImage = utils.loadImage(\n                    'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QAAAAAAAD5Q7t/AAAACW9GRnMAAAAgAAAA4ACD+EAUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVRYw+2VPwqDMBTG3dz1Am56EnH2XLroETxGuwc3Z7cOdhY8QJpfSUBspUvStJAPPggvD973/uQligICAgL+DKViqygUV02hbaXLwJlio7gpyhNu2idzEXwwgfI8H+u6vnZdN/V9P3EuimLcCRlsiyArGcfxjWDLsmzyAGzc4aNFNDZ7/iw7AeQH4LNrh5WZYLgkJTaZCyHuVVVdkiSZ0zSdOWMzlaBFWkRrQ4A4Zk/A4wBie1MFYUMAz0wybCYAmR8FUAlzj6+2r18TgM2VAO8tOB1Cyk7mrofQ+zP0voheVjHtIBjDxjrmvCu7k1Xs/TP6ie84ICDAGR5uCYdPo0MWiAAAAABJRU5ErkJggg==',\n                    //\"http://maps.google.com/mapfiles/kml/shapes/placemarkcircle.png\",\n                    (function(){\n                        this.circleTexture = this.core.getRendererInterface().createTexture({ 'source': this.circleImage });\n                    }).bind(this)\n                );\n        }\n\n        this.core.on('map-update', this.onMapUpdate.bind(this));\n        this.enabled = true;\n    }\n};\n\n\nInspector.prototype.setParameter = function(key, value) {\n    this.input.setParameter(key, value);\n};\n\nInspector.prototype.addStyle = function(string) {\n    var style = document.createElement('style');\n    style.type = 'text/css';\n    style.innerHTML = string;\n    document.getElementsByTagName('head')[0].appendChild(style);\n};\n\n\n//used to block mouse events\nInspector.prototype.doNothing = function(e) {\n    e.stopPropagation();\n    return false;\n};\n\n\nInspector.prototype.preventDefault = function(e) {\n    if (e.preventDefault) {\n        e.preventDefault();\n    } else {\n        e.returnValue = false;\n    }\n};\n\n\nInspector.prototype.onMapUpdate = function() {\n    var map = this.core.getMapInterface();\n    if (!map) {\n        return;\n    }\n\n    if (this.shakeCamera) {\n        map.redraw();\n    } \n\n    /*if (this.measureMode) {\n        var renderer = this.core.getRenderer();\n        var p = map.convertCoordsFromPhysToNav(this.measurePoints[0]);\n        map.convertCoordsFromPhysToCanvas(this.measurePoints[0]);\n    }*/\n\n    var renderer = this.core.getRendererInterface(), i, li, j, lj, lines, slines, p;\n\n    if (this.replay.drawGlobe) {\n        p = map.convertCoordsFromPhysToCameraSpace([0,0,0]);\n        var renderer2 = this.core.getRenderer();\n        renderer2.draw.drawTBall(p, 12742000 * 0.5, renderer2.progStardome, this.replay.globeTexture, 12742000 * 0.5, true);\n    }\n\n    if (this.replay.drawCamera) {\n        lines = this.replay.cameraLines;\n        slines = []; \n        //for (i = 0, li = lines.length; i < li; i++) {\n          //  slines.push(map.convertCoordsFromPhysToCanvas(lines[i]));\n        //}\n        \n        renderer.drawLineString({\n            points : lines,\n            size : 2.0,\n            color : [0,128,255,255],\n            depthTest : false,\n            screenSpace : false,\n            blend : false\n        });            \n\n        lines = this.replay.cameraLines3;\n        for (i = 0, li = lines.length; i < li; i++) {\n            slines = []; \n            for (j = 0, lj = lines[i].length; j < lj; j++) {\n                //slines.push(map.convertCoordsFromPhysToCanvas(lines[i][j]));\n                slines.push(lines[i][j]);\n            }\n\n            renderer.drawLineString({\n                points : slines,\n                size : 2.0,\n                color : [0,255,128,255],\n                depthTest : false,\n                screenSpace : false,\n                blend : false\n            });   \n        }\n\n        lines = this.replay.cameraLines2;\n        for (i = 0, li = lines.length; i < li; i++) {\n            slines = []; \n            for (j = 0, lj = lines[i].length; j < lj; j++) {\n                //slines.push(map.convertCoordsFromPhysToCanvas(lines[i][j]));\n                slines.push(lines[i][j]);\n            }\n\n            renderer.drawLineString({\n                points : slines,\n                size : 2.0,\n                color : [0,255,255,255],\n                depthTest : false,\n                screenSpace : false,\n                blend : false\n            });   \n        }\n\n\n        var cameInfo = map.getCameraInfo();\n        var p1 = map.convertCoordsFromPhysToCameraSpace(this.replay.cameraLines[0]);\n\n        //var map2 = this.core.getMap();\n    \n        //var m2 = map2.camera.getRotationviewMatrix();\n        var mv = mat4.create(this.replay.cameraMatrix);\n        //mat4.inverse(m2, mv);\n    \n        //matrix which tranforms mesh position and scale\n        /*\n        var mv = [\n            1, 0, 0, 0,\n            0, 1, 0, 0,\n            0, 0, 1, 0,\n            p1[0], p1[1], p1[2], 1\n        ];*/\n        mv[12] = p1[0];\n        mv[13] = p1[1];\n        mv[14] = p1[2];\n    \n        //setup material \n        var material = [ \n            255,128,128, 0, //ambient,\n            0,0,0,0, //diffuse\n            0,0,0,0, //specular \n            0,0.5,0,0 //shininess, alpha,0,0\n        ];\n    \n        //multiply cube matrix with camera view matrix\n        mat4.multiply(cameInfo.viewMatrix, mv, mv);\n    \n        var norm = [\n            0,0,0,\n            0,0,0,\n            0,0,0\n        ];\n    \n        //normal transformation matrix\n        mat4.toInverseMat3(mv, norm);\n    \n        renderer.setState(this.replay.frustumState);\n    \n        //draw cube\n        renderer.drawMesh({\n            mesh : this.replay.frustumMesh,\n            texture : null,\n            shader : 'shaded',\n            shaderVariables : {\n                'uMV' : ['mat4', mv],\n                'uNorm' : ['mat3', norm],\n                'uMaterial' : ['mat4', material]\n            }\n        });\n    }\n    \n    if (this.drawRadar && this.circleTexture) {\n        //var renderer = this.core.getRendererInterface();\n        var pos = map.getPosition();\n        var count = 16;\n        var step = pos.getViewExtent() / (count * 4);\n\n        var cbuffer = new Array(count * count);\n\n/*        \n        var coords = pos.getCoords();\n\n        for (var j = 0; j < count; j++) {\n            for (var i = 0; i < count; i++) {\n                var screenCoords = map.convertCoordsFromNavToCanvas([coords[0] + i*step - count*0.5*step,\n                                                                       coords[1] + j*step - count*0.5*step, 0], \"float\", this.radarLod);\n        \n                cbuffer[j * count + i] = screenCoords;\n            }            \n        }\n*/\n\n\n        for (j = 0; j < count; j++) {\n            for (i = 0; i < count; i++) {\n                var dx =  i*step - count*0.5*step;\n                var dy =  j*step - count*0.5*step;\n                var a = Math.atan2(dy, dx);\n                var l = Math.sqrt(dx*dx + dy*dy);\n\n                var pos2 = map.movePositionCoordsTo(pos, math.degrees(a), l);\n                var coords = pos2.getCoords();\n                \n                var screenCoords = map.convertCoordsFromNavToCanvas([coords[0], coords[1], 0], 'float', this.radarLod);\n\n                cbuffer[j * count + i] = screenCoords;\n            }            \n        }\n\n\n        var lbuffer = new Array(count);\n\n        for (j = 0; j < count; j++) {\n            for (i = 0; i < count; i++) {\n                lbuffer[i] =  cbuffer[j * count + i];\n            }\n            \n            renderer.drawLineString({\n                points : lbuffer,\n                size : 2.0,\n                screenSpace : true,\n                color : [0,255,255,255],\n                depthTest : false,\n                blend : false\n            });            \n        }\n\n\n        for (i = 0; i < count; i++) {\n            for (j = 0; j < count; j++) {\n                lbuffer[j] =  cbuffer[j * count + i];\n            }\n            \n            renderer.drawLineString({\n                points : lbuffer,\n                size : 2.0,\n                screenSpace : true,\n                color : [0,255,255,255],\n                depthTest : false,\n                blend : false\n            });            \n        }\n\n        for (i = 0, li = cbuffer.length; i < li; i++) {\n            p = cbuffer[i];\n            renderer.drawImage({\n                rect : [p[0]-10, p[1]-10, 20, 20],\n                texture : this.circleTexture,\n                color : [255,0,255,255],\n                depth : p[2],\n                depthTest : false,\n                blend : true\n            });\n        }\n    }\n};\n\n\nexport default Inspector;\n","\n\nvar GpuDevice = function(renderer, div, size, keepFrameBuffer, antialias, aniso) {\n    this.renderer = renderer;\n    this.div = div;\n    this.canvas =  null;\n    this.curSize = size;\n    this.currentProgram = null;\n    this.maxAttributesCount = 8;\n    this.newAttributes = new Uint8Array(this.maxAttributesCount);\n    this.enabledAttributes = new Uint8Array(this.maxAttributesCount);\n    this.noTextures = false;\n    this.barycentricBuffer = null;\n   \n    //state of device when first initialized\n    this.defaultState = this.createState({blend:false, stencil:false, zequal: false, ztest:false, zwrite: false, culling:false}); \n    this.currentState = this.defaultState;\n    this.currentOffset = 0; //used fot direct offset\n\n    this.keepFrameBuffer = (keepFrameBuffer == null) ? false : keepFrameBuffer;\n    this.antialias = antialias ? true : false;\n    this.anisoLevel = aniso;\n};\n\n\nGpuDevice.prototype.init = function() {\n    var canvas = document.createElement('canvas');\n\n    if (canvas == null) {\n        //canvas not supported\n        return;\n    }\n\n    this.canvas = canvas;\n\n    canvas.width = this.curSize[0];\n    canvas.height = this.curSize[1];\n    canvas.style.display = 'block';\n\n    if (canvas.getContext == null) {\n        //canvas not supported\n        return;\n    }\n\n    canvas.addEventListener(\"webglcontextlost\", this.contextLost.bind(this), false);\n    canvas.addEventListener(\"webglcontextrestored\", this.contextRestored.bind(this), false);\n\n    var gl;\n\n    try {\n        gl = canvas.getContext('webgl', {preserveDrawingBuffer: this.keepFrameBuffer, antialias: this.antialias, stencil: true}) || canvas.getContext('experimental-webgl', {preserveDrawingBuffer: this.keepFrameBuffer});\n    } catch(e) {\n        //webgl not supported\n    }\n\n    if (!gl) {\n        //webgl not supported\n        return;\n    }\n\n    this.gl = gl;\n\n    if (!gl.getExtension('OES_standard_derivatives')) {\n    }\n\n    this.anisoExt = (\n      gl.getExtension('EXT_texture_filter_anisotropic') ||\n      gl.getExtension('MOZ_EXT_texture_filter_anisotropic') ||\n      gl.getExtension('WEBKIT_EXT_texture_filter_anisotropic')\n    );\n\n    if (this.anisoExt) {\n        this.maxAniso = gl.getParameter(this.anisoExt.MAX_TEXTURE_MAX_ANISOTROPY_EXT);\n\n        if (this.anisoLevel) {\n            if (this.anisoLevel == -1) {\n                this.anisoLevel = this.maxAniso;\n            } else {\n                this.anisoLevel = Math.min(this.anisoLevel, this.maxAniso);\n            }\n        }\n    } else {\n        this.maxAniso = 0;\n        this.anisoLevel = 0;\n    }\n\n    this.div.appendChild(canvas);\n\n    gl.viewportWidth = canvas.width;\n    gl.viewportHeight = canvas.height;\n\n    gl.clearColor(0.0, 0.0, 0.0, 1.0);\n    //gl.enable(gl.DEPTH_TEST);\n\n    //initial state\n    gl.disable(gl.BLEND);\n\n    gl.disable(gl.STENCIL_TEST);\n    gl.depthMask(false);\n    gl.enable(gl.DEPTH_TEST);\n    gl.depthFunc(gl.LESS);\n    gl.disable(gl.CULL_FACE);\n\n    //clear screen\n    gl.viewport(0, 0, gl.viewportWidth, gl.viewportHeight);\n    gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n};\n\n\nGpuDevice.prototype.kill = function() {\n    this.div.removeChild(this.canvas);\n    delete this.canvas;\n    this.canvas = null;\n};\n\n\nGpuDevice.prototype.contextLost = function(event) {\n    event.preventDefault();\n    this.renderer.core.contextLost = true;\n    this.renderer.core.callListener('gpu-context-lost', {});\n};\n\n\nGpuDevice.prototype.contextRestored = function() {\n    this.renderer.core.callListener('gpu-context-restored', {});\n};\n\n\nGpuDevice.prototype.resize = function(size, skipCanvas) {\n    this.curSize = size;\n    var canvas = this.canvas, gl = this.gl;\n\n    if (canvas != null && skipCanvas !== true) {\n        canvas.width = this.curSize[0];\n        canvas.height = this.curSize[1];\n    }\n\n    if (gl != null) {\n        gl.viewportWidth = canvas.width;\n        gl.viewportHeight = canvas.height;\n    }\n};\n\n\nGpuDevice.prototype.setAniso = function(aniso) {\n    if (this.anisoExt) {\n        if (this.anisoLevel) {\n            if (aniso == -1) {\n                this.anisoLevel = this.maxAniso;\n            } else {\n                this.anisoLevel = Math.min(aniso, this.maxAniso);\n            }\n        }\n    }\n};\n\n\nGpuDevice.prototype.getCanvas = function() {\n    return this.canvas;\n};\n\n\nGpuDevice.prototype.setViewport = function() {\n    this.gl.viewport(0, 0, this.gl.viewportWidth, this.gl.viewportHeight);\n};\n\n\nGpuDevice.prototype.clear = function(clearDepth, clearColor, color) {\n    if (color != null) {\n        this.gl.clearColor(color[0]/255, color[1]/255, color[2]/255, color[3]/255);\n    }\n    \n    this.gl.clear((clearColor ? this.gl.COLOR_BUFFER_BIT : 0) |\n                  (clearDepth ? this.gl.DEPTH_BUFFER_BIT : 0) );\n};\n\n\nGpuDevice.prototype.useProgram = function(program, attributes, nextSampler) {\n    if (this.currentProgram != program) {\n        this.gl.useProgram(program.program);\n        this.currentProgram = program;\n\n        program.setSampler('uSampler', 0);\n        \n        if (nextSampler) {\n            program.setSampler('uSampler2', 1);\n        }\n\n        var newAttributes = this.newAttributes;\n        var enabledAttributes = this.enabledAttributes; \n       \n        //reset new attributes list\n        for (var i = 0, li = newAttributes.length; i < li; i++){\n            newAttributes[i] = 0;\n        }\n        \n        for (i = 0, li = attributes.length; i < li; i++){\n            var index = program.getAttribute(attributes[i]);\n            \n            if (index != -1){\n                newAttributes[index] = 1;\n            }\n        }\n\n        //enable or disable current attributes according to new attributes list\n        for (i = 0, li = newAttributes.length; i < li; i++){\n            if (enabledAttributes[i] != newAttributes[i]) {\n                if (newAttributes[i]) {\n                    this.gl.enableVertexAttribArray(i);\n                    enabledAttributes[i] = 1;\n                } else {\n                    this.gl.disableVertexAttribArray(i);\n                    enabledAttributes[i] = 0;\n                }\n            }\n        }\n    }\n};\n\n\nGpuDevice.prototype.bindTexture = function(texture, id) {\n    if (!texture.loaded) {\n        return;\n    }\n\n    this.gl.activeTexture(id ? this.gl.TEXTURE1 : this.gl.TEXTURE0);\n    this.gl.bindTexture(this.gl.TEXTURE_2D, texture.texture);\n};\n\n\nGpuDevice.prototype.setFramebuffer = function(texture) {\n    if (texture != null) {\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, texture.framebuffer);\n    } else {\n        this.gl.bindTexture(this.gl.TEXTURE_2D, null);\n        this.gl.bindRenderbuffer(this.gl.RENDERBUFFER, null);\n        this.gl.bindFramebuffer(this.gl.FRAMEBUFFER, null);\n    }\n};\n\n\nGpuDevice.prototype.createState = function(state) {\n    if (state.blend == null) { state.blend = false; }\n    if (state.stencil == null) { state.stencil = false; }\n    if (state.zwrite == null) { state.zwrite = true; }\n    if (state.ztest == null) { state.ztest = true; }\n    if (state.zequal == null) { state.zequal = false; }\n    if (state.culling == null) { state.culling = true; }\n\n    return state;\n};\n\n\nGpuDevice.prototype.setState = function(state) {\n    if (!state) {\n        return;\n    }\n\n    var gl = this.gl;\n    var currentState = this.currentState;\n\n    if (currentState.blend != state.blend) {\n        if (state.blend) {\n            gl.blendEquationSeparate(gl.FUNC_ADD, gl.FUNC_ADD);\n            gl.blendFuncSeparate(gl.SRC_ALPHA, gl.ONE_MINUS_SRC_ALPHA, gl.ONE, gl.ONE_MINUS_SRC_ALPHA);\n            gl.enable(gl.BLEND);\n        } else {\n            gl.disable(gl.BLEND);\n        }\n    }\n\n    if (currentState.stencil != state.stencil) {\n        if (state.stencil) {\n            gl.enable(gl.STENCIL_TEST);\n        } else {\n            gl.disable(gl.STENCIL_TEST);\n        }\n    }\n\n    if (currentState.zwrite != state.zwrite) {\n        if (state.zwrite) {\n            gl.depthMask(true);\n        } else {\n            gl.depthMask(false);\n        }\n    }\n\n    if (currentState.ztest != state.ztest) {\n        if (state.ztest != 0) {\n            gl.enable(gl.DEPTH_TEST);\n        } else {\n            gl.disable(gl.DEPTH_TEST);\n        }\n    }\n\n    if (currentState.zequal != state.zequal) {\n        if (state.zequal != 0) {\n            gl.depthFunc(gl.LEQUAL);\n        } else {\n            gl.depthFunc(gl.LESS);\n        }\n    }\n\n    if (currentState.culling != state.culling) {\n        if (state.culling) {\n            gl.enable(gl.CULL_FACE);\n        } else {\n            gl.disable(gl.CULL_FACE);\n        }\n    }\n\n    this.currentState = state;\n};\n\n\nexport default GpuDevice;\n\n\n\n\n","\nimport GpuTexture_ from './texture';\nimport {utils as utils_} from '../../utils/utils';\n\n//get rid of compiler mess\nvar GpuTexture = GpuTexture_;\nvar utils = utils_;\n\n\nvar GpuFont = function(gpu, core, font, size, path) {\n    this.bbox = null;\n    this.gpu = gpu;\n    this.gl = gpu.gl;\n    this.core = core;\n\n    this.data = null;\n    this.path = path;\n\n    this.texture = {width:256, height:256}; //hack\n\n    this.textures = [];\n    this.images = [];\n    this.ready = false;    \n    this.version = 1;    \n\n    this.load(path);\n};\n\n\n//destructor\nGpuFont.prototype.kill = function() {\n};\n\n// Returns GPU RAM used, in bytes.\nGpuFont.prototype.getSize = function(){ return this.size; };\n\n\nGpuFont.prototype.load = function(path) {\n    utils.loadBinary(path, this.onLoaded.bind(this), this.onError.bind(this));\n};\n\nGpuFont.prototype.onLoaded = function(data) {\n    this.data = data;\n    this.ready = true;    \n    this.core.markDirty();\n};\n\nGpuFont.prototype.isReady = function() {\n    return this.ready;\n};\n\nGpuFont.prototype.onError = function() {\n\n};\n\nGpuFont.prototype.onFileLoaded = function(index, data) {\n    this.core.markDirty();\n    this.textures[index].createFromData(256, 256, new Uint8Array(data), 'linear');\n};\n\nGpuFont.prototype.onFileLoadError = function() {\n};\n\nGpuFont.prototype.areTexturesReady = function(files) {\n    var ready = true;\n    for (var i = 0, li = files.length; i < li; i++) {\n        var index = files[i];//Math.round( (planes[i] - (planes[i] % 3)) );\n\n        if (!this.textures[index]) {\n            utils.loadBinary(this.path + (index+2), this.onFileLoaded.bind(this, index), this.onFileLoadError.bind(this));\n            this.textures[index] = new GpuTexture(this.gpu, null, this.core);\n            ready = false;\n        } else {\n            ready = (ready && this.textures[index].loaded);\n        }\n    }\n\n    return ready;\n};\n\nGpuFont.prototype.getTexture = function(file) {\n    //if (!this.textures[file]) {\n        //debugger;\n    //}\n\n    return this.textures[file];\n};\n\nexport default GpuFont;\n\n\n","\nimport {vec3 as vec3_, vec4 as vec4_, mat4 as mat4_} from '../utils/matrix';\nimport {math as math_} from '../utils/math';\n\n//get rid of compiler mess\nvar vec3 = vec3_, vec4 = vec4_, mat4 = mat4_;\nvar math = math_;\n\n\nvar Camera = function(parent, fov, near, far) {\n    this.parent = parent;\n    this.position = [0,0,0];\n    this.orientation = [0,0,0];\n    this.aspect = 1;\n    this.fov = fov;\n    this.fovTan = Math.tan(fov * Math.PI / 180.0);\n    this.fovDist = 1;\n    this.near = near;\n    this.far = far;\n    this.rotationByMatrix = false;\n\n    // derived quantities, calculated from camera parameters by update()\n    this.modelview = mat4.create();\n    this.rotationview = mat4.create();\n    this.projection = mat4.create();\n    this.mvp = mat4.create();\n    this.mvp32 = new Float32Array(16);\n    this.modelview32 = new Float32Array(16);\n    this.rotationview32 = new Float32Array(16);\n    this.projection32 = new Float32Array(16);\n\n    this.frustumPlanes = [ [0,0,0,0], [0,0,0,0], [0,0,0,0],\n                           [0,0,0,0], [0,0,0,0], [0,0,0,0] ];\n    this.bboxPoints = [\n        [ 0, 0, 0, 1 ],\n        [ 0, 0, 0, 1 ],\n        [ 0, 0, 0, 1 ],\n        [ 0, 0, 0, 1 ],\n        [ 0, 0, 0, 1 ],\n        [ 0, 0, 0, 1 ],\n        [ 0, 0, 0, 1 ],\n        [ 0, 0, 0, 1 ]\n    ];\n\n    //reduce garbage collection\n    this.scaleFactorVec = [0,0,0,0];\n    this.dirty = true;\n};\n\n\nCamera.prototype.setPosition = function(position) {\n    this.position = position;\n    this.dirty = true;\n};\n\n\nCamera.prototype.setOrientation = function(orientation) {\n    this.rotationByMatrix = false;\n    this.orientation = orientation;\n    this.dirty = true;\n};\n\n\nCamera.prototype.setRotationMatrix = function(matrix){\n    this.rotationByMatrix = true;\n    this.rotationview = matrix.slice();\n    this.dirty = true;\n};\n\n\n// Sets the viewport aspect ratio (width / height). Should be called\n// whenever the rendering viewport changes.\nCamera.prototype.setAspect = function(aspect) {\n    this.aspect = aspect;\n    this.dirty = true;\n};\n\n\nCamera.prototype.setViewHeight = function(height) {\n    this.viewHeight = height;\n    this.dirty = true;\n};\n\n\nCamera.prototype.setOrtho = function(state) {\n    this.ortho = state;\n    this.dirty = true;\n};\n\n\nCamera.prototype.setParams = function(fov, near, far) {\n    this.fov = fov;\n    this.near = near;\n    this.far = far;\n    this.dirty = true;\n};\n\n\nCamera.prototype.clone = function(newFov) {\n    var camera = new Camera(this. parent, (newFov != null) ? newFov : this.getFov(), this.getNear(), this.getFar());\n\n    camera.setPosition(this.getPosition());\n    camera.setOrientation(this.getOrientation());\n    camera.setAspect(this.getAspect());\n    camera.update();\n\n    return camera;\n};\n\n\n// simple getters\nCamera.prototype.getPosition = function(){ return [this.position[0], this.position[1], this.position[2]]; };\nCamera.prototype.getOrientation = function(){ return [this.orientation[0], this.orientation[1], this.orientation[2]]; };\nCamera.prototype.getAspect = function(){ return this.aspect; };\nCamera.prototype.getFov = function(){ return this.fov; };\nCamera.prototype.getNear = function(){ return this.near; };\nCamera.prototype.getFar = function(){ return this.far; };\nCamera.prototype.getViewHeight = function(){ return this.viewHeight; };\nCamera.prototype.getOrtho = function(){ return this.ortho; };\n\n\n// Returns rotation matrix\nCamera.prototype.getRotationviewMatrix = function() {\n    if (this.dirty) this.update();\n    return this.rotationview;\n};\n\nCamera.prototype.getRotationviewFMatrix = function() {\n    if (this.dirty) this.update();\n    return this.rotationview32;\n};\n\n// Returns a matrix that transforms the world space to camera space.\nCamera.prototype.getModelviewMatrix = function(){\n    if (this.dirty) this.update();\n    return this.modelview;\n};\n\nCamera.prototype.getModelviewFMatrix = function(){\n    if (this.dirty) this.update();\n    return this.modelview32;\n};\n\n\n// Returns a matrix that transforms the camera space to screen space.\nCamera.prototype.getProjectionMatrix = function() {\n    if (this.dirty) this.update();\n    return this.projection;\n};\n\nCamera.prototype.getProjectionFMatrix = function() {\n    if (this.dirty) this.update();\n    return this.projection32;\n};\n\n\n// Returns projectionMatrix() * modelviewMatrix()\nCamera.prototype.getMvpMatrix = function() {\n    if (this.dirty) this.update();\n    return this.mvp;\n};\n\nCamera.prototype.getMvpFMatrix = function() {\n    if (this.dirty) this.update();\n    return this.mvp32;\n};\n\n// Returns how much a length unit located at a point in world space is\n// stretched when projected to the sceen space.\nCamera.prototype.scaleFactor = function(worldPos, returnDist) {\n    if (this.dirty) this.update();\n\n    //var camPos = vec4.create();\n    //mat4.multiplyVec4(this.modelview, worldPos, camPos);\n    mat4.multiplyVec3(this.modelview, worldPos, this.scaleFactorVec);\n    var dist = vec3.length(this.scaleFactorVec); // distance from camera\n\n    // the expression \"projection(0,0) / depth\" is the derivative of the\n    // screen X position by the camera space X coordinate.\n\n    // ('dist' is used instead of camera depth (camPos(2)) to make the tile\n    // resolution independent of camera rotation)\n\n    if (returnDist) {\n        if (dist < this.near) return [Number.POSITIVE_INFINITY, dist];\n        return [this.projection[0] / dist, dist]; \n        //return [(this.projection[5]*0.5) / dist, dist]; //projection by sy\n    }\n\n    if (dist < this.near) return Number.POSITIVE_INFINITY;\n    return this.projection[0] / dist;\n    //return (this.projection[5]*0.5) / dist; //projection by sy\n};\n\n\nCamera.prototype.scaleFactor2 = function(dist) {\n    if (this.dirty) this.update();\n\n    if (dist < this.near) return Number.POSITIVE_INFINITY;\n    return this.projection[0] / dist;\n    //return (this.projection[5]*0.5) / dist; //projection by sy\n};\n\n\nCamera.prototype.distance = function(worldPos) {\n    var delta = vec3.create();\n    vec3.subtract(this.position, worldPos, delta);\n    return vec3.length(delta);\n};\n\n\n// Returns true if point is inside camera frustum.\nCamera.prototype.pointVisible = function(point, shift) {\n    if (this.dirty) this.update();\n\n    var p;\n\n    if (shift) {\n        p = [ point[0] - shift[0], point[1] - shift[1], point[2] - shift[2], 1 ];\n    } else {\n        p = [ point[0], point[1], point[2], 1 ];\n    }\n\n    // test all frustum planes quickly\n    for (var i = 0; i < 6; i++) {\n        // check if point lie on the negative side of the frustum plane\n        if (vec4.dot(this.frustumPlanes[i], p) < 0) {\n            return false;\n        }\n    }\n\n    // the box might be inside - further testing should be done here - TODO!\n    return true;\n};\n\n\n// Returns true if the box intersects the camera frustum.\nCamera.prototype.pointsVisible = function(points, shift) {\n    if (this.dirty) this.update();\n   \n    var planes = this.frustumPlanes;\n    var lj = points.length, sx, sy, sz;\n\n    if (shift) {\n        sx = shift[0];\n        sy = shift[1];\n        sz = shift[2];\n    } else {\n        sx = 0;\n        sy = 0;\n        sz = 0;\n    }\n        \n    var dot = vec4.dot3;\n\n    // test all frustum planes quickly\n    for (var i = 0; i < 6; i++) {\n        // check if all points lie on the negative side of the frustum plane\n        var negative = true;\n        var plane = planes[i];\n        for (var j = 0; j < lj; j+=3) {\n            if (dot(plane, points, j, sx, sy, sz) >= 0) {\n                //return false;\n                negative = false;\n                break;\n            }\n        }\n        if (negative) return false;\n    }\n\n    return true;\n};\n\n\n// Returns true if the box intersects the camera frustum.\nCamera.prototype.bboxVisible = function(bbox, shift) {\n    if (this.dirty) this.update();\n\n    var min = bbox.min;\n    var max = bbox.max;\n    var points = this.bboxPoints;\n    var p, minX, minY, minZ, maxX, maxY, maxZ;\n\n    if (shift) {\n        minX = min[0] - shift[0];        \n        minY = min[1] - shift[1];        \n        minZ = min[2] - shift[2];        \n       \n        maxX = max[0] - shift[0];        \n        maxY = max[1] - shift[1];        \n        maxZ = max[2] - shift[2];        \n    } else {\n        minX = min[0];        \n        minY = min[1];        \n        minZ = min[2];        \n\n        maxX = max[0];        \n        maxY = max[1];        \n        maxZ = max[2];        \n    }\n\n    p = points[0];\n    p[0] = minX;  p[1] = minY; p[2] = minZ; \n    p = points[1];\n    p[0] = minX;  p[1] = minY; p[2] = maxZ; \n    p = points[2];\n    p[0] = minX;  p[1] = maxY; p[2] = minZ; \n    p = points[3];\n    p[0] = minX;  p[1] = maxY; p[2] = maxZ; \n\n    p = points[4];\n    p[0] = maxX;  p[1] = minY; p[2] = minZ; \n    p = points[5];\n    p[0] = maxX;  p[1] = minY; p[2] = maxZ; \n    p = points[6];\n    p[0] = maxX;  p[1] = maxY; p[2] = minZ; \n    p = points[7];\n    p[0] = maxX;  p[1] = maxY; p[2] = maxZ; \n\n\n    var dot = vec4.dot2;\n    var planes = this.frustumPlanes;\n\n    // test all frustum planes quickly\n    for (var i = 0; i < 6; i++) {\n        // check if all points lie on the negative side of the frustum plane\n        var negative = true;\n        var plane = planes[i];\n        for (var j = 0; j < 8; j++) {\n            if (dot(plane, points[j]) >= 0) {\n                //return false;\n                negative = false;\n                break;\n            }\n        }\n        if (negative) return false;\n    }\n\n    // the box might be inside - further testing should be done here - TODO!\n    return true;\n};\n\n\nCamera.prototype.update = function(zoffset) {\n    // modelview matrix, this is essentially the inverse of a matrix that\n    // brings the camera from the origin to its world position (the inverse\n    // is trivial here -- negative angles, reverse order of transformations)\n    //this.modelview = mat4.create();\n\n    if (!this.rotationByMatrix) {\n        mat4.multiply(math.rotationMatrix(2, math.radians(-this.orientation[2])), math.rotationMatrix(0, math.radians(-this.orientation[1] - 90.0)), this.rotationview);\n        mat4.multiply(this.rotationview, math.rotationMatrix(2, math.radians(-this.orientation[0])), this.rotationview);\n    }\n\n    mat4.multiply(this.rotationview, math.translationMatrix(-this.position[0], -this.position[1], -this.position[2]), this.modelview);\n\n    if (this.ortho) {\n        this.projection = math.orthographicMatrix(this.viewHeight, this.aspect, this.near, this.far);\n    } else {\n        this.projection = math.perspectiveMatrix(this.fov, this.aspect, this.near, this.far);\n    }\n\n    mat4.multiply(this.projection, this.modelview, this.mvp);\n\n    // prepare frustum planes (in normalized device coordinates)\n    this.frustumPlanes[0] = [ 0, 0, 1, 1 ]; // far\n    this.frustumPlanes[1] = [ 0, 0,-1, 1 ]; // near\n    this.frustumPlanes[2] = [ 1, 0, 0, 1 ]; // left\n    this.frustumPlanes[3] = [-1, 0, 0, 1 ]; // right\n    this.frustumPlanes[4] = [ 0, 1, 0, 1 ]; // bottom\n    this.frustumPlanes[5] = [ 0,-1, 0, 1 ]; // top\n\n    // transform the frustum planes to the world space, remember that\n    // planes in homogeneous coordinates transform as p' = M^{-T} * p, where\n    // M^{-T} is the transpose of inverse of M\n    var mvpt = mat4.create();\n    mat4.transpose(this.mvp, mvpt); //without zoffset\n    for (var i = 0; i < 6; i++) {\n        this.frustumPlanes[i] = mat4.multiplyVec4(mvpt, this.frustumPlanes[i]);\n    }\n\n    this.mvp32.set(this.mvp);\n    this.projection32.set(this.projection);\n    this.modelview32.set(this.modelview);\n    this.rotationview32.set(this.rotationview);\n\n    this.fovDist = (this.parent.curSize[1] *0.5) / this.fovTan;\n\n    // the derived quantities are now in sync with the parameters\n    this.dirty = false;\n};\n\n\nexport default Camera;\n","\nimport BBox_ from './bbox';\n\n//get rid of compiler mess\nvar BBox = BBox_;\n\n\nvar RendererGeometry = {};\n\n\nRendererGeometry.setFaceVertices = function(vertices, a, b, c, index) {\n    vertices[index] = a[0];\n    vertices[index+1] = a[1];\n    vertices[index+2] = a[2];\n\n    vertices[index+3] = b[0];\n    vertices[index+4] = b[1];\n    vertices[index+5] = b[2];\n\n    vertices[index+6] = c[0];\n    vertices[index+7] = c[1];\n    vertices[index+8] = c[2];\n};\n\n\nRendererGeometry.setFaceUVs = function(uvs, a, b, c, index) {\n    uvs[index] = a[0];\n    uvs[index+1] = a[1];\n\n    uvs[index+2] = b[0];\n    uvs[index+3] = b[1];\n\n    uvs[index+4] = c[0];\n    uvs[index+5] = c[1];\n};\n\n\n// Procedural mesh representing a heightmap block\n// Creates a grid of size x size vertices, all coords are [0..1].\nRendererGeometry.buildHeightmap = function(size, use16bit) {\n    size--;\n\n    var g = RendererGeometry;\n    var numFaces = (size* size) * 2;\n    var vertices = new Float32Array(numFaces * 3 * 3);//[];\n    var uvs = new Float32Array(numFaces * 3 * 2);//[];\n\n    var factor = 1.0 * size;\n    var index = 0;\n    var index2 = 0;\n\n    for (var i = 0; i < size; i++) {\n        for (var j = 0; j < size; j++) {\n            var x1 = (j) * factor;\n            var x2 = (j+1) * factor;\n\n            var y1 = (i) * factor;\n            var y2 = (i+1) * factor;\n\n            g.setFaceVertices(vertices, [x1, y1, 0], [x2, y1, 0], [x2, y2, 0], index);\n            g.setFaceUVs(uvs, [x1, y1], [x2, y1], [x2, y2], index2);\n            index += 9;\n            index2 += 6;\n\n            g.setFaceVertices(vertices, [x2, y2, 0], [x1, y2, 0], [x1, y1, 0], index);\n            g.setFaceUVs(uvs, [x2, y2], [x1, y2], [x1, y1], index2);\n            index += 9;\n            index2 += 6;\n        }\n    }\n\n    var bbox = new BBox(0,0,0,1,1,1);\n\n    if (use16bit) {\n        return { bbox:bbox, vertices:this.covnetTo16Bit(vertices), uvs: this.covnetTo16Bit(uvs)};\n    } else {\n        return { bbox:bbox, vertices:vertices, uvs: uvs};\n    }\n};\n\n\nRendererGeometry.buildPlane = function(size, use16bit) {\n    size--;\n\n    var g = RendererGeometry;\n    var numFaces = (size* size) * 2;\n    var vertices = (use16bit) ? (new Uint16Array(numFaces * 3 * 3)) : (new Float32Array(numFaces * 3 * 3));\n    var uvs = new Float32Array(numFaces * 3 * 2);//[];\n\n    var factor = 1.0 / (size);\n    var index = 0, index2 = 0;\n    var x1, y1, x2, y2, xx1, xx2, yy1, yy2;\n\n    for (var i = 0; i < size; i++) {\n        for (var j = 0; j < size; j++) {\n            x1 = j;\n            x2 = j+1;\n            y1 = i;\n            y2 = i+1;\n\n            xx1 = j * factor;\n            xx2 = (j+1) * factor;\n            yy1 = (i) * factor;\n            yy2 = (i+1) * factor;\n\n            g.setFaceVertices(vertices, [x1, y1, 0], [x1, y2, 0], [x2, y2, 0], index);\n            g.setFaceUVs(uvs, [xx1, yy1], [xx1, yy2], [xx2, yy2], index2);\n            index += 9;\n            index2 += 6;\n\n            g.setFaceVertices(vertices, [x2, y2, 0], [x2, y1, 0], [x1, y1, 0], index);\n            g.setFaceUVs(uvs, [xx2, yy2], [xx2, yy1], [xx1, yy1], index2);\n            index += 9;\n            index2 += 6;\n        }\n    }\n\n    var bbox = new BBox(0,0,0,1,1,1);\n\n    if (use16bit) {\n        return { bbox:bbox, vertices:vertices, uvs: this.covnetTo16Bit(uvs)};\n    } else {\n        return { bbox:bbox, vertices:vertices, uvs: uvs};\n    }\n};\n\nRendererGeometry.spherePos = function(lon, lat) {\n    lat *= Math.PI;\n    lon *= 2*Math.PI;\n\n    return [Math.cos(lon)*Math.sin(lat)*0.5 + 0.5,\n        Math.sin(lon)*Math.sin(lat)*0.5 + 0.5,\n        Math.cos(lat) * 0.5 + 0.5];\n};\n\n\n// Creates an approximation of a unit sphere, note that all coords are\n// in the range [0..1] and the center is in (0.5, 0.5). Triangle \"normals\"\n// are oriented inwards.\nRendererGeometry.buildSkydome = function(latitudeBands, longitudeBands, use16bit, useIndices) {\n    var g = RendererGeometry;\n    var numFaces = (latitudeBands * longitudeBands) * 2;\n    var numVertices = (latitudeBands * longitudeBands) * (useIndices ? 1 : 3);\n    var vertices = new Float32Array(numVertices * 3);\n    var uvs = new Float32Array(numVertices * 2);\n    var indices = useIndices ? (new Uint16Array(numFaces * 3)) : null;\n    var index = 0, index2 = 0;\n    var g = RendererGeometry, lat, lon, lon2, lat2, v, flon, flat;\n\n    if (useIndices) {\n\n        for (lat = 0; lat < latitudeBands; lat++) {\n            for (lon = 0; lon < longitudeBands; lon++) {\n\n                flon = lon / longitudeBands;\n                flat = lat / latitudeBands;\n                v = g.spherePos(flon, flat);\n\n                vertices[index] = v[0];\n                vertices[index+1] = v[1];\n                vertices[index+2] = v[2];\n\n                uvs[index2] = flon;\n                uvs[index2+1] = flat;\n\n                index += 3;\n                index2 += 2;\n            }\n        }\n\n        index = 0;\n\n        for (lat = 0; lat < (latitudeBands - 1); lat++) {\n            for (lon = 0; lon < longitudeBands; lon++) {\n\n                lat2 = lat + 1;\n                lon2 = lon + 1;\n\n                if (lon2 >= longitudeBands) {\n                    lon2 = 0;\n                }\n\n                indices[index] = (lat2 * longitudeBands) + lon;\n                indices[index+1] = (lat * longitudeBands) + lon;\n                indices[index+2] = (lat * longitudeBands) + lon2;\n\n                indices[index+3] = (lat * longitudeBands) + lon2;\n                indices[index+4] = (lat2 * longitudeBands) + lon2;\n                indices[index+5] = (lat2 * longitudeBands) + lon;\n\n                index += 6;\n            }\n        }\n\n    } else {\n\n        for (var lat = 0; lat < latitudeBands; lat++) {\n            for (var lon = 0; lon < longitudeBands; lon++) {\n\n                var lon1 = ((lon) / longitudeBands);\n                var lon2 = ((lon+1) / longitudeBands);\n\n                var lat1 = ((lat) / latitudeBands);\n                var lat2 = ((lat+1) / latitudeBands);\n\n                g.makeQuad(lon1, lat1, lon2, lat2, vertices, index, uvs, index2);\n                index += 9*2;\n                index2 += 6*2;\n            }\n        }\n\n    }\n\n    var bbox = new BBox(0,0,0,1,1,1);\n\n    if (use16bit) {\n        return { bbox:bbox, vertices:this.covnetTo16Bit(vertices), uvs: this.covnetTo16Bit(uvs), indices:indices};\n    } else {\n        return { bbox:bbox, vertices:vertices, uvs: uvs, indices:indices};\n    }\n};\n\nRendererGeometry.covnetTo16Bit = function(array) {\n    var t, array2 = new Uint16Array(array.length);\n\n    for (var i = 0, li = array.length; i < li; i++) {\n        t = array[i] * 65535;\n        if (t < 0) t = 0; if (t > 65535) t = 65535;\n        array2[i] = t;\n    }\n\n    return array2;\n}\n\n\nRendererGeometry.makeQuad = function(lon1, lat1, lon2, lat2, vertices, index, uvs, index2) {\n    var g = RendererGeometry;\n    var a = g.spherePos(lon1, lat1), ta = [lon1, lat1];\n    var b = g.spherePos(lon1, lat2), tb = [lon1, lat2];\n    var c = g.spherePos(lon2, lat1), tc = [lon2, lat1];\n    var d = g.spherePos(lon2, lat2), td = [lon2, lat2];\n    g.setFaceVertices(vertices, b, a, c, index);\n    g.setFaceUVs(uvs, tb, ta, tc, index2);\n    g.setFaceVertices(vertices, c, d, b, index+9);\n    g.setFaceUVs(uvs, tc, td, tb, index2+6);\n};\n\n\nexport default RendererGeometry;\n\n\n","\n\nvar GpuBBox = function(gpu, free) {\n    this.gl = gpu.gl;\n\n    var gl = this.gl;\n\n    if (gl == null)\n        return;\n\n    this.free = free;\n    this.vertexPositionBuffer = null;\n\n    //create vertex buffer\n    this.vertexPositionBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexPositionBuffer);\n\n    var vertices;\n\n    if (free) {\n        vertices = [0,0,0, 0,0,1,\n            0,0,1, 0,0,2,\n            0,0,2, 0,0,3,\n            0,0,3, 0,0,0,\n\n            0,0,4, 0,0,5,\n            0,0,5, 0,0,6,\n            0,0,6, 0,0,7,\n            0,0,7, 0,0,4,\n\n            0,0,0, 0,0,4,\n            0,0,1, 0,0,5,\n            0,0,2, 0,0,6,\n            0,0,3, 0,0,7 ];\n    } else {\n        vertices = [0,0,0, 1,0,0,\n            1,0,0, 1,1,0,\n            1,1,0, 0,1,0,\n            0,1,0, 0,0,0,\n\n            0,0,1, 1,0,1,\n            1,0,1, 1,1,1,\n            1,1,1, 0,1,1,\n            0,1,1, 0,0,1,\n\n            0,0,0, 0,0,1,\n            1,0,0, 1,0,1,\n            1,1,0, 1,1,1,\n            0,1,0, 0,1,1 ];\n    }\n\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);\n    this.vertexPositionBuffer.itemSize = 3;\n    this.vertexPositionBuffer.numItems = vertices.length / 3;\n\n    this.size = 4 + 4 * 8;\n    this.lines = this.vertexPositionBuffer.numItems / 3;\n};\n\n//destructor\nGpuBBox.prototype.kill = function() {\n    this.gl.deleteBuffer(this.vertexPositionBuffer);\n};\n\n// Draws the mesh, given the two vertex shader attributes locations.\nGpuBBox.prototype.draw = function(program, attrPosition) {\n    var gl = this.gl;\n    if (gl == null)\n        return;\n\n    var vertexPositionAttribute = program.getAttribute(attrPosition);\n\n    //bind vetex positions\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexPositionBuffer);\n    gl.vertexAttribPointer(vertexPositionAttribute, this.vertexPositionBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n    //draw lines\n    gl.drawArrays(gl.LINES, 0, this.vertexPositionBuffer.numItems);\n\n};\n\n\nexport default GpuBBox;\n\n","\nvar GpuPixelLine3 = function(gpu, core, lines, maxLines, joins, joinSides) {\n    this.bbox = null;\n    this.gpu = gpu;\n    this.gl = gpu.gl;\n    this.core = core;\n\n    var gl = this.gl;\n\n    if (gl == null){\n        return;\n    }\n\n    this.vertices = [];\n    this.normals = [];\n    this.vertexBuffer = null;\n    this.lines = lines;\n    this.joins = joins;\n    this.joinSides = joinSides;\n    this.maxLines = maxLines;\n\n    this.init();\n};\n\n//destructor\nGpuPixelLine3.prototype.kill = function() {\n    this.gl.deleteBuffer(this.vertexBuffer);\n};\n\n\nGpuPixelLine3.prototype.init = function() {\n    var i;\n    if (this.lines) {\n        if (this.joins) {\n            this.addCircle(0, this.joinSides);\n        }\n\n        for (i = 0; i < this.maxLines; i++) {\n            this.addLine(i, i+1);\n\n            if (this.joins) {\n                this.addCircle(i+1, this.joinSides);\n            }\n        }\n    } else if (this.joins) {\n        for (i = 0; i <= this.maxLines; i++) {\n            this.addCircle(i, this.joinSides);\n        }\n    }\n\n    this.compile();\n};\n\n//add line to vertices buffer\nGpuPixelLine3.prototype.addLine = function(i1, i2) {\n    var index = this.vertices.length;\n\n    //first polygon\n    this.vertices[index] = i1;\n    this.vertices[index+1] = i2;\n    this.vertices[index+2] = 1;\n\n    this.vertices[index+3] = i1;\n    this.vertices[index+4] = i2;\n    this.vertices[index+5] = -1;\n\n    this.vertices[index+6] = i2;\n    this.vertices[index+7] = i1;\n    this.vertices[index+8] = 1;\n\n    //next polygon\n    this.vertices[index+9] = i1;\n    this.vertices[index+10] = i2;\n    this.vertices[index+11] = 1;\n\n    this.vertices[index+12] = i2;\n    this.vertices[index+13] = i1;\n    this.vertices[index+14] = 1;\n\n    this.vertices[index+15] = i2;\n    this.vertices[index+16] = i1;\n    this.vertices[index+17] = -1;\n\n    this.polygons += 2;\n};\n\n//add circle to vertices buffer\nGpuPixelLine3.prototype.addCircle = function(i1, sides) {\n    var index = this.vertices.length;\n    var step = (2.0*Math.PI) / sides;\n\n    for (var i = 0; i < sides; i++) {\n        this.vertices[index] = i1;\n        this.vertices[index+1] = -1;\n        this.vertices[index+2] = 0;\n\n        this.vertices[index+3] = i1;\n        this.vertices[index+4] = -2;\n        this.vertices[index+5] = step * i;\n\n        this.vertices[index+6] = i1;\n        this.vertices[index+7] = -2;\n        this.vertices[index+8] = step * (i+1);\n\n        index += 9;\n    }\n\n    this.polygons += sides;\n};\n\n//compile content of vertices buffer into gpu buffer\nGpuPixelLine3.prototype.compile = function() {\n    var gl = this.gl;\n\n    //create vertex buffer\n    this.vertexBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(this.vertices), gl.STATIC_DRAW);\n    this.vertexBuffer.itemSize = 3;\n    this.vertexBuffer.numItems = this.vertices.length / 3;\n\n    this.size = this.vertexBuffer.numItems * 3 * 4 * 2;\n    this.polygons = this.vertexBuffer.numItems / 3;\n};\n\n// Draws the mesh, given the two vertex shader attributes locations.\nGpuPixelLine3.prototype.draw = function(program, attrPosition, points) {\n    var gl = this.gl;\n    if (gl == null || this.vertexBuffer == null || points > this.maxLines){\n        return;\n    }\n\n    var vertexPositionAttribute = program.getAttribute(attrPosition);\n\n    //bind vetex positions\n    gl.bindBuffer(gl.ARRAY_BUFFER, this.vertexBuffer);\n    gl.vertexAttribPointer(vertexPositionAttribute, this.vertexBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n    var size = 0;\n\n    if (this.lines) {\n        size += ((points-1) * 3 * 2);\n    }\n\n    if (this.joins) {\n        size += points * (this.joinSides * 3);\n    }\n\n    //draw polygons\n    gl.drawArrays(gl.TRIANGLES, 0, size);\n};\n\n// Returns GPU RAM used, in bytes.\nGpuPixelLine3.prototype.getSize = function(){ return this.size; };\n\n\nGpuPixelLine3.prototype.getBbox = function(){ return this.bbox; };\n\n\nGpuPixelLine3.prototype.getPolygons = function(){ return this.polygons; };\n\n\nexport default GpuPixelLine3;","\nimport RendererGeometry_ from './geometry';\nimport GpuBBox_ from './gpu/bbox';\nimport GpuFont_ from './gpu/font';\nimport GpuMesh_ from './gpu/mesh';\nimport GpuPixelLine3_ from './gpu/pixel-line3';\nimport GpuProgram_ from './gpu/program';\nimport GpuShaders_ from './gpu/shaders';\nimport GpuTexture_ from './gpu/texture';\n\n//get rid of compiler mess\nvar RendererGeometry = RendererGeometry_;\nvar GpuBBox = GpuBBox_;\nvar GpuFont = GpuFont_;\nvar GpuMesh = GpuMesh_;\nvar GpuPixelLine3 = GpuPixelLine3_;\nvar GpuProgram = GpuProgram_;\nvar GpuShaders = GpuShaders_;\nvar GpuTexture = GpuTexture_;\n\n\nvar RendererInit = function(renderer) {\n    this.renderer = renderer;\n    this.core = renderer.core;\n    this.gpu = renderer.gpu;\n\n    //renderer.font = new GpuFont(this.gpu, this.core);\n    //renderer.fonts['#default'] = renderer.font;\n    //renderer.font = new GpuFont(this.gpu, this.core, null, null, './allinone.fnt');\n\n    this.initShaders();\n    this.initHeightmap();\n    this.initSkydome();\n    this.initHitmap();\n    this.initTextMap();\n    this.initImage();\n    this.initTestMap();\n    this.initBBox();\n    this.initLines();\n    this.initBaricentricBuffer();\n};\n\n\nRendererInit.prototype.initShaders = function() {\n    var shaders = GpuShaders;\n    var renderer = this.renderer;\n    var gpu = this.gpu;\n\n    renderer.progTile = [new GpuProgram(gpu, '#define variants\\n' +shaders.tileVertexShader, '#define variants\\n' + shaders.tileFragmentShader)];\n    renderer.progTile2 = [new GpuProgram(gpu, '#define variants\\n#define externalTex\\n' + shaders.tileVertexShader, '#define variants\\n#define externalTex\\n' + shaders.tileFragmentShader.replace('__FILTER__', ''))];\n    renderer.progTile3 = [new GpuProgram(gpu, '#define variants\\n#define externalTex\\n' + shaders.tileVertexShader, '#define variants\\n#define externalTex\\n#define mask\\n' + shaders.tileFragmentShader.replace('__FILTER__', ''))];\n\n    renderer.progFogTile = [new GpuProgram(gpu, '#define variants\\n#define onlyFog\\n' + shaders.tileVertexShader, '#define variants\\n#define onlyFog\\n' + shaders.tileFragmentShader)];\n\n    var sdExt = '#extension GL_OES_standard_derivatives : enable\\n';\n\n    renderer.progFlatShadeTile = [new GpuProgram(gpu, '#define variants\\n#define flatShadeVar\\n' + shaders.tileVertexShader, sdExt+'#define variants\\n#define flatShadeVar\\n#define flatShade\\n' + shaders.tileFragmentShader)];\n    renderer.progFlatShadeTileSE = [new GpuProgram(gpu, '#define variants\\n#define applySE\\n#define flatShadeVar\\n' + shaders.tileVertexShader, sdExt+'#define variants\\n#define flatShadeVar\\n#define flatShade\\n' + shaders.tileFragmentShader)];\n    renderer.progCFlatShadeTile = new GpuProgram(gpu, '#define flatShadeVar\\n' + shaders.tileVertexShader, (sdExt+'#define flatShadeVar\\n#define flatShade\\n#define fogAndColor\\n' + shaders.tileFragmentShader).replace('mediump', 'highp'));\n    renderer.progCFlatShadeTileSE = new GpuProgram(gpu, '#define applySE\\n#define flatShadeVar\\n' + shaders.tileVertexShader, (sdExt+'#define flatShadeVar\\n#define flatShade\\n#define fogAndColor\\n' + shaders.tileFragmentShader).replace('mediump', 'highp'));\n\n    renderer.progDepthTile = [new GpuProgram(gpu, '#define variants\\n#define depth\\n' + shaders.tileVertexShader, ('#define variants\\n#define depth\\n' + shaders.tileFragmentShader).replace('mediump', 'highp'))];\n    renderer.progDepthHeightmap = new GpuProgram(gpu, shaders.heightmapDepthVertexShader, (shaders.heightmapDepthFragmentShader).replace('mediump', 'highp'));\n\n    renderer.progWireFrameBasic = [new GpuProgram(gpu, '#define variants\\n' + shaders.tileVertexShader, '#define variants\\n' + shaders.tileWireFrameBasicShader)];\n\n    renderer.progShadedTile = new GpuProgram(gpu, shaders.shadedMeshVertexShader, shaders.shadedMeshFragmentShader);\n    renderer.progTShadedTile = new GpuProgram(gpu, shaders.shadedMeshVertexShader, '#define textured\\n' + shaders.shadedMeshFragmentShader);\n\n    renderer.progHeightmap = new GpuProgram(gpu, shaders.heightmapVertexShader, shaders.heightmapFragmentShader);\n    renderer.progPlane = new GpuProgram(gpu, '#define flat\\n' + shaders.planeVertexShader, shaders.planeFragmentShader); //flat\n    renderer.progPlane2 = new GpuProgram(gpu, '#define poles\\n' + shaders.planeVertexShader, '#define poles\\n' + shaders.planeFragmentShader); //poles\n    renderer.progPlane3 = new GpuProgram(gpu, shaders.planeVertexShader, shaders.planeFragmentShader); // grid\n    renderer.progPlaneD = new GpuProgram(gpu, '#define depth\\n#define flat\\n' + shaders.planeVertexShader, '#define depth\\n' + shaders.planeFragmentShader); //flat\n    renderer.progPlane2D = new GpuProgram(gpu, '#define depth\\n#define poles\\n' + shaders.planeVertexShader, '#define depth\\n#define poles\\n' + shaders.planeFragmentShader); //poles\n    renderer.progPlane3D = new GpuProgram(gpu, '#define depth\\n' + shaders.planeVertexShader, '#define depth\\n' + shaders.planeFragmentShader); // grid\n\n    renderer.progSkydome = new GpuProgram(gpu, shaders.skydomeVertexShader, shaders.skydomeFragmentShader);\n    renderer.progStardome = new GpuProgram(gpu, shaders.skydomeVertexShader, shaders.stardomeFragmentShader);\n    \n    renderer.progAtmo2 = new GpuProgram(gpu, shaders.atmoVertexShader, shaders.atmoFragmentShader);\n    renderer.progAtmo = new GpuProgram(gpu, shaders.atmoVertexShader3, shaders.atmoFragmentShader3);\n\n    renderer.progBBox = new GpuProgram(gpu, shaders.bboxVertexShader, shaders.bboxFragmentShader);\n    renderer.progBBox2 = new GpuProgram(gpu, shaders.bbox2VertexShader, shaders.bboxFragmentShader);\n\n    renderer.progLine = new GpuProgram(gpu, shaders.lineVertexShader, shaders.lineFragmentShader); //line\n    renderer.progLineSE = new GpuProgram(gpu, '#define applySE\\n' + shaders.lineVertexShader, shaders.lineFragmentShader); //line SE\n    renderer.progELine = new GpuProgram(gpu, '#define withElements\\n' + shaders.lineVertexShader, '#define withElements\\n' + shaders.lineFragmentShader); //line elements \n    renderer.progELineSE = new GpuProgram(gpu, '#define applySE\\n#define withElements\\n' + shaders.lineVertexShader, '#define withElements\\n' + shaders.lineFragmentShader); //line SE elements \n    renderer.progLine3 = new GpuProgram(gpu, '#define pixelLine\\n' + shaders.lineVertexShader, shaders.lineFragmentShader); //pixel line\n    renderer.progELine3 = new GpuProgram(gpu, '#define pixelLine\\n#define withElements\\n' + shaders.lineVertexShader, '#define withElements\\n' + shaders.lineFragmentShader); //pixel line elements\n    renderer.progLine3SE = new GpuProgram(gpu, '#define applySE\\n#define pixelLine\\n' + shaders.lineVertexShader, shaders.lineFragmentShader); //pixel line SE\n    renderer.progELine3SE = new GpuProgram(gpu, '#define applySE\\n#define pixelLine\\n#define withElements\\n' + shaders.lineVertexShader, '#define withElements\\n' + shaders.lineFragmentShader); //pixel line SE elements\n    renderer.progLine4 = new GpuProgram(gpu, '#define pixelLine\\n#define dataPoints\\n' + shaders.lineVertexShader, shaders.lineFragmentShader); //direct linestring pixel line\n    renderer.progLine5 = new GpuProgram(gpu, '#define pixelLine\\n#define dataPoints\\n#define dataPoints2\\n' + shaders.lineVertexShader, shaders.lineFragmentShader); //clipped direct linestring pixel line, physical coords\n    renderer.progRLine = new GpuProgram(gpu, '#define dynamicWidth\\n' + shaders.lineVertexShader, shaders.lineFragmentShader); //dynamic width line\n    renderer.progRLineSE = new GpuProgram(gpu, '#define applySE\\n#define dynamicWidth\\n' + shaders.lineVertexShader, shaders.lineFragmentShader); //dynamic width line\n    renderer.progERLine = new GpuProgram(gpu, '#define dynamicWidth\\n#define withElements\\n' + shaders.lineVertexShader, '#define withElements\\n' + shaders.lineFragmentShader); //dynamic width line elements\n    renderer.progERLineSE = new GpuProgram(gpu, '#define applySE\\n#define dynamicWidth\\n#define withElements\\n' + shaders.lineVertexShader, '#define withElements\\n' + shaders.lineFragmentShader); //dynamic width line elements\n\n    renderer.progTLine = new GpuProgram(gpu, shaders.tlineVertexShader, shaders.tlineFragmentShader); //textured line\n    renderer.progTPLine = new GpuProgram(gpu, shaders.tplineVertexShader, shaders.tlineFragmentShader); //textured pixed line\n    renderer.progTBLine = new GpuProgram(gpu, shaders.tlineVertexShader, shaders.tblineFragmentShader); //textured line with background color\n    renderer.progTPBLine = new GpuProgram(gpu, shaders.tplineVertexShader, shaders.tblineFragmentShader); //textured pixel line with background color\n    renderer.progETLine = new GpuProgram(gpu, shaders.etlineVertexShader, shaders.elineFragmentShader); //textured line elements\n    renderer.progETPLine = new GpuProgram(gpu, shaders.etplineVertexShader, shaders.elineFragmentShader); //textured pixed line elements\n    //renderer.progLineWireframe = new GpuProgram(gpu, shaders.lineWireframeVertexShader, shaders.lineWireframeFragmentShader); //line with wireframe for debugging\n\n    renderer.progText2 = new GpuProgram(gpu, '#define lineLabel\\n' + shaders.lineVertexShader, shaders.text2FragmentShader); //line label \n    renderer.progText2SE = new GpuProgram(gpu, '#define applySE\\n#define lineLabel\\n' + shaders.lineVertexShader, shaders.text2FragmentShader); //line label \n\n    renderer.progLineLabel16 = new GpuProgram(gpu, '#define DSIZE 16\\n#define lineLabel2\\n' + shaders.lineVertexShader, shaders.text2FragmentShader); \n    renderer.progLineLabel32 = new GpuProgram(gpu, '#define DSIZE 32\\n#define lineLabel2\\n' + shaders.lineVertexShader, shaders.text2FragmentShader); \n    renderer.progLineLabel48 = new GpuProgram(gpu, '#define DSIZE 48\\n#define lineLabel2\\n' + shaders.lineVertexShader, shaders.text2FragmentShader); \n    renderer.progLineLabel64 = new GpuProgram(gpu, '#define DSIZE 64\\n#define lineLabel2\\n' + shaders.lineVertexShader, shaders.text2FragmentShader); \n    renderer.progLineLabel96 = new GpuProgram(gpu, '#define DSIZE 96\\n#define lineLabel2\\n' + shaders.lineVertexShader, shaders.text2FragmentShader); \n    renderer.progLineLabel128 = new GpuProgram(gpu, '#define DSIZE 128\\n#define lineLabel2\\n' + shaders.lineVertexShader, shaders.text2FragmentShader); \n\n    renderer.progPolygon = new GpuProgram(gpu, shaders.polygonVertexShader, shaders.polygonFragmentShader);\n    renderer.progImage = new GpuProgram(gpu, shaders.imageVertexShader, shaders.imageFragmentShader);\n    renderer.progIcon = new GpuProgram(gpu, shaders.iconVertexShader, shaders.textFragmentShader); //label or icon\n    renderer.progIcon2 = new GpuProgram(gpu, shaders.icon2VertexShader, shaders.text2FragmentShader); //label\n\n    renderer.progLabel16 = new GpuProgram(gpu, '#define DSIZE 16\\n' + shaders.icon3VertexShader, shaders.text2FragmentShader); //label with singleBuffer\n    renderer.progLabel32 = new GpuProgram(gpu, '#define DSIZE 32\\n' + shaders.icon3VertexShader, shaders.text2FragmentShader);\n    renderer.progLabel48 = new GpuProgram(gpu, '#define DSIZE 48\\n' + shaders.icon3VertexShader, shaders.text2FragmentShader);\n    renderer.progLabel64 = new GpuProgram(gpu, '#define DSIZE 64\\n' + shaders.icon3VertexShader, shaders.text2FragmentShader);\n    renderer.progLabel96 = new GpuProgram(gpu, '#define DSIZE 96\\n' + shaders.icon3VertexShader, shaders.text2FragmentShader); \n    renderer.progLabel128 = new GpuProgram(gpu, '#define DSIZE 128\\n' + shaders.icon3VertexShader, shaders.text2FragmentShader); \n};\n\nRendererInit.prototype.initProceduralShaders = function() {\n    var shaders = GpuShaders;\n    var renderer = this.renderer;\n    var gpu = this.gpu;\n    renderer.progHmapPlane = new GpuProgram(gpu, shaders.planeVertex4Shader, shaders.planeFragmentShader2);\n    renderer.progHmapPlane2 = new GpuProgram(gpu, shaders.planeVertex4Shader, '#define grid\\n' + shaders.planeFragmentShader2);\n    renderer.progHmapPlane3 = new GpuProgram(gpu, shaders.planeVertex4Shader, '#define exmap\\n' + shaders.planeFragmentShader2);\n    renderer.progHmapPlane4 = new GpuProgram(gpu, shaders.planeVertex4Shader, '#define flat\\n' + shaders.planeFragmentShader2);\n    renderer.progHmapPlane5 = new GpuProgram(gpu, shaders.planeVertex4Shader, '#define normals\\n' + shaders.planeFragmentShader2);\n    renderer.progHmapPlane6 = new GpuProgram(gpu, shaders.planeVertex4Shader, '#define nmix\\n#define normals\\n' + shaders.planeFragmentShader2);\n    renderer.progHmapPlane7 = new GpuProgram(gpu, shaders.planeVertex4Shader, '#define nmix\\n' + shaders.planeFragmentShader2);\n    renderer.progHmapPlane8 = new GpuProgram(gpu, shaders.planeVertex4Shader, '#define exmap\\n#define classmap\\n' + shaders.planeFragmentShader2);\n}\n\nRendererInit.prototype.initHeightmap = function() {\n    var renderer = this.renderer;\n    var use16Bit = renderer.core.config.map16bitMeshes;\n    var gpu = this.gpu;\n\n    // initialize heightmap geometry\n    var meshData = RendererGeometry.buildHeightmap(5, true);\n    //renderer.heightmapMesh = new GpuMesh(gpu, meshData, null, this.core, true, use16Bit);\n\n    meshData = RendererGeometry.buildPlane(16, true);\n    renderer.planeMesh = new GpuMesh(gpu, meshData, null, this.core, true, use16Bit, true);\n\n    meshData = RendererGeometry.buildPlane(128, true);\n    renderer.planeMesh2 = new GpuMesh(gpu, meshData, null, this.core, true, use16Bit, true);\n\n    // create heightmap texture\n    var size = 64;\n    var halfLineWidth = 1;\n    var data = new Uint8Array( size * size * 4 );\n\n    for (var i = 0; i < size; i++) {\n        for (var j = 0; j < size; j++) {\n\n            var index = (i*size+j)*4;\n\n            if (i < halfLineWidth || i >= size-halfLineWidth || j < halfLineWidth || j >= size-halfLineWidth) {\n                data[index] = 255;\n                data[index + 1] = 255;\n                data[index + 2] = 255;\n            } else {\n                data[index] = 32;\n                data[index + 1] = 32;\n                data[index + 2] = 32;\n            }\n\n            data[index + 3] = 255;\n        }\n    }\n\n\n    renderer.heightmapTexture = new GpuTexture(gpu);\n    renderer.heightmapTexture.createFromData(size, size, data, 'trilinear', true);\n};\n\n\nRendererInit.prototype.initHitmap = function() {\n    var renderer = this.renderer;\n    var size = renderer.hitmapSize;\n    var data = new Uint8Array( size * size * 4 );\n\n    if (renderer.hitmapMode > 2) {\n        renderer.hitmapData = data;\n    }\n\n    renderer.hitmapTexture = new GpuTexture(this.gpu);\n    renderer.hitmapTexture.createFromData(size, size, data);\n    renderer.hitmapTexture.createFramebuffer(size, size);\n\n    renderer.geoHitmapTexture = new GpuTexture(this.gpu);\n    renderer.geoHitmapTexture.createFromData(size, size, data);\n    renderer.geoHitmapTexture.createFramebuffer(size, size);\n\n    renderer.geoHitmapTexture2 = new GpuTexture(this.gpu);\n    renderer.geoHitmapTexture2.createFromData(size, size, data);\n    renderer.geoHitmapTexture2.createFramebuffer(size, size);\n};\n\n\nRendererInit.prototype.initTestMap = function() {\n    var renderer = this.renderer;\n    var gpu = this.gpu;\n\n   // create red texture\n    var size = 16, i, j, index;\n    var data = new Uint8Array( size * size * 4 );\n\n    for (i = 0; i < size; i++) {\n        for (j = 0; j < size; j++) {\n            index = (i*size+j)*4;\n            data[index] = 255;\n            data[index + 1] = 0;\n            data[index + 2] = 0;\n            data[index + 3] = 255;\n        }\n    }\n\n    renderer.redTexture = new GpuTexture(gpu);\n    renderer.redTexture.createFromData(size, size, data);\n\n    data = new Uint8Array( size * size * 4 );\n\n    for (i = 0; i < size; i++) {\n        for (j = 0; j < size; j++) {\n            index = (i*size+j)*4;\n            data[index] = 255;\n            data[index + 1] = 255;\n            data[index + 2] = 255;\n            data[index + 3] = 255;\n        }\n    }\n\n    renderer.whiteTexture = new GpuTexture(gpu);\n    renderer.whiteTexture.createFromData(size, size, data);\n\n    data = new Uint8Array( size * size * 4 );\n\n    for (i = 0; i < size; i++) {\n        for (j = 0; j < size; j++) {\n            index = (i*size+j)*4;\n            data[index] = 0;\n            data[index + 1] = 0;\n            data[index + 2] = 0;\n            data[index + 3] = 255;\n        }\n    }\n\n    renderer.blackTexture = new GpuTexture(gpu);\n    renderer.blackTexture.createFromData(size, size, data);\n};\n\n\nRendererInit.prototype.initTextMap = function() {\n    var renderer = this.renderer;\n\n    //font texture\n    var texture = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAQAAAACACAMAAADTa0c4AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAAZQTFRFAAAA////pdmf3QAABIFJREFUeNrsnNuyqzAIhsP7v/Se6Yxra0L4OUVNCzetVqP5DAQItrVOiLg95739NnfOaR99RDj6esBw+CKZXiMK4PiuBkAcANoHAP3J5fzzAV2jePQIt6f4Ndb/MIChlVcCEFpAACZPfN4KUAF0/ufboDW3AuBMFgBwHTCfg2ftYgDUKBuA1ABuHKvA2P+5XdONIEt7BO2o2MdlAJoTQOsV6GEAswt0Zq/bsBhdeQQkqEDMwmIAnJHzA8i3ASkWRFKBbADyLGB3mlYD6DyhA4DfBlgsBDtirUPcBgC5woStYMgVtgKATWcB6DskKUEkGFLYrGw3+l3ydR16wKbbPDlWp4Xfo9vZwR1jtOMA6GkABrdvNmt1Vluy6pyvxu4Xt62fquyTggCTsIkCoIuv8gAA08w+ATBXAdSRY56xPDFPx/VPWFZp5v65kFMPgFjP70YASMfRsDn01xLPcwkRq1HLMoK647hR8v+nId74MQBjvIbUQePra42ZVXVcBCR3mIY89mYAlNGLflqA0V1seosCQNMg80B0bsLGAIDNwvFyiqu66ngVGGMGVBwyWwIwpty2DqEr/qf0Bq+DbjYkkcr4VUoOxiRjrYn3YY5SC4BQB/cF0Lq4kD1RCJ+tN4g6Jps5zfWu+QmSz9sUABkA0BIAXocmBwCJ99MDIASATkmtLQAIft4IgE/ZDStZ59yQbOQQAGZWYMbZ3FFCAGRHnwHQznegGAE+zwxNi8kALCOgS9tzAC4jYG1Qo0myRm0Ae/z8eleqewBoZLwfUswCsbT1KgBZD6QAzAEoXUe3K+xxVf2uLf5U3nBeMPRyACW/LtrwVX989id3PRQOG5Io6vh9XwC6stHIdGdJozun03lxNlwvH4u6UgDM8/LmJyx7ak12feEebaXmUwCOYJWk1JcYKsl74HL74wAaH93NqkE1FSKXc4cv0AjaPEEPgE4ru/ieWdvzVq/4psG3AYDFHlEAioQCuEgMgPjK1VDrqlkbTABAiQBGK38B0BlBSf9xtiAJQDM4NtDqMlaeyduTtkDjHgAtEQBj5ZGK2QE0aCcMAIxLSw0WVYlGDgOQXWE+afouAM0S398O4Nej3wIQf4cIHSfz9pbWugyep4MFIAFARvspbm8BcE2DOdvWnCJQAWFhJ/hKzh4AaB2A7NxedKmLPc+6PN4cL2S8GYC1QMIEQJvmFsJfxdvkEQAoLV4AogBS8/kNvdXlWe5GKhABvQUAZASDALJffY1XfsrToFXFbvYD1gBo6wC8LR7/uvj9CwHcfWuoUJItsVl5nwWAnhxxqsXatUq0OYCcaS/fkbK61u5H8jwAuUIEZXHNL1Jmub5oSKZWiDR9FttM4HEAigqRpn8TeB2AuWNiByAXSHCGbB7/3qYCfgCgPgADEEskbjCCaJDB/+kR6wP4P1Obl8jsBwDUB4yAxqKkthaATjX0KmCtDyCxm+yIMLjCbwBgrg94FYC3h8vLPPmfAVBSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlJSUlLy9fJPgAEAvWMULbGsSjwAAAAASUVORK5CYII=';\n    renderer.textTexture2 = new GpuTexture(this.gpu, texture, this.core, null, true);\n};\n\n\nRendererInit.prototype.initImage = function() {\n    var renderer = this.renderer;\n    var gl = this.gpu.gl;\n\n    //create vertices buffer for rect\n    renderer.rectVerticesBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, renderer.rectVerticesBuffer);\n\n    var vertices = [ 0, 0, 0, 1,   1, 0, 0, 1,   2, 0, 0, 1,   3, 0, 0, 1 ];\n\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(vertices), gl.STATIC_DRAW);\n    renderer.rectVerticesBuffer.itemSize = 4;\n    renderer.rectVerticesBuffer.numItems = 4;\n\n    //create indices buffer for rect\n    renderer.rectIndicesBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, renderer.rectIndicesBuffer);\n\n    var indices = [ 0, 2, 1,    0, 3, 2 ];\n\n    gl.bufferData(gl.ELEMENT_ARRAY_BUFFER, new Uint16Array(indices), gl.STATIC_DRAW);\n    renderer.rectIndicesBuffer.itemSize = 1;\n    renderer.rectIndicesBuffer.numItems = 6;\n\n    renderer.textBuff16 = new Float32Array(16 * 4);\n    renderer.textBuff32 = new Float32Array(32 * 4);\n    renderer.textBuff48 = new Float32Array(48 * 4);\n    renderer.textBuff64 = new Float32Array(64 * 4);\n\n    renderer.textQuads16 = this.generateTextQuads(16);\n    renderer.textQuads32 = this.generateTextQuads(32);\n    renderer.textQuads48 = this.generateTextQuads(48);\n    renderer.textQuads64 = this.generateTextQuads(64);\n    renderer.textQuads96 = this.generateTextQuads(96);\n    renderer.textQuads128 = this.generateTextQuads(128);\n};\n\n\nRendererInit.prototype.generateTextQuads = function(num) {\n    var renderer = this.renderer;\n    var gl = this.gpu.gl;\n\n    var buffer = new Float32Array(num * 2 * 6);\n    var index, j;\n\n    for (var i = 0; i < num; i++) {\n        index = i * 6 * 2;\n\n        j = 0;\n        buffer[index] = i;\n        buffer[index+1] = j;\n\n        j = 1;\n        buffer[index+2] = i;\n        buffer[index+3] = j;\n\n        j = 2;\n        buffer[index+4] = i;\n        buffer[index+5] = j;\n\n        j = 2;\n        buffer[index+6] = i;\n        buffer[index+7] = j;\n\n        j = 3;\n        buffer[index+8] = i;\n        buffer[index+9] = j;\n\n        j = 0;\n        buffer[index+10] = i;\n        buffer[index+11] = j;\n    }\n\n    //create vertices buffer for rect\n    var vbuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, vbuffer);\n\n    gl.bufferData(gl.ARRAY_BUFFER, buffer, gl.STATIC_DRAW);\n    vbuffer.itemSize = 2;\n    vbuffer.numItems = num * 6;\n\n    return vbuffer;\n};\n\nRendererInit.prototype.initSkydome = function() {\n    var renderer = this.renderer;\n    var use16Bit = renderer.core.config.map16bitMeshes;\n    var meshData = RendererGeometry.buildSkydome(32, 64, use16Bit);\n    renderer.skydomeMesh = new GpuMesh(this.gpu, meshData, null, this.core, true, use16Bit);\n    //this.skydomeTexture = new GpuTexture(this.gpu, \"./skydome.jpg\", this.core);\n\n    meshData = RendererGeometry.buildSkydome(128, 256, use16Bit, true);\n//    var meshData = RendererGeometry.buildSkydome(256, 512);\n    renderer.atmoMesh = new GpuMesh(this.gpu, meshData, null, this.core, true, use16Bit);\n};\n\n\nRendererInit.prototype.initBBox = function() {\n    var renderer = this.renderer;\n    var gpu = this.gpu;\n    renderer.bboxMesh = new GpuBBox(gpu);\n    renderer.bboxMesh2 = new GpuBBox(gpu, true);\n};\n\n\nRendererInit.prototype.initLines = function() {\n    var gpu = this.gpu;\n    var renderer = this.renderer;\n    renderer.plineBuffer = new Float32Array(32*3);\n    renderer.plines = new GpuPixelLine3(gpu, this.core, true, 64, true, 8);\n    renderer.plineJoints = new GpuPixelLine3(gpu, this.core, false, 64, true, 8);\n\n    renderer.stencilLineState = gpu.createState({blend:true, stencil:true, culling: false});\n    renderer.lineLabelState = gpu.createState({blend:true, culling: false, zequal: true, zwrite:false});\n    renderer.labelState = gpu.createState({blend:true, culling: false, zequal: true});\n    renderer.stencilLineHitState = gpu.createState({blend:false, stencil:true, culling: false});\n    renderer.lineLabelHitState = gpu.createState({blend:false, culling: false});\n\n    renderer.polygonB1S1C1tate = gpu.createState({blend:true, stencil:true, culling: true, zequal: true});\n    renderer.polygonB1S0C1tate = gpu.createState({blend:true, stencil:false, culling: true, zequal: true});\n    renderer.polygonB1S1C0tate = gpu.createState({blend:true, stencil:true, culling: false, zequal: true});\n    renderer.polygonB1S0C0tate = gpu.createState({blend:true, stencil:false, culling: false, zequal: true});\n\n    renderer.polygonB0S1C1tate = gpu.createState({blend:false, stencil:true, culling: true, zequal: true});\n    renderer.polygonB0S0C1tate = gpu.createState({blend:false, stencil:false, culling: true, zequal: true});\n    renderer.polygonB0S1C0tate = gpu.createState({blend:false, stencil:true, culling: false, zequal: true});\n    renderer.polygonB0S0C0tate = gpu.createState({blend:false, stencil:false, culling: false, zequal: true});\n\n};\n\n\nRendererInit.prototype.initBaricentricBuffer = function() {\n    var gpu = this.gpu;\n    var buffer = new Array(65535*3);\n\n    for (var i = 0; i < 65535*3; i+=9) {\n        buffer[i] = 1.0;\n        buffer[i+1] = 0;\n        buffer[i+2] = 0;\n\n        buffer[i+3] = 0;\n        buffer[i+4] = 1.0;\n        buffer[i+5] = 0;\n\n        buffer[i+6] = 0;\n        buffer[i+7] = 0;\n        buffer[i+8] = 1.0;\n    }\n\n    var gl = gpu.gl;\n    gpu.barycentricBuffer = gl.createBuffer();\n    gl.bindBuffer(gl.ARRAY_BUFFER, gpu.barycentricBuffer);\n\n    gl.bufferData(gl.ARRAY_BUFFER, new Float32Array(buffer), gl.STATIC_DRAW);\n    gpu.barycentricBuffer.itemSize = 3;\n    gpu.barycentricBuffer.numItems = buffer.length / 3;\n};\n\n\nexport default RendererInit;\n","\n\nfunction processGMap(gpu, gl, renderer, screenPixelSize, draw) {\n    if (!renderer.config.mapFeaturesReduceParams) {\n        return;\n    }\n\n    var tileCount = renderer.config.mapFeaturesReduceParams[1]; //31; //labelGridCells\n    var featuresPerSquareInch = renderer.config.mapFeaturesReduceParams[0]; //0.6614; //labelsPerSquareInch\n    var ppi = 96 * (window.devicePixelRatio || 1);\n    var screenLX = renderer.curSize[0];\n    var screenLY = renderer.curSize[1];\n    var featureCount = Math.ceil((screenLX/ppi)*(screenLY/ppi)*featuresPerSquareInch); \n    var i, li, top = renderer.config.mapFeaturesSortByTop;\n\n    if (tileCount <= 0) {\n        tileCount = featureCount * 2; //31; //labelGridCells\n    } else {\n        tileCount = tileCount;\n    }\n\n    //renderer.debugStr = '<br>featuresPerScr: ' + featureCount + '<br>gridCells: ' + tileCount + '';\n\n    //get top features\n    var featureCache = renderer.gmap;\n    var featureCacheSize = renderer.gmapIndex;\n    var topFeatures = renderer.gmapTop;\n    var featureCount2 = featureCount;\n\n    if (featureCount > featureCacheSize) {\n        featureCount2 = featureCacheSize;\n    }\n\n    //distribute top features\n    var tileSize = Math.floor(Math.sqrt((screenLX*screenLY) / tileCount));\n    var hitMap = renderer.gmapHit, usedFeatures = 0;\n    var tileFeatures, count, feature, job;\n    var drawAllLabels = renderer.drawAllLabels;\n\n    var colors = [\n        [0, 0, 255, 255],\n        [128, 0, 255, 255],\n        [255, 0, 0, 255],\n        [255, 128, 0, 255],\n        [0, 255, 0, 255],\n        [0, 255, 128, 255],\n        [128, 255, 128, 255]\n    ];\n\n    var colorIndex = 0;\n\n    do {\n        var a,b,c,d,ix,iy,is,pp,tx,ty,mx,my,v,index,o,j;\n\n        ix = screenLX / tileSize;\n        iy = screenLY / tileSize;\n        is = ix * iy;\n        mx = Math.floor(ix);\n        my = Math.floor(iy);\n        ix = ix - mx;\n        iy = iy - my;\n\n        a = 1 / is;\n        b = ix / is;\n        c = iy / is;\n        d = (ix*iy) / is;\n\n        a = Math.floor(a * featureCount);\n        b = Math.floor(b * featureCount);\n        c = Math.floor(c * featureCount);\n        d = Math.floor(d * featureCount);\n\n        var hitMap = renderer.gmapStore;\n        var hitMapCount = renderer.gmapHit;\n\n        if (renderer.drawGridCells) {\n            gpu.setState(renderer.lineLabelState);\n\n            var x = 0, y = 0, j, lj;\n\n            for (j = 0, lj = (my + 1); j < lj; j++) {\n                for (i = 0, li = (mx + 1); i < li; i++) {\n                    x = tileSize * i;\n                    y = tileSize * j;\n\n                    v = a;\n\n                    if (i >= mx) {\n                        if (j >= my) {\n                            v =d;\n                        } else {\n                            v = b;\n                        }\n\n                    } else {\n                        if (j >= my) {\n                            v = b;\n                        }\n                    }\n\n                    draw.drawLineString([[x, y, 0.5], [x+tileSize, y, 0.5],\n                                         [x+tileSize, y+tileSize, 0.5], [x, y+tileSize, 0.5]], true, 1, colors[colorIndex], null, true, null, null, null);\n\n                    draw.drawText(Math.round(x+5), Math.round(y + 5 + colorIndex * 15), 10, '' + v, colors[colorIndex], 0.5);\n                }\n            }\n\n        }\n\n\n        //clear hit-map\n        for (i = 0, li = (mx+1) * (my+1); i < li; i++) {\n            hitMap[i] = null;\n        }\n\n        for (i = 0, li = featureCacheSize; i < li; i++) {\n            feature = featureCache[i];\n            if (!feature) {\n                continue;\n            }\n\n            pp = feature[5];\n\n            if (pp[0] < 30 || pp[0] >= (screenLX-30) || pp[1] < 30 || pp[1] >= (screenLY-30)) {\n                featureCache[i] = null;\n                continue;\n            }\n\n            tx = pp[0] / tileSize;\n            ty = pp[1] / tileSize;\n\n            if (tx > mx) {\n                if (ty > my) {\n                    v = d;\n                } else {\n                    v = b;\n                }\n            } else if (ty > my) {\n                v = c;\n            } else {\n                v = a;\n            }\n\n            if (v > 0) {\n                index = Math.floor(tx) + Math.floor(ty) * (mx + 1);\n\n                tileFeatures = hitMap[index];\n\n                if (tileFeatures) {\n                    hitMap[index].push(i);\n                } else {\n                    hitMap[index] = [i];\n                    hitMapCount[index] = v;\n                }\n            }\n        }\n\n        for (i = 0, li = (mx+1) * (my+1); i < li; i++) {\n            tileFeatures = hitMap[i];\n\n            if (tileFeatures && tileFeatures.length) {\n                count = hitMapCount[i];\n\n                if (count > tileFeatures.length) {\n                    count = tileFeatures.length;\n                }\n\n                sortFeatures(tileFeatures, top, count, renderer);\n\n                for (j = 0; j < count; j++){\n                    index = topFeatures[j]\n                    feature = featureCache[index];\n                    topFeatures[j] = null;\n                    featureCache[index] = null;\n                    job = feature[0];\n\n                    //render job\n                    if (!drawAllLabels && feature[6]) { //no-overlap \n                        pp = feature[5];\n                        o = feature[8];\n\n                        if (!renderer.rmap.addRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], feature[7], feature[0].lastSubJob)) {\n                        }\n\n                        if (job.type == VTS_JOB_LINE_LABEL) {\n                            if (renderer.rmap.addLineLabel(job.lastSubJob, depthParams)) {\n                                //renderer.rmap.storeRemovedLineLabel(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], feature[7], feature[0].lastSubJob);\n                            }\n                        } else {\n                            if (renderer.rmap.addRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], feature[7], job.lastSubJob, true, depthParams)) {\n                                renderer.rmap.storeRemovedRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], feature[7], feature[0].lastSubJob);\n                            }\n                        }\n\n                    } else {\n                        if (job.hysteresis) {\n                            renderer.jobHBuffer[job.id] = job;\n                        } else {\n                            renderer.drawnJobs++;\n\n                            if (job.type == VTS_JOB_LINE_LABEL) {\n                                draw.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                            } else {\n                                draw.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                            }\n                        }\n                    }\n                }\n\n            }\n        }\n\n        a *= mx * my;\n        b *= mx;\n        c *= my;\n\n        usedFeatures += a + b + c + d;\n        featureCount -= a + b + c + d;\n        tileSize *= 2;\n\n        colorIndex++;\n\n    } while(usedFeatures < featureCount2);\n\n}\n\n\nfunction sortFeatures(features, top, count, renderer) {\n    var value, feature;\n    var currentIndex = 0;\n    var currentValue2 = top ? Number.POSITIVE_INFINITY : Number.NEGATIVE_INFINITY;\n    var topFeatures = renderer.gmapTop;\n    var topFeaturesIndex = 0;\n    var topFeaturesIndex2 = 0;\n\n    //remove feature from cache\n    var featureCache = renderer.gmap, index;\n\n\n    do {\n        var currentValue = top ? Number.NEGATIVE_INFINITY : Number.POSITIVE_INFINITY;\n        topFeaturesIndex2 = topFeaturesIndex;\n\n        for (var i = 0, li = features.length; i < li; i++) {\n            index = features[i];\n            feature = featureCache[index];\n            value = feature[0].reduce[1];\n\n            if (((top && value >= currentValue && value < currentValue2) || (value <= currentValue && value > currentValue2)) ) {\n                if (currentValue != value) {\n                    topFeaturesIndex = topFeaturesIndex2;\n                }\n\n                topFeatures[topFeaturesIndex] = index;\n                topFeaturesIndex++;\n                currentValue = value;\n            }\n        }\n\n        currentValue2 = currentValue;\n        currentIndex++;\n\n    } while(currentIndex < count);\n\n}\n\nfunction storeFeatureToHitmap(id, feature, ix, iy, mx, my, hitMap, hcache, hcacheSize) {\n    var x1 = ix - 1, y1 = iy - 1, x,\n        x2 = ix + 1, y2 = iy + 1, index, blockFeatures;\n\n    if (x1 < 0) x1 = 0;\n    if (y1 < 0) y1 = 0;\n    if (x2 > mx) x2 = mx;\n    if (y2 > my) y2 = my;\n\n    for (; y1 <= y2; y1++) {\n        for (x = x1; x <= x2; x++) {\n            index = (y1 * mx + x) * 2;\n            blockFeatures = hitMap[index];\n\n            if (!hitMap[index]) {\n                hitMap[index] = hcacheSize;\n                hitMap[index+1] = hcacheSize+1;\n                hcache[hcacheSize] = feature;\n                hcache[hcacheSize+1] = 0;\n                hcacheSize +=2;\n            } else {\n                hcache[hitMap[index+1]] = hcacheSize;\n                hitMap[index+1] = hcacheSize+1;\n                hcache[hcacheSize] = feature;\n                hcache[hcacheSize+1] = 0;\n                hcacheSize +=2;\n            }\n        }\n    }\n\n    return hcacheSize;\n}\n\n\nfunction processGMap4(gpu, gl, renderer, screenPixelSize, draw) {\n    if (!renderer.config.mapFeaturesReduceParams) {\n        return;\n    }\n\n    var ppi = 96 * (window.devicePixelRatio || 1);\n\n    var maxRadius = renderer.config.mapFeaturesReduceParams[0] * ppi; //mapFeatureRadius\n    var maxHitcount = renderer.config.mapFeaturesReduceParams[1]; //0.6614; //mapFeatureMaxOverlays\n\n    var screenLX = renderer.curSize[0];\n    var screenLY = renderer.curSize[1];\n    var i, li, top = renderer.config.mapFeaturesSortByTop, tmp;\n    var feature, feature2, pp, pp2, o, job;\n    var drawAllLabels = renderer.drawAllLabels;\n\n    //get top features\n    var featureCache = renderer.gmap;\n    var featureCacheSize = renderer.gmapIndex;\n\n    var hcache = renderer.gmap2;\n    var hcacheSize = 1;\n    var hmap = renderer.gmap3;\n    var hmapSize = renderer.gmap3Size;\n    var hmap = renderer.gmap3;\n\n\n    var hmin = 10000;\n    var hmax = 0, h, r;\n\n    var divByDist = (renderer.config.mapFeaturesReduceFactor >= 1);\n\n    if (divByDist) { // imp / dists\n        if (renderer.fmaxDist == Number.NEGATIVE_INFINITY || renderer.fminDist == Number.POSITIVE_INFINITY) {\n            return;\n        }\n\n        var ub = 1 - Math.log(renderer.fminDist) / Math.log(101);\n        var lb = -Math.log(renderer.fmaxDist) / Math.log(101); \n    }\n\n    //filter features and sort them by importance\n    for (i = 0, li = featureCacheSize; i < li; i++) {\n        feature = featureCache[i];\n        if (!feature) {\n            continue;\n        }\n\n        pp = feature[5];\n\n        if (divByDist) {\n            r = feature[0].reduce;\n            h = Math.round(-5000 + ( ( Math.log(r[1]+1) - Math.log(r[4]) ) / Math.log(101) - lb ) / ( ub-lb ) * 10000) + 5000;\n            r[5] = h; //for debug\n        } else {\n            h = Math.round(feature[0].reduce[1]);            \n        }\n\n        if (h < 0) h = 0;\n        if (h >= 10000) h = 9999;\n        if (h < hmin) hmin = h;\n        if (h > hmax) hmax = h;\n\n        hmap[h][hmapSize[h]++] = feature;\n    }\n\n    var invMaxRadius = 1 / maxRadius, index, ix, iy, features;\n    var mx = Math.floor(screenLX * invMaxRadius);\n    var my = Math.floor(screenLY * invMaxRadius);\n\n    var hitMap = renderer.gmapStore;\n    var hitMapCount = renderer.gmapHit;\n\n    //clear hit-map\n    for (i = 0, li = (mx+1) * (my+1) * 2; i < li; i+=2) {\n        hitMap[i] = 0;\n    }\n\n    //var hitCache = renderer.gmapHit2;\n    var hitCacheSize = 0, j, lj, k, lk, hitCount, dx, dy, blockFeatures;\n\n    maxRadius *= maxRadius;\n\n    for (i = hmax, li = hmin; i >= 0; i--) {\n\n        if (hmapSize[i] > 0) {\n            var features = hmap[i];\n\n            for (j = 0, lj = hmapSize[i]; j < lj; j++) {\n                feature = features[j];\n                job = feature[0];\n\n                hitCount = 0;\n                pp = feature[5];\n\n                //check area\n                ix = Math.floor(pp[0] * invMaxRadius);\n                iy = Math.floor(pp[1] * invMaxRadius);\n                index = ((iy * mx) + ix) * 2;\n                //blockFeatures = hitMap[index];\n\n                //check\n                if (hitMap[index]) {\n                    index = hitMap[index];\n                    do {\n                        feature2 = hcache[index];\n                        pp2 = feature2[5];\n\n                        dx = pp[0] - pp2[0];\n                        dy = pp[1] - pp2[1];\n\n                        if ((dx*dx+dy*dy) < maxRadius) {\n                            hitCount++;\n                            if (hitCount > maxHitcount) {\n                                break;\n                            }\n                        }\n\n                        index = hcache[index+1];\n                    } while (index);\n                }\n\n                // check                \n                if (hitCount <= maxHitcount) {\n                    index = hitCacheSize;\n\n                    //render job\n                    if (!drawAllLabels && feature[6]) { //no-overlap \n                        pp = feature[5];\n                        o = feature[8];\n\n                        if (job.type == VTS_JOB_LINE_LABEL) {\n                            if (renderer.rmap.addLineLabel(job.lastSubJob, null)) {\n                                hitCacheSize++;\n                            }\n                        } else {\n                            if (renderer.rmap.addRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], feature[7], job.lastSubJob, true, null)) {\n                                hitCacheSize++;\n                            }\n                        }\n\n                    } else {\n                        if (job.hysteresis) {\n                            renderer.jobHBuffer[job.id] = job;\n                        } else {\n                            renderer.drawnJobs++;\n\n                            if (job.type == VTS_JOB_LINE_LABEL) {\n                                draw.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                            } else {\n                                draw.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                            }\n                        }\n\n                        //hitCache[hitCacheSize] = feature;\n                        hitCacheSize++;\n                    }\n\n                    //store to hitmap\n                    if (index != hitCacheSize) {\n                        hcacheSize = storeFeatureToHitmap(index, feature, ix, iy, mx, my, hitMap, hcache, hcacheSize);\n                    }\n                }\n\n            }\n\n            hmapSize[i] = 0;  //zero size\n        }\n    }\n}\n\nfunction processGMap5(gpu, gl, renderer, screenPixelSize, draw) {\n    if (!renderer.config.mapFeaturesReduceParams) {\n        return;\n    }\n\n    var ppi = 96 * (window.devicePixelRatio || 1);\n\n    var screenLX = renderer.curSize[0];\n    var screenLY = renderer.curSize[1];\n    var i, li, top = renderer.config.mapFeaturesSortByTop, tmp;\n    var feature, feature2, pp, pp2, o, job;\n    var drawAllLabels = renderer.drawAllLabels;\n\n    //get top features\n    var featureCache = renderer.gmap;\n    var featureCacheSize = renderer.gmapIndex;\n\n    var hcache = renderer.gmap2;\n    var hcacheSize = 1;\n    var hmap = renderer.gmap3;\n    var hmapSize = renderer.gmap3Size;\n    var hmap = renderer.gmap3;\n\n\n    var hmin = 10000;\n    var hmax = 0, h, r;\n\n    var divByDist = (renderer.config.mapFeaturesReduceFactor >= 1);\n\n    if (divByDist) { // imp / dists\n        if (renderer.fmaxDist == Number.NEGATIVE_INFINITY || renderer.fminDist == Number.POSITIVE_INFINITY) {\n            return;\n        }\n\n        var ub = 1 - Math.log(renderer.fminDist) / Math.log(101);\n        var lb = -Math.log(renderer.fmaxDist) / Math.log(101); \n    }\n\n    //filter features and sort them by importance\n    for (i = 0, li = featureCacheSize; i < li; i++) {\n        feature = featureCache[i];\n        if (!feature) {\n            continue;\n        }\n\n        pp = feature[5];\n\n        if (divByDist) {\n            r = feature[0].reduce;\n            h = Math.round(-5000 + ( ( Math.log(r[1]+1) - Math.log(r[4]) ) / Math.log(101) - lb ) / ( ub-lb ) * 10000) + 5000;\n            r[5] = h; //for debug\n        } else {\n            h = Math.round(feature[0].reduce[1]);            \n        }\n\n        if (h < 0) h = 0;\n        if (h >= 10000) h = 9999;\n        if (h < hmin) hmin = h;\n        if (h > hmax) hmax = h;\n\n        hmap[h][hmapSize[h]++] = feature;\n    }\n\n    var j, lj;\n\n    for (i = hmax, li = hmin; i >= 0; i--) {\n\n        if (hmapSize[i] > 0) {\n            var features = hmap[i];\n\n            for (j = 0, lj = hmapSize[i]; j < lj; j++) {\n                feature = features[j];\n                job = feature[0];\n                pp = feature[5];\n\n                // check                \n\n                //render job\n                if (!drawAllLabels && feature[6]) { //no-overlap is always enabled\n                    pp = feature[5];\n                    o = feature[8];\n\n                    if (job.type == VTS_JOB_LINE_LABEL) {\n                        if (renderer.rmap.addLineLabel(job.lastSubJob, null)) {\n                            //hitCache[hitCacheSize] = feature;\n                        }\n                    } else {\n                        if (renderer.rmap.addRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], feature[7], job.lastSubJob, true, null)) {\n                            //hitCache[hitCacheSize] = feature;\n                        }\n                    }\n\n                } else {\n                    if (job.hysteresis) {\n                        renderer.jobHBuffer[job.id] = job;\n                    } else {\n                        renderer.drawnJobs++;\n\n                        if (job.type == VTS_JOB_LINE_LABEL) {\n                            draw.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                        } else {\n                            draw.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                        }\n                    }\n                }\n            }\n\n            hmapSize[i] = 0;  //zero size\n        }\n    }\n}\n\n\nfunction radixSortFeatures(renderer, input, inputSize, tmp, depthOnly) {\n    var count = inputSize < (1 << 16) ? renderer.radixCountBuffer16 : renderer.radixCountBuffer32; \n    var item, val, bunit32 = renderer.buffUint32, bfloat32 = renderer.buffFloat32, i, r, pp;\n    var distanceFactor = renderer.config.mapFeaturesReduceFactor;\n    //var screenDistanceFactor = renderer.config.mapFeaturesReduceFactor2 * 0.5, e100 = 1.0/Math.exp(100);\n    //var centerOffset = renderer.config.mapFeaturesReduceFactor3;\n\n    var depthTest = true;\n\n    var sx = renderer.curSize[0], sy = renderer.curSize[1];\n    var cx = sx * 0.5, cy = sy * 0.5;\n    var invcx = 1.0 / (cx+0.0001), invcy = 1.0 / (cy+0.0001), dx, dy, yy;\n    var invsy = 1.0 / (sy+0.0001);\n\n    if (count.fill) {\n        count.fill(0);\n    } else { //IE fallback\n        for (i = 0; i < (256*4); i++) {\n            count[i] = 0;\n        }\n    }\n\n    // count all bytes in one pass\n    for (i = 0; i < inputSize; i++) {\n        item = input[i];\n        r = item[0].reduce;\n\n        // optical center\n        //pp = item[5]; \n        //yy = Math.pow(pp[1] * invsy, centerOffset) * sy;\n        //dx = (cx - pp[0]) * invcx;\n        //dy = (cy - yy) * invcx;\n\n        val = r[3] - distanceFactor * Math.log(r[4]); // - screenDistanceFactor * Math.log(dx*dx + dy*dy + e100);\n        r[6] = val;\n        val += 10000;\n        if (val < 0) val = 0;\n        bfloat32[0] = val;\n        val = bunit32[0];\n        r[5] = val;\n        count[val & 0xFF]++;\n        count[((val >> 8) & 0xFF) + 256]++;\n        count[((val >> 16) & 0xFF) + 512]++;\n        count[((val >> 24) & 0xFF) + 768]++;\n    }\n\n    // create summed array\n    for (var j = 0; j < 4; j++) {\n        var t = 0, sum = 0, offset = j * 256;\n\n        for (i = 0; i < 256; i++) {\n            t = count[i + offset];\n            count[i + offset] = sum;\n            sum += t;\n        }\n    }\n\n    for (i = 0; i < inputSize; i++) {\n        item = input[i];\n        val = item[0].reduce[5];\n        tmp[count[val & 0xFF]++] = item;\n    }\n    for (i = 0; i < inputSize; i++) {\n        item = tmp[i];\n        val = item[0].reduce[5];\n        input[count[((val >> 8) & 0xFF) + 256]++] = item;\n    }\n    for (i = 0; i < inputSize; i++) {\n        item = input[i];\n        val = item[0].reduce[5];\n        tmp[count[((val >> 16) & 0xFF) + 512]++] = item;\n    }\n    for (i = 0; i < inputSize; i++) {\n        item = tmp[i];\n        val = item[0].reduce[5];\n        input[count[((val >> 24) & 0xFF) + 768]++] = item;\n    }\n\n    if (i == -123) { //debug\n        for (i = 0; i < inputSize; i++) {\n            val = input[i][0].reduce[5];\n            console.log('' + val +  ' ' + input[i][0].id);\n        }\n    }\n\n    return input;\n}\n\n//used for scr-count7\nfunction processGMap6(gpu, gl, renderer, screenPixelSize, draw) {\n    if (!renderer.config.mapFeaturesReduceParams) {\n        return;\n    }\n\n    var featuresPerSquareInch = renderer.config.mapFeaturesReduceParams[1]; //0.6614; //labelsPerSquareInch\n    var ppi = 96 * (window.devicePixelRatio || 1);\n    var screenLX = renderer.curSize[0];\n    var screenLY = renderer.curSize[1];\n    var maxFeatures = Math.ceil((screenLX/ppi)*(screenLY/ppi)*featuresPerSquareInch); \n    var i, li, top = renderer.config.mapFeaturesSortByTop, tmp, job;\n    var feature, feature2, pp, pp2, o, featureCount = 0;\n    var drawAllLabels = renderer.drawAllLabels;\n\n    var depthTest = (renderer.config.mapFeaturesReduceFactor2 != 0);\n    var depthOffset = -renderer.config.mapFeaturesReduceFactor3;\n    var depthParams = null;\n\n    renderer.debugStr = '<br>featuresPerScr: ' + maxFeatures;\n\n    //get top features\n    var featureCache = renderer.gmap;\n    var featureCacheSize = renderer.gmapIndex;\n    var featureCache2 = renderer.gmap2;\n\n    if (drawAllLabels) {\n        maxFeatures = featureCacheSize;\n    }\n\n    //filter features and sort them by importance\n    radixSortFeatures(renderer, featureCache, featureCacheSize, featureCache2);\n\n    for (i = featureCacheSize - 1; i >= 0; i--) {\n        feature = featureCache[i];\n        job = feature[0];\n\n        // check                \n\n        //render job\n        if (!drawAllLabels && feature[6]) { //no-overlap is always enabled\n            pp = feature[5];\n            o = feature[8];\n            \n            depthParams = depthTest ? [pp[0],pp[1]+feature[1],job.reduce,depthOffset] : null;\n\n            if (job.type == VTS_JOB_LINE_LABEL) {\n                if (renderer.rmap.addLineLabel(job.lastSubJob, depthParams)) {\n                    featureCount++;\n                }\n            } else {\n                if (renderer.rmap.addRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], feature[7], job.lastSubJob, true, depthParams)) {\n                    featureCount++;\n                }\n            }\n\n            if (featureCount >= maxFeatures) {\n                return;\n            }\n\n        } else {\n            if (job.hysteresis) {\n                renderer.jobHBuffer[job.id] = job;\n            } else {\n                renderer.drawnJobs++;\n\n                if (job.type == VTS_JOB_LINE_LABEL) {\n                    draw.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                } else {\n                    draw.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                }\n            }\n        }\n    }\n\n}\n\n\nfunction radixDepthSortFeatures(renderer, input, inputSize, tmp) {\n    var count = inputSize < (1 << 16) ? renderer.radixCountBuffer16 : renderer.radixCountBuffer32; \n    var item, val, bunit32 = renderer.buffUint32, bfloat32 = renderer.buffFloat32, i, r, pp;\n    var distanceFactor = renderer.config.mapFeaturesReduceFactor;\n    //var screenDistanceFactor = renderer.config.mapFeaturesReduceFactor2 * 0.5, e100 = 1.0/Math.exp(100);\n    //var centerOffset = renderer.config.mapFeaturesReduceFactor3;\n\n    var depthTest = true;\n\n    if (count.fill) {\n        count.fill(0);\n    } else { //IE fallback\n        for (i = 0; i < (256*4); i++) {\n            count[i] = 0;\n        }\n    }\n\n    // count all bytes in one pass\n    for (i = 0; i < inputSize; i++) {\n        item = input[i];\n        val = 1 - item.lastSubJob[5][2];\n        bfloat32[0] = val;\n        val = bunit32[0];\n        item.depth = val;\n        count[val & 0xFF]++;\n        count[((val >> 8) & 0xFF) + 256]++;\n        count[((val >> 16) & 0xFF) + 512]++;\n        count[((val >> 24) & 0xFF) + 768]++;\n    }\n\n    // create summed array\n    for (var j = 0; j < 4; j++) {\n        var t = 0, sum = 0, offset = j * 256;\n\n        for (i = 0; i < 256; i++) {\n            t = count[i + offset];\n            count[i + offset] = sum;\n            sum += t;\n        }\n    }\n\n    for (i = 0; i < inputSize; i++) {\n        item = input[i];\n        val = item.depth;\n        tmp[count[val & 0xFF]++] = item;\n    }\n    for (i = 0; i < inputSize; i++) {\n        item = tmp[i];\n        val = item.depth;\n        input[count[((val >> 8) & 0xFF) + 256]++] = item;\n    }\n    for (i = 0; i < inputSize; i++) {\n        item = input[i];\n        val = item.depth;\n        tmp[count[((val >> 16) & 0xFF) + 512]++] = item;\n    }\n    for (i = 0; i < inputSize; i++) {\n        item = tmp[i];\n        val = item.depth;\n        input[count[((val >> 24) & 0xFF) + 768]++] = item;\n    }\n\n    /*if (i == -123) { //debug\n        for (i = 0; i < inputSize; i++) {\n            item = input[i];\n            val = item.depth;\n            console.log('' + val +  ' ' + item.lastSubJob[0].id);\n        }\n    }*/\n\n    return input;\n}\n\n\nfunction fillVMapHoles(vmap, mx, my) {\n    var holesCount = 0, v;\n    var x0, y0, x1, y1, x2, y2;\n    var maxX = mx - 1;\n    var maxY = my - 1;\n\n    for (var j = 0, lj = my; j < lj; j++) {\n        for (var i = 0, li = mx; i < li; i++) {\n\n            v = vmap[j*mx+i];\n\n            if (v === null) {\n\n                //find \n                x0 = i - 1;\n                y0 = j - 1;\n\n                x1 = i;\n                y1 = j;\n\n                x2 = i + 1;\n                y2 = j + 1;\n\n                if (x0 < 0) x0 = 0;\n                if (y0 < 0) y0 = 0;\n\n                if (x2 > maxX) x2 = maxX;\n                if (y2 > maxY) y2 = maxY;\n\n                var vv = [vmap[y0*mx+x0],\n                          vmap[y0*mx+x1],\n                          vmap[y0*mx+x2],\n                          vmap[y1*mx+x0],\n                          vmap[y1*mx+x2],\n                          vmap[y2*mx+x0],\n                          vmap[y2*mx+x1],\n                          vmap[y2*mx+x2]];\n\n                var vcount = 0;\n                var vsum = 0;\n\n                for (var k= 0; k < 8; k++) {\n                    if (vv[k] !== null) {\n                        vcount++;\n                        vsum += vv[k];\n                    }\n                }\n\n                if (vcount != 0) {\n                    vmap[j*mx+i] = vsum / vcount;\n                } else {\n                    holesCount++;\n                }\n            }\n        }\n    }\n\n    if (holesCount != 0 && holesCount != (mx * my)) {\n        fillVMapHoles(vmap, mx, my);\n    }\n}\n\n\nfunction getVMapValue(vmap, x, y, mx, my) {\n    x -= 0.5;\n    y -= 0.5;\n\n    var maxX = mx - 1;\n    var maxY = my - 1;\n\n    if (x < 0) { x = 0; }\n    if (y < 0) { y = 0; }\n    if (x > maxX) { x = maxX; }\n    if (y > maxY) { y = maxY; }\n\n    var ix = Math.floor(x);\n    var iy = Math.floor(y);\n    var fx = x - ix;\n    var fy = y - iy;\n\n    var index = iy * mx;\n    var index2 = (iy == maxY) ? index : index + mx;\n    var ix2 = (ix == maxX) ? ix : ix + 1; \n    var v00 = vmap[index + ix];\n    var v01 = vmap[index + ix2];\n    var v10 = vmap[index2 + ix];\n    var v11 = vmap[index2 + ix2];\n    var w0 = (v00 + (v01 - v00)*fx);\n    var w1 = (v10 + (v11 - v10)*fx);\n   \n    return (w0 + (w1 - w0)*fy);\n}\n\n\nfunction radixDeltaSortFeatures(renderer, input, inputSize, tmp) {\n    var count = inputSize < (1 << 16) ? renderer.radixCountBuffer16 : renderer.radixCountBuffer32; \n    var item, val, bunit32 = renderer.buffUint32, bfloat32 = renderer.buffFloat32, i, r, pp;\n\n    if (count.fill) {\n        count.fill(0);\n    } else { //IE fallback\n        for (i = 0; i < (256*4); i++) {\n            count[i] = 0;\n        }\n    }\n\n    // count all bytes in one pass\n    for (i = 0; i < inputSize; i++) {\n        item = input[i];\n        //val = 1 - item.lastSubJob[5][2];\n        bfloat32[0] = item[0].delta;\n        val = bunit32[0];\n        item[0].delta = val;\n        count[val & 0xFF]++;\n        count[((val >> 8) & 0xFF) + 256]++;\n        count[((val >> 16) & 0xFF) + 512]++;\n        count[((val >> 24) & 0xFF) + 768]++;\n    }\n\n    // create summed array\n    for (var j = 0; j < 4; j++) {\n        var t = 0, sum = 0, offset = j * 256;\n\n        for (i = 0; i < 256; i++) {\n            t = count[i + offset];\n            count[i + offset] = sum;\n            sum += t;\n        }\n    }\n\n    for (i = 0; i < inputSize; i++) {\n        item = input[i];\n        val = item[0].delta;\n        tmp[count[val & 0xFF]++] = item;\n    }\n    for (i = 0; i < inputSize; i++) {\n        item = tmp[i];\n        val = item[0].delta;\n        input[count[((val >> 8) & 0xFF) + 256]++] = item;\n    }\n    for (i = 0; i < inputSize; i++) {\n        item = input[i];\n        val = item[0].delta;\n        tmp[count[((val >> 16) & 0xFF) + 512]++] = item;\n    }\n    for (i = 0; i < inputSize; i++) {\n        item = tmp[i];\n        val = item[0].delta;\n        input[count[((val >> 24) & 0xFF) + 768]++] = item;\n    }\n\n    /*if (i == -123) { //debug\n        for (i = 0; i < inputSize; i++) {\n            item = input[i];\n            val = item.depth;\n            console.log('' + val +  ' ' + item.lastSubJob[0].id);\n        }\n    }*/\n\n    return input;\n}\n\n\n//used for scr-count8\nfunction processGMap7(gpu, gl, renderer, screenPixelSize, draw) {\n    if (!renderer.config.mapFeaturesReduceParams) {\n        return;\n    }\n\n    var tileCount = renderer.config.mapFeaturesReduceParams[5];\n    var featuresPerSquareInch = renderer.config.mapFeaturesReduceParams[1];\n    var ppi = 96 * (window.devicePixelRatio || 1);\n    var screenLX = renderer.curSize[0];\n    var screenLY = renderer.curSize[1];\n    var maxFeatures = Math.ceil((screenLX/ppi)*(screenLY/ppi)*featuresPerSquareInch); \n    var featuresPerTile = maxFeatures / (tileCount * tileCount); \n    var featuresPerTileInt = Math.floor(featuresPerTile); \n    var featuresPerTileFract = featuresPerTile - featuresPerTileInt; \n    var tileSizeX = screenLX / tileCount;\n    var tileSizeY = screenLY / tileCount;\n\n    renderer.debugStr = '<br>featuresPerScr: ' + maxFeatures + '<br>featuresPerTile: ' + featuresPerTile.toFixed(2);\n\n    var i, li, top = renderer.config.mapFeaturesSortByTop, tmp, job, featureCount = 0;\n    //var feature, feature2, pp, pp2, o, featureCount = 0;\n    //var drawAllLabels = renderer.drawAllLabels;\n\n    var depthTest = (renderer.config.mapFeaturesReduceFactor2 != 0);\n    var depthOffset = -renderer.config.mapFeaturesReduceFactor3;\n    var depthParams = null;\n\n    //get top features\n    var featureCache = renderer.gmap;\n    var featureCacheSize = renderer.gmapIndex;\n    var featureCache2 = renderer.gmap2;\n    var featureCacheSize2 = 0;\n    var vmap = renderer.gmap4;\n    var drawAllLabels = renderer.drawAllLabels;\n\n    if (drawAllLabels) {\n        maxFeatures = featureCacheSize;\n    }\n\n    if (featureCacheSize > 0) {\n\n        //filter features and sort them by importance\n        radixSortFeatures(renderer, featureCache, featureCacheSize, featureCache2);\n\n        if (drawAllLabels) {\n\n            for (i = featureCacheSize - 1; i >= 0; i--) {\n                feature = featureCache[i];\n                job = feature[0];\n\n                if (feature[0].hysteresis) {\n                    renderer.jobHBuffer[feature[0].id] = job;\n                } else {\n                    renderer.drawnJobs++;\n                    job = feature[0];\n                    if (job.type == VTS_JOB_LINE_LABEL) {\n                        draw.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                    } else {\n                        draw.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                    }\n                }\n            }\n\n        } else {\n\n            //distribute top features\n            var hitMap = renderer.gmapHit, usedFeatures = 0;\n            var tileFeatures, count, feature;\n\n            var ix,iy,is,pp,tx,ty,mx,my,v,v2,index,o,j;\n\n            ix = screenLX / tileSizeX;\n            iy = screenLY / tileSizeY;\n            mx = Math.round(ix);\n            my = Math.round(iy);\n            //ix = ix - mx;\n            //iy = iy - my;\n\n            var hitMap = renderer.gmapStore;\n            var hitMapCount = renderer.gmapHit;\n\n            //clear hit-map\n            for (i = 0, li = mx * my; i < li; i++) {\n                hitMap[i] = null;\n                vmap[i] = null;\n            }\n\n            for (i = featureCacheSize - 1; i >= 0; i--) {\n\n                feature = featureCache[i];\n                if (!feature) {\n                    continue;\n                }\n\n                pp = feature[5];\n\n                if (pp[0] < 30 || pp[0] >= (screenLX-30) || pp[1] < 30 || pp[1] >= (screenLY-30)) {\n                    featureCache[i] = null;\n                    continue;\n                }\n\n                tx = pp[0] / tileSizeX;\n                ty = pp[1] / tileSizeY;\n\n                index = Math.floor(tx) + Math.floor(ty) * (mx);\n\n                tileFeatures = hitMap[index];\n\n                if (tileFeatures) {\n                    hitMap[index].push(i);\n                } else {\n                    hitMap[index] = [i];\n                    //hitMapCount[index] = v;\n                }\n            }\n\n\n            for (i = 0, li = (mx) * (my); i < li; i++) {\n                tileFeatures = hitMap[i];\n\n                if (tileFeatures && tileFeatures.length) {\n                    count = tileFeatures.length;\n\n                    if (count == 0) {\n                        vmap[i] = null;\n                    } else {\n                        if (count > featuresPerTileInt) {\n                            count = featuresPerTileInt;\n\n                            index = tileFeatures[count];\n                            feature = featureCache[index];\n                            v = feature[0].reduce[6];\n\n                            if (tileFeatures.length > count+1) {\n                                index = tileFeatures[count+1];\n                                feature = featureCache[index];\n                                v2 = feature[0].reduce[6];\n                                v = v + (v2 - v) * featuresPerTileFract;\n                            }\n                        } else {\n                            index = tileFeatures[count - 1];\n                            feature = featureCache[index];\n                            v = feature[0].reduce[6];\n                        }\n\n                        vmap[i] = v;\n                    }\n                }\n            }\n\n            fillVMapHoles(vmap, mx, my);\n\n            for (i = featureCacheSize - 1; i >= 0; i--) {\n                feature = featureCache[i];\n                if (!feature) {\n                    continue;\n                }\n\n                job = feature[0];\n                v = job.reduce[6];\n                pp = feature[5];\n\n                var vmax = getVMapValue(vmap, pp[0] / tileSizeX, pp[1] / tileSizeY, mx, my);\n\n                if (v >= vmax) {\n\n                    //render job\n                    if (/*!drawAllLabels &&*/ feature[6]) { //no-overlap is always enabled\n                        pp = feature[5];\n                        o = feature[8];\n\n                        depthParams = depthTest ? [pp[0],pp[1]+feature[1],job.reduce,depthOffset] : null;\n                        \n                        if (job.type == VTS_JOB_LINE_LABEL) {\n                            if (renderer.rmap.addLineLabel(job.lastSubJob, depthParams)) {\n                                featureCount++;\n                            }\n                        } else {\n                            if (renderer.rmap.addRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], feature[7], job.lastSubJob, true, depthParams)) {\n                                featureCount++;\n                            }\n                        }\n\n\n                    } else {\n                        if (job.hysteresis) {\n                            renderer.jobHBuffer[job.id] = job;\n                        } else {\n                            renderer.drawnJobs++;\n\n                            if (job.type == VTS_JOB_LINE_LABEL) {\n                                draw.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                            } else {\n                                draw.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                            }\n                        }\n                    }\n                } else {\n                    //store v delta\n                    feature[0].delta = Math.abs(vmax - v);\n                    featureCache2[featureCacheSize2] = feature; \n                    featureCacheSize2++;\n                }\n            }\n\n            if (featureCount < maxFeatures && featureCacheSize2 > 0) {\n                //sort deltas\n                radixDeltaSortFeatures(renderer, featureCache2, featureCacheSize2, featureCache);\n\n                for (i = featureCacheSize2 - 1; i >= 0; i--) {\n                    feature = featureCache2[i];\n                    job = feature[0];\n\n                    //render job\n                    if (/*!drawAllLabels &&*/ feature[6]) { //no-overlap is always enabled\n                        pp = feature[5];\n                        o = feature[8];\n\n                        depthParams = depthTest ? [pp[0],pp[1]+feature[1],job.reduce,depthOffset] : null;\n                        \n                        if (job.type == VTS_JOB_LINE_LABEL) {\n                            if (renderer.rmap.addLineLabel(job.lastSubJob, depthParams)) {\n                                featureCount++;\n                            }\n                        } else {\n                            if (renderer.rmap.addRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], feature[7], job.lastSubJob, true, depthParams)) {\n                                featureCount++;\n                            }\n                        }\n\n                    } else {\n                        if (job.hysteresis) {\n                            renderer.jobHBuffer[job.id] = job;\n                        } else {\n                            renderer.drawnJobs++;\n\n                            if (job.type == VTS_JOB_LINE_LABEL) {\n                                draw.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                            } else {\n                                draw.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, job.lastSubJob, null);\n                            }\n                        }\n                    }\n\n                    if (featureCount >= maxFeatures) {\n                        break;\n                    }\n                }\n            }\n        }\n    }\n\n\n    if (renderer.drawGridCells) {\n        gpu.setState(renderer.lineLabelState);\n\n        var x = 0, y = 0, j, lj;\n\n        for (j = 0, lj = my; j < lj; j++) {\n            for (i = 0, li = mx; i < li; i++) {\n                x = tileSizeX * i;\n                y = tileSizeY * j;\n\n                var v = vmap[j*mx+i];\n\n                draw.drawLineString([[x, y, 0.5], [x+tileSizeX, y, 0.5],\n                                     [x+tileSizeX, y+tileSizeY, 0.5], [x, y+tileSizeY, 0.5]], true, 1, [0,0,255,255], null, true, null, null, null);\n\n                if (v) {\n                    draw.drawText(Math.round(x+5), Math.round(y + 5), 11, '' + v.toFixed(2), [255,255,255,255], 0.5);\n                }\n            }\n        }\n    }\n\n}\n\n\nexport {processGMap, processGMap4, processGMap5, processGMap6, processGMap7, radixDepthSortFeatures};\n\n","\nimport {vec3 as vec3_, mat3 as mat3_, mat4 as mat4_} from '../utils/matrix';\nimport {math as math_} from '../utils/math';\nimport {processGMap as processGMap_, processGMap4 as processGMap4_, processGMap5 as processGMap5_,\n        processGMap6 as processGMap6_, processGMap7 as processGMap7_, radixDepthSortFeatures as radixDepthSortFeatures_ } from './gmap';\n\n//get rid of compiler mess\nvar vec3 = vec3_, mat3 = mat3_, mat4 = mat4_;\nvar math = math_;\nvar processGMap = processGMap_;\nvar processGMap4 = processGMap4_;\nvar processGMap5 = processGMap5_;\nvar processGMap6 = processGMap6_;\nvar processGMap7 = processGMap7_;\nvar radixDepthSortFeatures = radixDepthSortFeatures_;\n\n\nvar RendererDraw = function(renderer) {\n    this.renderer = renderer;\n    this.core = renderer.core;\n    this.gpu = renderer.gpu;\n    this.gl = renderer.gpu.gl;\n    this.rmap = renderer.rmap;\n    this.mBuffer = new Float32Array(16);\n    this.mBuffer2 = new Float32Array(16);\n    this.vBuffer = new Float32Array(4);\n};\n\n\nRendererDraw.prototype.drawSkydome = function(texture, shader) {\n    if (!texture) {\n        return;\n    }\n\n    var gpu = this.gpu;\n    var gl = this.gl;\n    var renderer = this.renderer;\n    \n    var lower = 400; // put the dome a bit lower\n    var normMat = mat4.create();\n    mat4.multiply(math.scaleMatrix(2, 2, 2), math.translationMatrix(-0.5, -0.5, -0.5), normMat);\n\n    var domeMat = mat4.create();\n\n    var pos = renderer.camera.getPosition();\n    mat4.multiply(math.translationMatrix(pos[0], pos[1], pos[2] - lower), math.scaleMatrixf(Math.min(renderer.camera.getFar()*0.9,600000)), domeMat);\n\n    var mvp = mat4.create();\n    mat4.multiply(renderer.camera.getMvpMatrix(), domeMat, mvp);\n    mat4.multiply(mvp, normMat, mvp);\n\n\n    gpu.useProgram(shader, ['aPosition', 'aTexCoord']);\n    gpu.bindTexture(texture);\n\n    shader.setSampler('uSampler', 0);\n    shader.setMat4('uMVP', mvp);\n\n    gl.depthMask(false);\n\n    renderer.skydomeMesh.draw(shader, 'aPosition', 'aTexCoord');\n\n    gl.depthMask(true);\n    gl.enable(gl.CULL_FACE);\n\n    renderer.renderedPolygons += renderer.skydomeMesh.getPolygons();\n};\n\n\nRendererDraw.prototype.drawTBall = function(position, size, shader, texture, size2, nocull) {\n    var gpu = this.gpu;\n    var gl = this.gl;\n    var renderer = this.renderer;\n\n    if (nocull) {\n        //gl.disable(gl.CULL_FACE);\n    }\n\n    var normMat = mat4.create();\n    mat4.multiply(math.scaleMatrix(2, 2, 2), math.translationMatrix(-0.5, -0.5, -0.5), normMat);\n\n    var pos = [position[0], position[1], position[2] ];\n\n    size = (size != null) ? size : 1.5;\n\n    var domeMat = mat4.create();\n    mat4.multiply(math.translationMatrix(pos[0], pos[1], pos[2]), math.scaleMatrix(size, size, size2 || size), domeMat);\n\n    var mvp = mat4.create();\n    mat4.multiply(renderer.camera.getMvpMatrix(), domeMat, mvp);\n    mat4.multiply(mvp, normMat, mvp);\n\n    gpu.useProgram(shader, ['aPosition', 'aTexCoord']);\n    gpu.bindTexture(texture || renderer.redTexture);\n\n    shader.setSampler('uSampler', 0);\n    shader.setMat4('uMVP', mvp);\n\n    renderer.skydomeMesh.draw(shader, 'aPosition', 'aTexCoord');\n\n    renderer.renderedPolygons += renderer.skydomeMesh.getPolygons();\n\n    if (nocull) {\n        //gl.enable(gl.CULL_FACE);\n    }\n};\n\n\nRendererDraw.prototype.drawBall = function(position, size, size2, shader, params, params2, params3, color, color2, normals) {\n    var gpu = this.gpu;\n    var gl = this.gl;\n    var renderer = this.renderer;\n\n    var normMat = mat4.create();\n    mat4.multiply(math.scaleMatrix(2, 2, 2), math.translationMatrix(-0.5, -0.5, -0.5), normMat);\n\n    var pos = [position[0], position[1], position[2] ];\n\n    var domeMat = mat4.create();\n    size = size || 1.5;\n    size2 = size2 || 1.5;\n    mat4.multiply(math.translationMatrix(pos[0], pos[1], pos[2]), math.scaleMatrix(size, size, size2), domeMat);\n\n    var mv = mat4.create();\n    mat4.multiply(renderer.camera.getModelviewMatrix(), domeMat, mv);\n    mat4.multiply(mv, normMat, mv);\n    var proj = renderer.camera.getProjectionMatrix();\n\n    var norm = [0,0,0, 0,0,0, 0,0,0];\n    mat4.toInverseMat3(mv, norm);\n    mat3.transpose(norm);\n    \n    gpu.useProgram(shader, ['aPosition']);\n    //gpu.bindTexture(renderer.redTexture);\n\n    //shader.setSampler('uSampler', 0);\n    shader.setMat4('uProj', proj);\n    shader.setMat4('uMV', mv);\n    \n    if (normals) {\n        shader.setMat3('uNorm', norm);\n        gl.cullFace(gl.FRONT);\n        //gl.disable(gl.DEPTH_TEST);\n    }\n    \n    if (params) {\n        shader.setVec4('uParams', params);\n    }\n\n    if (params2) {\n        shader.setVec4('uParams2', params2);\n    }\n\n    if (params2) {\n        shader.setVec4('uParams3', params3);\n    }\n\n    if (color) {\n        shader.setVec4('uFogColor', color);\n    }\n\n    if (color2) {\n        shader.setVec4('uFogColor2', color2);\n    }\n\n    renderer.atmoMesh.draw(shader, 'aPosition', null /*\"aTexCoord\"*/);\n\n    renderer.renderedPolygons += renderer.skydomeMesh.getPolygons();\n\n    if (normals) {\n        gl.cullFace(gl.BACK);\n    }\n};\n\n\nRendererDraw.prototype.drawBall2 = function(position, size, shader, nfactor, dir, radius2) {\n    var gpu = this.gpu;\n    var renderer = this.renderer;\n\n    var normMat = mat4.create();\n    mat4.multiply(math.scaleMatrix(2, 2, 2), math.translationMatrix(-0.5, -0.5, -0.5), normMat);\n\n    var pos = [position[0], position[1], position[2] ];\n\n    var domeMat = mat4.create();\n    mat4.multiply(math.translationMatrix(pos[0], pos[1], pos[2]), math.scaleMatrixf(size != null ? size : 1.5), domeMat);\n\n    var mv = mat4.create();\n    mat4.multiply(renderer.camera.getModelviewMatrix(), domeMat, mv);\n    mat4.multiply(mv, normMat, mv);\n    var proj = renderer.camera.getProjectionMatrix();\n\n    var norm = [0,0,0, 0,0,0, 0,0,0];\n    mat4.toInverseMat3(mv, norm);\n    mat3.transpose(norm);\n    \n    gpu.useProgram(shader, ['aPosition']);\n    gpu.bindTexture(renderer.redTexture);\n\n    shader.setSampler('uSampler', 0);\n    shader.setMat4('uProj', proj);\n    shader.setMat4('uMV', mv);\n    shader.setMat3('uNorm', norm);\n    shader.setFloat('uNFactor', nfactor);\n    shader.setVec3('uCenter', position);\n    shader.setVec2('uRadius', [size, radius2]);\n\n    renderer.atmoMesh.draw(shader, 'aPosition', null /*\"aTexCoord\"*/);\n    renderer.renderedPolygons += renderer.skydomeMesh.getPolygons();\n};\n\n\nRendererDraw.prototype.drawLineString = function(points, screenSpace, size, color, depthOffset, depthTest, transparent, writeDepth, useState) {\n    var gpu = this.gpu;\n    var gl = this.gl;\n    var renderer = this.renderer;\n    var index = 0, p, i;\n\n    var totalPoints = points.length; \n   \n    if (totalPoints > 32) {\n        for (i = 0; i < totalPoints; i += 31) {\n            p = points.slice(i, i + 32); \n            this.drawLineString(p, screenSpace, size, color, depthOffset, depthTest, transparent, writeDepth, useState);\n        }\n        return;\n    }\n\n    var plineBuffer = renderer.plineBuffer;\n\n\n    if (screenSpace) { \n\n        //fill points\n        for (i = 0; i < totalPoints; i++) {\n            p = points[i];\n            plineBuffer[index] = p[0];\n            plineBuffer[index+1] = p[1];\n            plineBuffer[index+2] = p[2] || 0;\n            index += 3;\n        }\n\n    } else { //covert points from physical space\n\n        var mvp = renderer.camera.getMvpMatrix();\n        var curSize = renderer.curSize;\n        var cameraPos = renderer.cameraPosition;\n\n        for (i = 0; i < totalPoints; i++) {\n            p = points[i];\n\n            plineBuffer[index] = p[0] - cameraPos[0];\n            plineBuffer[index+1] = p[1] - cameraPos[1];\n            plineBuffer[index+2] = p[2] - cameraPos[2];\n\n            index += 3;\n        }\n    }\n\n    if (useState !== true) {\n        var tmpState = gpu.currentState;\n\n        gpu.setState({\n            ztest: !(depthTest !== true),\n            blend: (transparent === true),\n            zwrite: !(writeDepth === false),\n            stencil: false,\n            culling: false,\n            zequal: false\n        });\n    }\n\n    var prog = (!screenSpace) ? renderer.progLine5 : renderer.progLine4;\n\n    gpu.useProgram(prog, ['aPosition']);\n\n    if (screenSpace) { \n        prog.setMat4('uMVP', renderer.imageProjectionMatrix, depthOffset ? renderer.getZoffsetFactor(depthOffset) : null);\n    } else {\n        prog.setMat4('uMV', renderer.camera.getModelviewFMatrix(), null); //depthOffset ? renderer.getZoffsetFactor(depthOffset) : null);\n        prog.setMat4('uProj', renderer.camera.getProjectionFMatrix(), null);\n    }\n\n    prog.setVec3('uScale', [(2 / renderer.curSize[0]), (2 / renderer.curSize[1]), size*0.5]);\n    prog.setVec4('uColor', (color != null ? color : [1,1,1,1]));\n    prog.setVec3('uPoints', plineBuffer);\n\n    renderer.plines.draw(prog, 'aPosition', totalPoints);\n\n    if (useState !== true) {\n        gpu.setState(tmpState);\n    }\n};\n\n\n//draw 2d circle - used for debuging\nRendererDraw.prototype.drawCircle = function(point, radius, lineWidth, color, depthOffset, depthTest, transparent, writeDepth, useState) {\n    var points = [];\n    var circleSides = 16;\n    var angle = 0, step = (2.0*Math.PI) / circleSides;\n\n    for (var i = 0; i < circleSides; i++) {\n        points[i] = [-Math.sin(angle)*radius+point[0], Math.cos(angle)*radius+point[1], point[2]];\n        angle += step;\n    }\n\n    points[circleSides] = [point[0], radius+point[1], point[2]];;\n\n    this.drawLineString(points, true, lineWidth, color, depthOffset, depthTest, transparent, writeDepth, useState);\n};\n\n\n//draw 2d image - used for debuging\nRendererDraw.prototype.drawImage = function(x, y, lx, ly, texture, color, depth, depthOffset, depthTest, transparent, writeDepth, useState) {\n    var gpu = this.gpu;\n    var gl = this.gl;\n    var renderer = this.renderer;\n\n    if (texture == null || renderer.imageProjectionMatrix == null) {\n        return;\n    }\n\n    if (useState !== true) {\n        var tmpState = gpu.currentState;\n\n        gpu.setState({\n            ztest: !(depthTest !== true),\n            blend: (transparent === true),\n            zwrite: !(writeDepth === false),\n            stencil: false,\n            culling: false,\n            zequal: false\n        });\n    }\n\n    var prog = renderer.progImage;\n\n    gpu.useProgram(prog, ['aPosition']);\n    gpu.bindTexture(texture);\n\n    var vertices = renderer.rectVerticesBuffer;\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertices);\n    gl.vertexAttribPointer(prog.getAttribute('aPosition'), vertices.itemSize, gl.FLOAT, false, 0, 0);\n\n    var indices = renderer.rectIndicesBuffer;\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indices);\n\n    prog.setMat4('uProjectionMatrix', renderer.imageProjectionMatrix);\n\n    prog.setMat4('uData', [\n        x, y,  0, 0,\n        x + lx, y,  1, 0,\n        x + lx, y + ly, 1, 1,\n        x,  y + ly,  0, 1  ]);\n\n    if (depthOffset) {\n        depth = depth * (1 + renderer.getZoffsetFactor(depthOffset) * 2);\n    }\n\n    prog.setVec4('uColor', (color != null ? color : [1,1,1,1]));\n    prog.setFloat('uDepth', depth);\n\n    gl.drawElements(gl.TRIANGLES, indices.numItems, gl.UNSIGNED_SHORT, 0);\n\n    if (useState !== true) {\n        gpu.setState(tmpState);\n    }\n};\n\n\nRendererDraw.prototype.drawBillboard = function(mvp, texture, color, depthOffset, depthTest, transparent, writeDepth, useState) {\n    var gpu = this.gpu;\n    var gl = this.gl;\n    var renderer = this.renderer;\n\n    if (useState !== true) {\n        var tmpState = gpu.currentState;\n\n        gpu.setState({\n            ztest: !(depthTest !== true),\n            blend: (transparent === true),\n            zwrite: !(writeDepth === false),\n            stencil: false,\n            culling: false,\n            zequal: false\n        });\n    }\n\n    var prog = renderer.progImage;\n\n    gpu.useProgram(prog, ['aPosition', 'aTexCoord']);\n    gpu.bindTexture(texture);\n    prog.setSampler('uSampler', 0);\n\n    var vertices = renderer.rectVerticesBuffer;\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertices);\n    gl.vertexAttribPointer(prog.getAttribute('aPosition'), vertices.itemSize, gl.FLOAT, false, 0, 0);\n\n    var indices = renderer.rectIndicesBuffer;\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indices);\n\n    prog.setMat4('uProjectionMatrix', mvp, depthOffset ? renderer.getZoffsetFactor(depthOffset) : null);\n\n    var x = 0, y = 0, lx = 1, ly = 1;\n\n    prog.setMat4('uData', [\n        x, y,  0, 0,\n        x + lx, y,  1, 0,\n        x + lx, y + ly, 1, 1,\n        x,  y + ly,  0, 1  ]);\n\n    prog.setVec4('uColor', (color != null ? color : [1,1,1,1]));\n    prog.setFloat('uDepth', 0);\n\n    gl.drawElements(gl.TRIANGLES, indices.numItems, gl.UNSIGNED_SHORT, 0);\n\n    if (useState !== true) {\n        gpu.setState(tmpState);\n    }\n};\n\n\n//draw flat 2d image - used for debuging\nRendererDraw.prototype.drawFlatImage = function(x, y, lx, ly, texture, color, depth, depthOffset) {\n    var gpu = this.gpu;\n    var gl = this.gl;\n    var renderer = this.renderer;\n\n    if (texture == null || renderer.imageProjectionMatrix == null) {\n        return;\n    }\n\n    var prog = renderer.progImage;\n\n    gpu.useProgram(prog, ['aPosition']);\n    gpu.bindTexture(texture);\n\n    var vertices = renderer.rectVerticesBuffer;\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertices);\n    gl.vertexAttribPointer(prog.getAttribute('aPosition'), vertices.itemSize, gl.FLOAT, false, 0, 0);\n\n    var indices = renderer.rectIndicesBuffer;\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indices);\n\n    prog.setMat4('uProjectionMatrix', renderer.imageProjectionMatrix);\n\n    prog.setMat4('uData', [\n        x, y,  0, 0,\n        x + lx, y,  1, 0,\n        x + lx, y + ly, 1, 1,\n        x,  y + ly,  0, 1  ]);\n\n    prog.setVec4('uColor', (color != null ? color : [1,1,1,1]));\n    prog.setFloat('uDepth', depth != null ? depth : 0);\n\n    gl.drawElements(gl.TRIANGLES, indices.numItems, gl.UNSIGNED_SHORT, 0);\n};\n\n\n//draw 2d text - used for debuging\nRendererDraw.prototype.drawText = function(x, y, size, text, color, depth, useState) {\n    var gpu = this.gpu;\n    var gl = this.gl;\n    var renderer = this.renderer;\n\n    if (renderer.imageProjectionMatrix == null) {\n        return;\n    }\n\n    if (useState !== true) {\n        var tmpState = gpu.currentState;\n\n        gpu.setState({\n          ztest: !(depth == null),\n          blend: false,\n          zwrite: !(depth == null),\n          stencil: false,\n          culling: false,\n          zequal: !(depth == null)\n        });\n    }\n\n    var prog = renderer.progImage;\n\n    gpu.useProgram(prog, ['aPosition']);\n    gpu.bindTexture(renderer.textTexture2);\n\n    var vertices = renderer.rectVerticesBuffer;\n    gl.bindBuffer(gl.ARRAY_BUFFER, vertices);\n    gl.vertexAttribPointer(prog.getAttribute('aPosition'), vertices.itemSize, gl.FLOAT, false, 0, 0);\n\n    var indices = renderer.rectIndicesBuffer;\n    gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indices);\n\n    prog.setMat4('uProjectionMatrix', renderer.imageProjectionMatrix);\n    prog.setVec4('uColor', color);\n    prog.setFloat('uDepth', depth != null ? depth : 0);\n\n    var sizeX = size - 1;\n    var sizeY = size;\n\n    var sizeX2 = Math.round(size*0.5);\n\n    var texelX = 1 / 256;\n    var texelY = 1 / 128;\n\n    var lx = this.getTextSize(size, text) + 2;\n\n    //draw black line before text\n    var char = 0;\n    var charPosX = (char & 15) << 4;\n    var charPosY = (char >> 4) << 4;\n\n    prog.setMat4('uData', [\n        x-2, y-2,  (charPosX * texelX), (charPosY * texelY),\n        x-2 + lx, y-2,  ((charPosX+15) * texelX), (charPosY * texelY),\n        x-2 + lx, y + sizeY+1, ((charPosX + 15) * texelX), ((charPosY+15) * texelY),\n        x-2,  y + sizeY+1,  (charPosX * texelX), ((charPosY+15) * texelY) ]);\n\n    gl.drawElements(gl.TRIANGLES, indices.numItems, gl.UNSIGNED_SHORT, 0);\n    \n\n    for (var i = 0, li = text.length; i < li; i++) {\n        char = text.charCodeAt(i) - 32;\n        charPosX = (char & 15) << 4;\n        charPosY = (char >> 4) << 4;\n\n        switch(char) {\n        case 12:\n        case 14:\n        case 27: //:\n        case 28: //;\n        case 64: //'\n        case 73: //i\n        case 76: //l\n        case 84: //t\n\n            prog.setMat4('uData', [\n                x, y,  (charPosX * texelX), (charPosY * texelY),\n                x + sizeX2, y,  ((charPosX+8) * texelX), (charPosY * texelY),\n                x + sizeX2, y + sizeY, ((charPosX + 8) * texelX), ((charPosY+16) * texelY),\n                x,  y + sizeY,  (charPosX * texelX), ((charPosY+16) * texelY) ]);\n\n            x += sizeX2;\n            break;\n\n        default:\n\n            prog.setMat4('uData', [\n                x, y,  (charPosX * texelX), (charPosY * texelY),\n                x + sizeX, y,  ((charPosX+15) * texelX), (charPosY * texelY),\n                x + sizeX, y + sizeY, ((charPosX + 15) * texelX), ((charPosY+16) * texelY),\n                x,  y + sizeY,  (charPosX * texelX), ((charPosY+16) * texelY) ]);\n\n            x += sizeX;\n                \n            break;\n        }\n\n        gl.drawElements(gl.TRIANGLES, indices.numItems, gl.UNSIGNED_SHORT, 0);\n\n    }\n\n    if (useState !== true) {\n        gpu.setState(tmpState);\n    }\n};\n\n\nRendererDraw.prototype.getTextSize = function(size, text) {\n    var sizeX = size - 1;\n    var sizeX2 = Math.round(size*0.5);\n    var x = 0;\n\n    for (var i = 0, li = text.length; i < li; i++) {\n        var char = text.charCodeAt(i) - 32;\n\n        switch(char) {\n        case 12:\n        case 14:\n        case 27: //:\n        case 28: //;7\n        case 64: //'\n        case 73: //i\n        case 76: //l\n        case 84: //t\n            x += sizeX2;\n            break;\n\n        default:\n            x += sizeX;\n            break;\n        }\n    }\n    \n    return x;\n};\n\n\nRendererDraw.prototype.drawGpuJobs = function() {\n    var gpu = this.gpu;\n    var gl = this.gl;\n    var renderer = this.renderer;\n    var sortHysteresis = renderer.config.mapSortHysteresis;\n    var timerWait = renderer.config.mapHysteresisWait;\n\n    renderer.geoRenderCounter++;\n    renderer.totalJobs = 0;\n    renderer.drawnJobs = 0;\n    renderer.jobsTimer4 = 0;\n    renderer.jobsTimer3 = 0;\n    renderer.jobsTimer2 = 0;\n    renderer.jobsTimer1 = performance.now();\n\n    //setup stencil\n    gl.stencilMask(0xFF);\n    gl.clear(gl.STENCIL_BUFFER_BIT);\n    gl.stencilFunc(gl.EQUAL, 0, 0xFF);\n    gl.stencilOp(gl.KEEP, gl.KEEP, gl.INCR);\n\n    var screenPixelSize = [1.0/renderer.curSize[0], 1.0/renderer.curSize[1]];\n    var rmap = this.rmap;\n    var clearPass = 513;\n    var clearPassIndex = 0;\n    var clearStencilPasses = renderer.clearStencilPasses;\n    var jobZBuffer = renderer.jobZBuffer;\n    var jobZBufferSize = renderer.jobZBufferSize;\n    var jobZBuffer2 = renderer.jobZBuffer2;\n    var jobZBuffer2Size = renderer.jobZBuffer2Size;\n    var onlyHitLayers = renderer.onlyHitLayers;\n    var onlyAdvancedHitLayers = renderer.onlyAdvancedHitLayers;\n    var geoRenderCounter = renderer.geoRenderCounter;\n    var job, key, hitmapRender = renderer.onlyHitLayers;\n    //var logDebugInfo = false;\n\n    var hsortBuff = renderer.jobHSortBuffer;\n    var hsortBuffSize = 0;\n\n    if (clearStencilPasses.length > 0) {\n        clearPass = clearStencilPasses[0];\n        clearPassIndex++;\n    }\n\n    if (this.rmap.counter != this.renderer.geoRenderCounter) {\n        this.rmap.clear();\n    }\n\n    renderer.gmapIndex = 0;\n    renderer.gmapUseVersion = 1;\n\n    var forceUpdate = false;\n\n    var ret, frameTime = renderer.frameTime, sortHbuffer = false;\n\n    //console.log(\"\" + frameTime);\n\n    //draw job buffer and also clean buffer\n    for (var i = 0, li = jobZBuffer.length; i < li; i++) {\n        var j, lj = jobZBufferSize[i], lj2 = jobZBuffer2Size[i];\n        var buffer = jobZBuffer[i];\n        var buffer2 = jobZBuffer2[i];\n        renderer.jobHBuffer = {};\n\n        renderer.totalJobs += lj;\n\n        if (lj > 0 && i >= clearPass) {\n            gl.clear(gl.STENCIL_BUFFER_BIT);\n\n            if (clearStencilPasses.length > clearPassIndex) {\n                clearPass = clearStencilPasses[clearPassIndex];\n                clearPassIndex++;\n            } else {\n                clearPass = 513;\n            }\n        }\n\n        if (onlyHitLayers) {\n            if (onlyAdvancedHitLayers) {\n                for (j = 0; j < lj; j++) {\n                    if (buffer[j].advancedHit) {\n                        this.drawGpuJob(gpu, gl, renderer, buffer[j], screenPixelSize, true);\n                    }\n                }\n            } else {\n                for (j = 0; j < lj; j++) {\n                    var job = buffer[j];\n                    if (job.hitable) {\n                        this.drawGpuJob(gpu, gl, renderer, job, screenPixelSize);\n                        if (job.advancedHit) {\n                            renderer.advancedPassNeeded = true;\n                        }\n                    }\n                }\n            }\n        } else {\n\n            for (j = 0; j < lj; j++) {\n \n                job = buffer[j];\n                this.drawGpuJob(gpu, gl, renderer, job, screenPixelSize);\n            }\n\n            /*if (logDebugInfo) {\n                for (j = 0; j < lj; j++) {\n                    job = buffer[j];\n                    console.log('' + j + ' ' + job.id);\n                }\n            }*/\n        }\n    \n        renderer.jobsTimer3 = performance.now();\n\n        if (renderer.gmapIndex > 0) {\n            switch(renderer.gmapUseVersion) {\n                case 1: //scr-count4\n                    processGMap(gpu, gl, renderer, screenPixelSize, this);\n                    break;\n                case 2:  //scr-count5\n                    processGMap4(gpu, gl, renderer, screenPixelSize, this);\n                    break;\n                case 3: //scr-count6\n                    processGMap5(gpu, gl, renderer, screenPixelSize, this);\n                    break;\n                case 4: //scr-count7\n                    processGMap6(gpu, gl, renderer, screenPixelSize, this);\n                    break;\n                case 5: //scr-count8\n                    processGMap7(gpu, gl, renderer, screenPixelSize, this);\n                    break;\n            }\n            renderer.gmapIndex = 0;\n        }\n\n        if (rmap.rectanglesCount > 0 || rmap.rectangles2Count > 0) {\n            rmap.processRectangles(gpu, gl, renderer, screenPixelSize);\n        }\n\n        renderer.jobsTimer4 += performance.now() - renderer.jobsTimer3;\n\n        //lj2 = jobZBuffer2Size[i]; //probably no op\n\n        lj2 = false;\n        var hbuffer = renderer.jobHBuffer;\n\n        for (key in hbuffer) {\n            lj2 = true;\n            break;\n        }\n\n        for (key in buffer2) {\n            lj2 = true;\n            break;\n        }\n\n        if (lj2) {\n\n            if (!hitmapRender) {\n\n                for (key in hbuffer) {\n                    job = hbuffer[key];\n\n                     if (job.hysteresis && job.id) {\n                        var job2 = buffer2[job.id];\n\n                        if (!job2) {\n                            job.timerShow = 0;\n                            job.timerHide = 0;\n                            job.draw = false;\n                            job.hysteresisCounter = renderer.geoRenderCounter;\n                            buffer2[job.id] = job;\n                            jobZBuffer2Size[i]++;\n                            forceUpdate = true;\n                        } else {\n\n                            if (job == job2) {\n                                job2.hysteresisCounter = renderer.geoRenderCounter;\n                            } else {\n                                job2.hysteresisBackup = job;\n                            }\n\n                        }\n\n                        //if (job.hysteresis[3] === true) {\n                            sortHbuffer = true;\n                        //}\n                    }\n                }\n            }\n\n            for (key in buffer2) {\n                job = buffer2[key];\n                job2 = hbuffer[key];\n\n                renderer.drawnJobs++;\n\n                if (!hitmapRender) {\n                    if (job2) {\n                        if (isNaN(job.timerShow)) {\n                            job.timerShow = 0;\n                            job.timerHide = 0;\n                            job.draw = false;\n                        }\n\n                        if (!job.draw) {\n                            job.timerShow += frameTime;\n\n                            if ((job.timerShow - timerWait) > (job.hysteresis[0])) {\n                                job.draw = true;\n                                job.timerShow = 0;\n                            } else {\n                                forceUpdate = true;\n                            }\n                        } else if (job.timerHide) {\n                            job.draw = false;\n                            job.timerShow = timerWait + (job.hysteresis[0]) * (1.0-(job.timerHide / (job.hysteresis[1])));\n                        }\n\n                        job.timerHide = 0;\n\n                    } else {\n                        //job = buffer2[key];\n\n                        if (job.draw) {\n                            job.timerHide += frameTime;\n\n                            if (job.timerHide > (job.hysteresis[1])) {\n                                delete buffer2[key];\n                                jobZBuffer2Size[i]--;\n                                job.draw = false;\n                                job.timerHide = 0;\n                            } else {\n                                forceUpdate = true;\n                            }\n                        } else if (job.timerShow) {\n                            job.draw = true;\n                            job.timerHide = (job.hysteresis[1]) * (1.0-((job.timerShow-timerWait) / (job.hysteresis[0])));\n                        }\n\n                        job.timerShow = 0;\n                    }\n                }\n\n                var draw = job.draw, fade = null;\n\n                if (!hitmapRender && job.hysteresis[3] === true) {\n \n                    if (draw) {\n                        if (job.timerHide != 0) {\n                            fade = job.timerHide / (job.hysteresis[1]+1);\n                            fade = 1.0 - Math.min(1.0, fade);\n                        }\n                    } else {\n                        if (job.timerShow != 0 && (job.timerShow-timerWait) > 0) {\n                            fade = (job.timerShow -timerWait) / (job.hysteresis[0]+1);\n                            fade = Math.min(1.0, fade);\n                            draw = true;\n                        }\n                    }\n                }\n\n\n                if (draw) {\n\n                    if (job.hysteresisCounter != renderer.geoRenderCounter && job.hysteresisBackup) {\n                        var job3 = job.hysteresisBackup;\n                        buffer2[key] = job3;\n\n                        job3.timerShow = job.timerShow;\n                        job3.timerHide = job.timerHide;\n                        job3.draw = job.draw;\n\n                        job = job3;\n                    }\n\n                    // update job matricies\n                    if (job.renderCounter[0][0] !== geoRenderCounter && job.renderCounter[0][0] !== null) { \n                        job.updatePos = true;\n\n                        var renderCounter = job.renderCounter[0];\n\n                        var mvp = mat4.create();\n                        var mv = mat4.create();\n                        var group = renderCounter[3];\n                        var bbox = group.bbox;\n                        var geoPos = renderer.cameraPosition;\n                    \n                        var m = math.translationMatrix(bbox.min[0] - geoPos[0], bbox.min[1] - geoPos[1], bbox.min[2] - geoPos[2]);\n                        mat4.multiply(renderer.camera.getModelviewMatrix(), m, mv);\n\n                        var proj = renderer.camera.getProjectionMatrix();\n                        mat4.multiply(proj, mv, mvp);\n\n                        job.mv = mv;\n                        job.mvp = mvp;\n                    }                    \n\n                    if (sortHysteresis) {\n\n                        job.fade = fade;\n\n                        hsortBuff[hsortBuffSize] = job;\n                        hsortBuffSize++;\n\n                    } else {\n\n                        switch(job.type) {\n                            case VTS_JOB_VSPOINT:\n                                var viewExtent = renderer.viewExtent;\n                                var slayers = job.vswitch[job.vswitchIndex];\n\n                                if (slayers) {\n                                    slayers = slayers[1];\n\n                                    for (var k = 0, lk = slayers.length; k < lk; k++) {\n                                        var sjob = slayers[k];\n                                        sjob.updatePos = job.updatePos;\n                                        sjob.mvp = job.mvp;\n                                        sjob.mv = job.mv;\n                                        this.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, sjob.lastSubJob, fade);\n                                    }\n                                }\n\n                                break;\n\n                            case VTS_JOB_LINE_LABEL:\n                                this.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, job.lastSubJob, fade);\n                                break;\n\n                            default:\n                                this.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, job.lastSubJob, fade);\n                                break;\n                        }\n\n                        job.updatePos = false;\n                    }\n                }\n\n                job.hysteresisBackup = null;\n            }\n        }\n    }\n\n    if (sortHysteresis && hsortBuffSize) {\n\n        radixDepthSortFeatures(renderer, hsortBuff, hsortBuffSize, renderer.gmap2);\n\n        for (i = 0; i < hsortBuffSize; i++) {\n            job = hsortBuff[i];\n\n            switch(job.type) {\n                case VTS_JOB_VSPOINT:\n                    var viewExtent = renderer.viewExtent;\n                    var slayers = job.vswitch[job.vswitchIndex];\n\n                    if (slayers) {\n                        slayers = slayers[1];\n\n                        for (var k = 0, lk = slayers.length; k < lk; k++) {\n                            var sjob = slayers[k];\n                            sjob.updatePos = job.updatePos;\n                            sjob.mvp = job.mvp;\n                            sjob.mv = job.mv;\n                            this.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, sjob.lastSubJob, job.fade);\n                        }\n                    }\n\n                break;\n\n                case VTS_JOB_LINE_LABEL:\n                    this.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, job.lastSubJob, job.fade);\n                    break;\n\n                default:\n                    this.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, job.lastSubJob, job.fade);\n                    break;\n            }\n\n            job.updatePos = false;\n        }\n\n    }\n\n    if (forceUpdate) {\n        this.core.markDirty();\n    }\n\n    renderer.jobsTimer2 = performance.now();\n};\n\n\nRendererDraw.prototype.clearJobBuffer = function() {\n    var renderer = this.renderer;\n    var jobZBuffer = renderer.jobZBuffer;\n    var jobZBufferSize = renderer.jobZBufferSize;\n\n    //clean job buffer\n    for (var i = 0, li = jobZBuffer.length; i < li; i++) {\n        var lj = jobZBufferSize[i];\n        var buffer = jobZBuffer[i];\n\n        for (var j = 0; j < lj; j++) {\n            buffer[j] = null;\n        }\n\n        jobZBufferSize[i] = 0;\n    }\n};\n\n\nRendererDraw.prototype.clearJobHBuffer = function() {\n    var renderer = this.renderer;\n    var jobZBuffer2 = renderer.jobZBuffer2;\n    var jobZBuffer2Size = renderer.jobZBuffer2Size;\n\n    //clean job hbuffer\n    for (var i = 0, li = jobZBuffer2.length; i < li; i++) {\n        jobZBuffer2[i] = {};\n        jobZBuffer2Size[i] = 0;\n    }\n};\n\n\nRendererDraw.prototype.paintGL = function() {   //remove this??\n    var renderer = this.renderer;\n\n    this.gpu.clear(true, false);\n\n    if (!renderer.onlyLayers) {\n        if (!renderer.onlyDepth && !renderer.onlyHitLayers) {\n            this.drawSkydome();\n        }\n    }\n};\n\n\nRendererDraw.prototype.processNoOverlap = function(renderer, job, pp, p1, p2, camVec, l, stickShift, texture, files, color) {\n    var res = { \n        exit: true\n    };\n\n    var reduce78 = (job.reduce && (job.reduce[0] >= 7 && job.reduce[0] <= 11));\n\n    if (!renderer.drawAllLabels && job.noOverlap) { \n        if (!pp) {\n            //if (job.type == VTS_JOB_LINE_LABEL) {\n              //  pp = renderer.project2(job.center2, job.mvp, [0,0,0]);\n            //} else {\n                pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition, true);\n            //}\n        }\n\n        res.pp = pp;\n        var o = job.noOverlap, depth = pp[2];\n\n        if (depth < 0 || depth > 1.0) {\n            return res;\n        }\n\n        if (job.type == VTS_JOB_LINE_LABEL) {\n            if (renderer.benevolentMargins) {\n                if (!renderer.rmap.checkRectangle(pp[0]-200, pp[1]-200, pp[0]+200, pp[1]+200, 0)) {\n                    return res;\n                }\n            } else{ \n                if (!renderer.rmap.checkRectangle(pp[0], pp[1], pp[0], pp[1], 0)) {\n                    return res;\n                }\n            }\n        } else {\n            if (!renderer.rmap.checkRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], stickShift)) {\n                return res;\n            }\n        }\n\n        if (o[4] !== null) {\n            if (o[4] === VTS_NO_OVERLAP_DIRECT) {\n                depth = o[5];\n            } else {\n                if (l === null) {\n                    p2 = job.center2;\n                    p1 = renderer.cameraPosition;\n                    camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n                    l = vec3.length(camVec) + 0.0001;\n                }\n\n                if (!job.reduce || (job.reduce && !(job.reduce[0] >= 8 && job.reduce[0] <= 11))) {  //not overlap code not used for reduce==8\n                    depth = o[5] / l;\n                }\n            } \n        }\n\n        job.lastSubJob = [job, stickShift, texture, files, color, pp, true, depth, o];\n\n        if (reduce78) {\n            renderer.gmapUseVersion = (job.reduce[0] >= 8 && job.reduce[0] <= 11) ? (job.reduce[0] - 6) : 1;\n            renderer.gmap[renderer.gmapIndex] = job.lastSubJob;\n            renderer.gmapIndex++;\n\n            if (renderer.config.mapFeaturesReduceFactor >= 1) { // prom / dists\n                if (l === null) {\n                    p2 = job.center2;\n                    p1 = renderer.cameraPosition;\n                    camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n                    l = vec3.length(camVec) + 0.0001;\n                }\n\n                if (l > renderer.fmaxDist) renderer.fmaxDist = l;\n                if (l < renderer.fminDist) renderer.fminDist = l;\n\n                job.reduce[1] = job.reduce[2];\n                job.reduce[4] = l;\n            }\n            return res;\n        }\n\n        if (job.type == VTS_JOB_LINE_LABEL) {\n            if (!renderer.rmap.addLineLabel(job.lastSubJob)) {\n                //renderer.rmap.storeRemovedLineLabel(job.lastSubJob);\n                return res;\n            }\n        } else {\n            if (!renderer.rmap.addRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], depth, job.lastSubJob)) {\n                renderer.rmap.storeRemovedRectangle(pp[0]+o[0], pp[1]+o[1], pp[0]+o[2], pp[1]+o[3], depth, job.lastSubJob);\n                return res;\n            }\n        }\n\n        return res; //draw all labe from same z-index together\n    } else {\n        if (reduce78) {\n            if (!pp) {\n                pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition, true);\n            }\n\n            job.lastSubJob = [job, stickShift, texture, files, color, pp, false];\n\n            renderer.gmapUseVersion = (job.reduce[0] >= 8 && job.reduce[0] <= 11) ? (job.reduce[0] - 6) : 1;\n            renderer.gmap[renderer.gmapIndex] = job.lastSubJob;\n            renderer.gmapIndex++;\n\n            if (renderer.config.mapFeaturesReduceFactor >= 1) { // prom / dists\n                if (l === null) {\n                    p2 = job.center2;\n                    p1 = renderer.cameraPosition;\n                    camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n                    l = vec3.length(camVec) + 0.0001;\n                }\n\n                if (l > renderer.fmaxDist) renderer.fmaxDist = l;\n                if (l < renderer.fminDist) renderer.fminDist = l;\n\n                job.reduce[1] = job.reduce[2];\n                job.reduce[4] = l;\n            }\n\n            res.pp = pp;\n            return res;\n        }\n    }\n\n    if (job.hysteresis && job.id) {\n        if (!pp) {\n            pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition, true);\n        }\n\n        job.lastSubJob = [job, stickShift, texture, files, color, pp];\n        renderer.jobHBuffer[job.id] = job;\n        res.pp = pp;\n        return res;\n     } else {\n        res.pp = pp;\n     }\n\n    res.exit = false;\n\n    return res;\n}\n\nRendererDraw.prototype.drawGpuJob = function(gpu, gl, renderer, job, screenPixelSize, advancedHitPass, ignoreFilters) {\n    if (!job.ready) {\n        return;\n    }\n\n    //if (!(job.tile.id[0] == 14 && job.tile.id[1] == 4383 && job.tile.id[2] == 2863)) {\n      //  return;\n    //}\n\n    if (!job.eventInfo) {\n        return;\n    }\n\n    var state = job.state & 0xff;\n    var id = job.eventInfo['#id'];\n\n    if (id != null) {\n\n        if (job.state & (2 << 8)) { //has selection layers?\n\n            if (renderer.geodataSelection.indexOf(id) != -1) {  // is selected\n\n                if (job.state & (3 << 8)) { //has hover layers?\n\n                    if (renderer.hoverFeature && renderer.hoverFeature[0]['#id'] == id) {\n                        if (state != 3) {\n                            return;\n                        }\n                    } else {\n                        if (state != 2) {\n                            return;\n                        }\n                    }\n                }\n            } else if (job.state & (1 << 8)) { //has hover layers?\n\n                if (renderer.hoverFeature && renderer.hoverFeature[0]['#id'] == id) {\n                    if (state != 1) {\n                        return;\n                    }\n                } else {\n                    if (state != 0) {\n                        return;\n                    }\n                }\n\n            } else {\n                if (state != 0) {\n                    return;\n                }        \n            }\n        \n        } else if (job.state & (1 << 8)) { //has hover layers?\n\n            if (renderer.hoverFeature && renderer.hoverFeature[0]['#id'] == id) {\n                if (state != 1) {\n                    return;\n                }\n            } else {\n                if (state != 0) {\n                    return;\n                }\n            }\n\n        } else {\n            if (state != 0) {\n                return;;\n            }        \n        }\n\n    } else {\n        if (state != 0) {\n            return;\n        }        \n    }\n\n    var mvp = job.mvp, prog, texture, res;\n    var vertexPositionAttribute, vertexTexcoordAttribute,\n        vertexNormalAttribute, vertexOriginAttribute, vertexElementAttribute;\n\n    var hitmapRender = job.hitable && renderer.onlyHitLayers;\n    var screenPixelSize2, color = job.color;\n    var useSuperElevation = renderer.useSuperElevation;\n\n    if (hitmapRender) {\n        var c = renderer.hoverFeatureCounter;\n        //color = [(c&255)/255, ((c>>8)&255)/255, ((c>>16)&255)/255, 1];\n        color = [(c&255)/255, ((c>>8)&255)/255, 0, 0];\n        renderer.hoverFeatureList[c] = [job.eventInfo, job.center, job.clickEvent, job.hoverEvent, job.enterEvent, job.leaveEvent, advancedHitPass];\n        renderer.hoverFeatureCounter++;\n    }\n\n    switch(job.type) {\n    case VTS_JOB_FLAT_LINE:\n    case VTS_JOB_POLYGON:\n\n        if (job.type == VTS_JOB_POLYGON) {\n            if (hitmapRender) {\n                if (job.stencil) {\n                    gpu.setState(job.culling ? renderer.polygonB0S1C1tate : renderer.polygonB0S1C0tate);\n                } else {\n                    gpu.setState(job.culling ? renderer.polygonB0S0C1tate : renderer.polygonB0S0C0tate);\n                }\n            } else {\n                if (job.stencil) {\n                    gpu.setState(job.culling ? renderer.polygonB1S1C1tate : renderer.polygonB1S1C0tate);\n                } else {\n                    gpu.setState(job.culling ? renderer.polygonB1S0C1tate : renderer.polygonB1S0C0tate);\n                }\n            }\n        } else {\n            gpu.setState(hitmapRender ? renderer.stencilLineHitState : renderer.stencilLineState);\n        }\n\n        var debugWires = (gpu === 0); //just generate false value to avoid compiler warnings;\n\n        if (useSuperElevation) {\n            prog = advancedHitPass ? job.program2 : renderer.progLineSE;\n        } else {            \n            prog = advancedHitPass ? job.program2 : debugWires ? renderer.progLineWireframe : job.program;\n        }\n\n        var flatShade = (!advancedHitPass && job.type == VTS_JOB_POLYGON && job.style == 1);\n\n        if (flatShade) { \n            prog = useSuperElevation ? renderer.progCFlatShadeTileSE : renderer.progCFlatShadeTile;\n        }\n\n        gpu.useProgram(prog, advancedHitPass ? ['aPosition', 'aElement'] : debugWires ? ['aPosition', 'aBarycentric'] : ['aPosition']);\n\n        if (useSuperElevation) {\n            var m = this.mBuffer;\n            var se = renderer.superElevation;\n\n            m[0] = job.bbox.min[0];\n            m[1] = job.bbox.min[1];\n            m[2] = job.bbox.min[2];\n\n            m[3] = 1;\n            m[4] = 1;\n            m[5] = 1;\n\n            m[9] = se[0]; // h1\n            m[10] = se[1]; // f1\n            m[11] = se[2]; // h2\n            m[12] = se[6]; // inv dh\n            m[13] = se[5]; // df\n\n            m[14] = renderer.earthRadius;\n            m[15] = renderer.earthERatio;\n\n            prog.setMat4('uParamsSE', m);\n        }\n\n        if (flatShade) { \n            prog.setMat4('uMV', job.mv);\n            prog.setMat4('uProj', renderer.camera.getProjectionFMatrix(), renderer.getZoffsetFactor(job.zbufferOffset));\n            prog.setVec4('uColor', color);\n        } else {\n            prog.setMat4('uMVP', mvp, renderer.getZoffsetFactor(job.zbufferOffset));\n            prog.setVec4('uColor', color);\n        }\n\n        vertexPositionAttribute = prog.getAttribute('aPosition');\n\n        //bind vetex positions\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexPositionBuffer);\n        gl.vertexAttribPointer(vertexPositionAttribute, job.vertexPositionBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n        if (advancedHitPass) {\n            vertexElementAttribute = prog.getAttribute('aElement');\n            gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexElementBuffer);\n            gl.vertexAttribPointer(vertexElementAttribute, job.vertexElementBuffer.itemSize, gl.FLOAT, false, 0, 0);\n        }\n\n        if (debugWires) {\n            var barycentericAttribute = prog.getAttribute('aBarycentric');\n            gl.bindBuffer(gl.ARRAY_BUFFER, gpu.barycentricBuffer);\n            gl.vertexAttribPointer(barycentericAttribute, gpu.barycentricBuffer.itemSize, gl.FLOAT, false, 0, 0);\n        }\n        \n        //draw polygons\n        gl.drawArrays(gl.TRIANGLES, 0, job.vertexPositionBuffer.numItems);\n\n        var drawDebugLines = renderer.debug.drawPolyWires;// false;//true;\n\n        if (drawDebugLines) {\n\n            var program = useSuperElevation ? renderer.progWireFrameBasicSE : renderer.progWireFrameBasic;\n            renderer.gpu.useProgram(program, ['aPosition']);\n\n            if (useSuperElevation) {\n                program.setMat4('uParamsSE', m);\n            }\n\n            program.setMat4('uMV', job.mv);\n            program.setVec4('uColor', [0,0,0,1]);\n\n            program.setMat4('uProj', renderer.camera.getProjectionFMatrix(), renderer.getZoffsetFactor(job.zbufferOffset));\n\n            for (var i = 0, li = job.vertexPositionBuffer.numItems*2; i < li; i+=3) {\n                gl.drawArrays(gl.LINE_LOOP, i, 3);\n            }\n\n\n        }\n\n        break;\n\n    case VTS_JOB_FLAT_RLINE:\n    case VTS_JOB_FLAT_TLINE:\n    case VTS_JOB_PIXEL_LINE:\n    case VTS_JOB_PIXEL_TLINE:\n        gpu.setState(hitmapRender ? renderer.stencilLineHitState : renderer.stencilLineState);\n\n        prog = advancedHitPass ? job.program2 : job.program;\n        texture = null;\n        var textureParams = [0,0,0,0];\n        screenPixelSize2 = screenPixelSize;\n\n        if (hitmapRender) {\n            if (job.type == VTS_JOB_PIXEL_TLINE) {\n                if (job.widthByRatio) {\n                    screenPixelSize2 = [ screenPixelSize[0] * renderer.curSize[1], screenPixelSize[1] * renderer.curSize[1]];\n                }\n                prog = advancedHitPass ? this.renderer.progELine3 : this.renderer.progLine3;\n                if (!prog.isReady()) {\n                    return;\n                }\n            }\n        }\n\n        if (job.type != VTS_JOB_PIXEL_LINE) {\n\n            if (job.type == VTS_JOB_FLAT_RLINE) {\n                textureParams = [0, 0, 0, job.widthByRatio ? renderer.cameraViewExtent : 1];\n            } else {\n                if (hitmapRender) {\n                    texture = renderer.whiteTexture;\n\n                    if (job.type == VTS_JOB_FLAT_TLINE || job.type == VTS_JOB_FLAT_RLINE) {\n                        textureParams = [0, 0, 0, job.widthByRatio ? renderer.cameraViewExtent : 1];\n                    }\n\n                } else {\n                    var t = job.texture;\n                    if (t == null || t[0] == null) {\n                        return;\n                    }\n\n                    texture = t[0];\n                    textureParams = [0, t[1]/t[0].height, (t[1]+t[2])/t[0].height, job.widthByRatio ? renderer.cameraViewExtent : 1];\n\n                    if (job.type == VTS_JOB_FLAT_TLINE || job.type == VTS_JOB_FLAT_RLINE) {\n                        if (job.widthByRatio) {\n                            textureParams[0] = 1/(renderer.cameraViewExtent2*job.lineWidth)/(texture.width/t[2]);\n                        } else {\n                            textureParams[0] = 1/job.lineWidth/(texture.width/t[2]);    \n                        }\n                    } else {\n                        if (job.widthByRatio) {\n                            textureParams[0] = 1/(renderer.cameraViewExtent2/renderer.curSize[1])/(texture.width/t[2]);\n                            textureParams[0] /= (renderer.curSize[1]*job.lineWidth*0.5);\n                            //textureParams[3] = renderer.curSize[1]*(1.0/job.lineWidth)*0.5;\n                            textureParams[3] = renderer.curSize[1];\n                        } else {\n                            textureParams[0] = 1/(renderer.cameraViewExtent2/renderer.curSize[1])/(texture.width/t[2]);\n                            textureParams[0] /= (job.lineWidth*0.5);\n                            textureParams[3] = 1;\n                        }    \n                    }\n                }\n\n                if (!texture.loaded) {\n                    return;\n                }\n\n                gpu.bindTexture(texture);\n            }\n\n        } else if (job.widthByRatio) {\n            screenPixelSize2 = [ screenPixelSize[0] * renderer.curSize[1], screenPixelSize[1] * renderer.curSize[1]];\n        }\n\n        if (useSuperElevation) {\n            prog = advancedHitPass ? job.program2 : renderer.progLine3SE;\n\n            var m = this.mBuffer;\n            var se = renderer.superElevation;\n\n            m[0] = job.bbox.min[0];\n            m[1] = job.bbox.min[1];\n            m[2] = job.bbox.min[2];\n\n            m[3] = 1;\n            m[4] = 1;\n            m[5] = 1;\n\n            m[9] = se[0]; // h1\n            m[10] = se[1]; // f1\n            m[11] = se[2]; // h2\n            m[12] = se[6]; // inv dh\n            m[13] = se[5]; // df\n\n            m[14] = renderer.earthRadius;\n            m[15] = renderer.earthERatio;\n\n            gpu.useProgram(prog, advancedHitPass ? ['aPosition','aNormal','aElement'] : ['aPosition','aNormal']);\n            prog.setMat4('uParamsSE', m);\n\n        } else {\n            gpu.useProgram(prog, advancedHitPass ? ['aPosition','aNormal','aElement'] : ['aPosition','aNormal']);\n        }           \n\n        prog.setVec4('uColor', color);\n        prog.setVec2('uScale', screenPixelSize2);\n        prog.setMat4('uMVP', mvp, renderer.getZoffsetFactor(job.zbufferOffset));\n\n        if (job.type != VTS_JOB_PIXEL_LINE) {\n            if (job.background != null) {\n                prog.setVec4('uColor2', hitmapRender ? [0,0,0,0] : job.background);\n            }\n            prog.setVec4('uParams', textureParams);\n            prog.setSampler('uSampler', 0);\n        }\n\n        vertexPositionAttribute = prog.getAttribute('aPosition');\n        vertexNormalAttribute = prog.getAttribute('aNormal');\n\n        //bind vetex positions\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexPositionBuffer);\n        gl.vertexAttribPointer(vertexPositionAttribute, job.vertexPositionBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n        //bind vetex normals\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexNormalBuffer);\n        gl.vertexAttribPointer(vertexNormalAttribute, job.vertexNormalBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n        if (advancedHitPass) {\n            vertexElementAttribute = prog.getAttribute('aElement');\n            gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexElementBuffer);\n            gl.vertexAttribPointer(vertexElementAttribute, job.vertexElementBuffer.itemSize, gl.FLOAT, false, 0, 0);\n        }\n\n        //draw polygons\n        gl.drawArrays(gl.TRIANGLES, 0, job.vertexPositionBuffer.numItems);\n\n        break;\n\n    case VTS_JOB_LINE_LABEL:\n        var files = job.files;\n\n        if (files.length > 0) {\n            for (var i = 0, li = files.length; i < li; i++) {\n                if (files[i].length > 0) {\n                    var font = job.fonts[i];\n                    if (font && !font.areTexturesReady(files[i])) {\n                        return;\n                    }\n                }\n            }\n\n        } else {\n            if (!hitmapRender) {\n                return;\n            }\n\n            texture = renderer.whiteTexture;\n        }\n\n        if (renderer.useSuperElevation) {\n            if (job.seCounter != renderer.seCounter) {\n                job.seCounter = renderer.seCounter;\n                job.labelPointsBuffer.id = -1;\n                job.center2 = renderer.transformPointBySE(job.center);\n            }\n        } else {\n            job.center2 = job.center;\n        }\n\n        var gamma = job.outline[2] * 1.4142 / 20;\n        var gamma2 = job.outline[3] * 1.4142 / 20;\n\n        if (job.singleBuffer) {\n\n            var p1, p2, camVec, ll, l = null, localTilt;\n\n            if (job.culling != 180) {\n                p2 = job.center2;\n                p1 = renderer.cameraPosition;\n                camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n\n                if (job.visibility) {\n                    l = vec3.length(camVec);\n\n                    switch(job.visibility.length) {\n                        case 1:\n                            if (l > job.visibility[0]) {\n                                return;\n                            }\n                            break;\n\n                        case 2:\n                            ll = l * renderer.localViewExtentFactor;\n                            if (ll < job.visibility[0] || ll > job.visibility[1]) {\n                                return;\n                            }\n\n                            break;\n\n                        case 4:\n                            ll = l * renderer.localViewExtentFactor;\n                            var diameter = job.visibility[0] * job.visibility[1];\n                            if (diameter < (job.visibility[2] * ll) || diameter > (job.visibility[3] * ll)) {\n                                return;\n                            }\n\n                            break;\n                    }\n\n                    l = 1/l;\n                    camVec[0] *= l;                       \n                    camVec[1] *= l;                       \n                    camVec[2] *= l;                       \n                } else {\n                    vec3.normalize(camVec);\n                }\n                    \n                job.normal = [0,0,0];\n                vec3.normalize(job.center2, job.normal);\n                    \n                localTilt = -vec3.dot(camVec, job.normal);\n\n                if (localTilt < Math.cos(math.radians(job.culling))) {\n                    return;\n                }\n                \n            } else if (job.visibility) {\n\n                p2 = job.center2;\n                p1 = renderer.cameraPosition;\n                camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n                l = vec3.length(camVec);\n\n                switch(job.visibility.length) {\n                    case 1:\n                        if (l > job.visibility[0]) {\n                            return;\n                        }\n                        break;\n\n                    case 2:\n                        l *= renderer.localViewExtentFactor;\n                        if (l < job.visibility[0] || l > job.visibility[1]) {\n                            return;\n                        }\n\n                        break;\n\n                    case 4:\n                        l *= renderer.localViewExtentFactor;\n\n                        var diameter = job.visibility[0] * job.visibility[1];\n                        if (diameter < (job.visibility[2] * l) || diameter > (job.visibility[3] * l)) {\n                            return;\n                        }\n\n                        break;\n                }\n            }\n\n            res = this.processNoOverlap(renderer, job, pp, p1, p2, camVec, l, stickShift, texture, files, color); //, pointsIndex);\n\n            if (res.exit) {\n                return;\n            } else {\n                //pp = res.pp;\n                //p1 = res.p1;\n                //p2 = res.p2;\n                //camVec = res.camVec;\n                //l = res.l;\n            }\n           \n            this.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, [job,0,texture,files,color,pp]);\n\n            /*\n            if (bl > 384) { vbuff = renderer.textQuads128; prog = renderer.progLineLabel128; } else\n            if (bl > 256) { vbuff = renderer.textQuads96; prog = renderer.progLineLabel96; } else\n            if (bl > 192) { vbuff = renderer.textQuads64; prog = renderer.progLineLabel64; } else\n            if (bl > 128) { vbuff = renderer.textQuads48; prog = renderer.progLineLabel48; } else\n            if (bl > 64) { vbuff = renderer.textQuads32; prog = renderer.progLineLabel32; }\n            else { vbuff = renderer.textQuads16; prog = renderer.progLineLabel16; }\n\n            gpu.useProgram(prog, ['aPosition']);\n            prog.setSampler('uSampler', 0);\n            prog.setMat4('uMVP', mvp, renderer.getZoffsetFactor(job.zbufferOffset));\n\n            prog.setVec4('uColor', hitmapRender ? color : job.color2);\n            prog.setVec2('uParams', [job.outline[0], gamma2]);\n            lj = hitmapRender ? 1 : 2;\n\n            var vertexPositionAttribute = prog.getAttribute('aPosition');\n\n            prog.setVec4('uData', b);\n\n            //bind vetex positions\n            gl.bindBuffer(gl.ARRAY_BUFFER, vbuff);\n            gl.vertexAttribPointer(vertexPositionAttribute, vbuff.itemSize, gl.FLOAT, false, 0, 0);\n\n            //draw polygons\n            for(var j = 0; j < (hitmapRender ? 1 : 2); j++) {\n                if (j == 1) {\n                    prog.setVec4('uColor', color);\n                    prog.setVec2('uParams', [job.outline[1], gamma]);\n                }\n\n                for (var i = 0, li = files.length; i < li; i++) {\n                    var fontFiles = files[i];\n\n                    for (var k = 0, lk = fontFiles.length; k < lk; k++) {\n                        var file = fontFiles[k];\n                        prog.setFloat('uFile', Math.round(file+i*1000));\n                        gpu.bindTexture(job.fonts[i].getTexture(file));\n                        gl.drawArrays(gl.TRIANGLES, 0, vitems / 3); //TODO: demystify vitems\n                    }\n                }\n            }\n\n            if (renderer.drawLabelBoxes) {\n                if (job.labelPoints.length > 0) {\n                    var points = job.labelPoints[0][pointsIndex];\n\n                    for(j = 0; j < points.length; j++) {\n                        pp = renderer.project2(points[j], mvp, [0,0,0], true);\n                        this.drawCircle(pp, points[j][3] *renderer.camera.scaleFactor2(pp[3])*0.5*renderer.curSize[1]*(renderer.curSize[0]/renderer.curSize[1]), 1, [255, 0, 255, 255], null, null, null, null, null);\n                    }\n                }\n            }*/\n\n            return;\n        }\n\n        gpu.setState(hitmapRender ? renderer.lineLabelHitState : renderer.lineLabelState);\n\n        prog = renderer.useSuperElevation ? renderer.progText2SE : job.program;\n        gpu.useProgram(prog, ['aPosition', 'aTexCoord']);\n\n        if (useSuperElevation) {\n            var m = this.mBuffer;\n            var se = renderer.superElevation;\n\n            m[0] = job.bbox.min[0];\n            m[1] = job.bbox.min[1];\n            m[2] = job.bbox.min[2];\n\n            m[3] = 1;\n            m[4] = 1;\n            m[5] = 1;\n\n            m[9] = se[0]; // h1\n            m[10] = se[1]; // f1\n            m[11] = se[2]; // h2\n            m[12] = se[6]; // inv dh\n            m[13] = se[5]; // df\n\n            m[14] = renderer.earthRadius;\n            m[15] = renderer.earthERatio;\n\n            prog.setMat4('uParamsSE', m);\n        }  \n\n        prog.setSampler('uSampler', 0);\n        prog.setMat4('uMVP', mvp, renderer.getZoffsetFactor(job.zbufferOffset));\n        prog.setVec4('uVec', renderer.labelVector);\n\n        prog.setVec4('uColor', (hitmapRender ? color : job.color2));\n        prog.setVec2('uParams', [job.outline[0], gamma2]);\n\n        vertexPositionAttribute = prog.getAttribute('aPosition');\n        vertexTexcoordAttribute = prog.getAttribute('aTexCoord');\n\n        //bind vetex positions\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexPositionBuffer);\n        gl.vertexAttribPointer(vertexPositionAttribute, job.vertexPositionBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n        //bind vetex texcoords\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexTexcoordBuffer);\n        gl.vertexAttribPointer(vertexTexcoordAttribute, job.vertexTexcoordBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n        //draw polygons\n        for(var j = 0; j < (hitmapRender ? 1 : 2); j++) {\n            if (j == 1) {\n                prog.setVec4('uColor', color);\n                prog.setVec2('uParams', [job.outline[1], gamma]);\n            }\n\n            if (files.length > 0) {\n                for (var i = 0, li = files.length; i < li; i++) {\n                    var fontFiles = files[i];\n\n                    for (var k = 0, lk = fontFiles.length; k < lk; k++) {\n                        var file = fontFiles[k];\n                        prog.setFloat('uFile', Math.round(file+i*1000));\n                        gpu.bindTexture(job.fonts[i].getTexture(file));\n                        gl.drawArrays(gl.TRIANGLES, 0, job.vertexPositionBuffer.numItems);\n                    }\n                }\n\n            } else {\n                gpu.bindTexture(texture);\n                gl.drawArrays(gl.TRIANGLES, 0, job.vertexPositionBuffer.numItems);\n            }\n        }\n\n        break;\n\n    case VTS_JOB_ICON:\n    case VTS_JOB_LABEL:\n    case VTS_JOB_PACK:\n    case VTS_JOB_VSPOINT:\n\n\n        if (job.reduce && !(job.reduce[0] >= 7 && job.reduce[0] <= 11)) {\n            var a, r = job.reduce;\n\n            if (r[0] > 4) {\n                \n                if (r[0] == 4) {\n                    a = Math.max(r[1], Math.floor(r[2] / Math.max(1, renderer.drawnGeodataTiles)));\n\n                    if (job.index >= a) {\n                        return;\n                    } \n                    r[5] = a; //for debug\n                } else {\n                    a = Math.pow(job.texelSize * job.tiltAngle, VTS_TILE_COUNT_FACTOR); \n                    a = Math.max(r[1], Math.round(r[2] * (a / Math.max(0.00001, this.renderer.drawnGeodataTilesFactor))));\n\n                    if (job.index >= a) {\n                        return;\n                    } \n                    r[5] = a; //for debug\n                }\n\n            } else {\n                a = job.tiltAngle;\n\n                if (r[0] == 1) {\n                    a = 1.0 - (Math.acos(a) * (1.0/(Math.PI*0.5)));\n                } else if (r[0] == 3) {\n                    a = (Math.cos(Math.acos(a) * 2) + 1.0) * 0.5;\n                }\n\n                var indexLimit = (Math.round(r[1] + (a*r[2]))-1);\n\n                if (job.index > indexLimit) {\n                    return;\n                } \n                r[5] = indexLimit; //for debug\n            }\n        }\n\n        var files = job.files;\n\n        if (job.type != VTS_JOB_VSPOINT) {\n            if (job.type == VTS_JOB_PACK) {\n\n                var notready = false;\n                \n                for (var j = 0, lj = job.subjobs.length; j < lj; j++) {\n                    var subjob = job.subjobs[j];\n\n                    files = subjob.files;\n\n                    if (files.length > 0) {\n                        for (var i = 0, li = files.length; i < li; i++) {\n                            if (files[i].length > 0) {\n                                var font = subjob.fonts[i];\n                                if (font && !font.areTexturesReady(files[i])) {\n                                    notready = true;\n                                }\n                            }\n                        }\n\n                    } else {\n                        texture = hitmapRender ? renderer.whiteTexture : subjob.texture;\n                        if (!texture.loaded) {\n                            notready = true;\n                        }\n                    }\n                }\n\n                if (notready) {\n                    return;\n                }\n\n            } else {\n                files = job.files;\n\n                if (files.length > 0) {\n                    for (var i = 0, li = files.length; i < li; i++) {\n                        if (files[i].length > 0) {\n                            var font = job.fonts[i];\n                            if (font && !font.areTexturesReady(files[i])) {\n                                return;\n                            }\n                        }\n                    }\n\n                } else {\n                    texture = hitmapRender ? renderer.whiteTexture : job.texture;\n                    if (!texture.loaded) {\n                        return;\n                    }\n                }\n            }\n        }\n\n        var p1, p2, camVec, ll, l = null, localTilt;\n\n        if (renderer.useSuperElevation) {\n            if (job.seCounter != renderer.seCounter) {\n                job.seCounter = renderer.seCounter;\n                job.center2 = renderer.transformPointBySE(job.center);\n            }\n        } else {\n            job.center2 = job.center;\n        }\n\n        if (job.culling != 180) {\n            p2 = job.center2;\n            p1 = renderer.cameraPosition;\n            camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n\n            if (job.visibility) {\n                l = vec3.length(camVec);\n\n                switch(job.visibility.length) {\n                    case 1:\n                        if (l > job.visibility[0]) {\n                            return;\n                        }\n                        break;\n\n                    case 2:\n                        ll = l * renderer.localViewExtentFactor;\n                        if (ll < job.visibility[0] || ll > job.visibility[1]) {\n                            return;\n                        }\n\n                        break;\n\n                    case 4:\n                        ll = l * renderer.localViewExtentFactor;\n                        var diameter = job.visibility[0] * job.visibility[1];\n                        if (diameter < (job.visibility[2] * ll) || diameter > (job.visibility[3] * ll)) {\n                            return;\n                        }\n\n                        break;\n                }\n\n                l = 1/l;\n                camVec[0] *= l;                       \n                camVec[1] *= l;                       \n                camVec[2] *= l;                       \n            } else {\n                vec3.normalize(camVec);\n            }\n                \n            job.normal = [0,0,0];\n            vec3.normalize(job.center2, job.normal);\n                \n            localTilt = -vec3.dot(camVec, job.normal);\n\n            if (localTilt < Math.cos(math.radians(job.culling))) {\n                return;\n            }\n            \n        } else if (job.visibility) {\n\n            p2 = job.center2;\n            p1 = renderer.cameraPosition;\n            camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n            l = vec3.length(camVec);\n\n            switch(job.visibility.length) {\n                case 1:\n                    if (l > job.visibility[0]) {\n                        return;\n                    }\n                    break;\n\n                case 2:\n                    l *= renderer.localViewExtentFactor;\n                    if (l < job.visibility[0] || l > job.visibility[1]) {\n                        return;\n                    }\n\n                    break;\n\n                case 4:\n                    l *= renderer.localViewExtentFactor;\n\n                    var diameter = job.visibility[0] * job.visibility[1];\n                    if (diameter < (job.visibility[2] * l) || diameter > (job.visibility[3] * l)) {\n                        return;\n                    }\n\n                    break;\n            }\n        }\n\n        if (job.type == VTS_JOB_VSPOINT) {\n            //TODO: solve switch an call render\n            var viewExtent = renderer.viewExtent;\n            var lastViewExtent = 0, vswitch = job.vswitch;\n            job.vswitchIndex = 0;\n\n            for (i = 0, li = vswitch.length; i < li; i++) {\n                if (viewExtent <= vswitch[i][0] || i == (li-1)) {\n                    job.vswitchIndex = i;\n                    var slayers = job.vswitch[i];\n\n                    if (slayers) {\n                        slayers = slayers[1];\n\n                        for (j = 0, lj = slayers.length; j < lj; j++) {\n                            var sjob = slayers[j];\n                            sjob.mv = job.mv;\n                            sjob.mvp = job.mvp;\n                            sjob.updatePos = job.updatePos;\n                            sjob.hysteresis = job.hysteresis;\n                            sjob.vswitchIndex = i;\n                            sjob.renderCounter = job.renderCounter;\n                            sjob.localTilt = localTilt;\n                            sjob.id = job.id;\n                            this.drawGpuJob(gpu, gl, renderer, sjob, screenPixelSize, advancedHitPass, ignoreFilters);\n                        }\n                    }\n\n                    return;\n                }\n            }\n\n            return;\n        }\n\n        var s = job.stick;\n        var stickShift = 0, pp, o, depth, stickMode, stickHeight;\n\n        if (s[0] != 0) {\n            stickMode = renderer.config.mapFeatureStickMode;\n            stickHeight = s[0];\n\n            if (stickMode[0]) {\n                if (!localTilt) {\n                    localTilt = job.localTilt;\n\n                    if (!localTilt) {\n                        p2 = job.center2;\n                        p1 = renderer.cameraPosition;\n                        camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n                        vec3.normalize(camVec);\n                        job.normal = [0,0,0];\n                        vec3.normalize(job.center2, job.normal);\n                            \n                        localTilt = -vec3.dot(camVec, job.normal);\n                    }\n                }\n\n                if (stickMode[0] == 2) {\n\n                    var hdelta = renderer.gridHmax - renderer.gridHmin;\n\n                    if (hdelta < 0) {\n                        hdelta = 0;\n                    }\n\n                    if (hdelta < stickHeight) {\n                        stickHeight = hdelta;\n                    }\n                }\n\n                if (localTilt < 0) {\n                    localTilt = 0;\n                }\n               \n                stickShift = Math.pow(1-localTilt,stickMode[1]) * stickHeight * renderer.cameraTiltFator;\n\n            } else {\n                stickShift = renderer.cameraTiltFator * s[0];\n            }\n                \n            if (stickShift < s[1]) {\n                stickShift = 0;\n            }\n\n            if (s[0] != 0 && s[2] != 0 && stickShift >= 4) {\n                stickShift += s[7];\n            }\n\n            //else if (s[2] != 0) {\n                pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition);\n                pp[0] = Math.round(pp[0]);\n                pp[1] -= stickShift;\n            //}\n        }\n\n        res = this.processNoOverlap(renderer, job, pp, p1, p2, camVec, l, stickShift, texture, files, color);\n\n        if (res.exit) {\n            return;\n        } else {\n            pp = res.pp;\n            p1 = res.p1;\n            p2 = res.p2;\n            camVec = res.camVec;\n            l = res.l;\n        }\n        \n        if (job.type == VTS_JOB_PACK) {\n            return;\n        }\n\n        if (renderer.drawLabelBoxes) {\n            o = job.noOverlap;\n\n            if (o) {\n                if (!pp) {\n                    pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition);\n                }\n\n                gpu.setState(hitmapRender ? renderer.lineLabelHitState : renderer.lineLabelState);\n                this.drawLineString([[pp[0]+o[0], pp[1]+o[1], 0.5], [pp[0]+o[2], pp[1]+o[1], 0.5],\n                                     [pp[0]+o[2], pp[1]+o[3], 0.5], [pp[0]+o[0], pp[1]+o[3], 0.5], [pp[0]+o[0], pp[1]+o[1], 0.5]], true, 1, [255, 0, 0, 255], null, true, null, null, null);\n\n                if (job.reduce) {\n                    if (job.reduce[0] >= 10) {\n                        this.drawText(pp[0]+o[0], pp[1]+o[3]-4*renderer.debug.debugTextSize, 4*renderer.debug.debugTextSize, ''+job.reduce[6].toFixed(3)+' '+job.reduce[1].toFixed(2)+' '+job.reduce[3].toFixed(2)+' '+job.reduce[7].toFixed(0), [1,0,0,1], 0.5);\n                    } else {\n                        this.drawText(pp[0]+o[0], pp[1]+o[3]-4*renderer.debug.debugTextSize, 4*renderer.debug.debugTextSize, ''+job.reduce[1].toFixed(0)+' '+job.reduce[5].toFixed(0), [1,0,0,1], 0.5);\n                    }\n                }\n            }\n        }\n\n        gpu.setState(hitmapRender ? renderer.lineLabelHitState : renderer.labelState);\n\n        if (s[0] != 0 && s[2] != 0) {\n            if (!pp) {\n                pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition);\n            }\n\n            this.drawLineString([[pp[0], pp[1]+stickShift+s[7], pp[2]], [pp[0], pp[1]+s[7], pp[2]]], true, s[2], [s[3], s[4], s[5], s[6]], null, null, null, null, true);\n        }\n\n        /*if (dinfo) { //debug only\n            if (!pp) {\n                pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition);\n            }\n\n            var stmp = \"\" + dinfo[0].toFixed(0) + \" \" + dinfo[1].toFixed(0) + \" \" + dinfo[2].toFixed(0) + \" \" + dinfo[3].toFixed(0) + \" \" + dinfo[4].toFixed(0);\n            this.drawText(Math.round(pp[0]-this.getTextSize(10,stmp)*0.5), Math.round(pp[1]), 10, stmp, [1,1,1,1], 0);\n        }*/\n\n        prog = job.program; //renderer.progIcon;\n\n        if (job.singleBuffer) {\n            if (!pp) {\n                pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition);\n            }\n\n            if (prog == renderer.progIcon) {\n                var b = job.singleBuffer;\n                prog = renderer.progImage;\n\n                if (!job.singleBuffer2) {\n                    job.singleBuffer2 = new Float32Array(b);\n\n                    var tx = 1 / texture.width, ty = 1 / texture.height;\n                    b[2] *= tx; b[3] *= ty;\n                    b[6] *= tx; b[7] *= ty;\n                    b[10] *= tx; b[11] *= ty;\n                    b[14] *= tx; b[15] *= ty;\n                }\n\n                if (job.updatePos) {\n                    pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition);\n                    pp[1] -= stickShift;\n                }\n\n                var b2 = job.singleBuffer2;\n\n                b[0] = pp[0] + b2[0];\n                b[1] = pp[1] + b2[1];\n\n                b[4] = pp[0] + b2[4];\n                b[5] = pp[1] + b2[5];\n\n                b[8] = pp[0] + b2[8];\n                b[9] = pp[1] + b2[9];\n\n                b[12] = pp[0] + b2[12];\n                b[13] = pp[1] + b2[13];\n\n                gpu.useProgram(prog, ['aPosition']);\n                gpu.bindTexture(texture);\n\n                var vertices = renderer.rectVerticesBuffer;\n                gl.bindBuffer(gl.ARRAY_BUFFER, vertices);\n                gl.vertexAttribPointer(prog.getAttribute('aPosition'), vertices.itemSize, gl.FLOAT, false, 0, 0);\n\n                var indices = renderer.rectIndicesBuffer;\n                gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indices);\n\n                prog.setMat4('uProjectionMatrix', renderer.imageProjectionMatrix);\n                prog.setMat4('uData', job.singleBuffer );\n                prog.setVec4('uColor', color);\n                prog.setFloat('uDepth', pp[2] * (1 + renderer.getZoffsetFactor(job.zbufferOffset) * 2));\n\n                gl.drawElements(gl.TRIANGLES, indices.numItems, gl.UNSIGNED_SHORT, 0);\n\n            } else {\n\n                var b = job.singleBuffer, bl = b.length, vbuff, vitems = (b.length / 4) * 6, color2 = job.color2, j = 0;\n\n                if (bl > 384) { vbuff = renderer.textQuads128; prog = renderer.progLabel128; } else\n                if (bl > 256) { vbuff = renderer.textQuads96; prog = renderer.progLabel96; } else\n                if (bl > 192) { vbuff = renderer.textQuads64; prog = renderer.progLabel64; } else\n                if (bl > 128) { vbuff = renderer.textQuads48; prog = renderer.progLabel48; } else\n                if (bl > 64) { vbuff = renderer.textQuads32; prog = renderer.progLabel32; }\n                else { vbuff = renderer.textQuads16; prog = renderer.progLabel16; }\n\n                if (job.updatePos) {\n                    pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition);\n                    pp[1] -= stickShift;\n                }\n\n                gpu.useProgram(prog, ['aPosition']);\n                prog.setSampler('uSampler', 0);\n                prog.setMat4('uProjectionMatrix', renderer.imageProjectionMatrix);\n\n                prog.setVec4('uScale', [screenPixelSize[0], screenPixelSize[1], 1, stickShift*2]);\n                prog.setVec3('uOrigin', [pp[0],pp[1],pp[2] * (1 + renderer.getZoffsetFactor(job.zbufferOffset) * 2)]);\n                prog.setVec4('uColor', hitmapRender ? color : color2);\n                prog.setVec2('uParams', [job.outline[0], job.gamma[1]]);\n                lj = hitmapRender ? 1 : 2;\n\n                var vertexPositionAttribute = prog.getAttribute('aPosition');\n\n                prog.setVec4('uData', b);\n\n                //bind vetex positions\n                gl.bindBuffer(gl.ARRAY_BUFFER, vbuff);\n                gl.vertexAttribPointer(vertexPositionAttribute, vbuff.itemSize, gl.FLOAT, false, 0, 0);\n\n                //draw polygons\n                for(;j<lj;j++) {\n                    if (j == 1) {\n                        prog.setVec4('uColor', color);\n                        prog.setVec2('uParams', [job.outline[1], job.gamma[0]]);\n                    }\n\n                    for (var i = 0, li = files.length; i < li; i++) {\n                        var fontFiles = files[i];\n\n                        for (var k = 0, lk = fontFiles.length; k < lk; k++) {\n                            var file = fontFiles[k];\n                            prog.setFloat('uFile', Math.round(file+i*1000));\n                            gpu.bindTexture(job.fonts[i].getTexture(file));\n                            gl.drawArrays(gl.TRIANGLES, 0, vitems);\n                        }\n                    }\n                }\n\n            }\n            \n            return;   \n        }\n\n        gpu.useProgram(prog, ['aPosition', 'aTexCoord', 'aOrigin']);\n        prog.setSampler('uSampler', 0);\n        prog.setMat4('uMVP', mvp, renderer.getZoffsetFactor(job.zbufferOffset));\n        prog.setVec4('uScale', [screenPixelSize[0], screenPixelSize[1], (job.type == VTS_JOB_LABEL ? 1.0 : 1.0 / texture.width), stickShift*2]);\n\n        var j = 0, lj = 1;\n\n        if (prog != renderer.progIcon) {\n            prog.setVec4('uColor', hitmapRender ? color : job.color2);\n            prog.setVec2('uParams', [job.outline[0], job.gamma[1]]);\n            lj = hitmapRender ? 1 : 2;\n        } else {\n            prog.setVec4('uColor', color);\n        }\n\n        vertexPositionAttribute = prog.getAttribute('aPosition');\n        vertexTexcoordAttribute = prog.getAttribute('aTexCoord');\n        vertexOriginAttribute = prog.getAttribute('aOrigin');\n\n        //bind vetex positions\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexPositionBuffer);\n        gl.vertexAttribPointer(vertexPositionAttribute, job.vertexPositionBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n        //bind vetex texcoordds\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexTexcoordBuffer);\n        gl.vertexAttribPointer(vertexTexcoordAttribute, job.vertexTexcoordBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n        //bind vetex origin\n        gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexOriginBuffer);\n        gl.vertexAttribPointer(vertexOriginAttribute, job.vertexOriginBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n        //draw polygons\n        for(;j<lj;j++) {\n            if (j == 1) {\n                prog.setVec4('uColor', color);\n                prog.setVec2('uParams', [job.outline[1], job.gamma[0]]);\n            }\n\n            if (files.length > 0) {\n                for (var i = 0, li = files.length; i < li; i++) {\n                    var fontFiles = files[i];\n\n                    for (var k = 0, lk = fontFiles.length; k < lk; k++) {\n                        var file = fontFiles[k];\n                        prog.setFloat('uFile', Math.round(file+i*1000));\n                        gpu.bindTexture(job.fonts[i].getTexture(file));\n                        gl.drawArrays(gl.TRIANGLES, 0, job.vertexPositionBuffer.numItems);\n                    }\n                }\n\n            } else {\n                gpu.bindTexture(texture);\n                gl.drawArrays(gl.TRIANGLES, 0, job.vertexPositionBuffer.numItems);\n            }\n        }\n\n        break;\n    }\n\n    return;\n};\n\nRendererDraw.prototype.drawGpuSubJob = function(gpu, gl, renderer, screenPixelSize, subjob, fade) {\n    if (!subjob) {\n        return;\n    }\n\n    var job = subjob[0], stickShift = subjob[1], texture = subjob[2],\n        files = subjob[3], color = subjob[4], pp = subjob[5], s = job.stick,\n        o = job.noOverlap, localTilt, p2, p1, camVec;\n\n    if (renderer.useSuperElevation) {\n        if (job.seCounter != renderer.seCounter) {\n            job.seCounter = renderer.seCounter;\n            job.center2 = renderer.transformPointBySE(job.center);\n        }\n    } else {\n        job.center2 = job.center;\n    }\n\n    if (job.hysteresis && job.id) {\n\n        /*\n        if (job.culling != 180) {\n            p2 = job.center2;\n            p1 = renderer.cameraPosition;\n            var camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n            vec3.normalize(camVec);\n                \n            job.normal = [0,0,0];\n            vec3.normalize(job.center2, job.normal);\n                \n            localTilt = -vec3.dot(camVec, job.normal);\n            if (localTilt < Math.cos(math.radians(job.culling))) {\n                return;\n            }\n        }\n\n        //if (o) {\n            //var x1 = pp[0]+o[0], y1 = pp[1]+o[1], \n              //  x2 = pp[0]+o[2], y2 = pp[1]+o[3]+stickShift;\n\n            /*\n            if (s[0] != 0) {\n                stickShift = renderer.cameraTiltFator * s[0];\n                    \n                if (stickShift < s[1]) {\n                    stickShift = 0;\n                }\n            }*/\n\n            /* \n            var rmap = renderer.rmap;\n\n            //screen including credits\n            if (x1 < 0 || x2 > rmap.slx || y1 < 0 || y2 > rmap.sly) {\n                return false;\n            }\n\n            //compass\n            if (x1 < rmap.clx && x2 > 0 && y1 <= rmap.sly && y2 > (rmap.sly - rmap.cly)) {\n                return false;\n            }\n\n            //serach bar\n            if (x1 < rmap.blx && x2 > 0 && y1 <= rmap.bly && y2 > 0) {\n                return false;\n            }*/\n        //}\n\n        if (s[0] != 0) {\n            var stickMode = renderer.config.mapFeatureStickMode;\n            var stickHeight = s[0];\n\n            if (stickMode[0]) {\n                if (!localTilt) {\n                    localTilt = job.localTilt;\n\n                    if (!localTilt) {\n                        p2 = job.center2;\n                        p1 = renderer.cameraPosition;\n                        camVec = [p2[0] - p1[0], p2[1] - p1[1], p2[2] - p1[2]];\n                        vec3.normalize(camVec);\n                        job.normal = [0,0,0];\n                        vec3.normalize(job.center2, job.normal);\n                            \n                        localTilt = -vec3.dot(camVec, job.normal);\n                    }\n                }\n\n                if (stickMode[0] == 2) {\n\n                    var hdelta = renderer.gridHmax - renderer.gridHmin;\n\n                    if (hdelta < 0) {\n                        hdelta = 0;\n                    }\n\n                    if (hdelta < stickHeight) {\n                        stickHeight = hdelta;\n                    }\n                }\n\n                if (localTilt < 0) {\n                    localTilt = 0;\n                }\n               \n                stickShift = Math.pow(1-localTilt,stickMode[1]) * stickHeight * renderer.cameraTiltFator;\n\n            } else {\n                stickShift = renderer.cameraTiltFator * s[0];\n            }\n              \n            if (stickShift < s[1]) {\n                stickShift = 0;\n            }\n\n            if (s[0] != 0 && s[2] != 0 && stickShift >= 4) {\n                stickShift += s[7];\n            }\n\n\n             //else if (s[2] != 0) {\n                pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition);\n                pp[0] = Math.round(pp[0]);\n                pp[1] -= stickShift;\n            //}\n\n        }\n\n    }\n\n    var hitmapRender = job.hitable && renderer.onlyHitLayers;\n\n    if (job.type == VTS_JOB_PACK) {\n        if (renderer.drawLabelBoxes && o) {\n            gpu.setState(hitmapRender ? renderer.lineLabelHitState : renderer.lineLabelState);\n            this.drawLineString([[pp[0]+o[0], pp[1]+o[1], 0.5], [pp[0]+o[2], pp[1]+o[1], 0.5],\n                                 [pp[0]+o[2], pp[1]+o[3], 0.5], [pp[0]+o[0], pp[1]+o[3], 0.5], [pp[0]+o[0], pp[1]+o[1], 0.5]], true, 1, [255, 0, 0, 255], null, true, null, null, null);\n\n            if (job.reduce) {\n                if (job.reduce[0] >= 10) {\n                    this.drawText(pp[0]+o[0], pp[1]+o[3]-4*renderer.debug.debugTextSize, 4*renderer.debug.debugTextSize, ''+job.reduce[6].toFixed(3)+' '+job.reduce[1].toFixed(2)+' '+job.reduce[3].toFixed(2)+' '+job.reduce[7].toFixed(0), [1,0,0,1], 0.5);\n                } else {\n                    this.drawText(pp[0]+o[0], pp[1]+o[3]-4*renderer.debug.debugTextSize, 4*renderer.debug.debugTextSize, ''+job.reduce[1].toFixed(0)+' '+job.reduce[5].toFixed(0), [1,0,0,1], 0.5);\n                }\n            }\n        }\n\n        gpu.setState(hitmapRender ? renderer.lineLabelHitState : renderer.labelState);\n\n        if (s[0] != 0 && s[2] != 0 && stickShift >= 4) {\n            this.drawLineString([[pp[0], pp[1]+stickShift+s[7], pp[2]], [pp[0], pp[1]+s[7], pp[2]]], true, s[2], [s[3], s[4], s[5], ((fade !== null) ? s[6] * fade : s[6]) ], null, null, null, null, true);\n            //stickShift += s[7];\n        }\n\n        for (var i = 0, li = job.subjobs.length; i < li; i++) {\n            var subjob2 = job.subjobs[i], job2;\n            subjob2.mvp = job.mvp;\n            subjob2.updatePos = job.updatePos;\n\n            var depth = subjob[7];\n\n            o = null;\n            files = subjob2.files;\n\n            if (hitmapRender) {\n                color = subjob[4];\n                texture = renderer.whiteTexture;\n            } else {\n                color = subjob2.color;\n                texture = subjob2.texture;\n            }\n\n            this.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, [subjob2, stickShift, texture, files, color, pp, true, depth, o], fade);\n        }\n\n        return;\n    }\n\n\n    if (renderer.drawLabelBoxes && o) {\n        gpu.setState(hitmapRender ? renderer.lineLabelHitState : renderer.lineLabelState);\n        this.drawLineString([[pp[0]+o[0], pp[1]+o[1], 0.5], [pp[0]+o[2], pp[1]+o[1], 0.5],\n                             [pp[0]+o[2], pp[1]+o[3], 0.5], [pp[0]+o[0], pp[1]+o[3], 0.5], [pp[0]+o[0], pp[1]+o[1], 0.5]], true, 1, [255, 0, 0, 255], null, true, null, null, null);\n\n        if (job.reduce) {\n            if (job.reduce[0] >= 10) {\n                this.drawText(pp[0]+o[0], pp[1]+o[3]-4*renderer.debug.debugTextSize, 4*renderer.debug.debugTextSize, ''+job.reduce[6].toFixed(3)+' '+job.reduce[1].toFixed(2)+' '+job.reduce[3].toFixed(2)+' '+job.reduce[7].toFixed(0), [1,0,0,1], 0.5);\n                //this.drawText(pp[0]+o[0], pp[1]+o[3]-4*renderer.debug.debugTextSize, 4*renderer.debug.debugTextSize, ''+job.reduce[6].toFixed(3)+' '+job.reduce[1].toFixed(2)+' '+job.reduce[3].toFixed(2)+' '+job.fade, [1,0,0,1], 0.5);\n            } else {\n                this.drawText(pp[0]+o[0], pp[1]+o[3]-4*renderer.debug.debugTextSize, 4*renderer.debug.debugTextSize, ''+job.reduce[1].toFixed(0)+' '+job.reduce[5].toFixed(0), [1,0,0,1], 0.5);\n            }\n        }\n    }\n\n    gpu.setState(hitmapRender ? renderer.lineLabelHitState : renderer.labelState);\n\n    var j = 0, lj = 1, color2 = job.color2;\n\n    if (fade !== null) {\n        color = [color[0], color[1], color[2], color[3] * fade];\n\n        if (color2) {\n            color2 = [color2[0], color2[1], color2[2], color2[3] * fade];\n        }\n    }\n\n    if (s[0] != 0 && s[2] != 0 && stickShift >= 4) {\n        this.drawLineString([[pp[0], pp[1]+stickShift+s[7], pp[2]], [pp[0], pp[1]+s[7], pp[2]]], true, s[2], [s[3], s[4], s[5], ((fade !== null) ? s[6] * fade : s[6]) ], null, null, null, null, true);\n    }\n\n    var prog = job.program; //renderer.progIcon;\n\n    if (job.singleBuffer) {\n\n        if (prog == renderer.progIcon) {\n            var b = job.singleBuffer;\n            prog = renderer.progImage;\n\n            if (!job.singleBuffer2) {\n                job.singleBuffer2 = new Float32Array(b);\n\n                var tx = 1 / texture.width, ty = 1 / texture.height;\n                b[2] *= tx; b[3] *= ty;\n                b[6] *= tx; b[7] *= ty;\n                b[10] *= tx; b[11] *= ty;\n                b[14] *= tx; b[15] *= ty;\n            }\n\n            if (job.updatePos) {\n                pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition);\n                pp[1] -= stickShift;\n            }\n\n            var b2 = job.singleBuffer2;\n\n            b[0] = pp[0] + b2[0];\n            b[1] = pp[1] + b2[1];\n\n            b[4] = pp[0] + b2[4];\n            b[5] = pp[1] + b2[5];\n\n            b[8] = pp[0] + b2[8];\n            b[9] = pp[1] + b2[9];\n\n            b[12] = pp[0] + b2[12];\n            b[13] = pp[1] + b2[13];\n\n            gpu.useProgram(prog, ['aPosition']);\n            gpu.bindTexture(texture);\n\n            var vertices = renderer.rectVerticesBuffer;\n            gl.bindBuffer(gl.ARRAY_BUFFER, vertices);\n            gl.vertexAttribPointer(prog.getAttribute('aPosition'), vertices.itemSize, gl.FLOAT, false, 0, 0);\n\n            var indices = renderer.rectIndicesBuffer;\n            gl.bindBuffer(gl.ELEMENT_ARRAY_BUFFER, indices);\n\n            prog.setMat4('uProjectionMatrix', renderer.imageProjectionMatrix);\n            prog.setMat4('uData', job.singleBuffer );\n            prog.setVec4('uColor', color);\n            prog.setFloat('uDepth', pp[2] * (1 + renderer.getZoffsetFactor(job.zbufferOffset) * 2));\n\n            gl.drawElements(gl.TRIANGLES, indices.numItems, gl.UNSIGNED_SHORT, 0);\n\n        } else {\n\n            var b = job.singleBuffer, bl = b.length, vbuff, vitems = (b.length / 4) * 6;\n\n            if (bl > 384) { vbuff = renderer.textQuads128; prog = renderer.progLabel128; } else\n            if (bl > 256) { vbuff = renderer.textQuads96; prog = renderer.progLabel96; } else\n            if (bl > 192) { vbuff = renderer.textQuads64; prog = renderer.progLabel64; } else\n            if (bl > 128) { vbuff = renderer.textQuads48; prog = renderer.progLabel48; } else\n            if (bl > 64) { vbuff = renderer.textQuads32; prog = renderer.progLabel32; }\n            else { vbuff = renderer.textQuads16; prog = renderer.progLabel16; }\n\n            if (job.updatePos) {\n                pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition);\n                pp[1] -= stickShift;\n            }\n\n            gpu.useProgram(prog, ['aPosition']);\n            prog.setSampler('uSampler', 0);\n            prog.setMat4('uProjectionMatrix', renderer.imageProjectionMatrix);\n\n            prog.setVec4('uScale', [screenPixelSize[0], screenPixelSize[1], 1, stickShift*2]);\n            prog.setVec3('uOrigin', [pp[0],pp[1],pp[2] * (1 + renderer.getZoffsetFactor(job.zbufferOffset) * 2)]);\n            prog.setVec4('uColor', hitmapRender ? color : color2);\n            prog.setVec2('uParams', [job.outline[0], job.gamma[1]]);\n            lj = hitmapRender ? 1 : 2;\n\n            var vertexPositionAttribute = prog.getAttribute('aPosition');\n\n            prog.setVec4('uData', b);\n\n            //bind vetex positions\n            gl.bindBuffer(gl.ARRAY_BUFFER, vbuff);\n            gl.vertexAttribPointer(vertexPositionAttribute, vbuff.itemSize, gl.FLOAT, false, 0, 0);\n\n            //draw polygons\n            for(;j<lj;j++) {\n                if (j == 1) {\n                    prog.setVec4('uColor', color);\n                    prog.setVec2('uParams', [job.outline[1], job.gamma[0]]);\n                }\n\n                for (var i = 0, li = files.length; i < li; i++) {\n                    var fontFiles = files[i];\n\n                    for (var k = 0, lk = fontFiles.length; k < lk; k++) {\n                        var file = fontFiles[k];\n                        prog.setFloat('uFile', Math.round(file+i*1000));\n                        gpu.bindTexture(job.fonts[i].getTexture(file));\n                        gl.drawArrays(gl.TRIANGLES, 0, vitems);\n                    }\n                }\n            }\n\n        }\n        \n        return;   \n    }\n\n    gpu.useProgram(prog, ['aPosition', 'aTexCoord', 'aOrigin']);\n    prog.setSampler('uSampler', 0);\n    prog.setMat4('uMVP', job.mvp, renderer.getZoffsetFactor(job.zbufferOffset));\n    prog.setVec4('uScale', [screenPixelSize[0], screenPixelSize[1], (job.type == VTS_JOB_LABEL ? 1.0 : 1.0 / texture.width), stickShift*2]);\n\n    if (prog != renderer.progIcon) {\n        prog.setVec4('uColor', hitmapRender ? color : color2);\n        prog.setVec2('uParams', [job.outline[0], job.gamma[1]]);\n        lj = hitmapRender ? 1 : 2;\n    } else {\n        prog.setVec4('uColor', color);\n    }\n\n    var vertexPositionAttribute = prog.getAttribute('aPosition');\n    var vertexTexcoordAttribute = prog.getAttribute('aTexCoord');\n    var vertexOriginAttribute = prog.getAttribute('aOrigin');\n\n    //bind vetex positions\n    gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexPositionBuffer);\n    gl.vertexAttribPointer(vertexPositionAttribute, job.vertexPositionBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n    //bind vetex texcoordds\n    gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexTexcoordBuffer);\n    gl.vertexAttribPointer(vertexTexcoordAttribute, job.vertexTexcoordBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n    //bind vetex origin\n    gl.bindBuffer(gl.ARRAY_BUFFER, job.vertexOriginBuffer);\n    gl.vertexAttribPointer(vertexOriginAttribute, job.vertexOriginBuffer.itemSize, gl.FLOAT, false, 0, 0);\n\n    //draw polygons\n    for(;j<lj;j++) {\n        if (j == 1) {\n            prog.setVec4('uColor', color);\n            prog.setVec2('uParams', [job.outline[1], job.gamma[0]]);\n        }\n\n        if (files.length > 0) {\n            for (var i = 0, li = files.length; i < li; i++) {\n                var fontFiles = files[i];\n\n                for (var k = 0, lk = fontFiles.length; k < lk; k++) {\n                    var file = fontFiles[k];\n                    prog.setFloat('uFile', Math.round(file+i*1000));\n                    gpu.bindTexture(job.fonts[i].getTexture(file));\n                    gl.drawArrays(gl.TRIANGLES, 0, job.vertexPositionBuffer.numItems);\n                }\n            }\n\n        } else {\n            gpu.bindTexture(texture);\n            gl.drawArrays(gl.TRIANGLES, 0, job.vertexPositionBuffer.numItems);\n        }\n    }\n};\n\n\nfunction q4Slerp(a, b, t, out) {\n  // benchmarks:\n  //    http://jsperf.com/quaternion-slerp-implementations\n  var ax = a[0], ay = a[1], az = a[2], aw = a[3];\n  var bx = b[0], by = b[1], bz = b[2], bw = b[3];\n\n  var omega, cosom, sinom, scale0, scale1;\n\n  // calc cosine\n  cosom = ax * bx + ay * by + az * bz + aw * bw;\n  // adjust signs (if necessary)\n  if ( cosom < 0.0 ) {\n    cosom = -cosom;\n    bx = - bx;\n    by = - by;\n    bz = - bz;\n    bw = - bw;\n  }\n  // calculate coefficients\n  if ( (1.0 - cosom) > 0.000001) {\n    // standard case (slerp)\n    omega  = Math.acos(cosom);\n    sinom  = Math.sin(omega);\n    scale0 = Math.sin((1.0 - t) * omega) / sinom;\n    scale1 = Math.sin(t * omega) / sinom;\n  } else {\n    // \"from\" and \"to\" quaternions are very close\n    //  ... so we can do a linear interpolation\n    scale0 = 1.0 - t;\n    scale1 = t;\n  }\n  // calculate final values\n  out[0] = scale0 * ax + scale1 * bx;\n  out[1] = scale0 * ay + scale1 * by;\n  out[2] = scale0 * az + scale1 * bz;\n  out[3] = scale0 * aw + scale1 * bw;\n\n  return out;\n}\n\nRendererDraw.prototype.drawGpuSubJobLineLabel = function(gpu, gl, renderer, screenPixelSize, subjob, fade) {\n    if (!subjob) {\n        return;\n    }\n\n    var job = subjob[0], texture = subjob[2],\n        files = subjob[3], color = subjob[4], pp = subjob[5],\n        o = job.noOverlap, localTilt, p2, p1, camVec, prog,\n        useSE = renderer.useSuperElevation;\n\n    if (useSE) {\n        if (job.seCounter != renderer.seCounter) {\n            job.seCounter = renderer.seCounter;\n            job.labelPointsBuffer.id = -1;\n            job.center2 = renderer.transformPointBySE(job.center);\n        }\n    } else {\n        job.center2 = job.center;\n    }\n\n    var hitmapRender = job.hitable && renderer.onlyHitLayers, j, lj, p, p2;\n\n    var gamma = job.outline[2] * 1.4142 / 20;\n    var gamma2 = job.outline[3] * 1.4142 / 20;\n\n    if (job.singleBuffer) {\n\n        gpu.setState(hitmapRender ? renderer.lineLabelHitState : renderer.lineLabelState);\n\n        //if (job.labelPoints.length < 1) return;\n\n        pp = subjob[5];\n\n        if (!pp || job.updatePos) {\n            pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition, true);                    \n        }\n\n        var targetSize = job.labelSize * 0.5; \n        var sizeFactor = renderer.camera.scaleFactor2(pp[3])*0.5*renderer.curSize[1]*(renderer.curSize[0]/renderer.curSize[1]);\n        var labelPoints = job.labelPoints;\n        var labelIndex = job.labelIndex;\n        var labelMorph = 0;\n\n        lj = labelPoints.length;\n\n        if (lj <= 1 || labelPoints[lj -1][0]*sizeFactor < targetSize) {\n            return;\n        }\n\n        lj--;\n\n        for (j = 0; j < lj; j++) {\n            var s2 = labelPoints[j+1][0] * sizeFactor;\n\n            if (s2 > targetSize) {\n                var s1 = labelPoints[j][0] * sizeFactor;\n\n                labelIndex = j;\n                labelMorph = (targetSize - s1) / (s2 - s1);\n                break;                \n            }\n        }\n\n        var pointsIndex = (vec3.dot(labelPoints[labelIndex][1], renderer.labelVector) >= 0) ? 3 : 2;\n\n        var b = (pointsIndex == 3) ? job.singleBuffer2 : job.singleBuffer, bl = b.length, vbuff, vitems = (b.length / 4) * 6;\n\n        var points = labelPoints[labelIndex][pointsIndex], index = 0;\n        var points2 = (labelPoints[labelIndex+1]) ? labelPoints[labelIndex+1][pointsIndex] : points;\n        var q = [0,0,0,0], buffer;\n\n        if (useSE) {\n            buffer = job.labelPointsBuffer;\n\n            if (buffer.id != (labelIndex * 1024 + pointsIndex)) {\n                buffer.id = (labelIndex * 1024 + pointsIndex);\n                if (buffer.points.length != points.length) {\n                    buffer.points = new Array(points.length);\n                    buffer.points2 = new Array(points.length);\n                }\n\n                var sePoints = buffer.points;\n                var sePoints2 = buffer.points2;\n\n                for(j = 0, lj = points.length; j < lj; j++) {\n                    sePoints[j] = renderer.transformPointBySE2(points[j]);\n                    sePoints2[j] = renderer.transformPointBySE2(points2[j]);\n                }\n\n                points = sePoints;\n                points2 = sePoints2;\n\n            } else {\n                points = buffer.points;\n                points2 = buffer.points2;\n            }\n        }\n\n        for(j = 0, lj = points.length; j < lj; j++) {\n            p = points[j];\n            p2 = points2[j];\n\n            if (useSE) {\n                b[index] = (p[4]+p[13]) + ((p2[4]+p2[13]) - (p[4]+p[13])) * labelMorph;\n                b[index+1] = (p[5]+p[14]) + ((p2[5]+p2[14]) - (p[5]+p[14])) * labelMorph;\n                b[index+2] = (p[6]+p[15]) + ((p2[6]+p2[15]) - (p[6]+p[15])) * labelMorph;\n            } else {\n                b[index] = p[4] + (p2[4] - p[4]) * labelMorph;\n                b[index+1] = p[5] + (p2[5] - p[5]) * labelMorph;\n                b[index+2] = p[6] + (p2[6] - p[6]) * labelMorph;\n            }\n\n            q4Slerp([p[7],p[8],p[9],p[10]], [p2[7],p2[8],p2[9],p2[10]], labelMorph, q);\n\n            b[index+3] = q[0];\n            b[index+4] = q[1];\n            b[index+5] = q[2];\n            b[index+6] = q[3];\n\n            b[index+7] = p[11] + (p2[11] - p[11]) * labelMorph;\n            b[index+8] = p[12] + (p2[12] - p[12]) * labelMorph;\n\n            index += 12;\n        }\n\n        if (bl > 384) { vbuff = renderer.textQuads128; prog = renderer.progLineLabel128; } else\n        if (bl > 256) { vbuff = renderer.textQuads96; prog = renderer.progLineLabel96; } else\n        if (bl > 192) { vbuff = renderer.textQuads64; prog = renderer.progLineLabel64; } else\n        if (bl > 128) { vbuff = renderer.textQuads48; prog = renderer.progLineLabel48; } else\n        if (bl > 64) { vbuff = renderer.textQuads32; prog = renderer.progLineLabel32; }\n        else { vbuff = renderer.textQuads16; prog = renderer.progLineLabel16; }\n\n        var color2 = job.color2;\n\n        if (fade !== null) {\n            color = [color[0], color[1], color[2], color[3] * fade];\n\n            if (color2) {\n                color2 = [color2[0], color2[1], color2[2], color2[3] * fade];\n            }\n        }\n\n        gpu.useProgram(prog, ['aPosition']);\n        prog.setSampler('uSampler', 0);\n        prog.setMat4('uMVP', job.mvp, renderer.getZoffsetFactor(job.zbufferOffset));\n\n        prog.setVec4('uColor', hitmapRender ? color : color2);\n        prog.setVec2('uParams', [job.outline[0], gamma2]);\n        var lj = hitmapRender ? 1 : 2;\n\n        var vertexPositionAttribute = prog.getAttribute('aPosition');\n\n        prog.setVec4('uData', b);\n\n        //bind vetex positions\n        gl.bindBuffer(gl.ARRAY_BUFFER, vbuff);\n        gl.vertexAttribPointer(vertexPositionAttribute, vbuff.itemSize, gl.FLOAT, false, 0, 0);\n\n        //draw polygons\n        for(j = 0, lj = (hitmapRender ? 1 : 2); j < lj; j++) {\n            if (j == 1) {\n                prog.setVec4('uColor', color);\n                prog.setVec2('uParams', [job.outline[1], gamma]);\n            }\n\n            for (var i = 0, li = files.length; i < li; i++) {\n                var fontFiles = files[i];\n\n                for (var k = 0, lk = fontFiles.length; k < lk; k++) {\n                    var file = fontFiles[k];\n                    prog.setFloat('uFile', Math.round(file+i*1000));\n                    gpu.bindTexture(job.fonts[i].getTexture(file));\n                    gl.drawArrays(gl.TRIANGLES, 0, vitems / 3); //TODO: demystify vitems\n                }\n            }\n        }\n\n        if (renderer.drawLabelBoxes) {\n            var margin = o ? o[0] : 1, pp = [0,0,0], r;\n\n            for(j = 0, lj = points.length; j < lj; j++) {\n                p = points[j];\n                p2 = points2[j];\n\n                pp[0] = p[0] + (p2[0] - p[0]) * labelMorph;\n                pp[1] = p[1] + (p2[1] - p[1]) * labelMorph;\n                pp[2] = p[2] + (p2[2] - p[2]) * labelMorph;\n                r = p[3] + (p2[3] - p[3]) * labelMorph;\n\n                pp = renderer.project2(pp, renderer.camera.mvp, renderer.cameraPosition, true);                    \n                this.drawCircle(pp, r*sizeFactor*margin, 1, [255, 0, 255, 255], null, null, null, null, null);\n            }\n\n            pp = subjob[5];\n\n            if (!pp) {\n                pp = renderer.project2(job.center2, renderer.camera.mvp, renderer.cameraPosition, true);                    \n            }\n\n            this.drawCircle(pp, 8, 1, [255, 255, 0, 255], null, null, null, null, null);\n\n            if (job.reduce) {\n                if (job.reduce[0] >= 10) {\n                    this.drawText(pp[0], pp[1]-4*renderer.debug.debugTextSize, 4*renderer.debug.debugTextSize, ''+job.reduce[6].toFixed(3)+' '+job.reduce[1].toFixed(2)+' '+job.reduce[3].toFixed(2)+' '+job.reduce[7].toFixed(0), [1,0,0,1], 0.5);\n                } else {\n                    this.drawText(pp[0], pp[1]-4*renderer.debug.debugTextSize, 4*renderer.debug.debugTextSize, ''+job.reduce[1].toFixed(0)+' '+job.reduce[5].toFixed(0), [1,0,0,1], 0.5);\n                }\n            }\n        }\n\n        return;\n    }\n\n};\n\nexport default RendererDraw;\n","\nimport {vec3 as vec3_} from '../utils/matrix';\n\n//get rid of compiler mess\nvar vec3 = vec3_;\n\n\nvar RendererRMap = function(renderer, blockSize, maxBlockRectangles) {\n    this.renderer = renderer;\n    this.drawAllLabels = false;\n    this.maxBlockRectangles = maxBlockRectangles || 500;\n    this.blockSize = blockSize;\n    this.blockSizeFactor = 1/blockSize;\n    this.blocks = [];\n    this.blocks2 = [];\n    this.blocksRCount = [];\n    this.blocks2RCount = [];\n    this.allocatedBlocks = 0;\n    this.lx = 1;\n    this.ly = 1;\n    this.counter = 0;\n    this.rectangles = null;\n    this.rectanglesCount = 0;\n    this.rectangles2 = null;\n    this.rectangles2Count = 0;\n    this.rectanglesR = null;\n    this.rectanglesRCount = 0;\n    this.benevolentMargins = false;\n    this.positionsBuffer = new Float64Array(256*4);\n};\n\n\nRendererRMap.prototype.clear = function() {\n    var renderer = this.renderer;\n\n    this.sx2 = renderer.curSize[0];\n    this.sy2 = renderer.curSize[1];\n\n    //reduce by credits\n    this.sy2 = Math.max(1, this.sy2 - 55);\n    this.sy1 = 1;\n    this.sx1 = 1;\n\n    //compass size\n    this.cx2 = 135;\n    this.cy1 = renderer.curSize[1] - 145;\n\n    //search bar size\n    this.bx2 = 245;\n    this.by2 = 45;\n\n    this.lx = Math.floor(renderer.curSize[0] * this.blockSizeFactor) + 1;\n    this.ly = Math.floor(renderer.curSize[1] * this.blockSizeFactor) + 1;\n\n    if (renderer.marginFlags & 4096) {\n        this.sx1 = Math.min(34, this.sx2);\n        this.sx2 = Math.max(1, renderer.curSize[0] - 34);\n        this.sy1 = Math.min(50, this.sy2);\n        this.sy2 = Math.max(1, renderer.curSize[1] - 68);\n    }\n\n    var totalNeeded = this.ly * this.lx;\n    \n    if (!this.rectangles) {\n        this.rectangles = new Array(totalNeeded * this.maxBlockRectangles * 6); //preallocate empty rectangles\n    }\n\n    if (!this.rectangles2) {\n        this.rectangles2 = new Array(totalNeeded * this.maxBlockRectangles * 6); //preallocate empty rectangles\n    }\n\n    if (!this.rectanglesR) {\n        this.rectanglesR = new Array(totalNeeded * this.maxBlockRectangles * 6); //preallocate empty rectangles\n    }\n\n    if (this.rectanglesCount > 0 || this.allocatedBlocks != totalNeeded) {\n\n        for (var i = 0; i < totalNeeded; i++) { //check if all rectangles are preallocated and reset coutner\n            if (!this.blocks[i]) {\n                this.blocks[i] = [];\n            }\n\n            this.blocksRCount[i] = 0;\n        }\n    }\n\n    if (this.rectangles2Count > 0 || this.allocatedBlocks != totalNeeded) {\n\n        for (var i = 0; i < totalNeeded; i++) { //check if all rectangles are preallocated and reset coutner\n            if (!this.blocks2[i]) {\n                this.blocks2[i] = [];\n            }\n\n            this.blocks2RCount[i] = 0;\n        }\n    }\n\n    this.allocatedBlocks = totalNeeded;\n    this.drawAllLabels = renderer.debug.drawAllLabels;\n    this.benevolentMargins = renderer.benevolentMargins;\n\n    this.rectanglesCount = 0;\n    this.rectangles2Count = 0;\n    this.rectanglesRCount = 0;\n    this.counter = renderer.geoRenderCounter;\n};\n\n\nRendererRMap.prototype.storeRemovedRectangle = function(x1, y1, x2, y2, z, subjob) {\n    var rectangles2 = this.rectanglesR;\n    var rectangles2Count = this.rectanglesRCount;\n\n    rectangles2[rectangles2Count] = x1;\n    rectangles2[rectangles2Count+1] = y1;\n    rectangles2[rectangles2Count+2] = x2;\n    rectangles2[rectangles2Count+3] = y2;\n    rectangles2[rectangles2Count+4] = z;\n    rectangles2[rectangles2Count+5] = subjob;\n    this.rectanglesRCount += 6;\n};\n\n\n//aabbox circle\n//http://www.firenibbler.com/2016/04/27/how-to-js-collision-detection-cheat-sheets-learn-aabb-box-circle-and-point-detection/\nRendererRMap.prototype.circleAABBoxCollide = function(x1, y1, x2, y2, cx, cy, cr){\n    // Get the distance between the two objects\n    var hwidth = (x2 - x1) * 0.5;\n    var hheight = (y2 - y1) * 0.5;\n    var distX = Math.abs(cx - x1 - hwidth);\n    var distY = Math.abs(cy - y2 - hheight);\n\n    // Check to make sure it is definitely not overlapping\n    if (distX > (hwidth + cr) || distY > (hheight + cr)) {\n        return false;\n    }\n    // Check to see if it is definitely overlapping\n    if (distX <= hwidth || distY <= hheight) {\n        return true;\n    }\n\n    // Last Resort to see if they are overlapping\n    var dx = distX - hwidth;\n    var dy = distY - hheight;\n    return (dx * dx + dy * dy <= (cr * cr));\n};\n\n\n//aabbox line\n//https://gamedev.stackexchange.com/questions/18436/most-efficient-aabb-vs-ray-collision-algorithms\nRendererRMap.prototype.lineAABBoxCollide = function(x1, y1, x2, y2, rx1, ry1, rx2, ry2) {\n    var dx = 1 / ( (rx2 != rx1) ? (rx2 - rx1) : 0.00001);\n    var tx1 = (x1 - rx1)*dx;\n    var tx2 = (x2 - rx1)*dx;\n\n    var tmin = Math.min(tx1, tx2);\n    var tmax = Math.max(tx1, tx2);\n\n    var dy = 1 / ( (ry2 != ry1) ? (ry2 - ry1) : 0.00001);\n    var ty1 = (y1 - ry1)*dy;\n    var ty2 = (y2 - ry1)*dy;\n\n    tmin = Math.max(tmin, Math.min(ty1, ty2));\n    tmax = Math.min(tmax, Math.max(ty1, ty2));\n\n    return tmax >= tmin;\n};\n\n\nRendererRMap.prototype.checkRectangle = function(x1, y1, x2, y2, y3) {\n    var t;\n\n    if (x1 > x2) { t = x1; x1 = x2; x2 = t; }\n    if (y1 > y2) { t = y1; y1 = y2; y2 = t; }\n\n    y3 += y2;\n\n    if (this.benevolentMargins) {\n        //screen including credits\n        return !(x2 < this.sx1 || x1 > this.sx2 || y3 < this.sy1 || y1 > this.sy2);\n    }\n    \n    //screen including credits\n    if (x1 < this.sx1 || x2 > this.sx2 || y1 < this.sy1 || y3 > this.sy2) {\n        return false;\n    }\n\n    //compass\n    if ((this.renderer.marginFlags & 1) && x1 < this.cx2 && x2 > 0 && y1 <= this.sx2 && y3 > this.cy1) {\n        return false;\n    }\n\n    //search bar\n    if ((this.renderer.marginFlags & 2) && x1 < this.bx2 && x2 > 0 && y1 <= this.by2 && y3 > 0) {\n        return false;\n    }\n\n    return true;\n}\n\nRendererRMap.prototype.addRectangle = function(x1, y1, x2, y2, z, subjob, any, checkDepthMap) {\n    var x, y, i, index, blockRectangles, blockRectanglesCount,\n        rectangleIndex, t, renderer = this.renderer;\n\n    if (this.drawAllLabels) {\n        return true;\n    }\n\n    if (x1 > x2) { t = x1; x1 = x2; x2 = t; }\n    if (y1 > y2) { t = y1; y1 = y2; y2 = t; }\n\n    var y3 = y2 + subjob[1]; //add stick shift\n\n    if (this.benevolentMargins) {\n        //screen including credits\n        if (x2 < this.sx1 || x1 > this.sx2 || y3 < this.sy1 || y1 > this.sy2) {\n            return false;\n        }\n    } else {\n        //screen including credits\n        if (x1 < this.sx1 || x2 > this.sx2 || y1 < this.sy1 || y3 > this.sy2) {\n            return false;\n        }\n\n        //compass\n        if ((renderer.marginFlags & 1) && x1 < this.cx2 && x2 > 0 && y1 <= this.sx2 && y3 > this.cy1) {\n            return false;\n        }\n\n        //search bar\n        if ((renderer.marginFlags & 2) && x1 < this.bx2 && x2 > 0 && y1 <= this.by2 && y3 > 0) {\n            return false;\n        }\n    }\n\n    var xx1 = Math.floor(x1 * this.blockSizeFactor);\n    var yy1 = Math.floor(y1 * this.blockSizeFactor);\n    var xx2 = Math.floor(x2 * this.blockSizeFactor);\n    var yy2 = Math.floor(y2 * this.blockSizeFactor);\n\n    if (xx2 < 0 || yy2 < 0 || xx1 >= this.lx || yy1 >= this.ly) {\n        return false;\n    }\n\n    if (xx1 < 0) xx1 = 0;\n    if (xx2 >= this.lx) xx2 = this.lx - 1;\n\n    if (yy1 < 0) yy1 = 0;\n    if (yy2 >= this.ly) yy2 = this.ly - 1;\n\n    var lx = (xx2 - xx1) + 1;\n    var ly = (yy2 - yy1) + 1;\n    var removeList = {};\n    var exit = false;\n\n    var top = renderer.config.mapFeaturesSortByTop,\n        rectangles = this.rectangles, rectangles2 = this.rectangles2;\n\n    //test collision\n    for (y = 0; y < ly; y++) {\n        for (x = 0; x < lx; x++) {\n            index = (yy1 + y)*this.lx + (xx1 + x);\n\n            blockRectangles = this.blocks[index];\n            blockRectanglesCount = this.blocksRCount[index];\n\n            //test rectangles\n            for (i = 0; i < blockRectanglesCount; i++) {\n                rectangleIndex = blockRectangles[i];\n\n                if (x1 < rectangles[rectangleIndex + 2] && x2 > rectangles[rectangleIndex + 0] &&\n                    y1 < rectangles[rectangleIndex + 3] && y2 > rectangles[rectangleIndex + 1]) {\n\n                    if (any) {\n                        return false;\n                    }\n\n                    if (top) {\n                        if (z < rectangles[rectangleIndex + 4]) {\n                            return false;\n                        }\n                    } else {\n                        if (z > rectangles[rectangleIndex + 4]) {\n                            return false;\n                        }\n                    }\n\n                    removeList[rectangleIndex] = true;\n                }\n            }\n\n            if ((blockRectanglesCount + 1) >= this.maxBlockRectangles) {\n                return false;\n            }\n\n            blockRectangles = this.blocks2[index];\n            blockRectanglesCount = this.blocks2RCount[index];\n\n            //test circles\n            for (i = 0; i < blockRectanglesCount; i++) {\n                rectangleIndex = blockRectangles[i];\n\n//                if (this.circleAABBoxCollide(rectangles2[rectangleIndex + 0], rectangles2[rectangleIndex + 1], rectangles[rectangleIndex + 2], rectangles[rectangleIndex + 3], x, y, r)) {\n                if (this.circleAABBoxCollide(x1, y1, x2, y2, rectangles2[rectangleIndex + 0], rectangles2[rectangleIndex + 1], rectangles[rectangleIndex + 3])) {\n\n                 //   if (any) {\n                        return false;\n                  //  }                    \n                }\n            }\n\n\n        }\n    }\n\n    //remove rectangles\n    for (var key in removeList) {\n        this.removeRectangle(parseInt(key));\n    }\n\n    if (checkDepthMap) {\n\n        var reduce = checkDepthMap[2];\n        var depth = renderer.mapHack.getScreenDepth(checkDepthMap[0], checkDepthMap[1], (reduce[4] > 10000000));\n\n        if (depth[0]) {\n            var delta = depth[1] - reduce[4];\n            reduce[7] = delta;\n\n            if (!renderer.drawHiddenLabels && delta < checkDepthMap[3]) {\n                return false;\n            }\n        }\n    }\n\n    //there is no collision so we can store rectangle\n    rectangleIndex = this.rectanglesCount;\n    rectangles[rectangleIndex] = x1;\n    rectangles[rectangleIndex+1] = y1;\n    rectangles[rectangleIndex+2] = x2;\n    rectangles[rectangleIndex+3] = y2;\n    rectangles[rectangleIndex+4] = z;\n    rectangles[rectangleIndex+5] = subjob;\n    this.rectanglesCount += 6;\n\n    for (y = 0; y < ly; y++) {\n        for (x = 0; x < lx; x++) {\n            index = (yy1 + y)*this.lx + (xx1 + x);\n            this.blocks[index][this.blocksRCount[index]] = rectangleIndex;\n            this.blocksRCount[index]++;\n        }\n    }\n\n    return true;\n};\n\n\nRendererRMap.prototype.addLineLabel = function(subjob, checkDepthMap) {\n    var job = subjob[0], blockRectangles, blockRectanglesCount, rectangleIndex;\n    var x1 = Number.POSITIVE_INFINITY, x2 = Number.NEGATIVE_INFINITY,\n        y1 = Number.POSITIVE_INFINITY, y2 = Number.NEGATIVE_INFINITY;\n    var x, y, r, rr = 0, xx, yy, renderer = this.renderer, i, li, pp = [0,0,0,0];\n    var pbuff = this.positionsBuffer;\n    var index = 0, pindex = 0;\n    var margin = job.noOverlap ? job.noOverlap[0] : 1;\n\n    var targetSize = job.labelSize * 0.5; \n    var sizeFactor = renderer.camera.scaleFactor2(subjob[5][3])*0.5*renderer.curSize[1]*(renderer.curSize[0]/renderer.curSize[1]);\n    var pointsIndex = subjob[9];\n    var labelPoints = job.labelPoints;\n    var labelIndex = job.labelIndex;\n    var labelMorph = 0;\n\n    li = labelPoints.length;\n\n    if (li <= 1 || labelPoints[li -1][0]*sizeFactor < targetSize) {\n        return;\n    }\n\n    li--;\n\n    for (i = 0; i < li; i++) {\n        var s2 = labelPoints[i+1][0] * sizeFactor;\n\n        if (s2 > targetSize) {\n            var s1 = labelPoints[i][0] * sizeFactor;\n\n            labelIndex = i;\n            labelMorph = (targetSize - s1) / (s2 - s1);\n            break;                \n        }\n    }\n\n    var pointsIndex = (vec3.dot(labelPoints[labelIndex][1], renderer.labelVector) >= 0) ? 3 : 2;\n    var points = labelPoints[labelIndex][pointsIndex];\n    var points2 = (labelPoints[labelIndex+1]) ? labelPoints[labelIndex+1][pointsIndex] : points;\n    var p, p2, buffer, benevolentMargins = this.benevolentMargins;\n\n    if (renderer.useSuperElevation) {\n        buffer = job.labelPointsBuffer;\n\n        if (buffer.id != (labelIndex * 1024 + pointsIndex)) {\n            buffer.id = (labelIndex * 1024 + pointsIndex);\n            if (buffer.points.length != points.length) {\n                buffer.points = new Array(points.length);\n                buffer.points2 = new Array(points.length);\n            }\n\n            var sePoints = buffer.points;\n            var sePoints2 = buffer.points2;\n\n            for(i = 0, li = points.length; i < li; i++) {\n                sePoints[i] = renderer.transformPointBySE2(points[i]);\n                sePoints2[i] = renderer.transformPointBySE2(points2[i]);\n            }\n\n            points = sePoints;\n            points2 = sePoints2;\n\n        } else {\n            points = buffer.points;\n            points2 = buffer.points2;\n        }\n    }\n\n    for (i = 0, li = points.length; i < li; i++) {\n\n        p = points[i];\n        p2 = points2[i];\n\n        pp[0] = p[0] + (p2[0] - p[0]) * labelMorph;\n        pp[1] = p[1] + (p2[1] - p[1]) * labelMorph;\n        pp[2] = p[2] + (p2[2] - p[2]) * labelMorph;\n        r = (p[3] + (p2[3] - p[3]) * labelMorph)*sizeFactor*margin;\n\n        pp = renderer.project2(pp, renderer.camera.mvp, renderer.cameraPosition, true);\n\n        if (pp[0] > x2) x2 = pp[0];\n        if (pp[1] > y2) y2 = pp[1];\n        if (pp[0] < x1) x1 = pp[0];\n        if (pp[1] < y1) y1 = pp[1];\n\n        //minX, maxX, minY, maxY;\n        pbuff[pindex] = pp[0];\n        pbuff[pindex+1] = pp[1];\n        pbuff[pindex+2] = pp[2];\n        pbuff[pindex+3] = r;\n\n        if (r > rr) {\n            rr = r;\n        }\n\n        pindex += 4;\n    }\n\n    x1 -= rr, x2 += rr, y1 -= rr, y2 += rr;\n\n    if (benevolentMargins) {\n        //screen including credits\n        if (x2 < this.sx1 || x1 > this.sx2 || y2 < this.sy1 || y1 > this.sy2) {\n            return false;\n        }\n    } else {\n        //screen including credits\n        if (x1 < this.sx1 || x2 > this.sx2 || y1 < this.sy1 || y2 > this.sy2) {\n            return false;\n        }\n\n        //compass\n        if ((renderer.marginFlags & 1) && x1 < this.cx2 && x2 > 0 && y1 <= this.sx2 && y2 > this.cy1) {\n            return false;\n        }\n\n        //search bar\n        if ((renderer.marginFlags & 2) && x1 < this.bx2 && x2 > 0 && y1 <= this.by2 && y2 > 0) {\n            return false;\n        }\n    }\n\n    var blockSizeFactor = this.blockSizeFactor, xx1, yy1, xx2, yy2, dx, dy, llx = this.lx, lly = this.ly;\n    var top = renderer.config.mapFeaturesSortByTop, j,\n        rectangles = this.rectangles, rectangles2 = this.rectangles2;\n\n    pindex = 0;\n\n    for (i = 0, li = points.length; i < li; i++) {\n\n        xx = pbuff[pindex];\n        yy = pbuff[pindex+1];\n        r = pbuff[pindex+3];\n\n        xx1 = Math.floor((xx-r) * blockSizeFactor);\n        yy1 = Math.floor((yy-r) * blockSizeFactor);\n        xx2 = Math.floor((xx+r) * blockSizeFactor);\n        yy2 = Math.floor((yy+r) * blockSizeFactor);\n\n        if (benevolentMargins) {\n            if (xx2 < 0 || xx1 >= llx || yy2 < 0 || yy1 >= lly) {\n              pindex += 4;\n              continue;  \n            } \n            if (xx1 < 0) xx1 = 0;\n            if (yy1 < 0) yy1 = 0;\n            if (xx2 >= llx) xx2 = llx - 1;\n            if (yy2 >= lly) yy2 = lly - 1;\n        }\n\n        var lx = (xx2 - xx1) + 1;\n        var ly = (yy2 - yy1) + 1;\n\n        //test collision\n        for (y = 0; y < ly; y++) {\n            for (x = 0; x < lx; x++) {\n                index = (yy1 + y)*llx + (xx1 + x);\n\n                blockRectangles = this.blocks[index];\n                blockRectanglesCount = this.blocksRCount[index];\n\n                //test rectangles\n                for (j = 0; j < blockRectanglesCount; j++) {\n                    rectangleIndex = blockRectangles[j];\n\n                    if (this.circleAABBoxCollide(x1, y1, x2, y2, rectangles[rectangleIndex + 0], rectangles[rectangleIndex + 1], rectangles[rectangleIndex + 2])) {\n\n                        //if (any) {\n                            return false;\n                        //}                    \n                    }\n                }\n\n                blockRectangles = this.blocks2[index];\n                blockRectanglesCount = this.blocks2RCount[index];\n\n                //test circles\n                for (j = 0; j < blockRectanglesCount; j++) {\n                    rectangleIndex = blockRectangles[j];\n\n                    dx = xx - rectangles2[rectangleIndex + 0];\n                    dy = yy - rectangles2[rectangleIndex + 1];\n                    rr = rectangles2[rectangleIndex + 2] + r;\n\n                    if ((dx*dx + dy*dy) < (rr * rr)) {\n\n                        //if (any) {\n                            return false;\n                        //}                    \n                    }\n                }\n            }\n        }\n\n        pindex += 4;\n    }\n\n    //there is no collision so we can store line label\n    pindex = 0;\n\n    for (i = 0, li = points.length; i < li; i++) {\n\n        xx = pbuff[pindex];\n        yy = pbuff[pindex+1];\n        r = pbuff[pindex+3];\n\n        xx1 = Math.floor((xx-r) * blockSizeFactor);\n        yy1 = Math.floor((yy-r) * blockSizeFactor);\n        xx2 = Math.floor((xx+r) * blockSizeFactor);\n        yy2 = Math.floor((yy+r) * blockSizeFactor);\n\n        if (benevolentMargins) {\n            if (xx2 < 0 || xx1 >= llx || yy2 < 0 || yy1 >= lly) {\n              pindex += 4;\n              continue;  \n            } \n            if (xx1 < 0) xx1 = 0;\n            if (yy1 < 0) yy1 = 0;\n            if (xx2 >= llx) xx2 = llx - 1;\n            if (yy2 >= lly) yy2 = lly - 1;\n        }\n\n        var lx = (xx2 - xx1) + 1;\n        var ly = (yy2 - yy1) + 1;\n\n        rectangleIndex = this.rectangles2Count;\n        rectangles2[rectangleIndex] = xx;\n        rectangles2[rectangleIndex+1] = yy;\n        rectangles2[rectangleIndex+2] = r;\n        rectangles2[rectangleIndex+3] = subjob;\n        this.rectangles2Count += 4;\n\n        //test collision\n        for (y = 0; y < ly; y++) {\n            for (x = 0; x < lx; x++) {\n                index = (yy1 + y)*this.lx + (xx1 + x);\n\n                //console.log('' + index);\n\n                //if (typeof this.blocks2[index][this.blocks2RCount[index]] === 'undefined') {\n                  //  debugger\n                //}\n\n                this.blocks2[index][this.blocks2RCount[index]] = rectangleIndex;\n                this.blocks2RCount[index]++;\n            }\n        }\n\n        pindex += 4;\n    }\n\n    return true;\n};\n\n\nRendererRMap.prototype.removeRectangle = function(rectangleIndex) {\n    var rectangles = this.rectangles, x1, y1, x2, y2, x, y, i, index,\n        blockRectangles, blockRectanglesCount;\n\n    x1 = rectangles[rectangleIndex];\n    y1 = rectangles[rectangleIndex+1];\n    x2 = rectangles[rectangleIndex+2];\n    y2 = rectangles[rectangleIndex+3];\n\n    //store removed rectangels for second pass\n    var rectangles2 = this.rectanglesR;\n    var rectangles2Count = this.rectanglesRCount;\n\n    rectangles2[rectangles2Count] = x1;\n    rectangles2[rectangles2Count+1] = y1;\n    rectangles2[rectangles2Count+2] = x2;\n    rectangles2[rectangles2Count+3] = y2;\n    rectangles2[rectangles2Count+4] = rectangles[rectangleIndex+4];\n    rectangles2[rectangles2Count+5] = rectangles[rectangleIndex+5];\n    this.rectanglesRCount += 6;\n\n    //remove subjob\n    rectangles[rectangleIndex+5] = null;\n\n    var xx1 = Math.floor(x1 * this.blockSizeFactor);\n    var yy1 = Math.floor(y1 * this.blockSizeFactor);\n    var xx2 = Math.floor(x2 * this.blockSizeFactor);\n    var yy2 = Math.floor(y2 * this.blockSizeFactor);\n\n    if (xx1 < 0) xx1 = 0;\n    if (xx2 >= this.lx) xx2 = this.lx - 1;\n\n    if (yy1 < 0) yy1 = 0;\n    if (yy2 >= this.ly) yy2 = this.ly - 1;\n\n    var lx = (xx2 - xx1) + 1;\n    var ly = (yy2 - yy1) + 1;\n\n    for (y = 0; y < ly; y++) {\n        for (x = 0; x < lx; x++) {\n            index = (yy1 + y)*this.lx + (xx1 + x);\n\n            blockRectangles = this.blocks[index];\n            blockRectanglesCount = this.blocksRCount[index];\n\n            for (i = 0; i < blockRectanglesCount; i++) {\n                if (blockRectangles[i] == rectangleIndex) {\n                    blockRectangles[i] = blockRectangles[blockRectanglesCount - 1];\n                    this.blocksRCount[index]--;\n                    break;\n                }\n            }\n\n        }\n    }\n};\n\nRendererRMap.prototype.processRectangles = function(gpu, gl, renderer, screenPixelSize) {\n    var rectangles = this.rectangles;\n    var rectangles2 = this.rectangles2;\n    var rectanglesR = this.rectanglesR;\n    var draw = renderer.draw;\n\n    // second pass\n    // add removed rectangles\n    for (var i = 0, li = this.rectanglesRCount; i < li; i+=6) {\n        var x1 = rectanglesR[i],\n            y1 = rectanglesR[i+1],\n            x2 = rectanglesR[i+2],\n            y2 = rectanglesR[i+3],\n            z = rectanglesR[i+4],\n            subjob = rectanglesR[i+5];\n\n        this.addRectangle(x1, y1, x2, y2, z, subjob);\n    }\n\n    this.rectanglesRCount = 0;\n\n    //labels\n    for (i = 0, li = this.rectanglesCount; i < li; i+=6) {\n        var subjob = rectangles[i+5];\n\n        if (subjob) {\n            if (subjob[0].hysteresis) {\n                renderer.jobHBuffer[subjob[0].id] = subjob[0];\n            } else {\n                renderer.drawnJobs++;\n                draw.drawGpuSubJob(gpu, gl, renderer, screenPixelSize, subjob, null);\n            }\n        }\n    }\n\n    //line labels\n    for (i = 0, li = this.rectangles2Count; i < li; i+=4) {\n        var subjob = rectangles2[i+3];\n\n        if (subjob) {\n            var job = subjob[0];\n\n            if (job.hysteresis) {\n                renderer.jobHBuffer[job.id] = job;\n            } else {\n                renderer.drawnJobs++;\n                draw.drawGpuSubJobLineLabel(gpu, gl, renderer, screenPixelSize, subjob, null);\n            }\n\n            var l = job.labelPoints[0][2].length;\n\n            if (l > 0) {\n                i += (4 * (l - 1));\n            }\n        }\n    }\n\n    this.clear();\n};\n\nexport default RendererRMap;\n\n","\nimport {vec3 as vec3_, mat4 as mat4_} from '../utils/matrix';\nimport GpuDevice_ from './gpu/device';\nimport GpuTexture_ from './gpu/texture';\nimport GpuFont_ from './gpu/font';\nimport Camera_ from './camera';\nimport RenderInit_ from './init';\nimport RenderDraw_ from './draw';\nimport RenderRMap_ from './rmap';\n\n//get rid of compiler mess\nvar vec3 = vec3_, mat4 = mat4_;\nvar GpuDevice = GpuDevice_;\nvar GpuTexture = GpuTexture_;\nvar GpuFont = GpuFont_;\nvar Camera = Camera_;\nvar RenderInit = RenderInit_;\nvar RenderDraw = RenderDraw_;\nvar RenderRMap = RenderRMap_;\n\nvar Renderer = function(core, div, onUpdate, onResize, config) {\n    this.config = config || {};\n    this.core = core;\n    this.marginFlags = 0;\n    this.progTile = null;\n    this.progHeightmap = null;\n    this.progSkydome = null;\n    this.progWireframeTile = null;\n    this.progWireframeTile2 = null;\n    this.progText = null;\n    this.div = div;\n    this.onUpdate = onUpdate;\n    this.killed = false;\n    this.onlyDepth = false;\n    this.onlyLayers = false;\n    this.onlyHitLayers = false;\n    this.onlyAdvancedHitLayers = false;\n    this.advancedPassNeeded = false;\n    this.hitmapCounter = 0;\n    this.geoRenderCounter = 0;\n    this.geoHitmapCounter = 0;\n    this.frameTime = 0;\n    this.geometries = {};\n    this.clearStencilPasses = [];\n    this.onResizeCall = onResize;\n    //this.math = Math;\n    this.stencilLineState = null;\n    this.drawLabelBoxes = false;\n    this.drawGridCells = false;\n    this.drawAllLabels = false;\n    this.debug = {};\n    this.mapHack = null;\n\n    this.geodataSelection = [];\n    this.hoverFeatureCounter = 0;\n    this.hoverFeatureList = [];\n\n    this.touchSurfaceEvent = [];\n\n    var rect = this.div.getBoundingClientRect();\n\n    this.winSize = [rect.width, rect.height]; //QSize\n    this.curSize = [rect.width, rect.height]; //QSize\n    this.oldSize = [rect.width, rect.height]; //QSize\n    this.dirty = true;\n    this.cameraVector = [0,1,0];\n    this.viewExtent = 1;\n    //this.texelSizeLimit = this.core.mapConfig.texelSize * texelSizeFactor;\n\n    this.gpu = new GpuDevice(this, div, this.curSize, this.config.rendererAllowScreenshots, this.config.rendererAntialiasing, this.config.rendererAnisotropic);\n    this.camera = new Camera(this, 45, 2, 1200000.0);\n\n    //reduce garbage collection\n    this.drawTileMatrix = mat4.create();\n    this.drawTileMatrix2 = mat4.create();\n    this.drawTileVec = [0,0,0];\n    this.drawTileWorldMatrix = mat4.create();\n    this.pixelTileSizeMatrix = mat4.create();\n\n    this.heightmapMesh = null;\n    this.heightmapTexture = null;\n\n    this.skydomeMesh = null;\n    this.skydomeTexture = null;\n\n    this.hitmapTexture = null;\n    this.geoHitmapTexture = null;\n    this.hitmapSize = this.config.mapDMapSize;\n    this.hitmapMode = this.config.mapDMapMode;\n    this.updateHitmap = true;\n    this.updateGeoHitmap = true;\n\n    this.redTexture = null;\n\n    this.rectVerticesBuffer = null;\n    this.rectIndicesBuffer = null;\n    this.imageProjectionMatrix = null;\n\n    this.font = null;\n    this.fonts = {};\n    this.fogDensity = 0;\n\n    this.gmap = new Array(2048);\n    this.gmap2 = new Array(2048);\n    this.gmap3 = new Array(10000);\n    this.gmap3Size = new Array(10000);\n    this.gmap4 = new Array(10000);\n    this.gmapIndex = 0;\n    this.gmapTop = new Array(512);\n    this.gmapHit = new Array(512);\n    this.gmapStore = new Array(512);\n    this.fmaxDist = 0;\n    this.fminDist = 0;\n\n    this.jobZBuffer = new Array(512);\n    this.jobZBufferSize = new Array(512);\n\n    this.jobZBuffer2 = new Array(512);\n    this.jobZBuffer2Size = new Array(512);\n    \n    this.jobHBuffer = {};\n    this.jobHBufferSize = 0;\n    this.jobHSortBuffer = new Array(2048);\n\n\n    for (var i = 0, li = this.jobZBuffer.length; i < li; i++) {\n        this.jobZBuffer[i] = [];\n        this.jobZBufferSize[i] = 0;\n        this.jobZBuffer2[i] = {};\n        this.jobZBuffer2Size[i] = 0;\n    }\n\n    for (i = 0, li = this.gmap3.length; i < li; i++) {\n        this.gmap3[i] = [];\n        this.gmap3Size[i] = 0;\n    }\n\n    this.radixCountBuffer16 = new Uint16Array(256*4);\n    this.radixCountBuffer32 = new Uint32Array(256*4);\n    //this.radixOutputBufferUint32 = new Uint32Array(256*256);\n    //this.radixOutputBufferFloat32 = new Uint32Array(256*256);\n\n    this.buffFloat32 = new Float32Array(1);\n    this.buffUint32 = new Uint32Array(this.buffFloat32.buffer);\n\n    this.layerGroupVisible = [];\n    this.bitmaps = {};\n    \n    this.cameraPosition = [0,0,0];\n    this.cameraOrientation = [0,0,0];\n    this.cameraTiltFator = 1;\n    this.cameraViewExtent = 1;\n    this.distanceFactor = 1;\n    this.tiltFactor = 1;\n    this.localViewExtentFactor = 1;\n    this.cameraVector = [0,0,0];\n    this.labelVector = [0,0,0];\n    this.drawnGeodataTiles = 0;\n    this.drawnGeodataTilesFactor = 0;\n    this.drawnGeodataTilesUsed = false;\n    this.progMap = {};\n    this.gridHmax = 0;\n    this.gridHmin = 0;\n    this.seCounter = 0;\n\n    //hack for vts maps\n    //this.vtsHack = true;\n    //this.vtsHack = false;\n\n    //reduce garbage collection\n    this.updateCameraMatrix = mat4.create();\n\n    this.seTmpVec = [0,0,0];\n    this.seTmpVec2 = [0,0,0];\n    this.seTmpVec3 = [0,0,0];\n\n    //debug\n    this.lastHitPosition = [0,0,100];\n    this.logTilePos = null;\n    this.setSuperElevation(0,2,4000,1.5);\n\n    window.addEventListener('resize', (this.onResize).bind(this), false);\n\n    this.gpu.init();\n\n    //intit resources\n    // eslint-disable-next-line\n    this.init = new RenderInit(this);\n    this.rmap = new RenderRMap(this, 50);\n    this.draw = new RenderDraw(this);\n\n    var factor = 1;\n    this.resizeGL(Math.floor(this.curSize[0]*factor), Math.floor(this.curSize[1]*factor));\n};\n\nRenderer.prototype.initProceduralShaders = function() {\n    this.init.initProceduralShaders();\n};\n\n\nRenderer.prototype.onResize = function() {\n    if (this.killed){\n        return;\n    }\n\n    var rect = this.div.getBoundingClientRect();\n    this.resizeGL(Math.floor(rect.width), Math.floor(rect.height));\n    \n    if (this.onResizeCall) {\n        this.onResizeCall();\n    }\n};\n\n\nRenderer.prototype.kill = function() {\n    if (this.killed){\n        return;\n    }\n\n    this.killed = true;\n\n    if (this.heightmapMesh) this.heightmapMesh.kill();\n    if (this.heightmapTexture) this.heightmapTexture.kill();\n    if (this.skydomeMesh) this.skydomeMesh.kill();\n    if (this.skydomeTexture) this.skydomeTexture.kill();\n    if (this.hitmapTexture) this.hitmapTexture.kill();\n    if (this.geoHitmapTexture) this.geoHitmapTexture.kill();\n    if (this.redTexture) this.redTexture.kill();\n    if (this.whiteTexture) this.whiteTexture.kill();\n    if (this.blackTexture) this.blackTexture.kill();\n    if (this.lineTexture) this.lineTexture.kill();\n    if (this.textTexture2) this.textTexture2.kill();\n    if (this.atmoMesh) this.atmoMesh.kill();\n    if (this.bboxMesh) this.bboxMesh.kill();\n    if (this.font) this.font.kill();\n    if (this.plines) this.plines.kill();\n    if (this.plineJoints) this.plineJoints.kill();\n \n    this.gpu.kill();\n    //this.div.removeChild(this.gpu.getCanvas());\n};\n\n\nRenderer.prototype.resizeGL = function(width, height, skipCanvas, skipPaint) {\n    this.camera.setAspect(width / height);\n    this.curSize = [width, height];\n    this.oldSize = [width, height];\n    this.gpu.resize(this.curSize, skipCanvas);\n\n    //if (skipPaint !== true) { //remove this??\n       // this.draw.paintGL();\n    //}\n\n    var m = new Float32Array(16);\n    m[0] = 2.0/width; m[1] = 0; m[2] = 0; m[3] = 0;\n    m[4] = 0; m[5] = -2.0/height; m[6] = 0; m[7] = 0;\n    m[8] = 0; m[9] = 0; m[10] = 1; m[11] = 0;\n    m[12] = -width*0.5*m[0]; m[13] = -height*0.5*m[5]; m[14] = 0; m[15] = 1;\n\n    this.imageProjectionMatrix = m;\n};\n\n\nRenderer.prototype.project2 = function(point, mvp, cameraPos, includeDistance) {\n    var p = [0, 0, 0, 1];\n\n    if (cameraPos) {\n        p = mat4.multiplyVec4(mvp, [point[0] - cameraPos[0], point[1] - cameraPos[1], point[2] - cameraPos[2], 1 ]);\n    } else {\n        p = mat4.multiplyVec4(mvp, [point[0], point[1], point[2], 1 ]);\n    }\n\n    //project point coords to screen\n    if (p[3] != 0) {\n        var sp = [0,0,0];\n\n        //x and y are in screen pixels\n        sp[0] = ((p[0]/p[3])+1.0)*0.5*this.curSize[0];\n        sp[1] = (-(p[1]/p[3])+1.0)*0.5*this.curSize[1];\n\n        //depth in meters\n        sp[2] = p[2]/p[3];\n\n        if (includeDistance) {\n            sp[3] = p[2];\n        }\n\n        return sp;\n    } else {\n        return [0, 0, 0];\n    }\n};\n\n\nRenderer.prototype.setSuperElevationState = function(state) {\n    if (this.useSuperElevation != state) {\n        this.useSuperElevation = state;\n        this.seCounter++;\n    }\n};\n\n\nRenderer.prototype.getSuperElevationState = function() {\n    return this.useSuperElevation;\n};\n\n\nRenderer.prototype.setSuperElevation = function(h1, f1, h2, f2) {\n    if (f1 == 1 && f2 == 1) {\n        if (this.useSuperElevation != false) {\n            this.useSuperElevation = false;\n            this.seCounter++;\n        }\n\n        if (h1 == h2) { h2 = h1 + 1; }\n        this.superElevation = [h1, f1, h2, f2, h2-h1, f2-f1, 1.0 / (h2-h1)];\n        return;\n    }\n\n    if (h1 == h2) { h2 = h1 + 1; }\n    this.superElevation = [h1, f1, h2, f2, h2-h1, f2-f1, 1.0 / (h2-h1)];\n    this.seCounter++;\n};\n\n\nRenderer.prototype.getSuperElevation = function() {\n    return this.superElevation.slice();\n};\n\n\nRenderer.prototype.getSuperElevatedHeight = function(height) {\n    var se = this.superElevation, h = height;\n\n    if (h < se[0]) {  // 0 - h1, 1 - f1, 2 - h2, 3 - f2, 4 - dh, 5 - df, 6 - invdh\n        h = se[0];\n    }\n\n    if (h > se[2]) {\n        h = se[2];\n    }\n\n    return height * (se[1] + ((h - se[0]) * se[6]) * se[5]);\n};\n\nRenderer.prototype.getUnsuperElevatedHeight = function(height) {\n    var se = this.superElevation, s = height;\n\n    if (se[1] == se[3]) {\n        return s / se[1];\n    }\n\n    if (s <= se[0] * se[1]) {  // 0 - h1, 1 - f1, 2 - h2, 3 - f2, 4 - dh, 5 - df, 6 - invdh\n        return s / se[1];\n    }\n\n    if (s >= se[2] * se[3]) {\n        return s / se[3];\n    }\n\n\n    var h1 = se[0], f1 = se[1], h2 = se[2], f2 = se[3];\n\n    // and f1!=f2 and h1!=h2\n\n    return -(Math.sqrt(-2*f2*(f1*h1*h2 + 2*h1*s - 2*h2*s) + f1*(f1*h2*h2 + 4*h1*s - 4*h2*s) + f2*f2*h1*h1) - f1*h2 + f2*h1)/(2*(f1 - f2));\n};\n\n\nRenderer.prototype.getEllipsoidHeight = function(pos, shift) {\n    var p, p2;\n    this.seTmpVec3 = [0,0,0];\n\n    if (shift) {\n        p = this.seTmpVec;\n        p2 = [pos[0] + shift[0], pos[1] + shift[1], (pos[2] + shift[2]) * this.earthERatio];\n    } else {\n        p = pos;\n        p2 = [p[0], p[1], p[2] * this.earthERatio];\n    }\n\n    var l = Math.sqrt(p2[0] * p2[0] + p2[1] * p2[1] + p2[2] * p2[2]);\n\n    return l - this.earthRadius;\n};\n\n\nRenderer.prototype.transformPointBySE = function(pos, shift) {\n    var p = pos, p2;\n    this.seTmpVec3 = [0,0,0];\n\n    if (shift) {\n        p2 = [pos[0] + shift[0], pos[1] + shift[1], (pos[2] + shift[2]) * this.earthERatio];\n    } else {\n        p2 = [p[0], p[1], p[2] * this.earthERatio];\n    }\n\n    var l = Math.sqrt(p2[0] * p2[0] + p2[1] * p2[1] + p2[2] * p2[2]);\n    var v = this.seTmpVec2;\n\n    var m = (1.0/(l+0.0001));\n    v[0] = p2[0] * m;\n    v[1] = p2[1] * m;\n    v[2] = p2[2] * m;\n\n    var h = l - this.earthRadius;\n    var h2 = this.getSuperElevatedHeight(h);\n    m = (h2 - h);\n\n    p2[0] = p[0] + v[0] * m;\n    p2[1] = p[1] + v[1] * m;\n    p2[2] = p[2] + v[2] * m;\n\n    return p2;\n};\n\n\nRenderer.prototype.transformPointBySE2 = function(pos, shift) {\n    var p = pos, p2;\n    this.seTmpVec3 = [0,0,0];\n\n    if (shift) {\n        p2 = [pos[0] + shift[0], pos[1] + shift[1], (pos[2] + shift[2]) * this.earthERatio];\n    } else {\n        p2 = [p[0], p[1], p[2] * this.earthERatio];\n    }\n\n    var l = Math.sqrt(p2[0] * p2[0] + p2[1] * p2[1] + p2[2] * p2[2]);\n    var v = this.seTmpVec2;\n\n    var m = (1.0/(l+0.0001));\n    v[0] = p2[0] * m;\n    v[1] = p2[1] * m;\n    v[2] = p2[2] * m;\n\n    var h = l - this.earthRadius;\n    var h2 = this.getSuperElevatedHeight(h);\n    m = (h2 - h);// * 10;\n\n    pos = pos.slice();\n\n    pos[0] = p[0] + v[0] * m;\n    pos[1] = p[1] + v[1] * m;\n    pos[2] = p[2] + v[2] * m;\n\n    pos[13] = v[0] * m;\n    pos[14] = v[1] * m;\n    pos[15] = v[2] * m;\n\n    return pos;\n};\n\n\nRenderer.prototype.project = function(point) {\n    //get mode-view-projection matrix\n    var mvp = this.camera.getMvpMatrix();\n\n    //get camera position relative to position\n    var cameraPos2 = this.camera.getPosition();\n\n    //get global camera position\n    var cameraPos = this.cameraPosition();\n\n    //get point coords relative to camera\n    var p = [point[0] - cameraPos[0] + cameraPos2[0], point[1] - cameraPos[1] + cameraPos2[1], point[2] - cameraPos[2] + cameraPos2[2], 1 ];\n\n    //project point coords to screen\n    var p2 = [0, 0, 0, 1];\n    p2 = mat4.multiplyVec4(mvp, p);\n\n    if (p2[3] != 0) {\n\n        var sp = [0,0,0];\n\n        //x and y are in screen pixels\n        sp[0] = ((p2[0]/p2[3])+1.0)*0.5*this.curSize[0];\n        sp[1] = (-(p2[1]/p2[3])+1.0)*0.5*this.curSize[1];\n\n        //depth in meters\n        sp[2] = p2[2]/p2[3];\n\n        return sp;\n    } else {\n        return [0, 0, 0];\n    }\n};\n\n\nRenderer.prototype.getScreenRay = function(screenX, screenY) {\n    if (this.camera == null) {\n        return [0,0,1.0];\n    }\n\n    this.camera.dirty = true; //???? why is projection matrix distored so I have to refresh\n\n    //convert screen coords\n    var x = (2.0 * screenX) / this.curSize[0] - 1.0;\n    var y = 1.0 - (2.0 * screenY) / this.curSize[1];\n    \n    var rayNormalizeDeviceSpace = [x, y, 1.0];\n\n    var rayClipCoords = [rayNormalizeDeviceSpace[0], rayNormalizeDeviceSpace[1], -1.0, 1.0];\n\n    var invProjection = mat4.create();\n    invProjection = mat4.inverse(this.camera.getProjectionMatrix());\n\n    //console.log(\"--\" + JSON.stringify(rayClipCoords));\n    //console.log(\"----\" + JSON.stringify(invProjection));\n\n    var rayEye = [0,0,0,0];\n    mat4.multiplyVec4(invProjection, rayClipCoords, rayEye); //inverse (projectionmatrix) * rayClipCoords;\n    rayEye[2] = -1.0;\n    rayEye[3] = 0.0;\n\n    var invView = mat4.create();\n    invView = mat4.inverse(this.camera.getModelviewMatrix());\n\n    var rayWorld = [0,0,0,0];\n    mat4.multiplyVec4(invView, rayEye, rayWorld); //inverse (projectionmatrix) * rayClipCoords;\n\n    // don't forget to normalise the vector at some point\n    rayWorld = vec3.normalize([rayWorld[0], rayWorld[1], rayWorld[2]]); //normalise (raywor);\n\n    return rayWorld;\n};\n\n\nRenderer.prototype.hitTestGeoLayers = function(screenX, screenY, secondTexture) {\n    var gl = this.gpu.gl;\n\n    //probably not needed\n    //if (gl.checkFramebufferStatus(gl.FRAMEBUFFER) != gl.FRAMEBUFFER_COMPLETE) {\n      //  return [false, 0,0,0,0];\n    //}\n\n    var surfaceHit = false, pixel;\n\n    if (screenX >= 0 && screenX < this.curSize[0] &&\n        screenY >= 0 && screenY < this.curSize[1]) {\n\n        //convert screen coords to texture coords\n        var x = 0, y = 0;\n\n        //get screen coords\n        x = Math.floor(screenX * (this.hitmapSize / this.curSize[0]));\n        y = Math.floor(screenY * (this.hitmapSize / this.curSize[1]));\n\n        //get pixel value from framebuffer\n\n        if (secondTexture) {\n            pixel = this.geoHitmapTexture2.readFramebufferPixels(x, this.hitmapSize - y - 1, 1, 1);\n        } else {\n            pixel = this.geoHitmapTexture.readFramebufferPixels(x, this.hitmapSize - y - 1, 1, 1);\n        }\n\n        surfaceHit = !(pixel[0] == 255 && pixel[1] == 255 && pixel[2] == 255 && pixel[3] == 255);\n    }\n\n    if (surfaceHit) {\n        return [true, pixel[0], pixel[1], pixel[2], pixel[3]];\n    } \n\n    return [false, 0,0,0,0];\n};\n\n\nRenderer.prototype.switchToFramebuffer = function(type, texture) {\n    var gl = this.gpu.gl, size, width, height;\n    \n    switch(type) {\n    case 'base':\n        width = this.oldSize[0];\n        height = this.oldSize[1];\n    \n        gl.clearColor(0.0, 0.0, 0.0, 1.0);\n    \n        gl.viewport(0, 0, width, height);\n        this.gpu.setFramebuffer(null);\n    \n        this.camera.setAspect(width / height);\n        this.curSize = [width, height];\n        this.gpu.resize(this.curSize, true);\n        this.camera.update();\n            //this.updateCamera();\n        this.onlyDepth = false;\n        this.onlyHitLayers = false;\n        this.onlyAdvancedHitLayers = false;\n        this.advancedPassNeeded = false;\n        break;\n\n    case 'depth':\n        //set texture framebuffer\n        this.gpu.setFramebuffer(this.hitmapTexture);\n\n        this.oldSize = [ this.curSize[0], this.curSize[1] ];\n   \n        gl.clearColor(1.0,1.0, 1.0, 1.0);\n        gl.enable(gl.DEPTH_TEST);\n\n        size = this.hitmapSize;\n    \n        //clear screen\n        gl.viewport(0, 0, size, size);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    \n        this.curSize = [size, size];\n\n        //this.gpu.clear();\n        this.camera.update();\n        this.onlyDepth = true;\n        this.onlyHitLayers = false;\n        this.onlyAdvancedHitLayers = false;\n        this.advancedPassNeeded = false;\n        break;\n\n    case 'geo':\n    case 'geo2':\n\n        this.hoverFeatureCounter = 0;\n        size = this.hitmapSize;\n            \n        //set texture framebuffer\n        this.gpu.setFramebuffer(type == 'geo' ? this.geoHitmapTexture : this.geoHitmapTexture2);\n            \n        width = size;\n        height = size;\n            \n        gl.clearColor(1.0,1.0, 1.0, 1.0);\n        gl.enable(gl.DEPTH_TEST);\n            \n        //clear screen\n        gl.viewport(0, 0, size, size);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n            \n        this.curSize = [width, height];\n            \n        //render scene\n        this.onlyHitLayers = true;\n        this.advancedPassNeeded = false;\n        this.onlyAdvancedHitLayers = (type == 'geo2');\n            \n        //this.gpu.clear();\n        this.camera.update();\n        break;\n\n    case 'texture':\n        //set texture framebuffer\n        this.gpu.setFramebuffer(texture);\n\n        this.oldSize = [ this.curSize[0], this.curSize[1] ];\n   \n        gl.clearColor(0.0, 0.0, 0.0, 1.0);\n        gl.enable(gl.DEPTH_TEST);\n\n        //clear screen\n        gl.viewport(0, 0, this.gpu.canvas.width, this.gpu.canvas.height);\n        gl.clear(gl.COLOR_BUFFER_BIT | gl.DEPTH_BUFFER_BIT);\n    \n        this.curSize = [this.gpu.canvas.width, this.gpu.canvas.height];\n\n        //this.gpu.clear();\n        this.camera.update();\n        this.onlyDepth = false;\n        this.onlyHitLayers = false;\n        this.onlyAdvancedHitLayers = false;\n        this.advancedPassNeeded = false;\n        break;        \n    }\n};\n\n\nRenderer.prototype.hitTest = function(screenX, screenY) {\n    var gl = this.gpu.gl;\n\n    //get screen ray\n    var screenRay = this.getScreenRay(screenX, screenY);\n    var cameraPos = this.camera.getPosition();\n\n    //probably not needed\n    //if (gl.checkFramebufferStatus(gl.FRAMEBUFFER) != gl.FRAMEBUFFER_COMPLETE) {  \n      //  return [0, 0, 0, null, screenRay, Number.MAX_VALUE, cameraPos];\n    //}\n\n    //convert screen coords to texture coords\n    var x = 0, y = 0;\n\n    //get screen coords\n    x = Math.floor(screenX * (this.hitmapSize / this.curSize[0]));\n    y = Math.floor(screenY * (this.hitmapSize / this.curSize[1]));\n\n    //get pixel value from framebuffer\n    var pixel = this.hitmapTexture.readFramebufferPixels(x, this.hitmapSize - y - 1, 1, 1);\n\n    //convert rgb values into depth\n    var depth = (pixel[0] * (1.0/255)) + (pixel[1]) + (pixel[2]*255.0) + (pixel[3]*65025.0);// + (pixel[3]*16581375.0);\n\n    var surfaceHit = !(pixel[0] == 255 && pixel[1] == 255 && pixel[2] == 255 && pixel[3] == 255);\n\n    //compute hit postion\n    this.lastHitPosition = [cameraPos[0] + screenRay[0]*depth, cameraPos[1] + screenRay[1]*depth, cameraPos[2] + screenRay[2]*depth];\n\n    return [this.lastHitPosition[0], this.lastHitPosition[1], this.lastHitPosition[2], surfaceHit, screenRay, depth, cameraPos];\n};\n\n\nRenderer.prototype.copyHitmap = function() {\n    this.hitmapTexture.readFramebufferPixels(0,0,this.hitmapSize,this.hitmapSize, false, this.hitmapData);\n};\n\n\nRenderer.prototype.getDepth = function(screenX, screenY) {\n    var x = Math.floor(screenX * (this.hitmapSize / this.curSize[0]));\n    var y = Math.floor(screenY * (this.hitmapSize / this.curSize[1]));\n\n    if (this.hitmapMode <= 2) {\n        //get pixel value from framebuffer\n        var pixel = this.hitmapTexture.readFramebufferPixels(x, this.hitmapSize - y - 1, 1, 1, (this.hitmapMode == 2));\n\n        //convert rgb values into depth\n        var depth = (pixel[0] * (1.0/255)) + (pixel[1]) + (pixel[2]*255.0) + (pixel[3]*65025.0);// + (pixel[3]*16581375.0);\n        var surfaceHit = !(pixel[0] == 255 && pixel[1] == 255 && pixel[2] == 255 && pixel[3] == 255);\n\n    } else {\n        var pixels = this.hitmapData;\n        var index = (x + (this.hitmapSize - y - 1) * this.hitmapSize) * 4;\n        var r = pixels[index], g = pixels[index+1], b = pixels[index+2], a = pixels[index+3];\n\n        var depth = (r * (1.0/255)) + (g) + (b*255.0) + (a*65025.0);// + (pixel[3]*16581375.0);\n        var surfaceHit = !(r == 255 && g == 255 && b == 255 && a == 255);\n    }\n\n    return [surfaceHit, depth];\n};\n\n\nRenderer.prototype.getZoffsetFactor = function(params) {\n    return (params[0] + params[1]*this.distanceFactor + params[2]*this.tiltFactor)*0.0001;\n};\n\n\nRenderer.prototype.saveScreenshot = function(output, filename, filetype) {\n    var gl = this.gpu.gl;\n\n    //get current screen size\n    var width = this.curSize[0];\n    var height = this.curSize[1];\n\n    //read rgba data from frame buffer\n    //works only when webgl context is initialized with preserveDrawingBuffer: true\n    var data2 = new Uint8Array(width * height * 4);\n    gl.readPixels(0, 0, width, height, gl.RGBA, gl.UNSIGNED_BYTE, data2);\n\n    //flip image vertically\n    var data = new Uint8Array(width * height * 4);\n    var index = 0;\n\n    for (var y = 0; y < height; y++) {\n\n        var index2 = ((height-1) - y) * width * 4;\n\n        for (var x = 0; x < width; x++) {\n            data[index] = data2[index2];\n            data[index+1] = data2[index2+1];\n            data[index+2] = data2[index2+2];\n            data[index+3] = data2[index2+3];\n            index+=4;\n            index2+=4;\n        }\n    }\n\n    // Create a 2D canvas to store the result\n    var canvas = document.createElement('canvas');\n    canvas.width = width;\n    canvas.height = height;\n    var context = canvas.getContext('2d');\n\n    // Copy the pixels to a 2D canvas\n    var imageData = context.createImageData(width, height);\n    imageData.data.set(data);\n    context.putImageData(imageData, 0, 0);\n\n    filetype = filetype || 'jpg'; \n   \n    if (output == 'file') {\n        var a = document.createElement('a');\n\n        var dataURI= canvas.toDataURL('image/' + filetype);\n\n        var byteString = atob(dataURI.split(',')[1]);\n        \n        // write the bytes of the string to an ArrayBuffer\n        var ab = new ArrayBuffer(byteString.length);\n        var ia = new Uint8Array(ab);\n        for (var i = 0; i < byteString.length; i++) {\n            ia[i] = byteString.charCodeAt(i);\n        }\n      \n        var file = new Blob([ab], {type: filetype});\n\n        var url = URL.createObjectURL(file);\n        a.href = url;\n        a.download = filename;\n        document.body.appendChild(a);\n        a.click();\n        setTimeout(function() {\n            document.body.removeChild(a);\n            window.URL.revokeObjectURL(url);  \n        }, 0); \n    } if (output == 'tab') {\n        //open image in new window\n        window.open(canvas.toDataURL('image/' + filetype));\n    }\n    \n    return imageData;\n};\n\n\nRenderer.prototype.getBitmap = function(url, filter, tiled, hash, useHash) {\n    var id = (useHash ? hash : url) + '*' + filter + '*' + tiled;\n\n    var texture = this.bitmaps[id];\n    if (!texture && url) {\n        texture = new GpuTexture(this.gpu, url, this.core, null, null, tiled, filter);\n        this.bitmaps[id] = texture;\n    }\n\n    return texture;\n};\n\n\nRenderer.prototype.getFont = function(url) {\n    var font = this.fonts[url];\n    if (!font) {\n        font = new GpuFont(this.gpu, this.core, null, null, url);\n        this.fonts[url] = font;\n    }\n\n    return font;\n};\n\n\nexport default Renderer;\n","\nimport {vec3 as vec3_} from '../utils/matrix';\n\n//get rid of compiler mess\nvar vec3 = vec3_;\n\n\nvar Octree = function() {\n    this.root = null;\n    this.maxItemsPerNode = 20;\n    this.maxDepth = 20;\n\n    this.depthCount = [];\n    for (var i = 0; i < 1000; i++) {\n        this.depthCount[i] = 0;\n    }\n\n    /**\n     * A binary pattern that describes the standard octant layout:\n     *\n     * ```text\n     *    3____7\n     *  2/___6/|\n     *  | 1__|_5\n     *  0/___4/\n     * ```\n     *\n     * This common layout is crucial for positional assumptions.\n     *\n     */\n\n    this.pattern = [\n        new Uint8Array([0, 0, 0]),\n        new Uint8Array([0, 0, 1]),\n        new Uint8Array([0, 1, 0]),\n        new Uint8Array([0, 1, 1]),\n\n        new Uint8Array([1, 0, 0]),\n        new Uint8Array([1, 0, 1]),\n        new Uint8Array([1, 1, 0]),\n        new Uint8Array([1, 1, 1])\n    ];\n};\n\n\nOctree.prototype.clear = function() {\n};\n\n\nOctree.prototype.buildFromGeometry = function(data) {\n    if (!data) {\n        return;\n    }\n\n    var i, li, j, lj, k, lk, v, item, submeshes, submesh, bbox, index,\n        minX, minY, minZ, maxX, maxY, maxZ, geometry, vertices;\n\n    minX = minY = minZ = Number.POSITIVE_INFINITY;\n    maxX = maxY = maxZ = Number.NEGATIVE_INFINITY;\n\n    //get gemetery bbox\n    for (i = 0, li = data.length; i < li; i++) {\n        geometry = data[i];\n        if (geometry[\"type\"] == \"mesh\") {\n            submeshes = geometry[\"submeshes\"];\n\n            for (j = 0, lj = submeshes.length; j < lj; j++) {\n                submesh = submeshes[j];\n                bbox = submesh[\"bbox\"];\n                \n                if (bbox[0][0] < minX) minX = bbox[0][0];\n                if (bbox[0][1] < minY) minY = bbox[0][1];\n                if (bbox[0][2] < minZ) minZ = bbox[0][2];\n\n                if (bbox[1][0] > maxX) maxX = bbox[1][0];\n                if (bbox[1][1] > maxY) maxY = bbox[1][1];\n                if (bbox[1][2] > maxZ) maxZ = bbox[1][2];\n            }\n        }\n    }\n\n    this.root = new OctreeNode([minX, minY, minZ], [maxX, maxY, maxZ]);\n\n    //get gemetery bbox\n    for (i = 0, li = data.length; i < li; i++) {\n        geometry = data[i];\n        if (geometry[\"type\"] == \"mesh\") {\n            submeshes = geometry[\"submeshes\"];\n\n            for (j = 0, lj = submeshes.length; j < lj; j++) {\n                submesh = submeshes[j];\n\n                vertices = submesh[\"vertices\"];\n\n                for (k = 0, lk = vertices.length; k < lk; k += 9) {\n\n                    minX = minY = minZ = Number.POSITIVE_INFINITY;\n                    maxX = maxY = maxZ = Number.NEGATIVE_INFINITY;\n\n                    for (v = 0; v < 3; v ++) {\n                        index = k + v * 3;\n\n                        if (vertices[index] < minX) minX = vertices[index];\n                        if (vertices[index+1] < minY) minY = vertices[index+1];\n                        if (vertices[index+2] < minZ) minZ = vertices[index+2];\n\n                        if (vertices[index] > maxX) maxX = vertices[index];\n                        if (vertices[index+1] > maxY) maxY = vertices[index+1];\n                        if (vertices[index+2] > maxZ) maxZ = vertices[index+2];\n                    }\n\n                    //this.root.add([minX, minY, minZ], [maxX, maxY, maxZ], [vertices, k])\n                    this.root.add([minX, minY, minZ, maxX, maxY, maxZ, vertices, k], this)\n                }\n\n            }\n        }\n    }\n\n\n};\n\n\nvar OctreeNode = function(min, max) {\n    this.min = min;\n    this.max = max;\n    this.children = null;\n    this.items = null;\n};\n\nOctreeNode.prototype.add = function(item, octree, depth) {\n    if (this.children) {\n        if (!depth) {\n            depth = 0; \n        }\n\n        for (var i = 0; i < 8; i++) {\n            var child = this.children[i],\n                min = child.min,\n                max = child.max;\n\n            if (item[0] < max[0] && item[3] > min[0] &&\n                item[1] < max[1] && item[4] > min[1] &&\n                item[2] < max[2] && item[5] > min[2]) {\n\n                //collision detected, add item\n                child.add(item, octree, depth + 1);\n            }\n        }\n\n        return;\n    }\n\n    if (!this.items) {\n        this.items = [];\n    }\n\n    this.items.push(item);\n\n    if (depth < octree.maxDepth && this.items.length >= octree.maxItemsPerNode) {\n        this.split(octree, depth + 1);\n    }\n};\n\nOctreeNode.prototype.split = function(octree, depth) {\n    var min = this.min,\n        max = this.max,\n        mid = [(max[0] + min[0]) * 0.5, (max[1] + min[1]) * 0.5, (max[2] + min[2]) * 0.5],\n        i, li, j;\n\n    this.children = [\n        null, null,\n        null, null,\n        null, null,\n        null, null\n    ];\n\n    this.depthCount[depth]++;\n\n    for (i = 0; i < 8; i++) {\n        var combination = octree.pattern[i];\n\n        this.children[i] = new OctreeNode(\n            [\n                (combination[0] === 0) ? min[0] : mid[0],\n                (combination[1] === 0) ? min[1] : mid[1],\n                (combination[2] === 0) ? min[2] : mid[2]\n            ],\n\n            [\n                (combination[0] === 0) ? mid[0] : max[0],\n                (combination[1] === 0) ? mid[1] : max[1],\n                (combination[2] === 0) ? mid[2] : max[2]\n            ]\n        );\n    }\n\n    var items = this.items;\n\n    //distribute items\n    if (items) {\n        for (i = 0, li = items.length; i < li; i++) {\n            var item = items[i];\n\n            for (j = 0; j < 8; j++) {\n                var child = this.children[j];\n                min = child.min;\n                max = child.max;\n\n                if (item[0] < max[0] && item[3] > min[0] &&\n                    item[1] < max[1] && item[4] > min[1] &&\n                    item[2] < max[2] && item[5] > min[2]) {\n\n                    //collision detected, add item\n                    child.add(item, octree);\n                }\n            }\n        }\n    }\n\n    this.items = null;   \n};\n\n\nvar OctreeRaycaster = function() {\n\n    // A lookup-table containing octant ids. Used to determine the exit plane from an octant.\n    this.octantTable = [\n        new Uint8Array([4, 2, 1]),\n        new Uint8Array([5, 3, 8]),\n        new Uint8Array([6, 8, 3]),\n        new Uint8Array([7, 8, 8]),\n        new Uint8Array([8, 6, 5]),\n        new Uint8Array([8, 7, 8]),\n        new Uint8Array([8, 8, 7]),\n        new Uint8Array([8, 8, 8])\n    ];\n\n    // A byte that stores raycasting flags.\n    this.flags = 0;\n};\n\n\n/**\n * Finds the entry plane of the first octant that a ray travels through.\n *\n * Determining the first octant requires knowing which of the t0s is the\n * largest. The tms of the other axes must also be compared against that\n * largest t0.\n * \n * tx0, ty0,tz0 - Ray projection parameter.\n * txm, tym, tzm - Ray projection parameter mean.\n * returns - index of the first octant that the ray travels through.\n */\n\nOctreeRaycaster.prototype.findEntryOctant = function(tx0, ty0, tz0, txm, tym, tzm) {\n    var entry = 0;\n\n    // Find the entry plane.\n    if(tx0 > ty0 && tx0 > tz0) {\n\n        // YZ-plane.\n        if (tym < tx0) {\n            entry |= 2;\n        }\n\n        if (tzm < tx0) {\n            entry |= 1;\n        }\n\n    } else if (ty0 > tz0) {\n\n        // XZ-plane.\n        if (txm < ty0) {\n            entry |= 4;\n        }\n\n        if (tzm < ty0) {\n            entry |= 1;\n        }\n\n    } else {\n\n        // XY-plane.\n        if (txm < tz0) {\n            entry |= 4;\n        }\n\n        if (tym < tz0) {\n            entry |= 2;\n        }\n    }\n\n    return entry;\n}\n\n/**\n * Finds the next octant that intersects with the ray based on the exit plane of\n * the current one.\n *\n * urrentOctant - The index of the current octant.\n * tx1, ty1, tz1 - Ray projection parameter.\n * returns - index of the next octant that the ray travels through.\n */\n\nOctreeRaycaster.prototype.findNextOctant = function(currentOctant, tx1, ty1, tz1) {\n    var min;\n    var exit = 0;\n\n    // Find the exit plane.\n    if (tx1 < ty1) {\n        min = tx1;\n        exit = 0; // YZ-plane.\n    } else {\n        min = ty1;\n        exit = 1; // XZ-plane.\n    }\n\n    if (tz1 < min) {\n        exit = 2; // XY-plane.\n    }\n\n    return this.octantTable[currentOctant][exit];\n}\n\n/**\n * Finds all octants that intersect with the given ray.\n *\n * octant - The current octant.\n * tx0 - Ray projection parameter. Initial tx0 = (minX - rayOriginX) / rayDirectionX.\n * ty0 - Ray projection parameter. Initial ty0 = (minY - rayOriginY) / rayDirectionY.\n * tz0 - Ray projection parameter. Initial tz0 = (minZ - rayOriginZ) / rayDirectionZ.\n * tx1 - Ray projection parameter. Initial tx1 = (maxX - rayOriginX) / rayDirectionX.\n * ty1 - Ray projection parameter. Initial ty1 = (maxY - rayOriginY) / rayDirectionY.\n * tz1 - Ray projection parameter. Initial tz1 = (maxZ - rayOriginZ) / rayDirectionZ.\n * intersects - An array to be filled with the intersecting octants.\n * returns\n */\n\nOctreeRaycaster.prototype.raycastOctant = function(octant, tx0, ty0, tz0, tx1, ty1, tz1, intersects) {\n    var children = octant.children;\n    var currentOctant;\n    var txm, tym, tzm;\n\n    if (tx1 >= 0.0 && ty1 >= 0.0 && tz1 >= 0.0) {\n\n        if (!children) {\n\n            // Leaf.\n            if (octant.items) {\n                intersects.push(octant);\n            }\n\n        } else {\n\n            // Compute means.\n            txm = 0.5 * (tx0 + tx1);\n            tym = 0.5 * (ty0 + ty1);\n            tzm = 0.5 * (tz0 + tz1);\n\n            currentOctant = this.findEntryOctant(tx0, ty0, tz0, txm, tym, tzm);\n\n            do {\n\n                /* The possibilities for the next node are passed in the same respective\n                 * order as the t-values. Hence, if the first value is found to be the\n                 * greatest, the fourth one will be returned. If the second value is the\n                 * greatest, the fifth one will be returned, etc.\n                 */\n\n                switch(currentOctant) {\n\n                    case 0:\n                        this.raycastOctant(children[this.flags], tx0, ty0, tz0, txm, tym, tzm, intersects);\n                        currentOctant = this.findNextOctant(currentOctant, txm, tym, tzm);\n                        break;\n\n                    case 1:\n                        this.raycastOctant(children[this.flags ^ 1], tx0, ty0, tzm, txm, tym, tz1, intersects);\n                        currentOctant = this.findNextOctant(currentOctant, txm, tym, tz1);\n                        break;\n\n                    case 2:\n                        this.raycastOctant(children[this.flags ^ 2], tx0, tym, tz0, txm, ty1, tzm, intersects);\n                        currentOctant = this.findNextOctant(currentOctant, txm, ty1, tzm);\n                        break;\n\n                    case 3:\n                        this.raycastOctant(children[this.flags ^ 3], tx0, tym, tzm, txm, ty1, tz1, intersects);\n                        currentOctant = this.findNextOctant(currentOctant, txm, ty1, tz1);\n                        break;\n\n                    case 4:\n                        this.raycastOctant(children[this.flags ^ 4], txm, ty0, tz0, tx1, tym, tzm, intersects);\n                        currentOctant = this.findNextOctant(currentOctant, tx1, tym, tzm);\n                        break;\n\n                    case 5:\n                        this.raycastOctant(children[this.flags ^ 5], txm, ty0, tzm, tx1, tym, tz1, intersects);\n                        currentOctant = this.findNextOctant(currentOctant, tx1, tym, tz1);\n                        break;\n\n                    case 6:\n                        this.raycastOctant(children[this.flags ^ 6], txm, tym, tz0, tx1, ty1, tzm, intersects);\n                        currentOctant = this.findNextOctant(currentOctant, tx1, ty1, tzm);\n                        break;\n\n                    case 7:\n                        this.raycastOctant(children[this.flags ^ 7], txm, tym, tzm, tx1, ty1, tz1, intersects);\n                        // Far top right octant. No other octants can be reached from here.\n                        currentOctant = 8;\n                        break;\n\n                }\n\n            } while(currentOctant < 8);\n\n        }\n\n    }\n\n}\n\nOctreeRaycaster.prototype.hitFace = function(origin, dir, index, vertices) {\n    var EPSILON = 0.0000001,\n        v1 = [vertices[index], vertices[index+1], vertices[index+2]],\n        v2 = [vertices[index+3], vertices[index+4], vertices[index+5]],\n        v3 = [vertices[index+6], vertices[index+7], vertices[index+8]];\n\n    var h = [0,0,0], q = [0,0,0], s, a, f, u, v,\n        edge1 = [v2[0] - v1[0], v2[1] - v1[1], v2[2] - v1[2]],\n        edge2 = [v3[0] - v1[0], v3[1] - v1[1], v3[2] - v1[2]];\n\n    vec3.cross(dir, edge2, h);\n    a = vec3.dot(edge1, h);\n\n    if (a > -EPSILON && a < EPSILON) {\n        return [false];\n    }\n\n    f = 1/a;\n    s = [origin[0] - v1[0], origin[1] - v1[1], origin[2] - v1[2]];\n    u = f * (vec3.dot(s, h));\n\n    if (u < 0.0 || u > 1.0) {\n        return [false];\n    }\n\n    q = vec3.cross(s, edge1);\n    v = f * vec3.dot(dir, q);\n    if (v < 0.0 || u + v > 1.0) {\n        return [false];\n    }\n\n    // At this stage we can compute t to find out where the intersection point is on the line.\n    var t = f * vec3.dot(edge2, q);\n    //if (t > EPSILON) { // ray intersection\n        return [true, t]; //[origin[0] + dir[0] * t, origin[1] + dir[1] * t, origin[2] + dir[2] * t ]];\n    //} else { // This means that there is a line intersection but not a ray intersection.\n     //   return [false];\n    //}\n};\n\n\n/**\n * Finds the octants that intersect with the given ray. The intersecting\n * octants are sorted by distance, closest first.\n *\n * octree - An octree.\n * intersects - A list to be filled with intersecting octants.\n */\n\n// https://github.com/vanruesc/sparse-octree/blob/master/src/core/OctreeRaycaster.js\n\nOctreeRaycaster.prototype.intersectOctree = function(rayPos, rayDir, octree, intersects) {\n    // Translate the octree extents to the scene origin.\n    var min = [0,0,0];\n    var max = [octree.root.max[0] - octree.root.min[0],\n               octree.root.max[1] - octree.root.min[1],\n               octree.root.max[2] - octree.root.min[2]] \n\n    var dimensions = [max[0], max[1], max[2]];\n    var halfDimensions = [dimensions[0]*0.5, dimensions[1]*0.5, dimensions[2]*0.5];\n\n    var origin = [rayPos[0],rayPos[1],rayPos[2]];\n    var direction = [rayDir[0], rayDir[1], rayDir[2]];\n\n    var invDirX, invDirY, invDirZ;\n    var tx0, tx1, ty0, ty1, tz0, tz1;\n\n    var center = [(octree.root.max[0] + octree.root.min[0]) * 0.5,\n                  (octree.root.max[1] + octree.root.min[1]) * 0.5,\n                  (octree.root.max[2] + octree.root.min[2]) * 0.5] \n\n    // Translate the ray to the center of the octree.\n    //origin.sub(octree.getCenter(v[2])).add(halfDimensions);\n    origin[0] = (origin[0] - center[0]) + halfDimensions[0]; \n    origin[1] = (origin[1] - center[1]) + halfDimensions[1]; \n    origin[2] = (origin[2] - center[2]) + halfDimensions[2]; \n\n    // Reset all flags.\n    this.flags = 0;\n\n    // Handle rays with negative directions.\n    if (direction[0] < 0.0) {\n        origin[0] = dimensions[0] - origin[0];\n        direction[0] = -direction[0];\n        this.flags |= 4;\n    }\n\n    if (direction[1] < 0.0) {\n        origin[1] = dimensions[1] - origin[1];\n        direction[1] = -direction[1];\n        this.flags |= 2;\n    }\n\n    if (direction[2] < 0.0) {\n        origin[2] = dimensions[2] - origin[2];\n        direction[2] = -direction[2];\n        this.flags |= 1;\n    }\n\n    // Improve IEEE double stability.\n    invDirX = 1.0 / direction[0];\n    invDirY = 1.0 / direction[1];\n    invDirZ = 1.0 / direction[2];\n\n    // Project the ray to the root's boundaries.\n    tx0 = (min[0] - origin[0]) * invDirX;\n    tx1 = (max[0] - origin[0]) * invDirX;\n    ty0 = (min[1] - origin[1]) * invDirY;\n    ty1 = (max[1] - origin[1]) * invDirY;\n    tz0 = (min[2] - origin[2]) * invDirZ;\n    tz1 = (max[2] - origin[2]) * invDirZ;\n\n    // Check if the ray hits the octree.\n    if (Math.max(Math.max(tx0, ty0), tz0) < Math.min(Math.min(tx1, ty1), tz1)) {\n        // Find the intersecting octants.\n        this.raycastOctant(octree.root, tx0, ty0, tz0, tx1, ty1, tz1, intersects);\n    }\n};\n\nOctreeRaycaster.prototype.intersectOctants = function(rayPos, rayDir, octants) {\n    var hits = [];\n    var t = Number.POSITIVE_INFINITY;\n\n    for (var i = 0, li = octants.length; i < li; i++) {\n        var items = octants[i].items;\n\n        for (var j = 0, lj = items.length; j < lj; j++) {\n            var item = items[j];\n            var res = this.hitFace(rayPos, rayDir, item[7], item[6]);\n\n            if (res[0] && res[1] < t) {\n                t = res[1];\n            }\n        }\n    }\n\n    if (t !== Number.POSITIVE_INFINITY) {\n        hits = [t];\n    }\n\n    return hits;\n};\n\nexport {Octree, OctreeRaycaster};\n","\nimport GpuTexture_ from './gpu/texture';\nimport GpuMesh_ from './gpu/mesh';\nimport GpuProgram_ from './gpu/program';\nimport {Octree as Octree_, OctreeRaycaster as OctreeRaycaster_} from './octree.js';\n\n//get rid of compiler mess\nvar GpuTexture = GpuTexture_;\nvar GpuMesh = GpuMesh_;\nvar GpuProgram = GpuProgram_;\nvar Octree = Octree_;\nvar OctreeRaycaster = OctreeRaycaster_;\n\nvar RendererInterface = function(renderer) {\n    this.renderer = renderer;\n    this.gpu = renderer.gpu;\n};\n\n\nRendererInterface.prototype.clear = function(options) {\n    if (options != null) {\n        this.gpu.clear((options['clearDepth'] || true),\n                        (options['clearColor'] || false),\n                        (options['color'] || [255,255,255,255]),\n                        ((options['depth'] != null) ? options['depth'] : 1.0) );\n    }\n    return this;    \n};\n\n\nRendererInterface.prototype.createState = function(options) {\n    if (options == null || typeof options !== 'object') {\n        return this;    \n    }\n    \n    var stateOptions = {\n        blend : (options['blend'] != null) ? options['blend'] : false,\n        stencil : (options['stencil'] != null) ? options['stencil'] : false,\n        zoffset : (options['zoffset'] != null) ? options['zoffset'] : 0,\n        zwrite : (options['zwrite'] != null) ? options['zwrite'] : true,\n        ztest : (options['ztest'] != null) ? options['ztest'] : true,\n        zequal : (options['zequal'] != null) ? options['zequal'] : true,\n        culling : (options['culling'] != null) ? options['culling'] : true\n    };\n\n    return this.gpu.createState(stateOptions);\n};\n\n\nRendererInterface.prototype.setState = function(state) {\n    if (state != null) {\n        this.gpu.setState(state);\n    }\n    return this;    \n};\n\n\nRendererInterface.prototype.createTexture = function(options) {\n    if (options == null || typeof options !== 'object') {\n        return null;\n    }\n\n    var source = options['source'];\n    if (source == null) {\n        return null;\n    }\n\n    var filter = options['filter'] || 'linear';\n    var repeat = options['repeat'] || false, texture;\n\n    if (source instanceof Uint8Array) {\n        var width = options['width'];\n        var height = options['height'];\n\n        if (width && height) {\n            texture = new GpuTexture(this.gpu);\n            texture.createFromData(width, height, source, filter, repeat);\n            return texture;\n        }\n    }\n\n    if (source instanceof Image) {\n        texture = new GpuTexture(this.gpu);\n        texture.createFromImage(source, filter, repeat);\n        return texture;\n    }\n\n    return null;\n};\n\n\nRendererInterface.prototype.removeTexture = function(texture) {\n    if (texture) {\n        texture.kill();\n    }\n    return this;    \n};\n\n\nRendererInterface.prototype.createMesh = function(options) {\n    if (options == null || typeof options !== 'object') {\n        return null;\n    }\n\n    var data = {\n        vertices : options['vertices'],\n        uvs : options['uvs'],\n        uvs2 : options['normals'],\n        vertexSize : options['vertexSize'],\n        uvSize : options['uvSize'],\n        uv2Size : options['normalSize'] || 3,\n        vertexAttr : options['vertexAttr'],\n        uvAttr : options['uvAttr'],\n        uv2Attr : options['normalAttr'],\n        bbox : options['bbox']\n    };\n\n    return new GpuMesh(this.gpu, data, 0, this.renderer.core);\n};\n\n\nRendererInterface.prototype.removeMesh = function(mesh) {\n    if (mesh) {\n        mesh.kill();\n    }\n    return this;    \n};\n\n\nRendererInterface.prototype.createShader = function(options) {\n    if (options == null || typeof options !== 'object') {\n        return null;\n    }\n\n    var vertexShader = options['vertexShader'];\n    var fragmentShader = options['fragmentShader'];\n\n    if (vertexShader != null && fragmentShader) {\n        return new GpuProgram(this.gpu, vertexShader, fragmentShader);\n    }\n};\n\n\nRendererInterface.prototype.removeResource = function(resource) {\n    if (resource != null && resource.kill != null) {\n        resource.kill();\n    }\n    return this;    \n};\n\n\nRendererInterface.prototype.addJob = function(/*options*/) {\n    return this;    \n};\n\n\nRendererInterface.prototype.clearJobs = function(/*options*/) {\n    return this;    \n};\n\n\nRendererInterface.prototype.drawMesh = function(options) {\n    if (options == null || typeof options !== 'object') {\n        return this;    \n    }\n\n    if (!options['mesh'] == null || !options['shaderVariables']) {\n        return this;    \n    }\n\n    //var shaderAttributes = options['shaderAttributes'];\n    var vertexAttr = options['vertex'] || 'aPosition';\n    var uvAttr = options['uv'] || 'aTexCoord';\n    var uv2Attr = options['normal'] || 'aNormal';\n    var depthOffset = (options['depthOffset'] != null) ? options['depthOffset'] : null;\n\n    var shaderVariables = options['shaderVariables'];\n    var shader = options['shader'] || 'textured';\n\n   \n    var renderer = this.renderer; \n    var mesh = options['mesh'];\n    var texture = options['texture'];\n    var mv = renderer.camera.getModelviewMatrix();\n    var proj = renderer.camera.getProjectionMatrix();\n    var fogDensity = renderer.fogDensity;\n    \n    if (typeof shader === 'string') {\n        switch(shader) {\n        case 'hit':\n\n            if (!shaderVariables['uMV']) {\n                shaderVariables['uMV'] = ['mat4', mv];\n            } \n\n            if (!shaderVariables['uProj']) {\n                shaderVariables['uProj'] = ['mat4', proj];\n            } \n\n            uvAttr = null;\n            uv2Attr = null;\n            texture = null;\n            shader = renderer.progDepthTile[0];\n            break;\n\n        case 'shaded':\n            uvAttr = null;\n\n        // eslint-disable-next-line\n        case 'textured':\n        case 'textured-and-shaded':\n\n            if (!shaderVariables['uMV']) {\n                shaderVariables['uMV'] = ['mat4', mv];\n            } \n\n            if (!shaderVariables['uProj']) {\n                shaderVariables['uProj'] = ['mat4', proj];\n            } \n\n            if (!shaderVariables['uFogDensity']) {\n                shaderVariables['uFogDensity'] = ['float', fogDensity];\n            } \n            \n            uv2Attr = (shader == 'textured') ? null : 'aNormal';\n            shader = (shader == 'textured') ? renderer.progTile[0] : ((shader == 'shaded') ? renderer.progShadedTile : renderer.progTShadedTile);\n            break;\n        }\n    }\n\n    if (!shader || !shader.isReady()) {\n        return;\n    }\n\n    var attributes = [vertexAttr];\n    if (uvAttr){\n        attributes.push(uvAttr);        \n    } \n    if (uv2Attr){\n        attributes.push(uv2Attr);        \n    } \n\n    renderer.gpu.useProgram(shader, attributes);\n\n    for (var key in shaderVariables) {\n        var item = shaderVariables[key];\n        \n        if (item.length == 2) {\n            switch(item[0]){\n            case 'floatArray':\n                shader.setFloatArray(key, item[1]);\n                break;\n            case 'float':\n                shader.setFloat(key, item[1]);\n                break;\n            case 'mat3':\n                shader.setMat3(key, item[1]);\n                break;\n            case 'mat4':\n                if (depthOffset && key == 'uProj') {\n                    shader.setMat4(key, item[1], renderer.getZoffsetFactor(depthOffset));\n                } else {\n                    shader.setMat4(key, item[1]);\n                }\n                break;\n            case 'vec2':\n                shader.setVec2(key, item[1]);\n                break;\n            case 'vec3':\n                shader.setVec3(key, item[1]);\n                break;\n            case 'vec4':\n                shader.setVec4(key, item[1]);\n                break;\n            case 'sampler':\n                shader.setSampler(key, item[1]);\n                break;\n            } \n        }\n    }\n\n    if (texture) {\n        renderer.gpu.bindTexture(texture);\n    }\n    \n    //mesh.draw(shader, vertexAttr, texture ? uvAttr : null, uv2Attr, null);\n    mesh.draw(shader, vertexAttr, uvAttr, uv2Attr, null);\n    return this;    \n};\n\n\nRendererInterface.prototype.drawImage = function(options) {\n    if (options == null || typeof options !== 'object') {\n        return this;    \n    }\n\n    if (options['texture'] == null || options['rect'] == null) {\n        return this;    \n    }\n\n    var rect = options['rect'];\n    var color = options['color'] || [255,255,255,255];\n    var depth = (options['depth'] != null) ? options['depth'] : 0;\n    var depthOffset = (options['depthOffset'] != null) ? options['depthOffset'] : null;\n    var depthTest = (options['depthTest'] != null) ? options['depthTest'] : false;\n    var blend = (options['blend'] != null) ? options['blend'] : false;\n    var writeDepth = (options['writeDepth'] != null) ? options['writeDepth'] : false;\n    var useState = (options['useState'] != null) ? options['useState'] : false;\n    color = [ color[0] * (1.0/255), color[1] * (1.0/255), color[2] * (1.0/255), color[3] * (1.0/255) ];\n\n    this.renderer.draw.drawImage(rect[0], rect[1], rect[2], rect[3], options['texture'], color, depth, depthOffset, depthTest, blend, writeDepth, useState);\n    return this;    \n};\n\n\nRendererInterface.prototype.drawBillboard = function(options) {\n    if (options == null || typeof options !== 'object') {\n        return this;    \n    }\n\n    if (options['texture'] == null || options['mvp'] == null) {\n        return this;    \n    }\n\n    var mvp = options['mvp'];\n    var color = options['color'] || [255,255,255,255];\n    var depthOffset = (options['depthOffset'] != null) ? options['depthOffset'] : null;\n    var depthTest = (options['depthTest'] != null) ? options['depthTest'] : false;\n    var blend = (options['blend'] != null) ? options['blend'] : false;\n    var writeDepth = (options['writeDepth'] != null) ? options['writeDepth'] : false;\n    var useState = (options['useState'] != null) ? options['useState'] : false;\n    color[0] *= 1.0/255;\n    color[1] *= 1.0/255;\n    color[2] *= 1.0/255;\n    color[3] *= 1.0/255;\n\n    this.renderer.draw.drawBillboard(mvp, options['texture'], color, depthOffset, depthTest, blend, writeDepth, useState);\n    return this;    \n};\n\n\nRendererInterface.prototype.drawLineString = function(options) {\n    if (options == null || typeof options !== 'object') {\n        return this;    \n    }\n\n    if (options['points'] == null) {\n        return this;    \n    }\n\n    var points = options['points'];\n    var color = options['color'] || [255,255,255,255];\n    var depthOffset = (options['depthOffset'] != null) ? options['depthOffset'] : null;\n    var size = options['size'] || 2;\n    var screenSpace = (options['screenSpace'] != null) ? options['screenSpace'] : true;\n    var depthTest = (options['depthTest'] != null) ? options['depthTest'] : false;\n    var blend = (options['blend'] != null) ? options['blend'] : false;\n    var writeDepth = (options['writeDepth'] != null) ? options['writeDepth'] : false;\n    var useState = (options['useState'] != null) ? options['useState'] : false;\n    color[0] *= 1.0/255;\n    color[1] *= 1.0/255;\n    color[2] *= 1.0/255;\n    color[3] *= 1.0/255;\n\n    this.renderer.draw.drawLineString(points, screenSpace, size, color, depthOffset, depthTest, blend, writeDepth, useState);\n    return this;    \n};\n\n\nRendererInterface.prototype.drawJobs = function(/*options*/) {\n    return this;    \n};\n\n\nRendererInterface.prototype.drawBBox = function(/*options*/) {\n    return this;    \n};\n\n\nRendererInterface.prototype.drawDebugText = function(options) {\n    if (options == null || typeof options !== 'object') {\n        return this;    \n    }\n\n    var text = options['text'];\n    var coords = options['coords'];\n\n    if (!text || !coords) {\n        return this;    \n    }\n    \n    var color = options['color'] || [255,255,255,255];\n    var size = options['size'] || 16;\n    var depth = options['depth'];\n    var useState = options['useState'] || false;\n    color[0] *= 1.0/255;\n    color[1] *= 1.0/255;\n    color[2] *= 1.0/255;\n    color[3] *= 1.0/255;\n\n    var lx = this.renderer.draw.getTextSize(size, text);\n\n    this.renderer.draw.drawText(coords[0] - (lx * 0.5), coords[1], size, text, color, depth, useState);\n\n    return this;    \n};\n\n\nRendererInterface.prototype.buildOctreeFromGeometry = function(geometry) {\n    var octree = new Octree();\n    octree.buildFromGeometry(geometry);\n    return octree;\n};\n\n\nRendererInterface.prototype.raycastOctreeGeometry = function(octree, rayPos, rayDir) {\n    var raycaster = new OctreeRaycaster(), intersects = [];\n    raycaster.intersectOctree(rayPos, rayDir, octree, intersects);\n    return raycaster.intersectOctants(rayPos, rayDir, intersects);\n};\n\nRendererInterface.prototype.saveScreenshot = function(output, filename, filetype) {\n    return this.renderer.saveScreenshot(output, filename, filetype);\n};\n\n\nRendererInterface.prototype.getCanvasCoords = function(point, mvp) {\n    return this.renderer.project2(point, mvp);\n};\n\n\nRendererInterface.prototype.getCanvasSize = function() {\n    return this.renderer.curSize.slice();\n};\n\n\nRendererInterface.prototype.setConfigParams = function(params) {\n    this.renderer.setConfigParams(params);\n    return this;\n};\n\n\nRendererInterface.prototype.setConfigParam = function(key, value) {\n    this.renderer.setConfigParam(key, value);\n    return this;\n};\n\n\nRendererInterface.prototype.getConfigParam = function(key) {\n    return this.renderer.getConfigParam(key);\n};\n\n\nRendererInterface.prototype.getGLInterface = function() {\n    return {\n        canvas : this.gpu.canvas,\n        gl : this.gpu.gl\n    };\n};\n\n\nRendererInterface.prototype.setSuperElevation = function(h1, f1, h2, f2) {\n    return this.renderer.setSuperElevation(h1, f1, h2, f2);\n};\n\n\nRendererInterface.prototype.setMarginFlags = function(flags) {\n    return this.renderer.marginFlags = flags;\n};\n\n\nRendererInterface.prototype.getMarginFlags = function() {\n    return this.renderer.marginFlags;\n};\n\n\nexport default RendererInterface;\n","\nimport {math as math_} from '../utils/math';\n\n//get rid of compiler mess\nvar math = math_;\n\n\nvar MapTrajectory = function(map, p1, p2, options) {\n    this.map = map;\n    this.p1 = p1.clone();\n    this.p2 = p2.clone();\n    this.op2 = p2.clone();\n\n    var hm1 = this.p1.getHeightMode();\n    var hm2 = this.p2.getHeightMode();\n    \n    if (hm1 == 'fix' && hm2 == 'float') {\n        this.p1 = this.map.convert.convertPositionHeightMode(this.p1, 'float', true);\n    } else if (hm1 == 'float' && hm2 == 'fix') {\n        this.p1 = this.map.convert.convertPositionHeightMode(this.p1, 'fix', true);\n    } \n    \n    var vm1 = this.p1.getViewMode();\n    var vm2 = this.p2.getViewMode();\n\n    if (vm1 == 'subj' && vm2 == 'obj') {\n        this.p2 = this.map.convert.convertPositionViewMode(this.p2, 'subj');\n    } else if (vm1 == 'obj' && vm2 == 'subj') {\n        this.p1 = this.map.convert.convertPositionViewMode(this.p1, 'subj');\n    } \n    \n    this.p1.pos[5] = this.p1.pos[5] < 0 ? (360 + (this.p1.pos[5] % 360)) : (this.p1.pos[5] % 360);  \n    this.p2.pos[5] = this.p2.pos[5] < 0 ? (360 + (this.p2.pos[5] % 360)) : (this.p2.pos[5] % 360);  \n    \n    this.pp1 = this.p1.clone();\n\n    this.mode = options['mode'] || 'auto';\n    this.submode = options['submode'] || 'none';\n    this.submode = 'none';\n    this.maxHeight = options['maxHeight'] || 1000000000;\n    this.minDuration = options['minDuration'] || 0;\n    this.maxDuration = options['maxDuration'] || 10000;\n    this.samplePeriod = options['samplePeriod'] || 10;\n    this.fade = options['fade'] || 'none';\n    this.fadePower = options['fadePower'] || 1;\n    this.yawInterpolation = options['yawInterpolation'] || 'shortest';\n\n    this.pv = options['pv'] || 0.15;\n\n    if (!this.map.getNavigationSrs().isProjected()) {\n        this.geodesic = this.map.measure.getGeodesic();\n    } \n    \n    if (options['distanceAzimuth']) {\n        this.distanceAzimuth = true;\n        \n        this.pp2 = this.p1.clone();\n        if (options['destHeight']) {\n            this.pp2.setHeight(options['destHeight']);\n        }\n\n        if (options['destOrientation']) {\n            this.pp2.setHeight(options['destOrientation']);\n        }\n        \n        if (options['destFov']) {\n            this.pp2.setHeight(options['destFov']);\n        }\n\n        this.geoAzimuth = options['azimuth'] || 0; \n        this.geoDistance = options['distance'] || 100;\n        this.distance = this.geoDistance; \n        this.azimuth = this.geoAzimuth % 360;\n        this.azimuth = (this.azimuth < 0) ? (360 + this.azimuth) : this.azimuth;\n\n    } else {\n        this.distanceAzimuth = false;\n            \n        this.pp2 = this.p2.clone();\n\n        //get distance and azimut\n        var res = this.map.measure.getDistance(this.pp1.getCoords(), this.pp2.getCoords());\n        this.distance = res[0];\n        this.azimuth = (res[1] + 90) % 360;\n        this.azimuth = (this.azimuth < 0) ? (360 + this.azimuth) : this.azimuth;\n\n        if (!this.map.getNavigationSrs().isProjected()) {\n            res = this.geodesic.Inverse(this.pp1.pos[2], this.pp1.pos[1], this.pp2.pos[2], this.pp2.pos[1]);\n            this.geoAzimuth = res.azi1; \n            this.geoDistance = res.s12;\n            this.azimuth = this.geoAzimuth % 360;\n            this.azimuth = (this.azimuth < 0) ? (360 + this.azimuth) : this.azimuth;\n        }\n    }\n    \n    //console.log(\"azim: \" + Math.round(this.azimuth) + \" p1: \" + this.p1.pos[5]  + \" p2: \" + this.p2.pos[5]);\n\n    this.detectMode();\n    this.detectDuration();\n    this.detectFlightHeight(options['height']);\n};\n\n\nMapTrajectory.prototype.detectFlightHeight = function(flightHeight) {\n    if (this.mode == 'ballistic') {\n        this.flightHeight = Math.max(this.pp1.getHeight(), this.pp2.getHeight());\n        this.flightHeight += flightHeight || (this.distance * 0.5);\n        this.flightHeight = Math.min(this.flightHeight, this.maxHeight);\n        this.flightHeight -= Math.max(this.pp1.getHeight(), this.pp2.getHeight());\n    }\n};\n\n\nMapTrajectory.prototype.detectMode = function() {\n    if (this.mode == 'auto') {\n        this.mode = (this.distance > 2000) ? 'ballistic' : 'direct';\n    }\n};\n\n\nMapTrajectory.prototype.detectDuration = function() {\n    this.duration = 0;\n    this.headingDuration = 1000;\n    \n    if (this.distance < 500) {\n        this.duration = 1000;\n    } else if (this.distance < 2000) {\n        this.duration = 2000;\n    } else {\n        this.duration = this.distance / 100;\n\n        if (this.duration < 300) {\n            this.duration = 3000;\n        } else {\n            this.headingDuration = 1500;\n        }\n        \n        if (this.duration < 6000) {\n            this.duration = 6000;\n        }\n\n        if (this.duration > 10000) {\n            this.duration = 10000;\n        }\n\n        if (this.mode != 'direct') {\n            this.duration *= 1.8;\n            this.headingDuration *= 1.8;\n        }\n    }\n    \n    if (this.mode != 'direct') {\n        var minDuration = 3 * this.headingDuration; \n        this.duration = Math.max(this.duration, minDuration);\n        \n        if (this.maxDuration < minDuration) {\n            this.duration = this.maxDuration;\n            this.headingDuration = this.maxDuration / 3;\n        }   \n    }    \n    \n    this.duration = Math.min(this.duration, this.maxDuration);\n    this.duration = Math.max(this.duration, this.minDuration);\n};\n\n    \nMapTrajectory.prototype.generate = function() {\n    var samples = new Array(Math.ceil(this.duration / this.samplePeriod)+(this.distanceAzimuth?0:1));\n    var index = 0;\n    \n    for (var time = 0; time <= this.duration; time += this.samplePeriod) {\n        var factor = time / this.duration;\n\n        var p = this.pp1.clone(), x, coords;\n        \n        if (this.mode == 'direct') {\n\n            x = factor;\n            \n            switch(this.fade) {\n            case 'in':\n                switch(this.fadePower) {\n                case 1: factor = x*x; break;\n                case 2: factor = x*x*x; break;\n                case 3: factor = x*x*x*x; break;\n                case 4: factor = x*x*x*x*x; break;\n                case 5: factor = x*x*x*x*x*x; break;\n                case 6: factor = x*x*x*x*x*x*x; break;\n                }\n                break;\n\n            case 'out':\n                x = 1 - x;\n                switch(this.fadePower) {\n                case 1: factor = 1 - (x*x); break;\n                case 2: factor = 1 - (x*x*x); break;\n                case 3: factor = 1 - (x*x*x*x); break;\n                case 4: factor = 1 - (x*x*x*x*x); break;\n                case 5: factor = 1 - (x*x*x*x*x*x); break;\n                case 6: factor = 1 - (x*x*x*x*x*x*x); break;\n                }\n                break;\n\n            case 'inout':\n                switch(this.fadePower) {\n                case 1: factor = x*x*(3 - 2*x); break;\n                case 2: factor = x*x*x * (x * (6*x - 15) + 10); break;\n                case 3: factor = x*x*(3 - 2*x); x = factor; factor = x*x*(3 - 2*x); break;\n                case 4: factor = x*x*x * (x * (6*x - 15) + 10); x = factor; factor = x*x*x * (x * (6*x - 15) + 10); break;\n                case 5: factor = x*x*(3 - 2*x); x = factor; factor = x*x*(3 - 2*x); x = factor; factor = x*x*(3 - 2*x); break;\n                case 6: factor = x*x*x * (x * (6*x - 15) + 10); x = factor; factor = x*x*x * (x * (6*x - 15) + 10); x = factor; factor = x*x*x * (x * (6*x - 15) + 10); break;\n                }\n                break;\n            }\n            \n            p.setCoords(this.getInterpolatedCoords(factor));\n            p.setHeight(this.getInterpolatedHeight(factor));\n            \n            var o1 = this.pp1.getOrientation(); \n            var o2 = this.pp2.getOrientation(); \n\n            p.setOrientation(this.getInterpolatedOrinetation(o1, o2, factor));\n            p.setFov(this.getInterpolatedFov(factor));\n            p.setViewExtent(this.getInterpolatedViewExtent(factor));\n            \n            samples[index] = p.pos;\n            index++;\n        } else {\n\n            //http://en.wikipedia.org/wiki/Smoothstep\n            x = factor;\n            factor =  x*x*(3 - 2*x);\n            x = factor;\n            factor =  x*x*(3 - 2*x);\n\n            //factor2 includes slow start and end of flight\n            var factor2 =  this.getSmoothFactor(time);\n            \n            if (this.submode == 'piha') {\n                \n                var distanceFactor = (this.distance / this.duration * (time - this.duration / (2 * Math.PI) * Math.sin(2 * Math.PI / this.duration * time))) / this.distance;\n\n                //var f = (time / this.duration) * Math.PI * 2;\n                //var distanceFactor = ((f - Math.sin(f)) / (2 * Math.PI));\n                \n                var pv = this.pv;\n                var h1 = this.pp1.getCoords()[2]; \n                var h2 = this.pp2.getCoords()[2]; \n\n                var height = this.distance / ((this.duration*0.001) * pv * Math.tan(math.radians(this.pp1.getFov()) * 0.5))\n                              * (1 - Math.cos(2 * Math.PI * time / this.duration))\n                              + h1 + (h2 - h1) * time  / this.duration;\n\n                coords = this.getInterpolatedCoords(distanceFactor);\n\n                p.setCoords(coords);\n                p.setHeight(height);            \n            } else {\n\n                coords = this.getInterpolatedCoords(factor2);\n    \n                p.setCoords(coords);\n                p.setHeight(this.getSineHeight(factor));            \n            }\n            \n            if (coords[3] != null) { //used for correction in planet mode\n                this.azimuth = -coords[3];\n            }\n\n            p.setOrientation(this.getFlightOrienation(time));\n            p.setFov(this.getInterpolatedFov(factor));\n            p.setViewExtent(this.getInterpolatedViewExtent(factor));\n            \n            //p.convertViewMode(\"subj\");\n            //console.log(\"pos: \" + p.toString());\n\n            samples[index] = p.pos;\n            samples[index] = p.pos;\n            index++;\n        }\n    }\n    \n    if (!this.distanceAzimuth) {\n        samples[index] = this.op2.clone().pos;\n    }\n\n    //console.log(\"pos2: \" + this.p2.toString());\n\n    return samples;\n};\n\n\nMapTrajectory.prototype.getInterpolatedCoords = function(factor) {\n    var c1 = this.pp1.getCoords(); \n    var c2 = this.pp2.getCoords(); \n\n    if (!this.map.getNavigationSrs().isProjected()) {\n        var res = this.geodesic.Direct(c1[1], c1[0], this.geoAzimuth, this.geoDistance * factor);\n\n        var azimut = res.azi1 - res.azi2;\n\n        //var azimut = (azimut - 90) % 360;\n        azimut = (this.azimuth < 0) ? (360 + azimut) : azimut;\n\n        //azimut = this.azimuth;\n\n\n        return [ res.lon2, res.lat2,\n            c1[2] + (c2[2] - c1[2]) * factor, azimut];\n\n    } else {\n        return [ c1[0] + (c2[0] - c1[0]) * factor,\n            c1[1] + (c2[1] - c1[1]) * factor,\n            c1[2] + (c2[2] - c1[2]) * factor ];\n    }\n};\n\n\nMapTrajectory.prototype.getInterpolatedOrinetation = function(o1, o2, factor) {\n    var od1 = o2[0] - o1[0];\n    var od2 = o2[1] - o1[1];\n    var od3 = o2[2] - o1[2];\n\n    if (this.yawInterpolation == 'shortest') {\n        if (Math.abs(od1) > 180) {\n            if (od1 > 0) {\n                od1 = -(360 - od1);\n            } else {\n                od1 = 360 - Math.abs(od1);\n            }\n        }\n    }\n\n    return [ o1[0] + od1 * factor,\n        o1[1] + od2 * factor,\n        o1[2] + od3 * factor ];\n};\n\n\nMapTrajectory.prototype.getInterpolatedFov = function(factor) {\n    var f1 = this.pp1.getFov(); \n    var f2 = this.pp2.getFov(); \n    return f1 + (f2 - f1) * factor;\n};\n\n\nMapTrajectory.prototype.getInterpolatedViewExtent = function(factor) {\n    var v1 = this.pp1.getViewExtent(); \n    var v2 = this.pp2.getViewExtent(); \n    return v1 + (v2 - v1) * factor;\n};\n\n\nMapTrajectory.prototype.getInterpolatedHeight = function(factor) {\n    var h1 = this.pp1.getHeight(); \n    var h2 = this.pp2.getHeight(); \n    return h1 + (h2 - h1) * factor;\n};\n\n\nMapTrajectory.prototype.getSineHeight = function(factor) {\n    var c1 = this.pp1.getCoords(); \n    var c2 = this.pp2.getCoords(); \n\n    return c1[2] + (c2[2] - c1[2]) * factor +\n           Math.sin(Math.PI * factor) * this.flightHeight;\n};\n\n\nMapTrajectory.prototype.getSmoothFactor = function(time) {\n    var x = 0;\n\n    if (time < this.headingDuration) {\n        x = 0;\n    } else if (time > (this.duration - this.headingDuration)) {\n        x = 1.0;\n    } else {\n        x = Math.min(1.0, (time-this.headingDuration) / (this.duration - this.headingDuration*2));\n    }\n\n    x = x*x*(3 - 2*x);\n    return x*x*(3 - 2*x);\n};\n\n\nMapTrajectory.prototype.getFlightOrienation = function(time) {\n    var o1 = null;\n    var o2 = null;\n    var fo = [0, -90, 0]; //flight orientation\n    var factor = 0;\n\n    //get fly direction angle\n    fo[0] = this.azimuth % 360;\n\n    if (fo[0] < 0) {\n        fo[0] = 360 - Math.abs(fo[0]);\n    }\n\n    if (time <= this.headingDuration) { //start sequence\n        factor = time / this.headingDuration;\n        o1 = this.pp1.getOrientation();\n        o2 = fo;\n    } else if (time >= this.duration - this.headingDuration) { //end sequence\n        factor = (time - (this.duration - this.headingDuration)) / this.headingDuration;\n        o1 = fo;\n        o2 = this.pp2.getOrientation();\n    } else { //fly sequence\n        factor = 0;\n        o1 = fo;\n        o2 = fo;\n    }    \n    \n    return this.getInterpolatedOrinetation(o1, o2, factor);\n};\n\n\nexport default MapTrajectory;\n\n\n\n","\nimport MapTrajectory_ from './trajectory';\nimport MapBoundLayer_ from './bound-layer';\nimport MapSurface_ from './surface';\nimport MapPosition_ from './position';\nimport MapGeodataBuilder_ from './geodata-builder';\n\n//get rid of compiler mess\nvar MapTrajectory = MapTrajectory_;\nvar MapBoundLayer = MapBoundLayer_;\nvar MapSurface = MapSurface_;\nvar MapPosition = MapPosition_;\nvar MapGeodataBuilder = MapGeodataBuilder_;\n\n\nvar MapInterface = function(map) {\n    this.map = map;\n    this.config = map.config;\n};\n\n\nMapInterface.prototype.setPosition = function(position) {\n    this.map.setPosition(position);\n    return this;    \n};\n\n\nMapInterface.prototype.getPosition = function() {\n    return this.map.getPosition();\n};\n\n\nMapInterface.prototype.setView = function(view, forceRefresh, posToFixed) {\n    this.map.setView(view, forceRefresh, posToFixed);\n    return this;    \n};\n\n\nMapInterface.prototype.getView = function() {\n    return this.map.getView();\n};\n\n\nMapInterface.prototype.getCredits = function() {\n    return this.map.getCredits();\n};\n\n\nMapInterface.prototype.getCurrentCredits = function() {\n    return this.map.getVisibleCredits();\n};\n\n\nMapInterface.prototype.getCreditInfo = function(creditId) {\n    var credit = this.map.getCreditById(creditId);\n    return credit ? credit.getInfo() : {};\n};\n\n\nMapInterface.prototype.getViews = function() {\n    return this.map.getNamedViews();\n};\n\n\nMapInterface.prototype.getViewInfo = function(viewId) {\n    var view = this.map.getNamedView(viewId);\n    return view ? view.getInfo() : {};\n};\n\n\nMapInterface.prototype.getBoundLayers = function() {\n    return this.map.getBoundLayers();\n};\n\n\nMapInterface.prototype.getBoundLayerInfo = function(layerId) {\n    return this.map.getBoundLayerInfo(layerId);\n};\n\n\nMapInterface.prototype.getFreeLayers = function() {\n    return this.map.getFreeLayers();\n};\n\n\nMapInterface.prototype.getFreeLayerInfo = function(layerId) {\n    var layer = this.map.getFreeLayer(layerId);\n    return layer ? layer.getInfo() : {};\n};\n\n\nMapInterface.prototype.getSurfaces = function() {\n    return this.map.getSurfaces();\n};\n\n\nMapInterface.prototype.getSurfaceInfo = function(surfaceId) {\n    var surface = this.map.getFreeLayer(surfaceId);\n    return surface ? surface.getInfo() : {};\n};\n\n\nMapInterface.prototype.getSrses = function() {\n    return this.map.getSrses();\n};\n\n\nMapInterface.prototype.getSrsInfo = function(srsId) {\n    var srs = this.map.getSrs(srsId);\n    return srs ? srs.getInfo() : {};\n};\n\n\nMapInterface.prototype.getReferenceFrame = function() {\n    return this.map.referenceFrame.getInfo();\n};\n\n\nMapInterface.prototype.addFreeLayer = function(id, options) {\n    var layer = new MapSurface(this.map, options, 'free');\n    this.map.addFreeLayer(id, layer);\n};\n\n\nMapInterface.prototype.removeFreeLayer = function(id) {\n    this.map.removeFreeLayer(id); \n};\n\n\n/* MapInterface.prototype.setFreeLayerOptions = function(id, options) {\n    this.map.setFreeLayerOptions(id, options); \n};\n\n\nMapInterface.prototype.getFreeLayerOptions = function(id) {\n    return this.map.getFreeLayerOptions(id); \n}; */\n\n\nMapInterface.prototype.addBoundLayer = function(id, options) {\n    var layer = new MapBoundLayer(this.map, options, id);\n    this.map.addBoundLayer(id, layer); \n};\n\n\nMapInterface.prototype.removeBoundLayer = function(id) {\n    this.map.removeBoundLayer(id); \n};\n\n\n/* MapInterface.prototype.setBoundLayerOptions = function(id, options) {\n    this.map.setBoundLayerOptions(id, options); \n};\n\n\nMapInterface.prototype.getBoundLayerOptions = function(id) {\n    return this.map.setBoundLayerOptions(id); \n};*/\n\nMapInterface.prototype.convertPositionViewMode = function(position, mode) {\n    return this.map.convert.convertPositionViewMode((new MapPosition(position)), mode);\n};\n\n\nMapInterface.prototype.convertPositionHeightMode = function(position, mode, noPrecisionCheck) {\n    return this.map.convert.convertPositionHeightMode((new MapPosition(position)), mode, noPrecisionCheck);\n};\n\n\nMapInterface.prototype.convertCoords = function(sourceSrs, destinationSrs, coords) {\n    var srs = this.map.getSrs(sourceSrs);\n    var srs2 = this.map.getSrs(destinationSrs);\n    if (!srs || !srs2) {\n        return null;\n    }\n\n    return srs2.convertCoordsFrom(coords, srs);\n};\n\n\nMapInterface.prototype.convertCoordsFromNavToPublic = function(pos, mode, lod) {\n    var p = ['obj', pos[0], pos[1], mode, pos[2], 0, 0, 0, 10, 45 ];\n    return this.map.convert.getPositionPublicCoords((new MapPosition(p)), lod);\n};\n\n\nMapInterface.prototype.convertCoordsFromPublicToNav = function(pos, mode, lod) {\n    var p = ['obj', pos[0], pos[1], mode, pos[2], 0, 0, 0, 10, 45 ];\n    return this.map.convert.getPositionNavCoordsFromPublic((new MapPosition(p)), lod);\n};\n\n\nMapInterface.prototype.convertCoordsFromPhysToPublic = function(pos, containsSE) {\n    if (containsSE && this.map.renderer.useSuperElevation) {\n        var p = this.map.renderer.transformPointBySE(pos);\n        return this.map.convert.convertCoords(p, 'physical', 'public');\n    } else {\n        return this.map.convert.convertCoords(pos, 'physical', 'public');\n    }\n};\n\n\nMapInterface.prototype.convertCoordsFromNavToPhys = function(pos, mode, lod, includeSE) {\n    var p = ['obj', pos[0], pos[1], mode, pos[2], 0, 0, 0, 10, 45 ];\n    return this.map.convert.getPositionPhysCoords((new MapPosition(p)), lod, includeSE);\n};\n\n\nMapInterface.prototype.convertCoordsFromPhysToNav = function(pos, mode, lod, containsSE) {\n    return this.map.convert.convertCoordsFromPhysToNav(pos, mode, lod, containsSE);\n};\n\n\nMapInterface.prototype.convertCoordsFromNavToCanvas = function(pos, mode, lod) {\n    var p = ['obj', pos[0], pos[1], mode, pos[2], 0, 0, 0, 10, 45 ];\n    return this.map.convert.getPositionCanvasCoords((new MapPosition(p)), lod);\n};\n\n\nMapInterface.prototype.convertCoordsFromPhysToCanvas = function(pos, containsSE) {\n    var p = ['obj', pos[0], pos[1], 'fix', pos[2], 0, 0, 0, 10, 45 ];\n    return this.map.convert.getPositionCanvasCoords((new MapPosition(p)), null, true, containsSE);\n};\n\n\nMapInterface.prototype.convertCoordsFromNavToCameraSpace = function(pos, mode, lod) {\n    var p = ['obj', pos[0], pos[1], mode, pos[2], 0, 0, 0, 10, 45 ];\n    return this.map.convert.getPositionCameraSpaceCoords((new MapPosition(p)), lod);\n};\n\n\nMapInterface.prototype.convertCoordsFromPhysToCameraSpace = function(pos) {\n    var p = this.map.camera.position;\n    return [pos[0] - p[0], pos[1] - p[1], pos[2] - p[2]];\n};\n\n\nMapInterface.prototype.transformPhysCoordsBySE = function(pos) {\n    return this.map.convert.transformPhysCoordsBySE(pos);\n};\n\n\nMapInterface.prototype.getPositionCanvasCoords = function(position, lod) {\n    return this.map.convert.getPositionCanvasCoords(new MapPosition(position), lod);\n};\n\n\nMapInterface.prototype.getPositionCameraCoords = function(position, mode) {\n    return this.map.convert.getPositionCameraCoords(new MapPosition(position), mode);\n};\n\n\nMapInterface.prototype.movePositionCoordsTo = function(position, azimuth, distance, skipOrientation) {\n    return this.map.convert.movePositionCoordsTo(new MapPosition(position), azimuth, distance, skipOrientation);\n};\n\n\nMapInterface.prototype.getGeodesicLinePoints = function(coords, coords2, height, density) {\n    return this.map.convert.getGeodesicLinePoints(coords, coords2, height, density);\n};\n\n\nMapInterface.prototype.getSurfaceHeight = function(coords, precision) {\n    return this.map.measure.getSurfaceHeight(coords, this.map.measure.getOptimalHeightLodBySampleSize(coords, precision));\n};\n\n\nMapInterface.prototype.getSurfaceAreaGeometry = function(coords, radius, mode, limit, callback, loadTextures) {\n    var res = this.map.measure.getSurfaceAreaGeometry(coords, radius, mode, limit, true, loadTextures);\n    //console.log('getSurfaceAreaGeometry');\n\n    if (!res[0]) {\n        return this.map.core.once('map-update', this.getSurfaceAreaGeometry.bind(this, coords, radius, mode, limit, callback, loadTextures), 1);\n    } else {\n        var buffer = res[1], ret = [], map = this.map;        \n\n        if (map.tree) {\n            map.storedTilesRes = [];\n            map.tree.storeGeometry(buffer, buffer.length);\n            ret = map.storedTilesRes;\n            map.storedTilesRes = [];\n        }\n\n        callback(ret);\n        return (function(){});\n    }\n};\n\n\nMapInterface.prototype.getDistance = function(coords, coords2, includingHeights, usePublic) {\n    return this.map.measure.getDistance(coords, coords2, includingHeights, usePublic);\n};\n\n\nMapInterface.prototype.getAzimuthCorrection = function(coords, coords2) {\n    return this.map.measure.getAzimuthCorrection(coords, coords2);\n};\n\n\nMapInterface.prototype.getNED = function(coords, onlyMatrix) {\n    return this.map.measure.getNewNED(coords, (onlyMatrix === false) ? false : true);\n};\n\n\nMapInterface.prototype.getCameraInfo = function() {\n    var camera = this.map.camera;\n    return {\n        'projectionMatrix' : camera.camera.projection.slice(),\n        'viewMatrix' : camera.camera.modelview.slice(),\n        'viewProjectionMatrix' : camera.camera.mvp.slice(),\n        'rotationMatrix' : camera.camera.rotationview.slice(),\n        'position' : this.map.camera.position.slice(),\n        'vector' : this.map.camera.vector.slice(),\n        'distance' : this.map.camera.distance,\n        'height' : this.map.camera.height\n    };\n};\n\n\nMapInterface.prototype.isPointInsideCameraFrustum = function(point) {\n    return this.map.camera.camera.pointVisible(point, this.map.camera.position);\n};\n\n\nMapInterface.prototype.isBBoxInsideCameraFrustum = function(bbox) {\n    return this.map.camera.camera.bboxVisible({min:bbox[0], max:bbox[1]}, this.map.camera.position);\n};\n\n\nMapInterface.prototype.generateTrajectory = function(p1, p2, options) {\n    p1 = new MapPosition(p1);\n    p2 = new MapPosition(p2);\n    return (new MapTrajectory(this.map, p1, p2, options)).generate();\n};\n\n\nMapInterface.prototype.generatePIHTrajectory = function(position, azimuth, distance, options) {\n    var p = new MapPosition(position);\n    options['distance'] = distance;\n    options['azimuth'] = azimuth;\n    options['distanceAzimuth'] = true;\n    return (new MapTrajectory(this.map, p, p, options)).generate();\n};\n\n\nMapInterface.prototype.setConfigParams = function(params) {\n    this.map.setConfigParams(params);\n    return this;\n};\n\n\nMapInterface.prototype.setConfigParam = function(key, value) {\n    this.map.setConfigParam(key, value);\n    return this;\n};\n\n\nMapInterface.prototype.getConfigParam = function(key) {\n    return this.map.getConfigParam(key);\n};\n\n\nMapInterface.prototype.redraw = function() {\n    this.map.markDirty();\n    return this;\n};\n\n\nMapInterface.prototype.addRenderSlot = function(id, callback, enabled) {\n    this.map.renderSlots.addRenderSlot(id, callback, enabled);\n    return this;    \n};\n\n\nMapInterface.prototype.moveRenderSlotBefore = function(whichId, whereId) {\n    this.map.renderSlots.moveRenderSlotBefore(whichId, whereId);\n    return this;    \n};\n\n\nMapInterface.prototype.moveRenderSlotAfter = function(whichId, whereId) {\n    this.map.renderSlots.moveRenderSlotAfter(whichId, whereId);\n    return this;    \n};\n\n\nMapInterface.prototype.removeRenderSlot = function(id) {\n    this.map.renderSlots.removeRenderSlot(id);\n    return this;    \n};\n\n\nMapInterface.prototype.setRenderSlotEnabled = function(id, state) {\n    this.map.renderSlots.setRenderSlotEnabled(id, state);\n    return this;    \n};\n\n\nMapInterface.prototype.getRenderSlotEnabled = function(id) {\n    return this.map.renderSlots.getRenderSlotEnabled(id);\n};\n\n\nMapInterface.prototype.setLoaderSuspended = function(state) {\n    this.map.loaderSuspended = state;\n    return this;\n};\n\n\nMapInterface.prototype.getLoaderSuspended = function() {\n    return this.map.loaderSuspended;\n};\n\n\nMapInterface.prototype.getGpuCache = function() {\n    return this.map.gpuCache;\n};\n\n\nMapInterface.prototype.getHitCoords = function(screenX, screenY, mode, lod) {\n    return this.map.getHitCoords(screenX, screenY, mode, lod);\n};\n\n\nMapInterface.prototype.getScreenRay = function(screenX, screenY) {\n    return this.map.getScreenRay(screenX, screenY);\n};\n\n\nMapInterface.prototype.renderToImage = function() {\n    return this.map.renderToImage();\n};\n\n\nMapInterface.prototype.getCurrentGeometry = function() {\n    return this.map.getCurrentGeometry();\n};\n\n\nMapInterface.prototype.getStats = function(switches) {\n    if (switches) {\n        return {\n            'maxZoom' : this.map.draw.debug.maxZoom\n        };\n    }\n\n    var busyWorkers = 0;\n    for (var i = 0, li = this.map.geodataProcessors; i < li; i++) {\n        if (this.map.geodataProcessors[i].busy) {\n            busyWorkers++;\n        }        \n    }\n\n    return {\n        'bestMeshTexelSize' : this.map.bestMeshTexelSize,\n        'bestGeodataTexelSize' : this.map.bestGeodataTexelSize, \n        'downloading' : this.map.loader.downloading.length,\n        'lastDownload' : this.map.loader.lastDownloadTime, \n        'surfaces' : this.map.tree.surfaceSequence.length,\n        'freeLayers' : this.map.freeLayerSequence.length,\n        'texelSizeFit' : this.map.texelSizeFit,\n        'loadMode' : this.map.config.mapLoadMode,\n        'processingTasks' : this.map.processingTasks.length,\n        'busyWorkers' : busyWorkers,\n        'dirty' : this.map.dirty,\n        'drawnTiles' : this.map.stats.drawnTiles,\n        'drawnGeodataTiles' : this.map.stats.drawnGeodataTiles,\n        'renderTime' : this.map.stats.rendererTime,\n        'frameTime' : this.map.stats.frameTime\n    };\n};\n\n\nMapInterface.prototype.click = function(screenX, screenY, state) {\n    this.map.click(screenX, screenY, state);\n};\n\n\nMapInterface.prototype.hover = function(screenX, screenY, persistent, state) {\n    this.map.hover(screenX, screenY, persistent, state);\n};\n\nMapInterface.prototype.createGeodata = function() {\n    return new MapGeodataBuilder(this.map);\n};\n\nMapInterface.prototype.getGeodataGeometry = function(id) {\n    return this.map.renderer.geometries[id];\n};\n\nMapInterface.prototype.setGeodataSelection = function(selection) {\n    this.map.renderer.geodataSelection = selection;\n    this.map.markDirty();\n    return this;\n};\n\nMapInterface.prototype.getGeodataSelection = function() {\n    return this.map.renderer.geodataSelection;\n};\n\n\nexport default MapInterface;\n","import Proj4 from 'melowntech-proj4';\nimport Map_ from './map/map';\nimport Inspector_ from './inspector/inspector';\nimport Renderer_ from './renderer/renderer';\nimport RendererInterface_ from './renderer/interface';\nimport MapPosition_ from './map/position';\nimport MapInterface_ from './map/interface';\nimport {utils as utils_} from './utils/utils';\nimport {utilsUrl as utilsUrl_} from './utils/url';\nimport {platform as platform_} from './utils/platform';\n\n//get rid of compiler mess\nvar Map = Map_;\nvar Inspector = Inspector_;\nvar Renderer = Renderer_;\nvar RendererInterface = RendererInterface_;\nvar MapPosition = MapPosition_;\nvar MapInterface = MapInterface_;\nvar utils = utils_;\nvar utilsUrl = utilsUrl_;\nvar platform = platform_;\n\n\nvar Core = function(element, config, coreInterface) {\n    var lang = navigator.languages ? navigator.languages[0] : (navigator.language || navigator.userLanguage);\n    this.killed = false;\n    this.config = {\n        map : null,\n        mapCache : 1100, //old value 900\n        mapGPUCache : 600, //old value 500, 360\n        mapMetatileCache : 60,\n        mapTexelSizeFit : 1.1,\n        mapMaxHiresLodLevels : 2,\n        mapDownloadThreads : 20,\n        mapMaxProcessingTime : 10, //1000*20,\n        mapMaxGeodataProcessingTime : 10,\n        mapMobileMode : false,\n        mapMobileModeAutodect : true,\n        mapMobileDetailDegradation : 1,\n        mapNavSamplesPerViewExtent : 4,\n        mapIgnoreNavtiles : false,\n        mapVirtualSurfaces : true,\n        mapAllowHires : true,\n        mapAllowLowres : true,\n        mapAllowSmartSwitching : true,\n        mapDisableCulling : false,\n        mapPreciseCulling : true,\n        mapHeightLodBlend : true,\n        mapHeightNodeBlend : true,\n        mapBasicTileSequence : false,\n        mapPreciseBBoxTest : false,\n        mapPreciseDistanceTest : false,\n        mapHeightfiledWhenUnloaded : true,\n        mapForceMetatileV3 : false,\n        mapSmartNodeParsing : true,\n        mapLoadErrorRetryTime : 3000,\n        mapLoadErrorMaxRetryCount : 3,\n        mapLoadMode : 'topdown', // 'topdown', 'downtop', 'fit', 'fitonly'\n        mapGeodataLoadMode : 'fit', // 'fitonly'\n        mapSplitMeshes : true, // used for topdown load mode\n        mapSplitMargin : 0.0025, // used for topdown load mode\n        mapSplitSpace : null, // used octant spliting demo\n        mapSplitLods : false, // used octant spliting demo\n        mapGridMode : 'linear', // 'flat'\n        mapGridSurrogatez : false,\n        mapGridUnderSurface: 0,\n        mapGridTextureLevel: -1,\n        mapGridTextureLayer: null, // 'bing\",\n        mapXhrImageLoad : true,\n        mapStoreLoadStats : false,\n        mapRefreshCycles : 3,\n        mapSoftViewSwitch : true,\n        mapSortHysteresis : true,\n        mapHysteresisWait : 0,\n        mapSeparateLoader : true,\n        mapGeodataBinaryLoad : true,\n        mapPackLoaderEvents : true,\n        mapParseMeshInWorker : true,\n        mapPackGeodataEvents : true,\n        mapCheckTextureSize : false,\n\n        mapFeatureStickMode : [1,1],\n\n        map16bitMeshes : true,\n        //mapOnlyOneUVs : true,\n        mapOnlyOneUVs : false,\n        mapIndexBuffers : true,\n        mapAsyncImageDecode : true,\n\n        mapFeatureGridCells : 31,\n        mapFeaturesPerSquareInch : 0.25, //0.6614,\n        mapFeaturesSortByTop : false,\n\n        mapFeaturesReduceMode : 'scr-count1', //have to be 'scr-count1' because of legacy https://rigel.mlwn.se/store/map-config/high-terrain/\n        mapFeaturesReduceParams : null,\n        mapFeaturesReduceFactor : 1,\n        mapFeaturesReduceFactor2 : 1,\n\n        mapDMapSize : 1024,\n        mapDMapMode : 1,\n\n        mapDegradeHorizon : false,\n        mapDegradeHorizonParams : [1, 1500, 97500, 3500], //[1, 3000, 15000, 7000],\n        //mapDefaultFont : '//cdn.melown.com/libs/vtsjs/fonts/noto-basic/1.0.0/noto.fnt',\n        mapDefaultFont : '/static/web_fonts/vts/noto.fnt',\n        mapFog : true,\n        mapNoTextures: false,\n        mapMetricUnits : !(lang == 'en' || lang.indexOf('en-') == 0),\n        mapLanguage : lang,\n        mapForceFrameTime: 0,\n        mapForcePipeline: 0,\n        mapLogGeodataStyles: true,\n        mapBenevolentMargins: false,\n\n        rendererAnisotropic : 0,\n        rendererAntialiasing : true,\n        rendererAllowScreenshots : false,\n        inspector : true,\n        authorization : null,\n        mario : false\n    };\n\n    this.configStorage = {};\n    this.element = element;\n    this.coreInterface = coreInterface;\n    //this.options = options;\n    this.ready = false;\n    this.listeners = [];\n    this.listenerCounter = 0;\n    this.tokenCookieHost = null;\n    this.tokenIFrame = null;\n    this.xhrParams = {};\n    this.inspector = (Inspector != null) ? (new Inspector(this)) : null;\n    this.setConfigParams(config);\n\n    this.map = null;\n    this.mapInterface = null;\n    this.renderer = new Renderer(this, this.element, null, this.onResize.bind(this), this.config);\n    this.rendererInterface = new RendererInterface(this.renderer);\n    this.proj4 = Proj4;\n    this.contextLost = false;\n\n    //platform detection\n    platform.init();\n    this.requestAnimFrame = (\n               window.requestAnimationFrame ||\n               window.webkitRequestAnimationFrame ||\n               window.mozRequestAnimationFrame ||\n               window.oRequestAnimationFrame ||\n               window.msRequestAnimationFrame ||\n               function(callback) {\n                   window.setTimeout(callback, 1000/60);\n               });\n\n    window.performance = window.performance || {};\n    performance.now = (function() {\n        return performance.now       ||\n               performance.mozNow    ||\n               performance.msNow     ||\n               performance.oNow      ||\n               performance.webkitNow ||\n               function() { return new Date().getTime(); };\n    })();\n\n    this.loadMap(this.config.map);\n\n    this.requestAnimFrame.call(window, this.onUpdate.bind(this));\n};\n\n\nCore.prototype.onResize = function() {\n    if (this.map != null) {\n        this.map.markDirty();\n    }\n};\n\n\nCore.prototype.loadMap = function(path) {\n    if (this.map != null) {\n        this.destroyMap();\n    }\n\n    if (path == null) {\n        return;\n    }\n\n    path = utilsUrl.getProcessUrl(path, window.location.href);\n\n    this.tokenCookieLoaded = true;\n    this.mapConfigData = null;\n    this.tokenExpiration = null;\n    this.tokenExpirationCallback = null;\n    this.tokenExpirationLoop = false;\n    this.tokenCanBeSkiped = true;\n    this.mapRunnig = false;\n\n    var onLoaded = (function() {\n        if (!(this.tokenCookieLoaded || this.tokenCanBeSkiped) || !this.mapConfigData || this.mapRunnig) {\n            return;\n        }\n\n        this.mapRunnig = true;\n        var data = this.mapConfigData;\n\n        this.callListener('map-mapconfig-loaded', data);\n\n        this.map = new Map(this, data, path, this.config, this.configStorage);\n        this.mapInterface = new MapInterface(this.map);\n        this.setConfigParams(this.map.browserOptions, true);\n        this.setConfigParams(this.configStorage);\n\n        if (this.config.position) {\n            this.map.setPosition(this.config.position);\n            this.config.position = null;\n        }\n\n        if (this.config.view) {\n            this.map.setView(this.config.view);\n            this.config.view = null;\n        }\n\n    }).bind(this);\n\n    var onMapConfigLoaded = (function(data) {\n        this.mapConfigData = data;\n        onLoaded();\n    }).bind(this);\n\n    var onMapConfigError = (function() {\n    }).bind(this);\n\n    //this.tokenLoaded = true;\n\n    var onAutorizationLoaded = (function(data) {\n        if (!data || (data && data['status'])) {\n            if (this.tokenCanBeSkiped) {\n                onLoadMapconfig(path);\n            }\n            return;\n        }\n\n        this.tokenLoaded = true;\n        this.xhrParams['token'] = data['token'];\n        this.xhrParams['tokenHeader'] = data['header'];\n        this.tokenExpiration = data['expires'] * 1000;\n        this.tokenExpirationCallback = (function(){\n            //this.tokenLoaded = false;\n            //this.tokenCookieLoaded = false;\n            this.tokenExpiration = null;\n            this.tokenExpirationLoop = true;\n            if (typeof this.config.authorization === 'string') {\n                utils.loadJSON(this.config.authorization, onAutorizationLoaded, onAutorizationError, null, utils.useCredentials, this.xhrParams);\n            } else {\n                this.config.authorization(onAutorizationLoaded);\n            }\n        }).bind(this);\n\n        if (!this.tokenExpirationLoop) {\n            onLoadMapconfig(path);\n        }\n\n        if (typeof this.config.authorization === 'string') {\n            onLoadImageCookie(data['cookieInjector'], this.config.authorization);\n        } else {\n            onLoadImageCookie(data['cookieInjector'], path);\n        }\n\n    }).bind(this);\n\n    var onAutorizationError = (function() {\n        // eslint-disable-next-line\n        console.log('auth token not loaded');\n\n        if (this.tokenCanBeSkiped) {\n            onLoadMapconfig(path);\n        }\n    }).bind(this);\n\n    var onImageCookieLoaded = (function() {\n        document.body.removeChild(this.tokenIFrame);\n        this.tokenIFrame = null;\n        this.tokenCookieLoaded = true;\n        onLoaded();\n    }).bind(this);\n\n    /*var onImageCookieError = (function() {\n        // eslint-disable-next-line\n        console.log('auth cookie not loaded');\n    }).bind(this);*/\n\n    //var baseUrl = path.split('?')[0].split('/').slice(0, -1).join('/')+'/';\n\n    var onLoadMapconfig = (function(path) {\n        utils.loadJSON(path, onMapConfigLoaded, onMapConfigError, null, utils.useCredentials, this.xhrParams);\n    }).bind(this);\n\n    var onLoadImageCookie = (function(url, originUrl) {\n        url = utilsUrl.getProcessUrl(url, originUrl);\n        this.tokenCookieHost = utilsUrl.getHost(url);\n        //utils.loadImage(url, onImageCookieLoaded, onImageCookieError);\n        var iframe = document.createElement('iframe');\n        this.tokenIFrame = iframe;\n        iframe.onload = onImageCookieLoaded;\n        iframe.src = url;\n        iframe.style.display = 'none';\n        document.body.appendChild(iframe);\n    }).bind(this);\n\n    //if (false && this.config.authorization) {\n    if (this.config.authorization) {\n        this.tokenCookieLoaded = false;\n\n        if (typeof this.config.authorization === 'string') {\n            utils.loadJSON(this.config.authorization, onAutorizationLoaded, onAutorizationError, null, utils.useCredentials, this.xhrParams);\n        } else {\n            this.config.authorization(onAutorizationLoaded);\n        }\n    } else {\n        onLoadMapconfig(path);\n    }\n};\n\n\nCore.prototype.destroy = function() {\n    if (this.killed) {\n        return;\n    }\n\n    this.destroyMap();\n    if (this.renderer) {\n        this.renderer.kill();\n    }\n    this.element = null;\n    this.killed = true;\n};\n\n\nCore.prototype.destroyMap = function() {\n    if (this.map) {\n        this.map.kill();\n        this.map = null;\n        this.mapInterface = null;\n        this.callListener('map-unloaded', {});\n    }\n};\n\n\nCore.prototype.getMap = function() {\n    return this.map;\n};\n\n\nCore.prototype.getMapInterface = function() {\n    return this.mapInterface;\n};\n\n\nCore.prototype.getRenderer = function() {\n    return this.renderer;\n};\n\n\nCore.prototype.getRendererInterface = function() {\n    return this.rendererInterface;\n};\n\n\nCore.prototype.getProj4 = function() {\n    return this.proj4;\n};\n\n\nCore.prototype.getOption = function(/*key, value*/) {\n};\n\n\nCore.prototype.setOption = function(/*key, value*/) {\n};\n\n\nCore.prototype.on = function(name, listener, wait, once) {\n    if (this.killed) { // || this.renderer == null) {\n        return;\n    }\n\n    if (listener == null) {\n        return;\n    }\n\n    this.listenerCounter++;\n    this.listeners.push({ name : name, listener : listener, id : this.listenerCounter, once: once, wait: wait ? wait : 0 });\n\n    return (function(id){ this.removeListener(id); }).bind(this, this.listenerCounter);\n};\n\n\nCore.prototype.once = function(name, listener, wait) {\n    this.on(name, listener, wait, true);\n};\n\n\n// private\nCore.prototype.callListener = function(name, event, log) {\n    for (var i = 0; i < this.listeners.length; i++) {\n        if (this.listeners[i].name == name) {\n            var listener = this.listeners[i];\n\n            if (listener.wait > 0) {\n                listener.wait--;\n            } else {\n                listener.listener(event);\n                if (listener.once) {\n                    this.listeners.splice(i, 1);\n                    i--;\n                }\n            }\n        }\n    }\n\n    if (log) {\n        // eslint-disable-next-line\n        console.log('event ' + name + ': ' + JSON.stringify(event));\n    }\n};\n\n// private\nCore.prototype.removeListener = function(id) {\n    for (var i = 0; i < this.listeners.length; i++) {\n        if (this.listeners[i].id == id) {\n            //this.listeners[i].splice(i, 1);\n            this.listeners.splice(i, 1);\n            return;\n        }\n    }\n};\n\nCore.prototype.markDirty = function() {\n    if (this.map != null) {\n        this.map.markDirty();\n    }\n};\n\nCore.prototype.onUpdate = function() {\n    if (this.killed || this.contextLost) {\n        return;\n    }\n\n    if (this.map != null) {\n        if (!this.map.srsReady && this.map.isReferenceFrameReady()) {\n            this.map.srsReady = true;\n            this.callListener('map-loaded', { 'browserOptions':this.map.browserOptions});\n        }\n\n        this.map.update();\n    }\n\n    //TODO: detect view change\n    //this.callListener(\"view-update\", {\"position\": position, \"orientaion\":orientation,\n    //                                  \"fov\": renderer.camera.getFov()});\n\n    //this.callListener(\"render-update\", { \"dirty\": true, \"message\": \"DOM element does not exist\" });\n\n    this.callListener('tick', {});\n\n    this.requestAnimFrame.call(window, this.onUpdate.bind(this));\n};\n\n\nCore.prototype.setConfigParams = function(params, solveStorage) {\n    if (typeof params === 'object' && params !== null) {\n        for (var key in params) {\n            this.setConfigParam(key, params[key], solveStorage);\n        }\n    }\n};\n\n\nCore.prototype.setConfigParam = function(key, value, solveStorage) {\n    switch(key) {\n    case 'pos':\n    case 'position':\n    case 'view':\n\n        if (this.getMap()) {\n            if (key == 'view') {\n                this.getMap().setView(value);\n            } else {\n                this.getMap().setPosition(new MapPosition(value));\n            }\n            if (this.configStorage[key]) {\n                delete this.configStorage[key];\n            }\n        } else {\n            this.configStorage[key] = value;\n        }\n        break;\n\n    case 'map':\n        this.config.map = utils.validateString(value, null); break;\n    case 'mapVirtualSurfaces':\n        this.config.mapVirtualSurfaces = utils.validateBool(value, true); break;\n    case 'mapForcePipeline':\n        this.config.mapForcePipeline = utils.validateNumber(value, -1, Number.MAXINTEGER, 0); break;\n    case 'mapDMapSize':\n        this.config.mapDMapSize = utils.validateNumber(value, 16, Number.MAXINTEGER, 512); break;\n    case 'mapDMapMode':\n        this.config.mapDMapMode = utils.validateNumber(value, 1, Number.MAXINTEGER, 1); break;\n    case 'map16bitMeshes':\n        this.config.map16bitMeshes = utils.validateBool(value, false); break;\n    case 'inspector':\n        this.config.inspector = utils.validateBool(value, true); break;\n    case 'authorization':\n        this.config.authorization = ((typeof value === 'string') || (typeof value === 'function')) ? value : null;\n         break;\n    default:\n        if (key.indexOf('map') == 0 || key == 'mario') {\n\n            if (!solveStorage || (typeof this.configStorage[key] === 'undefined')) {\n                this.configStorage[key] = value;\n            }\n\n            if (this.getMap() != null) {\n                this.getMap().setConfigParam(key, value);\n            }\n        }\n\n        if (key.indexOf('renderer') == 0) {\n            if (!solveStorage || (typeof this.configStorage[key] === 'undefined')) {\n                this.configStorage[key] = value;\n            }\n\n            this.setRendererConfigParam(key, value);\n        }\n\n        if (key.indexOf('debug') == 0) {\n            this.configStorage[key] = value;\n            if (this.getMap() != null) {\n                this.inspector.setParameter(key, value);\n            }\n        }\n\n        break;\n    }\n\n};\n\n\nCore.prototype.getConfigParam = function(key) {\n    if (key == 'map') {\n        return this.config.map;\n    } else if (key == 'inspector') {\n        return this.config.inspector;\n    } else {\n        if (key.indexOf('map') == 0 && this.getMap() != null) {\n            return this.getMap().getConfigParam(key);\n        }\n\n        if (key.indexOf('renderer') == 0) {\n            return this.getRendererConfigParam(key);\n        }\n    }\n};\n\n\nCore.prototype.setRendererConfigParam = function(key, value) {\n    switch (key) {\n    case 'rendererAnisotropic':        this.config.rendererAnisotropic = utils.validateNumber(value, -1, 2048, 0); if (this.rederer) this.rederer.gpu.setAniso(this.config.rendererAnisotropic); break;\n    case 'rendererAntialiasing':       this.config.rendererAntialiasing = utils.validateBool(value, true); break;\n    case 'rendererAllowScreenshots':   this.config.rendererAllowScreenshots = utils.validateBool(value, false); break;\n    }\n};\n\n\nCore.prototype.getRendererConfigParam = function(key) {\n    switch (key) {\n    case 'rendererAnisotropic':        return this.config.rendererAnisotropic;\n    case 'rendererAntialiasing':       return this.config.rendererAntialiasing;\n    case 'rendererAllowScreenshots':   return this.config.rendererAllowScreenshots;\n    }\n};\n\n/*\nstring getCoreVersion()\n\n    Returns string with VTS version\n*/\n\nfunction getCoreVersion(full) {\n    return (full ? 'Core: ' : '') + '2.23.6';\n}\n\n\n/*\nbool checkSupport()\n\n    Returns true if the environment is capable of running the WebGL browser, false otherwise.\n*/\n\nfunction checkSupport() {\n    platform.init();\n\n    //is webgl supported\n    var canvas = document.createElement('canvas');\n\n    if (canvas == null) {\n        return false;\n    }\n\n    canvas.width = 1024;\n    canvas.height = 768;\n\n    if (canvas.getContext == null) {\n        return false;\n    }\n\n    var gl = null;\n\n    try {\n        gl = canvas.getContext('webgl') || canvas.getContext('experimental-webgl');\n    } catch(e) {\n        return false;\n    }\n\n    if (!gl) {\n        return false;\n    }\n\n    return true;\n}\n\n\nexport {Core,getCoreVersion,checkSupport};\n","'use strict';\n\nmodule.exports = earcut;\nmodule.exports.default = earcut;\n\nfunction earcut(data, holeIndices, dim) {\n\n    dim = dim || 2;\n\n    var hasHoles = holeIndices && holeIndices.length,\n        outerLen = hasHoles ? holeIndices[0] * dim : data.length,\n        outerNode = linkedList(data, 0, outerLen, dim, true),\n        triangles = [];\n\n    if (!outerNode || outerNode.next === outerNode.prev) return triangles;\n\n    var minX, minY, maxX, maxY, x, y, invSize;\n\n    if (hasHoles) outerNode = eliminateHoles(data, holeIndices, outerNode, dim);\n\n    // if the shape is not too simple, we'll use z-order curve hash later; calculate polygon bbox\n    if (data.length > 80 * dim) {\n        minX = maxX = data[0];\n        minY = maxY = data[1];\n\n        for (var i = dim; i < outerLen; i += dim) {\n            x = data[i];\n            y = data[i + 1];\n            if (x < minX) minX = x;\n            if (y < minY) minY = y;\n            if (x > maxX) maxX = x;\n            if (y > maxY) maxY = y;\n        }\n\n        // minX, minY and invSize are later used to transform coords into integers for z-order calculation\n        invSize = Math.max(maxX - minX, maxY - minY);\n        invSize = invSize !== 0 ? 1 / invSize : 0;\n    }\n\n    earcutLinked(outerNode, triangles, dim, minX, minY, invSize);\n\n    return triangles;\n}\n\n// create a circular doubly linked list from polygon points in the specified winding order\nfunction linkedList(data, start, end, dim, clockwise) {\n    var i, last;\n\n    if (clockwise === (signedArea(data, start, end, dim) > 0)) {\n        for (i = start; i < end; i += dim) last = insertNode(i, data[i], data[i + 1], last);\n    } else {\n        for (i = end - dim; i >= start; i -= dim) last = insertNode(i, data[i], data[i + 1], last);\n    }\n\n    if (last && equals(last, last.next)) {\n        removeNode(last);\n        last = last.next;\n    }\n\n    return last;\n}\n\n// eliminate colinear or duplicate points\nfunction filterPoints(start, end) {\n    if (!start) return start;\n    if (!end) end = start;\n\n    var p = start,\n        again;\n    do {\n        again = false;\n\n        if (!p.steiner && (equals(p, p.next) || area(p.prev, p, p.next) === 0)) {\n            removeNode(p);\n            p = end = p.prev;\n            if (p === p.next) break;\n            again = true;\n\n        } else {\n            p = p.next;\n        }\n    } while (again || p !== end);\n\n    return end;\n}\n\n// main ear slicing loop which triangulates a polygon (given as a linked list)\nfunction earcutLinked(ear, triangles, dim, minX, minY, invSize, pass) {\n    if (!ear) return;\n\n    // interlink polygon nodes in z-order\n    if (!pass && invSize) indexCurve(ear, minX, minY, invSize);\n\n    var stop = ear,\n        prev, next;\n\n    // iterate through ears, slicing them one by one\n    while (ear.prev !== ear.next) {\n        prev = ear.prev;\n        next = ear.next;\n\n        if (invSize ? isEarHashed(ear, minX, minY, invSize) : isEar(ear)) {\n            // cut off the triangle\n            triangles.push(prev.i / dim);\n            triangles.push(ear.i / dim);\n            triangles.push(next.i / dim);\n\n            removeNode(ear);\n\n            // skipping the next vertex leads to less sliver triangles\n            ear = next.next;\n            stop = next.next;\n\n            continue;\n        }\n\n        ear = next;\n\n        // if we looped through the whole remaining polygon and can't find any more ears\n        if (ear === stop) {\n            // try filtering points and slicing again\n            if (!pass) {\n                earcutLinked(filterPoints(ear), triangles, dim, minX, minY, invSize, 1);\n\n            // if this didn't work, try curing all small self-intersections locally\n            } else if (pass === 1) {\n                ear = cureLocalIntersections(filterPoints(ear), triangles, dim);\n                earcutLinked(ear, triangles, dim, minX, minY, invSize, 2);\n\n            // as a last resort, try splitting the remaining polygon into two\n            } else if (pass === 2) {\n                splitEarcut(ear, triangles, dim, minX, minY, invSize);\n            }\n\n            break;\n        }\n    }\n}\n\n// check whether a polygon node forms a valid ear with adjacent nodes\nfunction isEar(ear) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // now make sure we don't have other points inside the potential ear\n    var p = ear.next.next;\n\n    while (p !== ear.prev) {\n        if (pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.next;\n    }\n\n    return true;\n}\n\nfunction isEarHashed(ear, minX, minY, invSize) {\n    var a = ear.prev,\n        b = ear,\n        c = ear.next;\n\n    if (area(a, b, c) >= 0) return false; // reflex, can't be an ear\n\n    // triangle bbox; min & max are calculated like this for speed\n    var minTX = a.x < b.x ? (a.x < c.x ? a.x : c.x) : (b.x < c.x ? b.x : c.x),\n        minTY = a.y < b.y ? (a.y < c.y ? a.y : c.y) : (b.y < c.y ? b.y : c.y),\n        maxTX = a.x > b.x ? (a.x > c.x ? a.x : c.x) : (b.x > c.x ? b.x : c.x),\n        maxTY = a.y > b.y ? (a.y > c.y ? a.y : c.y) : (b.y > c.y ? b.y : c.y);\n\n    // z-order range for the current triangle bbox;\n    var minZ = zOrder(minTX, minTY, minX, minY, invSize),\n        maxZ = zOrder(maxTX, maxTY, minX, minY, invSize);\n\n    var p = ear.prevZ,\n        n = ear.nextZ;\n\n    // look for points inside the triangle in both directions\n    while (p && p.z >= minZ && n && n.z <= maxZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n\n        if (n !== ear.prev && n !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\n            area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    // look for remaining points in decreasing z-order\n    while (p && p.z >= minZ) {\n        if (p !== ear.prev && p !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, p.x, p.y) &&\n            area(p.prev, p, p.next) >= 0) return false;\n        p = p.prevZ;\n    }\n\n    // look for remaining points in increasing z-order\n    while (n && n.z <= maxZ) {\n        if (n !== ear.prev && n !== ear.next &&\n            pointInTriangle(a.x, a.y, b.x, b.y, c.x, c.y, n.x, n.y) &&\n            area(n.prev, n, n.next) >= 0) return false;\n        n = n.nextZ;\n    }\n\n    return true;\n}\n\n// go through all polygon nodes and cure small local self-intersections\nfunction cureLocalIntersections(start, triangles, dim) {\n    var p = start;\n    do {\n        var a = p.prev,\n            b = p.next.next;\n\n        if (!equals(a, b) && intersects(a, p, p.next, b) && locallyInside(a, b) && locallyInside(b, a)) {\n\n            triangles.push(a.i / dim);\n            triangles.push(p.i / dim);\n            triangles.push(b.i / dim);\n\n            // remove two nodes involved\n            removeNode(p);\n            removeNode(p.next);\n\n            p = start = b;\n        }\n        p = p.next;\n    } while (p !== start);\n\n    return filterPoints(p);\n}\n\n// try splitting polygon into two and triangulate them independently\nfunction splitEarcut(start, triangles, dim, minX, minY, invSize) {\n    // look for a valid diagonal that divides the polygon into two\n    var a = start;\n    do {\n        var b = a.next.next;\n        while (b !== a.prev) {\n            if (a.i !== b.i && isValidDiagonal(a, b)) {\n                // split the polygon in two by the diagonal\n                var c = splitPolygon(a, b);\n\n                // filter colinear points around the cuts\n                a = filterPoints(a, a.next);\n                c = filterPoints(c, c.next);\n\n                // run earcut on each half\n                earcutLinked(a, triangles, dim, minX, minY, invSize);\n                earcutLinked(c, triangles, dim, minX, minY, invSize);\n                return;\n            }\n            b = b.next;\n        }\n        a = a.next;\n    } while (a !== start);\n}\n\n// link every hole into the outer loop, producing a single-ring polygon without holes\nfunction eliminateHoles(data, holeIndices, outerNode, dim) {\n    var queue = [],\n        i, len, start, end, list;\n\n    for (i = 0, len = holeIndices.length; i < len; i++) {\n        start = holeIndices[i] * dim;\n        end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n        list = linkedList(data, start, end, dim, false);\n        if (list === list.next) list.steiner = true;\n        queue.push(getLeftmost(list));\n    }\n\n    queue.sort(compareX);\n\n    // process holes from left to right\n    for (i = 0; i < queue.length; i++) {\n        eliminateHole(queue[i], outerNode);\n        outerNode = filterPoints(outerNode, outerNode.next);\n    }\n\n    return outerNode;\n}\n\nfunction compareX(a, b) {\n    return a.x - b.x;\n}\n\n// find a bridge between vertices that connects hole with an outer ring and and link it\nfunction eliminateHole(hole, outerNode) {\n    outerNode = findHoleBridge(hole, outerNode);\n    if (outerNode) {\n        var b = splitPolygon(outerNode, hole);\n\n        // filter collinear points around the cuts\n        filterPoints(outerNode, outerNode.next);\n        filterPoints(b, b.next);\n    }\n}\n\n// David Eberly's algorithm for finding a bridge between hole and outer polygon\nfunction findHoleBridge(hole, outerNode) {\n    var p = outerNode,\n        hx = hole.x,\n        hy = hole.y,\n        qx = -Infinity,\n        m;\n\n    // find a segment intersected by a ray from the hole's leftmost point to the left;\n    // segment's endpoint with lesser x will be potential connection point\n    do {\n        if (hy <= p.y && hy >= p.next.y && p.next.y !== p.y) {\n            var x = p.x + (hy - p.y) * (p.next.x - p.x) / (p.next.y - p.y);\n            if (x <= hx && x > qx) {\n                qx = x;\n                if (x === hx) {\n                    if (hy === p.y) return p;\n                    if (hy === p.next.y) return p.next;\n                }\n                m = p.x < p.next.x ? p : p.next;\n            }\n        }\n        p = p.next;\n    } while (p !== outerNode);\n\n    if (!m) return null;\n\n    if (hx === qx) return m; // hole touches outer segment; pick leftmost endpoint\n\n    // look for points inside the triangle of hole point, segment intersection and endpoint;\n    // if there are no points found, we have a valid connection;\n    // otherwise choose the point of the minimum angle with the ray as connection point\n\n    var stop = m,\n        mx = m.x,\n        my = m.y,\n        tanMin = Infinity,\n        tan;\n\n    p = m;\n\n    do {\n        if (hx >= p.x && p.x >= mx && hx !== p.x &&\n                pointInTriangle(hy < my ? hx : qx, hy, mx, my, hy < my ? qx : hx, hy, p.x, p.y)) {\n\n            tan = Math.abs(hy - p.y) / (hx - p.x); // tangential\n\n            if (locallyInside(p, hole) &&\n                (tan < tanMin || (tan === tanMin && (p.x > m.x || (p.x === m.x && sectorContainsSector(m, p)))))) {\n                m = p;\n                tanMin = tan;\n            }\n        }\n\n        p = p.next;\n    } while (p !== stop);\n\n    return m;\n}\n\n// whether sector in vertex m contains sector in vertex p in the same coordinates\nfunction sectorContainsSector(m, p) {\n    return area(m.prev, m, p.prev) < 0 && area(p.next, m, m.next) < 0;\n}\n\n// interlink polygon nodes in z-order\nfunction indexCurve(start, minX, minY, invSize) {\n    var p = start;\n    do {\n        if (p.z === null) p.z = zOrder(p.x, p.y, minX, minY, invSize);\n        p.prevZ = p.prev;\n        p.nextZ = p.next;\n        p = p.next;\n    } while (p !== start);\n\n    p.prevZ.nextZ = null;\n    p.prevZ = null;\n\n    sortLinked(p);\n}\n\n// Simon Tatham's linked list merge sort algorithm\n// http://www.chiark.greenend.org.uk/~sgtatham/algorithms/listsort.html\nfunction sortLinked(list) {\n    var i, p, q, e, tail, numMerges, pSize, qSize,\n        inSize = 1;\n\n    do {\n        p = list;\n        list = null;\n        tail = null;\n        numMerges = 0;\n\n        while (p) {\n            numMerges++;\n            q = p;\n            pSize = 0;\n            for (i = 0; i < inSize; i++) {\n                pSize++;\n                q = q.nextZ;\n                if (!q) break;\n            }\n            qSize = inSize;\n\n            while (pSize > 0 || (qSize > 0 && q)) {\n\n                if (pSize !== 0 && (qSize === 0 || !q || p.z <= q.z)) {\n                    e = p;\n                    p = p.nextZ;\n                    pSize--;\n                } else {\n                    e = q;\n                    q = q.nextZ;\n                    qSize--;\n                }\n\n                if (tail) tail.nextZ = e;\n                else list = e;\n\n                e.prevZ = tail;\n                tail = e;\n            }\n\n            p = q;\n        }\n\n        tail.nextZ = null;\n        inSize *= 2;\n\n    } while (numMerges > 1);\n\n    return list;\n}\n\n// z-order of a point given coords and inverse of the longer side of data bbox\nfunction zOrder(x, y, minX, minY, invSize) {\n    // coords are transformed into non-negative 15-bit integer range\n    x = 32767 * (x - minX) * invSize;\n    y = 32767 * (y - minY) * invSize;\n\n    x = (x | (x << 8)) & 0x00FF00FF;\n    x = (x | (x << 4)) & 0x0F0F0F0F;\n    x = (x | (x << 2)) & 0x33333333;\n    x = (x | (x << 1)) & 0x55555555;\n\n    y = (y | (y << 8)) & 0x00FF00FF;\n    y = (y | (y << 4)) & 0x0F0F0F0F;\n    y = (y | (y << 2)) & 0x33333333;\n    y = (y | (y << 1)) & 0x55555555;\n\n    return x | (y << 1);\n}\n\n// find the leftmost node of a polygon ring\nfunction getLeftmost(start) {\n    var p = start,\n        leftmost = start;\n    do {\n        if (p.x < leftmost.x || (p.x === leftmost.x && p.y < leftmost.y)) leftmost = p;\n        p = p.next;\n    } while (p !== start);\n\n    return leftmost;\n}\n\n// check if a point lies within a convex triangle\nfunction pointInTriangle(ax, ay, bx, by, cx, cy, px, py) {\n    return (cx - px) * (ay - py) - (ax - px) * (cy - py) >= 0 &&\n           (ax - px) * (by - py) - (bx - px) * (ay - py) >= 0 &&\n           (bx - px) * (cy - py) - (cx - px) * (by - py) >= 0;\n}\n\n// check if a diagonal between two polygon nodes is valid (lies in polygon interior)\nfunction isValidDiagonal(a, b) {\n    return a.next.i !== b.i && a.prev.i !== b.i && !intersectsPolygon(a, b) && // dones't intersect other edges\n           (locallyInside(a, b) && locallyInside(b, a) && middleInside(a, b) && // locally visible\n            (area(a.prev, a, b.prev) || area(a, b.prev, b)) || // does not create opposite-facing sectors\n            equals(a, b) && area(a.prev, a, a.next) > 0 && area(b.prev, b, b.next) > 0); // special zero-length case\n}\n\n// signed area of a triangle\nfunction area(p, q, r) {\n    return (q.y - p.y) * (r.x - q.x) - (q.x - p.x) * (r.y - q.y);\n}\n\n// check if two points are equal\nfunction equals(p1, p2) {\n    return p1.x === p2.x && p1.y === p2.y;\n}\n\n// check if two segments intersect\nfunction intersects(p1, q1, p2, q2) {\n    var o1 = sign(area(p1, q1, p2));\n    var o2 = sign(area(p1, q1, q2));\n    var o3 = sign(area(p2, q2, p1));\n    var o4 = sign(area(p2, q2, q1));\n\n    if (o1 !== o2 && o3 !== o4) return true; // general case\n\n    if (o1 === 0 && onSegment(p1, p2, q1)) return true; // p1, q1 and p2 are collinear and p2 lies on p1q1\n    if (o2 === 0 && onSegment(p1, q2, q1)) return true; // p1, q1 and q2 are collinear and q2 lies on p1q1\n    if (o3 === 0 && onSegment(p2, p1, q2)) return true; // p2, q2 and p1 are collinear and p1 lies on p2q2\n    if (o4 === 0 && onSegment(p2, q1, q2)) return true; // p2, q2 and q1 are collinear and q1 lies on p2q2\n\n    return false;\n}\n\n// for collinear points p, q, r, check if point q lies on segment pr\nfunction onSegment(p, q, r) {\n    return q.x <= Math.max(p.x, r.x) && q.x >= Math.min(p.x, r.x) && q.y <= Math.max(p.y, r.y) && q.y >= Math.min(p.y, r.y);\n}\n\nfunction sign(num) {\n    return num > 0 ? 1 : num < 0 ? -1 : 0;\n}\n\n// check if a polygon diagonal intersects any polygon segments\nfunction intersectsPolygon(a, b) {\n    var p = a;\n    do {\n        if (p.i !== a.i && p.next.i !== a.i && p.i !== b.i && p.next.i !== b.i &&\n                intersects(p, p.next, a, b)) return true;\n        p = p.next;\n    } while (p !== a);\n\n    return false;\n}\n\n// check if a polygon diagonal is locally inside the polygon\nfunction locallyInside(a, b) {\n    return area(a.prev, a, a.next) < 0 ?\n        area(a, b, a.next) >= 0 && area(a, a.prev, b) >= 0 :\n        area(a, b, a.prev) < 0 || area(a, a.next, b) < 0;\n}\n\n// check if the middle point of a polygon diagonal is inside the polygon\nfunction middleInside(a, b) {\n    var p = a,\n        inside = false,\n        px = (a.x + b.x) / 2,\n        py = (a.y + b.y) / 2;\n    do {\n        if (((p.y > py) !== (p.next.y > py)) && p.next.y !== p.y &&\n                (px < (p.next.x - p.x) * (py - p.y) / (p.next.y - p.y) + p.x))\n            inside = !inside;\n        p = p.next;\n    } while (p !== a);\n\n    return inside;\n}\n\n// link two polygon vertices with a bridge; if the vertices belong to the same ring, it splits polygon into two;\n// if one belongs to the outer ring and another to a hole, it merges it into a single ring\nfunction splitPolygon(a, b) {\n    var a2 = new Node(a.i, a.x, a.y),\n        b2 = new Node(b.i, b.x, b.y),\n        an = a.next,\n        bp = b.prev;\n\n    a.next = b;\n    b.prev = a;\n\n    a2.next = an;\n    an.prev = a2;\n\n    b2.next = a2;\n    a2.prev = b2;\n\n    bp.next = b2;\n    b2.prev = bp;\n\n    return b2;\n}\n\n// create a node and optionally link it with previous one (in a circular doubly linked list)\nfunction insertNode(i, x, y, last) {\n    var p = new Node(i, x, y);\n\n    if (!last) {\n        p.prev = p;\n        p.next = p;\n\n    } else {\n        p.next = last.next;\n        p.prev = last;\n        last.next.prev = p;\n        last.next = p;\n    }\n    return p;\n}\n\nfunction removeNode(p) {\n    p.next.prev = p.prev;\n    p.prev.next = p.next;\n\n    if (p.prevZ) p.prevZ.nextZ = p.nextZ;\n    if (p.nextZ) p.nextZ.prevZ = p.prevZ;\n}\n\nfunction Node(i, x, y) {\n    // vertex index in coordinates array\n    this.i = i;\n\n    // vertex coordinates\n    this.x = x;\n    this.y = y;\n\n    // previous and next vertex nodes in a polygon ring\n    this.prev = null;\n    this.next = null;\n\n    // z-order curve value\n    this.z = null;\n\n    // previous and next nodes in z-order\n    this.prevZ = null;\n    this.nextZ = null;\n\n    // indicates whether this is a steiner point\n    this.steiner = false;\n}\n\n// return a percentage difference between the polygon area and its triangulation area;\n// used to verify correctness of triangulation\nearcut.deviation = function (data, holeIndices, dim, triangles) {\n    var hasHoles = holeIndices && holeIndices.length;\n    var outerLen = hasHoles ? holeIndices[0] * dim : data.length;\n\n    var polygonArea = Math.abs(signedArea(data, 0, outerLen, dim));\n    if (hasHoles) {\n        for (var i = 0, len = holeIndices.length; i < len; i++) {\n            var start = holeIndices[i] * dim;\n            var end = i < len - 1 ? holeIndices[i + 1] * dim : data.length;\n            polygonArea -= Math.abs(signedArea(data, start, end, dim));\n        }\n    }\n\n    var trianglesArea = 0;\n    for (i = 0; i < triangles.length; i += 3) {\n        var a = triangles[i] * dim;\n        var b = triangles[i + 1] * dim;\n        var c = triangles[i + 2] * dim;\n        trianglesArea += Math.abs(\n            (data[a] - data[c]) * (data[b + 1] - data[a + 1]) -\n            (data[a] - data[b]) * (data[c + 1] - data[a + 1]));\n    }\n\n    return polygonArea === 0 && trianglesArea === 0 ? 0 :\n        Math.abs((trianglesArea - polygonArea) / polygonArea);\n};\n\nfunction signedArea(data, start, end, dim) {\n    var sum = 0;\n    for (var i = start, j = end - dim; i < end; i += dim) {\n        sum += (data[j] - data[i]) * (data[i + 1] + data[j + 1]);\n        j = i;\n    }\n    return sum;\n}\n\n// turn a polygon in a multi-dimensional array form (e.g. as in GeoJSON) into a form Earcut accepts\nearcut.flatten = function (data) {\n    var dim = data[0][0].length,\n        result = {vertices: [], holes: [], dimensions: dim},\n        holeIndex = 0;\n\n    for (var i = 0; i < data.length; i++) {\n        for (var j = 0; j < data[i].length; j++) {\n            for (var d = 0; d < dim; d++) result.vertices.push(data[i][j][d]);\n        }\n        if (i > 0) {\n            holeIndex += data[i - 1].length;\n            result.holes.push(holeIndex);\n        }\n    }\n    return result;\n};\n","'use strict';\n\n// http://stackoverflow.com/questions/10343913/how-to-create-a-web-worker-from-a-string\n\nvar URL = window.URL || window.webkitURL;\n\nmodule.exports = function (content, url) {\n  try {\n    try {\n      var blob;\n\n      try {\n        // BlobBuilder = Deprecated, but widely implemented\n        var BlobBuilder = window.BlobBuilder || window.WebKitBlobBuilder || window.MozBlobBuilder || window.MSBlobBuilder;\n\n        blob = new BlobBuilder();\n\n        blob.append(content);\n\n        blob = blob.getBlob();\n      } catch (e) {\n        // The proposed API\n        blob = new Blob([content]);\n      }\n\n      return new Worker(URL.createObjectURL(blob));\n    } catch (e) {\n      return new Worker('data:application/javascript,' + encodeURIComponent(content));\n    }\n  } catch (e) {\n    if (!url) {\n      throw Error('Inline worker is not supported');\n    }\n\n    return new Worker(url);\n  }\n};","\nimport {utils as utils_} from '../utils/utils';\nimport {utilsUrl as utilsUrl_} from '../utils/url';\n\n//get rid of compiler mess\nvar utilsUrl = utilsUrl_;\nvar utils = utils_;\n\n\nvar MapUrl = function(map, path) {\n    this.map = map;\n\n    path = path.trim();\n    this.baseUrl = utilsUrl.getBase(path);\n    this.baseUrlSchema = utilsUrl.getSchema(path);\n    this.baseUrlOrigin = utilsUrl.getOrigin(path); \n\n    this.urlCounter = 0;\n};\n\n\nMapUrl.prototype['quad'] = function(lod, ix, iy) {\n    var quadKey = '';\n    //ty = Math.pow(2,zoom - 1) - ty;\n    for (var i = lod; i > 0; i--) {\n        var digit = 0;\n        var mask = 1 << (i-1);\n        if ((ix & mask) != 0) {\n            digit += 1;\n        }\n\n        if ((iy & mask) != 0) {\n            digit += 2;\n        }\n\n        quadKey += digit;\n    }\n\n    return quadKey;\n};\n\n\nMapUrl.prototype['msDigit'] = function(iy, ix) {\n    return (((iy & 3) << 1) + (ix & 1));\n};\n\n\nMapUrl.prototype.hex = function(v) {\n    var s = v.toString(16);\n    while (s.length < 8) {\n        s = '0' + s;\n    }\n    return s;\n};\n\n\nMapUrl.prototype['ppx'] = function(lod, ix) {\n    return this.hex(ix << (28 - lod), 7);\n};\n\n\nMapUrl.prototype['ppy'] = function(lod, iy) {\n    return this.hex((1 << 28) - ((iy + 1) << (28 - lod)), 7);\n};\n\n\nMapUrl.prototype.processUrlFunction = function(id, counter, string) {\n    var string2, fc;\n    if (typeof string == 'string') {\n        if (string.indexOf('quad') != -1) {\n            string2 = '(function(lod,x,y,loclod,locx,locy){' + string.replace('quad', 'return this.quad') + '})';\n\n            try {\n                fc = eval(string2).bind(this);\n                return fc(id.lod, id.ix, id.iy, id.loclod, id.locx, id.locy);\n            } catch(e) {\n                return string;\n            }\n        } else if (string.indexOf('msdigit') != -1) {\n            string2 = '(function(x,y,loclod,locx,locy){' + string.replace('msdigit', 'return this.msDigit') + '})';\n\n            try {\n                fc = eval(string2).bind(this);\n                return fc(id.ix, id.iy, id.loclod, id.locx, id.locy);\n            } catch(e) {\n                return string;\n            }\n\n        } else if (string.indexOf('alt') != -1) {\n            var result = /\\(([^)]*)\\)/.exec(string);\n\n            if (result && result[1]) {\n                var strings = result[1].match(/([^,]+)/g);\n\n                if (strings.length > 0) {\n                    return strings[(counter % strings.length)];\n                }\n            }\n\n            return string;\n\n        } else if (string.indexOf('ppx') != -1) {\n            string2 = '(function(lod,x,loclod,locx){' + string.replace('ppx', 'return this.ppx') + '})';\n\n            try {\n                fc = eval(string2).bind(this);\n                return fc(id.lod, id.ix, id.loclod, id.locx);\n            } catch(e) {\n                return string;\n            }\n\n        } else if (string.indexOf('ppy') != -1) {\n            string2 = '(function(lod,y,loclod,locy){' + string.replace('ppy', 'return this.ppy') + '})';\n\n            try {\n                fc = eval(string2).bind(this);\n                return fc(id.lod, id.iy, id.loclod, id.locy);\n            } catch(e) {\n                return string;\n            }\n\n        } else {\n            return string;\n        }\n\n    } else {\n        return string;\n    }\n};\n\n\nMapUrl.prototype.findLocalRoot = function(id) {\n    var nodes = this.map.referenceFrame.getSpatialDivisionNodes();\n    var validNodes = [];  \n\n    for (var i = 0, li = nodes.length; i < li; i++) {\n        var node = nodes[i];\n        \n        var delta = id[0] - node.id[0];\n        var ix = id[1] >> delta;\n        var iy = id[2] >> delta;\n        \n        if (ix == node.id[1] && iy == node.id[2]) {\n            validNodes.push(node);           \n        }\n    }\n\n    var bestNode = null;\n    var bestLod = -1;\n    \n    for (i = 0, li = validNodes.length; i < li; i++) {\n        if (validNodes[i].id[0] > bestLod) {\n            bestNode = validNodes[i]; \n        }\n    }\n    \n    if (bestNode) {\n        return bestNode.id.slice();\n    } else {\n        return [0,0,0];\n    }\n};\n\n\nMapUrl.prototype.makeUrl = function(templ, id, subId, skipBaseUrl) {\n    //if (templ.indexOf(\"jpg\") != -1) {\n       //templ = \"{lod}-{easting}-{northing}.jpg?v=4\";\n       //templ = \"{lod}-{x}-{y}.jpg?v=4\";\n       //templ = \"{quad(lod,x,y)}.jpg?v=4\";\n       //templ = \"{quad(lod,x+1,y*2)}.jpg?v=4\";\n       //templ = \"{lod}-{msdigit(x,y)}.jpg?v=4\";\n    //}\n    //templ = \"maps{alt(1,2,3,4)}.irist-test.citationtech.net/map/{lod}-{x}-{y}.jpg?v=4\";\n\n    var locx = 0;\n    var locy = 0;\n    var loclod = 0;\n\n    if (id.lod) {\n        var localRoot = this.findLocalRoot([id.lod, id.ix, id.iy]);    \n        loclod = id.lod - localRoot[0];\n        var mask = (1 << loclod) - 1;\n        locx = id.ix & mask;\n        locy = id.iy & mask;        \n    }\n    \n    var id2 = {\n        lod: id.lod,\n        ix : id.ix,\n        iy : id.iy,\n        loclod: loclod,\n        locx : locx,\n        locy : locy\n    };\n\n    //remove white spaces from template\n    templ = templ.replace(/ /g, '');\n\n    var url = utils.simpleFmtObjOrCall(templ, {'lod':id.lod,  'x':id.ix, 'y':id.iy, 'sub': subId,\n        'locx':locx, 'locy':locy, 'loclod':loclod, 'geonavtile': subId,\n        'hereappid': 'abcde', 'hereappcode':'12345'},\n                                               this.processUrlFunction.bind(this, id2, this.urlCounter));\n\n    this.urlCounter++;\n\n    skipBaseUrl = (url.indexOf('//') != -1);\n\n    /* //useful for debug\n    var tmp;\n\n    if (skipBaseUrl) {\n        tmp =  url;\n    } else {\n        tmp = this.baseUrl + url;\n    }\n    */\n\n    if (skipBaseUrl) {\n        if (url.indexOf('//') == 0) {\n            return this.baseUrlSchema + url;\n        } else {\n            return url;\n        }\n    } else {\n        return this.baseUrl + url;\n    }\n};\n\n\nMapUrl.prototype.processUrl = function(url, fallback) {\n    if (!url) {\n        return fallback;\n    }\n    \n    url = url.trim();\n\n    if (url.indexOf('://') != -1) { //absolute\n        return url;\n    } else if (url.indexOf('//') == 0) {  //absolute without schema\n        return this.baseUrlSchema + url;\n    } else if (url.indexOf('/') == 0) {  //absolute without host\n        return this.baseUrlOrigin + url;\n    } else {  //relative\n        return this.baseUrl + url; \n    }\n};\n\n\nexport default MapUrl;\n\n","\nimport Proj4 from 'melowntech-proj4';\nimport earcut from 'earcut';\nimport {Core as Core_} from './core';\n//import {CoreInterface as CoreInterface_} from './interface';\n\n//get rid of compiler mess\n//var CoreInterface = CoreInterface_;\nvar Core = Core_;\nvar proj4 = Proj4;\n\n\nvar CoreInterface = function(element, config) {\n    this.core = new Core(element, config, this);\n\n    Object.defineProperty(this, 'map', {\n        get: function() {\n            if (!this.core) { return null; }\n            return this.core.getMapInterface();\n        }\n    });\n\n    Object.defineProperty(this, 'renderer', {\n        get: function() {\n            if (!this.core) { return null; }\n            return this.core.getRendererInterface();\n        }\n    });\n\n    Object.defineProperty(this, 'proj4', {\n        get: function() {\n            if (!this.core) { return null; }\n            return proj4;\n        }\n    });\n\n    Object.defineProperty(this, 'earcut', {\n        get: function() {\n            if (!this.core) { return null; }\n            return earcut;\n        }\n    });\n};\n\n\nCoreInterface.prototype.destroy = function() {\n    this.core.destroy();\n    this.core = null;\n};\n\n\nCoreInterface.prototype.loadMap = function(path) {\n    if (!this.core) { return null; }\n    return this.core.loadMap(path);\n};\n\n\nCoreInterface.prototype.destroyMap = function() {\n    if (!this.core) { return null; }\n    return this.core.destroyMap();\n};\n\n\n/*CoreInterface.prototype.getMap = function() {\n    if (!this.core) { return null; }\n    return this.core.getMapInterface();\n};\n\n\nCoreInterface.prototype.getRenderer = function() {\n    if (!this.core) { return null; }\n    return this.core.getRendererInterface();\n};\n\n\nCoreInterface.prototype.getProj4 = function() {\n    if (!this.core) { return null; }\n    return this.core.getProj4();\n};*/\n\n\nCoreInterface.prototype.on = function(eventName, call) {\n    if (!this.core) { return null; }\n    return this.core.on(eventName, call);\n};\n\nCoreInterface.prototype.once = function(eventName, call, wait) {\n    if (!this.core) { return null; }\n    return this.core.once(eventName, call, wait);\n};\n\nCoreInterface.prototype.callListener = function(name, event) {\n    if (!this.core) { return null; }\n    this.core.callListener(name, event);\n};\n\n\nexport {CoreInterface};\n","module.exports = function() {\n  return require(\"!!/home/magic/Public/secret_content/experiementing-vts/vts-browser-js/node_modules/worker-loader/dist/workers/InlineWorker.js\")(\"/*!\\n * Copyright (c) 2020 Melown Technologies SE\\n *  *  For terms of use, see accompanying main file.\\n *  *  For 3rd party libraries licenses, see 3rdpartylicenses.txt.\\n * \\n */!function(e){var r={};function t(n){if(r[n])return r[n].exports;var a=r[n]={i:n,l:!1,exports:{}};return e[n].call(a.exports,a,a.exports,t),a.l=!0,a.exports}t.m=e,t.c=r,t.d=function(e,r,n){t.o(e,r)||Object.defineProperty(e,r,{enumerable:!0,get:n})},t.r=function(e){\\\"undefined\\\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\\\"Module\\\"}),Object.defineProperty(e,\\\"__esModule\\\",{value:!0})},t.t=function(e,r){if(1&r&&(e=t(e)),8&r)return e;if(4&r&&\\\"object\\\"==typeof e&&e&&e.__esModule)return e;var n=Object.create(null);if(t.r(n),Object.defineProperty(n,\\\"default\\\",{enumerable:!0,value:e}),2&r&&\\\"string\\\"!=typeof e)for(var a in e)t.d(n,a,function(r){return e[r]}.bind(null,a));return n},t.n=function(e){var r=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(r,\\\"a\\\",r),r},t.o=function(e,r){return Object.prototype.hasOwnProperty.call(e,r)},t.p=\\\"\\\",t(t.s=0)}([function(e,r,t){\\\"use strict\\\";t.r(r);var n={stylesheetData:{},stylesheetLayers:{},stylesheetBitmaps:{},stylesheetFonts:{},stylesheetConstants:{},stylesheetVariables:{},insidePack:!1,directPoints:[],directPoint:null,fonts:{},fontsMap:{},fontsStorage:{},forceOrigin:!1,forceScale:[1,1,1],bboxMin:[0,0,0],bboxMax:[1,1,1],geocent:!1,tileX:0,tileY:0,tileLod:0,tileIX:0,tileIY:0,tileSize:1,hitState:0,pixelFactor:1,alwaysEventInfo:!0,metricUnits:!0,language:\\\"en\\\",groupOptimize:!0,groupOrigin:[0,0,0],messageBuffer:new Array(65536),messageBufferIndex:0,messageBufferSize:65536,messagePackSize:0,signatureCounter:0,autoLod:!1,featureType:null,groupId:null,disableLog:!1,reduceMode:\\\"scr-count4\\\",reduceParams:null,processLineLabel:!1,useLineLabel2:!0,lineLabelPass:0};function a(e,r,t){return e<r&&(e=r),e>t&&(e=t),e}function s(e,r){r||(r=e);var t=e[0],n=e[1],a=e[2],s=Math.sqrt(t*t+n*n+a*a);return s?1==s?(r[0]=t,r[1]=n,r[2]=a,r):(s=1/s,r[0]=t*s,r[1]=n*s,r[2]=a*s,r):(r[0]=0,r[1]=0,r[2]=0,r)}function i(e,r,t){t||(t=e);var n=e[0],a=e[1];e=e[2];var s=r[0],i=r[1];return r=r[2],t[0]=a*r-e*i,t[1]=e*s-n*r,t[2]=n*i-a*s,t}var o=\\\"undefined\\\"!=typeof TextEncoder?new TextEncoder(\\\"utf-8\\\"):null;var l=\\\"undefined\\\"!=typeof TextDecoder?new TextDecoder(\\\"utf-8\\\"):null;var u=[\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"S\\\",\\\"B\\\",\\\"S\\\",\\\"WS\\\",\\\"B\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"B\\\",\\\"B\\\",\\\"B\\\",\\\"S\\\",\\\"WS\\\",\\\"ON\\\",\\\"ON\\\",\\\"ET\\\",\\\"ET\\\",\\\"ET\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ES\\\",\\\"CS\\\",\\\"ES\\\",\\\"CS\\\",\\\"CS\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"CS\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"B\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"BN\\\",\\\"CS\\\",\\\"ON\\\",\\\"ET\\\",\\\"ET\\\",\\\"ET\\\",\\\"ET\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"L\\\",\\\"ON\\\",\\\"ON\\\",\\\"BN\\\",\\\"ON\\\",\\\"ON\\\",\\\"ET\\\",\\\"ET\\\",\\\"EN\\\",\\\"EN\\\",\\\"ON\\\",\\\"L\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"EN\\\",\\\"L\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"ON\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"ON\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"ON\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\",\\\"L\\\"],c=[\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"ON\\\",\\\"ON\\\",\\\"AL\\\",\\\"ET\\\",\\\"ET\\\",\\\"AL\\\",\\\"CS\\\",\\\"AL\\\",\\\"ON\\\",\\\"ON\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"AL\\\",\\\"AL\\\",\\\"\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"AN\\\",\\\"ET\\\",\\\"AN\\\",\\\"AN\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"NSM\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"AN\\\",\\\"ON\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"AL\\\",\\\"AL\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"ON\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"NSM\\\",\\\"AL\\\",\\\"AL\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"EN\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\",\\\"AL\\\"];function f(e){return 0!=(1&e)}function h(e){return 0==(1&e)}function v(e,r,t){for(var n=r,a=e.length;n<a;++n)if(e[n]!==t)return n;return n}function d(e,r,t,n){for(var a=r;a<t;++a)e[a]=n}function b(e,r,t,n){for(var a=t,s=n-1;a<s;++a,--s){var i=e[a];e[a]=e[s],e[s]=i,i=r[a],r[a]=r[s],r[s]=i}}function g(e,r,t){return{str:e,indices:L,types:y,dir:t?\\\"ttb\\\":r?\\\"ltr\\\":\\\"rtl\\\"}}var p=[],y=[],L=[];var A=function(e,r,t){var n=!0,a=e.length;if(0===a||t)return g(e,n,t);p.length=a,y.length=a;var s,i,o=0;for(s=0;s<a;++s){p[s]=e.charAt(s),L[s]=s;var l=e.charCodeAt(s),A=\\\"L\\\";l<=255?A=u[l]:1424<=l&&l<=1524?A=\\\"R\\\":1536<=l&&l<=1791?A=c[255&l]:1792<=l&&l<=2220&&(A=\\\"AL\\\"),\\\"R\\\"!==A&&\\\"AL\\\"!==A&&\\\"AN\\\"!==A||o++,y[s]=A}if(0===o)return g(e,n=!0);-1===r&&(o/a<.3?(n=!0,r=0):(n=!1,r=1));var m=[];for(s=0;s<a;++s)m[s]=r;var N,U=f(r)?\\\"R\\\":\\\"L\\\",w=U,x=w,S=w;for(s=0;s<a;++s)\\\"NSM\\\"===y[s]?y[s]=S:S=y[s];for(S=w,s=0;s<a;++s)\\\"EN\\\"===(N=y[s])?y[s]=\\\"AL\\\"===S?\\\"AN\\\":\\\"EN\\\":\\\"R\\\"!==N&&\\\"L\\\"!==N&&\\\"AL\\\"!==N||(S=N);for(s=0;s<a;++s)\\\"AL\\\"===(N=y[s])&&(y[s]=\\\"R\\\");for(s=1;s<a-1;++s)\\\"ES\\\"===y[s]&&\\\"EN\\\"===y[s-1]&&\\\"EN\\\"===y[s+1]&&(y[s]=\\\"EN\\\"),\\\"CS\\\"!==y[s]||\\\"EN\\\"!==y[s-1]&&\\\"AN\\\"!==y[s-1]||y[s+1]!==y[s-1]||(y[s]=y[s-1]);for(s=0;s<a;++s)if(\\\"EN\\\"===y[s]){var M;for(M=s-1;M>=0&&\\\"ET\\\"===y[M];--M)y[M]=\\\"EN\\\";for(M=s+1;M<a&&\\\"ET\\\"===y[M];++M)y[M]=\\\"EN\\\"}for(s=0;s<a;++s)\\\"WS\\\"!==(N=y[s])&&\\\"ES\\\"!==N&&\\\"ET\\\"!==N&&\\\"CS\\\"!==N||(y[s]=\\\"ON\\\");for(S=w,s=0;s<a;++s)\\\"EN\\\"===(N=y[s])?y[s]=\\\"L\\\"===S?\\\"L\\\":\\\"EN\\\":\\\"R\\\"!==N&&\\\"L\\\"!==N||(S=N);for(s=0;s<a;++s)if(\\\"ON\\\"===y[s]){var B=v(y,s+1,\\\"ON\\\"),O=w;s>0&&(O=y[s-1]);var _=x;B+1<a&&(_=y[B+1]),\\\"L\\\"!==O&&(O=\\\"R\\\"),\\\"L\\\"!==_&&(_=\\\"R\\\"),O===_&&d(y,s,B,O),s=B-1}for(s=0;s<a;++s)\\\"ON\\\"===y[s]&&(y[s]=U);for(s=0;s<a;++s)N=y[s],h(m[s])?\\\"R\\\"===N?m[s]+=1:\\\"AN\\\"!==N&&\\\"EN\\\"!==N||(m[s]+=2):\\\"L\\\"!==N&&\\\"AN\\\"!==N&&\\\"EN\\\"!==N||(m[s]+=1);var k,I=-1,E=99;for(s=0,i=m.length;s<i;++s)I<(k=m[s])&&(I=k),E>k&&f(k)&&(E=k);for(k=I;k>=E;--k){var C=-1;for(s=0,i=m.length;s<i;++s)m[s]<k?C>=0&&(b(p,L,C,s),C=-1):C<0&&(C=s);C>=0&&b(p,L,C,m.length)}for(s=0,i=p.length;s<i;++s){var F=p[s];\\\"<\\\"!==F&&\\\">\\\"!==F||(p[s]=\\\"\\\")}return g(p.join(\\\"\\\"),n)},m={parse:function(e){var r=m._bin,t=new Uint8Array(e),n=0;r.readFixed(t,n);n+=4;var a=r.readUshort(t,n);n+=2;r.readUshort(t,n);n+=2;r.readUshort(t,n);n+=2;r.readUshort(t,n);n+=2;for(var s=[\\\"cmap\\\",\\\"head\\\",\\\"hhea\\\",\\\"maxp\\\",\\\"hmtx\\\",\\\"kern\\\",\\\"GPOS\\\",\\\"GSUB\\\"],i={_data:t},o={},l=0,u=0;u<a;u++){var c=r.readASCII(t,n,4);n+=4;r.readUint(t,n);n+=4;var f=r.readUint(t,n);n+=4;var h=r.readUint(t,n);n+=4,o[c]={offset:f,length:h},l=f+h}for(u=0;u<s.length;u++){var v=s[u];o[v]&&(i[v.trim()]=m[v.trim()].parse(t,o[v].offset,o[v].length,i))}i._tabs=o,m._processGlyphs(t,l,o,i);var d=i.GSUB;if(d){var b=d.lookupList,g=d.featureList;i.gsubIsolTable=[],i.gsubInitTable=[],i.gsubFinaTable=[],i.gsubMediTable=[],i.gsubRligLigaTable=[];for(var p=0;p<g.length;p++){switch(c=g[p].tag){case\\\"isol\\\":case\\\"init\\\":case\\\"fina\\\":case\\\"medi\\\":for(var y=0;y<g[p].tab.length;y++){if(1==(L=b[g[p].tab[y]]).ltype)switch(c){case\\\"isol\\\":i.gsubIsolTable.push(L.tabs);break;case\\\"init\\\":i.gsubInitTable.push(L.tabs);break;case\\\"fina\\\":i.gsubFinaTable.push(L.tabs);break;case\\\"medi\\\":i.gsubMediTable.push(L.tabs)}}break;case\\\"rlig\\\":case\\\"liga\\\":for(y=0;y<g[p].tab.length;y++){var L;4==(L=b[g[p].tab[y]]).ltype&&i.gsubRligLigaTable.push(L.tabs)}}}}return i},_processGlyphs:function(e,r,t,n){var a=e[r],s=e[r+=1]<<8|e[r+1],i=e[r+=2]<<8|e[r+1],o=e[r+=2],l=e[r+=1];r+=1,n.version=a,n.textureLX=s,n.textureLY=i,n.size=o,n.cly=1.5*o,n.flags=l;var u=new Array(n.maxp.numGlyphs),c=1/s,f=1/i,h=s>256?7:6,v=r+n.maxp.numGlyphs*h,d=e[v]<<8|e[v+1],b=new Array(d);v+=2;for(var g=0,p=d;g<p;g++)b[g]=e[v+2*g]<<8|e[v+2*g+1];var y=0;for(g=0,p=n.maxp.numGlyphs;g<p;g++)g==b[y]&&y++,u[g]=m._processGlyph(e,r,c,f,s,n,g,y),r+=h;n.glyphs=u},_processGlyph:function(e,r,t,n,a,s,i,o){var l=e[r]<<24|e[r+1]<<16|e[r+2]<<8|e[r+3],u=l>>22&63,c=l>>16&63,f=(l>>9&63)*(l>>15&1?-1:1),h=-(l>>2&63)*(l>>8&1?-1:1),v=(3&l)+4*o;l=a>256?e[r+4]<<16|e[r+5]<<8|e[r+6]:e[r+4]<<8|e[r+5];var d,b,g=s.size/.75/s.head.unitsPerEm*.75,p=s.hmtx.aWidth[i]*g;switch(a){case 2048:d=l>>11&2047,b=2047&l;break;case 1024:d=l>>10&1023,b=1023&l;break;case 512:d=l>>9&511,b=511&l;break;default:d=l>>8&255,b=255&l}return{u1:d*t,v1:b*n+v,u2:(d+u)*t,v2:(b+c)*n+v,lx:u,ly:c,sx:f,sy:h,step:p,plane:v}},_tabOffset:function(e,r){for(var t=m._bin,n=t.readUshort(e,4),a=12,s=0;s<n;s++){var i=t.readASCII(e,a,4);a+=4;t.readUint(e,a);a+=4;var o=t.readUint(e,a);a+=4;t.readUint(e,a);if(a+=4,i==r)return o}return 0}};m._bin={readFixed:function(e,r){return(e[r]<<8|e[r+1])+(e[r+2]<<8|e[r+3])/65540},readF2dot14:function(e,r){var t=m._bin.readShort(e,r);return t/16384},readInt:function(e,r){var t=m._bin.t.uint8;return t[0]=e[r+3],t[1]=e[r+2],t[2]=e[r+1],t[3]=e[r],m._bin.t.int32[0]},readInt8:function(e,r){return m._bin.t.uint8[0]=e[r],m._bin.t.int8[0]},readShort:function(e,r){var t=m._bin.t.uint8;return t[1]=e[r],t[0]=e[r+1],m._bin.t.int16[0]},readUshort:function(e,r){return e[r]<<8|e[r+1]},readUshorts:function(e,r,t){for(var n=[],a=0;a<t;a++)n.push(m._bin.readUshort(e,r+2*a));return n},readUint:function(e,r){var t=m._bin.t.uint8;return t[3]=e[r],t[2]=e[r+1],t[1]=e[r+2],t[0]=e[r+3],m._bin.t.uint32[0]},readUint64:function(e,r){return 4294967296*m._bin.readUint(e,r)+m._bin.readUint(e,r+4)},readASCII:function(e,r,t){for(var n=\\\"\\\",a=0;a<t;a++)n+=String.fromCharCode(e[r+a]);return n},readUnicode:function(e,r,t){for(var n=\\\"\\\",a=0;a<t;a++){var s=e[r++]<<8|e[r++];n+=String.fromCharCode(s)}return n},readBytes:function(e,r,t){for(var n=[],a=0;a<t;a++)n.push(e[r+a]);return n},readASCIIArray:function(e,r,t){for(var n=[],a=0;a<t;a++)n.push(String.fromCharCode(e[r+a]));return n}},m._bin.t={buff:new ArrayBuffer(8)},m._bin.t.int8=new Int8Array(m._bin.t.buff),m._bin.t.uint8=new Uint8Array(m._bin.t.buff),m._bin.t.int16=new Int16Array(m._bin.t.buff),m._bin.t.uint16=new Uint16Array(m._bin.t.buff),m._bin.t.int32=new Int32Array(m._bin.t.buff),m._bin.t.uint32=new Uint32Array(m._bin.t.buff),m._lctf={},m._lctf.parse=function(e,r,t,n,a){var s=m._bin,i={},o=r;s.readFixed(e,r);r+=4;var l=s.readUshort(e,r);r+=2;var u=s.readUshort(e,r);r+=2;var c=s.readUshort(e,r);return r+=2,i.scriptList=m._lctf.readScriptList(e,o+l),i.featureList=m._lctf.readFeatureList(e,o+u),i.lookupList=m._lctf.readLookupList(e,o+c,a),i},m._lctf.readLookupList=function(e,r,t){var n=m._bin,a=r,s=[],i=n.readUshort(e,r);r+=2;for(var o=0;o<i;o++){var l=n.readUshort(e,r);r+=2;var u=m._lctf.readLookupTable(e,a+l,t);s.push(u)}return s},m._lctf.readLookupTable=function(e,r,t){var n=m._bin,a=r,s={tabs:[]};s.ltype=n.readUshort(e,r),r+=2,s.flag=n.readUshort(e,r),r+=2;var i=n.readUshort(e,r);r+=2;for(var o=0;o<i;o++){var l=n.readUshort(e,r);r+=2;var u=t(e,s.ltype,a+l);s.tabs.push(u)}return s},m._lctf.numOfOnes=function(e){for(var r=0,t=0;t<32;t++)0!=(e>>>t&1)&&r++;return r},m._lctf.readClassDef=function(e,r){var t=m._bin,n={start:[],end:[],class:[]},a=t.readUshort(e,r);if(r+=2,1==a){var s=t.readUshort(e,r);r+=2;var i=t.readUshort(e,r);r+=2;for(var o=0;o<i;o++)n.start.push(s+o),n.end.push(s+o),n.class.push(t.readUshort(e,r)),r+=2}if(2==a){var l=t.readUshort(e,r);r+=2;for(o=0;o<l;o++)n.start.push(t.readUshort(e,r)),r+=2,n.end.push(t.readUshort(e,r)),r+=2,n.class.push(t.readUshort(e,r)),r+=2}return n},m._lctf.readValueRecord=function(e,r,t){var n=m._bin,a=[];return a.push(1&t?n.readShort(e,r):0),r+=1&t?2:0,a.push(2&t?n.readShort(e,r):0),r+=2&t?2:0,a.push(4&t?n.readShort(e,r):0),r+=4&t?2:0,a.push(8&t?n.readShort(e,r):0),r+=8&t?2:0,a},m._lctf.readCoverage=function(e,r){var t=m._bin,n={};n.fmt=t.readUshort(e,r),r+=2;var a=t.readUshort(e,r);r+=2,1==n.fmt&&(n.tab=t.readUshorts(e,r,a)),2==n.fmt&&(n.tab=t.readUshorts(e,r,3*a));var s=Number.POSITIVE_INFINITY,i=0,o=n.tab;if(1==n.fmt)for(var l=0;l<o.length;l++){var u=o[l];u>i&&(i=u),u<s&&(s=u)}if(2==n.fmt)for(l=0;l<o.length;l+=3){var c=o[l],f=o[l+1];c>i&&(i=c),c<s&&(s=c),f>i&&(i=f),f<s&&(s=f)}return n.min=s,n.max=i,n},m._lctf.coverageIndex=function(e,r){if(r<e.min||r>e.max)return-1;var t=e.tab;if(1==e.fmt)return t.indexOf(r);for(var n=0;n<t.length;n+=3){var a=t[n],s=t[n+1],i=t[n+2];if(a<=r&&r<=s)return i+(r-a)}return-1},m._lctf.readFeatureList=function(e,r){var t=m._bin,n=r,a=[],s=t.readUshort(e,r);r+=2;for(var i=0;i<s;i++){var o=t.readASCII(e,r,4);r+=4;var l=t.readUshort(e,r);r+=2,a.push({tag:o.trim(),tab:m._lctf.readFeatureTable(e,n+l)})}return a},m._lctf.readFeatureTable=function(e,r){var t=m._bin;t.readUshort(e,r);r+=2;var n=t.readUshort(e,r);r+=2;for(var a=[],s=0;s<n;s++)a.push(t.readUshort(e,r+2*s));return a},m._lctf.readScriptList=function(e,r){var t=m._bin,n=r,a={},s=t.readUshort(e,r);r+=2;for(var i=0;i<s;i++){var o=t.readASCII(e,r,4);r+=4;var l=t.readUshort(e,r);r+=2,a[o.trim()]=m._lctf.readScriptTable(e,n+l)}return a},m._lctf.readScriptTable=function(e,r){var t=m._bin,n=r,a={},s=t.readUshort(e,r);r+=2,a.default=m._lctf.readLangSysTable(e,n+s);var i=t.readUshort(e,r);r+=2;for(var o=0;o<i;o++){var l=t.readASCII(e,r,4);r+=4;var u=t.readUshort(e,r);r+=2,a[l.trim()]=m._lctf.readLangSysTable(e,n+u)}return a},m._lctf.readLangSysTable=function(e,r){var t=m._bin,n={};t.readUshort(e,r);r+=2,n.reqFeature=t.readUshort(e,r),r+=2;var a=t.readUshort(e,r);return r+=2,n.features=t.readUshorts(e,r,a),n},m.cmap={},m.cmap.parse=function(e,r,t){e=new Uint8Array(e.buffer,r,t);r=0;var n=m._bin,a={};n.readUshort(e,r);r+=2;var s=n.readUshort(e,r);r+=2;var i=[];a.tables=[];for(var o=0;o<s;o++){var l=n.readUshort(e,r);r+=2;var u=n.readUshort(e,r);r+=2;var c=n.readUint(e,r);r+=4;var f=\\\"p\\\"+l+\\\"e\\\"+u,h=i.indexOf(c);if(-1==h){var v;h=a.tables.length,i.push(c);var d=n.readUshort(e,c);0==d?v=m.cmap.parse0(e,c):4==d?v=m.cmap.parse4(e,c):6==d?v=m.cmap.parse6(e,c):12==d?v=m.cmap.parse12(e,c):console.log(\\\"unknown format: \\\"+d,l,u,c),a.tables.push(v)}if(null!=a[f])throw\\\"multiple tables for one platform+encoding\\\";a[f]=h}return a},m.cmap.parse0=function(e,r){var t=m._bin,n={};n.format=t.readUshort(e,r),r+=2;var a=t.readUshort(e,r);r+=2;t.readUshort(e,r);r+=2,n.map=[];for(var s=0;s<a-6;s++)n.map.push(e[r+s]);return n},m.cmap.parse4=function(e,r){var t=m._bin,n=r,a={};a.format=t.readUshort(e,r),r+=2;var s=t.readUshort(e,r);r+=2;t.readUshort(e,r);r+=2;var i=t.readUshort(e,r);r+=2;var o=i/2;a.searchRange=t.readUshort(e,r),r+=2,a.entrySelector=t.readUshort(e,r),r+=2,a.rangeShift=t.readUshort(e,r),r+=2,a.endCount=t.readUshorts(e,r,o),r+=2*o,r+=2,a.startCount=t.readUshorts(e,r,o),r+=2*o,a.idDelta=[];for(var l=0;l<o;l++)a.idDelta.push(t.readShort(e,r)),r+=2;for(a.idRangeOffset=t.readUshorts(e,r,o),r+=2*o,a.glyphIdArray=[];r<n+s;)a.glyphIdArray.push(t.readUshort(e,r)),r+=2;return a},m.cmap.parse6=function(e,r){var t=m._bin,n={};n.format=t.readUshort(e,r),r+=2;t.readUshort(e,r);r+=2;t.readUshort(e,r);r+=2,n.firstCode=t.readUshort(e,r),r+=2;var a=t.readUshort(e,r);r+=2,n.glyphIdArray=[];for(var s=0;s<a;s++)n.glyphIdArray.push(t.readUshort(e,r)),r+=2;return n},m.cmap.parse12=function(e,r){var t=m._bin,n={};n.format=t.readUshort(e,r),r+=2,r+=2;t.readUint(e,r);r+=4;t.readUint(e,r);r+=4;var a=t.readUint(e,r);r+=4,n.groups=[];for(var s=0;s<a;s++){var i=r+12*s,o=t.readUint(e,i+0),l=t.readUint(e,i+4),u=t.readUint(e,i+8);n.groups.push([o,l,u])}return n},m.GPOS={},m.GPOS.parse=function(e,r,t,n){return m._lctf.parse(e,r,t,n,m.GPOS.subt)},m.GPOS.subt=function(e,r,t){if(2!=r)return null;var n=m._bin,a=t,s={};s.format=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);t+=2,s.coverage=m._lctf.readCoverage(e,i+a),s.valFmt1=n.readUshort(e,t),t+=2,s.valFmt2=n.readUshort(e,t),t+=2;var o=m._lctf.numOfOnes(s.valFmt1),l=m._lctf.numOfOnes(s.valFmt2);if(1==s.format){s.pairsets=[];var u=n.readUshort(e,t);t+=2;for(var c=0;c<u;c++){var f=n.readUshort(e,t);t+=2,f+=a;var h=n.readUshort(e,f);f+=2;for(var v=[],d=0;d<h;d++){var b=n.readUshort(e,f);f+=2,0!=s.valFmt1&&(N=m._lctf.readValueRecord(e,f,s.valFmt1),f+=2*o),0!=s.valFmt2&&(U=m._lctf.readValueRecord(e,f,s.valFmt2),f+=2*l),v.push({gid2:b,val1:N,val2:U})}s.pairsets.push(v)}}if(2==s.format){var g=n.readUshort(e,t);t+=2;var p=n.readUshort(e,t);t+=2;var y=n.readUshort(e,t);t+=2;var L=n.readUshort(e,t);t+=2,s.classDef1=m._lctf.readClassDef(e,a+g),s.classDef2=m._lctf.readClassDef(e,a+p),s.matrix=[];for(c=0;c<y;c++){var A=[];for(d=0;d<L;d++){var N=null,U=null;0!=s.valFmt1&&(N=m._lctf.readValueRecord(e,t,s.valFmt1),t+=2*o),0!=s.valFmt2&&(U=m._lctf.readValueRecord(e,t,s.valFmt2),t+=2*l),A.push({val1:N,val2:U})}s.matrix.push(A)}}return s},m.GSUB={},m.GSUB.parse=function(e,r,t,n){return m._lctf.parse(e,r,t,n,m.GSUB.subt)},m.GSUB.subt=function(e,r,t){var n=m._bin,a=t,s={};if(1!=r&&4!=r)return null;s.fmt=n.readUshort(e,t),t+=2;var i=n.readUshort(e,t);if(t+=2,s.coverage=m._lctf.readCoverage(e,i+a),1==r){if(1==s.fmt)s.delta=n.readShort(e,t),t+=2;else if(2==s.fmt){var o=n.readUshort(e,t);t+=2,s.newg=n.readUshorts(e,t,o),t+=2*s.newg.length}}else if(4==r){s.vals=[];o=n.readUshort(e,t);t+=2;for(var l=0;l<o;l++){var u=n.readUshort(e,t);t+=2,s.vals.push(m.GSUB.readLigatureSet(e,a+u))}}return s},m.GSUB.readChainSubClassSet=function(e,r){var t=m._bin,n=r,a=[],s=t.readUshort(e,r);r+=2;for(var i=0;i<s;i++){var o=t.readUshort(e,r);r+=2,a.push(m.GSUB.readChainSubClassRule(e,n+o))}return a},m.GSUB.readChainSubClassRule=function(e,r){for(var t=m._bin,n={},a=[\\\"backtrack\\\",\\\"input\\\",\\\"lookahead\\\"],s=0;s<a.length;s++){var i=t.readUshort(e,r);r+=2,1==s&&i--,n[a[s]]=t.readUshorts(e,r,i),r+=2*n[a[s]].length}i=t.readUshort(e,r);return r+=2,n.subst=t.readUshorts(e,r,2*i),r+=2*n.subst.length,n},m.GSUB.readLigatureSet=function(e,r){var t=m._bin,n=r,a=[],s=t.readUshort(e,r);r+=2;for(var i=0;i<s;i++){var o=t.readUshort(e,r);r+=2,a.push(m.GSUB.readLigature(e,n+o))}return a},m.GSUB.readLigature=function(e,r){var t=m._bin,n={chain:[]};n.nglyph=t.readUshort(e,r),r+=2;var a=t.readUshort(e,r);r+=2;for(var s=0;s<a-1;s++)n.chain.push(t.readUshort(e,r)),r+=2;return n},m.head={},m.head.parse=function(e,r,t){var n=m._bin,a={};n.readFixed(e,r);r+=4,a.fontRevision=n.readFixed(e,r),r+=4;n.readUint(e,r);r+=4;n.readUint(e,r);return r+=4,a.flags=n.readUshort(e,r),r+=2,a.unitsPerEm=n.readUshort(e,r),r+=2,a.created=n.readUint64(e,r),r+=8,a.modified=n.readUint64(e,r),r+=8,a.xMin=n.readShort(e,r),r+=2,a.yMin=n.readShort(e,r),r+=2,a.xMax=n.readShort(e,r),r+=2,a.yMax=n.readShort(e,r),r+=2,a.macStyle=n.readUshort(e,r),r+=2,a.lowestRecPPEM=n.readUshort(e,r),r+=2,a.fontDirectionHint=n.readShort(e,r),r+=2,a.indexToLocFormat=n.readShort(e,r),r+=2,a.glyphDataFormat=n.readShort(e,r),r+=2,a},m.hhea={},m.hhea.parse=function(e,r,t){var n=m._bin,a={};n.readFixed(e,r);return r+=4,a.ascender=n.readShort(e,r),r+=2,a.descender=n.readShort(e,r),r+=2,a.lineGap=n.readShort(e,r),r+=2,a.advanceWidthMax=n.readUshort(e,r),r+=2,a.minLeftSideBearing=n.readShort(e,r),r+=2,a.minRightSideBearing=n.readShort(e,r),r+=2,a.xMaxExtent=n.readShort(e,r),r+=2,a.caretSlopeRise=n.readShort(e,r),r+=2,a.caretSlopeRun=n.readShort(e,r),r+=2,a.caretOffset=n.readShort(e,r),r+=2,r+=8,a.metricDataFormat=n.readShort(e,r),r+=2,a.numberOfHMetrics=n.readUshort(e,r),r+=2,a},m.hmtx={},m.hmtx.parse=function(e,r,t,n){for(var a=m._bin,s={aWidth:[],lsBearing:[]},i=0,o=0,l=0;l<n.maxp.numGlyphs;l++)l<n.hhea.numberOfHMetrics&&(i=a.readUshort(e,r),r+=2,o=a.readShort(e,r),r+=2),s.aWidth.push(i),s.lsBearing.push(o);return s},m.kern={},m.kern.parse=function(e,r,t,n){var a=m._bin,s=a.readUshort(e,r);if(r+=2,1==s)return m.kern.parseV1(e,r-2,t,n);var i=a.readUshort(e,r);r+=2;for(var o={glyph1:[],rval:[]},l=0;l<i;l++){r+=2;t=a.readUshort(e,r);r+=2;var u=a.readUshort(e,r);r+=2;var c=u>>>8;if(0!=(c&=15))throw\\\"unknown kern table format: \\\"+c;r=m.kern.readFormat0(e,r,o)}return o},m.kern.parseV1=function(e,r,t,n){var a=m._bin;a.readFixed(e,r);r+=4;var s=a.readUint(e,r);r+=4;for(var i={glyph1:[],rval:[]},o=0;o<s;o++){a.readUint(e,r);r+=4;var l=a.readUshort(e,r);r+=2;a.readUshort(e,r);r+=2;var u=l>>>8;if(0!=(u&=15))throw\\\"unknown kern table format: \\\"+u;r=m.kern.readFormat0(e,r,i)}return i},m.kern.readFormat0=function(e,r,t){var n=m._bin,a=-1,s=n.readUshort(e,r);r+=2;n.readUshort(e,r);r+=2;n.readUshort(e,r);r+=2;n.readUshort(e,r);r+=2;for(var i=0;i<s;i++){var o=n.readUshort(e,r);r+=2;var l=n.readUshort(e,r);r+=2;var u=n.readShort(e,r);r+=2,o!=a&&(t.glyph1.push(o),t.rval.push({glyph2:[],vals:[]}));var c=t.rval[t.rval.length-1];c.glyph2.push(l),c.vals.push(u),a=o}return r},m.maxp={},m.maxp.parse=function(e,r,t){var n=m._bin,a={},s=n.readUint(e,r);return r+=4,a.numGlyphs=n.readUshort(e,r),r+=2,65536==s&&(a.maxPoints=n.readUshort(e,r),r+=2,a.maxContours=n.readUshort(e,r),r+=2,a.maxCompositePoints=n.readUshort(e,r),r+=2,a.maxCompositeContours=n.readUshort(e,r),r+=2,a.maxZones=n.readUshort(e,r),r+=2,a.maxTwilightPoints=n.readUshort(e,r),r+=2,a.maxStorage=n.readUshort(e,r),r+=2,a.maxFunctionDefs=n.readUshort(e,r),r+=2,a.maxInstructionDefs=n.readUshort(e,r),r+=2,a.maxStackElements=n.readUshort(e,r),r+=2,a.maxSizeOfInstructions=n.readUshort(e,r),r+=2,a.maxComponentElements=n.readUshort(e,r),r+=2,a.maxComponentDepth=n.readUshort(e,r),r+=2),a},m.U={},m.U.codeToGlyph=function(e,r){var t=e.cmap,n=-1;if(null!=t.p0e4?n=t.p0e4:null!=t.p3e1?n=t.p3e1:null!=t.p1e0&&(n=t.p1e0),-1==n)throw\\\"no familiar platform and encoding!\\\";var a=t.tables[n];if(0==a.format)return r>=a.map.length?0:a.map[r];if(4==a.format){for(var s=-1,i=0;i<a.endCount.length;i++)if(r<=a.endCount[i]){s=i;break}if(-1==s)return 0;if(a.startCount[s]>r)return 0;return 65535&(0!=a.idRangeOffset[s]?a.glyphIdArray[r-a.startCount[s]+(a.idRangeOffset[s]>>1)-(a.idRangeOffset.length-s)]:r+a.idDelta[s])}if(12==a.format){if(r>a.groups[a.groups.length-1][1])return 0;for(i=0;i<a.groups.length;i++){var o=a.groups[i];if(o[0]<=r&&r<=o[1])return o[2]+(r-o[0])}return 0}throw\\\"unknown cmap table format \\\"+a.format},m.U._getGlyphClass=function(e,r){for(var t=0;t<r.start.length;t++)if(r.start[t]<=e&&r.end[t]>=e)return r.class[t];return 0},m.U.getPairAdjustment=function(e,r,t){if(e.GPOS){for(var n=null,a=0;a<e.GPOS.featureList.length;a++){var s=e.GPOS.featureList[a];if(\\\"kern\\\"==s.tag)for(var i=0;i<s.tab.length;i++)2==e.GPOS.lookupList[s.tab[i]].ltype&&(n=e.GPOS.lookupList[s.tab[i]])}if(n)for(a=0;a<n.tabs.length;a++){var o=n.tabs[a],l=m._lctf.coverageIndex(o.coverage,r);if(-1!=l){var u=0;if(1==o.format){var c=o.pairsets[l];for(i=0;i<c.length;i++)c[i].gid2==t&&(u=c[i]);if(null==u)continue}else if(2==o.format){var f=m.U._getGlyphClass(r,o.classDef1),h=m.U._getGlyphClass(t,o.classDef2);u=o.matrix[f][h]}return u.val1[2]}}}if(e.kern){var v=e.kern.glyph1.indexOf(r);if(-1!=v){var d=e.kern.rval[v].glyph2.indexOf(t);if(-1!=d)return e.kern.rval[v].vals[d]}}return 0},m.U.RTable=[1570,1571,1572,1573,1575,1577,1583,1584,1585,1586,1608,1649,1650,1651,1653,1654,1655,1672,1673,1674,1675,1676,1677,1678,1679,1680,1681,1682,1683,1684,1685,1686,1687,1688,1689,1728,1731,1732,1733,1734,1735,1736,1737,1738,1739,1741,1743,1746,1747,1749,1774,1775,1808,1813,1814,1815,1816,1817,1822,1832,1834,1836,1839,1869,1881,1882,1883,1899,1900,1905,1907,1908,1912,1913,2112,2118,2119,2121,2132,2151,2153,2154,2218,2219,2220,2222,2225,2226,2233,2757,2759,2761,2762,2766,2767,2768,2769,2770,2781,2785,2788,2799,2945,2947,2948,2949,2953,2956,2958,2959,2961,2985,2986,2987,2988],m.U.stringToGlyphs=function(e,r){var t,n,a,s,i,o,l,u,c,f,h,v,d,b=[],g=[],p=[],y=[],L=[],N=A(r,-1,!1),U=m.U.RTable;for(n=0,a=r.length;n<a;n++)u=r.charCodeAt(n),y.push(u),L.push(0),2765==u||2775==u||43122==u?L[n]=2:1548==u?L[n]=1:u<=63?9!=u&&10!=u&&32!=u&&33!=u&&34!=u&&40!=u&&41!=u&&44!=u&&46!=u&&58!=u&&59!=u&&63!=u||(L[n]=1):u>=1570&&u<=2988&&-1!=U.indexOf(u)&&(L[n]=3);for(n=0,a=r.length;n<a;n++)u=y[n],1!=L[n]&&n<a-2&&4156==(c=y[n+1])&&(y[n]=c,y[n+1]=u,n++);for(n=0,a=r.length;n<a;n++){for(u=y[n],s=0,i=e.length;s<i&&(h=e[s],!(t=m.U.codeToGlyph(h,u)));s++);b.push(t),g.push(t?s:0)}p=y,h=null;for(var w=0;w<b.length;w++)if(d=b[w],h!=g[w]&&(f=(h=e[g[w]]).GSUB),f){var x=L[w-1],S=L[w],M=L[w+1],B=0==w||1==x,O=w==b.length-1||1==M;if(B||3!=x||(B=!0),O||3!=S||(O=!0),O||2!=M||(O=!0),B||2!=S||(B=!0),v=null,v=B?O?h.gsubIsolTable:h.gsubInitTable:O?h.gsubFinaTable:h.gsubMediTable)for(l=0;l<v.length;l++){var _=v[l];for(s=0;s<_.length;s++){var k=_[s];-1!=(E=m._lctf.coverageIndex(k.coverage,d))&&(0==k.fmt?b[w]=E+k.delta:k.newg?b[w]=k.newg[E]:(b[w]=d,console.log(w,d,\\\"subst-error\\\",\\\" original:\\\",r)))}}}h=null;for(w=0;w<b.length;w++)if(d=b[w],h!=g[w]&&(f=(h=e[g[w]]).GSUB),f&&(v=h.gsubRligLigaTable)){var I=Math.min(3,b.length-w-1);for(l=0;l<v.length;l++){_=v[l];for(s=0;s<_.length;s++){var E;k=_[s];if(-1!=(E=m._lctf.coverageIndex(k.coverage,d))){var C=k.vals[E];for(o=0;o<C.length;o++){var F=C[o],z=F.chain.length;if(!(z>I)){for(var P=!0,j=0;j<z;j++)F.chain[j]!=b[w+(1+j)]&&(P=!1);if(P){b[w]=F.nglyph;for(j=0;j<z;j++)b[w+j+1]=-1}}}}}}}var T=N.indices,V=b.slice(),G=p.slice(),X=g.slice();for(n=0,a=b.length;n<a;n++)u=T[n],V[n]=b[u],G[n]=p[u],X[n]=g[u];return[V,X,G]};var N=n,U=s,w=function(e){var r=e[0],t=e[1];return e=e[2],Math.sqrt(r*r+t*t+e*e)},x=i,S=m,M=function(e,r,t,n,a,s,i,o,l,u,c,f,h,v,d,b){var g,p=u[d],y=[0,0,0];N.geocent&&!h?(g=[0,0,0],U(N.bboxMin,y),x(y,r,g)):g=[-r[1],r[0],0],x(r,g,y);var L=[e[0],e[1],e[2]],A=[L[0],L[1],L[2]],m=p.glyphs[n];if(n=0,!m)return[e,i,o,0];var w=0,S=l[0],M=l[1],B=l[2];if(9==n||32==n)(m=chars[32])&&(e[0]+=r[0]*m.step*a*s,e[1]+=r[1]*m.step*a*s,w=m.lx*a);else if(0==m.lx)e[0]=e[0]+r[0]*m.step*a*s,e[1]=e[1]+r[1]*m.step*a*s,w=m.lx*a;else{var O=4e3*d,_=m.plane+O;v&&(v[d]||(v[d]={}),v[d][_]=!0);var k=m.lx*a,I=m.ly*a;if(b)if(N.processLineLabel&&N.useLineLabel2){L[0]=L[0]+r[0]*m.sx*a,L[1]=L[1]+r[1]*m.sx*a,L[2]=L[2]+r[2]*m.sx*a,L[0]=L[0]+g[0]*(m.sy-p.size)*a,L[1]=L[1]+g[1]*(m.sy-p.size)*a,L[2]=L[2]+g[2]*(m.sy-p.size)*a;var E=[(V=[g[0]*t,g[1]*t,g[2]*t])[0]+g[0]*I,V[1]+g[1]*I,V[2]+g[2]*I];b[i]=L[0]-V[0],b[i+1]=L[1]-V[1],b[i+2]=L[2]-V[2];var C=function(e){var r,t,n,a,s,i=e[0][0]+e[1][1]+e[2][2];return i>0?(a=.25*(s=2*Math.sqrt(i+1)),r=(e[2][1]-e[1][2])/s,t=(e[0][2]-e[2][0])/s,n=(e[1][0]-e[0][1])/s):e[0][0]>e[1][1]&e[0][0]>e[2][2]?(s=2*Math.sqrt(1+e[0][0]-e[1][1]-e[2][2]),a=(e[2][1]-e[1][2])/s,r=.25*s,t=(e[0][1]+e[1][0])/s,n=(e[0][2]+e[2][0])/s):e[1][1]>e[2][2]?(s=2*Math.sqrt(1+e[1][1]-e[0][0]-e[2][2]),a=(e[0][2]-e[2][0])/s,r=(e[0][1]+e[1][0])/s,t=.25*s,n=(e[1][2]+e[2][1])/s):(s=2*Math.sqrt(1+e[2][2]-e[0][0]-e[1][1]),a=(e[1][0]-e[0][1])/s,r=(e[0][2]+e[2][0])/s,t=(e[1][2]+e[2][1])/s,n=.25*s),[r,t,n,a]}([[r[0],r[1],r[2]],[g[0],g[1],g[2]],[y[0],y[1],y[2]]]);b[i+3]=C[0],b[i+4]=C[1],b[i+5]=C[2],b[i+6]=C[3],N.lineLabelPass||(b[i+7]=k,b[i+8]=I),b[i+9]=m.u1,b[i+10]=m.v1+O;var F=1024*(m.u2-m.u1),z=m.v2-m.v1;b[i+11]=F+z;var P=.5*r[0]*k-.5*g[0]*I-V[0],j=.5*r[1]*k-.5*g[1]*I-V[1],T=.5*r[2]*k-.5*g[2]*I-V[2];N.lineLabelPoints.push([L[0]+P,L[1]+j,L[2]+T,.5*Math.sqrt(k*k+I*I),b[i],b[i+1],b[i+2],b[i+3],b[i+4],b[i+5],b[i+6],k,I]),i+=12}else b[i]=L[0]+m.sx*a,b[i+1]=L[1]+(m.sy-p.size)*a,b[i+2]=b[i]+k,b[i+3]=b[i+1]-I,b[i+4]=m.u1,b[i+5]=m.v1+O,b[i+6]=m.u2,b[i+7]=m.v2+O,i+=8;else{var V;E=[(V=[g[0]*t,g[1]*t,g[2]*t])[0]+g[0]*I,V[1]+g[1]*I,V[2]+g[2]*I];L[0]=L[0]+r[0]*m.sx*a,L[1]=L[1]+r[1]*m.sx*a,L[2]=L[2]+r[2]*m.sx*a,L[0]=L[0]+g[0]*(m.sy-p.size)*a,L[1]=L[1]+g[1]*(m.sy-p.size)*a,L[2]=L[2]+g[2]*(m.sy-p.size)*a,A[0]=L[0]+r[0]*k,A[1]=L[1]+r[1]*k,A[2]=L[2]+r[2]*k,c[i]=L[0]-V[0],c[i+1]=L[1]-V[1],c[i+2]=L[2]-V[2],c[i+3]=B,f[o]=m.u1,f[o+1]=m.v1+O,f[o+2]=S,f[o+3]=M,c[i+4]=L[0]-E[0],c[i+5]=L[1]-E[1],c[i+6]=L[2]-E[2],c[i+7]=B,f[o+4]=m.u1,f[o+5]=m.v2+O,f[o+6]=S,f[o+7]=M,c[i+8]=A[0]-V[0],c[i+9]=A[1]-V[1],c[i+10]=A[2]-V[2],c[i+11]=B,f[o+8]=m.u2,f[o+9]=m.v1+O,f[o+10]=S,f[o+11]=M,c[i+12]=L[0]-E[0],c[i+13]=L[1]-E[1],c[i+14]=L[2]-E[2],c[i+15]=B,f[o+12]=m.u1,f[o+13]=m.v2+O,f[o+14]=S,f[o+15]=M,c[i+16]=A[0]-E[0],c[i+17]=A[1]-E[1],c[i+18]=A[2]-E[2],c[i+19]=B,f[o+16]=m.u2,f[o+17]=m.v2+O,f[o+18]=S,f[o+19]=M,c[i+20]=A[0]-V[0],c[i+21]=A[1]-V[1],c[i+22]=A[2]-V[2],c[i+23]=B,f[o+20]=m.u2,f[o+21]=m.v1+O,f[o+22]=S,f[o+23]=M,i+=24,o+=24}e[0]=e[0]+r[0]*m.step*a*s,e[1]=e[1]+r[1]*m.step*a*s,w=m.lx*a}return[e,i,o,w*s]},B=function(e){return 3*(e?3:4)*2},O=function(e,r){return r?e/r.size*1.52:1},_=function(e,r,t,n,a){for(var s=0,i=a||S.U.stringToGlyphs(n,e),o=i[0],l=i[1],u=0,c=o.length;u<c;u++){var f=o[u],h=n[l[u]];if(h){var v=O(r,h)*t,d=h.glyphs[f];d&&(s+=u==c-1?d.lx*v:d.step*v)}}return s},k=function(e){for(var r=0,t=0,n=e.length-1;t<n;t++){var a=e[t],s=e[t+1],i=[s[0]-a[0],s[1]-a[1],s[2]-a[2]];r+=w(i)}return r},I=function(e,r){for(var t=0,n=[0,0,0],a=[1,0,0],s=0,i=e.length-1;s<i;s++){n=e[s];var o=e[s+1];a=[o[0]-n[0],o[1]-n[1],o[2]-n[2]];var l=w(a);if(t+l>r){var u=(r-t)/l,c=[n[0]+a[0]*u,n[1]+a[1]*u,n[2]+a[2]*u];return U(a),[c,a]}t+=l}return[n,a]},E=function(e,r,t,n,a,s,i){for(var o=0,l=[0,0,0],u=[1,0,0],c=[0,0,0],f=r,h=r+_(t,n,a,s,i),v=N.bboxMin,d=N.geocent,b=0,g=e.length-1;b<g;b++){l=e[b];var p=e[b+1];if(u=[p[0]-l[0],p[1]-l[1],p[2]-l[2]],(o+=w(u))>f&&(U(u),c[0]+=u[0],c[1]+=u[1],c[2]+=u[2]),o>h){if(U(c),d){var y=[0,0,0];return U(v,y),x(y,c,y),y}return[-c[1],c[0],0]}}return c},C=function(e,r,t){return!(!e||\\\"\\\"==e)&&-1==(t||S.U.stringToGlyphs(r,e))[0].indexOf(0)},F=function(e){for(var r=[],t=0,n=e.length;t<n;t++)r.push(N.fonts[e[t]]);return r},z=function(e){for(var r=[],t=0,n=e.length;t<n;t++)r.push(N.fontsMap[e[t]]);return r},P=function(e,r){return S.U.stringToGlyphs(r,e)},j=n,T=a,V=function(e,r){if(!e||\\\"\\\"==e)return\\\"\\\";var t,n,a=e.indexOf(\\\"{\\\");if(-1==a)return e;n=a>0?e.substring(0,a):\\\"\\\";var s=0,i=-1;for(t=e.length;a<t;a++){var o=e.charAt(a);\\\"{\\\"==o?(0==s&&(i=a),s++):\\\"}\\\"==o?0==--s&&(n+=r(e.substring(i+1,a))):0==s&&(n+=o)}return n},G=function(e){if(!e||0===e.length)return 0;for(var r=0,t=0,n=e.length;t<n;t++)r=(r<<5)-r+e.charCodeAt(t),r|=0;return r},X=function(e){for(var r=0,t=e.length;r<t;r++){var n=e.charCodeAt(r);if(n>=65&&n<=90||n>=97&&n<=122||n>=192&&n<=255&&215!=n&&247!=n||n>=256&&n<=383)return!0}return!1},D=function(e){for(var r=0,t=e.length;r<t;r++){var n=e.charCodeAt(r);if(!(n>=19968&&n<=25343||n>=25344&&n<=30719||n>=30720&&n<=36095||n>=36096&&n<=40959||n>=13312&&n<=19903||n>=131072&&n<=136703||n>=136704&&n<=143615||n>=143616&&n<=148991||n>=148992&&n<=155903||n>=155904&&n<=161279||n>=161280&&n<=168191||n>=168192&&n<=173791||n>=173824&&n<=177983||n>=177984&&n<=178207||n>=178208&&n<=183983||n>=183984&&n<=191471||n>=63744&&n<=64255||n>=13056&&n<=13311||n>=65072&&n<=65103||n>=63744&&n<=64255||n>=194560&&n<=195103||n>=0&&n<=64||n>=160&&n<=191))return!1}return!0},R=C,$=function(e,r,t,n,a,s){var i;if(s||(s=0),!(s>100)){switch(typeof r){case\\\"string\\\":if(r.length>0){switch(r.charAt(0)){case\\\"#\\\":case\\\"$\\\":case\\\"@\\\":case\\\"&\\\":case\\\"%\\\":return void 0===(i=Y(e,a,t,n,r,s+1))&&W(\\\"wrong-expresion\\\",e[\\\"$$layer-id\\\"],r,r,null,\\\"feature-property\\\"),i}return V(r,(function(o){if(o.length>0){switch(o.charAt(0)){case\\\"#\\\":case\\\"$\\\":case\\\"@\\\":case\\\"&\\\":case\\\"%\\\":return void 0===(i=Y(e,a,t,n,o,s+1))&&W(\\\"wrong-expresion\\\",e[\\\"$$layer-id\\\"],r,r,null,\\\"feature-property\\\"),i}if(-1!=o.indexOf(\\\"{\\\")){try{o=o.replace(/'/g,'\\\"'),i=JSON.parse(o)}catch(t){return W(\\\"wrong-expresion\\\",e[\\\"$$layer-id\\\"],r,r,null,\\\"feature-property\\\"),\\\"\\\"}return void 0===i?(W(\\\"wrong-expresion\\\",e[\\\"$$layer-id\\\"],r,r,null,\\\"feature-property\\\"),\\\"\\\"):H(e,a,t,n,i,s+1)}return o}}))}}return r}},q=function(e,r,t,n){var a=H(e,r,t,n);return K(e[\\\"$$layer-id\\\"],r,a)},Y=function(e,r,t,n,a,s){var i=a;switch(a.charAt(0)){case\\\"$\\\":i=t.properties[a.substr(1)];break;case\\\"@\\\":i=j.stylesheetConstants[a];break;case\\\"%\\\":i=j.stylesheetVariables[a.substr(1)];break;case\\\"&\\\":i=j.stylesheetLocals[a];break;case\\\"#\\\":switch(a){case\\\"#id\\\":return t.id;case\\\"#type\\\":return j.featureType;case\\\"#group\\\":return j.groupId;case\\\"#lod\\\":return j.tileLod;case\\\"#ix\\\":return j.tileIX;case\\\"#iy\\\":return j.tileIY;case\\\"#tileSize\\\":return j.tileSize;case\\\"#pixelSize\\\":return j.pixelSize;case\\\"#metric\\\":return j.metricUnits;case\\\"#dpr\\\":return j.pixelFactor;case\\\"#language\\\":return j.language}}return\\\"&\\\"==a.charAt(0)?void 0===i&&void 0!==(i=e[a])&&(\\\"string\\\"==typeof i?i=$(e,i,t,n,r,s+1):void 0!==i&&(i=H(e,r,t,n,i,s+1)),j.stylesheetLocals[a]=i):\\\"string\\\"==typeof i?i=$(e,i,t,n,r,s+1):void 0!==i&&\\\"@\\\"==a.charAt(0)&&(i=H(e,r,t,n,i,s+1)),i},H=function(e,r,t,n,a,s){var i,o,l,u,c,f;if(void 0===a)a=e[r],i=!0,s=0;else if(s>100)return;switch(typeof a){case\\\"string\\\":return a.length>0?void 0!==(d=Y(e,r,t,n,a,s))?d:(W(\\\"wrong-object\\\",e[\\\"$$layer-id\\\"],r,a,null,\\\"feature-property\\\"),i?Q(r):void 0):a;case\\\"object\\\":if(null==a)return i?Q(r):void 0;if(Array.isArray(a)){if(\\\"icon-source\\\"==r&&null==j.stylesheetBitmaps[a[0]])return W(\\\"wrong-object\\\",e[\\\"$$layer-id\\\"],r,a,null,\\\"bitmap\\\"),i?Q(r):void 0;if(\\\"filter\\\"!=r){for(f=new Array(a.length),_=0,k=a.length;_<k;_++)f[_]=H(e,r,t,n,a[_],s+1);return f}return a}var h,v,d;for(h in a)break;if(!h)return i?Q(r):void 0;switch(N=a[h],h){case\\\"if\\\":if(Array.isArray(N)&&3==N.length){if(void 0!==(d=ee(N[0],t,j.featureType,j.groupId,e,r,n,0)?H(e,r,t,n,N[1],s+1):H(e,r,t,n,N[2],s+1)))return d;v=!0}else v=!0;break;case\\\"add\\\":case\\\"sub\\\":case\\\"mul\\\":case\\\"div\\\":case\\\"mod\\\":case\\\"pow\\\":case\\\"tofixed\\\":case\\\"atan2\\\":case\\\"random\\\":if(Array.isArray(N)&&2==N.length)if(o=H(e,r,t,n,N[0],s+1),l=H(e,r,t,n,N[1],s+1),\\\"number\\\"!=typeof o||\\\"number\\\"!=typeof l)v=!0;else switch(h){case\\\"add\\\":return o+l;case\\\"sub\\\":return o-l;case\\\"mul\\\":return o*l;case\\\"div\\\":return o/l;case\\\"mod\\\":return o%l;case\\\"pow\\\":return Math.pow(o,l);case\\\"atan2\\\":return Math.atan2(o,l);case\\\"tofixed\\\":return o.tofixed(l);case\\\"random\\\":return o+Math.random()*(l-o)}else v=!0;break;case\\\"clamp\\\":if(Array.isArray(N)&&3==N.length){if(o=H(e,r,t,n,N[0],s+1),l=H(e,r,t,n,N[1],s+1),u=H(e,r,t,n,N[2],s+1),\\\"number\\\"==typeof o&&\\\"number\\\"==typeof l&&\\\"number\\\"==typeof u)return T(o,l,u);v=!0}else v=!0;break;case\\\"logScale\\\":case\\\"log-scale\\\":if(!Array.isArray(N)||N.length<2)v=!0;else{if(o=H(e,r,t,n,N[0],s+1),l=H(e,r,t,n,N[1],s+1),u=0,c=100,N.length>2&&\\\"number\\\"!=typeof(u=H(e,r,t,n,N[2],s+1))&&(v=!0),N.length>3&&\\\"number\\\"!=typeof(c=H(e,r,t,n,N[3],s+1))&&(v=!0),!v&&\\\"number\\\"==typeof o&&\\\"number\\\"==typeof l){var b=u,g=l,p=o;return p>g&&(p=g),_=(c-b)/Math.log(g+1)*Math.log(p+1)+b}v=!0}break;case\\\"sgn\\\":case\\\"sin\\\":case\\\"cos\\\":case\\\"tan\\\":case\\\"asin\\\":case\\\"acos\\\":case\\\"atan\\\":case\\\"sqrt\\\":case\\\"abs\\\":case\\\"log\\\":case\\\"round\\\":case\\\"floor\\\":case\\\"ceil\\\":case\\\"deg2rad\\\":case\\\"rad2deg\\\":if(\\\"number\\\"!=typeof(N=H(e,r,t,n,N,s+1)))v=!0;else switch(h){case\\\"sgn\\\":return N<0?-1:1;case\\\"sin\\\":return Math.sin(N);case\\\"cos\\\":return Math.cos(N);case\\\"tan\\\":return Math.tan(N);case\\\"asin\\\":return Math.asin(N);case\\\"acos\\\":return Math.acos(N);case\\\"atan\\\":return Math.atan(N);case\\\"sqrt\\\":return Math.sqrt(N);case\\\"abs\\\":return Math.abs(N);case\\\"log\\\":return Math.log(N);case\\\"round\\\":return Math.round(N);case\\\"floor\\\":return Math.floor(N);case\\\"ceil\\\":return Math.ceil(N);case\\\"deg2rad\\\":return N/180*Math.PI;case\\\"rad2deg\\\":return N/Math.PI*180}break;case\\\"strlen\\\":case\\\"trim\\\":case\\\"str2num\\\":case\\\"lowercase\\\":case\\\"uppercase\\\":case\\\"capitalize\\\":case\\\"has-fonts\\\":case\\\"has-latin\\\":case\\\"is-cjk\\\":if(\\\"string\\\"!=typeof(N=H(e,r,t,n,N,s+1))){if(\\\"number\\\"==typeof N)return N;v=!0}else switch(h){case\\\"strlen\\\":return N.length;case\\\"trim\\\":return N.trim();case\\\"str2num\\\":return parseFloat(N);case\\\"lowercase\\\":return N.toLowerCase();case\\\"uppercase\\\":return N.toUpperCase();case\\\"capitalize\\\":return N.replace(/(?:^|\\\\s)\\\\S/g,(function(e){return e.toUpperCase()}));case\\\"has-fonts\\\":return R(N);case\\\"has-latin\\\":return X(N);case\\\"is-cjk\\\":return D(N)}break;case\\\"find\\\":case\\\"replace\\\":case\\\"substr\\\":if(Array.isArray(N)&&N.length>=2){if(o=H(e,r,t,n,N[0],s+1),l=H(e,r,t,n,N[1],s+1),\\\"find\\\"==h&&\\\"string\\\"==typeof o&&\\\"string\\\"==typeof l)return o.indexOf(l);if(\\\"replace\\\"==h&&3==N.length&&(u=H(e,r,t,n,N[2],s+1),\\\"string\\\"==typeof o&&\\\"string\\\"==typeof l&&\\\"string\\\"==typeof u))return o.replace(l,u);if(\\\"substr\\\"==h)if(2==N.length){if(\\\"string\\\"==typeof o&&\\\"number\\\"==typeof l)return o.substr(l)}else if(u=H(e,r,t,n,N[2],s+1),\\\"string\\\"==typeof o&&\\\"number\\\"==typeof l&&\\\"number\\\"==typeof u)return o.substr(l,u)}v=!0;break;case\\\"min\\\":case\\\"max\\\":if(Array.isArray(N)){for(d=H(e,r,t,n,N[0],s+1),_=0,k=N.length;_<k;_++){if(\\\"number\\\"!=typeof(f=H(e,r,t,n,N[_],s+1))){v=!0;break}d=\\\"max\\\"==h?Math.max(d,f):Math.min(d,f)}return d}v=!0;break;case\\\"map\\\":if(Array.isArray(N)){d=H(e,r,t,n,N[0],s+1);var y=N[1];if(Array.isArray(y))for(_=0,k=y.length;_<k;_++){var L=y[_];if(!Array.isArray(L)){v=!0;break}if(d==H(e,r,t,n,L[0],s+1))return H(e,r,t,n,L[1],s+1)}else v=!0;return H(e,r,t,n,N[2],s+1)}v=!0;break;case\\\"linear\\\":case\\\"linear2\\\":case\\\"discrete\\\":case\\\"discrete2\\\":case\\\"lod-scaled\\\":var A=null,m=null,N=n;if(null!=a[\\\"lod-scaled\\\"]){var U;if(\\\"number\\\"==typeof(U=a[\\\"lod-scaled\\\"])[1])return U[1]*Math.pow(2*U[2],U[0]-n);A=U[1],m=U}if(null!=a.discrete2||null!=a.linear2)A=(U=a.discrete2||a.linear2)[1],N=H(e,r,t,n,U[0],s+1);else A=a.discrete||a.linear;for(var w,x,S=A[0][0],M=A[0][1],B=typeof M,O=M,_=0,k=A.length;_<=k;_++){if(_==k){O=M;break}if(A[_][0]>N){if(null!=a.discrete||null!=a.discrete2||null!=m){O=M;break}if(w=A[_][0],x=A[_][1],w==S)break;switch(B){case\\\"boolean\\\":O=(O=(M=M?1:0)+(N-S)/(w-S)*((x=M?1:0)-M))>.5;break;case\\\"number\\\":O=M+(N-S)/(w-S)*(x-M);break;case\\\"object\\\":O=[];for(var I=0,E=M.length;I<E;I++)O[I]=M[I]+(x[I]-M[I])*((N-S)/(w-S))}break}S=A[_][0],M=A[_][1]}return null!=m&&(O*=Math.pow(2*m[2],m[0]-N)),O;default:v=!0}if(v)return i?Q(r):void 0;case\\\"number\\\":case\\\"boolean\\\":return a}return i?Q(r):void 0},J=function(e,r,t,n,a){if(a>100)W(\\\"custom\\\",\\\"infinite inherit loop in Layer: \\\"+e);else if(null!=t.inherit){var s=n.layers[t.inherit];if(null==s)return W(\\\"wrong-object\\\",e,\\\"inherit\\\",s,\\\"Layer\\\"),Q(i);for(var i in null!=s.inherit&&J(t.inherit,r,s,n,a++),s)r[i]=s[i]}},W=function(e,r,t,n,a,s){if(!j.disableLog){\\\"object\\\"==typeof n&&(n=JSON.stringify(n));var i=null;switch(e){case\\\"wrong-property-value\\\":i=\\\"Error: wrong layer property \\\"+(s?\\\"'\\\"+s+\\\"'\\\":\\\"\\\")+\\\": \\\"+r+\\\".\\\"+t+\\\" = \\\"+n;break;case\\\"wrong-property-value[]\\\":i=\\\"Error: wrong layer property \\\"+(s?\\\"'\\\"+s+\\\"'\\\":\\\"\\\")+\\\"[\\\"+a+\\\"]: \\\"+r+\\\".\\\"+t+\\\" = \\\"+n;break;case\\\"wrong-object\\\":i=\\\"Error: reffered \\\"+s+\\\" does not exist: \\\"+r+\\\".\\\"+t+\\\" = \\\"+n;break;case\\\"wrong-object[]\\\":i=\\\"Error: reffered \\\"+s+\\\" does not exist: \\\"+r+\\\".\\\"+t+\\\"[\\\"+a+\\\"] = \\\"+n;break;case\\\"wrong-Layer\\\":i=\\\"Error: reffered \\\"+s+\\\" Layer does not exist: \\\"+s+\\\"[\\\"+a+\\\"].Layer = \\\"+r;break;case\\\"wrong-bitmap\\\":i=\\\"Error: wrong definition of bitmap: \\\"+r;break;case\\\"custom\\\":i=\\\"Error: \\\"+r}i&&j.log&&console.log(i)}},Z=function(e,r,t,n,a,s,i,o){var l,u;if(null!=t&&\\\"object\\\"==typeof t&&!Array.isArray(t))return W(\\\"wrong-property-value\\\",e,r,t),Q(r);if(typeof t!=n&&(null!==t||\\\"icon-source\\\"!=r&&\\\"visibility\\\"!=r&&\\\"label-no-overlap-factor\\\"!=r))return W(\\\"wrong-property-value\\\",e,r,t),Q(r);switch(typeof t){case\\\"object\\\":if(null===t)return t;if(\\\"reduce\\\"==r||\\\"dynamic-reduce\\\"==r||\\\"label-no-overlap-factor\\\"==r||\\\"line-points\\\"==r){if(!(Array.isArray(t)&&t.length>0&&\\\"string\\\"==typeof t[0]))return W(\\\"wrong-property-value\\\",e,r,t),Q(r);if(\\\"line-points\\\"==r){if(\\\"vertices\\\"!=t[0]&&\\\"by-length\\\"!=t[0]&&\\\"by-ratio\\\"!=t[0]&&\\\"endpoints\\\"!=t[0]&&\\\"start\\\"!=t[0]&&\\\"end\\\"!=t[0]&&\\\"middle\\\"!=t[0]&&\\\"midpoint\\\"!=t[0])return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}else if(\\\"dynamic-reduce\\\"==r){if(\\\"by-extenal-param\\\"==t[0]&&(t[0]=j.reduceMode),\\\"tilt\\\"!=t[0]&&\\\"tilt-cos\\\"!=t[0]&&\\\"tilt-cos2\\\"!=t[0]&&\\\"scr-count\\\"!=t[0]&&\\\"scr-count2\\\"!=t[0]&&\\\"scr-count3\\\"!=t[0]&&\\\"scr-count4\\\"!=t[0]&&\\\"scr-count5\\\"!=t[0]&&\\\"scr-count6\\\"!=t[0]&&\\\"scr-count7\\\"!=t[0]&&\\\"scr-count8\\\"!=t[0]||\\\"number\\\"!=typeof t[1]||\\\"number\\\"!=typeof t[2]&&\\\"scr-count4\\\"!=t[0]&&\\\"scr-count5\\\"!=t[0]&&\\\"scr-count6\\\"!=t[0]&&\\\"scr-count7\\\"!=t[0]&&\\\"scr-count8\\\"!=t[0])return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}else if(\\\"reduce\\\"==r){if(\\\"odd\\\"!=t[0]&&\\\"even\\\"!=t&&(\\\"number\\\"!=typeof t[1]||(\\\"top\\\"!=t[0]||\\\"bottom\\\"!=t)&&\\\"string\\\"!=typeof t[2]))return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}else if(\\\"label-no-overlap-factor\\\"==r&&\\\"direct\\\"!=t[0]&&\\\"div-by-dist\\\"!=t[0])return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}if(\\\"next-pass\\\"==r||\\\"visibility-switch\\\"==r){var c=\\\"visibility-switch\\\"==r;if(!(Array.isArray(t)&&t.length>0))return W(\\\"wrong-property-value\\\",e,r,t),Q(r);for(l=0;l<u;l++){var f=t[l];if(\\\"object\\\"!=typeof f||!Array.isArray(f)||2!=f.length||\\\"number\\\"!=typeof f[0]||!(\\\"string\\\"==typeof f[1]||c&&null===f[1]))return W(\\\"wrong-property-value[]\\\",e,r,t,l),Q(r);if(\\\"string\\\"==typeof f[1]&&\\\"@\\\"==f[1].charAt(0)){if(void 0===j.stylesheetConstants[f[1]])return W(\\\"wrong-property-value[]\\\",e,r,t,l),Q(r);f[1]=j.stylesheetConstants[f[1]]}}}if(\\\"label-font\\\"==r||\\\"line-label-font\\\"==r){if(!Array.isArray(t)||t.length<1)return W(\\\"wrong-property-value[]\\\",e,r,t,0),Q(r);for(l=0,u=t.length;l<u;l++)if(\\\"string\\\"!=typeof t[l]||!j.fonts[t[l]])return W(\\\"wrong-property-value[]\\\",e,r,t,0),Q(r);return t}if(null!=a){if(Array.isArray(t)&&(t.length==a||t.length>=7)){if(l=0,\\\"icon-source\\\"==r||\\\"line-style-texture\\\"==r){if(\\\"string\\\"!=typeof t[0])return W(\\\"wrong-property-value[]\\\",e,r,t,0),Q(r);if(null==j.stylesheetBitmaps[t[0]])return W(\\\"wrong-object\\\",e,r,t,null,\\\"bitmap\\\"),Q(r);l=1}for(u=t.length;l<u;l++)if(\\\"number\\\"!=typeof t[l])return W(\\\"wrong-property-value[]\\\",e,r,t,l),Q(r);return 7==t.length&&(t[7]=0),t}return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}return t;case\\\"string\\\":if(\\\"line-type\\\"==r||\\\"point-type\\\"==r)switch(t){case\\\"screen\\\":case\\\"flat\\\":case\\\"screen-flat\\\":return t;default:return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}if(\\\"line-label-type\\\"==r)switch(t){case\\\"flat\\\":case\\\"screen-flat\\\":return t;default:return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}if(\\\"line-style\\\"==r)switch(t){case\\\"solid\\\":case\\\"texture\\\":return t;default:return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}if(\\\"label-size-units\\\"==r)switch(t){case\\\"pixels\\\":case\\\"points\\\":return t;default:return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}if(\\\"line-width-units\\\"==r)switch(t){case\\\"pixels\\\":case\\\"points\\\":case\\\"meters\\\":case\\\"ratio\\\":return t;default:return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}if(\\\"label-origin\\\"==r||\\\"icon-origin\\\"==r)switch(t){case\\\"top-left\\\":case\\\"top-right\\\":case\\\"top-center\\\":case\\\"center-left\\\":case\\\"center-right\\\":case\\\"center-center\\\":case\\\"bottom-left\\\":case\\\"bottom-right\\\":case\\\"bottom-center\\\":return t;default:return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}if(\\\"label-align\\\"==r)switch(t){case\\\"left\\\":case\\\"right\\\":case\\\"center\\\":return t;default:return W(\\\"wrong-property-value\\\",e,r,t),Q(r)}return t;case\\\"number\\\":return t>i||t<s?(W(\\\"wrong-property-value\\\",e,r,t),Q(r)):t;case\\\"boolean\\\":return t}},K=function(e,r,t){switch(r){case\\\"inherit\\\":return Z(e,r,t,\\\"string\\\");case\\\"reduce\\\":case\\\"dynamic-reduce\\\":case\\\"line-points\\\":return Z(e,r,t,\\\"object\\\");case\\\"line\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"line-type\\\":return Z(e,r,t,\\\"string\\\");case\\\"line-flat\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"line-width\\\":return Z(e,r,t,\\\"number\\\",null,1e-4,Number.MAX_VALUE);case\\\"line-width-units\\\":return Z(e,r,t,\\\"string\\\");case\\\"line-color\\\":return Z(e,r,t,\\\"object\\\",4,0,255);case\\\"line-style\\\":return Z(e,r,t,\\\"string\\\");case\\\"line-style-texture\\\":return Z(e,r,t,\\\"object\\\",3,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"line-style-background\\\":return Z(e,r,t,\\\"object\\\",4,0,255);case\\\"line-label\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"line-label-type\\\":case\\\"line-label-source\\\":return Z(e,r,t,\\\"string\\\");case\\\"line-label-color\\\":case\\\"line-label-color2\\\":return Z(e,r,t,\\\"object\\\",4,0,255);case\\\"line-label-size\\\":return Z(e,r,t,\\\"number\\\",null,1e-4,Number.MAX_VALUE);case\\\"line-label-offset\\\":return Z(e,r,t,\\\"number\\\",null,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"line-label-spacing\\\":case\\\"line-label-line-height\\\":return Z(e,r,t,\\\"number\\\",null,1e-4,Number.MAX_VALUE);case\\\"line-label-no-overlap\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"line-label-no-overlap-factor\\\":return Z(e,r,t,\\\"object\\\");case\\\"line-label-no-overlap-margin\\\":return Z(e,r,t,\\\"number\\\",null,1e-4,Number.MAX_VALUE);case\\\"point\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"point-type\\\":return Z(e,r,t,\\\"string\\\");case\\\"point-flat\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"point-radius\\\":return Z(e,r,t,\\\"number\\\",null,1e-4,Number.MAX_VALUE);case\\\"point-Layer\\\":return Z(e,r,t,\\\"string\\\");case\\\"point-color\\\":return Z(e,r,t,\\\"object\\\",4,0,255);case\\\"icon\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"icon-source\\\":return Z(e,r,t,\\\"object\\\",5,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"icon-scale\\\":return Z(e,r,t,\\\"number\\\",null,1e-4,Number.MAX_VALUE);case\\\"icon-offset\\\":return Z(e,r,t,\\\"object\\\",2,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"icon-origin\\\":return Z(e,r,t,\\\"string\\\");case\\\"icon-stick\\\":return Z(e,r,t,\\\"object\\\",8,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"icon-color\\\":return Z(e,r,t,\\\"object\\\",4,0,255);case\\\"icon-no-overlap\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"icon-no-overlap-factor\\\":return Z(e,r,t,\\\"object\\\");case\\\"icon-no-overlap-margin\\\":return Z(e,r,t,\\\"object\\\",2,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"label\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"label-color\\\":case\\\"label-color2\\\":return Z(e,r,t,\\\"object\\\",4,0,255);case\\\"label-source\\\":return Z(e,r,t,\\\"string\\\");case\\\"label-size\\\":return Z(e,r,t,\\\"number\\\",null,1e-4,Number.MAX_VALUE);case\\\"label-size-units\\\":return Z(e,r,t,\\\"string\\\");case\\\"label-spacing\\\":case\\\"label-line-height\\\":return Z(e,r,t,\\\"number\\\",null,1e-4,Number.MAX_VALUE);case\\\"label-offset\\\":return Z(e,r,t,\\\"object\\\",2,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"label-origin\\\":case\\\"label-align\\\":return Z(e,r,t,\\\"string\\\");case\\\"label-stick\\\":return Z(e,r,t,\\\"object\\\",8,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"label-width\\\":return Z(e,r,t,\\\"number\\\",null,1e-4,Number.MAX_VALUE);case\\\"label-no-overlap\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"label-no-overlap-factor\\\":return Z(e,r,t,\\\"object\\\");case\\\"label-no-overlap-margin\\\":return Z(e,r,t,\\\"object\\\",2,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"polygon\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"polygon-style\\\":return Z(e,r,t,\\\"string\\\");case\\\"polygon-use-stencil\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"polygon-culling\\\":return Z(e,r,t,\\\"string\\\");case\\\"polygon-color\\\":return Z(e,r,t,\\\"object\\\",4,0,255);case\\\"polygon-extrude\\\":return Z(e,r,t,\\\"number\\\",0,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"z-index\\\":return Z(e,r,t,\\\"number\\\",null,-Number.MAX_VALUE,Number.MAX_VALUE);case\\\"zbuffer-offset\\\":return Z(e,r,t,\\\"object\\\",3,0,Number.MAX_VALUE);case\\\"selected-hover-layer\\\":case\\\"selected-layer\\\":return Z(e,r,t,\\\"string\\\");case\\\"hover-event\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"hover-layer\\\":return Z(e,r,t,\\\"string\\\");case\\\"enter-event\\\":case\\\"leave-event\\\":case\\\"click-event\\\":case\\\"draw-event\\\":case\\\"advanced-hit\\\":case\\\"export-geometry\\\":case\\\"pack\\\":case\\\"visible\\\":return Z(e,r,t,\\\"boolean\\\");case\\\"visibility\\\":return Z(e,r,t,\\\"number\\\",null,1e-5,Number.MAX_VALUE);case\\\"visibility-abs\\\":return Z(e,r,t,\\\"object\\\",2,1e-5,Number.MAX_VALUE);case\\\"visibility-rel\\\":return Z(e,r,t,\\\"object\\\",4,1e-5,Number.MAX_VALUE);case\\\"visibility-switch\\\":case\\\"hysteresis\\\":return Z(e,r,t,\\\"object\\\");case\\\"culling\\\":return Z(e,r,t,\\\"number\\\",180,1e-4,180);case\\\"next-pass\\\":return Z(e,r,t,\\\"object\\\");case\\\"importance-source\\\":return Z(e,r,t,\\\"string\\\");case\\\"importance-weight\\\":return Z(e,r,t,\\\"number\\\",null,0,Number.MAX_VALUE)}return t},Q=function(e){switch(e){case\\\"inherit\\\":return\\\"\\\";case\\\"filter\\\":case\\\"reduce\\\":case\\\"dynamic-reduce\\\":return null;case\\\"line-points\\\":return[\\\"vertices\\\",0,0];case\\\"line\\\":return!1;case\\\"line-type\\\":return\\\"screen\\\";case\\\"line-flat\\\":return!1;case\\\"line-width\\\":return 1;case\\\"line-width-units\\\":return\\\"meters\\\";case\\\"line-color\\\":return[255,255,255,255];case\\\"line-style\\\":return\\\"solid\\\";case\\\"line-style-texture\\\":return null;case\\\"line-style-background\\\":return[0,0,0,0];case\\\"line-label\\\":return!1;case\\\"line-label-type\\\":return\\\"flat\\\";case\\\"line-label-font\\\":return[\\\"#default\\\"];case\\\"line-label-color\\\":return[255,255,255,255];case\\\"line-label-color2\\\":return[0,0,0,255];case\\\"line-label-outline\\\":return[.27,.75,2.2,2.2];case\\\"line-label-source\\\":return\\\"$name\\\";case\\\"line-label-size\\\":return 1;case\\\"line-label-offset\\\":return 0;case\\\"line-label-spacing\\\":case\\\"line-label-line-height\\\":return 1;case\\\"line-label-no-overlap\\\":return!0;case\\\"line-label-no-overlap-factor\\\":return null;case\\\"line-label-no-overlap-margin\\\":return 1.1;case\\\"point\\\":return!1;case\\\"point-type\\\":return\\\"screen\\\";case\\\"point-flat\\\":return!1;case\\\"point-radius\\\":return 1;case\\\"point-Layer\\\":return\\\"solid\\\";case\\\"point-color\\\":return[255,255,255,255];case\\\"icon\\\":return!1;case\\\"icon-source\\\":return null;case\\\"icon-scale\\\":return 1;case\\\"icon-offset\\\":return[0,0];case\\\"icon-origin\\\":return\\\"bottom-center\\\";case\\\"icon-stick\\\":return[0,0,0,255,255,255,255,0];case\\\"icon-color\\\":return[255,255,255,255];case\\\"icon-no-overlap\\\":return!1;case\\\"icon-no-overlap-factor\\\":return null;case\\\"icon-no-overlap-margin\\\":return[5,5];case\\\"label\\\":return!1;case\\\"label-font\\\":return[\\\"#default\\\"];case\\\"label-color\\\":return[255,255,255,255];case\\\"label-color2\\\":return[0,0,0,255];case\\\"label-outline\\\":return[.27,.75,2.2,2.2];case\\\"label-source\\\":return\\\"$name\\\";case\\\"label-size\\\":return 10;case\\\"label-size-units\\\":return\\\"pixels\\\";case\\\"label-spacing\\\":case\\\"label-line-height\\\":return 1;case\\\"label-offset\\\":return[0,0];case\\\"label-origin\\\":return\\\"bottom-center\\\";case\\\"label-align\\\":return\\\"center\\\";case\\\"label-stick\\\":return[0,0,0,255,255,255,255,0];case\\\"label-width\\\":return 200;case\\\"label-no-overlap\\\":return!0;case\\\"label-no-overlap-factor\\\":return null;case\\\"label-no-overlap-margin\\\":return[5,5];case\\\"polygon\\\":return!1;case\\\"polygon-style\\\":return\\\"solid\\\";case\\\"polygon-use-stencil\\\":return!0;case\\\"polygon-culling\\\":return\\\"none\\\";case\\\"polygon-color\\\":return[255,255,255,255];case\\\"polygon-extrude\\\":case\\\"z-index\\\":return 0;case\\\"zbuffer-offset\\\":return[0,0,0];case\\\"selected-hover-layer\\\":case\\\"selected-layer\\\":return\\\"\\\";case\\\"hover-event\\\":return!1;case\\\"hover-layer\\\":return\\\"\\\";case\\\"enter-event\\\":case\\\"leave-event\\\":case\\\"click-event\\\":case\\\"draw-event\\\":case\\\"advanced-hit\\\":case\\\"export-geometry\\\":case\\\"pack\\\":return!1;case\\\"visible\\\":return!0;case\\\"visibility\\\":case\\\"visibility-abs\\\":case\\\"visibility-rel\\\":case\\\"visibility-switch\\\":case\\\"hysteresis\\\":return null;case\\\"culling\\\":return 180;case\\\"next-pass\\\":case\\\"importance-source\\\":return null;case\\\"importance-weight\\\":return 1}};function ee(e,r,t,n,a,s,i,o,l){var u,c,f,h;if(!e||!Array.isArray(e))return!1;if(o>100)return!1;switch(e[0]){case\\\"all\\\":for(u=1,c=e.length;u<c;u++)if(!ee(e[u],r,t,n,a,s,i,o+1,l))return!1;return!0;case\\\"any\\\":for(u=1,c=e.length;u<c;u++)if(ee(e[u],r,t,n,s,i,o+1,l))return!0;return!1;case\\\"none\\\":for(u=1,c=e.length;u<c;u++)if(ee(e[u],r,t,n,s,i,o+1,l))return!1;return!0;case\\\"skip\\\":return!1}switch(l&&e[2]?f=e[1]:(j.disableLog=\\\"has\\\"==e[0]||\\\"!has\\\"==e[0],f=H(a,s,r,i,e[1],0),j.disableLog=!1),e[0]){case\\\"==\\\":case\\\"!=\\\":case\\\">=\\\":case\\\"<=\\\":case\\\">\\\":case\\\"<\\\":if(void 0===(h=e[l?3:2]))return!1;l&&e[4]||(h=H(a,s,r,i,h,0))}switch(e[0]){case\\\"==\\\":return f==h;case\\\"!=\\\":return f!=h;case\\\">=\\\":return f>=h;case\\\"<=\\\":return f<=h;case\\\">\\\":return f>h;case\\\"<\\\":return f<h;case\\\"has\\\":return void 0!==f;case\\\"!has\\\":return void 0===f;case\\\"in\\\":for(u=l?3:2,c=e.length;u<c;u++)if(e[u]==f)return!0;return!1;case\\\"!in\\\":for(u=l?3:2,c=e.length;u<c;u++)if(e[u]==f)return!1;return!0}return!1}function re(e){switch(typeof e){case\\\"number\\\":return!0;case\\\"string\\\":if(!(e.length>0))return!0;switch(e.charAt(0)){case\\\"#\\\":case\\\"$\\\":case\\\"@\\\":case\\\"&\\\":break;default:if(-1==e.indexOf(\\\"{\\\"))return!0}}return!1}var te=function(e,r,t){var n,a,s={};for(n in function(e,r,t,n){for(var a in null!=t.inherit&&J(e,r,t,n,0),t)r[a]=t[a];r[\\\"$$layer-id\\\"]=e}(e,s,r,t),s){if(\\\"string\\\"==typeof(a=s[n])&&a.length>0)switch(a.charAt(0)){case\\\"@\\\":null!=j.stylesheetConstants[a]?s[n]=j.stylesheetConstants[a]:(W(\\\"wrong-object\\\",e,n,a,null,\\\"constant\\\"),s[n]=Q(n));break;case\\\"%\\\":null!=j.stylesheetLocals[a]?(s[\\\"$$layer-variables\\\"]||(s[\\\"$$layer-variables\\\"]={}),s[\\\"$$layer-variables\\\"][n]=a,s[n]=j.stylesheetLocals[a]):(W(\\\"wrong-object\\\",e,n,a,null,\\\"variable\\\"),s[n]=Q(n))}if(\\\"visibility-switch\\\"==n){if(!(Array.isArray(a)&&a.length>0))return W(\\\"wrong-property-value\\\",e,n,a),Q(n);for(var i=0,o=a.length;i<o;i++){var l=a[i],u=!1;\\\"object\\\"==typeof l&&Array.isArray(l)&&2==l.length?(\\\"string\\\"==typeof l[0]&&\\\"@\\\"==l[0].charAt(0)&&(void 0===j.stylesheetConstants[l[0]]?u=!0:l[0]=j.stylesheetConstants[l[0]]),(\\\"number\\\"!=typeof l[0]||\\\"string\\\"!=typeof l[1]&&null!==l[1])&&(u=!0)):u=!0,u&&W(\\\"wrong-property-value[]\\\",e,n,a,i)}}}return s},ne=n,ae=function(e){if(o)return o.encode(e);for(var r=String(e),t=r.length,n=0,a=[];n<t;){var s=r.charCodeAt(n);if(s<55296||s>57343)a.push(s);else if(56320<=s&&s<=57343)a.push(65533);else if(55296<=s&&s<=56319)if(n===t-1)a.push(65533);else{var i=r.charCodeAt(n+1);if(56320<=i&&i<=57343){var l=1023&s,u=1023&i;a.push(65536+(l<<10)+u),n+=1}else a.push(65533)}n+=1}return new Uint8Array(new Uint32Array(a).buffer)},se=new Uint8Array(16777216),ie=new Uint8Array(16777216),oe=[],le=[];function ue(e,r){ne.config.mapPackLoaderEvents?(oe.push(e),r&&(le=le.concat(r))):r?postMessage(e,r):postMessage(e)}function ce(e,r,t,n,a){var s,i,o=ae(JSON.stringify(t)),l=6+o.byteLength;for(s=0,i=n.length;s<i;s++)l+=4+n[s].byteLength;var u,c=new Uint8Array(l),f=new DataView(c.buffer),h=0;for(f.setUint8(h,e),h+=1,f.setUint8(h,r),h+=1,f.setUint32(h,o.byteLength),h+=4,c.set(o,h),u=h+=o.byteLength,s=0,i=n.length;s<i;s++)f.setUint32(h,n[s].length),h+=4,c.set(new Uint8Array(n[s].buffer),h),h+=n[s].byteLength;fe(e,r,c.buffer,u,a,t.hitable,t.totalPoints,11==r?t:null)}function fe(e,r,t,n,a,s,i,o){if(ne.messageBufferIndex>=ne.messageBufferSize){var l=ne.messageBuffer;ne.messageBufferSize+=65536,ne.messageBuffer=new Array(ne.messageBufferSize);for(var u=0,c=ne.messageBufferIndex;u<c;u++)ne.messageBuffer[u]=l[u]}ne.messageBuffer[ne.messageBufferIndex]={command:e,type:r,job:t,buffersIndex:n,signature:a,hitable:s,totalPoints:i,job2:o},ne.messageBufferIndex++,ne.messagePackSize+=t.byteLength}function he(e,r,t){var n=1==e?ie:se;if(n.byteLength<=r.byteLength+t){var a=new Uint8Array(2*n.byteLength);a.set(n,0),n=a,1==e?ie=n:se=n}n.set(r,t)}var ve=n,de=a,be=q,ge=$,pe=function(e,r,t,n,a,s,i,o,l,u,c,f,h){for(var v=[0,1,0],d=[e[0],e[1],e[2]],b=f||S.U.stringToGlyphs(s,t),g=b[0],p=b[1],y=0,L=g.length;y<L;y++){var A=g[y],m=s[p[y]];if(m){var N=O(n,m),U=M(d,r,0,A,N,a,u,u,v,s,i,o,l,c,p[y],h);d=U[0],u=U[1]}}return u},ye=function(e,r,t,n,a,s){for(var i=0,o=s||S.U.stringToGlyphs(a,e),l=o[0],u=o[1],c=o[2],f=0,h=l.length;f<h;f++){var v=l[f],d=c[f];if(i>r&&(10==d||9==d||32==d))return f;if(10!=d){var b=a[u[f]];if(b){var g=O(t,b)*n,p=b.glyphs[v];p&&(i+=f==h-1?p.lx*g:p.step*g)}}}return h},Le=P,Ae=_,me=F,Ne=z,Ue=C,we=B,xe=function(e,r,t){var n=O(e,t[0]);return t[0].cly*n*r},Se=ce,Me=function(e){var r,t,n,a,s,i,o,l=[];if(e[\\\"d-points\\\"]||e[\\\"d-lines\\\"]){if(l=e[\\\"d-points\\\"]||e[\\\"d-lines\\\"],Array.isArray(l)&&s.length>0)for(n=0,a=l;n<a;n++)if(s=l[n],Array.isArray(s)&&s.length>0)for((i=s[0])[0]=i[0]>>1^-(1&i[0]),i[1]=i[1]>>1^-(1&i[1]),i[2]=i[2]>>1^-(1&i[2]),r=1,t=s.length;r<t;r++)i=s[r-1],(o=s[r])[0]=(o[0]>>1^-(1&o[0]))+i[0],o[1]=(o[1]>>1^-(1&o[1]))+i[1],o[2]=(o[2]>>1^-(1&o[2]))+i[2];e[\\\"d-points\\\"]?(e.points=e[\\\"d-points\\\"],delete e[\\\"d-points\\\"]):(e.lines=e[\\\"d-lines\\\"],delete e[\\\"d-lines\\\"])}},Be=function(e,r,t,n,a,s){var i,o,l,u,c,f=[];if(Me(e),(f=e.lines?e.lines:[e.points])&&0!=f.length){var h,v,d,b,g=be(t,\\\"visibility-rel\\\",e,r)||be(t,\\\"visibility-abs\\\",e,r)||be(t,\\\"visibility\\\",e,r),p=be(t,\\\"culling\\\",e,r),y=be(t,\\\"hover-event\\\",e,r),L=be(t,\\\"click-event\\\",e,r),A=be(t,\\\"draw-event\\\",e,r),m=be(t,\\\"enter-event\\\",e,r),N=be(t,\\\"leave-event\\\",e,r),U=be(t,\\\"advanced-event\\\",e,r),w=be(t,\\\"line-points\\\",e,r),x=be(t,\\\"zbuffer-offset\\\",e,r),S=be(t,\\\"point\\\",e,r),M=be(t,\\\"point-flat\\\",e,r),B=be(t,\\\"point-color\\\",e,r),O=.5*be(t,\\\"point-radius\\\",e,r),_=0;for(l=0,u=f.length;l<u;l++)c=f[l],Array.isArray(c)&&c.length>0&&(_+=c.length);var k=be(t,\\\"icon\\\",e,r);if(k)if(h=be(t,\\\"icon-source\\\",e,r)){v=we()*_,d=we(!0)*_;var I={color:be(t,\\\"icon-color\\\",e,r),scale:be(t,\\\"icon-scale\\\",e,r),offset:be(t,\\\"icon-offset\\\",e,r),stick:be(t,\\\"icon-stick\\\",e,r),reduce:be(t,\\\"dynamic-reduce\\\",e,r),origin:be(t,\\\"icon-origin\\\",e,r),source:be(t,\\\"icon-source\\\",e,r),noOverlap:be(t,\\\"icon-no-overlap\\\",e,r),noOverlapMargin:be(t,\\\"icon-no-overlap-margin\\\",e,r),noOverlapFactor:be(t,\\\"icon-no-overlap-factor\\\",e,r),index:0,index2:0};_>1?(I.vertexBuffer=new Float32Array(v),I.originBuffer=new Float32Array(d),I.texcoordsBuffer=new Float32Array(v)):I.singleBuffer=new Float32Array(16)}else k=!1;var E=be(t,\\\"label\\\",e,r);if(E){h=be(t,\\\"label-source\\\",e,r);var C=ge(t,h,e,r,h);C=C?C.replace(\\\"\\\\r\\\\n\\\",\\\"\\\\n\\\").replace(\\\"\\\\r\\\",\\\"\\\\n\\\"):\\\"\\\";var F=be(t,\\\"label-size\\\",e,r),z=be(t,\\\"label-font\\\",e,r),P=me(z),j=Le(C,P);if(\\\"$name\\\"==h&&!Ue(C,P,j)){var T=ge(t,\\\"$name:en\\\",e,r,h);T=T?T.replace(\\\"\\\\r\\\\n\\\",\\\"\\\\n\\\").replace(\\\"\\\\r\\\",\\\"\\\\n\\\"):\\\"\\\";var V=Le(T,P);Ue(T,P)&&(C=T,j=V)}if(C&&\\\"\\\"!=C&&Math.abs(F)>1e-4){b=be(t,\\\"label-no-overlap\\\",e,r),v=we()*C.length*(b?1:_),d=we(!0)*C.length*(b?1:_);var G=1==_,X=1;\\\"points\\\"==be(t,\\\"label-size-units\\\",e,r)&&(X=ve.pixelFactor/(1/72*96));var D={color:be(t,\\\"label-color\\\",e,r),color2:be(t,\\\"label-color2\\\",e,r),outline:be(t,\\\"label-outline\\\",e,r),reduce:be(t,\\\"dynamic-reduce\\\",e,r),size:F*X,spacing:be(t,\\\"label-spacing\\\",e,r),lineHeight:be(t,\\\"label-line-height\\\",e,r),offset:be(t,\\\"label-offset\\\",e,r),stick:be(t,\\\"label-stick\\\",e,r),origin:be(t,\\\"label-origin\\\",e,r),align:be(t,\\\"label-align\\\",e,r),fonts:P,fontsStorage:Ne(z),text:C,hysteresis:be(t,\\\"hysteresis\\\",e,r),width:X*be(t,\\\"label-width\\\",e,r),noOverlap:b,noOverlapMargin:be(t,\\\"label-no-overlap-margin\\\",e,r),noOverlapFactor:be(t,\\\"label-no-overlap-factor\\\",e,r),vertexBuffer:G?null:new Float32Array(v),originBuffer:G?null:new Float32Array(d),texcoordsBuffer:G?null:new Float32Array(v),singleBuffer:G?new Float32Array(4*C.length*2):null,index:0,index2:0,glyphsRes:j};D.stick&&(D.stick=D.stick.slice(),D.stick[2]*=X)}else E=!1}var R,$,q,Y,H,J,W,Z=0,K=0,Q=[0,0,0],ee=ve.forceOrigin,re=ve.bboxMin,te=ve.tileX,ne=ve.tileY,ae=ve.forceScale,se=function(e){if(k&&!I.noOverlap&&($=_e(J,I)),E&&!D.noOverlap&&(R=ke(J,D)),S)for(var r=0;r<Fe;r++)M?(Oe[Z]=J[0],Oe[Z+1]=J[1],Oe[Z+2]=J[2],Oe[Z+3]=J[0]+Ce[r][0]*O,Oe[Z+4]=J[1]+Ce[r][1]*O,Oe[Z+5]=J[2],Oe[Z+6]=J[0]+Ce[r+1][0]*O,Oe[Z+7]=J[1]+Ce[r+1][1]*O,Oe[Z+8]=J[2],Z+=9):(Oe[Z]=J[0],Oe[Z+1]=J[1],Oe[Z+2]=J[2],Oe[Z+3]=0,Ie[K]=0,Ie[K+1]=0,Ie[K+2]=0,Ie[K+3]=0,Oe[Z+4]=J[0],Oe[Z+5]=J[1],Oe[Z+6]=J[2],Oe[Z+7]=0,Ie[K+4]=Ce[r][0]*O,Ie[K+5]=Ce[r][1]*O,Ie[K+6]=0,Ie[K+7]=0,Oe[Z+8]=J[0],Oe[Z+9]=J[1],Oe[Z+10]=J[2],Oe[Z+11]=0,Ie[K+8]=Ce[r+1][0]*O,Ie[K+9]=Ce[r+1][1]*O,Ie[K+10]=0,Ie[K+11]=0,Z+=12,K+=12)},ie=function(e){var r=0,t=0;if(q=c[0],Y=[q[0],q[1],q[2]],ee&&(Y=[Y[0]-te,Y[1]-ne,Y[2]]),null!=ae&&(Y=[Y[0]*ae[0],Y[1]*ae[1],Y[2]*ae[2]]),0==e)return Y;for(var n=0,a=c.length-1;n<a;n++){q=c[n+1],H=[q[0],q[1],q[2]],ee&&(H=[H[0]-te,H[1]-ne,H[2]]),null!=ae&&(H=[H[0]*ae[0],H[1]*ae[1],H[2]*ae[2]]);var s=H[0]-Y[0],i=H[1]-Y[1],o=H[2]-Y[2],l=Math.sqrt(s*s+i*i+o*o);if(r=t,t+=l,e>=r&&e<=t){var u=(e-r)/l;return[Y[0]+s*u,Y[1]+i*u,Y[2]+o*u]}Y=H}},oe=new Array(2048),le=0;for(l=0,u=f.length;l<u;l++)if(c=f[l],Array.isArray(c)&&c.length>0){var ue=0,ce=null;for(\\\"vertices\\\"!=w[0]&&((ce=new Array(c.length))[0]=0),i=0,o=c.length;i<o;i++){if(q=c[i],Y=[q[0],q[1],q[2]],ee&&(Y=[Y[0]-te,Y[1]-ne,Y[2]]),null!=ae&&(Y=[Y[0]*ae[0],Y[1]*ae[1],Y[2]*ae[2]]),i+1<o){q=c[i+1],H=[q[0],q[1],q[2]],ee&&(H=[H[0]-te,H[1]-ne,H[2]]),null!=ae&&(H=[H[0]*ae[0],H[1]*ae[1],H[2]*ae[2]]);var fe=H[0]-Y[0],he=H[1]-Y[1],pe=H[2]-Y[2],ye=Math.sqrt(fe*fe+he*he+pe*pe);ce&&(ce[i]=ye),ue+=ye}Q[0]+=Y[0],Q[1]+=Y[1],Q[2]+=Y[2],\\\"vertices\\\"==w[0]&&(oe[le]=Y,le++)}if(\\\"by-length\\\"==w[0]||\\\"by-ratio\\\"==w[0]){var Ae=w[1],xe=w[2]||0;if(\\\"by-ratio\\\"==w[0]&&(Ae*=ue,xe*=ue),Ae<=0)oe[le]=ie(xe),oe[le]&&le++;else for(i=xe;i<ue;i+=Ae)oe[le]=ie(i),oe[le]&&le++}\\\"start\\\"==w[0]&&(oe[le]=ie(0),le++),\\\"end\\\"==w[0]&&(oe[le]=ie(ue),le++),\\\"endpoints\\\"==w[0]&&(oe[le]=ie(0),oe[++le]=ie(ue),le++),\\\"middle\\\"!=w[0]&&\\\"midpoint\\\"!=w[0]||(oe[le]=ie(.5*ue),le++)}var Be,Oe,Ie,Ee=le;if(S){var Ce=[],Fe=de(8*O*.5,8,32),ze=0,Pe=2*Math.PI/Fe;for(i=0;i<Fe;i++)Ce[i]=[-Math.sin(ze),Math.cos(ze)],ze+=Pe;Ce[Fe]=[0,1],M?(Be=3*Fe*3,Oe=new Float32Array(Ee*Be)):(Be=3*Fe*4,Oe=new Float32Array(Ee*Be),Ie=new Float32Array(Ee*(3*Fe*4)))}if(le){for(ve.directPoints=oe.slice(0,le),i=0;i<le;i++)J=oe[i],se();_>0&&(Q[0]/=_,Q[1]/=_,Q[2]/=_),Q[0]+=re[0],Q[1]+=re[1],Q[2]+=re[2];var je=y||L||m||N;ve.signatureCounter++;var Te=\\\"\\\"+ve.signatureCounter;g&&!Array.isArray(g)&&(g=[g]),S&&(M?Se(5,6,{color:B,\\\"z-index\\\":a,visibility:g,center:Q,\\\"hover-event\\\":y,\\\"click-event\\\":L,\\\"draw-event\\\":A,advancedHit:U,\\\"enter-event\\\":m,\\\"leave-event\\\":N,\\\"zbuffer-offset\\\":x,hitable:je,state:ve.hitState,eventInfo:ve.alwaysEventInfo||je||A?s:{},lod:ve.autoLod?null:ve.tileLod},[Oe],Te):Se(5,9,{color:B,\\\"z-index\\\":a,visibility:g,center:Q,\\\"hover-event\\\":y,\\\"click-event\\\":L,\\\"draw-event\\\":A,\\\"enter-event\\\":m,\\\"leave-event\\\":N,\\\"zbuffer-offset\\\":x,hitable:je,state:ve.hitState,eventInfo:ve.alwaysEventInfo||je||A?s:{},lod:ve.autoLod?null:ve.tileLod},[Oe,Ie],Te));var Ve=function(){if(k){if(ve.signatureCounter++,Te=\\\"\\\"+ve.signatureCounter,I.noOverlap){var e=I.noOverlapMargin,r=null,t=null;if(null!==I.noOverlapFactor){switch(I.noOverlapFactor[0]){case\\\"direct\\\":r=0;break;case\\\"div-by-dist\\\":r=1}t=I.noOverlapFactor[1]}var i=[$[0]-e[0],$[1]-e[1],$[2]+e[0],$[3]+e[1],r,t]}(I.singleBuffer&&I.singleBuffer.length>0||I.vertexBuffer&&I.vertexBuffer.length>0)&&Se(5,I.singleBuffer?3:4,{icon:ve.stylesheetBitmaps[I.source[0]],color:I.color,\\\"z-index\\\":a,visibility:g,culling:p,center:W,stick:I.stick,\\\"hover-event\\\":y,\\\"click-event\\\":L,\\\"draw-event\\\":A,advancedHit:U,\\\"enter-event\\\":m,\\\"leave-event\\\":N,\\\"zbuffer-offset\\\":x,noOverlap:I.noOverlap?i:null,hitable:je,state:ve.hitState,eventInfo:ve.alwaysEventInfo||je||A?s:{},index:n,reduce:I.reduce,lod:ve.autoLod?null:ve.tileLod},I.singleBuffer?[I.singleBuffer]:[I.vertexBuffer,I.originBuffer,I.texcoordsBuffer],Te)}},Ge=function(){if(E){if(ve.signatureCounter++,Te=\\\"\\\"+ve.signatureCounter,D.noOverlap){var e=D.noOverlapMargin,r=null,t=null;if(null!==D.noOverlapFactor){switch(D.noOverlapFactor[0]){case\\\"direct\\\":r=0;break;case\\\"div-by-dist\\\":r=1}t=D.noOverlapFactor[1]}var i=[R[0]-e[0],R[1]-e[1],R[2]+e[0],R[3]+e[1],r,t]}(D.singleBuffer&&D.singleBuffer.length>0||D.vertexBuffer&&D.vertexBuffer.length>0)&&Se(5,D.singleBuffer?1:2,{size:D.size,origin:D.pos,color:D.color,color2:D.color2,outline:D.outline,\\\"z-index\\\":a,visibility:g,culling:p,center:W,stick:D.stick,noOverlap:D.noOverlap?i:null,\\\"hover-event\\\":y,\\\"click-event\\\":L,\\\"draw-event\\\":A,files:D.files,index:n,\\\"enter-event\\\":m,\\\"leave-event\\\":N,\\\"zbuffer-offset\\\":x,fonts:D.fontsStorage,hitable:je,state:ve.hitState,advancedHit:U,reduce:D.reduce,hysteresis:D.hysteresis,eventInfo:ve.alwaysEventInfo||je||A?s:{},lod:ve.autoLod?null:ve.tileLod},D.singleBuffer?[D.singleBuffer]:[D.vertexBuffer,D.originBuffer,D.texcoordsBuffer],Te)}};for(k&&!I.noOverlap&&(W=Q,Ve()),E&&!D.noOverlap&&(W=Q,Ge()),i=0,o=ve.insidePack?1:ve.directPoints.length;i<o;i++)J=ve.directPoints[i],W=[J[0]+re[0],J[1]+re[1],J[2]+re[2]],k&&I.noOverlap&&($=_e(J,I,$),Ve()),E&&D.noOverlap&&(R=ke(J,D,R),Ge())}}},Oe=function(e,r,t){switch(e){case\\\"top-left\\\":return[0,0];case\\\"top-right\\\":return[-r,0];case\\\"top-center\\\":return[.5*-r,0];case\\\"center-left\\\":return[0,.5*-t];case\\\"center-right\\\":return[-r,.5*-t];case\\\"center-center\\\":return[.5*-r,.5*-t];case\\\"bottom-left\\\":return[0,-t];case\\\"bottom-right\\\":return[-r,-t];case\\\"bottom-center\\\":return[.5*-r,-t]}},_e=function(e,r,t){t&&(r.index=0,r.index2=0,r.vertexBuffer=r.vertexBuffer?new Float32Array(r.vertexBuffer.length):null,r.originBuffer=r.originBuffer?new Float32Array(r.originBuffer.length):null,r.singleBuffer=r.singleBuffer?new Float32Array(r.singleBuffer.length):null);var n=r.source,a=r.index,s=r.index2,i=a,o=Math.abs(n[3]*r.scale*.5),l=Math.abs(n[4]*r.scale*.5),u=Oe(r.origin,o,l),c=u[0]+r.offset[0],f=u[1]+r.offset[1];if(r.singleBuffer){var h=r.singleBuffer;return h[0]=c,h[1]=f,h[2]=n[1],h[3]=n[2],h[4]=o+c,h[5]=f,h[6]=n[1]+n[3],h[7]=n[2],h[8]=o+c,h[9]=l+f,h[10]=n[1]+n[3],h[11]=n[2]+n[4],h[12]=c,h[13]=l+f,h[14]=n[1],h[15]=n[2]+n[4],[.5*c,.5*f,.5*(c+o)+1,.5*(f+l)]}var v=r.vertexBuffer,d=r.texcoordsBuffer,b=r.originBuffer;v[a]=0,v[a+1]=0,v[a+2]=0,v[a+3]=0,v[a+4]=o,v[a+5]=0,v[a+6]=0,v[a+7]=0,v[a+8]=o,v[a+9]=-l,v[a+10]=0,v[a+11]=0,d[a]=n[1],d[a+1]=n[2],d[a+2]=0,d[a+3]=0,d[a+4]=n[1]+n[3],d[a+5]=n[2],d[a+6]=0,d[a+7]=0,d[a+8]=n[1]+n[3],d[a+9]=n[2]+n[4],d[a+10]=0,d[a+11]=0,v[a+=12]=0,v[a+1]=0,v[a+2]=0,v[a+3]=0,v[a+4]=0,v[a+5]=-l,v[a+6]=0,v[a+7]=0,v[a+8]=o,v[a+9]=-l,v[a+10]=0,v[a+11]=0,d[a]=n[1],d[a+1]=n[2],d[a+2]=0,d[a+3]=0,d[a+4]=n[1],d[a+5]=n[2]+n[4],d[a+6]=0,d[a+7]=0,d[a+8]=n[1]+n[3],d[a+9]=n[2]+n[4],d[a+10]=0,d[a+11]=0,a+=12;for(var g=e[0],p=e[1],y=e[2],L=i;L<a;L+=4)v[L]+=c,v[L+1]-=f,b[s]=g,b[s+1]=p,b[s+2]=y,s+=3;return r.index=a,r.index2=s,[.5*c,.5*f,.5*(c+o)+1,.5*(f+l)]},ke=function(e,r,t){t&&(r.index=0,r.index2=0,r.vertexBuffer=r.vertexBuffer?new Float32Array(r.vertexBuffer.length):null,r.originBuffer=r.originBuffer?new Float32Array(r.originBuffer.length):null,r.singleBuffer=r.singleBuffer?new Float32Array(r.singleBuffer.length):null);var n=r.vertexBuffer,a=r.texcoordsBuffer,s=r.originBuffer,i=r.singleBuffer,o=r.index,l=r.index2,u=o,c=(r.text,r.fonts),f={},h=r.glyphsRes,v=[],d=[];do{var b=h[2].indexOf(10);-1!=b?(v.push([h[0].slice(0,b),h[1].slice(0,b),h[2].slice(0,b)]),h=[h[0].slice(b+1),h[1].slice(b+1),h[2].slice(b+1)]):v.push(h)}while(-1!=b);for(var g=0,p=v.length;g<p;g++)for(h=v[g];;){var y=ye(null,r.width,r.size,r.spacing,c,h);if(h[2].length==y){d.push(h);break}d.push([h[0].slice(0,y),h[1].slice(0,y),h[2].slice(0,y)]),h=[h[0].slice(y+1),h[1].slice(y+1),h[2].slice(y+1)]}var L=0,A=0,m=xe(r.size,r.lineHeight,c),N=0,U=[];for(g=0,p=d.length;g<p;g++)U[g]=Ae(null,r.size,r.spacing,c,d[g]),N=Math.max(U[g],N);for(g=0,p=d.length;g<p;g++){var w=U[g];switch(r.align){case\\\"left\\\":L=0;break;case\\\"right\\\":L=N-w;break;case\\\"center\\\":L=.5*(N-w)}o=pe([L,A,0],[1,0,0],null,r.size,r.spacing,c,n,a,!0,o,f,d[g],i),A-=m}var x=Oe(r.origin,N,-A),S=x[0]+r.offset[0],M=x[1]+r.offset[1],B=e[0],O=e[1],_=e[2];if(i){for(g=u;g<o;g+=8)i[g]+=S,i[g+1]-=M,i[g+2]+=S,i[g+3]-=M;r.pos=[B,O,_],i=new Float32Array(i.buffer,0,o)}else for(g=u;g<o;g+=4)n[g]+=S,n[g+1]-=M,s[l]=B,s[l+1]=O,s[l+2]=_,l+=3;c=r.fonts;for(r.files=new Array(c.length),g=0,p=c.length;g<p;g++)r.files[g]=[];for(var k in f){var I=parseInt(k),E=f[k],C=[];for(var F in E){var z=parseInt(F)-4e3*I,P=Math.round((z-z%4)/4);-1==C.indexOf(P)&&C.push(P)}r.files[I]=C}return r.index=o,r.index2=l,[.5*S,.5*M,.5*(S+N)+1,.5*(M+Math.abs(A))]},Ie=n,Ee=s,Ce=i,Fe=q,ze=$,Pe=function(e,r){return void 0!==e[r]},je=function(e,r,t,n,a,s,i,o,l,u,c,f){var h=_(r,t,n,a,c),v=k(e),d=.5*(v-h);if(d<0&&(d=0),!(h>v)){var b=E(e,d,r,t,n,a,c);return N.textVector=b,N.textCenter=I(e,.5*v)[0],N.textLength=h,function(e,r,t,n,a,s,i,o,l,u,c,f,h,v){null==s&&(s=[0,1,0]);var d=e[0];d=[d[0],d[1],d[2]];var b=r,g=h||S.U.stringToGlyphs(i,t),p=g[0],y=g[1];N.processLineLabel=!0;for(var L=0,A=p.length;L<A;L++){var m=p[L],w=i[y[L]];if(w){var x=O(n,w),B=.01,_=w.glyphs[m];_&&(B=_.step*x*a);var k=I(e,b),E=I(e,b+B),C=[.5*(E[1][0]+k[1][0]),.5*(E[1][1]+k[1][1]),.5*(E[1][2]+k[1][2])];U(C);var F=M(k[0],C,-x*w.size*.7+o,m,x,a,c,c,s,i,l,u,null,f,y[L],v);d=F[0],c=F[1],b+=B}}return N.processLineLabel=!1,c}(e,d,r,t,n,b,a,s,i,o,l,u,c,f)}},Te=C,Ve=B,Ge=F,Xe=z,De=ce,Re=P,$e=Me,qe=function(e,r,t,n,a,s){$e(e);var i=e.lines;if(i&&0!=i.length){var o=Fe(t,\\\"line\\\",e,r),l=Fe(t,\\\"line-label\\\",e,r);if(o||l){var u=Fe(t,\\\"hover-event\\\",e,r),c=Fe(t,\\\"click-event\\\",e,r),f=Fe(t,\\\"draw-event\\\",e,r),h=Fe(t,\\\"enter-event\\\",e,r),v=Fe(t,\\\"leave-event\\\",e,r),d=Fe(t,\\\"advanced-hit\\\",e,r),b=Fe(t,\\\"zbuffer-offset\\\",e,r);if(Pe(t,\\\"line-type\\\"));else var g=Fe(t,\\\"line-flat\\\",e,r);var p=Fe(t,\\\"line-color\\\",e,r),y=.5*Fe(t,\\\"line-width\\\",e,r),L=Fe(t,\\\"line-width-units\\\",e,r),A=Fe(t,\\\"line-style\\\",e,r),m=Fe(t,\\\"line-style-texture\\\",e,r),N=Fe(t,\\\"line-style-background\\\",e,r),U=Fe(t,\\\"line-label-size\\\",e,r),w=\\\"solid\\\"!=A,x=\\\"ratio\\\"==L;\\\"points\\\"==L&&(y*=Ie.pixelFactor/(1/72*96));var S,M,B,O,_,k,I,E,C,F,z,P,j=0,T=0,V=0,G=!1,X=1;if(!(G=x?!g&&1080*y<2.1:!g&&y<2.1)){var D=[],R=[],$=8,q=0,Y=2*Math.PI/$;for(M=0;M<$;M++)D[M]=[-Math.sin(q),Math.cos(q)],R[M]=q,q+=Y;D[$]=[0,1],R[$]=0}var H=0;for(S=0;S<i.length;S++)Array.isArray(i[S])&&(H+=i[S].length);if(!(H<=1)){g&&($=2);var J=3*(w||x||!g?4:3)*2,W=new Float32Array((H-1)*J+H*(G?0:$*(w||x||!g?4:3)*3));if(d)var Z=new Float32Array(6*(H-1)+H*(G?0:$)*3);if(!g||w||x)var K=new Float32Array(24*(H-1)+H*(G?0:3*$*4));var Q=[0,0,0],ee=[],re=Ie.forceOrigin,te=Ie.bboxMin,ne=Ie.geocent,ae=Ie.tileX,se=Ie.tileY,ie=Ie.forceScale,oe=[1,0,0],le=[-1,0,0];for(S=0;S<i.length;S++)if(Array.isArray(i[S])&&i[S].length){var ue=i[S];if(l){var ce=new Array(ue.length),fe=new Array(ue.length);ee.push({points:ce,points2:fe})}F=[(z=ue[0])[0],z[1],z[2]],re&&(F=[F[0]-ae,F[1]-se,F[2]]),null!=ie&&(F=[F[0]*ie[0],F[1]*ie[1],F[2]*ie[2]]);var he=.001,ve=.001,de=j,be=T;for(M=0,B=ue.length-1;M<B;M++)F=ue[M],O=ue[M+1],re&&(F=[F[0]-ae,F[1]-se,F[2]],O=[O[0]-ae,O[1]-se,O[2]]),null!=ie&&(F=[F[0]*ie[0],F[1]*ie[1],F[2]*ie[2]],O=[O[0]*ie[0],O[1]*ie[1],O[2]*ie[2]]),d&&(P=X+M,Z[V]=P,Z[V+1]=P,Z[V+2]=P,Z[V+3]=P,Z[V+4]=P,Z[V+5]=P,V+=6),!g||w||x?g?(ne?(_=[O[0]-F[0],O[1]-F[1],O[2]-F[2]],ve+=I=Math.sqrt(_[0]*_[0]+_[1]*_[1]+_[2]*_[2]),I=0!=I?1/I:0,k=[_[0]*I,_[1]*I,_[2]*I],E=[0,0,0],0==M&&(oe=k),M==B-1&&(le=k),Ee(te,C=[0,0,0]),Ce(C,k,E),E=[E[0],E[1],E[2]]):(_=[O[0]-F[0],O[1]-F[1],0],ve+=I=Math.sqrt(_[0]*_[0]+_[1]*_[1]),I=0!=I?y/I:0,E=[-_[1],_[0],0],0==M&&(oe=[_[0]*I,_[1]*I,0]),M==B-1&&(le=[_[0]*I,_[1]*I,0])),W[j]=F[0],W[j+1]=F[1],W[j+2]=F[2],W[j+3]=he,K[T]=E[0],K[T+1]=E[1],K[T+2]=E[2],K[T+3]=y,W[j+4]=F[0],W[j+5]=F[1],W[j+6]=F[2],W[j+7]=-he,K[T+4]=-E[0],K[T+5]=-E[1],K[T+6]=-E[2],K[T+7]=y,W[j+8]=O[0],W[j+9]=O[1],W[j+10]=O[2],W[j+11]=ve,K[T+8]=E[0],K[T+9]=E[1],K[T+10]=E[2],K[T+11]=y,W[j+12]=F[0],W[j+13]=F[1],W[j+14]=F[2],W[j+15]=-he,K[T+12]=-E[0],K[T+13]=-E[1],K[T+14]=-E[2],K[T+15]=y,W[j+16]=O[0],W[j+17]=O[1],W[j+18]=O[2],W[j+19]=-ve,K[T+16]=-E[0],K[T+17]=-E[1],K[T+18]=-E[2],K[T+19]=y,W[j+20]=O[0],W[j+21]=O[1],W[j+22]=O[2],W[j+23]=ve,K[T+20]=E[0],K[T+21]=E[1],K[T+22]=E[2],K[T+23]=y,j+=24,T+=24):(_=[O[0]-F[0],O[1]-F[1],0],ve+=I=Math.sqrt(_[0]*_[0]+_[1]*_[1]),W[j]=F[0],W[j+1]=F[1],W[j+2]=F[2],W[j+3]=he,K[T]=O[0],K[T+1]=O[1],K[T+2]=O[2],K[T+3]=y,W[j+4]=F[0],W[j+5]=F[1],W[j+6]=F[2],W[j+7]=-he,K[T+4]=O[0],K[T+5]=O[1],K[T+6]=O[2],K[T+7]=-y,W[j+8]=O[0],W[j+9]=O[1],W[j+10]=O[2],W[j+11]=-ve,K[T+8]=F[0],K[T+9]=F[1],K[T+10]=F[2],K[T+11]=y,W[j+12]=F[0],W[j+13]=F[1],W[j+14]=F[2],W[j+15]=he,K[T+12]=O[0],K[T+13]=O[1],K[T+14]=O[2],K[T+15]=y,W[j+16]=O[0],W[j+17]=O[1],W[j+18]=O[2],W[j+19]=-ve,K[T+16]=F[0],K[T+17]=F[1],K[T+18]=F[2],K[T+19]=y,W[j+20]=O[0],W[j+21]=O[1],W[j+22]=O[2],W[j+23]=ve,K[T+20]=F[0],K[T+21]=F[1],K[T+22]=F[2],K[T+23]=-y,j+=24,T+=24):(ne?(_=[O[0]-F[0],O[1]-F[1],O[2]-F[2]],ve+=I=Math.sqrt(_[0]*_[0]+_[1]*_[1]+_[2]*_[2]),I=0!=I?1/I:0,k=[_[0]*I,_[1]*I,_[2]*I],E=[0,0,0],Ee(te,C=[0,0,0]),Ce(C,k,E),0==M&&(oe=k),M==B-1&&(le=k),E=[E[0]*y,E[1]*y,E[2]*y]):(_=[O[0]-F[0],O[1]-F[1],0],ve+=I=Math.sqrt(_[0]*_[0]+_[1]*_[1]),I=0!=I?y/I:0,E=[-_[1]*I,_[0]*I,0],0==M&&(oe=[_[0]*I,_[1]*I,0]),M==B-1&&(le=[_[0]*I,_[1]*I,0])),W[j]=F[0]+E[0],W[j+1]=F[1]+E[1],W[j+2]=F[2]+E[2],W[j+3]=F[0]-E[0],W[j+4]=F[1]-E[1],W[j+5]=F[2]-E[2],W[j+6]=O[0]+E[0],W[j+7]=O[1]+E[1],W[j+8]=O[2]+E[2],W[j+9]=F[0]-E[0],W[j+10]=F[1]-E[1],W[j+11]=F[2]-E[2],W[j+12]=O[0]-E[0],W[j+13]=O[1]-E[1],W[j+14]=O[2]-E[2],W[j+15]=O[0]+E[0],W[j+16]=O[1]+E[1],W[j+17]=O[2]+E[2],j+=18),he=ve,F=O;for(F=[z[0],z[1],z[2]],M=0,B=ue.length;M<B;M++){if(re&&(F=[F[0]-ae,F[1]-se,F[2]]),null!=ie&&(F=[F[0]*ie[0],F[1]*ie[1],F[2]*ie[2]]),Q[0]+=F[0],Q[1]+=F[1],Q[2]+=F[2],!G){var ge,pe;if(g)d&&(P=X+(M!=B-1?M:M-1),Z[V]=P,Z[V+1]=P,Z[V+2]=P,Z[V+3]=P,Z[V+4]=P,Z[V+5]=P,V+=6),w||x?(he=M!=B-1?W[M*J+3]:W[(M-1)*J+11],ge=M!=B-1?be+M*J:be+(M-1)*J+8,pe=M>0?be+(M-1)*J+8:be+ge,W[j]=F[0],W[j+1]=F[1],W[j+2]=F[2],W[j+3]=he,W[j+4]=F[0],W[j+5]=F[1],W[j+6]=F[2],W[j+7]=he,W[j+8]=F[0],W[j+9]=F[1],W[j+10]=F[2],W[j+11]=he,W[j+12]=F[0],W[j+1+12]=F[1],W[j+2+12]=F[2],W[j+3+12]=he,W[j+4+12]=F[0],W[j+5+12]=F[1],W[j+6+12]=F[2],W[j+7+12]=-he,W[j+8+12]=F[0],W[j+9+12]=F[1],W[j+10+12]=F[2],W[j+11+12]=-he,0==M?(K[T]=0,K[T+1]=0,K[T+2]=0,K[T+3]=-y,K[T+4]=K[ge],K[T+5]=K[ge+1],K[T+6]=K[ge+2],K[T+7]=y,K[T+8]=-oe[0],K[T+9]=-oe[1],K[T+10]=-oe[2],K[T+11]=-y,K[T+12]=0,K[T+1+12]=0,K[T+2+12]=0,K[T+3+12]=-y,K[T+4+12]=-K[ge],K[T+5+12]=-K[ge+1],K[T+6+12]=-K[ge+2],K[T+7+12]=y,K[T+8+12]=-oe[0],K[T+9+12]=-oe[1],K[T+10+12]=-oe[2],K[T+11+12]=-y):M==B-1?(K[T]=0,K[T+1]=0,K[T+2]=0,K[T+3]=-y,K[T+4]=K[pe],K[T+5]=K[pe+1],K[T+6]=K[pe+2],K[T+7]=y,K[T+8]=le[0],K[T+9]=le[1],K[T+10]=le[2],K[T+11]=-y,K[T+12]=0,K[T+1+12]=0,K[T+2+12]=0,K[T+3+12]=-y,K[T+4+12]=-K[pe],K[T+5+12]=-K[pe+1],K[T+6+12]=-K[pe+2],K[T+7+12]=y,K[T+8+12]=le[0],K[T+9+12]=le[1],K[T+10+12]=le[2],K[T+11+12]=-y):(K[T]=0,K[T+1]=0,K[T+2]=0,K[T+3]=-y,K[T+4]=K[ge],K[T+5]=K[ge+1],K[T+6]=K[ge+2],K[T+7]=y,K[T+8]=K[pe],K[T+9]=K[pe+1],K[T+10]=K[pe+2],K[T+11]=y,K[T+12]=0,K[T+1+12]=0,K[T+2+12]=0,K[T+3+12]=-y,K[T+4+12]=-K[ge],K[T+5+12]=-K[ge+1],K[T+6+12]=-K[ge+2],K[T+7+12]=y,K[T+8+12]=-K[pe],K[T+9+12]=-K[pe+1],K[T+10+12]=-K[pe+2],K[T+11+12]=y),j+=24,T+=24):(ge=M!=B-1?de+M*J:de+(M-1)*J,pe=M>0?de+(M-1)*J:de+ge,0==M?(W[j]=F[0],W[j+1]=F[1],W[j+2]=F[2],W[j+3]=W[ge],W[j+4]=W[ge+1],W[j+5]=W[ge+2],W[j+6]=F[0]-oe[0]*y,W[j+7]=F[1]-oe[1]*y,W[j+8]=F[2]-oe[2]*y,W[j+9]=F[0],W[j+9+1]=F[1],W[j+9+2]=F[2],W[j+9+3]=W[ge+3],W[j+9+4]=W[ge+4],W[j+9+5]=W[ge+5],W[j+9+6]=F[0]-oe[0]*y,W[j+9+7]=F[1]-oe[1]*y,W[j+9+8]=F[2]-oe[2]*y):M==B-1?(W[j]=F[0],W[j+1]=F[1],W[j+2]=F[2],W[j+3]=W[ge+15],W[j+4]=W[ge+16],W[j+5]=W[ge+17],W[j+6]=F[0]+le[0]*y,W[j+7]=F[1]+le[1]*y,W[j+8]=F[2]+le[2]*y,W[j+9]=F[0],W[j+9+1]=F[1],W[j+9+2]=F[2],W[j+9+3]=W[ge+12],W[j+9+4]=W[ge+13],W[j+9+5]=W[ge+14],W[j+9+6]=F[0]+le[0]*y,W[j+9+7]=F[1]+le[1]*y,W[j+9+8]=F[2]+le[2]*y):(W[j]=F[0],W[j+1]=F[1],W[j+2]=F[2],W[j+3]=W[ge],W[j+4]=W[ge+1],W[j+5]=W[ge+2],W[j+6]=W[pe+15],W[j+7]=W[pe+16],W[j+8]=W[pe+17],W[j+9]=F[0],W[j+9+1]=F[1],W[j+9+2]=F[2],W[j+9+3]=W[ge+3],W[j+9+4]=W[ge+4],W[j+9+5]=W[ge+5],W[j+9+6]=W[pe+12],W[j+9+7]=W[pe+13],W[j+9+8]=W[pe+14]),j+=18);else for(var ye=M!=B-1?M:M-1,Le=0;Le<$;Le++)d&&(P=X+ye,Z[V]=P,Z[V+1]=P,Z[V+2]=P,V+=3),he=W[ye*J+3],W[j]=F[0],W[j+1]=F[1],W[j+2]=F[2],W[j+3]=he,K[T]=0,K[T+1]=0,K[T+2]=0,K[T+3]=0,W[j+4]=F[0],W[j+5]=F[1],W[j+6]=F[2],W[j+7]=he,K[T+4]=D[Le][0]*y,K[T+5]=D[Le][1]*y,K[T+6]=R[Le]+0,K[T+7]=0,W[j+8]=F[0],W[j+9]=F[1],W[j+10]=F[2],W[j+11]=he,K[T+8]=D[Le+1][0]*y,K[T+9]=D[Le+1][1]*y,K[T+10]=R[Le+1]+0,K[T+11]=0,j+=12,T+=12}l&&(z=[F[0],F[1],F[2]+.1*U],ce[M]=z,fe[B-M-1]=z),M+1<B&&(F=ue[M+1])}X+=ue.length}H>0&&(Q[0]/=H,Q[1]/=H,Q[2]/=H),Q[0]+=Ie.groupOrigin[0],Q[1]+=Ie.groupOrigin[1],Q[2]+=Ie.groupOrigin[2];var Ae,me=u||c||h||v;if(o){var Ne={color:p,\\\"z-index\\\":a,center:Q,advancedHit:d,totalPoints:H,\\\"hover-event\\\":u,\\\"click-event\\\":c,\\\"draw-event\\\":f,\\\"width-units\\\":L,hitable:me,state:Ie.hitState,eventInfo:Ie.alwaysEventInfo||me||f?s:{},\\\"enter-event\\\":h,\\\"leave-event\\\":v,\\\"zbuffer-offset\\\":b,\\\"line-width\\\":2*y,lod:Ie.autoLod?null:Ie.tileLod};Ae=g?w?8:x?7:6:w?10:9,w&&null!=m&&(Ne.texture=[Ie.stylesheetBitmaps[m[0]],m[1],m[2]],Ne.background=N);var Ue=JSON.stringify({type:\\\"T\\\"+Ae,color:p,zIndex:a,zOffset:b,state:Ie.hitState}),we=K?[W,K]:[W];d&&we.push(Z),De(5,Ae,Ne,we,Ue)}if(l)for(M=0,B=ee.length;M<B;M++)Ye(ee[M].points,ee[M].points2,e,Q,r,t,n,a,s)}}}},Ye=function(e,r,t,n,a,s,i,o,l){var u=Fe(s,\\\"line-label-type\\\",t,a),c=Fe(s,\\\"line-label-color\\\",t,a),f=Fe(s,\\\"line-label-color2\\\",t,a),h=Fe(s,\\\"line-label-outline\\\",t,a),v=Fe(s,\\\"line-label-source\\\",t,a),d=Fe(s,\\\"line-label-size\\\",t,a),b=Fe(s,\\\"line-label-spacing\\\",t,a),g=(Fe(s,\\\"line-label-line-height\\\",t,a),Fe(s,\\\"line-label-offset\\\",t,a)),p=Fe(s,\\\"dynamic-reduce\\\",t,a),y=Fe(s,\\\"line-label-no-overlap\\\",t,a),L=Fe(s,\\\"line-label-no-overlap-factor\\\",t,a),A=Fe(s,\\\"line-label-no-overlap-margin\\\",t,a);if(!(Math.abs(d)<1e-4)){var m=ze(s,v,t,a,v);m=m?m.replace(\\\"\\\\r\\\\n\\\",\\\"\\\\n\\\").replace(\\\"\\\\r\\\",\\\"\\\\n\\\"):\\\"\\\";var N=Fe(s,\\\"line-label-font\\\",t,a),U=Ge(N),w=Xe(N),x=Re(m,U);if(\\\"$name\\\"==v&&!Te(m,U,x)){var S=ze(s,\\\"$name:en\\\",t,a,v);S=S?S.replace(\\\"\\\\r\\\\n\\\",\\\"\\\\n\\\").replace(\\\"\\\\r\\\",\\\"\\\\n\\\"):\\\"\\\";var M=Re(m,U);Te(S,U,M)&&(m=S,x=M)}if(m&&\\\"\\\"!=m){var B,O,_,k,I,E=Fe(s,\\\"hover-event\\\",t,a),C=Fe(s,\\\"click-event\\\",t,a),F=Fe(s,\\\"draw-event\\\",t,a),z=Fe(s,\\\"enter-event\\\",t,a),P=Fe(s,\\\"leave-event\\\",t,a),j=Fe(s,\\\"advanced-hit\\\",t,a),T=Fe(s,\\\"zbuffer-offset\\\",t,a);Ie.useLineLabel2=\\\"flat\\\"!=u,Ie.useLineLabel2?(B=12*m.length,k=new Float32Array(B),I=new Float32Array(B)):(B=Ve()*m.length*2,O=new Float32Array(B),_=new Float32Array(B));var V={},G=E||C||z||P,X=d;Ie.lineLabelPass=0,Ie.lineLabelPoints=[];var D=je(e,m,d,b,U,g,O,_,0,V,x,k),R=Ie.lineLabelPoints;Ie.lineLabelPoints=[],D=je(r,m,d,b,U,g,O,_,Ie.useLineLabel2?0:D,null,x,I);var $=Ie.lineLabelPoints;if(!D){if(Ie.useLineLabel2)for(;;){d*=.5,Ie.lineLabelPass=0,Ie.lineLabelPoints=[];D=je(e,m,d,b,U,g,O,_,0,V,x,k),R=Ie.lineLabelPoints;Ie.lineLabelPoints=[],D=je(r,m,d,b,U,g,O,_,Ie.useLineLabel2?0:D,null,x,I);$=Ie.lineLabelPoints;if(D||d<.05)break}if(!D)return}var q,Y,H,J=Fe(s,\\\"visibility-rel\\\",t,a)||Fe(s,\\\"visibility-abs\\\",t,a)||Fe(s,\\\"visibility\\\",t,a),W=Fe(s,\\\"culling\\\",t,a),Z=Fe(s,\\\"hysteresis\\\",t,a),K=Ie.bboxMin,Q=[],ee=0;if(Ie.useLineLabel2){for(Y=0,H=R.length;Y<H;Y++)(q=R[Y])[0]+=K[0],q[1]+=K[1],q[2]+=K[2],(q=$[Y])[0]+=K[0],q[1]+=K[1],q[2]+=K[2];for(Q.push([d,Ie.textVector,R,$]),Ie.lineLabelPass=1;d*=2,Ie.lineLabelPoints=[],D=je(e,m,d,b,U,g,O,_,0,V,x,k),R=Ie.lineLabelPoints,D;){for(Ie.lineLabelPoints=[],D=je(r,m,d,b,U,g,O,_,Ie.useLineLabel2?0:D,null,x,I),$=Ie.lineLabelPoints,Y=0,H=R.length;Y<H;Y++)(q=R[Y])[0]+=K[0],q[1]+=K[1],q[2]+=K[2],(q=$[Y])[0]+=K[0],q[1]+=K[1],q[2]+=K[2];Q.push([d,Ie.textVector,R,$])}for(d=X;d*=.5,Ie.lineLabelPoints=[],D=je(e,m,d,b,U,g,O,_,0,V,x,k),R=Ie.lineLabelPoints,!(Ie.textLength<2);){for(Ie.lineLabelPoints=[],D=je(r,m,d,b,U,g,O,_,0,null,x,I),$=Ie.lineLabelPoints,Y=0,H=R.length;Y<H;Y++)(q=R[Y])[0]+=K[0],q[1]+=K[1],q[2]+=K[2],(q=$[Y])[0]+=K[0],q[1]+=K[1],q[2]+=K[2];Q.unshift([d,Ie.textVector,R,$]),ee++}(n=Ie.textCenter)[0]+=K[0],n[1]+=K[1],n[2]+=K[2]}var re=new Array(U.length);for(Y=0,H=U.length;Y<H;Y++)re[Y]=[];for(var te in V){var ne=parseInt(te),ae=V[te],se=[];for(var ie in ae){var oe=parseInt(ie)-4e3*ne,le=Math.round((oe-oe%4)/4);-1==se.indexOf(le)&&se.push(le)}re[ne]=se}var ue=JSON.stringify({type:\\\"line-label\\\",color:c,color2:f,outline:h,fonts:N,zIndex:o,zOffset:T});if(y){var ce=null,fe=null;if(null!==L){switch(L[0]){case\\\"direct\\\":ce=0;break;case\\\"div-by-dist\\\":ce=1}fe=L[1]}var he=[A,ce,fe]}De(5,Ie.useLineLabel2?12:11,{color:c,color2:f,outline:h,textVector:Ie.textVector,labelPoints:Ie.useLineLabel2?Q:[],visibility:J,culling:W,hysteresis:Z,\\\"z-index\\\":o,center:n,\\\"hover-event\\\":E,\\\"click-event\\\":C,\\\"draw-event\\\":F,reduce:p,noOverlap:y?he:null,files:re,\\\"enter-event\\\":z,\\\"leave-event\\\":P,\\\"zbuffer-offset\\\":T,advancedHit:j,labelIndex:ee,labelSize:X,fonts:w,hitable:G,state:Ie.hitState,eventInfo:Ie.alwaysEventInfo||G||F?l:{},lod:Ie.autoLod?null:Ie.tileLod},Ie.useLineLabel2?[k,I]:[O,_],ue)}}},He=n,Je=s,We=q,Ze=ce,Ke=qe,Qe=Be,er=function(e,r,t,n,a,s,i,o){var l=e.borders||[];if(0!=l.length){for(var u,c,f=We(n,\\\"polygon-extrude\\\",e,t),h=function(e){var r={};for(var t in e)\\\"surface\\\"!=t&&\\\"vertices\\\"!=t&&\\\"borders\\\"!=t&&(r[t]=e[t]);return r}(e),v=l.length,d=[],b=[],g=[0,0,0],p=He.tileX,y=He.tileY,L=He.forceOrigin,A=He.forceScale,m=[1/A[0],1/A[1],1/A[2]],N=He.geocent,U=He.bboxMin,w=0;w<v;w++){var x,S=l[w],M=S.length,B=0;if(M>0){var O,_,k;for(o?(O=new Array(M+1),_=new Array(M+1)):(O=new Array(M),_=new Array(M)),k=0;k<M;k++)S[k]>=0?(x=3*S[k],B++):x=3*-S[k],f?(c=(u=[r[x],r[x+1],r[x+2]]).slice(),L&&(c=[c[0]-p,c[1]-y,c[2]]),null!=A&&(c=[c[0]*A[0],c[1]*A[1],c[2]*A[2]]),N?(Je([c[0]+U[0],c[1]+U[1],c[2]+U[2]],g),c=[u[0]+g[0]*f*m[0],u[1]+g[1]*f*m[1],u[2]+g[2]*f*m[2]]):c[2]+=f,O[k]=u,_[k]=c,S[k]>=0&&d.push([u,c])):O[k]=[r[x],r[x+1],r[x+2]],o&&0==k&&(O[M]=O[0],_[M]=_[0]);var I=new Array(B),E=new Array(B),C=0;for(k=0;k<M;k++)S[k]>=0&&(I[C]=O[k].slice(),f&&(E[C]=_[k].slice()),C++);d.push(O),b=b.concat(I),f&&(d.push(_),b=b.concat(E))}}o&&d.length>0?(h.lines=d,Ke(h,t,n,a,s,i)):b.length>0&&(h.points=b,Qe(h,t,n,a,s,i))}},rr=n,tr=function(e){var r=S.parse(e.data);N.fontsStorage[e.url]=r},nr=function(e,r){if(l&&!r)return l.decode(e);var t,n,a,s,i,o;for(t=\\\"\\\",a=(e=new Uint8Array(e)).length,n=0;n<a;)switch((s=e[n++])>>4){case 0:case 1:case 2:case 3:case 4:case 5:case 6:case 7:t+=String.fromCharCode(s);break;case 12:case 13:i=e[n++],t+=String.fromCharCode((31&s)<<6|63&i);break;case 14:i=e[n++],o=e[n++],t+=String.fromCharCode((15&s)<<12|(63&i)<<6|(63&o)<<0)}return t},ar=function(e){var r=e.map;for(var t in r)N.fonts[t]=N.fontsStorage[r[t]];N.fontsMap=r},sr=function e(r){if(!r||!Array.isArray(r))return r;var t,n,a=[r[0]];switch(r[0]){case\\\"all\\\":case\\\"any\\\":case\\\"none\\\":case\\\"skip\\\":for(t=1,n=r.length;t<n;t++)a[t]=e(r[t]);return a}switch(a[1]=r[1],a[2]=re(r[1]),r[0]){case\\\"==\\\":case\\\"!=\\\":case\\\">=\\\":case\\\"<=\\\":case\\\">\\\":case\\\"<\\\":a[3]=r[2],a[4]=re(r[2]);break;case\\\"in\\\":case\\\"!in\\\":for(t=2,n=r.length;t<n;t++)a[t+1]=r[t]}return a},ir=function(e,r,t){var n=j.stylesheetData.layers[e];return null==n?(W(\\\"wrong-Layer\\\",e,null,null,t,r),{}):n},or=q,lr=function(e){var r;j.stylesheetBitmaps={},j.stylesheetFonts={},j.stylesheetConstants=e.constants||{},j.stylesheetVariables=e.variables||{},j.stylesheetLocals={};var t=e.bitmaps||{};for(r in t){var n=t[r];\\\"string\\\"==typeof n?n={url:n,hash:G(n)}:\\\"object\\\"==typeof n?null==n.url?(n.hash=\\\"null\\\",W(\\\"wrong-bitmap\\\",r)):n.hash=G(n.url):W(\\\"wrong-bitmap\\\",r),j.stylesheetBitmaps[r]=n}for(r in postMessage({command:\\\"loadBitmaps\\\",bitmaps:j.stylesheetBitmaps}),t=j.stylesheetBitmaps)(n=t[r]).url=null;var a=e.fonts||{};for(r in a){var s=a[r];\\\"string\\\"==typeof s?s={url:s}:\\\"object\\\"==typeof s?null==s.url&&W(\\\"wrong-font\\\",r):W(\\\"wrong-font\\\",r),j.stylesheetFonts[r]=s}postMessage({command:\\\"loadFonts\\\",fonts:j.stylesheetFonts}),j.stylesheetData={layers:{}};var i=e.layers||{};for(r in j.stylesheetLayers=j.stylesheetData.layers,i)j.stylesheetData.layers[r]=te(r,i[r],e)},ur=ee,cr=qe,fr=Be,hr=function(e,r,t,n,a,s){var i,o,l=[];if(Me(e),(l=e.lines?e.lines:[e.points])&&0!=l.length){var u,c,f,h=be(t,\\\"visibility-rel\\\",e,r)||be(t,\\\"visibility-abs\\\",e,r)||be(t,\\\"visibility\\\",e,r),v=be(t,\\\"culling\\\",e,r),d=be(t,\\\"hysteresis\\\",e,r),b=0;for(c=0,f=l.length;c<f;c++)u=l[c],Array.isArray(u)&&u.length>0&&(b+=u.length);var g,p,y=[0,0,0],L=ve.forceOrigin,A=ve.bboxMin,m=ve.tileX,N=ve.tileY,U=ve.forceScale;for(c=0,f=l.length;c<f;c++)if(u=l[c],Array.isArray(u)&&u.length>0)for(i=0,o=u.length;i<o;i++)p=[(g=u[i])[0],g[1],g[2]],L&&(p=[p[0]-m,p[1]-N,p[2]]),null!=U&&(p=[p[0]*U[0],p[1]*U[1],p[2]*U[2]]),y[0]+=p[0],y[1]+=p[1],y[2]+=p[2];b>0&&(y[0]/=b,y[1]/=b,y[2]/=b),y[0]+=A[0],y[1]+=A[1],y[2]+=A[2],ve.signatureCounter++;var w=\\\"\\\"+ve.signatureCounter;Se(5,20,{\\\"z-index\\\":a,hysteresis:d,visibility:h,culling:v,center:y,eventInfo:{},index:n,lod:ve.autoLod?null:ve.tileLod},[],w)}},vr=function(e,r,t,n,a,s){var i=e.vertices||[];if(0!=i.length&&((We(t,\\\"point\\\",e,r)||We(t,\\\"label\\\",e,r))&&er(e,i,r,t,n,a,s,!1),(We(t,\\\"line\\\",e,r)||We(t,\\\"line-label\\\",e,r))&&er(e,i,r,t,n,a,s,!0),We(t,\\\"polygon\\\",e,r))){var o=e.surface||[];if(0!=o.length){var l=We(t,\\\"hover-event\\\",e,r),u=We(t,\\\"click-event\\\",e,r),c=We(t,\\\"draw-event\\\",e,r),f=We(t,\\\"enter-event\\\",e,r),h=We(t,\\\"leave-event\\\",e,r),v=We(t,\\\"advanced-hit\\\",e,r),d=We(t,\\\"zbuffer-offset\\\",e,r),b=We(t,\\\"polygon-color\\\",e,r),g=We(t,\\\"polygon-style\\\",e,r),p=We(t,\\\"polygon-use-stencil\\\",e,r),y=We(t,\\\"polygon-culling\\\",e,r),L=We(t,\\\"polygon-extrude\\\",e,r);g=\\\"flatshade\\\"==g?1:0,y=\\\"back\\\"==y?1:0;for(var A,m,N,U,w=He.geocent,x=[0,0,0],S=[0,0,0],M=He.bboxMin,B=3*(o.length/3),O=new Float32Array(3*B),_=0,k=0,I=[0,0,0],E=[0,0,0],C=[0,0,0],F=[0,0,0],z=He.tileX,P=He.tileY,j=He.forceOrigin,T=He.forceScale,V=0;V<B;V++)I=[i[A=3*o[_++]],i[A+1],i[A+2]],j&&(I=[I[0]-z,I[1]-P,I[2]]),null!=T&&(I=[I[0]*T[0],I[1]*T[1],I[2]*T[2]]),L&&(w?(Je([I[0]+M[0],I[1]+M[1],I[2]+M[2]],S),I[0]+=S[0]*L,I[1]+=S[1]*L,I[2]+=S[2]*L):I[2]+=L),x[0]+=I[0],x[1]+=I[1],x[2]+=I[2],O[k++]=I[0],O[k++]=I[1],O[k++]=I[2];if(B>0){var G=1/B;x[0]*=G,x[1]*=G,x[2]*=G}x[0]+=He.groupOrigin[0],x[1]+=He.groupOrigin[1],x[2]+=He.groupOrigin[2];var X=e.borders||[];if(X.length>0){var D=0;for(V=0,m=X.length;V<m;V++){D+=2*(($=X[V]).length+1)}var R=O;for((O=new Float32Array(O.length+3*D*3)).set(R),V=0,m=X.length;V<m;V++){var $,q;for(N=0,U=($=X[V]).length;N<U;N++)q=$[N]>=0?3*$[N]:3*-$[N],I[0]=i[q],I[1]=i[q+1],I[2]=i[q+2],C[0]=i[q],C[1]=i[q+1],C[2]=i[q+2],q=N<U-1?$[N+1]>=0?3*$[N+1]:3*-$[N+1]:$[0]>=0?3*$[0]:3*-$[0],E[0]=i[q],E[1]=i[q+1],E[2]=i[q+2],F[0]=i[q],F[1]=i[q+1],F[2]=i[q+2],j&&(I=[I[0]-z,I[1]-P,I[2]],E=[E[0]-z,E[1]-P,E[2]],C=[C[0]-z,C[1]-P,C[2]],F=[F[0]-z,F[1]-P,F[2]]),null!=T&&(I=[I[0]*T[0],I[1]*T[1],I[2]*T[2]],E=[E[0]*T[0],E[1]*T[1],E[2]*T[2]],C=[C[0]*T[0],C[1]*T[1],C[2]*T[2]],F=[F[0]*T[0],F[1]*T[1],F[2]*T[2]]),L&&(w?(Je([I[0]+M[0],I[1]+M[1],I[2]+M[2]],S),I=[I[0]+S[0]*L,I[1]+S[1]*L,I[2]+S[2]*L],Je([E[0]+M[0],E[1]+M[1],E[2]+M[2]],S),E=[E[0]+S[0]*L,E[1]+S[1]*L,E[2]+S[2]*L]):(I[2]+=L,E[2]+=L)),O[k]=F[0],O[k+1]=F[1],O[k+2]=F[2],O[k+3]=E[0],O[k+4]=E[1],O[k+5]=E[2],O[k+6]=I[0],O[k+7]=I[1],O[k+8]=I[2],O[k+9]=I[0],O[k+10]=I[1],O[k+11]=I[2],O[k+12]=C[0],O[k+13]=C[1],O[k+14]=C[2],O[k+15]=F[0],O[k+16]=F[1],O[k+17]=F[2],k+=18}}var Y=l||u||f||h,H=JSON.stringify({style:g,culling:y,stencil:p,color:b,zIndex:a,zOffset:d,state:He.hitState});Ze(5,13,{color:b,\\\"z-index\\\":a,center:x,advancedHit:v,culling:y,\\\"hover-event\\\":l,\\\"click-event\\\":u,\\\"draw-event\\\":c,style:g,stencil:p,hitable:Y,state:He.hitState,eventInfo:He.alwaysEventInfo||Y||c?s:{},\\\"enter-event\\\":f,\\\"leave-event\\\":h,\\\"zbuffer-offset\\\":d,lod:He.autoLod?null:He.tileLod},[O],H)}}},dr=function(e){$e(e);var r=e.lines;if(!r&&0!=r.length){var t=0,n=new Uint32Array(r.length);for(c=0;c<r.length;c++)n[c]=t,Array.isArray(r[c])&&(t+=r[c].length);for(var a,s,i,o=new Float64Array(3*t),l=Ie.forceScale,u=0,c=0;c<r.length;c++)if(Array.isArray(r[c])&&r[c].length){var f=r[c];a=[(i=f[0])[0],i[1],i[2]];for(var h=0,v=f.length;h<v&&(null!=l&&(s=[a[0]*l[0],a[1]*l[1],a[2]*l[2]]),o[u]=s[0],o[u+1]=s[1],o[u+2]=s[2],u+=3,h!=v-1);h++)a=f[h+1]}Ie.signatureCounter++,De(5,14,{id:e.id},[o,n],\\\"\\\"+Ie.signatureCounter)}},br=function(e){if(Me(e),e.lines?pointsGroups=e.lines:pointsGroups=[e.points],pointsGroups&&0!=pointsGroups.length){var r=0,t=new Uint32Array(pointsGroups.length);for(u=0;u<pointsGroups.length;u++)t[u]=r,Array.isArray(pointsGroups[u])&&(r+=pointsGroups[u].length);for(var n,a,s,i=new Float64Array(3*r),o=ve.forceScale,l=0,u=0;u<pointsGroups.length;u++)if(Array.isArray(pointsGroups[u])&&pointsGroups[u].length){var c=pointsGroups[u];n=[(s=c[0])[0],s[1],s[2]];for(var f=0,h=c.length;f<h&&(null!=o&&(a=[n[0]*o[0],n[1]*o[1],n[2]*o[2]]),i[l]=a[0],i[l+1]=a[1],i[l+2]=a[2],l+=3,f!=h-1);f++)n=c[f+1]}ve.signatureCounter++,Se(5,5,{id:e.id},[i,t],\\\"\\\"+ve.signatureCounter)}},gr=function(e,r,t){var n=0,a=new ArrayBuffer(6),s=new DataView(a);n=0,s.setUint8(n,e),n+=1,s.setUint8(n,r),n+=1,s.setUint32(n,t||0),fe(e,r,a,n+=4,\\\"\\\")},pr=function(){for(var e,r,t,n,a,s,i,o,l=ne.messageBuffer,u=0,c=ne.messageBufferIndex;u<c;u++){(A=l[u]).job;var f=A.type,h=A.signature;if(!A.hitable&&!A.reduced&&f>=6&&f<=13)switch(f){case 13:case 6:for(o=0,i=4*new DataView(A.job).getUint32(A.buffersIndex),he(0,new Uint8Array(A.job,A.buffersIndex+4,i),0),a=i,e=u+1;e<c;e++)(n=l[e]).signature==h&&(n.reduced=!0,o++,i=4*new DataView(n.job).getUint32(n.buffersIndex),he(0,new Uint8Array(n.job,n.buffersIndex+4,i),a),a+=i);o>0&&(y=new Uint8Array(A.buffersIndex+2*(4+a)),s=new DataView(y.buffer),y.set(new Uint8Array(A.job,0,A.buffersIndex),0),s.setUint32(A.buffersIndex,a/4),y.set(new Uint8Array(se.buffer,0,a),A.buffersIndex+4),ne.messagePackSize-=A.job.byteLength,ne.messagePackSize+=y.byteLength,A.job=y.buffer);break;case 9:case 11:case 7:for(o=0,0,i=new DataView(A.job).getUint32(A.buffersIndex),i*=4,he(0,new Uint8Array(A.job,A.buffersIndex+4,i),0),he(1,new Uint8Array(A.job,A.buffersIndex+4+i+4,i),0),a=i,e=u+1;e<c;e++)if((n=l[e]).signature==h&&(n.reduced=!0,ne.messagePackSize-=n.job.byteLength,o++,i=new DataView(n.job).getUint32(n.buffersIndex),i*=4,he(0,new Uint8Array(n.job,n.buffersIndex+4,i),a),he(1,new Uint8Array(n.job,n.buffersIndex+4+i+4,i),a),a+=i,11==f)){var v=A.job2.files,d=n.job2.files;for(t=0,r=d.length;t<r;t++){v[t]||(v[t]=[]);for(var b=0,g=d[t].length;b<g;b++)-1==v[t].indexOf(d[t][b])&&v[t].push(d[t][b])}}if(o>0){if(11==f){var p=ae(JSON.stringify(A.job2));y=new Uint8Array(6+p.byteLength+2*(4+a)),L=0,(s=new DataView(y.buffer)).setUint8(L,A.command),L+=1,s.setUint8(L,f),L+=1,s.setUint32(L,p.byteLength),L+=4,y.set(p,L),L+=p.byteLength,A.buffersIndex=L}else y=new Uint8Array(A.buffersIndex+2*(4+a)),s=new DataView(y.buffer),y.set(new Uint8Array(A.job,0,A.buffersIndex),0);s.setUint32(A.buffersIndex,a/4),y.set(new Uint8Array(se.buffer,0,a),A.buffersIndex+4),s.setUint32(A.buffersIndex+4+a,a/4),y.set(new Uint8Array(ie.buffer,0,a),A.buffersIndex+4+a+4),ne.messagePackSize-=A.job.byteLength,ne.messagePackSize+=y.byteLength,A.job=y.buffer}}}var y=new Uint8Array(ne.messagePackSize),L=0;for(u=0,c=ne.messageBufferIndex;u<c;u++){var A;(A=ne.messageBuffer[u]).reduced||(y.set(new Uint8Array(A.job),L),L+=ne.messageBuffer[u].job.byteLength)}ue({command:\\\"addPackedCommands\\\",buffer:y},[y.buffer]),ne.messageBufferIndex=0,ne.messagePackSize=0},yr=ce,Lr=ue,Ar=function(){oe.length>0&&(le.length>0?postMessage({command:\\\"packed-events\\\",messages:oe},le):postMessage({command:\\\"packed-events\\\",messages:oe}),oe=[],le=[])},mr=H,Nr=[],Ur=new Array(1024),wr=0,xr=new Array(1024),Sr=0,Mr=0;function Br(e,r,t,n,a,s,i){switch(rr.stylesheetLocals={},e){case\\\"line-string\\\":(or(n,\\\"point\\\",r,t)||or(n,\\\"label\\\",r,t))&&fr(r,t,n,a,s,i),cr(r,t,n,a,s,i);break;case\\\"point-array\\\":fr(r,t,n,a,s,i);break;case\\\"polygon\\\":vr(r,t,n,a,s,i)}}function Or(e,r,t,n,a){var s=rr.reduceParams;for(var i in rr.stylesheetLayers){var o=rr.stylesheetLayers[i];if(\\\"point-array\\\"==e){var l=o[\\\"importance-source\\\"];if(null==l&&r[0]&&r[0].importance&&(l=\\\"$importance\\\"),null!=l)switch(rr.reduceMode){case\\\"scr-count1\\\":case\\\"scr-count2\\\":o.reduce=[\\\"top\\\",100,l],o[\\\"dynamic-reduce\\\"]=[\\\"scr-count2\\\",s[0],s[1]];break;case\\\"scr-count4\\\":o[\\\"dynamic-reduce\\\"]=[\\\"scr-count4\\\",l];break;case\\\"scr-count5\\\":o[\\\"dynamic-reduce\\\"]=[\\\"scr-count5\\\",l];break;case\\\"scr-count6\\\":case\\\"scr-count7\\\":case\\\"scr-count8\\\":var u=\\\"scr-count8\\\"==rr.reduceMode?s[6]:s[5];o[\\\"dynamic-reduce\\\"]=[rr.reduceMode,l,void 0!==o[\\\"importance-weight\\\"]?o[\\\"importance-weight\\\"]:1],o[\\\"label-no-overlap-margin\\\"]=[s[0]*u,s[0]*u],o[\\\"icon-no-overlap-margin\\\"]=[s[0]*u,s[0]*u],o[\\\"label-no-overlap-factor\\\"]=[\\\"div-by-dist\\\",l]}}var c,f,h=o.filter,v=o.reduce;for(h&&((h=o[\\\"#filter\\\"])||(o[\\\"#filter\\\"]=sr(o.filter),h=o[\\\"#filter\\\"])),wr=0,Sr=0,Mr=0,c=0,f=r.length;c<f;c++){var d=r[c];d.properties=d.properties||{},d.id&&(d.properties[\\\"#id\\\"]=d.id),h&&!ur(h,d,n,a,o,\\\"filter\\\",t,0,!0)||(v?(Ur[wr]=d,wr++):kr(e,d,t,o,c))}if(v){var b=v[1],g=v[2];switch(v[0]){case\\\"top\\\":case\\\"bottom\\\":if(\\\"string\\\"==typeof g&&\\\"@\\\"==g.charAt(0)&&void 0===(g=rr.stylesheetConstants[g]))break;if(\\\"string\\\"==typeof g&&\\\"$\\\"==g.charAt(0)||\\\"object\\\"==typeof g){var p=\\\"object\\\"==typeof g;p||(g=g.substr(1)),b>wr&&(b=wr);var y,L=\\\"top\\\"==v[0],A=0,m=L?Number.POSITIVE_INFINITY:Number.NEGATIVE_INFINITY;do{var N=L?Number.NEGATIVE_INFINITY:Number.POSITIVE_INFINITY;for(Mr=Sr,c=0,f=wr;c<f;c++)d=Ur[c],A?y=d.tmp:(y=p?mr(o,null,d,t,g,0):parseFloat(d.properties[g]),d.tmp=y),!isNaN(y)&&(L&&y>=N&&y<m||y<=N&&y>m)&&(N!=y&&(Sr=Mr),xr[Sr]=d,Sr++,N=y);m=N,A++}while(A<b)}break;case\\\"odd\\\":case\\\"even\\\":for(c=\\\"odd\\\"==v[0]?1:0,f=wr;c<f;c+=2)d=Ur[c],xr[Sr]=d,Sr++;case\\\"every\\\":for(b>wr&&(b=wr),c=0,f=wr;c<f;c+=b)d=Ur[c],xr[Sr]=d,Sr++}for(c=0,f=Sr;c<f;c++)d=xr[c],kr(e,xr[c],t,o,c)}}}function _r(e,r,t,n,a,s){var i,o=or(n,\\\"next-pass\\\",r,t);if(null!=o)for(var l=0,u=o.length;l<u;l++){var c=o[l][0];if(i=ir(o[l][1],e,a),or(i,\\\"visible\\\",r,t)){var f=or(i,\\\"selected-layer\\\",r,t),h=\\\"\\\"!=f?ir(f,e,a):null,v=or(i,\\\"selected-hover-layer\\\",r,t),d=\\\"\\\"!=v?ir(v,e,a):null,b=or(i,\\\"hover-layer\\\",r,t),g=\\\"\\\"!=b?ir(b,e,a):null,p=(null!=g?256:0)|(null!=h?512:0)|(null!=d?1024:0),y=rr.hitState;null!=h&&(rr.hitState=2|p,Br(e,r,t,h,a,c,s)),null!=d&&(rr.hitState=3|p,Br(e,r,t,d,a,c,s)),null!=g&&(rr.hitState=1|p,Br(e,r,t,g,a,c,s)),Br(e,r,t,i,a,c,s),rr.hitState=y}}}function kr(e,r,t,n,a,s){if(or(n,\\\"visible\\\",r,t))if(\\\"point-array\\\"==e&&n[\\\"visibility-switch\\\"]){gr(5,17);var i=or(n,\\\"z-index\\\",r,t),o=r.properties;hr(r,t,n,a,i,o);for(var l=n[\\\"visibility-switch\\\"],u=0,c=l.length;u<c;u++){if(l[u][1])kr(e,r,t,ir(l[u][1],e,a),a);gr(5,18,l[u][0])}gr(5,19)}else if(s||1!=n.pack||(rr.directPoints=[],gr(5,15),kr(e,r,t,n,a,!0),gr(5,16),!rr.directPoints)){i=or(n,\\\"z-index\\\",r,t);if(or(n,\\\"export-geometry\\\",r,t)&&void 0!==r.id&&!Nr[r]){switch(e){case\\\"line-string\\\":dr(r);break;case\\\"point-array\\\":br(r)}Nr[r]=!0}o=r.properties;var f=or(n,\\\"selected-layer\\\",r,t),h=\\\"\\\"!=f?ir(f,e,a):null,v=or(n,\\\"selected-hover-layer\\\",r,t),d=\\\"\\\"!=v?ir(v,e,a):null,b=or(n,\\\"hover-layer\\\",r,t),g=\\\"\\\"!=b?ir(b,e,a):null,p=(null!=g?256:0)|(null!=h?512:0)|(null!=d?1024:0);null!=h&&(rr.hitState=2|p,Br(e,r,t,h,a,i,o),_r(e,r,t,h,a,o)),null!=d&&(rr.hitState=3|p,Br(e,r,t,d,a,i,o),_r(e,r,t,d,a,o)),null!=g&&(rr.hitState=1|p,Br(e,r,t,g,a,i,o),_r(e,r,t,g,a,o)),rr.hitState=0|p,Br(e,r,t,n,a,i,o),_r(e,r,t,n,a,o)}}function Ir(e,r){var t=e.id||\\\"\\\";rr.groupId=t;var n=e.bbox;if(n){var a=n[0],s=n[1];rr.bboxMin=a,rr.bboxMax=s;var i=[n[1][0]-n[0][0],n[1][1]-n[0][1],n[1][2]-n[0][2]],o=e.resolution||4096;rr.groupOrigin=[0,0,0],rr.forceScale=[i[0]/o,i[1]/o,i[2]/o],yr(9,0,{id:e.id,bbox:[a,s],origin:a},[],\\\"\\\");var l=e.points||[];rr.featureType=\\\"point\\\",Or(\\\"point-array\\\",l,r,\\\"point\\\",t);var u=e.lines||[];rr.featureType=\\\"line\\\",Or(\\\"line-string\\\",u,r,\\\"line\\\",t);var c=e.polygons||[];rr.featureType=\\\"polygon\\\",Or(\\\"polygon\\\",c,r,\\\"polygon\\\",t),gr(10,0),rr.groupOptimize&&pr()}}function Er(e,r){var t,n;yr(5,21,{volume:e.volume,precision:e.precision,tileset:e.tileset},[],\\\"\\\");var a=e.meshes||[];for(t=0,n=a.length;t<n;t++){var s=a[t];yr(5,23,{path:a[t]},[],s)}var i=e.nodes||[];for(t=0,n=i.length;t<n;t++)Er(i[t],r);yr(5,22,{},[],\\\"\\\")}self.onmessage=function(e){var r=e.data,t=r.command,n=r.data,a=null,s=!1;switch(t){case\\\"config\\\":rr.config=n;break;case\\\"setStylesheet\\\":n&&(rr.geocent=n.geocent,rr.metricUnits=n.metric,rr.reduceMode=n.reduceMode,rr.reduceParams=n.reduceParams,rr.log=n.log,rr.language=n.language,lr(n.data));break;case\\\"setFont\\\":tr(n);break;case\\\"setFontMap\\\":ar(n),postMessage({command:\\\"styleDone\\\"}),postMessage({command:\\\"ready\\\"});break;case\\\"processGeodataRaw\\\":if(a=n,n.length>2){var i=new DataView(n),o=\\\"\\\";o+=String.fromCharCode(i.getUint8(0,!0)),\\\"GE\\\"!=(o+=String.fromCharCode(i.getUint8(1,!0)))&&(s=!0)}n=nr(n);case\\\"processGeodata\\\":rr.tileLod=r.lod||0,rr.tileIX=r.ix||0,rr.tileIY=r.iy||0,rr.tileSize=r.tileSize||1,rr.pixelSize=r.pixelSize||1,rr.pixelFactor=r.dpr||1,rr.invPixelFactor=1/rr.pixelFactor,rr.pixelsPerMM=rr.pixelFactor/96/2.54,rr.invPixelsPerMM=1/rr.pixelsPerMM,Nr=[],s?processGeodata2(i,rr.tileLod):function(e,r){if(\\\"string\\\"==typeof e)try{var t=JSON.parse(e)}catch(e){t=null}else t=e;if(t){for(var n=t.groups||[],a=0,s=n.length;a<s;a++)Ir(n[a],r);var i=t.nodes||[];for(a=0,s=i.length;a<s;a++)yr(9,0,{},[],\\\"\\\"),Er(i[a],r),gr(10,0)}}(n=JSON.parse(n),rr.tileLod),gr(7,0),rr.groupOptimize&&pr(),a?Lr({command:\\\"ready\\\",geodata:a},[a]):Lr({command:\\\"ready\\\"}),rr.config.mapPackLoaderEvents&&Ar()}}}]);\\n//# sourceMappingURL=613b72349d2ca54e7f86.worker.js.map\", null);\n};","module.exports = function() {\n  return require(\"!!/home/magic/Public/secret_content/experiementing-vts/vts-browser-js/node_modules/worker-loader/dist/workers/InlineWorker.js\")(\"/*!\\n * Copyright (c) 2020 Melown Technologies SE\\n *  *  For terms of use, see accompanying main file.\\n *  *  For 3rd party libraries licenses, see 3rdpartylicenses.txt.\\n * \\n */!function(e){var n={};function t(a){if(n[a])return n[a].exports;var r=n[a]={i:a,l:!1,exports:{}};return e[a].call(r.exports,r,r.exports,t),r.l=!0,r.exports}t.m=e,t.c=n,t.d=function(e,n,a){t.o(e,n)||Object.defineProperty(e,n,{enumerable:!0,get:a})},t.r=function(e){\\\"undefined\\\"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(e,Symbol.toStringTag,{value:\\\"Module\\\"}),Object.defineProperty(e,\\\"__esModule\\\",{value:!0})},t.t=function(e,n){if(1&n&&(e=t(e)),8&n)return e;if(4&n&&\\\"object\\\"==typeof e&&e&&e.__esModule)return e;var a=Object.create(null);if(t.r(a),Object.defineProperty(a,\\\"default\\\",{enumerable:!0,value:e}),2&n&&\\\"string\\\"!=typeof e)for(var r in e)t.d(a,r,function(n){return e[n]}.bind(null,r));return a},t.n=function(e){var n=e&&e.__esModule?function(){return e.default}:function(){return e};return t.d(n,\\\"a\\\",n),n},t.o=function(e,n){return Object.prototype.hasOwnProperty.call(e,n)},t.p=\\\"\\\",t(t.s=0)}([function(e,n,t){\\\"use strict\\\";t.r(n);var a={},r=a;function i(e,n){var t={valid:!0};return function(e,n,t){var a=t.data;n.flags=a.getUint8(t.index,!0),t.index+=1,e.version>1?(n.surfaceReference=a.getUint8(t.index,!0),t.index+=1):n.surfaceReference=0;n.textureLayer=a.getUint16(t.index,!0),t.index+=2,n.textureLayer2=n.textureLayer;var r=[],i=[];r[0]=a.getFloat64(t.index,!0),t.index+=8,r[1]=a.getFloat64(t.index,!0),t.index+=8,r[2]=a.getFloat64(t.index,!0),t.index+=8,i[0]=a.getFloat64(t.index,!0),t.index+=8,i[1]=a.getFloat64(t.index,!0),t.index+=8,i[2]=a.getFloat64(t.index,!0),t.index+=8,n.bboxMin=r,n.bboxMax=i}(e,t,n),e.version>=3?function(e,n,t){var a,i,o,f=t.data,u=t.index,c=t.uint8Data,d=r.config.map16bitMeshes,g=r.config.mapOnlyOneUVs&&1&n.flags,x=f.getUint16(u,!0);u+=2;var b=f.getUint16(u,!0);u+=2,x||(n.valid=!1);var m,y,p,v,U=n.bboxMin,h=n.bboxMax,w=[.5*(U[0]+h[0]),.5*(U[1]+h[1]),.5*(U[2]+h[2])],A=Math.abs(Math.max(h[0]-U[0],h[1]-U[1],h[2]-U[2])),V=1/b,z=null,M=d?new Uint16Array(3*x):new Float32Array(3*x),F=0,S=0,O=0,L=w[0],k=w[1],j=w[2],P=U[0],C=U[1],R=U[2],_=1/(h[0]-U[0]),B=1/(h[1]-U[1]),I=1/(h[2]-U[2]),T=[0,u];if(d)for(y=0;y<x;y++)l(c,T),F+=T[0],l(c,T),S+=T[0],l(c,T),O+=T[0],(v=(F*V*A+L-P)*_)<0&&(v=0),v>1&&(v=1),M[m=3*y]=65535*v,(v=(S*V*A+k-C)*B)<0&&(v=0),v>1&&(v=1),M[m+1]=65535*v,(v=(O*V*A+j-R)*I)<0&&(v=0),v>1&&(v=1),M[m+2]=65535*v;else for(y=0;y<x;y++)l(c,T),F+=T[0],l(c,T),S+=T[0],l(c,T),O+=T[0],M[m=3*y]=(F*V*A+L-P)*_,M[m+1]=(S*V*A+k-C)*B,M[m+2]=(O*V*A+j-R)*I;if(u=T[1],2&n.flags)if(b=f.getUint16(u,!0),u+=2,T[1]=u,g)for(y=0;y<x;y++)l(c,T),l(c,T);else if(V=d?65535/b:1/b,z=d?new Uint16Array(2*x):new Float32Array(2*x),F=0,S=0,d)for(y=0;y<x;y++){l(c,T),F+=T[0],l(c,T),S+=T[0],(v=F*V)<0&&(v=0),v>65535&&(v=65535),z[D=2*y]=v,(v=S*V)<0&&(v=0),v>65535&&(v=65535),z[D+1]=65535-v}else for(y=0;y<x;y++){var D;l(c,T),F+=T[0],l(c,T),S+=T[0],z[D=2*y]=F*V,z[D+1]=1-S*V}if(u=T[1],a=M,i=z,1&n.flags){var E=f.getUint16(u,!0);u+=2;var q=f.getUint16(u,!0);u+=2;var H=f.getUint16(u,!0);u+=2;var G=d?65536/q:1/q,X=d?65536/H:1/H;F=0,S=0;var J=d?new Uint16Array(2*E):new Float32Array(2*E);if(T[1]=u,d)for(y=0,p=2*E;y<p;y+=2)l(c,T),F+=T[0],l(c,T),S+=T[0],(v=F*G)<0&&(v=0),v>65535&&(v=65535),J[y]=v,(v=S*X)<0&&(v=0),v>65535&&(v=65535),J[y+1]=65535-v;else for(y=0,p=2*E;y<p;y+=2)l(c,T),F+=T[0],l(c,T),S+=T[0],J[y]=F*G,J[y+1]=1-S*X;u=T[1],o=J}var K=f.getUint16(u,!0);u+=2;var N=null;J=null,z=null;var Q=r.config.mapIndexBuffers&&r.config.mapOnlyOneUVs&&!(1&n.flags),W=r.config.mapIndexBuffers&&r.config.mapOnlyOneUVs&&1&n.flags,Y=Q||W;Y?N=new Uint16Array(3*K):(M=d?new Uint16Array(3*K*3):new Float32Array(3*K*3),1&n.flags&&(J=d?new Uint16Array(3*K*2):new Float32Array(3*K*2)),!g&&2&n.flags&&(z=d?new Uint16Array(3*K*2):new Float32Array(3*K*2)));var Z,$,ee,ne,te,ae,re=a,ie=i,se=o,le=0;for(T[1]=u,y=0;y<K;y++)if(s(c,T),Z=le-T[0],T[0]||le++,s(c,T),$=le-T[0],T[0]||le++,s(c,T),ee=le-T[0],T[0]||le++,Y)N[m=3*y]=Z,N[m+1]=$,N[m+2]=ee;else{var oe=3*Z;M[m=9*y]=re[oe],M[m+1]=re[oe+1],M[m+2]=re[oe+2],oe=3*$,M[m+3]=re[oe],M[m+4]=re[oe+1],M[m+5]=re[oe+2],oe=3*ee,M[m+6]=re[oe],M[m+7]=re[oe+1],M[m+8]=re[oe+2],null!=z&&(z[m=6*y]=ie[2*Z],z[m+1]=ie[2*Z+1],z[m+2]=ie[2*$],z[m+3]=ie[2*$+1],z[m+4]=ie[2*ee],z[m+5]=ie[2*ee+1])}Q&&(M=a,z=i);W&&(M=d?new Uint16Array(se.length/2*3):new Float32Array(se.length/2*3),J=o);if(le=0,null!=J)for(y=0;y<K;y++)s(c,T),Z=le-T[0],T[0]||le++,s(c,T),$=le-T[0],T[0]||le++,s(c,T),ee=le-T[0],T[0]||le++,W?(ne=3*N[m=3*y],te=3*N[m+1],ae=3*N[m+2],M[3*Z]=re[ne],M[3*Z+1]=re[ne+1],M[3*Z+2]=re[ne+2],M[3*$]=re[te],M[3*$+1]=re[te+1],M[3*$+2]=re[te+2],M[3*ee]=re[ae],M[3*ee+1]=re[ae+1],M[3*ee+2]=re[ae+2],N[m]=Z,N[m+1]=$,N[m+2]=ee):(J[m=6*y]=se[2*Z],J[m+1]=se[2*Z+1],J[m+2]=se[2*$],J[m+3]=se[2*$+1],J[m+4]=se[2*ee],J[m+5]=se[2*ee+1]);u=T[1],n.vertices=M,n.internalUVs=J,n.externalUVs=z,n.indices=N,t.index=u,n.size=n.vertices.byteLength,n.internalUVs&&(n.size+=n.internalUVs.byteLength);n.externalUVs&&(n.size+=n.externalUVs.byteLength);n.indices&&(n.size+=n.indices.byteLength);n.faces=K}(0,t,n):function(e,n,t){var a=t.data,i=t.index,s=t.uint8Data,l=r.config.map16bitMeshes,o=a.getUint16(i,!0);i+=2,o||(n.valid=!1);var f,u,c,d=null,g=null,x=r.config.mapOnlyOneUVs&&1&n.flags,b=l?new Uint16Array(3*o):new Float32Array(3*o);2&n.flags&&(g=!!x||(l?new Uint16Array(2*o):new Float32Array(2*o)));var m,y,p=l?1:1/65535,v=0,U=0;for(m=0;m<o;m++)b[v]=(s[i]+(s[i+1]<<8))*p,b[v+1]=(s[i+2]+(s[i+3]<<8))*p,b[v+2]=(s[i+4]+(s[i+5]<<8))*p,v+=3,g?(x||(g[U]=(s[i+6]+(s[i+7]<<8))*p,g[U+1]=(65535-(s[i+8]+(s[i+9]<<8)))*p,U+=2),i+=10):i+=6;if(f=b,u=g,1&n.flags){var h=a.getUint16(i,!0);for(i+=2,d=l?new Uint16Array(2*h):new Float32Array(2*h),m=0,y=2*h;m<y;m+=2)d[m]=(s[i]+(s[i+1]<<8))*p,d[m+1]=(65535-(s[i+2]+(s[i+3]<<8)))*p,i+=4;c=d}var w=a.getUint16(i,!0);i+=2;var A=null;d=null,g=null;var V=r.config.mapIndexBuffers&&r.config.mapOnlyOneUVs&&!(1&n.flags),z=r.config.mapIndexBuffers&&r.config.mapOnlyOneUVs&&1&n.flags,M=V||z;M?A=new Uint16Array(3*w):(b=l?new Uint16Array(3*w*3):new Float32Array(3*w*3),1&n.flags&&(d=l?new Uint16Array(3*w*2):new Float32Array(3*w*2)),!x&&2&n.flags&&(g=l?new Uint16Array(3*w*2):new Float32Array(3*w*2)));var F,S,O,L,k,j,P,C=f,R=u,_=c;V&&(b=f,g=u);z&&(b=l?new Uint16Array(_.length/2*3):new Float32Array(_.length/2*3),d=c);for(m=0;m<w;m++)F=s[i]+(s[i+1]<<8),S=s[i+2]+(s[i+3]<<8),O=s[i+4]+(s[i+5]<<8),M?(v=3*m,null!=d?(L=s[i+6]+(s[i+7]<<8),k=s[i+8]+(s[i+9]<<8),j=s[i+10]+(s[i+11]<<8),b[3*L]=C[3*F],b[3*L+1]=C[3*F+1],b[3*L+2]=C[3*F+2],b[3*k]=C[3*S],b[3*k+1]=C[3*S+1],b[3*k+2]=C[3*S+2],b[3*j]=C[3*O],b[3*j+1]=C[3*O+1],b[3*j+2]=C[3*O+2],A[v]=L,A[v+1]=k,A[v+2]=j,i+=12):(A[v]=F,A[v+1]=S,A[v+2]=O,i+=6)):(P=3*F,b[v=9*m]=C[P],b[v+1]=C[P+1],b[v+2]=C[P+2],P=3*S,b[v+3]=C[P],b[v+4]=C[P+1],b[v+5]=C[P+2],P=3*O,b[v+6]=C[P],b[v+7]=C[P+1],b[v+8]=C[P+2],null!=g&&(g[v=6*m]=R[2*F],g[v+1]=R[2*F+1],g[v+2]=R[2*S],g[v+3]=R[2*S+1],g[v+4]=R[2*O],g[v+5]=R[2*O+1]),null!=d?(F=s[i+6]+(s[i+7]<<8),S=s[i+8]+(s[i+9]<<8),O=s[i+10]+(s[i+11]<<8),i+=12,d[v=6*m]=_[2*F],d[v+1]=_[2*F+1],d[v+2]=_[2*S],d[v+3]=_[2*S+1],d[v+4]=_[2*O],d[v+5]=_[2*O+1]):i+=6);n.vertices=b,n.internalUVs=d,n.externalUVs=g,n.indices=A,f=null,c=null,u=null,t.index=i,n.size=n.vertices.byteLength,n.internalUVs&&(n.size+=n.internalUVs.byteLength);n.externalUVs&&(n.size+=n.externalUVs.byteLength);n.indices&&(n.size+=n.indices.byteLength);n.faces=w}(0,t,n),t}function s(e,n){var t=e[n[1]];128&t?(n[0]=127&t|e[n[1]+1]<<7,n[1]+=2):(n[0]=t,n[1]++)}function l(e,n){var t=e[n[1]];128&t?1&(t=127&t|e[n[1]+1]<<7)?(n[0]=-(1+(t>>1)),n[1]+=2):(n[0]=t>>1,n[1]+=2):1&t?(n[0]=-(1+(t>>1)),n[1]++):(n[0]=t>>1,n[1]++)}var o=a,f=function(e){var n,t,a={},s=e.data,l=\\\"\\\";if(s.length<2)return!1;if(l+=String.fromCharCode(s.getUint8(e.index,!0)),e.index+=1,l+=String.fromCharCode(s.getUint8(e.index,!0)),e.index+=1,\\\"ME\\\"!=l)return!1;if(a.version=s.getUint16(e.index,!0),e.index+=2,a.version>3)return!1;for(e.uint8Data=new Uint8Array(e.data.buffer),a.meanUndulation=s.getFloat64(e.index,!0),e.index+=8,a.numSubmeshes=s.getUint16(e.index,!0),e.index+=2,a.submeshes=[],a.gpuSize=0,a.faces=0,a.size=0,r.config.map16bitMeshes,n=0,t=a.numSubmeshes;n<t;n++){var o;(o=i(a,e)).valid&&(a.submeshes.push(o),a.size+=o.size,a.faces+=o.faces,a.gpuSize+=o.size)}a.numSubmeshes=a.submeshes.length;var f=[],u=[];for(n=0,t=a.numSubmeshes;n<t;n++)o=a.submeshes[n],f.push({bboxMax:o.bboxMax,bboxMin:o.bboxMin,externalUVs:o.externalUVs?o.externalUVs.buffer:null,faces:o.faces,flags:o.flags,gpuSize:o.gpuSize,indices:o.indices?o.indices.buffer:null,internalUVs:o.internalUVs?o.internalUVs.buffer:null,size:o.size,surfaceReference:o.surfaceReference,textureLayer:o.textureLayer,textureLayer2:o.textureLayer2,vertices:o.vertices.buffer}),o.externalUVs&&u.push(o.externalUVs.buffer),o.internalUVs&&u.push(o.internalUVs.buffer),o.vertices&&u.push(o.vertices.buffer),o.indices&&u.push(o.indices.buffer);return{mesh:{faces:a.faces,gpuSize:a.gpuSize,meanUndulation:a.meanUndulation,numSubmeshes:a.numSubmeshes,size:a.size,submeshes:a.submeshes,version:a.version},transferables:u}},u=[],c=[];function d(e,n){o.config.mapPackLoaderEvents?(u.push(e),n&&(c=c.concat(n))):n?postMessage(e,n):postMessage(e)}self.onmessage=function(e){var n=e.data;switch(n.command){case\\\"config\\\":o.config=n.data;break;case\\\"tick\\\":u.length>0&&(c.length>0?postMessage({command:\\\"packed-events\\\",messages:u},c):postMessage({command:\\\"packed-events\\\",messages:u})),u=[],c=[];break;case\\\"load-binary\\\":!function(e,n,t,a,r,i,s){var l=new XMLHttpRequest;l.onreadystatechange=function(){switch(l.readyState){case 0:case 1:case 2:case 3:break;case 4:if(l.status>=400||0==l.status){t&&d({command:\\\"on-error\\\",path:e,status:l.status});break}var a=l.response;if(!a){t&&d({command:\\\"on-error\\\",path:e});break}if(n)if(\\\"direct-texture\\\"==s)createImageBitmap(a).then(function(n){d({command:\\\"on-loaded\\\",path:e,data:n,filesize:a.size},[n])}.bind(this));else if(\\\"direct-mesh\\\"==s){var r=f({data:new DataView(a),index:0});d({command:\\\"on-loaded\\\",path:e,data:r.mesh},r.transferables)}else d({command:\\\"on-loaded\\\",path:e,data:a},[a]);break;default:t&&d({command:\\\"on-error\\\",path:e})}}.bind(this),l.open(\\\"GET\\\",e,!0),l.responseType=i||\\\"arraybuffer\\\",l.withCredentials=a,r&&r.token&&l.setRequestHeader(\\\"Accept\\\",\\\"token/\\\"+r.token+\\\", */*\\\"),l.send(\\\"\\\")}(n.path,!0,!0,n.withCredentials,n.xhrParams,n.responseType,n.kind)}}}]);\\n//# sourceMappingURL=e31ae36eedf805edb5df.worker.js.map\", null);\n};","\nvar UIEvent = function(type, element, event) {\n    this.type = type;\n    this.event = event;\n    this.element = element;\n};\n\n\nUIEvent.prototype.getMouseButton = function() {\n    switch (this.type) {\n    case 'touchstart':\n    case 'touchend':\n    case 'touchmove':\n\n        var touches = this.event['touches'];\n            \n        if (touches) {\n            switch(touches.length) {\n            case 1: return 'left';\n            case 2: return 'right';\n            case 3: return 'middle';\n            }\n        }\n\n        return '';   \n\n    default:\n    \n        if (this.event.which) { // Gecko (Firefox), WebKit (Safari/Chrome) & Opera\n                //right = e.which == 3;\n        \n            switch(this.event.which) {\n            case 1: return 'left';\n            case 2: return 'middle';\n            case 3: return 'right';\n            }\n        \n        } else if (this.event.button) { // IE, Opera\n                //right = e.button == 2;\n        \n            switch(this.event.button) {\n            case 1: return 'left';\n            case 2: return 'right';\n            case 3: return 'middle';\n            }\n        }\n    \n    }\n\n    return '';\n};\n\n\nUIEvent.prototype.getMouseCoords = function(absolute) {\n    var pos = [0,0];\n\n    switch (this.type) {\n    case 'touchstart':\n    case 'touchend':\n    case 'touchmove':\n\n        var touches = this.event['touches'];\n        if (!touches || touches.length == 0) {\n            break;\n        }\n            \n        for (var i = 0, li = touches.length; i < li; i++) {\n            var pos2 = this.getEventCoords(this.event['touches'][i], absolute);\n            pos[0] += pos2[0];   \n            pos[1] += pos2[1];   \n        }\n            \n        pos[0] /= li;\n        pos[1] /= li;\n        break;\n\n    case 'mousedown':\n    case 'mouseup':\n    case 'mousemove':\n    case 'mouseenter':\n    case 'mouseover':\n    case 'mouseleave':\n    case 'click':\n    case 'dblclick':\n    case 'dragstart':\n    case 'dragend':\n    case 'drag':\n\n        pos = this.getEventCoords(this.event, absolute);\n        break;\n    }\n\n    return pos;\n};\n\n\nUIEvent.prototype.getEventCoords = function(event, absolute) {\n//    if (this.element.getBoundingClientRect == null || absolute) {\n    if (this.element.getPageRect == null || absolute) {\n        return [ event['clientX'],\n                 event['clientY'] ];\n    } else {\n        var rect = this.element.getPageRect();\n\n        return [ event['pageX'] - rect.left,\n                 event['pageY'] - rect.top ];\n    }\n};\n\n\nUIEvent.prototype.getDragDelta = function() {\n    switch (this.type) {\n    case 'drag':\n\n        return [ this.event['deltaX'],\n                 this.event['deltaY'] ];\n    }\n\n    return [0,0];\n};\n\n\nUIEvent.prototype.getDragZoom = function() {\n    switch (this.type) {\n    case 'drag':\n        return this.event['zoom'];\n    }\n    \n    return 1.0;\n};\n\n\nUIEvent.prototype.getDragTouches = function() {\n    switch (this.type) {\n    case 'drag':\n        return this.event['touches'];\n    }\n    \n    return 0;\n};\n\n\nUIEvent.prototype.getModifierKey = function(key) {\n    switch (this.type) {\n    case 'mouseup':\n    case 'mousedown':\n    case 'dblclick':\n    case 'keyup':\n    case 'keydown':\n    case 'keypress':\n\n        switch(key) {\n        case 'alt':   return this.event.altKey;\n        case 'ctrl':  return this.event.ctrlKey;\n        case 'shift': return this.event.shiftKey;\n        }\n    }\n\n    return false;\n};\n\n\nUIEvent.prototype.getKeyCode = function() {\n    switch (this.type) {\n    case 'keyup':\n    case 'keydown':\n    case 'keypress':\n        \n        if (this.event.keyCode) {         // eg. IE\n            return this.event.keyCode;\n        } else if (this.event.which) {   // eg. Firefox\n            return this.event.which;\n        } else {\n            return this.event.charCode;\n        }\n    }\n    \n    return null;\n};\n\n\nUIEvent.prototype.getDragButton = function(button) {\n    switch(button) {\n    case 'left': \n    case 'right':\n    case 'middle':\n            \n        switch(this.getTouchesCount()) {\n        case -1: return this.event[button];\n        case 0: return false;\n        case 1: return button == 'left';\n        case 2: return button == 'right';\n        case 3: return button == 'middle';\n        }\n        \n    }\n\n    return false;\n};\n\n\nUIEvent.prototype.getWheelDelta = function() {\n    switch (this.type) {\n    case 'mousewheel':\n\n        var delta = 0;\n\n        if (this.event.wheelDelta) {\n            delta = this.event.wheelDelta / 120;\n        }\n        if (this.event.detail) {\n            delta = -this.event.detail / 3;\n        }\n\n        return delta;\n    }\n\n    return 0;\n};\n\n\nUIEvent.prototype.getTouchesCount = function() {\n    switch (this.type) {\n    case 'touchstart':\n    case 'touchend':\n    case 'touchmove':\n\n        var touches = this.event['touches'];\n        if (!touches) {\n            break;\n        }\n            \n        return this.event['touches'].length;    \n    }\n    \n    return -1;\n};\n\n\nUIEvent.prototype.getTouchParameter = function(name) {\n    switch (this.type) {\n    case 'drag':\n        return this.event[name];\n    }\n    \n    return null;\n};\n\n\nUIEvent.prototype.getTouchCoords = function(index, absolute) {\n    switch (this.type) {\n    case 'touchstart':\n    case 'touchend':\n    case 'touchmove':\n\n        var touches = this.event['touches'];\n        if (!touches) {\n            break;\n        }\n            \n        var event = this.event['touches'][index];    \n        if (!event) {\n            break;\n        }\n\n        if (this.element.getPageRect == null || absolute) {\n            return [ event['clientX'],\n                     event['clientY'] ];\n        } else {\n            var rect = this.element.getPageRect();\n\n            return [ event['pageX'] - rect.left,\n                     event['pageY'] - rect.top ];\n        }\n    }\n\n    return [0,0];\n};\n\n\nUIEvent.prototype.getType = function() {\n    return this.type;\n};\n\n\nexport default UIEvent;\n\n\n","\nimport UIEvent_ from '../ui/element/event';\n\n//get rid of compiler mess\nvar UIEvent = UIEvent_;\n\n\n//Dom.dragging = false;\nvar Dom = {};\n\nDom.hasClass = function(element, name) {\n    if (element.classList !== undefined) {\n        return element.classList.contains(name);\n    }\n    var className = Dom.getClass(element);\n    return className.length > 0 && new RegExp('(^|\\\\s)' + name + '(\\\\s|$)').test(className);\n};\n\n\nDom.addClass = function(element, name) {\n    if (element.classList !== undefined) {\n        var classes = Dom.splitWords(name);\n        for (var i = 0, li = classes.length; i < li; i++) {\n            element.classList.add(classes[i]);\n        }\n    } else if (!Dom.hasClass(element, name)) {\n        var className = Dom.getClass(element);\n        Dom.setClass(element, (className ? className + ' ' : '') + name);\n    }\n};\n\n\nDom.removeClass = function(element, name) {\n    if (element.classList !== undefined) {\n        element.classList.remove(name);\n    } else {\n        Dom.setClass(element, ((' ' + Dom.getClass(element) + ' ').replace(' ' + name + ' ', ' ')).trim() );\n    }\n};\n\n\nDom.setClass = function(element, name) {\n    if (element.className.baseVal === undefined) {\n        element.className = name;\n    } else {\n        element.className.baseVal = name;\n    }\n};\n\n\nDom.getClass = function(element) {\n    return element.className.baseVal === undefined ? element.className : element.className.baseVal;\n};\n\n\nDom.preventDefault = function(e) {\n    e = e instanceof UIEvent ? e.event : e;\n    if (e.preventDefault) {\n        e.preventDefault();\n    } else {\n        e.returnValue = false;\n    }\n};\n\n\nDom.stopPropagation = function(e) {\n    e = e instanceof UIEvent ? e.event : e;\n    e.stopPropagation();\n};\n\n\nDom.disableTextSelection = function() {\n    window.addEventListener('selectstart', Dom.preventDefault);\n};\n\n\nDom.enableTextSelection = function() {\n    window.removeEventListener('selectstart', Dom.preventDefault);\n};\n\n\nDom.disableImageDrag = function() {\n    window.addEventListener('dragstart', Dom.preventDefault);\n};\n\n\nDom.enableImageDrag = function() {\n    window.removeEventListener('dragstart', Dom.preventDefault);\n};\n\n\nDom.disableContexMenu = function(element) {\n    element.addEventListener('contextmenu', Dom.preventDefault);\n};\n\n\nDom.enableContexMenu = function(element) {\n    element.removeEventListener('contextmenu', Dom.preventDefault);\n};\n\n\nDom.getSupportedProperty = function(properties) {\n    var style = document.documentElement.style;\n\n    for (var i = 0, li = properties.length; i < li; i++) {\n        if (properties[i] in style) {\n            return properties[i];\n        }\n    }\n\n    return false;\n};\n\n\nDom.stampCounter = 0;\n\n\nDom.stamp = function(obj) {\n    obj.vtsStamp = obj.vtsStamp || ++Dom.stampCounter;\n    return obj.vtsStamp;\n};\n\n\nDom.TRANSFORM = Dom.getSupportedProperty(\n            ['transform', 'WebkitTransform', 'OTransform', 'MozTransform', 'msTransform']);\n\n\nexport default Dom;\n","\nimport UIEvent_ from './event';\nimport Dom_ from '../../utility/dom';\n\n//get rid of compiler mess\nvar UIEvent = UIEvent_;\nvar dom = Dom_;\n\n\nvar UIElement = function(control, element) {\n    this.control = control;\n    this.ui = this.control.ui;\n    this.element = element;\n    this.events = [];\n    this.dragBeginCall = this.onDragBegin.bind(this, false);\n    this.dragBeginCallTouch = this.onDragBegin.bind(this, true);\n    this.dragMoveCall = this.onDragMove.bind(this, false);\n    this.dragMoveCallTouch = this.onDragMove.bind(this, true);\n    this.dragEndCall = this.onDragEnd.bind(this, false);\n    this.dragEndCallTouch = this.onDragEnd.bind(this, true);\n    this.firstDragDistance = 0;\n    this.lastDragDistance = 0;\n    this.dragStartPos = [0,0];\n    this.dragCurrentPos = [0,0];\n    this.dragLastPos = [0,0];\n    this.dragAbsMoved = [0,0];\n    this.zoomDrag = false;\n};\n\n\nUIElement.prototype.setStyle = function(key, value) {\n    this.element.style[key] = value;\n};\n\n\nUIElement.prototype.getStyle = function(key) {\n    return this.element.style[key];\n};\n\n\nUIElement.prototype.setClass = function(name) {\n    dom.setClass(this.element, name);\n    return this;\n};\n\n\nUIElement.prototype.getClass = function() {\n    dom.getClass(this.element);\n    return this;\n};\n\n\nUIElement.prototype.hasClass = function(name) {\n    return dom.hasClass(this.element, name);\n};\n\n\nUIElement.prototype.addClass = function(name) {\n    dom.addClass(this.element, name);\n    return this;\n};\n\n\nUIElement.prototype.removeClass = function(name) {\n    dom.removeClass(this.element, name);\n    return this;\n};\n\n\nUIElement.prototype.getRect = function() {\n    var rect = this.element.getBoundingClientRect();\n    var rect2 = this.ui.map.getMapElement().element.getBoundingClientRect();\n    var offsetX = window.pageXOffset || 0;\n    var offsetY = window.pageYOffset || 0;\n    return {\n        'left' : (rect.left + offsetX) - (rect2.left + offsetX), \n        'top' : (rect.top + offsetY) - (rect2.top + offsetY), \n        'fromRight' : rect2.right - ((rect.left + offsetX) - (rect2.left + offsetX)), \n        'fromBottom' : rect2.height - ((rect.top + offsetY) - (rect2.top + offsetY)),\n        'width' : rect.width, \n        'height' : rect.height \n    };\n};\n\n\nUIElement.prototype.getPageRect = function() {\n    var rect = this.element.getBoundingClientRect();\n    var offsetX = window.pageXOffset || 0;\n    var offsetY = window.pageYOffset || 0;\n    return {\n        'left' : (rect.left + offsetX), \n        'top' : (rect.top + offsetY), \n        'width' : rect.width, \n        'height' : rect.height \n    };\n};\n\n\nUIElement.prototype.setHtml = function(html) {\n    this.element.innerHTML = html;\n    \n    var allElements = this.element.getElementsByTagName('*');\n\n    //store all elements with id attribute to the table\n    for (var i = 0, li = allElements.length; i < li; i++) {\n        var id = allElements[i].getAttribute('id');\n\n        if (id !== null) {\n            //store element to the table\n            this.control.elementsById[id] = new UIElement(this, allElements[i]);\n        }\n    }    \n};\n\n\nUIElement.prototype.getHtml = function() {\n    return this.element.innerHTML;\n};\n\n\nUIElement.prototype.getElement = function() {\n    return this.element;\n};\n\n\nUIElement.prototype.on = function(type, call, externalElement) {\n    this.addEvent(type, call, externalElement);\n};\n\n\nUIElement.prototype.once = function(type, call, externalElement) {\n    var removeEventCall = (function() {\n        this.removeEvent(type, call, externalElement);\n    }).bind(this);\n\n    var handler = function(e) {\n        call(e);\n        removeEventCall();\n    };\n\n    this.addEvent(type, handler, externalElement);\n};\n\n\nUIElement.prototype.off = function(type, call, externalElement) {\n    this.removeEvent(type, call, externalElement);\n};\n\n\nUIElement.prototype.fire = function(type, event) {\n    var hooks = this.events[type];\n\n    if (hooks != null) {\n        for (var hook in hooks) {\n            hooks[hook](event);\n        }\n    }\n};\n\n\nUIElement.prototype.addEvent = function(type, call, externalElement) {\n    var id = type + '-' + dom.stamp(call)\n              + (externalElement ? ('-' + dom.stamp(externalElement)) : '');\n\n    var handler = (function(e) {\n        if (this.ui.killed) {\n            return; //todo remove event\n        }\n\n        if (typeof e.preventDefault === \"function\" && type == \"click\") {\n            e.preventDefault();\n        }\n\n        call(new UIEvent(type, this, e || window.event));\n    }).bind(this);\n\n    var element =  externalElement || this.element;\n    element.addEventListener(this.getEventName(type), handler, false);\n\n    if (type == 'mousewheel') {\n        element.addEventListener('DOMMouseScroll', handler, false);\n    }\n\n    this.events[type] = this.events[type] || [];\n    this.events[type][id] = handler;\n};\n\n\nUIElement.prototype.removeEvent = function(type, call, externalElement) {\n    var id = type + '-' + dom.stamp(call)\n              + (externalElement ? ('-' + dom.stamp(externalElement)) : '');\n\n    var handler = this.events[type] && this.events[type][id];\n\n    if (handler != null) {\n        delete this.events[type][id];\n\n        var element =  externalElement || this.element;\n        element.removeEventListener(this.getEventName(type), handler, false);\n    }\n};\n\n\nUIElement.prototype.getEventName = function(type) {\n    return type;\n};\n\n\nUIElement.prototype.setDraggableState = function(state) {\n    if (state) {\n        this.on('mousedown', this.dragBeginCall);\n        this.on('touchstart', this.dragBeginCallTouch);\n    } else if (this.dragable){\n        this.off('mousedown', this.dragBeginCall);\n        this.off('mousemove', this.dragMoveCall, document);\n        //this.off(\"mouseup\", this.onDragEnd.bind(this));\n        this.off('mouseup', this.dragEndCall, document);\n        \n        this.off('touchstart', this.dragBeginCallTouch);\n        this.off('touchmove', this.dragMoveCallTouch, document);\n        this.off('touchend', this.dragEndCallTouch, document);\n        \n        this.dragging = false;\n    }\n    \n    this.dragStartPos = [0,0];\n    this.dragCurrentPos = [0,0];\n    this.dragLastPos = [0,0];\n    this.dragAbsMoved = [0,0];\n    this.dragTouchCount = 0;\n    this.dragTouches = [];\n    this.dragTouches2 = [];\n    this.resetPos = false;\n    \n    this.dragable = state;\n    this.dragButtons = {\n        'left' : false,\n        'right' : false,\n        'middle' : false\n    };\n};\n\n\nUIElement.prototype.getDraggableState = function() {\n    return this.dragable;\n};\n\n\nUIElement.prototype.getDraggingState = function() {\n    return {\n        'dragging' : this.dragging,\n        'buttonLeft' : this.dragButtons['left'],\n        'buttonRight' : this.dragButtons['right'],\n        'buttonMiddle' : this.dragButtons['middle'],\n        'startPos' : this.dragStartPos.slice(), \n        'lastPos' : this.dragLastPos.slice(), \n        'currentPos' : this.dragCurrentPos.slice(), \n        'absMoved' : this.dragAbsMoved.slice() \n    };\n};\n\n\nUIElement.prototype.onDragBegin = function(touchUsed, event) {\n    //console.log(\"bergin: 1#:  \" + JSON.stringify(this.dragButtons));\n\n    this.dragButtons[event.getMouseButton()] = true;\n\n    //console.log(\"bergin: 2#:  \" + JSON.stringify(this.dragButtons));\n\n    //if (event.getTouchesCount() == 2) {\n    this.dragTouches = [];\n    this.dragTouches2 = [];\n    this.dragTouches.push(event.getTouchCoords(0));            \n    this.dragTouches2.push(event.getTouchCoords(1));            \n    //}\n\n    if (touchUsed) {\n        this.resetPos = true;\n        this.firstDragDistance = 0;\n        this.lastDragDistance = 0;\n        this.zoomDrag = false;\n    }\n\n    if (!this.dragging) {\n        this.dragging = true;\n        var pos = event.getMouseCoords();//true);\n        this.dragStartPos = [pos[0], pos[1]];\n        this.dragCurrentPos = [pos[0], pos[1]];\n        this.dragLastPos = [pos[0], pos[1]];\n        this.dragAbsMoved = [0,0];\n\n        this.on('mousemove', this.dragMoveCall, document);\n        this.on('mouseup', this.dragEndCall, document);\n        //this.on(\"mouseup\", this.onDragEnd.bind(this), document);\n\n        this.on('touchmove', this.dragMoveCallTouch, document);\n        this.on('touchend', this.dragEndCallTouch, document);\n\n        dom.disableTextSelection();\n        dom.disableImageDrag();\n        //dom.disableContexMenu();\n        dom.preventDefault(event);\n\n        this.dragLastPos[0] = pos[0];\n        this.dragLastPos[1] = pos[1];\n\n        this.fire('dragstart', {\n            'clientX' : pos[0],\n            'clientY' : pos[1],\n            'pageX' : pos[0],\n            'pageY' : pos[1]\n        });\n    } else {\n        this.dragLastPos = event.getMouseCoords();\n    }\n};\n\n\nUIElement.prototype.onDragMove = function(touchUsed, event) {\n    var pos = event.getMouseCoords();\n\n    if (event.getTouchesCount() != -1) {\n        this.updateDragButtonsState(event, true);\n    }\n\n    dom.preventDefault(event);\n\n    var mode = '';\n    var zoom = 0;\n    var rotateDelta = 0;\n    var panDelta = [0,0];\n    var distanceDelta = 0;\n\n    //var el = document.getElementById(\"debug123\");\n\n    if (touchUsed) {\n\n        var touchCount = event.getTouchesCount();\n        if (touchCount != this.dragTouchCount) {\n            this.dragLastPos[0] = pos[0];\n            this.dragLastPos[1] = pos[1];\n            this.dragTouchCount = touchCount; \n        }\n\n        if (this.resetPos) {\n            this.dragCurrentPos = [pos[0], pos[1]];\n            this.dragLastPos[0] = pos[0];\n            this.dragLastPos[1] = pos[1];\n            this.resetPos = false;\n        }\n\n        if (touchCount == 2) {\n            this.dragTouches.push(event.getTouchCoords(0));            \n            this.dragTouches2.push(event.getTouchCoords(1));            \n\n            if (this.dragTouches.length >= 7) {\n                this.dragTouches.shift();\n                this.dragTouches2.shift();\n            }\n\n            if (this.dragTouches.length == 6) {\n\n                //get vector for touch #1\n                var t = this.dragTouches;\n                var v1x = (t[5][0] - t[4][0]) + (t[4][0] - t[3][0]) + (t[3][0] - t[2][0]) + (t[2][0] - t[1][0]) + (t[1][0] - t[0][0]);\n                var v1y = (t[5][1] - t[4][1]) + (t[4][1] - t[3][1]) + (t[3][1] - t[2][1]) + (t[2][1] - t[1][1]) + (t[1][1] - t[0][1]);\n\n                //get vector for touch #2\n                var t2 = this.dragTouches2;\n                var v2x = (t2[5][0] - t2[4][0]) + (t2[4][0] - t2[3][0]) + (t2[3][0] - t2[2][0]) + (t2[2][0] - t2[1][0]) + (t2[1][0] - t2[0][0]);\n                var v2y = (t2[5][1] - t2[4][1]) + (t2[4][1] - t2[3][1]) + (t2[3][1] - t2[2][1]) + (t2[2][1] - t2[1][1]) + (t2[1][1] - t2[0][1]);\n                \n                //get distance of each vector\n                var d1 = Math.sqrt(v1x * v1x + v1y * v1y);\n                var d2 = Math.sqrt(v2x * v2x + v2y * v2y);\n                var cosAngle, cosAngle2; \n\n                mode = 'pan';\n\n                if (d1 > d2 * 5 || d2 > d1 * 5) { //dectec situation where only one finger is closing to another\n\n                    var p1, p2, p3;\n                    \n                    //make first vector from non moving point to beginnig position of moving point\n                    //make seconf vector from non moving point to ending position of moving point\n                    if (d1 > d2 * 5) {\n                        p1 = t2[0];\n                        p2 = t[0];\n                        p3 = t[5];\n                    } else {\n                        p1 = t[0];\n                        p2 = t2[0];\n                        p3 = t2[5];\n                    }\n                    \n                    var v1 = [p2[0] - p1[0], p2[1] - p1[1]];\n                    var v2 = [p3[0] - p1[0], p3[1] - p1[1]];\n\n                    //normalize vectors                \n                    var d =  Math.sqrt(v1[0] * v1[0] + v1[1] * v1[1]);\n                    v1[0] /= d;\n                    v1[1] /= d;\n                    \n                    d =  Math.sqrt(v2[0] * v2[0] + v2[1] * v2[1]);\n                    v2[0] /= d;\n                    v2[1] /= d;\n\n                    //measure angle between vectors\n                    cosAngle = v1[0] * v2[0] + v1[1] * v2[1];\n                    cosAngle2 = -v1[1] * v2[0] + v1[0] * v2[1]; //v1 is rotated by 90deg\n                    \n                    rotateDelta = (Math.acos(cosAngle2) * (180.0/Math.PI)) - 90;\n\n                    if (cosAngle > 0.9999) { //are vectors in same line?\n                        mode = 'zoom';\n                    } else {\n                        panDelta = [(v1x + v2x) *0.5, (v1y + v2y) *0.5];\n                    }\n\n                } else if (d1 > 1 && d2 > 1) { //are bouth vectors in motion\n\n                    //normalize vectors\n                    var nv1x = v1x / d1;\n                    var nv1y = v1y / d1;\n\n                    var nv2x = v2x / d2;\n                    var nv2y = v2y / d2;\n                    \n                    //do vectors move in same direction\n                    cosAngle = nv1x * nv2x + nv1y * nv2y;\n                    \n                    if (cosAngle < 0.2) {\n                        mode = 'zoom';\n                    } else {\n                        panDelta = [(v1x + v2x) *0.5, (v1y + v2y) *0.5];\n                    } \n                }\n                \n                //if (mode == \"zoom\") {\n                t = this.dragTouches;\n                t2 = this.dragTouches2;\n\n                //get distance between points at the beginig\n                var dx = (t2[0][0] - t[0][0]);\n                var dy = (t2[0][1] - t[0][1]);\n                d1 = Math.sqrt(dx * dx + dy * dy);\n\n                /*\n                //get distance between points at the end\n                dx = (t2[5][0] - t[5][0]);\n                dy = (t2[5][1] - t[5][1]);\n                d2 = Math.sqrt(dx * dx + dy * dy);\n                \n                //get delta betwwen distances\n                distanceDelta = d2 - d1;   \n                */\n\n                distanceDelta = 0;   \n\n                for (var i = 1; i < 6; i++) {\n\n                    //get distance between points at the end\n                    dx = (t2[i][0] - t[i][0]);\n                    dy = (t2[i][1] - t[i][1]);\n                    d2 = Math.sqrt(dx * dx + dy * dy);\n                    \n                    //get delta between distances\n                    distanceDelta += d2 - d1;\n                    d1 = d2;\n                }\n\n                //}  \n            }\n        }\n    }\n\n    this.fire('drag', {\n        'clientX' : pos[0],\n        'clientY' : pos[1],\n        'pageX' : pos[0],\n        'pageY' : pos[1],\n        'deltaX' : pos[0] - this.dragLastPos[0],\n        'deltaY' : pos[1] - this.dragLastPos[1],\n        'left' : this.dragButtons['left'],\n        'right' : this.dragButtons['right'],\n        'middle' : this.dragButtons['middle'],\n        'zoom' : zoom,\n        'touchMode' : mode,\n        'touchPanDelta' : panDelta,\n        'touchRotateDelta' : rotateDelta,\n        'touchDistanceDelta' : distanceDelta,\n        'touches' : (touchUsed) ? touchCount : 0\n    });\n\n    //\n    //el.innerHTML = \"rotDelta\" + rotateDelta;\n\n    this.dragLastPos = this.dragCurrentPos;\n    this.dragCurrentPos = [pos[0], pos[1]];\n    this.dragAbsMoved[0] += Math.abs(pos[0] - this.dragLastPos[0]);\n    this.dragAbsMoved[1] += Math.abs(pos[1] - this.dragLastPos[1]);\n};\n\n//var debugCoutner = 0;\n\nUIElement.prototype.onDragEnd = function(touchUsed, event) {\n    //this.dragButtons[event.getMouseButton()] = false;\n    //console.log(\"end: 1#:  \" + JSON.stringify(this.dragButtons));\n\n    var left = this.dragButtons['left'];\n    var right = this.dragButtons['right'];\n    var middle = this.dragButtons['middle'];\n\n    this.updateDragButtonsState(event, false);\n\n    //if (event.getTouchesCount() == 2) {\n    this.dragTouches = [];\n    this.dragTouches2 = [];\n    this.dragTouches.push(event.getTouchCoords(0));            \n    this.dragTouches2.push(event.getTouchCoords(1));            \n    //}\n\n    //console.log(\"end: 2#:  \" + JSON.stringify(this.dragButtons));\n\n    if (touchUsed) {\n        this.resetPos = true;\n        this.firstDragDistance = 0;\n        this.lastDragDistance = 0;\n        this.zoomDrag = false;\n    }\n\n    if (this.dragging) {\n        var pos = event.getMouseCoords();\n        this.dragLastPos = pos;\n\n        if (!this.dragButtons['left'] &&\n            !this.dragButtons['right'] &&\n            !this.dragButtons['middle'] ) {\n\n            this.dragging = false;\n            pos = this.dragCurrentPos;//event.getMouseCoords();\n            this.off('mousemove', this.dragMoveCall, document);\n            this.off('mouseup', this.dragEndCall, document);\n            //this.off(\"mouseup\", this.onDragEnd.bind(this), document);\n\n            this.off('touchmove', this.dragMoveCallTouch, document);\n            this.off('touchend', this.dragEndCallTouch, document);\n\n            dom.enableTextSelection();\n            dom.enableImageDrag();\n            //dom.enableContexMenu();\n            dom.preventDefault(event);\n\n            this.fire('dragend', {\n                'clientX' : pos[0],\n                'clientY' : pos[1],\n                'pageX' : pos[0],\n                'pageY' : pos[1],\n                'left' : left,\n                'right' : right,\n                'middle' : middle\n            });\n        }\n    }\n};\n\n\nUIElement.prototype.updateDragButtonsState = function(event, state) {\n    switch(event.getTouchesCount()) {\n    case -1: this.dragButtons[event.getMouseButton()] = state; break;\n    case 0: this.dragButtons = { 'left' : false, 'right' : false, 'middle' : false }; break;\n    case 1: this.dragButtons = { 'left' : true, 'right' : false, 'middle' : false }; break;\n    case 2: this.dragButtons = { 'left' : false, 'right' : true, 'middle' : false }; break;\n    case 3: this.dragButtons = { 'left' : false, 'right' : false, 'middle' : true }; break;\n    }        \n};\n\n\n\nexport default UIElement;\n\n","\nimport UIElement_ from '../element/element';\n\n//get rid of compiler mess\nvar UIElement = UIElement_;\n\n\nvar UIControlHolder = function(ui, html, visible, visibleLock, parentElement) {\n    this.ui = ui;\n    this.html = html;\n    this.elementsById = [];\n    this.visible = (visible != null) ? visible : true;\n\n    //create holder element\n    this.element = document.createElement('div');\n    this.setVisible(this.visible);\n\n    this.visibleLock = visibleLock ? true : false;\n    this.setVisibleLock(this.visibleLock);\n\n    //set element content\n    this.setHtml(html);\n\n    //append elemenet to UI\n    if (parentElement) {\n        parentElement.appendChild(this.element);\n    } else {\n        this.ui.element.appendChild(this.element);\n    }\n};\n\n\nUIControlHolder.prototype.setHtml = function(html) {\n    this.element.innerHTML = html;\n\n    var allElements = this.element.getElementsByTagName('*');\n\n    //store all elements with id attribute to the table\n    for (var i = 0, li = allElements.length; i < li; i++) {\n        var id = allElements[i].getAttribute('id');\n\n        if (id !== null) {\n            //store element to the table\n            this.elementsById[id] = new UIElement(this, allElements[i]);\n        }\n    }\n};\n\n\nUIControlHolder.prototype.getElement = function(id) {\n    return this.elementsById[id];\n};\n\n\nUIControlHolder.prototype.setVisible = function(state) {\n    if (this.visibleLock) {\n        return;\n    }\n\n    this.element.style.display = state ? 'block' : 'none';\n    this.visible = state;\n};\n\n\nUIControlHolder.prototype.getVisible = function() {\n    return this.visible;\n};\n\nUIControlHolder.prototype.setVisibleLock = function(state) {\n    this.visibleLock = state;\n};\n\n\nUIControlHolder.prototype.getVisibleLock = function() {\n    return this.visibleLock;\n};\n\nexport default UIControlHolder;\n\n/*\n//prevent minification\nUIControlHolder.prototype[\"setHtml\"] = UIControlHolder.prototype.setHtml; \nUIControlHolder.prototype[\"getElement\"] = UIControlHolder.prototype.getElement; \nUIControlHolder.prototype[\"setVisible\"] = UIControlHolder.prototype.setVisible; \nUIControlHolder.prototype[\"getVisible\"] = UIControlHolder.prototype.getVisible; \n*/\n\n\n\n","\nvar UIControlMap = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.browser = ui.browser;\n    this.control = this.ui.addControl('map',\n      '<div id=\"vts-map\"'\n      + ' class=\"vts-map\">'\n      + ' </div>', visible, visibleLock);\n\n    var map = this.getMapElement();\n    map.setDraggableState(true);\n};\n\n\nUIControlMap.prototype.getMapElement = function() {\n    return this.control.getElement('vts-map');\n};\n\n\nexport default UIControlMap;\n","\nimport Dom_ from '../../utility/dom';\n\n//get rid of compiler mess\nvar dom = Dom_;\n\nvar UIControlCompass = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.browser = ui.browser;\n    this.control = this.ui.addControl('compass',\n      '<div id=\"vts-compass\">'\n\n        + '<div id=\"vts-compass-frame\">'\n            + '<img id=\"vts-compass-compass\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAABjCAYAAACPO76VAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyJpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuMy1jMDExIDY2LjE0NTY2MSwgMjAxMi8wMi8wNi0xNDo1NjoyNyAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENTNiAoV2luZG93cykiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODRDNjZFNDJCQjNCMTFFM0IyN0ZCQTZFQTAwNzEzNDUiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODRDNjZFNDNCQjNCMTFFM0IyN0ZCQTZFQTAwNzEzNDUiPiA8eG1wTU06RGVyaXZlZEZyb20gc3RSZWY6aW5zdGFuY2VJRD0ieG1wLmlpZDo4NEM2NkU0MEJCM0IxMUUzQjI3RkJBNkVBMDA3MTM0NSIgc3RSZWY6ZG9jdW1lbnRJRD0ieG1wLmRpZDo4NEM2NkU0MUJCM0IxMUUzQjI3RkJBNkVBMDA3MTM0NSIvPiA8L3JkZjpEZXNjcmlwdGlvbj4gPC9yZGY6UkRGPiA8L3g6eG1wbWV0YT4gPD94cGFja2V0IGVuZD0iciI/Pgg3VBcAAAzUSURBVHja7F1bbBTX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\">'\n        + '</div>'\n\n        + '<div id=\"vts-compass-frame2\">'\n            + '<img id=\"vts-compass-compass2\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAABjCAYAAACPO76VAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABG9JREFUeNrtnM9LFGEcxkeEPCQVmbkh7EXoEgW6noIQzQwKoQ5Lkgh7SA8iddlCQfAQFApdghAxooJCsEMe9JAEek8i81YQCIEYQvgHZM9L37Fpmpl9Z3d+rs8DDw7unuaz3+ddX+d9DIOiKIqiKIqiKIqiKIqiKIqiKIqiKMpTQ0NDyqNwTq7/MRUNAKsfwL2EER+MLHxBru/BA4QR3zR0wY/lWmmEMKKHcVh+tsEv5PoGPE4Y0cP4LD9b4AW57oC/whvwB3gZfgN3886FG1EmjAZ41WEa6uAm+DTcyLsXPAz11fWkDUYtvAVPwHfgAnwdbmVMhQtjDj4jN3gNPiTXF+E8fAsuwvfhQScIuVwuMusK762H69IGYwY+LwDew+3wcZkOQ2fhThoMvK8TnkrjZEzCV+RGF2XhXoE/wuvwJ7jGK5aSAkOm4Qm8DTemEcYYfNNtCnTWiCTAkGn4Bu/B+bSuGcPwF3gJfg1Pww/l661uLMQGwzINe+L5tH+1PSpbIOdkG0TtRWWSDsM2Dco/UhlPQSpqGA7TsJfqeEorDLjHNg3pj6cUwjgCzzpAYDxFDENNw6YLCOU+Uggfhtc0mH5LAuHDKDUNyjtwhgTCg6EzDab7effDg6EzDYynkGH4mQbGU4gw/EwD4ykkGMfgZz4hMJ5CgHEV/l4GCMZTgDDUNDwvAwLjKeD1odxp2I8nP/92JQx3P6oAwn48EUYw64N5U3+VG09+H0ggDOc1woymn/Bl2WH1A2KhnKdDCON/WxfrgvzurA8gCmAzYVQOwxpPi7bXdIEUyn1uijDc46nZ4T2lgCxW8hAbYfz1U69PtwYQN4AE4BNGT6lPtwaQQqWPdxLGn93XzVKfbgff1QVI6cOY1Ywnt+2RkgApPRh+48m+PaJA9Ab1FPpBhuEnnpw2Cxd1I40qDUM3npymoRDG+YyDCsMaT0thTANh6MGwxtMunA1jGghDD4Y1ngY1pkH9T+JUFMfIDhoMazy9g2s8pmHHug1OGMHCcIunBvilwzRkoj5geZBgOMXTNXgrjGkgDHcYl2zxdAJ+FeY0EIYziHrLQRUVT7ejmAbCcIZhPbq1G9U06MIo97RuGkF0ejy50Z9LwDlwuekZOSB6QQ6MZuUAaVXGU+TT4BNGixydnpaj1EtytHq4GuPJPEPXF/HBSkcYOmUCUjowVo3xNK8OM8YBwgNGjdRqrEvNxorUbhTldVXHMVlN8aSmIR8XBDsMjymolSKadimmMaSoZqZa4mnePNqbMBiDUr1UlCqmvFQzGVLVtCbXqsJpLu3xtG1vHYgThMMUtEopWUFKyiaktKzWVmamys1G0xxPU04H3RMAo1Fq+Zqkps8OaFVq/aww0vt3hleDWQJgdEth5bIUWG5IoWWHvL5gNgJZYVABy2PRHpfKV0MqYNts1bC8eRHCGJEyZEPKkbvYwRsfjAGpCTdkGyRLAPHB6JUCfU5DAmDkpJ+XN4miKIqiKIqiKIqiKIqiKIqiKIpKpn4DKrVAiBFUfdUAAAAASUVORK5CYII=\">'\n        + '</div>'\n\n        + '<div id=\"vts-compass-frame3\">'\n            + '<img id=\"vts-compass-compass3\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAGMAAABjCAYAAACPO76VAAAACXBIWXMAAC4jAAAuIwF4pT92AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAABG9JREFUeNrtnM9LFGEcxkeEPCQVmbkh7EXoEgW6noIQzQwKoQ5Lkgh7SA8iddlCQfAQFApdghAxooJCsEMe9JAEek8i81YQCIEYQvgHZM9L37Fpmpl9Z3d+rs8DDw7unuaz3+ddX+d9DIOiKIqiKIqiKIqiKIqiKIqiKIqiKMpTQ0NDyqNwTq7/MRUNAKsfwL2EER+MLHxBru/BA4QR3zR0wY/lWmmEMKKHcVh+tsEv5PoGPE4Y0cP4LD9b4AW57oC/whvwB3gZfgN3886FG1EmjAZ41WEa6uAm+DTcyLsXPAz11fWkDUYtvAVPwHfgAnwdbmVMhQtjDj4jN3gNPiTXF+E8fAsuwvfhQScIuVwuMusK762H69IGYwY+LwDew+3wcZkOQ2fhThoMvK8TnkrjZEzCV+RGF2XhXoE/wuvwJ7jGK5aSAkOm4Qm8DTemEcYYfNNtCnTWiCTAkGn4Bu/B+bSuGcPwF3gJfg1Pww/l661uLMQGwzINe+L5tH+1PSpbIOdkG0TtRWWSDsM2Dco/UhlPQSpqGA7TsJfqeEorDLjHNg3pj6cUwjgCzzpAYDxFDENNw6YLCOU+Uggfhtc0mH5LAuHDKDUNyjtwhgTCg6EzDab7effDg6EzDYynkGH4mQbGU4gw/EwD4ykkGMfgZz4hMJ5CgHEV/l4GCMZTgDDUNDwvAwLjKeD1odxp2I8nP/92JQx3P6oAwn48EUYw64N5U3+VG09+H0ggDOc1woymn/Bl2WH1A2KhnKdDCON/WxfrgvzurA8gCmAzYVQOwxpPi7bXdIEUyn1uijDc46nZ4T2lgCxW8hAbYfz1U69PtwYQN4AE4BNGT6lPtwaQQqWPdxLGn93XzVKfbgff1QVI6cOY1Ywnt+2RkgApPRh+48m+PaJA9Ab1FPpBhuEnnpw2Cxd1I40qDUM3npymoRDG+YyDCsMaT0thTANh6MGwxtMunA1jGghDD4Y1ngY1pkH9T+JUFMfIDhoMazy9g2s8pmHHug1OGMHCcIunBvilwzRkoj5geZBgOMXTNXgrjGkgDHcYl2zxdAJ+FeY0EIYziHrLQRUVT7ejmAbCcIZhPbq1G9U06MIo97RuGkF0ejy50Z9LwDlwuekZOSB6QQ6MZuUAaVXGU+TT4BNGixydnpaj1EtytHq4GuPJPEPXF/HBSkcYOmUCUjowVo3xNK8OM8YBwgNGjdRqrEvNxorUbhTldVXHMVlN8aSmIR8XBDsMjymolSKadimmMaSoZqZa4mnePNqbMBiDUr1UlCqmvFQzGVLVtCbXqsJpLu3xtG1vHYgThMMUtEopWUFKyiaktKzWVmamys1G0xxPU04H3RMAo1Fq+Zqkps8OaFVq/aww0vt3hleDWQJgdEth5bIUWG5IoWWHvL5gNgJZYVABy2PRHpfKV0MqYNts1bC8eRHCGJEyZEPKkbvYwRsfjAGpCTdkGyRLAPHB6JUCfU5DAmDkpJ+XN4miKIqiKIqiKIqiKIqiKIqiKIpKpn4DKrVAiBFUfdUAAAAASUVORK5CYII=\">'\n        + '</div>'\n\n      + ' </div>', visible, visibleLock);\n\n    var compass = this.control.getElement('vts-compass');\n    compass.setDraggableState(true);\n    compass.on('drag', this.onDrag.bind(this));\n    compass.on('dblclick', this.onDoubleClick.bind(this));\n\n    this.image = this.control.getElement('vts-compass-compass');\n    this.image2 = this.control.getElement('vts-compass-compass2');\n    this.image3 = this.control.getElement('vts-compass-compass3');\n    \n    this.lastStyle = '';\n};\n\n\nUIControlCompass.prototype.update = function() {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var pos = map.getPosition();\n    var orientation = pos.getOrientation();\n    var value = 'rotateX('+(Math.round(orientation[1]+90)*0.7)+'deg) ' + 'rotateZ('+Math.round(-orientation[0]-45)+'deg)';\n\n    if (value != this.lastStyle) {\n        this.lastStyle = value;\n        this.image.setStyle(dom.TRANSFORM, value);\n        this.image2.setStyle(dom.TRANSFORM, value);\n        this.image3.setStyle(dom.TRANSFORM, value);\n    }\n};\n\n\nUIControlCompass.prototype.onDrag = function(event) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    if (this.browser.autopilot) { //stop autorotation\n        this.browser.autopilot.setAutorotate(0);\n        this.browser.autopilot.setAutopan(0,0);\n    }\n\n    var delta = event.getDragDelta();\n    var sensitivity = 0.4;\n    \n    var controller = this.browser.controlMode.getCurrentController();\n    \n    if (controller.orientationDeltas) {\n        controller.orientationDeltas.push([delta[0] * sensitivity,\n            -delta[1] * sensitivity, 0]);\n    }\n};\n\n\nUIControlCompass.prototype.onDoubleClick = function(event) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    if (this.browser.autopilot) { //stop autorotation\n        this.browser.autopilot.setAutorotate(0);\n        this.browser.autopilot.setAutopan(0,0);\n    }\n\n    var pos = map.getPosition();\n    var orientation = pos.getOrientation();\n    orientation[0] = 0;\n    orientation[1] = -90;\n    pos.setOrientation(orientation);\n\n    map.setPosition(pos);\n\n    if (this.browser.config.navigationMode == 'azimuthal2')  {\n        this.browser.config.navigationMode = 'azimuthal';\n    }\n    \n    dom.stopPropagation(event);    \n};\n\n\nexport default UIControlCompass;\n","\nvar UIControlCredits = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.browser = ui.browser;\n    this.control = this.ui.addControl('credits',\n      '<div id=\"vts-credits\"'\n      + ' class=\"vts-credits\">'\n      + ' </div>', visible, visibleLock);\n\n    this.lastHTML = '';\n    this.lastHTML2 = '';\n    this.lastHTML3 = '';\n    this.credits = this.control.getElement('vts-credits');\n};\n\n\nUIControlCredits.prototype.getCreditsString = function(array, separator, full) {\n    var map = this.browser.getMap();\n    var html = '';\n    //var copyright = '&copy;' + (new Date().getFullYear());\n    \n    var li = array.length;\n    var plain = ''; \n    var more = false;\n    var creditInfo;\n\n    for (var i = 0; i < li; i++) {\n        creditInfo = map.getCreditInfo(array[i]);\n        if (creditInfo['plain']) {\n            plain += creditInfo['plain'];\n        }\n    }        \n    \n    if (plain && plain.length > 30 && li > 1 && !full) {\n        for (i = 0; i < li; i++) {\n            creditInfo = map.getCreditInfo(array[i]);\n            if (creditInfo['html'].trim() != '') {\n                li = i + 1;\n                break;\n            }\n        }\n\n        if (li < array.length) {\n            more = true; \n        } else {\n            li = array.length;\n        }\n    }\n\n    for (i = 0; i < li; i++) {\n        creditInfo = map.getCreditInfo(array[i]);\n       \n        if (creditInfo['html'] && creditInfo['html'].trim() != '') {\n            html += creditInfo['html'];\n\n            if (i + 1 < li) {\n                html += separator;        \n            }\n        }\n    }\n    \n    return [html, more];\n};\n\n\nUIControlCredits.prototype.update = function() {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var html = '', html2 = '', html3 = '', res;\n    var credits = map.getCurrentCredits();\n    \n    if (credits['imagery'].length > 0) {\n        res = this.getCreditsString(credits['imagery'], ', ');\n        if (res[0] != '') {\n            html += '<div class=\"vts-credits-supercell\">';\n            html += '<div class=\"vts-credits-cell\">Imagery: ' + res[0] + '</div>';\n            html += res[1] ? '<a href=\"#\" class=\"vts-credits-cell-button\" id=\"vts-credits-imagery-more\">and others</a>' : '';\n            html += '<div class=\"vts-credits-separator\">|</div>';\n            html += '</div>';\n            html2 = '<div class=\"vts-credits-list\">';\n            html2 += this.getCreditsString(credits['imagery'], '<br/>', true)[0] + '</div>';\n        }\n    }\n    \n    if (credits['mapdata'].length > 0) {\n        res = this.getCreditsString(credits['mapdata'], ', ');\n        if (res[0] != '') {\n            html += '<div class=\"vts-credits-supercell\">';\n            html += '<div class=\"vts-credits-cell\">Map Data: ' + res[0] + '</div>';\n            html += res[1] ? '<a href=\"#\" class=\"vts-credits-cell-button\" id=\"vts-credits-mapdata-more\">and others</a>' : '';\n            html += '<div class=\"vts-credits-separator\">|</div>';\n            html += '</div>';\n            html3 = '<div class=\"vts-credits-list\">';\n            html3 += this.getCreditsString(credits['mapdata'], '<br/>', true)[0] + '</div>';\n        }\n    }\n\n    html += '<div class=\"vts-credits-supercell\">';\n    html += '<div class=\"vts-credits-cell\">Powered by <a href=\"https://www.melown.com/products/vts/\" target=\"blank\">VTS 3D Geospatial Software Stack</a></div>';\n    html += '<div class=\"vts-credits-separator\">|</div>';\n    html += '</div>';\n\n    html += '<div class=\"vts-credits-supercell\">';\n    html += '<div class=\"vts-credits-cell\">Integrated by <a href=\"https://github.com/ExploreWilder/MainWebsite\" target=\"_blank\">Clement</a></div>';\n    html += '</div>';\n\n    if (this.lastHTML != html) {\n        this.lastHTML = html;\n        this.credits.setHtml('<div id=\"vts-credits-extended-content\">' + html + '</div><div id=\"vts-credits-extend-button\">i</div>');\n\n        this.control.getElement('vts-credits-extended-content').setStyle(\"display\", \"none\");\n\n        var butt = this.control.getElement('vts-credits-extend-button');\n        if (butt) {\n            butt.on('click', this.onExtendButton.bind(this));\n        }\n\n        butt = this.control.getElement('vts-credits-imagery-more');\n        if (butt) {\n            butt.on('click', this.onMoreButton.bind(this, butt, '2'));\n        }\n        \n        butt = this.control.getElement('vts-credits-mapdata-more');\n        if (butt) {\n            butt.on('click', this.onMoreButton.bind(this, butt, '3'));\n        }\n    }\n\n    this.lastHTML2 = html2;\n    this.lastHTML3 = html3;\n\n    /*\n    if (this.lastHTML2 != html2) {\n        var butt = this.control.getElement(\"vts-credits-imagery-more\");\n        if (butt) {\n            butt.on(\"click\", this.onMoreButton.bind(this, butt, \"2\"));\n        }\n    }\n        \n    if (this.lastHTML3 != html3) {\n        var butt = this.control.getElement(\"vts-credits-mapdata-more\");\n        if (butt) {\n            butt.on(\"click\", this.onMoreButton.bind(this, butt, \"3\"));\n        }\n    }*/\n};\n\n\nUIControlCredits.prototype.onMoreButton = function(butt, html) {\n    var rect = butt.getRect();\n    \n    if (html == '2') {\n        html = this.lastHTML2;\n    } else {\n        html = this.lastHTML3;\n    }\n    \n    this.ui.popup.show({'right' : Math.max(0,(rect['fromRight']-rect['width'])) + 'px',\n        'bottom' : (rect['fromBottom']+7) + 'px'}, html);\n    \n    return false;\n};\n\nUIControlCredits.prototype.onExtendButton = function() {\n    var content = this.control.getElement('vts-credits-extended-content');\n    content.setStyle(\"display\", (content.getStyle(\"display\") != \"inline-block\") ? \"inline-block\" : \"none\");\n    return false;\n};\n\n\nexport default UIControlCredits;\n\n","\nimport Dom_ from '../../utility/dom';\n\n//get rid of compiler mess\nvar dom = Dom_;\n\n\nvar UIControlFullscreen = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.control = this.ui.addControl('fullscreen',\n      '<img id=\"vts-fullscreen\" class=\"vts-fullscreen\" src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAADAAAAAwCAYAAABXAvmHAAAAwUlEQVRo3u2YwRWDIBBEIc+SLMKmckpTFkFPePKQQ57DsitR/z/D6KgMDikBAMCTycKYxai9Bul8MYkic+NFS7BOs4FUa/1IrzTn9xk6O6+rrwEMjGayTlS/UXWeujbcDKgpEZRObgYOc1oYt7CIMXCFFLKmTrS+aqAEP8iSAGBYI1s776FLv7eReaWHWd/cyLz3Bas+vxIYGNXIhBTxOhcKNdCaHvPfGPjVYb3OhVjEGLhrI/Pewc9uZDQvAABwZQMKFi+DmFdLbgAAAABJRU5ErkJggg==\">'\n      , visible, visibleLock);\n      \n    var img = this.control.getElement('vts-fullscreen');\n    img.on('click', this.onClick.bind(this));\n    img.on('dblclick', this.onDoNothing.bind(this));\n    \n    this.enabled = false;\n};\n\n\nUIControlFullscreen.prototype.onDoNothing = function(event) {\n    dom.preventDefault(event);    \n    dom.stopPropagation(event);    \n};\n\n\nUIControlFullscreen.prototype.requestFullscreen = function(element) {\n    if(element.requestFullscreen) {\n        element.requestFullscreen();\n    } else if(element.mozRequestFullScreen) {\n        element.mozRequestFullScreen();\n    } else if(element.webkitRequestFullscreen) {\n        element.webkitRequestFullscreen();\n    } else if(element.msRequestFullscreen) {\n        element.msRequestFullscreen();\n    }\n};\n\n\nUIControlFullscreen.prototype.exitFullscreen = function() {\n    if(document.exitFullscreen) {\n        document.exitFullscreen();\n    } else if(document.mozCancelFullScreen) {\n        document.mozCancelFullScreen();\n    } else if(document.webkitExitFullscreen) {\n        document.webkitExitFullscreen();\n    }\n};\n\n\nUIControlFullscreen.prototype.fullscreenEnabled = function() {\n    return (document.fullscreenEnabled || document.mozFullScreenEnabled || document.webkitFullscreenEnabled);\n};\n\n\nUIControlFullscreen.prototype.onClick = function() {\n    var element = this.ui.element;\n    \n    if (!this.enabled) {\n    //if (!this.fullscreenEnabled()) {\n        this.enabled = true;\n        this.requestFullscreen(element);\n    } else {\n        this.enabled = false;\n        this.exitFullscreen();  \n    } \n};\n\n\nexport default UIControlFullscreen;\n","\nimport Dom_ from '../../utility/dom';\n\n//get rid of compiler mess\nvar dom = Dom_;\n\n\nvar UIControlZoom = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.browser = ui.browser;\n    this.control = this.ui.addControl('zoom',\n      '<div id=\"vts-zoom\"'\n      + ' class=\"vts-zoom\">'\n\n        + '<div id=\"vts-zoom-plus\" class=\"vts-zoom-plus\">'\n            + '<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAASUlEQVRIx+2Tyw0AIAhDq0d2KsMzFFddQBO9+En6rqR5kFBAiBVINpJtJ1NPLCbJe5IyG7j78IMyEwBgZsNcRJQrl6gnkgjxIx12Cg3wDaLBUAAAAABJRU5ErkJggg==\">'\n        + '</div>'\n\n        + '<div id=\"vts-zoom-minus\" class=\"vts-zoom-minus\">'\n          + '<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAALUlEQVRIx2NgGAWjYBSMAqoCRlwSdnZ2/8kx8NChQxhmMo2G8ygYBaNgFGAHAElYBARpOBYqAAAAAElFTkSuQmCC\">'\n        + '</div>'\n\n     + ' </div>', visible, visibleLock);\n\n    var plus = this.control.getElement('vts-zoom-plus');\n    plus.on('click', this.onZoomIn.bind(this));\n    plus.on('dblclick', this.onDoNothing.bind(this));\n\n    var minus = this.control.getElement('vts-zoom-minus');\n    minus.on('click', this.onZoomOut.bind(this));\n    minus.on('dblclick', this.onDoNothing.bind(this));\n};\n\n\nUIControlZoom.prototype.onDoNothing = function(event) {\n    dom.preventDefault(event);    \n    dom.stopPropagation(event);    \n};\n\n\nUIControlZoom.prototype.onZoomIn = function() {\n    this.repeat(7, 0.96, 50);\n};\n\n\nUIControlZoom.prototype.onZoomOut = function() {\n    this.repeat(7, 1.04, 50);\n};\n\n\nUIControlZoom.prototype.repeat = function(count, factor, delay) {\n    if (count <= 0) {\n        return;\n    }\n\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    if (this.browser.autopilot) { //stop autorotation\n        this.browser.autopilot.setAutorotate(0);\n        this.browser.autopilot.setAutopan(0,0);\n    }\n    \n    var controller = this.browser.controlMode.getCurrentController();\n    \n    if (controller.viewExtentDeltas) {\n        controller.viewExtentDeltas.push(factor);\n    }\n\n    setTimeout(this.repeat.bind(this, --count, factor, delay), delay);\n};\n\n\nexport default UIControlZoom;\n","\nimport Dom_ from '../utility/dom';\nimport {math as math_} from '../../core/utils/math';\n\n//get rid of compiler mess\nvar dom = Dom_;\nvar math = math_;\n\n\nvar ControlModeMapObserver = function(browser) {\n    this.browser = browser;\n    this.config = browser.config;\n\n    this.coordsDeltas = [];\n    this.orientationDeltas = [];\n    this.viewExtentDeltas = [];\n    this.northResetAnimation = false;\n\n    this['drag'] = this.drag;\n    this['wheel'] = this.wheel;\n    this['tick'] = this.tick;\n    this['reset'] = this.reset;\n    this['keyup'] = this.keyup;\n    this['keydown'] = this.keydown;\n    this['keypress'] = this.keypress;\n    this['doubleclick'] = this.doubleclick;\n\n    this.retinaFactor = 1.0 / Math.max(1.0,(window.devicePixelRatio || 1) - 1);\n};\n\n\nControlModeMapObserver.prototype.drag = function(event) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var pos = map.getPosition();\n    var coords = pos.getCoords();\n    var delta = event.getDragDelta();\n    //var zoom = event.getDragZoom();\n    var touches = event.getDragTouches();\n    var azimuthDistance = this.getAzimuthAndDistance(delta[0], delta[1]);\n    var sensitivity, config = this.config;\n\n    var modifierKey = (this.browser.controlMode.altKey\n               || this.browser.controlMode.shiftKey\n               || this.browser.controlMode.ctrlKey);\n\n    //event.getTouchParameter(\"touchMode\");\n\n\n    if (touches == 2) {//} && /*event.getDragButton(\"middle\")*/ zoom != 0 && this.config.zoomAllowed) {\n        if (pos.getViewMode() != 'obj') {\n            return;\n        }\n\n        if (event.getTouchParameter('touchMode') == 'pan' && config.rotationAllowed) {\n\n            sensitivity = config.sensitivity[1] * this.retinaFactor;\n            this.orientationDeltas.push([delta[0] * sensitivity,  -delta[1] * sensitivity, 0]);\n            this.browser.callListener('map-position-rotated', {});\n\n        } else if (event.getTouchParameter('touchMode') == 'zoom' && config.zoomAllowed) {\n\n            var delta = event.getTouchParameter('touchDistanceDelta');\n\n            if (Math.abs(delta) >= 1) {\n\n                var factor = 1.0 + (delta > 0 ? -1 : 1)*0.01;\n                this.viewExtentDeltas.push(factor);\n                this.reduceFloatingHeight(0.8);\n\n                if (config.legacyInertia) {\n                    this.updateDeltas(false, false, true);\n                }\n\n                this.browser.callListener('map-position-zoomed', {});\n            }\n        }\n\n    } else if ((event.getDragButton('left') && !modifierKey) && config.panAllowed) { //pan\n\n        if (pos.getHeightMode() == 'fix') {\n            var pos2 = map.convertPositionHeightMode(pos, 'float', true);\n            if (pos2 != null) {\n                pos = pos2;\n                this.setPosition(pos);\n            }\n        } else {\n            sensitivity = config.sensitivity[0] * this.retinaFactor;\n            var fov = pos.getFov();\n            var fovCorrection = (fov > 0.01 && fov < 179) ? (1.0 / Math.tan(math.radians(fov*0.5))) : 1.0;\n            var azimuth = math.radians(azimuthDistance[0]);\n            var forward = [Math.sin(azimuth), //direction vector x\n                Math.cos(azimuth), //direction vector y\n                azimuthDistance[1] * fovCorrection * sensitivity, azimuthDistance[0], //distance and azimut\n                coords[0], coords[1]]; //coords\n\n            this.coordsDeltas.push(forward);\n            this.reduceFloatingHeight(0.9);\n\n            if (config.legacyInertia) {\n                this.updateDeltas(true);\n            }\n\n            this.browser.callListener('map-position-panned', {});\n        }\n    } else if (((touches <= 1 && event.getDragButton('right')) || event.getDragButton('middle') || modifierKey)  && config.rotationAllowed) { //rotate\n\n        sensitivity = config.sensitivity[1] * this.retinaFactor * (pos.getViewMode() != 'obj' ? 0.5 : 1);\n        this.orientationDeltas.push([delta[0] * sensitivity, -delta[1] * sensitivity, 0]);\n\n        if (config.legacyInertia) {\n            this.updateDeltas(false, true);\n        }\n\n        this.browser.callListener('map-position-rotated', {});\n    }\n};\n\n\nControlModeMapObserver.prototype.wheel = function(event) {\n    dom.preventDefault(event);\n\n    var map = this.browser.getMap();\n    if (!map || !this.config.zoomAllowed) {\n        return;\n    }\n\n    if (map.getStats(true)['maxZoom']) {\n        this.browser.config.minViewExtent = 0.5;\n    }\n\n    var pos = map.getPosition();\n    var delta = event.getWheelDelta();\n    var sensitivity = this.config.sensitivity[2];\n\n    if (this.browser.controlMode.shiftKey) sensitivity *= 0.1;\n\n    var factor = 1.0 + (delta > 0 ? -1 : 1)*sensitivity;\n\n    if (this.browser.controlMode.altKey &&\n        this.browser.controlMode.shiftKey &&\n        this.browser.controlMode.ctrltKey) {\n        var fov = math.clamp(pos.getFov() * factor, 1, 179);\n        pos.setFov(fov);\n        map.setPosition(pos);\n    } else {\n        if (pos.getViewMode() != 'obj') {\n            var coords = pos.getCoords();\n\n            var cameraInfo = map.getCameraInfo();\n            var vector = cameraInfo.vector;\n            var height = cameraInfo.height;\n            var speed = Math.max(100, height) * (this.browser.controlMode.shiftKey ? 0.00025 : 0.0025) * (delta > 0 ? 1 : -1);\n\n            coords = map.convertCoordsFromNavToPhys(coords, 'float');\n\n            coords[0] += vector[0] * speed;\n            coords[1] += vector[1] * speed;\n            coords[2] += vector[2] * speed;\n\n            coords = map.convertCoordsFromPhysToNav(coords, 'float');\n\n            pos.setCoords(coords);\n            map.setPosition(pos);\n            return;\n        }\n\n\n        this.viewExtentDeltas.push(factor);\n        this.reduceFloatingHeight(0.8);\n        this.browser.callListener('map-position-zoomed', {});\n    }\n};\n\n\nControlModeMapObserver.prototype.doubleclick = function(event) {\n    dom.preventDefault(event);\n\n    var map = this.browser.getMap();\n    if (!map || !this.config.jumpAllowed) {\n        return;\n    }\n\n    if (this.browser.controlMode.altKey &&\n        this.browser.controlMode.shiftKey &&\n        this.browser.controlMode.ctrlKey) {\n        this.browser.config.minViewExtent = 0.5;\n        return;\n    }\n\n    var coords = event.getMouseCoords();\n    var canvasSize = this.browser.getRenderer().getCanvasSize();\n\n    if (coords[0] < 0 || coords[1] < 0 || coords[0] >= canvasSize[0] || coords[1] >= canvasSize[1]) {\n        return;\n    }\n\n    //get hit coords with fixed height\n    var mapCoords = map.getHitCoords(coords[0], coords[1], 'fix');\n\n    if (mapCoords) {\n        var pos = map.getPosition();\n        pos.setCoords(mapCoords);\n        pos = map.convertPositionHeightMode(pos, 'fix');\n        pos.setHeight(mapCoords[2]);\n        //pos = map.convertPositionHeightMode(pos, \"fix\");\n        //pos.setPositionHeight(0);\n\n        if (this.browser.controlMode.shiftKey) {\n            map.setPosition(pos);\n        } else {        \n            this.browser.autopilot.flyTo(pos, {'mode' : 'direct', 'maxDuration' : 2000 });\n        }\n    }\n};\n\n\nControlModeMapObserver.prototype.keyup = function() {\n};\n\n\nControlModeMapObserver.prototype.keydown = function() {\n};\n\n\nControlModeMapObserver.prototype.keypress = function() {\n};\n\n\nControlModeMapObserver.prototype.setPosition = function(pos) {\n\n    if (!this.config.walkMode) {\n        pos = constrainMapPosition(this.browser, pos);\n    }\n\n    if (this.config.fixedHeight) {\n        pos.setHeight(this.config.fixedHeight);\n    }\n\n    var map = this.browser.getMap();\n    map.setPosition(pos);\n    //console.log(JSON.stringify(pos));\n};\n\n\nControlModeMapObserver.prototype.reduceFloatingHeight = function(factor) {\n    var map = this.browser.getMap();\n    var pos = map.getPosition();\n    var coords = pos.getCoords();\n\n    if (pos.getHeightMode() == 'float' &&\n        pos.getViewMode() == 'obj') {\n        if (coords[2] != 0) {\n            coords[2] *= factor;\n\n            if (Math.abs(coords[2]) < 0.1) {\n                coords[2] = 0;\n            }\n\n            pos.setCoords(coords);\n            this.setPosition(pos);\n        }\n    }\n};\n\n\nControlModeMapObserver.prototype.isNavigationSRSProjected = function() {\n    var map = this.browser.getMap();\n    var rf = map.getReferenceFrame();\n    var srs = map.getSrsInfo(rf['navigationSrs']);\n    return (srs) ? (srs['type'] == 'projected') : false;\n};\n\n\nControlModeMapObserver.prototype.getAzimuthAndDistance = function(dx, dy) {\n    var map = this.browser.getMap();\n    var pos = map.getPosition();\n    var viewExtent = pos.getViewExtent();\n    var fov = pos.getFov()*0.5;\n\n    if (this.config.walkMode) {\n        viewExtent += 5;\n    }\n\n    //var sensitivity = 0.5;\n    var zoomFactor = (((viewExtent*0.5) * Math.tan(math.radians(fov))) / 800);\n    dx *= zoomFactor;\n    dy *= zoomFactor;\n\n    var distance = Math.sqrt(dx*dx + dy*dy);\n    var azimuth = -math.degrees(Math.atan2(dx, dy)) + pos.getOrientation()[0];\n\n    return [azimuth, distance];\n};\n\n\nControlModeMapObserver.prototype.updateDeltas = function(onlyLastPan, onlyLastRotate, onlyLastZoom) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var pos = map.getPosition(), delta, deltas;\n    var update = false, azimuth, correction, i;\n    var inertia = this.config.inertia, stats = map.getStats();\n    var timeFactor = 1;\n    var invTimeFactor = 1;\n\n    if (this.config.timeNormalizedInertia) {\n        var fps = (1000/(map.getStats()['frameTime'] + 0.000001));\n\n        if (fps < 1) {\n            fps = 60;\n        }\n\n        timeFactor = (fps/60);  //normalized to 60 fps\n        invTimeFactor = 1.0/timeFactor;\n    }\n\n    //console.log(''+timeFactor);\n\n    //process coords deltas\n    if (!onlyLastRotate && !onlyLastZoom && this.coordsDeltas.length > 0) {\n        deltas = this.coordsDeltas;\n        var forward = [0,0];\n        var coords = pos.getCoords();\n\n        //get foward vector form coord deltas\n        for (i = (onlyLastPan ? (deltas.length - 1) : 0); i < deltas.length; i++) {\n            delta = deltas[i];\n\n            azimuth = delta[3];\n            azimuth = math.radians(azimuth);\n\n            forward[0] += Math.sin(azimuth) * (delta[2] * invTimeFactor);\n            forward[1] += Math.cos(azimuth) * (delta[2] * invTimeFactor);\n\n            delta[2] *= inertia[0] * timeFactor;\n\n            //remove zero deltas\n            if (delta[2] < 0.01) {\n                deltas.splice(i, 1);\n                i--;\n            }\n        }\n\n        var distance = Math.sqrt(forward[0]*forward[0] + forward[1]*forward[1]);\n        azimuth = math.degrees(Math.atan2(forward[0], forward[1]));\n\n        if (!this.isNavigationSRSProjected()) {\n            if (!this.northResetAnimation && this.config.navigationMode == 'azimuthal' && (Math.abs(coords[1]) > 75 || Math.abs(pos.getOrientation()[0]) > 1))  {\n                this.config.navigationMode = 'azimuthal2';\n            }\n        }\n\n        //apply final azimuth and distance\n        correction = pos.getOrientation()[0];\n        pos = map.movePositionCoordsTo(pos, (this.isNavigationSRSProjected() ? -1 : 1) * azimuth, distance,\n                                            (!(this.config.navigationMode == 'free' || this.config.navigationMode == 'azimuthal2')) ? 0 : 1);\n        correction = pos.getOrientation()[0] - correction;\n\n\n        for (i = 0; i < deltas.length; i++) {\n            delta = deltas[i];\n            delta[3] += correction;\n        }\n\n        update = true;\n    }\n\n    //process coords deltas\n    if (!onlyLastPan && !onlyLastZoom && this.orientationDeltas.length > 0) {\n        deltas = this.orientationDeltas;\n        var orientation = pos.getOrientation();\n\n        //apply detals to current orientation\n        for (i = (onlyLastRotate ? (deltas.length - 1) : 0); i < deltas.length; i++) {\n            delta = deltas[i];\n            orientation[0] += delta[0] * invTimeFactor;\n            orientation[1] += delta[1] * invTimeFactor;\n            orientation[2] += delta[2] * invTimeFactor;\n\n            delta[0] *= inertia[1] * timeFactor;\n            delta[1] *= inertia[1] * timeFactor;\n            delta[2] *= inertia[1] * timeFactor;\n\n            //remove zero deltas\n            if (delta[0]*delta[0] + delta[1]*delta[1] + delta[2]*delta[2] < 0.1) {\n                deltas.splice(i, 1);\n                i--;\n            }\n        }\n\n        //apply final orintation\n        // HACK\n        pos.setOrientation(orientation);\n        update = true;\n    }\n\n    //process view extents deltas\n    if (!onlyLastRotate && !onlyLastPan && this.viewExtentDeltas.length > 0) {\n        deltas = this.viewExtentDeltas;\n        var viewExtent = pos.getViewExtent();\n\n        //apply detals to current view extent\n        for (i = (onlyLastZoom ? (deltas.length - 1) : 0); i < deltas.length; i++) {\n            //viewExtent *= deltas[i];\n            viewExtent *= Math.pow(deltas[i], invTimeFactor);\n            deltas[i] += (1 - deltas[i]) * (1.0 - (inertia[2] * timeFactor));\n\n            //deltas[i] *= Math.pow(deltas[i], Math.pow(inertia[2], timeFactor));\n\n            //remove zero deltas\n            if (Math.abs(1 - deltas[i]) < 0.001) {\n                deltas.splice(i, 1);\n                i--;\n            }\n        }\n\n        viewExtent = Math.max(1, viewExtent);\n\n        //apply final view extrent\n        pos.setViewExtent(viewExtent);\n        update = true;\n    }\n\n    //set new position\n    if (update) {\n        this.setPosition(pos);\n    }\n};\n\nControlModeMapObserver.prototype.tick = function() {\n    this.updateDeltas();\n};\n\n\nControlModeMapObserver.prototype.reset = function() {\n    this.coordsDeltas = [];\n    this.orientationDeltas = [];\n    this.viewExtentDeltas = [];\n};\n\n\nfunction constrainMapPosition(browser, pos) {\n    if (!browser.config.constrainCamera) {\n        return pos;\n    }\n\n    var minVE = browser.config.minViewExtent;\n    var maxVE = browser.config.maxViewExtent;\n\n    var map = browser.getMap(), o;\n\n    //clamp view extets\n    var viewExtent = math.clamp(pos.getViewExtent(), minVE, maxVE);\n    pos.setViewExtent(viewExtent);\n\n    var distance = (viewExtent*0.5) / Math.tan(math.radians(pos.getFov()*0.5));\n    //var hmaxOffset = 0;\n\n    //reduce tilt when you are far off the planet\n    if (pos.getViewMode() == 'obj') {\n        var rf = map.getReferenceFrame();\n        var srs = map.getSrsInfo(rf['navigationSrs']);\n\n        if (srs['a']) {\n\n            var a1 = Math.asin(srs['a'] / (distance + srs['a'])); //get angle to horion\n            //console.log('a1: ' + math.degrees(a1));\n\n            var factor = Math.tan(math.radians(pos.getFov()*0.5)) / Math.tan(a1);\n            //var viewFactor = factor;\n\n            //console.log('factor: ' + factor);\n\n            var threshold = browser.config.tiltConstrainThreshold;\n            var thresholdMin = threshold[0];// * 0.5;\n            var thresholdMax = threshold[1];// * 0.5;\n            var maxTilt, minTilt = -90;\n\n            if (!(thresholdMin > thresholdMax || thresholdMin == thresholdMax)) {\n                factor = math.clamp(factor, thresholdMin, thresholdMax);\n                factor = ((factor - thresholdMin) / (thresholdMax - thresholdMin));\n                maxTilt = 20 + ((-90) - 20) * (factor);\n            } else {\n                maxTilt = 20;\n            }\n\n            //console.log('maxTilt: ' + maxTilt);\n\n            o = pos.getOrientation();\n            o[1] = math.clamp(o[1], minTilt, maxTilt);\n\n            pos.setOrientation(o);\n        }\n\n        //do not allow camera under terrain\n        var camPos = map.getPositionCameraCoords(pos, 'float');\n        //var cameraConstrainDistance = 1;\n        var cameraConstrainDistance = (minVE*0.5) / Math.tan(math.radians(pos.getFov()*0.5));\n        cameraConstrainDistance *= 0.5; //divice by 2 to alow 45deg tilt in maximum zoom\n\n        //var hmax = Math.max(Math.min(4000,cameraConstrainDistance), (distance * Math.tan(math.radians(3.0))));\n        //var hmax = Math.max(Math.min(4000,cameraConstrainDistance), (distance * Math.tan(math.radians(3.0))));\n        var hmax = Math.max(cameraConstrainDistance, (distance * Math.tan(math.radians(3.0))));\n\n        var cameraHeight = camPos[2]; //this.cameraHeight() - this.cameraHeightOffset - this.cameraHeightOffset2;\n\n        if (cameraHeight < hmax) {\n            o = pos.getOrientation();\n\n            var getFinalOrientation = (function(start, end, level) {\n                var value = (start + end) * 0.5;\n\n                if (level > 20) {\n                    return value;\n                } else {\n                    o[1] = value;\n                    pos.setOrientation(o);\n\n                    if (map.getPositionCameraCoords(pos, 'float')[2] < hmax) {\n                        return getFinalOrientation(start, value, level+1);\n                    } else {\n                        return getFinalOrientation(value, end, level+1);\n                    }\n                }\n\n            });//.bind(this);\n\n            o[1] = getFinalOrientation(-90, Math.min(20, o[1]), 0);\n            pos.setOrientation(o);\n        }\n    }\n\n    return pos;\n}\n\n\nexport {ControlModeMapObserver, constrainMapPosition};\n","\nimport Dom_ from '../../utility/dom';\nvar dom = Dom_;\n\nimport {constrainMapPosition as constrainMapPosition_} from '../../control-mode/map-observer';\nvar constrainMapPosition = constrainMapPosition_;\n\n\nvar UIControlSpace = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.browser = ui.browser;\n    this.control = this.ui.addControl('space',\n      '<div id=\"vts-space\"'\n      + ' class=\"vts-space\">'\n\n        + '<img id=\"vts-space-2d\"'\n          + ' class=\"vts-space-button\"'\n          + ' src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAABqElEQVRIx+2UsWoUURSGv3Nn1sIiaKMBSbD0AdRBdmbdB7DMA0gaSSVRbFRYiGAaUWJhEAQVEey10yacO/gAwqZNSKWwhShs4ew9NtewTDI6sRCE/at7h8P/nfnvuRdmmum/lkxvut1u5pwbAOfNrAMMzWy9LMt3v2qKorCaRwC+A9vApqq+bITkeX4Z+CAiab3IzJa9988bIPXaR977G9Pf3NT6joikZvYmSZL5JElOAPcBRORu3UxVRVVlNBodCyEsmtkAMBFZjQ3va79rETluZl+rqrrpvf8c41t3zt0GFpo6Hw6HP4A9YK0oinlgRUSuAVsHIKqaH8hSJIsR7LQ54KqqNtI0XTGzS01xURuCBeBZhD1pAzGz3Vh/+o+QXq93zjnnReSsmb1W1Y0jTm3yW0ie5xdDCB5YNLMX4/H4KmAtzc/EP/py6MHH8bwAvAfmgDXv/eAo7Xc6nSsxro+HQrIsO2Vmb0VkDrilqg9aert+v39yMpksAfciZLPpMj4UkdUmJ1WVNpcReKyq15viWvrLp8mAb8CnEMLTsixfzV7rmf6dfgKmzKAWE7bqxgAAAABJRU5ErkJggg==\">'\n\n        + '<img id=\"vts-space-3d\"'\n          + ' class=\"vts-space-button\"'\n          + ' src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAB8klEQVRIx+1Uv4sTQRT+3mRygyDInYXFabaxsRNOIiG7mEPQxsJCLQVF8AeiaCNWigrWiniCVfA/0Eo4ONnZ4P4FURAL9yyCEMQfRMzs7LOZk2HZxNgIQr7qzbw373t838wAc8zxX4P8RbvdPimEuMLM+4loAcAmM3eTJLkHgAEgiiIu9SgAfAfwBsCa1rpbJqltBWEYXhBCdAE0HEENwBIRrQZBQFmWvQKAIAhuVwyqAOwGcLzRaOzIsuylXyB+VxKdc+FTY8yyMWZbURSn3N7l8nRaa9Ja03A4XCiKosHMtwAwEV0Lw/BQJYnW+oAxZu9oNLqUpulASrmdiPa49GCS3v1+3/R6vc0kSe4AeOIGPu/XSH+Rpul7J906ER0GAGYeADgzi8F5nj+QUl5k5tZEEk+6fV6sfO+mgZk/uDO7KuUqYcUYswTgGYBFAPf/8tbW/kiitR6kafqZma+7CVdmbL7s6j9VyhVF0QtmbuV5fnDLm/F4rJRSICKehaFerx9zcr2uJGHmn0S0U0r5uNlsnlVKWQCPXG5jSm/R6XQWrbUnANx1JGuTjL/JzEeJ6IhS6qNH/kUIcaPc2X/51lo/9TCO441KT5IkeWetXQWwDuAHgG/M/BxAK47jt9MuFYCvAHpFUZzWWl+d/9Zz/Dv8ApJPyD0fWCwOAAAAAElFTkSuQmCC\">'\n\n     + ' </div>', visible, visibleLock);\n     \n    this.button2D = this.control.getElement('vts-space-2d');\n    this.button2D.on('click', this.onSwitch.bind(this));\n    this.button2D.on('dblclick', this.onDoNothing.bind(this));\n\n    this.button3D = this.control.getElement('vts-space-3d');\n    this.button3D.on('click', this.onSwitch.bind(this));\n    this.button3D.on('dblclick', this.onDoNothing.bind(this));\n\n    this.space3D = true;\n    this.display3D = this.space3D;\n\n    if (this.space3D) {\n        this.button2D.setStyle('display', 'block');\n        this.button3D.setStyle('display', 'none');\n    } else {\n        this.button2D.setStyle('display', 'none');\n        this.button3D.setStyle('display', 'block');\n    }\n};\n\n\nUIControlSpace.prototype.onDoNothing = function(event) {\n    dom.stopPropagation(event);    \n};\n\n\nUIControlSpace.prototype.onSwitch = function() {\n    this.space3D = !this.space3D;\n\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    if (this.browser.autopilot) { //stop autorotation\n        this.browser.autopilot.setAutorotate(0);\n        this.browser.autopilot.setAutopan(0,0);\n    }\n\n    var pos = map.getPosition();\n    var orientation = pos.getOrientation();\n\n    if (this.space3D) {\n        orientation[0] = 45;\n        orientation[1] = -60;\n        //pos = map.setPositionFov(pos, 90);\n        pos.setOrientation(orientation);\n    } else {\n        orientation[0] = 0;\n        orientation[1] = -90;\n        //pos = map.setPositionFov(pos, 5);\n        pos.setOrientation(orientation);\n    }\n\n    pos = constrainMapPosition(this.browser, pos);\n    map.setPosition(pos);\n    \n    this.update();\n};\n\n\nUIControlSpace.prototype.update = function() {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var pos = map.getPosition();\n    var orientation = pos.getOrientation();\n\n    var space3D = (Math.abs(orientation[1]+90) > 0.1);\n\n    if (space3D != this.display3D) {\n        if (space3D) {\n            this.button2D.setStyle('display', 'block');\n            this.button3D.setStyle('display', 'none');\n        } else {\n            this.button2D.setStyle('display', 'none');\n            this.button3D.setStyle('display', 'block');\n        }\n\n        this.space3D = space3D;\n        this.display3D = space3D;\n    }\n};\n\n\nexport default UIControlSpace;\n","\nimport {math as math_} from '../../../core/utils/math';\n\n//get rid of compiler mess\nvar math = math_;\n\n// Deduplication of hits, that have the same display_name\n// and are subsequent in a result set. \nfunction dedupe(hits) {\n    var hit, result = [], dupes = [];\n\n    // Helper function, that takes set of duplicities\n    // and returns just one hit.\n    //\n    // we return first populated place  - if exist\n    // or if not exist we return just first one \n    var filterHits = (function(dupes){\n        for (var j = 0; j < dupes.length; j++) {\n            switch (dupes[j].type) {\n                case 'hamlet':\n                case 'village':\n                case 'town':\n                case 'city':\n                    return dupes[j];\n            }\n        }\n\n        return dupes[0];\n    });\n\n    // We go through all hits and separate results \n    // and duplicities\n    for (var i = 0; i < hits.length - 1; i++) {\n        hit = hits[i];\n\n        if (hit.display_name === hits[ i + 1 ].display_name) {\n            dupes.push(hit);\n        } else {\n            if (dupes.length > 0) {\n                dupes.push(hit);\n                result.push(filterHits(dupes));\n                dupes.length = 0;\n            } else {\n                result.push(hit);\n            }\n        }\n    }\n\n    // Make sure filterHits is called\n    if (dupes.length) {\n        result.push(filterHits(dupes));\n    }\n\n    return result;\n}\n\nfunction getDistance(lon1, lat1, lon2, lat2) {\n    var r = 6371e3; // metres\n    var l1 = math.radians(lat1);\n    var l2 = math.radians(lat2);\n    var dlat = math.radians(lat2-lat1);\n    var dlon = math.radians(lon2-lon1);\n\n    var a = Math.sin(dlat/2) * Math.sin(dlat/2) +\n            Math.cos(l1) * Math.cos(l2) *\n            Math.sin(dlon/2) * Math.sin(dlon/2);\n    var c = 2 * Math.atan2(Math.sqrt(a), Math.sqrt(1-a));\n\n    return r * c;\n}\n\n// Stupid unprecise comparsion of two points, if \n// they lay close to each other (less than 10km)\nfunction layClose(A, B) {\n    //return ruler.distance([ A.lon, A.lat ], [ B.lon, B.lat ] ) < 10\n    var diff = 0.1;\n\n    return ( +B.lat > +A.lat - diff ) && ( +B.lat < +A.lat + diff )\n        && ( +B.lon > +A.lon - diff ) && ( +B.lon < +A.lon + diff );\n}\n\n// Hits with low importance can be reshaked by its distance\nfunction reshakeHits(hits) {\n    var maxDiff = 0.06;\n    var maxRank = 0.4;\n    var temp, done;\n\n    do {\n        done = true;\n\n        for (var i = 0; i < hits.length - 1; i++ ) {\n            var h1 = hits[i];\n            var h2 = hits[i + 1];\n\n            if (( h1.rank < maxRank && h2.rank < maxRank ) // both hits have lowRank\n                && ( Math.abs( h1.rank - h2.rank ) < maxDiff ) // ...and diff in their rank is small\n                && ( h1.distance > h2.distance ) // ...and h1 has bigger distance\n                ) {\n\n                // Switch both hits\n                h1.note = 'reshaked-down'\n                h2.note = 'reshaked-up'\n\n                temp = h1;\n                hits[i] = h2;\n                hits[i + 1] = temp;\n                done = false;\n            }\n        }\n    } while (!done);\n}\n\nfunction nofilterSearch(data, lon, lat) {\n    var rtrn = [];\n    var hits = data;\n    var hasLocation = lat && lon;\n    var rtrnHit, hit;\n\n    //Cycle each hit and reduce uts size\n    for (var i = 0; i < hits.length; i++) {\n        hit = hits[i];\n\n        rtrnHit = { \n            lat: +hit['lat'], \n            lon: +hit['lon'],  \n            title: hit['title'],\n            rank: 1, //hit.importance || 1,\n            country: hit['country'], \n            region: hit['region'],\n            state: hit['state'],\n            cc: '',\n            type: '', \n            bounds: null, //hit.boundingbox,\n            polygon : [],\n            bbox : null //hit.boundingbox\n        }\n\n        // Calculate distance\n        if (hasLocation) {\n            rtrnHit.distance = getDistance(lon, lat, rtrnHit.lon, rtrnHit.lat);\n        }\n\n        rtrn.push(rtrnHit);\n    }\n\n    return rtrn;\n}\n\n// Return Promise, that resolves nice deduplicated results from \n// Nominatim (on particular keyword)\nfunction filterSearch(data, lon, lat) {\n    var rtrn = [];\n    var hasLocation = lat && lon;\n    var hits = data;\n\n    /*\n    // Should we search ZIP code? \n    var querySubString = ( /^\\d{3,5}$/.test( query ) ) ? \n                            `postalcode=${  query }` : `q=${ encodeURIComponent( query ) }`\n\n    var url = `${ searchServer }search.php?format=json&limit=20&addressdetails=1&${ querySubString }&accept-language=${lang}`;      \n\n    if( program.dev ) log.info(url);\n    */\n\n    var rtrnHit, hit, adr, region, county, display, bounds;\n\n    // Deduplication number 1: Deduplicate consequent \n    // results with same name\n    if( hits.length > 1) {\n        hits = dedupe( hits );\n    }\n\n    //Cycle each hit and reduce uts size\n    for (var i = 0; i < hits.length; i++) {\n\n        // Shortcuts\n        hit = hits[i];\n\n        bounds = hit.boundingbox;\n\n        adr = hit.address;\n\n        display = hit.display_name.replace(/,.*/,'');\n\n        region = adr.state && adr.state \n                    || ( adr.state_district && adr.state_district ||\n                            ( adr.county && adr.county || '' ) );\n\n        county = adr.county && adr.county \n                    || ( adr.state_district && adr.state_district || region );\n\n        // If county is same as title, find \n        // something better         \n        if (county === display) {\n            county = adr.state_district && adr.state_district || region;\n        }\n\n        // Deduplication number 2: Simple process of throwing away hits\n        // that have lower importance, and lay in vicinity\n        // of previous hit\n        if (rtrnHit && layClose(rtrnHit, hit)) continue;\n\n        // Filter out results with low, low low importance\n        // but only if there is more results\n        if (hit.importance < 0.01 && i > 5) continue;\n\n        // Rewrite these types of regions\n        // \"Graubünden - Grigioni - Grischun\" --> \"Graubunder\"\n        if (new RegExp(/ - /).test( region )) {\n            region = region.replace(/ -.*/,'');\n        }\n\n        // Should we display bounds instead of dot in a map?            \n        if (hit.type === 'archipelago'  || \n            ( hit.type === 'administrative' && \n            (display === adr.country || display === region ))) {            \n\n            // Repair undefined lon values in bounds\n            if( bounds[2] === '-180' ) {\n                bounds[2] = bounds[3] = hit.lon;\n            }\n\n        } else {\n            bounds = null;\n        }\n\n        // Changes display name in adress querries like \"Kopeckeho 27\"\n        if (display === adr.house_number && adr.road ) {\n            display = adr.road;\n        }\n\n        rtrnHit = { \n            lat: +hit.lat, \n            lon: +hit.lon,  \n            title: display,\n\n            rank: hit.importance,\n\n            // for US we use State as country \n            country: adr.country_code === 'us' ? region : ( adr.country && adr.country.replace(/,.*/,'')  ), \n\n            display: hit.display_name,\n            region: county || '',\n            state: region || '',\n            cc: adr.country_code,\n            type: hit.type, \n            bounds: bounds,\n            polygon : hit.polygonpoints || [],\n            bbox : hit.boundingbox\n        }\n\n        // Calculate distance\n        if (hasLocation) {\n            rtrnHit.distance = getDistance(lon, lat, rtrnHit.lon, rtrnHit.lat);\n        }\n\n\n        rtrn.push(rtrnHit)\n    }\n\n    // Reshake hits by distance\n    if (hasLocation) { \n        reshakeHits(rtrn);\n    }\n\n    return rtrn;\n}   \n\n// return query on reverse search\n/*\nfunction geoSearch = ( { lat,lon,zoom,lang } ) => {\n    var url = `${ searchServer }reverse.php?format=json&lat=${ lat }&lon=${ lon }&zoom=${ zoom }&addressdetails=1&accept-language=${ lang }`\n    return rp.get(url,{ timeout: 3000, json: true })\n} \n*/              \n\nexport {filterSearch, nofilterSearch};\n","\nimport Dom_ from '../../utility/dom';\nimport {utils as utils_} from '../../../core/utils/utils';\nimport {filterSearch as filterSearch_, nofilterSearch as nofilterSearch_} from './search-filter';\nimport {vec3 as vec3_} from '../../../core/utils/matrix';\nimport {math as math_} from '../../../core/utils/math';\n\n//get rid of compiler mess\nvar dom = Dom_;\nvar vec3 = vec3_;\nvar math = math_;\nvar utils = utils_;\nvar filterSearch = filterSearch_;\nvar nofilterSearch = nofilterSearch_;\n\nvar UIControlSearch = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.browser = ui.browser;\n    \n    var element = this.browser.config.controlSearchElement;\n    if (element) {\n        if (typeof element === 'string') {\n            element = document.getElementById(element);\n        }\n    }\n    \n    this.control = this.ui.addControl('search',\n      '<div class=\"vts-search\">'\n      + '<div class=\"vts-search-input\"><input type=\"text\" id=\"vts-search-input\" autocomplete=\"off\" spellcheck=\"false\" placeholder=\"Search location...\"></div>'      \n      + '<div id=\"vts-search-list\" class=\"vts-search-list\"></div>'      \n      + '</div>', visible, visibleLock, element);\n\n    this.input = this.control.getElement('vts-search-input');\n    \n    //this.input.on(\"change\", this.onChange.bind(this));\n    this.input.on('input', this.onChange.bind(this));\n    this.input.on('keydown', this.onKeyUp.bind(this));\n    this.input.on('focus', this.onFocus.bind(this));\n    this.input.on('mousedown', this.onDrag2.bind(this));\n    this.input.on('mousewheel', this.onDrag.bind(this));\n    this.input.on('dblclick', this.onDoNothing.bind(this));\n\n    this.list = this.control.getElement('vts-search-list');\n    this.list.on('mousedown', this.onDrag2.bind(this));\n    this.list.on('mousewheel', this.onDrag.bind(this));\n\n    this.mapControl = this.ui.getMapControl();\n    this.mapElement = this.mapControl.getMapElement();\n    this.mapElement.on('mousedown', this.onDrag.bind(this), window);\n    this.mapElement.on('mousewheel', this.onDrag.bind(this), window);\n\n    this.ignoreDrag = false; \n\n    //old template '//cdn.melown.com/vtsapi/geocode?q={value}&format=json&lang=en-US&addressdetails=1&limit=20';\n    //this.urlTemplate = '//cdn.melown.com/vtsapi/geocode/v3.0/{lat}/{long}/{value}';\n    //this.urlTemplate = '//node.windy.com/search/v3.0/{lat}/{long}/{value}';\n    this.urlTemplate = '//cdn.melown.com/vtsapi/geocode/v3.0/{lat}/{long}/{value}';\n    this.urlTemplate2 = this.urlTemplate;\n    this.data = [];\n    this.lastSearch = '';\n    this.itemIndex = -1;\n    this.searchCounter = 0;\n    this.coordsSrs = '+proj=longlat +datum=WGS84 +nodefs';\n\n    this.initialValueUsed = false;\n\n    if (this.browser.config.controlSearchValue) {\n        this.initialValueUsed = true;\n        this.input.getElement().value = this.browser.config.controlSearchValue;\n        this.onChange();\n    }\n};\n\n\nUIControlSearch.prototype.onDoNothing = function(event) {\n    dom.preventDefault(event);    \n    dom.stopPropagation(event);    \n};\n\n\nUIControlSearch.prototype.processTemplate = function(str, obj) {\n    return str.replace(/\\{([$a-zA-Z0-9][$a-zA-Z0-9]*)\\}/g, function(s, match) {\n        return (match in obj ? obj[match] : s);\n    });\n};\n\n\nUIControlSearch.prototype.showList = function() {\n    this.list.setStyle('display', 'block');\n};\n\n\nUIControlSearch.prototype.hideList = function() {\n    //this.data = {};\n    this.list.setStyle('display', 'none');\n};\n\n\nUIControlSearch.prototype.moveSelector = function(delta) {\n    //this.data = {};\n    this.itemIndex += delta;\n\n    if (this.itemIndex >= this.data.length) {\n        this.itemIndex = this.data.length - 1;\n    }\n    \n    if (this.itemIndex < 0) {\n        this.itemIndex = 0;\n    }\n    \n    this.updateList(this.data);\n};\n\n\nUIControlSearch.prototype.updateList = function(json) {\n    if (Array.isArray(json)) {\n        var data = json, item, list = '';\n        data = data.slice(0,10);\n        this.data = data;\n\n        for (var i = 0, li = data.length; i < li; i++) {\n            item = data[i];\n\n            var title = '';\n\n            if (this.coords && i == 0) {\n                title = 'location: ';\n            }\n\n            title += item['title'] + '<small>';\n\n            if (item['region'] && item['title'] != item['region']) {\n                title += ', ' + item['region'];\n            }\n\n            if (item['country'] && item['title'] != item['country'] && item['region'] != item['country']) {\n                title += (item['region'] ? ', ' : '') + item['country'];\n            }\n\n            title += '</small>';\n\n            if (this.itemIndex == i) {\n                list += '<div id=\"vts-search-item' + i + '\"'+ ' class=\"vts-search-listitem-selected\">' + title + '</div>';\n            } else {\n                list += '<div id=\"vts-search-item' + i + '\"'+ ' class=\"vts-search-listitem\">' + title + '</div>';\n            }\n                \n        }\n        \n        this.list.setHtml(list);\n\n        for (i = 0, li = data.length; i < li; i++) {\n            var id = 'vts-search-item' + i;\n            item = this.control.getElement(id);\n            \n            if (item) {\n                item.on('click', this.onSelectItem.bind(this, i));\n                item.on('mouseenter', this.onHoverItem.bind(this, i));\n            }\n        }\n\n        if (!this.initialValueUsed) {\n            this.showList();\n        }\n    } else {\n        this.hideList();\n    }\n};\n\nUIControlSearch.prototype.solveSRS = function(srs) {\n    if (srs.indexOf('+proj=') == -1) { //no proj4 string\n        srs = map.getSrsInfo(srs);\n        if (srs && srs['srsDef']) {\n            srs = srs['srsDef'];\n        } else {\n            srs = this.coordsSrs;            \n        }\n    }\n\n    return srs;\n};\n\nUIControlSearch.prototype.onSelectItem = function(index) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n    \n    //sort list with polygons\n    var pos = map.getPosition();\n    var refFrame = map.getReferenceFrame();\n    var navigationSrsId = refFrame['navigationSrs'];\n    var navigationSrs = map.getSrsInfo(navigationSrsId);\n    var physicalSrsId = refFrame['physicalSrs'];\n    var physicalSrs = map.getSrsInfo(physicalSrsId);\n\n    var proj4 = this.browser.getProj4();\n    var srs = this.browser.config.controlSearchSrs || this.coordsSrs;\n    srs = this.solveSRS(srs);\n\n    var coords = proj4(navigationSrs['srsDef'], srs, pos.getCoords());\n\n    pos = map.convertPositionHeightMode(pos, \"float\", true);\n\n    var item = this.data[index];\n    if (item) {\n        var coords = [item['lon'], item['lat']];\n        \n        //conver coords from location srs to map navigation srs         \n        coords = proj4(srs, navigationSrs['srsDef'], coords);\n        coords[2] = 0;\n\n        pos.setCoords(coords);\n\n        var viewExtent = 6667;                \n\n        if (item.bbox) {\n            var lat1 = parseFloat(item.bbox[0]);\n            var lat2 = parseFloat(item.bbox[1]);\n            var lon1 = parseFloat(item.bbox[2]);\n            var lon2 = parseFloat(item.bbox[3]);\n\n            item.polygon = [\n                [lon1, lat1], [(lon2+lon1)*0.5, lat1], [lon2, lat1],\n                [lon1, (lat2+lat1)*0.5],  [lon2, (lat2+lat1)*0.5],\n                [lon1, lat2], [(lon2+lon1)*0.5, lat2], [lon2, lat2]\n            ];\n        }\n\n        if (item.polygon && item.type != 'continent') {\n            var points = item.polygon;\n\n            //convert point to physical coords\n            var cameraPosition = proj4(srs, physicalSrs['srsDef'], coords);\n            var cameraVector = [-cameraPosition[0], -cameraPosition[1], -cameraPosition[2]];\n            vec3.normalize(cameraVector);\n\n            for (var i = 0, li = points.length; i < li; i++) {\n                //convert point to physical coords\n                coords = proj4(srs, physicalSrs['srsDef'], [points[i][0], points[i][1], 0]);\n\n                var ab = cameraVector;\n                var av = [coords[0] - cameraPosition[0], coords[1] - cameraPosition[1], coords[2] - cameraPosition[2]];\n\n                //final R3 bv  = v.sub( b ) ;\n                var b = [cameraPosition[0] + cameraVector[0], cameraPosition[1] + cameraVector[1], cameraPosition[2] + cameraVector[2]];\n                var bv = [coords[0] - b[0], coords[1] - b[1], coords[2] - b[2]];\n\n                var af = [0,0,0];\n                vec3.cross(ab, av, af);\n\n                var d = (vec3.length(bv) / vec3.length(ab)) * 2;\n\n                if (d > viewExtent) {\n                    viewExtent = d;\n                }\n            }\n\n            if (navigationSrs['type'] != 'projected') {\n                if (viewExtent > navigationSrs['a']*1.4) {\n                    viewExtent = navigationSrs['a']*1.4;\n                }\n            }\n        } else {\n            //try to guess view extent from location type\n            switch(item.type) {\n            case 'peak':        viewExtent = 20000;   break;\n            case 'city':        viewExtent = 30000;   break;                \n            case 'street':      viewExtent = 4000;    break;\n            case 'residential': viewExtent = 3000;    break;\n            case 'continent':   viewExtent = 8550000; break;             \n            case 'pos':         viewExtent = 150000;  break;             \n            }\n        }\n        \n        pos.setViewExtent(viewExtent);                \n\n        var orientation = [0,-60,0];\n\n        //reduce tilt when you are far off the planet\n        if (pos.getViewMode() == 'obj') {\n            if (navigationSrs['a']) {\n                var distance = (pos.getViewExtent()*0.5) / Math.tan(math.radians(pos.getFov()*0.5));\n                var factor = Math.min(distance / (navigationSrs['a']*0.5), 1.0);\n                var maxTilt = 20 + ((-90) - 20) * factor; \n                var minTilt = -90; \n                \n                if (orientation[1] > maxTilt) {\n                    orientation[1] = maxTilt;\n                }\n        \n                if (orientation[1] < minTilt) {\n                    orientation[1] = minTilt;\n                }\n            }\n        }\n\n        pos.setOrientation(orientation);\n        map.setPosition(pos);\n        \n        this.itemIndex = index;\n        this.lastSearch = item['title'];\n        \n        var element = this.input.getElement();  \n        element.value = this.lastSearch;\n        element.blur(); //defocus \n    }\n\n    this.hideList();\n};\n\n\nUIControlSearch.prototype.onHoverItem = function(index) {\n    if (this.itemIndex == index) {\n        return;\n    }\n\n    this.itemIndex = index;\n    this.updateList(this.data);\n};\n\n\nUIControlSearch.prototype.onListLoaded = function(counter, data) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    if (this.searchCounter == counter) {\n\n        var pos = map.getPosition();\n        var refFrame = map.getReferenceFrame();\n        var navigationSrsId = refFrame['navigationSrs'];\n        var navigationSrs = map.getSrsInfo(navigationSrsId);\n\n        var proj4 = this.browser.getProj4();\n        var srs = this.browser.config.controlSearchSrs || this.coordsSrs;\n        srs = this.solveSRS(srs);\n\n        var coords = proj4(navigationSrs['srsDef'], srs, pos.getCoords());\n\n        //check data format\n        if (!(data['data'] && Array.isArray(data['data']) && data['header'] && data['header']['type'] == 'search')) {\n            return;\n        }\n\n        if (this.browser.config.controlSearchFilter) {\n            data = filterSearch(data['data'], coords[0], coords[1]);\n        } else {\n            data = nofilterSearch(data['data'], coords[0], coords[1]);\n        }\n\n        if (this.coords) {\n            data.unshift({\n                'title' : ('' + this.coords[0].toFixed(6) + ' ' + this.coords[1].toFixed(6)),\n                'lat' : this.coords[0],\n                'lon' : this.coords[1],\n                'type': 'pos'\n            });\n        }\n\n        this.updateList(data);\n    }\n};\n\n\nUIControlSearch.prototype.onListLoadError = function() {\n};\n\n\nUIControlSearch.prototype.onFocus = function() {\n    this.lastSearch = '';\n    var element = this.input.getElement();  \n    element.value = this.lastSearch;\n    this.hideList();\n};\n\n\nUIControlSearch.prototype.onKeyPress = function(event) {\n    //console.log('press');\n\n    this.onKeyUp(event);\n};\n\n\nUIControlSearch.prototype.onKeyUp = function(event) {\n    var code = event.getKeyCode();\n    \n    switch(code) {\n    case 38:  //up\n        this.moveSelector(-1);\n        dom.preventDefault(event);\n        dom.stopPropagation(event);    \n        break;\n\n    case 40:  //down\n        this.moveSelector(1); \n        dom.preventDefault(event);\n        dom.stopPropagation(event);    \n        break;\n\n    case 9:  //tab\n    case 13: //enter\n        \n        this.onSelectItem(Math.max(0,this.itemIndex), null); \n        break;\n    }\n};\n\n\nUIControlSearch.prototype.parseLatLon = function(value) {\n    if (value.replace(/\\d+/, '') == value) {\n        return null;\n    }\n\n    value = value.replace(',',' ');\n    value = (value.replace(/  +/g, ' ')).trim().toLowerCase();\n    var words = value.split(' '), lat, lon, i;\n    var lastChar, lastChar2, skip, part, numbers, num;\n\n    //simple case of two numbers\n    if (words.length == 2 && value.indexOf('n') == -1 && value.indexOf('s') == -1 &&\n        value.indexOf('w') == -1 && value.indexOf('e') == -1 ) {\n\n        lastChar = words[0].charAt(words[0].length - 1);\n        lastChar2 = words[1].charAt(words[1].length - 1);\n        skip = false;\n\n        //are numbers in degrees? \n        if (lastChar == '°' || lastChar == \"'\" || lastChar == '\"') {\n            if (lastChar2 == '°' || lastChar2 == \"'\" || lastChar2 == '\"') {\n                words[0] = words[0] + 'n';\n                words[1] = words[1] + 'e';\n                value = words.join();\n            }\n        }\n\n        if (!skip) {\n            if (!isNaN(words[0]) && !isNaN(words[1])) {\n                lat = parseFloat(words[0]);\n                lon = parseFloat(words[1]);\n\n                if (!isNaN(lat) && !isNaN(lon)) {\n\n                    if (lat > 90 || lat < -90) {\n                        return null;\n                    }\n\n                    if (lon > 360 || lon < -360) {\n                        return null;\n                    }\n\n                    return[lat, lon];\n                }\n            }\n        }\n\n       return null;\n    }\n\n    var parts = value.split(/[°'\"]+/).join(' ').split(/[^\\w\\S]+/);\n\n    //check wheteher it make sence to pase it further\n    lat = 0, lon = 0, numbers = 0;\n\n    var lengthCheck = false;\n\n    for (i in parts) {\n        part = parts[i];\n\n        if (isNaN(part)) {\n            num = parseFloat(part);\n            lengthCheck = true;\n            lastChar = part.charAt(part.length - 1);\n\n            if (!isNaN(num)) {\n                numbers++;\n                lengthCheck = false;\n            } \n\n            if (!lengthCheck || (part.length == 1)) {\n                if (lastChar == 'w' || lastChar == 'e') {\n                    lat++;\n                }\n\n                if (lastChar == 'n' || lastChar == 's') {\n                    lon++;\n                }\n            }\n\n        } else {\n            numbers++;\n        }\n    }\n\n    if (!(lat == 1 && lon ==1)) {\n        return null;\n    }\n\n    // parse complex lat lon in degrees with directions\n    var directions = [];\n    var coords = [];\n    var dd = 0;\n    var pow = 0;\n    var numberCount = 0;\n\n    for (i in parts) {\n\n        // we end on a direction\n        if (isNaN(parts[i])) {\n            var direction = parts[i];\n            num = parseFloat(parts[i]);\n\n            if (!isNaN(num)) {\n                dd += ( num / Math.pow( 60, pow++ ) );\n                direction = parts[i].replace( num, '' );\n                numberCount++;\n            }\n\n            direction = direction[0];\n\n            if (direction == 's' || direction == 'w') {\n                dd *= -1;\n            }\n\n            directions[directions.length] = direction;\n            coords[coords.length] = dd;\n            dd = pow = 0;\n\n        } else {\n            num = parseFloat(parts[i]);\n\n            if (!isNaN(num)) {\n                dd += ( num / Math.pow( 60, pow++ ) );\n                numberCount++;\n            }\n        }\n    }\n\n    if (coords.length != 2 || numberCount < 2 || isNaN(coords[0]) || isNaN(coords[1])) {\n        return null;\n    }\n\n    if (directions[0] == 'w' || directions[0] == 'e') {\n        var tmp = coords[0];\n        coords[0] = coords[1];\n        coords[1] = tmp;\n    }\n\n    if (coords[0] > 90 || coords[0] < -90) {\n        return null;\n    }\n\n    if (coords[1] > 360 || coords[1] < -360) {\n        return null;\n    }\n\n    return coords;\n}\n\nUIControlSearch.prototype.onChange = function() {\n    var value = this.input.getElement().value;\n    value = value.trim();\n\n    //console.log(\"value: \" + value + \"  last-value: \" + this.lastSearch);\n\n    if (value == this.lastSearch) {\n        //console.log(\"value-same\");\n        return;        \n    }\n    \n    this.lastSearch = value;\n    \n    if (value == '') {\n        //console.log(\"value-null\");\n        this.hideList();        \n    }\n\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n    \n    //sort list with polygons\n    var pos = map.getPosition();\n    var refFrame = map.getReferenceFrame();\n    var navigationSrsId = refFrame['navigationSrs'];\n    var navigationSrs = map.getSrsInfo(navigationSrsId);\n    var proj4 = this.browser.getProj4();\n    var srs = this.browser.config.controlSearchSrs || this.coordsSrs;\n    srs = this.solveSRS(srs);\n\n    var coords = proj4(navigationSrs['srsDef'], srs, pos.getCoords());\n\n\n    this.coords = this.parseLatLon(value);\n   \n    var url = this.processTemplate(this.browser.config.controlSearchUrl || this.urlTemplate, { 'value':value, 'lat':coords[1], 'long':coords[0] });\n    //console.log(url);\n    this.searchCounter++;\n    this.itemIndex = -1;\n   \n    utils.loadJSON(url, this.onListLoaded.bind(this, this.searchCounter), this.onListLoadError.bind(this));\n};\n\n\nUIControlSearch.prototype.onDrag2 = function() {\n    this.ignoreDrag = true; \n    //var element = this.input.getElement();  \n};\n\n\nUIControlSearch.prototype.onDrag = function() {\n    if (this.ignoreDrag) {\n        this.ignoreDrag = false;\n        return; \n    } \n\n    var element = this.input.getElement();  \n    element.value = this.lastSearch;\n    element.blur(); //defocus'\n    this.hideList(); \n};\n\n\nUIControlSearch.prototype.update = function() {\n    if (this.initialValueUsed && this.browser.mapLoaded) {\n        this.initialValueUsed = false;\n        this.onSelectItem(0);\n    }\n};\n\n\nexport default UIControlSearch;\n","\nimport Dom_ from '../../utility/dom';\n\n//get rid of compiler mess\nvar dom = Dom_;\n\n\nvar UIControlLink = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.browser = ui.browser;\n    this.control = this.ui.addControl('link',\n      '<div id=\"vts-link\" class=\"vts-link\">'\n\n        + '<div id=\"vts-link-button\" class=\"vts-link-button\">'\n          + '<img src=\"data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAABrUlEQVRIx+2VMWtUQRSFz5nZjVrpD9gNVhpLQbZZ5vWaIoUECayNRSpbo9UiJI1pBRs7DVjYGBC1ntm3yHaiwgYsZP+EmMe7x8K3YJEH+xYLwT3NcGe483HvnJkBVvovxWWSsiy7BeAxgGuSpmY2zPP8/V+DhBAekDysQgPgAMDMbo5Gow9n5bgmgF6vd47kAYBC0t0Y45qkPQAguV+X1wgymUx+ShqUZZmllI4AlEVRPJckkht1ea1FNu/3+1ve+31JV0h+dc49mq+12+0dkpQ0XfpMQgh7JJ9U4SmANf3WZUnXvfevAbQBbMYY3zVu1x+Awsx2YoznzewOgKcke3OApId1AADwCwIGJG90u12f5/nx+vr6Jefc0RyQUjpsfE9CCJsk3wIoyrLcljRttVrznv8AcAEAFgHUtovksNrkXp7nx+Px+ETSbQBfKrN8NrOtRQC17pK0QbJMKb2az5nZd+fc/ZRSBKAm1q+r5ASADyHsVuPAe/+R5JtlnqEzIWY2rGDPsiw7JfmysulB0ypq3TWbzb51Op0JyaskLwL4BGA3xvhi9aes9G/pF4AdwlhUZ8RfAAAAAElFTkSuQmCC\">'\n        + '</div>'\n\n        + '<div id=\"vts-link-text-holder\" class=\"vts-link-text-holder\">'\n            + '<div class=\"vts-link-text\">'\n              + '<textarea id=\"vts-link-text-input\" rows=\"4\" cols=\"50\" wrap=\"hard\"></textarea>'\n            + '</div>'\n        + '</div>'\n        \n     + ' </div>', visible, visibleLock);\n     \n    this.div = this.control.getElement('vts-link');\n\n    var button = this.control.getElement('vts-link-button');\n    button.on('click', this.onSwitch.bind(this));\n    button.on('dblclick', this.onDoNothing.bind(this));\n\n    this.linkPanel = this.control.getElement('vts-link-text-holder');\n    this.link = this.control.getElement('vts-link-text-input');\n\n    this.linkVisible = false;\n    this.update();\n};\n\n\nUIControlLink.prototype.onDoNothing = function(event) {\n    dom.stopPropagation(event);    \n};\n\n\nUIControlLink.prototype.onSwitch = function() {\n    this.linkVisible = !this.linkVisible;\n    this.updateLink();\n    this.update();\n};\n\n\nUIControlLink.prototype.update = function() {\n    //var button = this.control.getElement('vts-link-button');\n    \n    var left = 10 + (this.ui.config.controlZoom ? 70 : 0) +\n                (this.ui.config.controlSpace ? 35 : 0);\n    \n    this.div.setStyle('left', left + 'px');\n    this.linkPanel.setStyle('display', this.linkVisible ? 'block' : 'none');\n};\n\n\nUIControlLink.prototype.updateLink = function() {\n    var linkValue =  this.browser.getLinkWithCurrentPos();\n    if (this.link.getElement().value != linkValue) {\n        this.link.getElement().value = linkValue;\n    }\n};\n\n\nexport default UIControlLink;\n\n","\nvar UIControlLayers = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.control = this.ui.addControl('layers',\n      '<div class=\"vts-layers\"'\n      + '</div>', visible, visibleLock);\n};\n\n\nexport default UIControlLayers;\n","\n\nvar UIControlFallback = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.control = this.ui.addControl('fallback',\n      '<div class=\"vts-fallback\">'\n\n        + '<div class=\"vts-fallback-text\">'\n            + '<p>VTS Browser needs <a href=\"http://get.webgl.org/\">WebGL</a> capable web browser.</p>'\n        + '</div>'\n\n      + ' </div>', visible, visibleLock);\n};\n\n\nexport default UIControlFallback;\n","\nvar UIControlPopup = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.browser = ui.browser;\n    this.control = this.ui.addControl('popup',\n        '<div class=\"vts-popup-background\" id=\"vts-popup-background\">'\n      +    '<div id=\"vts-popup\"</div>'\n      + '</div>', visible, visibleLock);\n\n    this.lastHTML = '';\n    this.popup = this.control.getElement('vts-popup');\n    this.background = this.control.getElement('vts-popup-background');\n    this.background.on('click', this.hide.bind(this));\n};\n\n\nUIControlPopup.prototype.show = function(style, html) {\n    this.control.setVisible(true);\n    \n    for (var key in style) {\n        this.popup.setStyle(key, style[key]);\n    }\n\n    this.popup.setHtml(html);\n};\n\n\nUIControlPopup.prototype.hide = function() {\n    this.control.setVisible(false);\n};\n\n\nexport default UIControlPopup;\n","\nvar UIControlLoading = function(ui, visible) {\n    this.ui = ui;\n    this.control = this.ui.addControl('loading',\n      '<div id=\"vts-loading\" class=\"vts-loading\">'\n\n        + '<div class=\"vts-loading-progress\">'\n            + '<div id=\"vts-loading-dot1\" class=\"vts-loading-dot\"></div>'\n            + '<div id=\"vts-loading-dot2\" class=\"vts-loading-dot\"></div>'\n            + '<div id=\"vts-loading-dot3\" class=\"vts-loading-dot\"></div>'\n            + '<div id=\"vts-loading-dot4\" class=\"vts-loading-dot\"></div>'\n            + '<div id=\"vts-loading-dot5\" class=\"vts-loading-dot\"></div>'\n        + '</div>'\n\n      + ' </div>', visible);\n\n    this.loading = this.control.getElement('vts-loading');\n    this.dots = [\n        this.control.getElement('vts-loading-dot1'),\n        this.control.getElement('vts-loading-dot2'),\n        this.control.getElement('vts-loading-dot3'),\n        this.control.getElement('vts-loading-dot4'),\n        this.control.getElement('vts-loading-dot5')\n    ];\n    \n    this.time = Date.now();\n    this.hiding = null;\n    \n    //setTimeout(this.hide.bind(this), 5000);\n};\n\n\nUIControlLoading.prototype.show = function() {\n    this.hiding = null;\n    this.ui.setControlVisible('compass', false);\n    this.ui.setControlVisible('zoom', false);\n    this.ui.setControlVisible('space', false);\n    this.ui.setControlVisible('search', false);\n    this.ui.setControlVisible('link', false);\n    this.ui.setControlVisible('github', false);\n    this.ui.setControlVisible('measure', false);\n    this.ui.setControlVisible('measure2', false);\n    this.ui.setControlVisible('fullscreen', false);\n    this.ui.setControlVisible('credits', false);\n    this.ui.setControlVisible('loading', true);\n    this.time = Date.now();\n};\n\n\nUIControlLoading.prototype.hide = function() {\n    this.hiding = Date.now();\n    \n    var search = this.ui.config.controlSearch;\n    if (search && !this.ui.browser.config.controlSearchUrl) { //enable search for melown2015 reference frame only\n        var map = this.ui.browser.getMap();\n        if (map) {\n            //search = (map.getReferenceFrame()[\"id\"] == \"melown2015\");\n            \n            var radius = map.getSrsInfo(map.getReferenceFrame()['physicalSrs'])['a'];\n            \n            if (radius < (6378137 + 50000) && radius > (6378137 - 50000)) { //is it earth\n                search = true;  \n            } else {\n                search = false;  \n            }\n            //search = (map.getSrsInfo(map.getReferenceFrame()[\"physical\"]) == \"melown2015\");\n        }\n    } \n   \n    this.ui.setControlVisible('compass', this.ui.config.controlCompass, false);\n    this.ui.setControlVisible('zoom', this.ui.config.controlZoom, false);\n    this.ui.setControlVisible('space', this.ui.config.controlSpace, false);\n    this.ui.setControlVisible('search', search, false);\n    this.ui.setControlVisible('link', this.ui.config.controlLink, false);\n    this.ui.setControlVisible('github', this.ui.config.controlGithub, false);\n    this.ui.setControlVisible('measure', this.ui.config.controlMeasure, false);\n    this.ui.setControlVisible('measure2', this.ui.config.controlMeasureLite, false);\n    this.ui.setControlVisible('fullscreen', this.ui.config.controlFullscreen, false);\n    this.ui.setControlVisible('credits', this.ui.config.controlCredits, false);\n    this.ui.setControlVisible('loading', false);\n};\n\n\nUIControlLoading.prototype.update = function() {\n    var timer = Date.now();\n    var timeDelta;\n\n    if (this.hiding) { \n        timeDelta = (timer - this.hiding) * 0.001;\n        this.loading.setStyle('opacity', (1-Math.min(1.0, timeDelta*2)) + '' );\n        \n        if (timeDelta > 0.5) {\n            this.control.setVisible(false);\n        }\n    }\n\n\n    timeDelta = (timer - this.time) * 0.001;\n\n    //sine wave\n    /*\n    for (var i = 0; i < 5; i++) {\n        this.dots[i].setStyle(\"top\", (Math.sin(((Math.PI*1.5)/5)*i+timeDelta*Math.PI*2)*10)+\"%\");\n    }*/\n\n    //opacity    \n    for (var i = 0; i < 5; i++) {\n        //this.dots[i].setStyle(\"opacity\", (Math.sin(((Math.PI*1.5)/5)*i+timeDelta*Math.PI*2)*60+20)+\"%\");\n        this.dots[i].setStyle('opacity', (Math.sin(((Math.PI*1.5)/5)*i-timeDelta*Math.PI*2)*0.6+0.2));\n    }\n\n    var map = this.ui.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var stats = map.getStats();\n\n    if ((stats['surfaces'] == 0 && stats['freeLayers'] == 0) ||  //nothing to load \n        ((timer - this.time) > 7000) || //loading takes too long\n        (stats['downloading'] == 0 && stats['lastDownload'] > 0 && (timer - stats['lastDownload']) > 1000) || //or everything loaded\n        (stats['bestMeshTexelSize'] != 0 && stats['bestMeshTexelSize'] <= (stats['texelSizeFit'] * 3) || //or resolution is good enough\n        (stats['loadMode'] == 'fit' || stats['loadMode'] == 'fitonly') && (stats['drawnTiles'] - stats['drawnGeodataTiles']) > 1) ) { //or at leas some tiles are loaded\n        this.hide();\n        this.ui.browser.callListener('loading-screen-hidden', {});\n    }\n};\n\n\nexport default UIControlLoading;\n","\nimport Dom_ from '../../utility/dom';\nimport {utils as utils_} from '../../../core/utils/utils';\nimport {vec3 as vec3_} from '../../../core/utils/matrix';\n\n//get rid of compiler mess\nvar dom = Dom_,\n    utils = utils_,\n    vec3 = vec3_,\n    UIControlMeasureIcon = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAA2lpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wTU09Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9tbS8iIHhtbG5zOnN0UmVmPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvc1R5cGUvUmVzb3VyY2VSZWYjIiB4bWxuczp4bXA9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC8iIHhtcE1NOk9yaWdpbmFsRG9jdW1lbnRJRD0ieG1wLmRpZDpkNjI1MjFjMi1mYzE5LTcyNDUtOTI5My1kNTU3MmE5N2E1MjgiIHhtcE1NOkRvY3VtZW50SUQ9InhtcC5kaWQ6ODJGRUI2NzE2NzkwMTFFN0EzRUZFNzQ1NEFCMkVFQUQiIHhtcE1NOkluc3RhbmNlSUQ9InhtcC5paWQ6ODJGRUI2NzA2NzkwMTFFN0EzRUZFNzQ1NEFCMkVFQUQiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjRBMjkwN0JENjc4QzExRTc5QTQwRjk4NjQzOEI4RDczIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjRBMjkwN0JFNjc4QzExRTc5QTQwRjk4NjQzOEI4RDczIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+k3ySjQAAAdJJREFUeNrclk0oBGEYgHemjZOLm8tSyt9BqT2I1O7JSdSSkpsDxZGLi5MTjn5K4SDh4OfiaPfkIDebOPiPUqKUiLKet96pzzT7MztxMPX0le+b95n3Z2ZZmUwm9NuXHfqLK1smsVhsED5hKkhswc4mYJmHVxgNIvIslyE4hnLYDSqycwiaoCGVSnUFFdk5BH2wKHtBRbYKqlVwbQhGoNU5GETkZHKpggjMqaBFhaGgIltv/mKphRuQss1oZkPuG4oRWTLHlmU5fSlhOYNKSEK7xIUugj+6hmSHpROm2RvL9Q7arqf80IykdDEdgll4IWi/Bm+ECT8Z2R7l+DBKV6N/PoRnEbBuwIKf0nm+8S7RGuzDLaxLMuw/5OuR+bn60ROPt9/pUUQnUEa6A56SyeSWeTYejzs9GkC8ZIpySjxEy1APbdCM6MAlGmeZdIahYIlLVAU9kIA7KZFxrJrA5+bU8RBjBf+eGD26gk0oI4AItiU4dMOqHh+GTylbQT3JU7oj2IMLmNBJrIATKIUoD5L2LfEQJbRPvXAP0iPZj5J92vNl9Fk6mSCZsBV4dwuyflb8XJrRqX6C3iDsFhSdiXOzZlSnwxD2yuBHJv/iX6JvAQYAPSICqA82OnoAAAAASUVORK5CYII=',\n    UIControlMeasureIcon2 = 'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAABkAAAAZCAYAAADE6YVjAAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAyFpVFh0WE1MOmNvbS5hZG9iZS54bXAAAAAAADw/eHBhY2tldCBiZWdpbj0i77u/IiBpZD0iVzVNME1wQ2VoaUh6cmVTek5UY3prYzlkIj8+IDx4OnhtcG1ldGEgeG1sbnM6eD0iYWRvYmU6bnM6bWV0YS8iIHg6eG1wdGs9IkFkb2JlIFhNUCBDb3JlIDUuNS1jMDIxIDc5LjE1NDkxMSwgMjAxMy8xMC8yOS0xMTo0NzoxNiAgICAgICAgIj4gPHJkZjpSREYgeG1sbnM6cmRmPSJodHRwOi8vd3d3LnczLm9yZy8xOTk5LzAyLzIyLXJkZi1zeW50YXgtbnMjIj4gPHJkZjpEZXNjcmlwdGlvbiByZGY6YWJvdXQ9IiIgeG1sbnM6eG1wPSJodHRwOi8vbnMuYWRvYmUuY29tL3hhcC8xLjAvIiB4bWxuczp4bXBNTT0iaHR0cDovL25zLmFkb2JlLmNvbS94YXAvMS4wL21tLyIgeG1sbnM6c3RSZWY9Imh0dHA6Ly9ucy5hZG9iZS5jb20veGFwLzEuMC9zVHlwZS9SZXNvdXJjZVJlZiMiIHhtcDpDcmVhdG9yVG9vbD0iQWRvYmUgUGhvdG9zaG9wIENDIChXaW5kb3dzKSIgeG1wTU06SW5zdGFuY2VJRD0ieG1wLmlpZDo2Nzg3NzczMzY3OEMxMUU3QjU2QUUxNTNCNzc4MzVBQiIgeG1wTU06RG9jdW1lbnRJRD0ieG1wLmRpZDo2Nzg3NzczNDY3OEMxMUU3QjU2QUUxNTNCNzc4MzVBQiI+IDx4bXBNTTpEZXJpdmVkRnJvbSBzdFJlZjppbnN0YW5jZUlEPSJ4bXAuaWlkOjY3ODc3NzMxNjc4QzExRTdCNTZBRTE1M0I3NzgzNUFCIiBzdFJlZjpkb2N1bWVudElEPSJ4bXAuZGlkOjY3ODc3NzMyNjc4QzExRTdCNTZBRTE1M0I3NzgzNUFCIi8+IDwvcmRmOkRlc2NyaXB0aW9uPiA8L3JkZjpSREY+IDwveDp4bXBtZXRhPiA8P3hwYWNrZXQgZW5kPSJyIj8+owD8TQAAAepJREFUeNrcls8rBGEYx993lIMfxR4kF/+AKMqBg7K1ajelLEWK025tKOTnjVykuAklNgcHuzmQg4MiTtz4Aza3TeGActDr+45nZt41s7tmBwdbn2l35933M9/3eead5UII9tsvjf3FK2uSiGgBKdDtZW6JllXA2DG4A3teRM7LZQl2QRuY9irScghGQRXb5KteRVoOQSMY0895FGkk8JHgSBH0gllzpAeRkeSRBAEwQIIZUJMxukARly3GOZdpivA5DnpAM2iQ5zFx3KE55DIugT6cT+a7PTTlKt9xHAT74AzU6vWJiEVQ4iWR9uXHhkgu3QhYB/JK3zBZE6WoBkE3Ivt9YolOQBd9uwJedQFjC+A8XyJ1J3G+4zNFV+CCmmMejINnY8sQG0wVzZnFlnW2Fd55ezGaIUAtPgzqwAsmv8mYMCLW8DaqdyY1g73w+RMFQRh0glse1RtDHRvDcdJp6XInsScKU3u3gnukSfCoOcoH0YPa3jif/P7zxEqUoPqUkWBZ398YqwdTNHqLdu+YuyTONToEl+AaTIAhUE61qwTtuJC0e4klkssQAn7QTy3+BA5AhRQgfdoovHvJp6iYli5EdTqlBKZA7a7CJFaiHdABUqBUFfyMxBJt06PBrwpskn/xl+hDgAEAH0j0b9rsgVUAAAAASUVORK5CYII=';\n\n\nvar UIControlMeasure = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.browser = ui.browser;\n    this.control = this.ui.addControl('measure',\n      '<div id=\"vts-measure\" class=\"vts-measure\">'\n\n        + '<img id=\"vts-measure-button\"'\n          + ' class=\"vts-measure-button\"'\n          + ' src=\"' + UIControlMeasureIcon + '\">'\n\n        + '<img id=\"vts-measure-button2\"'\n          + ' class=\"vts-measure-button\"'\n          + ' src=\"' + UIControlMeasureIcon2 + '\">'\n\n        + '<div id=\"vts-measure-text-holder\" class=\"vts-measure-text-holder\">'\n            + '<div class=\"vts-measure-text-holder2\">'\n                + '<div class=\"vts-measure-text\">'\n                  + '<textarea id=\"vts-measure-text-input\" rows=\"10\" cols=\"67\" wrap=\"hard\"></textarea>'\n                + '</div>'\n                + '<div class=\"vts-measure-tools\">'\n                    + '<div id=\"vts-measure-position\" class=\"vts-measure-tools-button\">Position</div>'\n                    + '<div id=\"vts-measure-length\" class=\"vts-measure-tools-button\">Length</div>'\n                    + '<div id=\"vts-measure-track\" class=\"vts-measure-tools-button\">Track Length</div>'\n                    + '<div id=\"vts-measure-area\" class=\"vts-measure-tools-button\">Area</div>'\n                    + '<div id=\"vts-measure-volume\" class=\"vts-measure-tools-button\">Volume</div>'\n                    + '<div id=\"vts-measure-clear\" class=\"vts-measure-tools-button\">Clear Log</div>'\n                    + '<div id=\"vts-measure-metric\" class=\"vts-measure-tools-button\">Units: Meters</div>'\n                + '</div>'\n            + '</div>'\n        + '</div>'\n\n        + '<div id=\"vts-measure-info\" class=\"vts-measure-info\">'\n        + '</div>'\n\n        + '<div id=\"vts-measure-buttons\" class=\"vts-measure-compute\">'\n            + '<div id=\"vts-measure-undo\" class=\"vts-measure-tools-button\">Undo</div>'\n            + '<div id=\"vts-measure-compute\" class=\"vts-measure-tools-button\">Compute</div>'\n        + '</div>'\n        \n     + ' </div>', visible, visibleLock);\n     \n    this.div = this.control.getElement('vts-measure');\n\n    this.buttonOff = this.control.getElement('vts-measure-button');\n    this.buttonOff.on('click', this.onSwitch.bind(this));\n    this.buttonOff.on('dblclick', this.onDoNothing.bind(this));\n\n    this.buttonOn = this.control.getElement('vts-measure-button2');\n    this.buttonOn.on('click', this.onSwitch.bind(this));\n    this.buttonOn.on('dblclick', this.onDoNothing.bind(this));\n\n    this.info = this.control.getElement('vts-measure-info');\n    this.compute = this.control.getElement('vts-measure-buttons');\n\n    var computeButton = this.control.getElement('vts-measure-undo');\n    computeButton.on('click', this.onCompute.bind(this, 0));\n    computeButton.on('dblclick', this.onDoNothing.bind(this));\n    computeButton = this.control.getElement('vts-measure-compute');\n    computeButton.on('click', this.onCompute.bind(this, 1));\n    computeButton.on('dblclick', this.onDoNothing.bind(this));\n\n    var clearButton = this.control.getElement('vts-measure-clear');\n    clearButton.on('click', this.onClear.bind(this));\n    clearButton.on('dblclick', this.onDoNothing.bind(this));\n\n    this.toolButtons = [];\n    var toolButton = this.control.getElement('vts-measure-position');\n    toolButton.on('click', this.onTool.bind(this, 0));\n    toolButton.on('dblclick', this.onDoNothing.bind(this));\n    this.toolButtons.push(toolButton);\n    toolButton = this.control.getElement('vts-measure-length');\n    toolButton.on('click', this.onTool.bind(this, 1));\n    toolButton.on('dblclick', this.onDoNothing.bind(this));\n    this.toolButtons.push(toolButton);\n    toolButton = this.control.getElement('vts-measure-track');\n    toolButton.on('click', this.onTool.bind(this, 2));\n    toolButton.on('dblclick', this.onDoNothing.bind(this));\n    this.toolButtons.push(toolButton);\n    toolButton = this.control.getElement('vts-measure-area');\n    toolButton.on('click', this.onTool.bind(this, 3));\n    toolButton.on('dblclick', this.onDoNothing.bind(this));\n    this.toolButtons.push(toolButton);\n    toolButton = this.control.getElement('vts-measure-volume');\n    toolButton.on('click', this.onTool.bind(this, 4));\n    toolButton.on('dblclick', this.onDoNothing.bind(this));\n    this.toolButtons.push(toolButton);\n    toolButton = this.control.getElement('vts-measure-metric');\n    toolButton.on('click', this.onTool.bind(this, 5));\n    toolButton.on('dblclick', this.onDoNothing.bind(this));\n    this.toolButtons.push(toolButton);\n    this.metricButton = toolButton;\n\n\n    this.measuring = false;\n    this.counter = 1;\n    this.renderCounter = 1;\n    this.lastCoords = null;\n    this.navCoords = null;\n    this.tool = 0;\n    this.metric = true;\n    this.mapUpdateDestructor = null;\n\n    this.listPanel = this.control.getElement('vts-measure-text-holder');\n    this.list = this.control.getElement('vts-measure-text-input');\n\n    if (this.measuring) {\n        this.buttonOn.setStyle('display', 'block');\n        this.buttonOff.setStyle('display', 'none');\n    } else {\n        this.buttonOn.setStyle('display', 'none');\n        this.buttonOff.setStyle('display', 'block');\n    }    \n\n    this.onMouseMoveCall = this.onMouseMove.bind(this);\n    this.onMouseLeaveCall = this.onMouseLeave.bind(this);\n    this.onMouseClickCall = this.onMouseClick.bind(this);\n    this.onMapUpdateCall = this.onMapUpdate.bind(this);\n\n    this.update();\n};\n\n\nUIControlMeasure.prototype.onDoNothing = function(event) {\n    dom.stopPropagation(event);    \n};\n\n\nUIControlMeasure.prototype.onMouseLeave = function(event) {\n    this.info.setStyle('display', 'none');\n};\n\n\nUIControlMeasure.prototype.onMouseClick = function(event) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var mapElement = this.ui.getMapElement();\n    var state = mapElement.getDraggingState();\n\n    //if (state['dragging']) { //TODO: why does not work this parameter? Fix it once you have time\n      //  return;\n    //}\n    var delta = state['absMoved'];\n\n    if ((delta[0]+delta[1]) > 0) {\n        return;\n    }\n\n    var coords = event.getMouseCoords();\n    var clickCoords = map.getHitCoords(coords[0], coords[1], 'fix');\n\n    map.redraw();\n\n    if (!clickCoords) {\n        return;\n    }\n\n    var i, li, res, str;\n    var space = '  ';\n\n    for (i = 0, li = ('' + this.counter).length; i < li; i++) {\n        space += ' ';\n    }\n\n    if (this.tool == 0) {\n        this.navCoords = clickCoords;\n        clickCoords = map.convertCoordsFromNavToPublic(clickCoords, 'fix');\n\n        str = '------------------------------------------------------\\n';\n        str += '#' + this.counter + ' Position: ';\n        str += '\\n' + space + clickCoords[0].toFixed(7) + ', ' + clickCoords[1].toFixed(7) + ', ' + this.getTextNumber(clickCoords[2]);\n        this.counter++;\n\n    } else if (this.tool == 1) { \n        if (!this.navCoords || this.navCoords.length == 2) {\n            this.navCoords = [clickCoords];\n            clickCoords = map.convertCoordsFromNavToPublic(clickCoords, 'fix');\n\n            str = '------------------------------------------------------\\n';\n            str += '#' + this.counter + ' Length: ';\n            str += '\\n' + space + 'p1: ' + clickCoords[0].toFixed(7) + ', ' + clickCoords[1].toFixed(7) + ', ' + this.getTextNumber(clickCoords[2]);\n        } else {\n            this.navCoords.push(clickCoords);\n            clickCoords = map.convertCoordsFromNavToPublic(clickCoords, 'fix');\n            \n            str = space + 'p2: ' + clickCoords[0].toFixed(7) + ', ' + clickCoords[1].toFixed(7) + ', ' + this.getTextNumber(clickCoords[2]);\n            str += '\\n' + space + '------------------------';\n\n            res = map.getDistance(this.lastCoords, clickCoords, false, true);\n            str += '\\n' +  space + 'great-circle distance: ' + this.getTextNumber(res[0]);\n            str += '\\n' + space + 'euclidean distance: ' + this.getTextNumber(res[2]);\n            str += '\\n' + space + 'elevation difference: ' + this.getTextNumber(clickCoords[2] - this.lastCoords[2]);\n            str += '\\n' + space + 'azimuth: ' + res[1].toFixed(2) + ' deg';\n\n            this.counter++;\n        }\n    } else if (this.tool == 2) { \n        if (this.renderCounter != this.counter) {\n            this.renderCounter = this.counter;\n            this.onTool(2);\n        }\n\n        if (!this.navCoords) {\n            this.navCoords = [clickCoords];\n            clickCoords = map.convertCoordsFromNavToPublic(clickCoords, 'fix');\n            str = '------------------------------------------------------\\n';\n            str += '#' + this.counter + ' Track Length: ';\n            str += '\\n' + space + 'p1: ' + clickCoords[0].toFixed(7) + ', ' + clickCoords[1].toFixed(7) + ', ' + this.getTextNumber(clickCoords[2]);\n        } else {\n            this.navCoords.push(clickCoords);\n            clickCoords = map.convertCoordsFromNavToPublic(clickCoords, 'fix');\n\n            str = space + 'p' + this.navCoords.length + ': ' + clickCoords[0].toFixed(7) + ', ' + clickCoords[1].toFixed(7) + ', ' + this.getTextNumber(clickCoords[2]);\n        }\n    } else if (this.tool == 3 || this.tool == 4) { \n        if (this.renderCounter != this.counter) {\n            this.renderCounter = this.counter;\n            this.onTool(this.tool);\n        }\n\n        if (!this.navCoords) {\n            this.navCoords = [clickCoords];\n            clickCoords = map.convertCoordsFromNavToPublic(clickCoords, 'fix');\n            str = '------------------------------------------------------\\n';\n            str += '#' + this.counter + ((this.tool == 3) ? ' Area: ' : ' Volume: ');\n            str += '\\n' + space + 'p1: ' + clickCoords[0].toFixed(7) + ', ' + clickCoords[1].toFixed(7) + ', ' + this.getTextNumber(clickCoords[2]);\n        } else {\n            this.navCoords.push(clickCoords);\n            clickCoords = map.convertCoordsFromNavToPublic(clickCoords, 'fix');\n\n            str = space + 'p' + this.navCoords.length + ': ' + clickCoords[0].toFixed(7) + ', ' + clickCoords[1].toFixed(7) + ', ' + this.getTextNumber(clickCoords[2]);\n        }\n    }\n\n    this.lastCoords = clickCoords;\n\n    if (str) {\n        var listElement = this.list.getElement();\n        listElement.value += str + '\\n';\n        listElement.scrollTop = listElement.scrollHeight;    //scroll list to the last line\n    }\n};\n\n\nUIControlMeasure.prototype.onMouseMove = function(event) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var coords = event.getMouseCoords();\n    var clickCoords = map.getHitCoords(coords[0], coords[1], 'fix');\n\n    if (!clickCoords) {\n        this.info.setStyle('display', 'none');\n        return;    \n    }\n\n    clickCoords = map.convertCoordsFromNavToPublic(clickCoords, 'fix');\n\n    var str = clickCoords[0].toFixed(7) + ', ' + clickCoords[1].toFixed(7) + ', ' + this.getTextNumber(clickCoords[2]);\n\n    coords[0] -= this.divRect.left;\n    coords[1] -= this.divRect.top;\n\n    this.info.setStyle('display', 'block');\n    this.info.setStyle('left', (coords[0]+20)+'px');\n    this.info.setStyle('top', (coords[1]+10)+'px');\n    this.info.setHtml(str);\n};\n\n\nUIControlMeasure.prototype.onSwitch = function() {\n    this.measuring = !this.measuring;\n\n    var mapElement = this.ui.getMapElement();\n\n    if (this.measuring) {\n        this.buttonOn.setStyle('display', 'block');\n        this.buttonOff.setStyle('display', 'none');\n\n        this.divRect = this.div.getRect();\n\n        mapElement.on('mousemove', this.onMouseMoveCall);\n        mapElement.on('mouseleave', this.onMouseLeaveCall);\n        mapElement.on('click', this.onMouseClickCall);\n        this.mapUpdateDestructor = this.browser.on('map-update', this.onMapUpdateCall);\n\n    } else {\n        this.buttonOn.setStyle('display', 'none');\n        this.buttonOff.setStyle('display', 'block');\n\n        mapElement.off('mousemove', this.onMouseMoveCall);\n        mapElement.off('mouseleave', this.onMouseLeaveCall);\n        mapElement.off('click', this.onMouseClickCall);\n        \n        if (this.mapUpdateDestructor) {\n            this.mapUpdateDestructor();\n        }\n    }\n\n    this.onTool(this.tool);\n\n    this.compute.setStyle('display', 'none');\n\n    var map = this.browser.getMap();\n    if (map) {\n        map.redraw();\n    }\n\n    this.update();\n};\n\n\nUIControlMeasure.prototype.onTool = function(tool) {\n    if (tool == 5) {\n        this.metric = !this.metric;\n        this.metricButton.setHtml(this.metric ? 'Units: Meters' : 'Units: Feets');\n        return;\n    }\n\n    this.tool = tool;\n    this.navCoords = null;\n\n    this.compute.setStyle('display', 'none');\n\n    for (var i = 0; i < 5; i++) {\n        this.toolButtons[i].setClass('vts-measure-tools-button');\n    }\n\n    this.toolButtons[tool].setClass('vts-measure-tools-button-selected');\n\n    var map = this.browser.getMap();\n    if (map) {\n        map.redraw();\n    }\n};\n\n\nUIControlMeasure.prototype.onCompute = function(button) {\n    if (!this.navCoords) {\n        return;\n    }\n\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var str, i, li, space;\n    var listElement = this.list.getElement();\n\n    if (button == 0) { //undo button\n        this.navCoords.pop();\n    } else { //compute button\n        if (this.tool == 2) {\n\n            var distance = 0;\n            var distance2 = 0, coords, coords2, res;\n            var emin = Number.POSITIVE_INFINITY;\n            var emax = Number.NEGATIVE_INFINITY;\n\n            space = '  ';\n\n            for (i = 0, li = ('' + this.counter).length; i < li; i++) {\n                space += ' ';\n            }\n\n            str = space + '------------------------';\n\n            for (i = 0, li = this.navCoords.length; i < li; i++) {\n                coords = map.convertCoordsFromNavToPublic(this.navCoords[i], 'fix');\n\n                if (coords[2] > emax) {\n                    emax = coords[2];\n                }\n\n                if (coords[2] < emin) {\n                    emin = coords[2];\n                }\n            }\n\n            for (i = 0, li = this.navCoords.length - 1; i < li; i++) {\n                coords = map.convertCoordsFromNavToPublic(this.navCoords[i], 'fix');\n                coords2 = map.convertCoordsFromNavToPublic(this.navCoords[i+1], 'fix');\n                res = map.getDistance(coords, coords2, false, true);\n                distance += res[0];\n                distance2 += res[2];\n            }\n\n            str += '\\n' +  space + 'great-circle distance: ' + this.getTextNumber(distance);\n            str += '\\n' + space + 'euclidean distance: ' + this.getTextNumber(distance2);\n            str += '\\n' + space + 'max elevation: ' + this.getTextNumber(emax);\n            str += '\\n' + space + 'min elevation: ' + this.getTextNumber(emin);\n            str += '\\n' + space + 'elevation difference: ' + this.getTextNumber(emax - emin);\n\n            this.counter++;\n        }\n\n        if (this.tool == 3) {\n            console.log(JSON.stringify(this.navCoords));\n\n            var geodata = map.createGeodata();\n            geodata.addPolygon3(this.navCoords, [], null, 'fix', {}, 'tmp-polygon');\n            geodata.processHeights('node-by-lod', 62, (function(){\n\n                space = '  ';\n\n                for (i = 0, li = ('' + this.counter).length; i < li; i++) {\n                    space += ' ';\n                }\n\n                str = space + '------------------------';\n\n                var poly = geodata.extractGeometry('tmp-polygon');\n\n                var area = poly.getSurfaceArea()\n\n                if (this.metric) {\n                    str += '\\n' +  space + 'area: ' + area.toFixed(2) + ' m\\u00B2';\n\n                    if (area > 100) {\n                        str += '\\n' +  space + '      ' + (area/100).toFixed(2) + ' ares';\n                    }\n\n                    if (area > 10000) {\n                        str += '\\n' +  space + '      ' + (area/10000).toFixed(2) + ' hectares';\n                    }\n\n                    if (area > 1000000) {\n                        str += '\\n' +  space + '      ' + (area/1000000).toFixed(2) + ' km\\u00B2';\n                    }\n                } else {\n                    //str += '\\n' +  space + 'area: ' + (area / 0.09290304).toFixed(2) + ' ft²';\n                    str += '\\n' +  space + 'area: ' + (area / 0.83612736).toFixed(2) + ' yd\\u00B2';\n\n                    if ((area / 4046.8564224) >= 1) {\n                        str += '\\n' +  space + '      ' + (area / 4046.8564224).toFixed(2) + ' acres';\n                    }\n                    \n                    if ((area / 2589988.110346) >= 1) {\n                        str += '\\n' +  space + '      ' + (area / 2589988.110346).toFixed(2) + ' mi\\u00B2';\n                    }\n                }\n\n                this.counter++;\n\n            }).bind(this));\n        }\n\n        if (this.tool == 4) {\n\n            var center = [0,0,0];\n\n            for (i = 0, li = this.navCoords.length; i < li; i++) {\n                coords = map.convertCoordsFromNavToPhys(this.navCoords[i], 'fix');\n                center[0] += coords[0];\n                center[1] += coords[1];\n                center[2] += coords[2];\n            }\n\n            center[0] /= li;\n            center[1] /= li;\n            center[2] /= li;\n\n            var radius = 0, dx, dy, dz, distance;\n\n            for (i = 0, li = this.navCoords.length; i < li; i++) {\n                coords = map.convertCoordsFromNavToPhys(this.navCoords[i], 'fix');\n                dx = (center[0] - coords[0]);\n                dy = (center[1] - coords[1]);\n                dz = (center[2] - coords[2]);\n                distance = Math.sqrt(dx*dx + dy*dy + dz*dz);\n\n                if (distance > radius) {\n                    radius = distance;\n                }\n            }\n\n            var geodata = map.createGeodata();\n\n            if (radius > 30000) {\n                geodata.addPolygon3(this.navCoords, [], null, 'fix', {}, 'tmp-polygon');\n            } else {\n                geodata.addPolygon(this.navCoords, [], null, 'fix', {}, 'tmp-polygon');\n            }\n\n            geodata.processHeights('node-by-lod', 62, (function(){\n\n            if (this.navCoords.length) {\n\n                space = '  ';\n\n                for (i = 0, li = ('' + this.counter).length; i < li; i++) {\n                    space += ' ';\n                }\n\n                str = space + '------------------------';\n\n                var poly = geodata.extractGeometry('tmp-polygon');\n\n                var faces = new Array(poly.getElements());\n\n                for (i = 0, li = faces.length; i < li; i++) {\n                    faces[i] = poly.getElement(i);\n                }\n\n                var renderer = this.browser.getRenderer();\n                var x, y, north, east;\n\n                coords = map.convertCoordsFromPhysToNav(center, 'fix');\n\n                var texelSize = radius * 0.0030; //0.15 texel size for 100m diameter \n                var core = this.browser.getCore();\n\n                var traceVolumeCall = (function(terrain){\n\n                    str = listElement.value;\n                    str = str.substr(0, str.lastIndexOf('loading data ...'));\n                    str += 'computation progress: 0%';\n\n                    if (!terrain) {\n                        str += '\\n some error ocurred. Try it again.';\n                        return;\n                    }\n\n                    var octree = renderer.buildOctreeFromGeometry(terrain);\n\n                    var ned = map.getNED(coords, false);\n                    north = ned.direction;\n                    east = ned.east;\n\n                    var steps = 25, l, sx, sy, res2, dir = [0,0,0], delta;\n                    var sampleArea = (1.0 / steps) * radius;\n                    var volumeAbove = 0;\n                    var volumeBelow = 0;\n\n                    sampleArea *= sampleArea;\n\n                    var y = -steps;\n\n                    var traceVolumeLine = (function(){\n\n                        for (x = -steps; x <= steps; x++) {\n\n                            sx = (1.0 / steps) * x * radius;\n                            sy = (1.0 / steps) * y * radius;\n                            coords[0] = center[0] * 1.0001 + north[0] * sy + east[0] * sx;\n                            coords[1] = center[1] * 1.0001 + north[1] * sy + east[1] * sx;\n                            coords[2] = center[2] * 1.0001 + north[2] * sy + east[2] * sx;\n\n                            vec3.normalize(coords, dir); // TODO: add support for projected systems\n                            dir[0] = -dir[0];\n                            dir[1] = -dir[1];\n                            dir[2] = -dir[2];\n\n                            res = this.hitFaces(coords, dir, faces);\n\n                            if (res[0]) {\n                                res2 = renderer.raycastOctreeGeometry(octree, coords, dir);\n\n                                if (res2.length > 0) {\n                                    delta = (res[1] - res2[0]) * sampleArea;\n\n                                    if (delta >= 0) {\n                                        volumeAbove += delta;\n                                    } else {\n                                        volumeBelow += -delta;\n                                    }\n\n                                    ///console.log(\"T\" + JSON.stringify(res2));\n                                }\n                            }\n                        }\n\n                        if (y < steps) {\n                            str = str.substr(0, str.lastIndexOf('computation progress:'));\n                            str += 'computation progress: ' + (((y + steps) / (steps*2))*100).toFixed(1) + ' %';\n                        } else {\n                            str = str.substr(0, str.lastIndexOf('computation progress:'));\n                            \n                            if (this.metric) {\n                                str += 'volume above: ' + volumeAbove.toFixed(2) + ' m\\u00B3';\n                                str += '\\n' +  space + 'volume below: ' + volumeBelow.toFixed(2) + ' m\\u00B3';\n                                str += '\\n' +  space + 'volume combined: ' + (volumeAbove + volumeBelow).toFixed(2) + ' m\\u00B3' + '\\n';\n                            } else {\n                                var yd2m = 0.764554857984;\n                                str += 'volume above: ' + (volumeAbove/yd2m).toFixed(2) + ' yd\\u00B3';\n                                str += '\\n' +  space + 'volume below: ' + (volumeBelow/yd2m).toFixed(2) + ' yd\\u00B3';\n                                str += '\\n' +  space + 'volume combined: ' + ((volumeAbove + volumeBelow)/yd2m).toFixed(2) + ' yd\\u00B3' + '\\n';\n                            }\n                        }\n\n                        if (str) {\n                            listElement.value = str;\n                            listElement.scrollTop = listElement.scrollHeight;    //scroll list to the last line\n                        }\n\n                        if (y < steps) {\n                            core.once('tick', traceVolumeLine, 1);\n                        }\n\n                        y++;\n\n                       //console.log(\"*\");\n                    }).bind(this);\n\n                    core.once('tick', traceVolumeLine, 1);\n\n                }).bind(this);\n\n                str += '\\n' +  space + 'loading data ...';\n                listElement.value += str;\n                listElement.scrollTop = listElement.scrollHeight;    //scroll list to the last line\n                str = null;\n\n                var destructor = map.getSurfaceAreaGeometry(coords, radius, 'texelSize', texelSize, traceVolumeCall, false);\n\n            }\n\n            }).bind(this));\n\n            this.counter++;\n        }\n    }\n\n    if (str) {\n        listElement.value += str + '\\n';\n        listElement.scrollTop = listElement.scrollHeight;    //scroll list to the last line\n    }\n\n    map.redraw();\n};\n\nUIControlMeasure.prototype.hitFace = function(origin, dir, face) {\n    var EPSILON = 0.0000001; \n    var v1 = face[0];\n    var v2 = face[1];  \n    var v3 = face[2];\n\n    var h = [0,0,0], q = [0,0,0], s;\n    var a,f,u,v;\n    var edge1 = [v2[0] - v1[0], v2[1] - v1[1], v2[2] - v1[2]];\n    var edge2 = [v3[0] - v1[0], v3[1] - v1[1], v3[2] - v1[2]];\n\n    vec3.cross(dir, edge2, h);\n    a = vec3.dot(edge1, h);\n\n    if (a > -EPSILON && a < EPSILON) {\n        return [false];\n    }\n\n    f = 1/a;\n    s = [origin[0] - v1[0], origin[1] - v1[1], origin[2] - v1[2]];\n    u = f * (vec3.dot(s, h));\n\n    if (u < 0.0 || u > 1.0) {\n        return [false];\n    }\n\n    q = vec3.cross(s, edge1);\n    v = f * vec3.dot(dir, q);\n    if (v < 0.0 || u + v > 1.0) {\n        return [false];\n    }\n\n    // At this stage we can compute t to find out where the intersection point is on the line.\n    var t = f * vec3.dot(edge2, q);\n    //if (t > EPSILON) { // ray intersection\n        return [true, t]; //[origin[0] + dir[0] * t, origin[1] + dir[1] * t, origin[2] + dir[2] * t ]];\n    //} else { // This means that there is a line intersection but not a ray intersection.\n     //   return [false];\n    //}\n};\n\n\nUIControlMeasure.prototype.hitFaces = function(coords, dir, faces) {\n    var hit = false, t = Number.POSITIVE_INFINITY;\n\n    for (var i = 0, li = faces.length; i < li; i++) {\n        var res = this.hitFace(coords, dir, faces[i]);\n\n        if (res[0]) {\n            hit = true;\n            \n            if (res[1] < t) {\n                t = res[1];\n            }\n        }\n    }\n\n    //console.log(hit ? (\"\" + t.toFixed(2)) : (\"N\"));\n    return [hit, t];\n};\n\n\nUIControlMeasure.prototype.onClear = function() {\n    this.counter = 1;\n    this.lastCoords = null;\n    this.navCoords = null;\n\n    var listElement = this.list.getElement();\n    listElement.value = '';\n    listElement.scrollTop = 0;\n\n    this.compute.setStyle('display', 'none');\n\n    var map = this.browser.getMap();\n    if (map) {\n        map.redraw();\n    }\n};\n\n\nUIControlMeasure.prototype.update = function() {\n    //var button = this.control.getElement('vts-measure-button');\n    \n    var left = 10 + (this.ui.config.controlZoom ? 70 : 0) +\n                (this.ui.config.controlSpace ? 35 : 0);\n    \n    this.div.setStyle('left', left + 'px');\n    this.listPanel.setStyle('display', this.measuring ? 'block' : 'none');\n};\n\n\nUIControlMeasure.prototype.onMapUpdate = function() {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var renderer = this.browser.getRenderer();\n\n    if (!this.circleImage) {\n        this.circleImage = utils.loadImage(\n                'data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAACAAAAAgCAYAAABzenr0AAAABmJLR0QAAAAAAAD5Q7t/AAAACW9GRnMAAAAgAAAA4ACD+EAUAAAACXBIWXMAAAsTAAALEwEAmpwYAAAA/UlEQVRYw+2VPwqDMBTG3dz1Am56EnH2XLroETxGuwc3Z7cOdhY8QJpfSUBspUvStJAPPggvD973/uQligICAgL+DKViqygUV02hbaXLwJlio7gpyhNu2idzEXwwgfI8H+u6vnZdN/V9P3EuimLcCRlsiyArGcfxjWDLsmzyAGzc4aNFNDZ7/iw7AeQH4LNrh5WZYLgkJTaZCyHuVVVdkiSZ0zSdOWMzlaBFWkRrQ4A4Zk/A4wBie1MFYUMAz0wybCYAmR8FUAlzj6+2r18TgM2VAO8tOB1Cyk7mrofQ+zP0voheVjHtIBjDxjrmvCu7k1Xs/TP6ie84ICDAGR5uCYdPo0MWiAAAAABJRU5ErkJggg==',\n                //\"http://maps.google.com/mapfiles/kml/shapes/placemarkcircle.png\",\n                (function(){\n                    this.circleTexture = renderer.createTexture({ 'source': this.circleImage });\n                }).bind(this)\n            );\n    }\n\n    if (!this.circleTexture) {\n        return;\n    }\n\n    var i, li, coords, points, wpoints;\n\n    switch(this.tool) {\n        case 0: //point\n\n            if (this.navCoords) {\n                coords = map.convertCoordsFromNavToCanvas(this.navCoords, \"fix\");\n\n                if (coords[2] <= 1) {\n                    renderer.drawImage({\n                        rect : [coords[0]-12, coords[1]-12, 24, 24],\n                        texture : this.circleTexture,\n                        color : [255,0,0,255],  //white point is multiplied by red color so resulting point will be red\n                        depth : coords[2],\n                        depthTest : false,\n                        blend : true   //point texture has alpha channel so blend is needed\n                        });\n                }\n            }\n\n            break;\n\n        case 1: //line\n        case 2: //track\n        case 3: //area\n        case 4: //volume\n\n            if (this.navCoords) {\n                points = [];\n\n                for (i = 0, li = this.navCoords.length; i < li; i++) {\n                    points.push(map.convertCoordsFromNavToCanvas(this.navCoords[i], \"fix\"));\n                }\n\n                if (li > 1) {\n\n                    var points2 = [], points3 = [], tmp;\n\n                    for (i = 0, li = this.navCoords.length - 1; i < li; i++) {\n                        tmp = map.getGeodesicLinePoints(this.navCoords[i], this.navCoords[i+1]);\n                        points2 = points2.concat(tmp);\n                    }\n\n                    if (this.tool == 3 || this.tool == 4) {\n                        tmp = map.getGeodesicLinePoints(this.navCoords[li], this.navCoords[0]);\n                        points2 = points2.concat(tmp);\n                    }\n\n                    for (i = 0, li = points2.length; i < li; i++) {\n                        points3.push(map.convertCoordsFromNavToPhys(points2[i], \"fix\", null, true));\n                    }\n\n                    renderer.drawLineString({\n                        points : points3,\n                        size : 5.0,\n                        color : [0,0,0,255],\n                        depthTest : false,\n                        //depthTest : true,\n                        //depthOffset : [-0.01,0,0],\n                        screenSpace : false,\n                        blend : false\n                        });\n\n                    renderer.drawLineString({\n                        points : points3,\n                        size : 2.0,\n                        color : [255,0,0,255],\n                        depthTest : false,\n                        //depthTest : true,\n                        //depthOffset : [-0.01,0,0],\n                        screenSpace : false,\n                        blend : false\n                        });\n                }\n\n                for (i = 0, li = points.length; i < li; i++) {\n                    coords = points[i];\n\n                    if (coords[2] <= 1) {\n                        renderer.drawImage({\n                            rect : [coords[0]-12, coords[1]-12, 24, 24],\n                            texture : this.circleTexture,\n                            color : [255,0,0,255],  //white point is multiplied by red color so resulting point will be red\n                            depth : coords[2],\n                            depthTest : false,\n                            blend : true   //point texture has alpha channel so blend is needed\n                            });\n                    }\n                }\n            }\n\n\n    }\n\n\n    if ((this.tool == 2 || this.tool == 3 || this.tool == 4) && points) {\n        if (points.length < 2 || this.renderCounter != this.counter) {\n            this.compute.setStyle('display', 'none');\n            return;    \n        }\n\n        coords = points[points.length - 1];\n        coords[0] -= this.divRect.left;\n        coords[1] -= this.divRect.top;\n\n        this.compute.setStyle('display', 'block');\n        this.compute.setStyle('left', (coords[0]+20)+'px');\n        this.compute.setStyle('top', (coords[1]+10)+'px');\n    }\n\n};\n\nUIControlMeasure.prototype.getTextNumber = function(value) {\n    var m2ft = 3.28084, km2mi = 0.621371;\n\n    if (value >= 100000) {\n        return (this.metric) ? (value*0.001).toFixed(2) + 'km' : (value*0.001*km2mi).toFixed(2) + 'mi';\n    } else {\n        return (this.metric) ? (value).toFixed(2) + 'm' : (value*m2ft).toFixed(2) + 'ft';\n    }\n};\n\nexport {UIControlMeasure , UIControlMeasureIcon, UIControlMeasureIcon2};\n\n","\nimport Dom_ from '../../utility/dom';\nimport {UIControlMeasureIcon as UIControlMeasureIcon_, UIControlMeasureIcon2 as UIControlMeasureIcon2_} from './measure';\n\n//get rid of compiler mess\nvar dom = Dom_,\n    UIControlMeasureIcon = UIControlMeasureIcon_,\n    UIControlMeasureIcon2 = UIControlMeasureIcon2_;\n\n\nvar UIControlMeasureLite = function(ui, visible, visibleLock) {\n    this.ui = ui;\n    this.browser = ui.browser;\n    this.control = this.ui.addControl('measure2',\n      '<div id=\"vts-measure\" class=\"vts-measure\">'\n\n        + '<img id=\"vts-measure-button\"'\n          + ' class=\"vts-measure-button\"'\n          + ' src=\"' + UIControlMeasureIcon + '\">'\n\n        + '<img id=\"vts-measure-button2\"'\n          + ' class=\"vts-measure-button\"'\n          + ' src=\"' + UIControlMeasureIcon2 + '\">'\n\n        + '<div id=\"vts-measure-text-holder\" class=\"vts-measure-text-holder\">'\n            + '<div class=\"vts-measure-text-holder2\">'\n                + '<div class=\"vts-measure-text\">'\n                  + '<textarea id=\"vts-measure-text-input\" rows=\"6\" cols=\"50\" wrap=\"hard\"></textarea>'\n                + '</div>'\n                + '<div class=\"vts-measure-tools\">'\n                    + '<div id=\"vts-measure-clear\" class=\"vts-measure-tools-button\">Clear</div>'\n                + '</div>'\n            + '</div>'\n        + '</div>'\n\n        + '<div id=\"vts-measure-info\" class=\"vts-measure-info\">'\n        + '</div>'\n        \n     + ' </div>', visible, visibleLock);\n     \n    this.div = this.control.getElement('vts-measure');\n\n    this.buttonOff = this.control.getElement('vts-measure-button');\n    this.buttonOff.on('click', this.onSwitch.bind(this));\n    this.buttonOff.on('dblclick', this.onDoNothing.bind(this));\n\n    this.buttonOn = this.control.getElement('vts-measure-button2');\n    this.buttonOn.on('click', this.onSwitch.bind(this));\n    this.buttonOn.on('dblclick', this.onDoNothing.bind(this));\n\n    this.info = this.control.getElement('vts-measure-info');\n\n    var clearButton = this.control.getElement('vts-measure-clear');\n    clearButton.on('click', this.onClear.bind(this));\n    clearButton.on('dblclick', this.onDoNothing.bind(this));\n\n    this.measuring = false;\n    this.counter = 1;\n    this.lastCoords = null;\n\n    this.listPanel = this.control.getElement('vts-measure-text-holder');\n    this.list = this.control.getElement('vts-measure-text-input');\n\n    if (this.measuring) {\n        this.buttonOn.setStyle('display', 'block');\n        this.buttonOff.setStyle('display', 'none');\n    } else {\n        this.buttonOn.setStyle('display', 'none');\n        this.buttonOff.setStyle('display', 'block');\n    }    \n\n    this.onMouseMoveCall = this.onMouseMove.bind(this);\n    this.onMouseLeaveCall = this.onMouseLeave.bind(this);\n    this.onMouseClickCall = this.onMouseClick.bind(this);\n\n    this.update();\n};\n\n\nUIControlMeasureLite.prototype.onDoNothing = function(event) {\n    dom.stopPropagation(event);    \n};\n\nUIControlMeasureLite.prototype.onMouseLeave = function(event) {\n    this.info.setStyle('display', 'none');\n};\n\n\nUIControlMeasureLite.prototype.onMouseClick = function(event) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var mapElement = this.ui.getMapElement();\n    var state = mapElement.getDraggingState();\n\n    //if (state['dragging']) { //TODO: why does not work this parameter? Fix it once you have time\n      //  return;\n    //}\n    var delta = state['absMoved'];\n\n    if ((delta[0]+delta[1]) > 0) {\n        return;\n    }\n\n    var coords = event.getMouseCoords();\n    var clickCoords = map.getHitCoords(coords[0], coords[1], 'fix');\n\n    if (!clickCoords) {\n        return;\n    }\n\n    clickCoords = map.convertCoordsFromNavToPublic(clickCoords, 'fix');\n\n    var str = '#' + this.counter + '  ' + clickCoords[0].toFixed(7) + ', ' + clickCoords[1].toFixed(7) + ', ' + clickCoords[2].toFixed(2) + 'm';\n\n    if (this.lastCoords) {\n        var res = map.getDistance(this.lastCoords, clickCoords, false, true);\n        var space = '\\n   ';\n\n        for (var i = 0, li = ('' + this.counter).length; i < li; i++) {\n            space += ' ';\n        }\n\n        str += space + 'great-circle distance: ';\n\n        if (res[0] > 100000) {\n            str += '' + (res[0]*0.001).toFixed(2) + 'km';\n        } else {\n            str += '' + res[0].toFixed(2) + 'm';\n        }\n\n        str += space + 'elevation difference: ' + (clickCoords[2] - this.lastCoords[2]).toFixed(2) + 'm';\n        str += space + 'euclidean distance: ';\n\n        if (res[2] > 100000) {\n            str += '' + (res[2]*0.001).toFixed(2) + 'km';\n        } else {\n            str += '' + res[2].toFixed(2) + 'm';\n        }\n    }\n\n    this.counter++;\n    this.lastCoords = clickCoords;\n\n    var listElement = this.list.getElement();\n    listElement.value += str + '\\n';\n    listElement.scrollTop = listElement.scrollHeight;    //scroll list to the last line\n};\n\nUIControlMeasureLite.prototype.onMouseMove = function(event) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var coords = event.getMouseCoords();\n    var clickCoords = map.getHitCoords(coords[0], coords[1], 'fix');\n\n    if (!clickCoords) {\n        this.info.setStyle('display', 'none');\n        return;    \n    }\n\n    clickCoords = map.convertCoordsFromNavToPublic(clickCoords, 'fix');\n\n    var str = clickCoords[0].toFixed(7) + ', ' + clickCoords[1].toFixed(7) + ', ' + clickCoords[2].toFixed(2) + 'm';\n\n    coords[0] -= this.divRect.left;\n    coords[1] -= this.divRect.top;\n\n    this.info.setStyle('display', 'block');\n    this.info.setStyle('left', (coords[0]+20)+'px');\n    this.info.setStyle('top', (coords[1]+10)+'px');\n    this.info.setHtml(str);\n};\n\nUIControlMeasureLite.prototype.onSwitch = function() {\n    this.measuring = !this.measuring;\n\n    var mapElement = this.ui.getMapElement();\n\n    if (this.measuring) {\n        this.buttonOn.setStyle('display', 'block');\n        this.buttonOff.setStyle('display', 'none');\n\n        this.divRect = this.div.getRect();\n\n        mapElement.on('mousemove', this.onMouseMoveCall);\n        mapElement.on('mouseleave', this.onMouseLeaveCall);\n        mapElement.on('click', this.onMouseClickCall);\n\n    } else {\n        this.buttonOn.setStyle('display', 'none');\n        this.buttonOff.setStyle('display', 'block');\n\n        mapElement.off('mousemove', this.onMouseMoveCall);\n        mapElement.off('mouseleave', this.onMouseLeaveCall);\n        mapElement.off('click', this.onMouseClickCall);\n    }\n\n    this.updateLink();\n    this.update();\n};\n\nUIControlMeasureLite.prototype.onClear = function() {\n    this.counter = 1;\n    this.lastCoords = null;\n\n    var listElement = this.list.getElement();\n    listElement.value = '';\n    listElement.scrollTop = 0;\n};\n\nUIControlMeasureLite.prototype.update = function() {\n    //var button = this.control.getElement('vts-measure-button');\n    \n    var left = 10 + (this.ui.config.controlZoom ? 70 : 0) +\n                (this.ui.config.controlSpace ? 35 : 0);\n    \n    this.div.setStyle('left', left + 'px');\n    this.listPanel.setStyle('display', this.measuring ? 'block' : 'none');\n};\n\n\nUIControlMeasureLite.prototype.updateLink = function() {\n    /*\n    var linkValue =  this.browser.getLinkWithCurrentPos();\n    if (this.list.getElement().value != linkValue) {\n        this.list.getElement().value = linkValue;\n    }*/\n};\n\n\nexport default UIControlMeasureLite;\n","\nimport Dom_ from '../utility/dom';\nvar dom = Dom_;\n\nimport {utils as utils_} from '../../core/utils/utils';\nvar utils = utils_;\n\nimport UIControlHolder_ from './control/holder';\nvar UIControlHolder = UIControlHolder_;\n\nimport UIControlMap_ from './control/map';\nvar UIControlMap = UIControlMap_;\n\nimport UIControlCompass_ from './control/compass';\nimport UIControlCredits_ from './control/credits';\nimport UIControlFullscreen_ from './control/fullscreen';\nimport UIControlZoom_ from './control/zoom';\nimport UIControlSpace_ from './control/space';\nimport UIControlSearch_ from './control/search';\nimport UIControlLink_ from './control/link';\nimport UIControlLayers_ from './control/layers';\nimport UIControlFallback_ from './control/fallback';\nimport UIControlPopup_ from './control/popup';\nimport UIControlLoading_ from './control/loading';\nimport { UIControlMeasure as UIControlMeasure_ }  from './control/measure';\nimport UIControlMeasureLite_ from './control/measure-lite';\n\n//get rid of compiler mess\nvar UIControlCompass = UIControlCompass_;\nvar UIControlCredits = UIControlCredits_;\nvar UIControlFullscreen = UIControlFullscreen_;\nvar UIControlZoom = UIControlZoom_;\nvar UIControlSpace = UIControlSpace_;\nvar UIControlSearch = UIControlSearch_;\nvar UIControlLink = UIControlLink_;\nvar UIControlMeasure = UIControlMeasure_;\nvar UIControlMeasureLite = UIControlMeasureLite_;\nvar UIControlLayers = UIControlLayers_;\nvar UIControlFallback = UIControlFallback_;\nvar UIControlPopup = UIControlPopup_;\nvar UIControlLoading = UIControlLoading_;\n\n\nvar UI = function(browser, element) {\n    this.browser = browser;\n    this.config = browser.config;\n    this.rootElement = element;\n    this.element = null;\n    this.controls = [];\n    this.killed = false;\n    this.init();\n    this.instanceId = utils.instanceCounter++;\n\n    Object.defineProperty(this, 'dom', {\n        get: function() {\n            if (this.killed) return;\n            return dom;\n        }\n    });    \n};\n\n\nUI.prototype.init = function() {\n    //create browser wrapper\n    this.element = document.createElement('div');\n    this.element.className = 'vts-browser';\n    this.rootElement.appendChild(this.element);\n\n    //create map cotrol\n    this.map = new UIControlMap(this);\n   \n    //create other ui controls\n    var loading = this.config.controlLoading;\n    this.compass = new UIControlCompass(this, (!loading && this.config.controlCompass), loading);\n    this.credits = new UIControlCredits(this, (!loading && this.config.controlCredits), loading);\n    //this.logo = new UIControlLogo(this, this.config.controlLogo);\n    this.fullscreen = new UIControlFullscreen(this, (!loading && this.config.controlFullscreen), loading);\n    this.zoom = new UIControlZoom(this, (!loading && this.config.controlZoom), loading);\n    this.space = new UIControlSpace(this, (!loading && this.config.controlSpace), loading);\n    this.search = new UIControlSearch(this, (!loading && this.config.controlSearch), loading);\n    this.link = new UIControlLink(this, (!loading && this.config.controlLink), loading);\n    this.measure = new UIControlMeasure(this, (!loading && this.config.controlMeasure), loading);\n    this.measure2 = new UIControlMeasureLite(this, (!loading && this.config.controlMeasureLite), loading);\n    //this.navigator = new UIControlNavigation(this, this.config.controlNavigator);\n    this.layers = new UIControlLayers(this, (!loading && this.config.controlLayers), loading);\n    this.fallback = new UIControlFallback(this);\n    this.popup = new UIControlPopup(this, false);\n    this.loading = new UIControlLoading(this, this.config.controlLoading);\n\n    dom.disableContexMenu(this.element);\n};\n\n\nUI.prototype.kill = function() {\n    this.killed = true;\n\n    for (var key in this.controls) {\n        delete this.controls[key];\n    }\n\n    this.rootElement.removeChild(this.element);\n    delete this.element;\n    this.element = null;\n};\n\n\nUI.prototype.addControl = function(id, html, visible, visibleLock, parentElement) {\n    var control = new UIControlHolder(this, html, visible, visibleLock, parentElement);\n    this.controls[id] = control;\n    return control;\n};\n\n\nUI.prototype.removeControl = function(id) {\n    if (this.controls[id] != null) {\n        delete this.controls[id];\n    }\n};\n\n\nUI.prototype.setControlHtml = function(id, html) {\n    if (this.controls[id] != null) {\n        this.controls[id].setHTML(html);\n    }\n};\n\n\nUI.prototype.setControlVisible = function(id, state, lockState) {\n    if (this.controls[id] != null) {\n        if (typeof lockState !== 'undefined') {\n            this.controls[id].setVisibleLock(lockState);\n        }\n\n        var renderer = this.browser.getRenderer();\n        var flags = renderer.getMarginFlags();\n\n        if (id == 'compass') flags |= 1;\n        if (id == 'search') flags |= 2;\n\n        if (this.config.bigScreenMargins) {\n            flags |= 4096;            \n        }\n\n        renderer.setMarginFlags(flags);\n       \n        this.controls[id].setVisible(state);\n    }\n};\n\n\nUI.prototype.getControlVisible = function(id) {\n    if (this.controls[id] != null) {\n        this.controls[id].getVisible();\n    }\n};\n\n\nUI.prototype.getControl = function(id) {\n    return this.controls[id];\n};\n\n\nUI.prototype.getMapControl = function() {\n    return this.map;\n};\n\n\nUI.prototype.getMapElement = function() {\n    return this.map.getMapElement();\n};\n\n\nUI.prototype.setParam = function(key) {\n    switch (key) {\n    case 'controlCompass':     this.setControlVisible('compass', this.config.controlCompass); break;\n    case 'controlZoom':        this.setControlVisible('zoom', this.config.controlZoom); break;\n        //case \"controlMeasure\":     this.setControlVisible(this.config.controlCompass); break;\n    case 'controlScale':       this.setControlVisible('scale', this.config.controlScale); break;\n    case 'controlLayers':      this.setControlVisible('layers', this.config.controlLayers); break;\n    case 'controlSpace':       this.setControlVisible('space', this.config.controlSpace); break;\n    case 'controlSearch':      this.setControlVisible('search', this.config.controlSearch); break;\n    case 'controlLink':        this.setControlVisible('link', this.config.controlLink); break;\n    case 'controlMeasure':     this.setControlVisible('measure', this.config.controlMeasure); break;\n    case 'controlLogo':        this.setControlVisible('logo', this.config.controlLogo); break;\n    case 'controlFullscreen':  this.setControlVisible('fullscreeen', this.config.controlFullscreen); break;\n    case 'controlCredits':     this.setControlVisible('credits', this.config.controlCredits); break;\n        //case \"controlLoading\":     this.setControlVisible(\"loading\", this.config.controlLogo); break;\n    }\n};\n\n\nUI.prototype.tick = function(dirty) {\n    if (dirty) {\n        this.compass.update();\n        this.space.update();\n        this.credits.update();\n        this.link.updateLink();                \n        this.search.update();\n    }\n\n    if (this.loading.control.getVisible()) {\n        this.loading.update();\n    }\n};\n\n\nexport default UI;\n\n\n","\n\nvar Autopilot = function(browser) {\n    this.browser = browser;\n    this.trajectory = [];\n    this.flightDuration = 1;\n    this.flightTime = 0;\n    this.trajectoryIndex = 0;\n    this.finished = true;\n    this.autoMovement = false;\n    this.autoRotate = 0;\n    this.autoPan = 0;\n    this.autoPanAzimuth = 0;\n\n    this.center = [0,0,0];\n    this.orientation = [0,0,0];\n    this.viewHeight = 0;\n    this.fov = 90;\n    this.lastTime = 0;\n};\n\n\nAutopilot.prototype.setAutorotate = function(speed) {\n    if (this.autoRotate != speed) {\n        this.browser.callListener('autorotate-changed', { 'autorotate' : speed});\n    }\n\n    this.autoRotate = speed;\n};\n\n\nAutopilot.prototype.getAutorotate = function() {\n    return this.autoRotate;\n};\n\n\nAutopilot.prototype.setAutopan = function(speed, azimuth) {\n    this.autoPan = speed;\n    this.autoPanAzimuth = azimuth;\n};\n\n\nAutopilot.prototype.getAutopan = function() {\n    return [this.autoPan, this.autoPanAzimuth];\n};\n\nAutopilot.prototype.flyToDAH = function(distance, azimuth, height, options) {\n    var map = this.browser.core.map;\n    if (!map) {\n        return;\n    }\n    \n    options = options || {};\n    \n    var trajectory = map.generatePIHTrajectory(map.getPosition(), distance, azimuth, height, options);\n    this.setTrajectory(trajectory, options['samplePeriod'] || 10, options); \n};\n\n\nAutopilot.prototype.flyTo = function(position, options) {\n    var map = this.browser.core.map;\n    if (!map) {\n        return;\n    }\n    \n    options = options || {};\n    var trajectory = map.generateTrajectory(map.getPosition(), position, options);\n    this.setTrajectory(trajectory, options['samplePeriod'] || 10, options); \n};\n\n\nAutopilot.prototype.flyTrajectory = function(trajectory, sampleDuration) {\n    this.setTrajectory(trajectory, sampleDuration || 10, {});\n};\n\n\nAutopilot.prototype.cancelFlight = function() {\n    this.browser.getControlMode().setCurrentControlMode(this.lastControlMode);\n    this.finished = true;\n};\n\n\nAutopilot.prototype.setTrajectory = function(trajectory, sampleDuration, options) {\n    if (trajectory == null || trajectory.length == 0) {\n        return;\n    }\n\n    this.setAutorotate(0);\n    this.setAutopan(0,0);\n\n    this.speed = options['speed'] || 1.0;\n    if (this.finished) {\n        this.lastControlMode = this.browser.getControlMode().getCurrentControlMode(); \n    }\n    this.browser.getControlMode().setCurrentControlMode('disabled');\n\n    this.trajectory = trajectory;\n    this.sampleDuration = sampleDuration;\n    //this.\n    \n    this.browser.callListener('fly-start', { 'startPosition' : this.trajectory[0],\n        'endPosition' : this.trajectory[this.trajectory.length - 1],\n        'options' : options\n    });\n    \n    this.timeStart = performance.now();\n    this.finished = false;\n};\n\n\nAutopilot.prototype.tick = function() {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var time = performance.now(), pos;\n    var timeFactor =  (time - this.lastTime) / 1000; \n    this.lastTime = time;\n\n    if (this.browser.ui && this.browser.ui.loading &&\n        this.browser.ui.loading.control.getVisible()) {\n        return;\n    }\n\n\n    if (this.autoRotate != 0) {\n        pos = map.getPosition();\n        var o = pos.getOrientation();\n        o[0] = (o[0] + this.autoRotate*timeFactor) % 360;\n        pos.setOrientation(o);\n        map.setPosition(pos);\n    }\n    \n    if (this.autoPan != 0) {\n        pos = map.getPosition();\n        pos = map.movePositionCoordsTo(pos, this.autoPanAzimuth, pos.getViewExtent()*(this.autoPan*0.01)*timeFactor, 0);\n        map.setPosition(pos);\n    }\n\n    if (this.finished || !this.trajectory) {\n        return;\n    }\n    \n    time = time - this.timeStart;\n    var sampleIndex =  Math.floor((time / this.sampleDuration)*this.speed);\n    var totalSamples = this.trajectory.length - 1; \n\n    if (sampleIndex < totalSamples) {\n        //interpolate\n        map.setPosition(this.trajectory[sampleIndex]);        \n        //console.log(JSON.stringify(this.trajectory[sampleIndex]));\n\n        this.browser.callListener('fly-progress', { 'position' : this.trajectory[sampleIndex],\n            'progress' : 100 * (sampleIndex / totalSamples)\n        });\n\n    } else {\n        map.setPosition(this.trajectory[totalSamples]);\n        //console.log(JSON.stringify(this.trajectory[totalSamples]));\n    } \n    \n    if (sampleIndex >= this.trajectory.length) {\n        this.browser.callListener('fly-end', { 'position' : this.trajectory[totalSamples] });\n\n        this.browser.getControlMode().setCurrentControlMode(this.lastControlMode);\n        this.finished = true;\n    } \n};\n\n\nAutopilot.prototype.generateTrajectory = function(p1, p2, options) {\n    var map = this.browser.core.map;\n    if (!map) {\n        return;\n    }\n    \n    options = options || {};\n    return map.generateTrajectory(p1, p2, options);\n};\n\n\nAutopilot.prototype.generatePIHTrajectory = function(position, azimuth, distance, options) {\n    var map = this.browser.core.map;\n    if (!map) {\n        return;\n    }\n    \n    options = options || {};\n    return map.generatePIHTrajectory(position, azimuth, distance, options);\n};\n\n\nexport default Autopilot;\n\n","\nvar ControlModeDisabled = function() {\n\n};\n\n\nexport default ControlModeDisabled;\n","\n\nimport {math as math_} from '../../core/utils/math';\n\n//get rid of compiler mess\nvar math = math_;\n\n\nvar ControlModePano = function(browser) {\n    this.browser = browser;\n    this.config = null;\n\n    this.center = [0, 0];\n    this.dragging = false;\n    this.velocity = [0, 0];\n\n    this.impulse = [0, 0];\n\n    this['drag'] = this.drag;\n    this['down'] = this.drag;\n    this['up'] = this.drag;\n    this['wheel'] = this.wheel;\n    this['tick'] = this.tick;\n    this['reset'] = this.reset;\n    this['keyup'] = this.keyup;\n    this['keydown'] = this.keydown;\n    this['keypress'] = this.keypress;\n};\n\n\nControlModePano.prototype.drag = function(event) {\n    if (!this.dragging) {\n        return;\n    }\n\n    var mouse = event.getMouseCoords();\n    var delta = [mouse[0] - this.center[0], mouse[1] - this.center[1]];\n    var sensitivity = 0.008;\n    this.velocity[0] = delta[0] * sensitivity;\n    this.velocity[1] = delta[1] * sensitivity;\n\n    this.impulse[0] = delta[0] * sensitivity;\n    this.impulse[1] = delta[1] * sensitivity;\n};\n\n\nControlModePano.prototype.down = function(event) {\n    if (event.getMouseButton() === 'left') {\n        this.center = event.getMouseCoords();\n        this.dragging = true;\n    }\n};\n\n\nControlModePano.prototype.up = function(event) {\n    if (event.getMouseButton() === 'left') {\n        this.dragging = false;\n    }\n};\n\n\nControlModePano.prototype.wheel = function(event) {\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n\n    var pos = map.getPosition();\n    var delta = event.getWheelDelta();\n\n    var factor = (delta > 0 ? -1 : 1) * 1;\n    pos.setViewExtent(math.clamp(pos.getViewExtent() + factor, 1, 179));\n\n    map.setPosition(pos);\n};\n\n\nControlModePano.prototype.keyup = function() {\n};\n\n\nControlModePano.prototype.keydown = function() {\n};\n\n\nControlModePano.prototype.keypress = function() {\n};\n\n\nControlModePano.prototype.tick = function() {\n    if (this.velocity[0] == 0.0 && this.velocity[1] == 0.0) {\n        return;\n    }\n\n    var map = this.browser.getMap();\n    if (!map) {\n        return;\n    }\n    \n    var pos = map.getPosition();\n    var coords = pos.getCoords();\n    coords[0] -= this.velocity[0];\n    coords[1] -= this.velocity[1];\n    pos.setCoords(coords);\n    map.setPosition(pos);\n\n    // friction\n    if (this.dragging) {\n        return;\n    }\n    var step = 0.9;\n    var treshold = 0.0005;\n\n    if (Math.abs(this.velocity[0]) < treshold) {\n        this.velocity[0] = 0.0;\n    } else {\n        this.velocity[0] *= step;\n    }\n\n    if (Math.abs(this.velocity[1]) < treshold) {\n        this.velocity[1] = 0.0;\n    } else {\n        this.velocity[1] *= step;\n    }\n};\n\n\nControlModePano.prototype.reset = function(config) {\n    this.config = config;\n};\n\n\nexport default ControlModePano;\n\n","\nimport ControlModeDisabled_ from './disabled';\nimport {ControlModeMapObserver as ControlModeMapObserver_} from './map-observer';\nimport ControlModePano_ from './pano';\n\n//get rid of compiler mess\nvar ControlModeDisabled = ControlModeDisabled_;\nvar ControlModeMapObserver = ControlModeMapObserver_;\nvar ControlModePano = ControlModePano_;\n\n\nvar ControlMode = function(browser) {\n    this.browser = browser;\n    this.ui = browser.ui;\n    this.mapControl = this.ui.getMapControl();\n    this.mapElement = this.mapControl.getMapElement();\n    this.altKey = false;\n    this.shiftKey = false;\n    this.ctrlKey = false;\n\n    this.mapElement.on('drag', this.onDrag.bind(this));\n    //this.mapElement.on('dragstart', this.onDragStart.bind(this));\n    //this.mapElement.on('dragend', this.onDragEnd.bind(this));\n    this.mapElement.on('mousedown', this.onDown.bind(this));\n    this.mapElement.on('mouseup', this.onUp.bind(this));\n    this.mapElement.on('mousewheel', this.onWheel.bind(this));\n    this.mapElement.on('keyup', this.onKeyUp.bind(this), window);\n    this.mapElement.on('keydown', this.onKeyDown.bind(this), window);\n    this.mapElement.on('keypress', this.onKeyPress.bind(this), window);\n    this.mapElement.on('dblclick', this.onDoubleClick.bind(this), window);\n    this.browser.on('tick', this.onTick.bind(this));\n\n    this.controlModes = {};\n    this.currentCotnrolModeId = 'map-observer';\n    this.currentControlMode = this.controlModes['map-observer'];\n\n    // default control modes\n    this.addControlMode('map-observer', new ControlModeMapObserver(browser));\n    this.addControlMode('disabled', new ControlModeDisabled());\n    this.addControlMode('pano', new ControlModePano(browser));\n\n    // use map observer mode as default\n    this.setDefaultControlMode();\n};\n\n\nControlMode.prototype.addControlMode = function(id, controller) {\n    this.controlModes[id] = controller;\n};\n\n\nControlMode.prototype.removeControlMode = function(id) {\n    if (id === this.currentCotnrolModeId) {\n        return;\n    }\n\n    delete this.controlModes[id];\n};\n\n\nControlMode.prototype.setCurrentControlMode = function(id, options) {\n    var newMode = this.controlModes[id];\n    if (!newMode) {\n        return;\n    }\n\n    // set new mode\n    this.currentControlModeId = id;\n    this.currentControlMode = newMode;\n\n    // call reset\n    if (newMode['reset']) {\n        newMode['reset'](options);\n    }\n};\n\n\nControlMode.prototype.setDefaultControlMode = function() {\n    this.setCurrentControlMode('map-observer');\n};\n\n\nControlMode.prototype.getCurrentControlMode = function() {\n    return this.currentControlModeId;\n};\n\nControlMode.prototype.getCurrentController = function() {\n    return this.currentControlMode;\n};\n\n// Event callbacks\n\nControlMode.prototype.onDrag = function(event) {\n    this.checkAutopilot();\n    if (this.currentControlMode['drag']) {\n        this.currentControlMode['drag'](event);\n    }\n};\n\n\nControlMode.prototype.onDown = function(event) {\n    this.checkAutopilot();\n    this.updateModifierKeys(event);\n    if (this.currentControlMode['down']) {\n        this.currentControlMode['down'](event);\n    }\n};\n\n\nControlMode.prototype.onUp = function(event) {\n    this.updateModifierKeys(event);\n    if (this.currentControlMode['up']) {\n        this.currentControlMode['up'](event);\n    }\n};\n\n\nControlMode.prototype.onWheel = function(event) {\n    this.checkAutopilot();\n    if (this.currentControlMode['wheel']) {\n        this.currentControlMode['wheel'](event);\n    }\n};\n\n\nControlMode.prototype.onKeyUp = function(event) {\n    this.updateModifierKeys(event);\n    if (this.currentControlMode['keyup']) {\n        this.currentControlMode['keyup'](event);\n    }\n};\n\n\nControlMode.prototype.onKeyDown = function(event) {\n    this.updateModifierKeys(event);\n    if (this.currentControlMode['keydown']) {\n        this.currentControlMode['keydown'](event);\n    }\n};\n\n\nControlMode.prototype.onKeyPress = function(event) {\n    this.updateModifierKeys(event);\n    if (this.currentControlMode['keypress']) {\n        this.currentControlMode['keypress'](event);\n    }\n};\n\n\nControlMode.prototype.onDoubleClick = function(event) {\n    this.updateModifierKeys(event);\n    if (this.currentControlMode['doubleclick']) {\n        this.currentControlMode['doubleclick'](event);\n    }\n};\n\n\nControlMode.prototype.onTick = function(event) {\n    if (this.currentControlMode['tick']) {\n        event.draggingState = this.mapElement.getDraggingState();    \n        this.currentControlMode['tick'](event);\n    }\n};\n\n\n// Private metod\nControlMode.prototype.updateModifierKeys = function(event) {\n    this.altKey = event.getModifierKey('alt');\n    this.shiftKey = event.getModifierKey('shift');\n    this.ctrlKey = event.getModifierKey('ctrl');\n    //console.log(\"alt:\" + this.altKey + \"  ctrl:\" + this.ctrlKey + \"  shift:\" + this.shiftKey);\n};\n\n\nControlMode.prototype.checkAutopilot = function() {\n    if (this.browser.autopilot) {\n        this.browser.autopilot.setAutorotate(0);\n        this.browser.autopilot.setAutopan(0,0);\n    }\n};\n\n\nexport default ControlMode;\n","\n\nvar Presenter = function(browser, config) {\n    this.container = null;\n    this.aTags = null;\n    this.sectionTags = null;\n    this.defaultHeight = 0; // Changes based on presentation\"s height\n    this.maxHeight = 0; // Height of inner container to be set\n    this.subtitlesHeights = []; // Set of heights after init() for subtitles\n\n    this.firstTitleMargin = 20; // First slide of presentation has some css margin-top, so here we use it\n    this.swipeOffset = 60; // Height of swipeControl\n\n    this.actualNode = 0;\n    this.maxNodes = 1;\n    this.animTime = 600; // Default css transition time\n    this.currentToolbox = 'right'; // Default toolbox (right | wide)\n\n    this.browser = browser;\n    this.id = [];\n    this.current = null;\n\n    this.presenter = (typeof config['presenter'] !== 'undefined') ? JSON.parse(JSON.stringify(config['presenter'])) : {};\n    this.presenterAutoplay = config['presenterAutoplay'];\n\n    if (typeof this.presenter !== 'undefined') {\n        this.playPresentation();\n    }\n};\n\n\nPresenter.prototype.addPresentation = function(id, source) {\n    if (Object.keys(this.presenter).length !== 0) {\n        this.presenter[id] = source;\n    } else if (typeof id !== 'undefined') {\n        this.presenter = {};\n        this.presenter[id] = source;\n    }\n};\n\n\nPresenter.prototype.removePresentation = function(id) {\n    if (typeof id !== 'undefined') {\n        if (this.getCurrentPresentation() == id) {\n            this.stopPresentation();\n            this.current = null;\n        }\n        delete this.presenter[id];\n        return('Removed presentation id: '+id);            \n    } else {\n        if (this.getCurrentPresentation() !== null) {\n            this.stopPresentation();\n        }\n        this.presenter = {}; // Remove all presentations\n        this.presenterAutoplay = '';\n        this.current = null;\n        return('All presentations removed.');\n    }\n};\n\n\nPresenter.prototype.getCurrentPresentation = function() {\n    return this.current;\n};\n\n\nPresenter.prototype.getCurrentPresentationType = function() {\n    return this.currentToolbox;\n};\n\n\nPresenter.prototype.playPresentation = function(id) {\n    this.stopPresentation();\n    if (this.presenterAutoplay !== undefined && typeof id === 'undefined') {\n        id = this.presenterAutoplay;\n    } else if (typeof id === 'undefined' && this.presenter !== undefined && Object.keys(this.presenter).length > 0) {\n        for (var key in this.presenter) {\n            id = key;\n            break;\n        }\n    }\n    \n    if (typeof id !== 'undefined' && Object.keys(this.presenter).indexOf(id) != -1) {\n        this.current = id;\n        this.readTextInput(id);\n        return true;\n    } else {\n        return false;\n    }\n};\n\n\nPresenter.prototype.stopPresentation = function() {\n    var current = this.getCurrentPresentation();\n    this.currentToolbox = 'right';\n    if (current !== null) {\n        this.current = null;\n        this.browser.ui.removeControl(current);\n        this.container.getElementsByTagName('article')[0].parentNode.parentNode.parentNode.remove();\n        return true;\n    }\n    return false;    \n};\n\n\nPresenter.prototype.listPresentations = function(id) {\n    if (Object.keys(this.presenter).length === 0) {\n        return [];\n    }\n    if (typeof id !== 'undefined') {\n        if (this.presenter[id] !== 'undefined') {\n            return this.presenter[id];\n        } else {\n            return null;\n        }\n    } else {\n        var tmp = [];\n        for (var key in this.presenter) {\n            tmp.push(key);\n        }\n        return tmp;\n    }\n};\n\n\nPresenter.prototype.initPresentation = function(id, HTMLtemplate) {\n    var obj = this;    \n    var templatePanelPrefix = '<div class=\"vts-presenter panelContainer\"><div class=\"vts-presenter swipeControl top\"></div><div class=\"vts-presenter toolboxContainer\">';\n    var templatePanelSuffix = '</div><div class=\"vts-presenter swipeControl\"></div></div>';\n    var templatePanel = templatePanelPrefix + HTMLtemplate + templatePanelSuffix;\n    var templateSubtitlesPrefix = '<div class=\"vts-presenter subtitlesContainer\"><button type=\"button\"></button><button type=\"button\"></button>'\n                                    + '<div class=\"vts-presenter swipeSubtitles\"><div><div></div></div></div><div class=\"vts-presenter swipeSubtitles\"><div><div></div></div></div><div class=\"vts-presenter innerContainer\">';\n    var templateSubtitlesSuffix = '</div></div>';\n    var templateSubtitles = templateSubtitlesPrefix + HTMLtemplate + templateSubtitlesSuffix;\n    var template = templatePanel + templateSubtitles;\n    var ctrlDelve = this.browser.ui.addControl(id, template);\n    this.id.push(id);\n    this.setContainer(ctrlDelve);\n\n    // Set all <a> tags to have onclick\n    this.aTags = this.container.getElementsByTagName('a');\n    for (var i = 0; i < this.aTags.length; i++) {\n        this.aTags[i].onclick = function() {\n            obj.linksDecode(this);\n        };\n    }\n    \n    setTimeout((function(){\n        this.renderControl();\n    }).bind(this), 200);\n};\n\n\nPresenter.prototype.readTextInput = function(id) {\n    var presentation = {\n        htmlDataStorage : this.presenter[id],\n        id : id,\n        checkID : function() {\n            var url = /^(ftp|http|https):\\/\\/[^ \"]+$/;\n            var relative = /.*\\/+.*/;\n            var level = /(\\.\\.\\/|\\.\\/)/g;\n            var hash = /^#.*$/;\n            var str = /(<article)/g;\n            if (str.test(this.htmlDataStorage)) {\n                return 'string';\n            } else if (url.test(this.htmlDataStorage)) {\n                return 'url';\n            } else if (relative.test(this.htmlDataStorage)) {\n                var getLevel;\n                var l = 0;\n                var split = '';\n                var loc = window.location.href.split('/');\n                var path = '';\n                while ((getLevel = level.exec(this.htmlDataStorage)) !== null) {\n                    split = split + getLevel[0];\n                    if (getLevel[0] === './') {\n                        break;     \n                    }\n                    l++;\n                }\n                l++;\n                for (var i = 0; i < (loc.length-l); i++) {\n                    path = path + loc[i] + '/';\n                }\n                path = path + this.htmlDataStorage.split(split)[1];\n                //console.log('Final path:');\n                //console.log(path);\n                this.htmlDataStorage = path;\n                return 'url';\n            } else if (hash.test(this.htmlDataStorage)) {\n                return 'hash';\n            } else {\n                return 'string';\n            }\n        }\n    };\n    \n    var mode = presentation.checkID();\n    \n    if (mode == 'url') {\n        var rawFile = new XMLHttpRequest();\n        //var obj = this;\n        rawFile.open('GET', presentation.htmlDataStorage, false);\n        rawFile.onreadystatechange = (function() {\n            if (rawFile.readyState === 4) {\n                if (rawFile.status === 200 || rawFile.status == 0) {\n                    var allText = rawFile.responseText;\n                    this.html = allText;\n                    this.initPresentation(presentation.id, this.html);\n                } else {\n                    this.file = 'undefined';\n                }\n            }\n        }).bind(this);\n        rawFile.send(null); \n    } else if (mode == 'hash') {\n        var obj = document.getElementById(presentation.htmlDataStorage).innerHTML;\n        this.initPresentation(presentation.id, obj);\n    } else if (mode == 'string') {\n        this.initPresentation(presentation.id, presentation.htmlDataStorage);\n    }\n};\n\n\nPresenter.prototype.linksDecode = function(obj) {\n    var position = null;\n    var autorotate = null;\n    var transition = null;\n    var navigate = null;\n    \n    if (obj.getAttribute('data-mln-navigate') !== null) {\n        navigate = obj.getAttribute('data-mln-navigate');\n        if (navigate !== null) {\n            if (navigate == 'prev') {\n                this.nextArticle('-1');\n            } else if (navigate == 'next') {\n                this.nextArticle('+1');\n            } else if (navigate == 'first') {\n                this.nextArticle(0);\n            } else if (navigate == 'last') {\n                this.nextArticle(this.maxNodes-1);\n            } else {\n                this.nextArticle(navigate);\n            }        \n            return 'navigation:true';\n        }\n    }\n    \n    if (obj.getAttribute('data-mln-position') === null){\n        return 'position:false';\n    }\n\n    position = this.getNumbers(obj.getAttribute('data-mln-position').split(','));\n    \n    if (obj.getAttribute('data-mln-autorotate') !== null) {\n        autorotate = this.getNumbers(obj.getAttribute('data-mln-autorotate'));\n    }\n    if (obj.getAttribute('data-mln-transition') !== null) {\n        transition = obj.getAttribute('data-mln-transition');\n    }\n    \n    if (transition === null) {\n        this.browser.autopilot.flyTo(position);\n    } else if (transition == 'teleport') {\n        this.browser.core.getMap().setPosition(position);\n    } else {\n        this.browser.autopilot.flyTo(position);\n        // Feature to be considered\n        // browser.flyTo(position, {mode : transition});\n    }\n    if (autorotate !== null) {\n        this.browser.autopilot.setAutorotate(autorotate);\n    }\n        \n    return 'Moving to position: ' + position;\n};\n\n\n// parseFloat here\nPresenter.prototype.getNumbers = function(obj) {\n    //var obj = obj;\n    for (var i = 0; i < obj.length; i++){\n        if (typeof obj == 'string' && parseFloat(obj)) {\n            obj = parseFloat(obj);\n            break;\n        }\n        if (parseFloat(obj[i])) {\n            obj[i] = parseFloat(obj[i]); // toFixed might be added here\n        }\n    }\n    return obj;\n};\n\n\nPresenter.prototype.nextArticle = function(node, init, lastNode) {\n    // fly to whatever node we wish\n    if (node === '+1') {\n        node = 1;\n    } else if (node === '-1') {\n        node = -1;\n    } else {\n        this.actualNode = node;\n        node = 0;\n    }\n    this.actualNode = this.actualNode + node;\n    \n    if (this.actualNode >= 0 && this.actualNode < this.maxNodes) {\n        if (!init) {\n            if (this.currentToolbox == 'right') {\n                this.handleArticle(this.actualNode);\n            } else if (this.currentToolbox == 'wide') {\n                this.handleSubtitlesPosition(this.actualNode);\n            }\n        }\n        if (typeof lastNode !== 'undefined') {\n            this.maxNodes = lastNode;\n        }\n        this.linksDecode(this.container.getElementsByTagName('section')[this.actualNode]);\n        return true;\n    \n    } else {\n        this.actualNode = this.actualNode - node;\n    }\n    return false;\n};\n\n\nPresenter.prototype.useToolbox = function() {\n    var type = this.container.getElementsByTagName('article')[0].getAttribute('data-mln-style');\n    \n    if (type === null) {\n        type = 'right';\n    }\n    \n    var rightPanel = this.container.getElementsByClassName('vts-presenter panelContainer')[0];\n    //var toolboxContainer = this.container.getElementsByClassName('vts-presenter toolboxContainer')[0];\n    var subtitles = this.container.getElementsByClassName('vts-presenter subtitlesContainer')[0];\n    var swipeControl = this.container.getElementsByClassName('vts-presenter swipeControl');\n    var i;\n    this.currentToolbox = type;\n    \n    subtitles.setAttribute('style', 'opacity: 0;');\n    subtitles.setAttribute('class', 'vts-presenter subtitlesContainer');\n    if (type == 'right') {\n        rightPanel.style.display = 'block';\n        setTimeout(function() {\n            rightPanel.style.opacity = 1;\n        }, 20);\n        swipeControl[0].style.display = 'block';\n        swipeControl[1].style.display = 'block';\n        for (i = 0; i < this.sectionTags.length; i++) { // Set maxHeight back as there is no dynamic rescaling of rightPanel\n            this.sectionTags[i].style.height = this.maxHeight + 'px';\n        }\n        this.nextArticle(0);\n    } else if (type == 'wide') {\n        subtitles.style.display = 'block';\n        setTimeout(function() {\n            subtitles.style.opacity = 1;\n        }, 20);\n        rightPanel.style.display = 'none';\n        rightPanel.style.opacity = 0;\n        swipeControl[0].style.display = 'none';\n        swipeControl[1].style.display = 'none';\n        for (i = 0; i < this.sectionTags.length; i++) { // Set height to auto so we can dynamicaly adjust subtitles height\n            this.sectionTags[i].style.height = 'auto';\n        }\n        this.handleSubtitlesPosition(0, true);\n    }\n};\n\n\nPresenter.prototype.setContainer = function(c) {\n    this.container = c.element;\n};\n\n\n// Rendering of DOM elements for Presenter\n\nPresenter.prototype.renderControl = function() {\n    // Set every <section> tag excluding the first one to not to be displayed\n    this.sectionTags = this.container.getElementsByClassName('vts-presenter toolboxContainer')[0].querySelectorAll('section');\n    \n    var swipeControlUp = this.container.getElementsByClassName('vts-presenter swipeControl')[0];\n    var swipeControlDw = this.container.getElementsByClassName('vts-presenter swipeControl')[1];\n\n    var nextButton = document.createElement('button');\n    nextButton.innerHTML = '<div><div></div></div>';\n    nextButton.setAttribute('type','button');\n    nextButton.setAttribute('class','vts-presenter-btnDw');\n    nextButton.onclick = (function(){\n        this.nextArticle('+1');\n    }).bind(this);\n        \n    var prevButton = document.createElement('button');\n    prevButton.innerHTML = '<div><div></div></div>';\n    prevButton.setAttribute('type','button');\n    prevButton.setAttribute('class','vts-presenter-btnUp');\n    prevButton.onclick = (function(){\n        this.nextArticle('-1');\n    }).bind(this);\n\n    // End of all buttons and other controllers\n    \n    swipeControlUp.appendChild(prevButton);\n    swipeControlDw.appendChild(nextButton);\n\n    this.getElementsTrueHeight(this.sectionTags);\n\n    var offsetTop = this.maxHeight + this.swipeOffset;\n\n    this.container.getElementsByClassName('vts-presenter panelContainer')[0].style.height = (offsetTop + this.swipeOffset) + 'px';\n    swipeControlDw.style.top = offsetTop +'px';\n    swipeControlUp.style.opacity = '1';\n    swipeControlDw.style.opacity = '1';\n    \n    // init now\n    setTimeout((function() {\n        this.useToolbox();\n    }).bind(this), this.animTime);\n    this.nextArticle(0, false, this.sectionTags.length);\n};\n\n\nPresenter.prototype.getElementsTrueHeight = function(elems) {\n    for (var i = 0; i < elems.length; i++) {\n        if (elems[i].offsetHeight > this.maxHeight) {\n            this.maxHeight = elems[i].offsetHeight;\n        }\n    }\n    \n    for (i = 0; i < elems.length; i++) {\n        elems[i].style.height = this.maxHeight + 'px';\n    }\n};\n\n\nPresenter.prototype.handleArticle = function(node) {\n    var rightPanel = this.container.getElementsByClassName('vts-presenter toolboxContainer')[0];\n    var btnUp = this.container.getElementsByClassName('vts-presenter-btnUp')[0];\n    var btnDw = this.container.getElementsByClassName('vts-presenter-btnDw')[0];\n\n    var articleClass = (function(a) {\n        this.container.getElementsByClassName('vts-presenter toolboxContainer')[0].querySelectorAll('article')[0].setAttribute('class',a);\n    }).bind(this);\n    \n    var actualHeight = this.maxHeight * this.actualNode * -1;\n    \n    btnUp.setAttribute('class','vts-presenter-btnUp');\n    btnDw.setAttribute('class','vts-presenter-btnDw');\n\n    if (node === 0) {\n        btnUp.setAttribute('class','vts-presenter-btnUp vts-presenter hidden');\n    } else if (node === this.maxNodes-1) {\n        btnDw.setAttribute('class','vts-presenter-btnDw vts-presenter hidden');\n    }\n        \n    this.container.getElementsByTagName('article')[0].setAttribute('style','top: '+actualHeight+'px');\n    \n    if (this.actualNode === 0) {\n        /* handle right panel stuff */\n        rightPanel.style.height = (this.maxHeight + this.swipeOffset) + 'px';\n        rightPanel.style.top = 0;\n        articleClass('vts-presenter');\n        /* done - now add some cosmetic attributes */\n        this.container.getElementsByClassName('vts-presenter swipeControl')[0].style.height = 0;\n        this.container.getElementsByTagName('article')[0].style.top = 0;\n        this.container.getElementsByTagName('section')[0].style.height = (this.maxHeight + (this.swipeOffset - this.firstTitleMargin)) + 'px';\n    } else {\n        /* handle right panel stuff */\n        rightPanel.style.height = this.maxHeight + 'px';\n        rightPanel.style.top = this.swipeOffset + 'px';\n        articleClass('vts-presenter nonFirst');\n        /* done - now add some cosmetic attributes */\n        this.container.getElementsByClassName('vts-presenter swipeControl')[0].style.height = this.swipeOffset + 'px';\n        this.container.getElementsByTagName('section')[0].style.height = (this.maxHeight + this.swipeOffset) + 'px';\n    }\n    return true;\n};\n\n\nPresenter.prototype.handleSubtitlesPosition = function(node, init) {\n    if (typeof node === 'undefined') {\n        node = 0;\n    }\n    \n    var subtitlesContainer = this.container.getElementsByClassName('vts-presenter subtitlesContainer')[0];\n    var leftButton = subtitlesContainer.childNodes[0];\n    var rightButton = subtitlesContainer.childNodes[1];\n    var sections = subtitlesContainer.childNodes[4].querySelectorAll('article')[0].querySelectorAll('section');\n    var swipeSubtitles = this.container.getElementsByClassName('vts-presenter swipeSubtitles');\n    \n    this.linksDecode(sections[node]);\n    \n    // clean all previous states\n    sections[node].removeAttribute('style');\n    subtitlesContainer.setAttribute('class','vts-presenter subtitlesContainer');\n    subtitlesContainer.removeAttribute('onclick');\n    swipeSubtitles[0].removeAttribute('onclick');\n    swipeSubtitles[1].removeAttribute('onclick');\n    swipeSubtitles[0].removeAttribute('style');\n    swipeSubtitles[1].removeAttribute('style');\n    leftButton.removeAttribute('onclick');\n    rightButton.removeAttribute('onclick');\n    leftButton.setAttribute('class', 'vts-presenter hidden');\n    rightButton.setAttribute('class', 'vts-presenter hidden');\n    \n    for (var i = 0; i < sections.length; i++) {\n        sections[i].style.opacity = 0;\n        if (this.subtitlesHeights[i] === undefined) {\n            sections[i].style.display = 'block';\n            this.subtitlesHeights[i] = sections[i].offsetHeight;\n            sections[i].style.display = 'none';\n        }\n        if (i !== node) {\n            this.hideSections(sections[i]);\n        }\n    }\n    this.showSections(sections[node]);\n    \n    var sectionType = sections[node].getAttribute('data-mln-style');\n    if (sectionType == undefined) {\n        sectionType = 'full';\n    }\n    \n    if (sectionType == 'full') {\n        swipeSubtitles[0].style.opacity = 0;\n        swipeSubtitles[1].style.opacity = 0;\n        swipeSubtitles[0].style.cursor = 'default';\n        swipeSubtitles[1].style.cursor = 'default';\n        \n        if (node === 0) {\n            leftButton.setAttribute('class', 'vts-presenter hidden');\n            rightButton.setAttribute('class', 'vts-presenter');\n            rightButton.onclick = (function() {\n                this.nextArticle(1);\n            }).bind(this);\n            rightButton.innerHTML = 'Continue';\n        } else if (node === sections.length - 2) { // One more before end\n            leftButton.setAttribute('class', 'vts-presenter');\n            leftButton.onclick = (function() {  \n                this.nextArticle('-1');\n            }).bind(this);\n            leftButton.innerHTML = 'Back';\n            rightButton.setAttribute('class', 'vts-presenter');\n            rightButton.onclick = (function() {  \n                this.nextArticle('+1');\n            }).bind(this);\n            rightButton.innerHTML = 'Explore';\n        }\n        if (typeof init === 'undefined') {\n            subtitlesContainer.setAttribute('style', 'display: block;');\n        }\n        subtitlesContainer.setAttribute('class','vts-presenter subtitlesContainer full');\n    } else if (sectionType == 'title') {\n        swipeSubtitles[0].style.opacity = 1;\n        swipeSubtitles[1].style.opacity = 1;\n        swipeSubtitles[0].onclick = (function() {\n            this.nextArticle('-1');\n        }).bind(this);\n        swipeSubtitles[1].onclick = (function() {\n            this.nextArticle('+1');\n        }).bind(this);\n        leftButton.setAttribute('class', 'vts-presenter hidden');\n        rightButton.setAttribute('class', 'vts-presenter hidden');\n        subtitlesContainer.style.height = this.subtitlesHeights[node] + 'px';\n        subtitlesContainer.setAttribute('class','vts-presenter subtitlesContainer title');\n       \n    } else if (sectionType == 'mini') {\n        subtitlesContainer.setAttribute('style', 'display: block;');\n        subtitlesContainer.setAttribute('class','vts-presenter subtitlesContainer mini');\n        leftButton.setAttribute('class', 'vts-presenter hidden');\n        rightButton.setAttribute('class', 'vts-presenter hidden');\n    }\n};\n\n\n\nPresenter.prototype.hideSections = function(elem) {\n    setTimeout(function() {\n        elem.style.display = 'none';\n    }, this.animTime);\n};\n\n\nPresenter.prototype.showSections = function(elem) {\n    setTimeout(function() {\n        elem.style.display = 'block';\n        setTimeout(function() {\n            elem.style.opacity = 1;\n        }, 50);    \n    }, this.animTime);\n};\n\n\nexport default Presenter;\n\n","// Basic class for requesting ROI servers. It hasn't any UI. Eg. Explore Bar\n// class has this class as ancestor.\n\n/**\n * @constructor\n */\n\nvar Rois = function(roiServers) {\n    this.roiServers = roiServers;\n};\n\n\n/**\n * roisAtPosition\n * Request rois intended for specific position\n * @param position position array \n * @param count number of requested rois\n * @param clb callback\n * @return Response promise object (if ES6 is supported otherwise null)\n */\nRois.prototype.roisAtPosition = function(/*position, count, clb*/) {\n    // TODO request ROI server\n    // ROI gravity must be defined before implementation\n};\n\n\nexport default Rois;\n\n","\nimport {checkSupport as checkSupport_} from '../core/core';\nimport {CoreInterface as CoreInterface_} from '../core/interface';\nimport {utils as utils_} from '../core/utils/utils';\nimport UI_ from './ui/ui';\nimport Autopilot_ from './autopilot/autopilot';\nimport ControlMode_ from './control-mode/control-mode';\nimport Presenter_ from './presenter/presenter';\nimport Rois_ from './rois/rois';\n\n//get rid of compiler mess\nvar CoreInterface = CoreInterface_;\nvar utils = utils_;\nvar UI = UI_;\nvar Autopilot = Autopilot_;\nvar ControlMode = ControlMode_;\nvar Presenter = Presenter_;\nvar Rois = Rois_;\nvar checkSupport = checkSupport_;\n\n\nvar Browser = function(element, config) {\n    this.killed = false;\n    this.configStorage = {};\n    this.initConfig();\n    this.setConfigParams(config, true);\n    this.originalConfig = JSON.parse(JSON.stringify(config));\n    \n    this.element = (typeof element === 'string') ? document.getElementById(element) : element; \n    this.ui = new UI(this, this.element);\n\n    element = (typeof element !== 'string') ? element : document.getElementById(element);\n\n    if (!checkSupport()) {\n        this.ui.setControlVisible('fallback', true);\n        return;\n    }\n\n    this.core = new CoreInterface(this.ui.getMapControl().getMapElement().getElement(), config);\n\n    if (this.core == null) {\n        this.ui.setControlVisible('fallback', true);\n        return;\n    }\n    \n    this.updatePosInUrl = false;\n    this.lastUrlUpdateTime = false;\n    this.mapLoaded = false;\n    this.mapInteracted = false;\n\n    this.autopilot = new Autopilot(this);\n    this.rois = new Rois(this);\n    this.controlMode = new ControlMode(this, this.ui);\n    this.presenter = new Presenter(this, config);\n\n    this.on('map-loaded', this.onMapLoaded.bind(this));\n    this.on('map-unloaded', this.onMapUnloaded.bind(this));\n    this.on('map-update', this.onMapUpdate.bind(this));\n    this.on('map-position-changed', this.onMapPositionChanged.bind(this));\n    this.on('map-position-fixed-height-changed', this.onMapPositionFixedHeightChanged.bind(this));\n    this.on('map-position-panned', this.onMapPositionPanned.bind(this));\n    this.on('map-position-rotated', this.onMapPositionRotated.bind(this));\n    this.on('map-position-zoomed', this.onMapPositionZoomed.bind(this));\n        \n    this.on('tick', this.onTick.bind(this));\n};\n\n\nBrowser.prototype.kill = function() {\n    this.ui.kill();\n    this.killed = true;\n};\n\n\nBrowser.prototype.getCore = function() {\n    return this.core;\n};\n\n\nBrowser.prototype.getMap = function() {\n    return this.core ? this.core.map : null;\n};\n\n\nBrowser.prototype.getRenderer = function() {\n    return this.core ? this.core.renderer : null;\n};\n\n\nBrowser.prototype.getProj4 = function() {\n    return this.core ? this.core.proj4 : null;\n};\n\n\nBrowser.prototype.getUI = function() {\n    return this.ui;\n};\n\n\nBrowser.prototype.setControlMode = function(mode) {\n    this.controlMode = mode;\n};\n\n\nBrowser.prototype.getControlMode = function() {\n    return this.controlMode;\n};\n\n\nBrowser.prototype.on = function(name, listener) {\n    return this.core.on(name, listener);\n};\n\n\nBrowser.prototype.callListener = function(name, event) {\n    this.core.callListener(name, event);\n};\n\n\nBrowser.prototype.onMapLoaded = function(event) {\n    this.mapLoaded = true;\n\n    //overwrite browser options\n    var options = event['browserOptions'] || {};\n    var originalOptions = this.originalConfig;\n    for (var key in originalOptions) {\n        if (typeof options[key] !== 'undefined') {\n            options[key] = originalOptions[key]; \n        } \n    }    \n    \n    this.setConfigParams(options);\n\n    if (this.config.geojson || this.config.geodata) {\n        var data = this.config.geojson || this.config.geodata;\n\n        if (typeof data === 'string') {\n            data = data.trim();\n           \n            if (data.charAt(0) == '{') {\n                try {\n                    data = JSON.parse(data);\n                    this.onGeoJsonLoaded(data);\n                } catch(e){ }\n            } else {\n                utils.loadJSON(data, this.onGeoJsonLoaded.bind(this));\n            }\n        }\n    }\n\n    if (this.autopilot) {\n        this.autopilot.setAutorotate(this.config.autoRotate);\n        this.autopilot.setAutopan(this.config.autoPan[0], this.config.autoPan[1]);\n    }\n};\n\n\nBrowser.prototype.getLinkWithCurrentPos = function() {\n    var map = this.getMap();\n    if (!map) {\n        return '';\n    }\n\n    //get url params\n    var params = utils.getParamsFromUrl(window.location.href);\n    \n    //get position string\n    var p = map.getPosition();\n    p = map.convertPositionHeightMode(p, 'fix', true);\n    \n    var s = '';\n    s += p.getViewMode() + ',';\n    var c = p.getCoords();\n    s += c[0].toFixed(6) + ',' + c[1].toFixed(6) + ',' + p.getHeightMode() + ',' + c[2].toFixed(2) + ',';\n    var o = p.getOrientation();\n    s += o[0].toFixed(2) + ',' + o[1].toFixed(2) + ',' + o[2].toFixed(2) + ',';\n    s += p.getViewExtent().toFixed(2) + ',' + p.getFov().toFixed(2);\n\n    //replace old value with new one    \n    params['pos'] = s;\n\n    if (this.mapInteracted) {\n        if (params['rotate'] || this.getConfigParam('rotate')) {\n            params['rotate'] = '0';\n        }\n        \n        var pan = this.getConfigParam('pan');\n        if (params['pan'] || (pan && (pan[0] || pan[1]))) {\n            params['pan'] = '0,0';\n        }\n    }\n    \n    //convert prameters to url parameters string\n    s = '';\n    for (var key in params) {\n        s += ((s.length > 0) ? '&' : '') + key + '=' + params[key];\n    }\n\n    //separete base url and url params\n    var urlParts = window.location.href.split('?');\n    \n    if (urlParts.length > 1) {\n        var extraParts = urlParts[1].split('#'); //is there anchor?\n        return urlParts[0] + '?' + s + (extraParts[1] || ''); \n    } else {\n        return urlParts[0] + '?' + s; \n    }\n};\n\n\nBrowser.prototype.onMapPositionChanged = function() {\n    if (this.config.positionInUrl) {\n        this.updatePosInUrl = true;\n    }\n};\n\n\nBrowser.prototype.onMapPositionPanned = function() {\n    this.mapInteracted = true;\n};\n\n\nBrowser.prototype.onMapPositionRotated = function() {\n    this.mapInteracted = true;\n};\n\n\nBrowser.prototype.onMapPositionZoomed = function() {\n    this.mapInteracted = true;\n};\n\n\nBrowser.prototype.onMapPositionFixedHeightChanged = function() {\n    if (this.config.positionInUrl) {\n        this.updatePosInUrl = true;\n    }\n};\n\n\nBrowser.prototype.onMapUnloaded = function() {\n};\n\n\nBrowser.prototype.onMapUpdate = function() {\n    this.dirty = true;\n};\n\n\nBrowser.prototype.onGeoJsonLoaded = function(data) {\n    var map = this.getMap();\n    var geodata = map.createGeodata();\n\n    var addFreeLayer = (function(){\n        var freeLayer = geodata.makeFreeLayer(this.config.geojsonStyle);\n        map.addFreeLayer('geojson', freeLayer);\n        var view = map.getView();\n        view.freeLayers.geojson = {};\n        map.setView(view);\n    }).bind(this)\n\n    if (this.config.geodata) {\n        geodata.importVTSGeodata(data);\n        addFreeLayer();\n    } else {\n        geodata.importGeoJson(data);\n        geodata.processHeights('node-by-precision', 62, addFreeLayer);\n    }\n};\n\n\nBrowser.prototype.onTick = function() {\n    if (this.killed) {\n        return;\n    }\n\n    this.autopilot.tick();\n    this.ui.tick(this.dirty);\n    this.dirty = false;\n    \n    if (this.updatePosInUrl) {\n        var timer = performance.now(); \n        if ((timer - this.lastUrlUpdateTime) > 1000) {\n            if (window.history.replaceState) {\n                window.history.replaceState({}, null, this.getLinkWithCurrentPos());\n            }        \n            this.updatePosInUrl = false;\n            this.lastUrlUpdateTime = timer;\n        }\n    }\n};\n\n\nBrowser.prototype.initConfig = function() {\n    this.config = {\n        panAllowed : true,\n        rotationAllowed : true,\n        zoomAllowed : true,\n        jumpAllowed : false,\n        sensitivity : [1, 0.06, 0.05],\n        inertia : [0.81, 0.9, 0.7],\n        timeNormalizedInertia : false, // legacy inertia [0.8,0.8,0.8] sensitivity [0.5,0.4]\n        legacyInertia : false, // legacy inertia [0.8,0.8,0.8] sensitivity [0.5,0.4]\n        positionInUrl : false,\n        positionUrlHistory : false,\n        constrainCamera : true,\n        navigationMode : 'azimuthal',\n        controlCompass : true,\n        controlZoom : true,\n        controlSpace : true,\n        controlSearch : true,\n        controlSearchSrs : null,\n        controlSearchUrl : null,\n        controlSearchFilter : false,\n        controlMeasure : false,\n        controlMeasureLite : false,\n        controlLink : false,\n        controlGithub : false,\n        controlScale : true,\n        controlLayers : false,\n        controlCredits : true,\n        controlFullscreen : false,\n        controlLoading : true,\n        searchElement : null,\n        searchValue : null,\n        walkMode : false,\n        fixedHeight : 0,\n        geojson : null,\n        tiltConstrainThreshold : [0.5,1],\n        bigScreenMargins : false, //75,\n        minViewExtent : 20, //75,\n        maxViewExtent : Number.MAXINTEGER,\n        autoRotate : 0,\n        autoPan : [0,0]\n    };\n};\n\n\nBrowser.prototype.setConfigParams = function(params, ignoreCore) {\n    if (typeof params === 'object' && params !== null) {\n        for (var key in params) {\n            this.setConfigParam(key, params[key], ignoreCore);\n\n            /*if (!(key == \"pos\" || key == \"position\" || key == \"view\" ||\n                key.indexOf(\"map\") == 0 || key.indexOf(\"renderer\") == 0)) {\n                this.configStorage[key] = params[key];\n            }*/\n        }\n    }\n};\n\n\nBrowser.prototype.updateUI = function(key) {\n    if (this.ui == null) {\n        return;\n    }\n\n    this.ui.setParam(key);\n};\n\n\nBrowser.prototype.setConfigParam = function(key, value, ignoreCore) {\n    var map = this.getMap();\n\n    switch (key) {\n    case 'pos':                \n    case 'position':\n        this.config.position = value;\n        if (map) {\n            map.setPosition(this.config.position);\n        }\n        break;\n            \n    case 'view':\n        this.config.view = value;\n        if (map) {\n            map.setView(this.config.view);\n        }\n        break;\n\n    case 'panAllowed':             this.config.panAllowed = utils.validateBool(value, true);           break;\n    case 'rotationAllowed':        this.config.rotationAllowed = utils.validateBool(value, true);      break;\n    case 'zoomAllowed':            this.config.zoomAllowed = utils.validateBool(value, true);          break;\n    case 'jumpAllowed':            this.config.jumpAllowed = utils.validateBool(value, false);         break;\n    case 'constrainCamera':        this.config.constrainCamera = utils.validateBool(value, true);      break;\n    case 'navigationMode':         this.config.navigationMode = value;                                 break;\n    case 'positionInUrl':          this.config.positionInUrl = utils.validateBool(value, false);       break;\n    case 'positionUrlHistory':     this.config.positionUrlHistory = utils.validateBool(value, false);  break;\n    case 'controlCompass':         this.config.controlCompass = utils.validateBool(value, true); this.updateUI(key);    break;\n    case 'controlZoom':            this.config.controlZoom = utils.validateBool(value, true); this.updateUI(key);       break;\n    case 'controlMeasure':         this.config.controlMeasure = utils.validateBool(value, false); this.updateUI(key);   break;\n    case 'controlScale':           this.config.controlScale = utils.validateBool(value, true); this.updateUI(key);      break;\n    case 'controlLayers':          this.config.controlLayers = utils.validateBool(value, false); this.updateUI(key);    break;\n    case 'controlSpace':           this.config.controlSpace = utils.validateBool(value, false); this.updateUI(key);     break;\n    case 'controlSearch':          this.config.controlSearch = utils.validateBool(value, false); this.updateUI(key);    break;\n    case 'controlSearchUrl':       this.config.controlSearchUrl = value;    break;\n    case 'controlSearchSrs':       this.config.controlSearchSrs = value;    break;\n    case 'controlSearchFilter':    this.config.controlSearchFilter = utils.validateBool(value, true);  break;\n    case 'controlSearchElement':   this.config.controlSearchElement = value; this.updateUI(key);  break;\n    case 'controlSearchValue':     this.config.controlSearchValue = /*utils.validateString(*/value/*, null)*/; this.updateUI(key); break;\n    case 'controlLink':            this.config.controlLink = utils.validateBool(value, false); this.updateUI(key);        break;\n    case 'controlGithub':          this.config.controlGithub = utils.validateBool(value, false); this.updateUI(key);      break;\n    case 'controlMeasure':         this.config.controlMeasure = utils.validateBool(value, false); this.updateUI(key);     break;\n    case 'controlMeasureLite':     this.config.controlMeasureLite = utils.validateBool(value, false); this.updateUI(key); break;\n    case 'controlLogo':            this.config.controlLogo = utils.validateBool(value, false); this.updateUI(key);        break;\n    case 'controlFullscreen':      this.config.controlFullscreen = utils.validateBool(value, true); this.updateUI(key);   break;\n    case 'controlCredits':         this.config.controlCredits = utils.validateBool(value, true); this.updateUI(key);      break;\n    case 'controlLoading':         this.config.controlLoading = utils.validateBool(value, true); this.updateUI(key);      break;\n    case 'minViewExtent':          this.config.minViewExtent = utils.validateNumber(value, 0.01, Number.MAXINTEGER, 100); break;\n    case 'maxViewExtent':          this.config.maxViewExtent = utils.validateNumber(value, 0.01, Number.MAXINTEGER, Number.MAXINTEGER); break;\n    case 'sensitivity':            this.config.sensitivity = utils.validateNumberArray(value, 3, [0,0,0], [10, 10, 10], [1, 0.12, 0.05]); break;\n    case 'inertia':                this.config.inertia = utils.validateNumberArray(value, 3, [0,0,0], [0.99, 0.99, 0.99], [0.85, 0.9, 0.7]); break;\n    case 'legacyInertia':          this.config.legacyInertia = utils.validateBool(value, false); break;\n    case 'timeNormalizedInertia':  this.config.timeNormalizedInertia = utils.validateBool(value, false); break;\n    case 'bigScreenMargins':       this.config.bigScreenMargins = utils.validateBool(value, false); break;\n    case 'tiltConstrainThreshold': this.config.tiltConstrainThreshold = utils.validateNumberArray(value, 2, [0.5,1], [-Number.MAXINTEGER, -Number.MAXINTEGER], [Number.MAXINTEGER, Number.MAXINTEGER]); break;\n    case 'walkMode':               this.config.walkMode = utils.validateBool(value, false); break;\n    case 'fixedHeight':            this.config.fixedHeight = utils.validateNumber(value, -Number.MAXINTEGER, Number.MAXINTEGER, 0); break;\n    case 'geodata':                this.config.geodata = value; break;\n    case 'geojson':                this.config.geojson = value; break;\n    case 'geojsonStyle':           this.config.geojsonStyle =  JSON.parse(value); break;\n    case 'rotate':             \n        this.config.autoRotate = utils.validateNumber(value, Number.NEGATIVE_INFINITY, Number.POSITIVE_INFINITY, 0);\n        if (map && this.autopilot) {\n            this.autopilot.setAutorotate(this.config.autoRotate);\n        }\n        break;\n    case 'pan':\n        if (Array.isArray(value) && value.length == 2){\n            this.config.autoPan = [\n                utils.validateNumber(value[0], Number.NEGATIVE_INFINITY, Number.POSITIVE_INFINITY, 0),\n                utils.validateNumber(value[1], -360, 360, 0)\n            ];\n        }\n\n        if (map && this.autopilot) {\n            this.autopilot.setAutorotate(this.config.autoRotate);\n        }\n        break;\n    }\n\n    if (ignoreCore) {\n        if ((key.indexOf('map') == 0 || key.indexOf('mario') == 0 || key.indexOf('authorization') == 0) && map) {\n            map.setConfigParam(key, value);\n        }\n\n        if (key.indexOf('renderer') == 0 && this.getRenderer()) {\n            this.getRenderer().setConfigParam(key, value);\n        }\n\n        if (key.indexOf('debug') == 0 && this.core) {\n            this.core.setConfigParam(key, value);\n        }\n\n    }\n};\n\n\nBrowser.prototype.getConfigParam = function(key) {\n    var map = this.getMap();\n\n    switch (key) {\n    case 'pos':\n    case 'position':\n        \n        if (map) {\n            map.getPosition();\n        } else {\n            return this.config.position;\n        }\n            \n        break;\n        \n    case 'view':               \n\n        if (map) {\n            return map.getView();\n        } else {\n            return this.config.view;\n        }\n            \n    case 'panAllowed':             return this.config.panAllowed;\n    case 'rotationAllowed':        return this.config.rotationAllowed;\n    case 'zoomAllowed':            return this.config.zoomAllowed;\n    case 'jumpAllowed':            return this.config.jumpAllowed;\n    case 'sensitivity':            return this.config.sensitivity;\n    case 'inertia':                return this.config.inertia;\n    case 'legacyInertia':          return this.config.legacyInertia;\n    case 'timeNormalizedInertia':  return this.config.timeNormalizedInertia;\n    case 'bigScreenMargins':       return this.config.bigScreenMargins;\n    case 'navigationMode':         return this.config.navigationMode;\n    case 'constrainCamera':        return this.config.constrainCamera;\n    case 'positionInUrl':          return this.config.positionInUrl;\n    case 'positionUrlHistory':     return this.config.positionUrlHistory;\n    case 'controlCompass':         return this.config.controlCompass;\n    case 'controlZoom':            return this.config.controlZoom;\n    case 'controlMeasure':         return this.config.controlMeasure;\n    case 'controlScale':           return this.config.controlScale;\n    case 'controlLayers':          return this.config.controlLayers;\n    case 'controlSpace':           return this.config.controlSpace;\n    case 'controlSearch':          return this.config.controlSearch;\n    case 'controlLink':            return this.config.controlLink;\n    case 'controlGithub':          return this.config.controlGithub;\n    case 'controlMeasure':         return this.config.controlMeasure;\n    case 'controlMeasureLite':     return this.config.controlMeasureLite;\n    case 'controlLogo':            return this.config.controlLogo;\n    case 'controlFullscreen':      return this.config.controlFullscreen;\n    case 'controlCredits':         return this.config.controlCredits;\n    case 'controlLoading':         return this.config.controlLoading;\n    case 'controlSearchElement':   return this.config.controlSearchElement;\n    case 'controlSearchValue':     return this.config.controlSearchValue;\n    case 'controlSearchUrl':       return this.config.controlSearchUrl;\n    case 'controlSearchSrs':       return this.config.controlSearchSrs;\n    case 'controlSearchFilter':    return this.config.controlSearchFilter;\n    case 'minViewExtent':          return this.config.minViewExtent;\n    case 'maxViewExtent':          return this.config.maxViewExtent;\n    case 'rotate':                 return this.config.autoRotate;\n    case 'pan':                    return this.config.autoPan;\n    }\n\n    //if (ignoreCore) {\n    if (key.indexOf('map') == 0 && map) {\n        return map.getConfigParam(key);\n    }\n\n    if (key.indexOf('renderer') == 0) {\n        return map.getConfigParam(key);\n    }\n    //}\n};\n\n\nexport default Browser;\n","\n//css stuff\nimport './browser.css';\nimport './presenter/css/main.css';\nimport './presenter/css/panel.css';\nimport './presenter/css/subtitles.css';\n\nimport Browser_ from './browser';\n\n\n//get rid of compiler mess\nvar Browser = Browser_;\n\n\nvar BrowserInterface = function(element, config) {\n    this.browser = new Browser(element, config);\n    this.core = this.browser.getCore();\n    this.killed = false;\n\n\n    Object.defineProperty(this, 'map', {\n        get: function() {\n            if (this.killed) return;\n            return this.core.map;\n        }\n    });\n\n    Object.defineProperty(this, 'renderer', {\n        get: function() {\n            if (this.killed) return;\n            return this.core.renderer;\n        }\n    });\n\n    Object.defineProperty(this, 'autopilot', {\n        get: function() {\n            if (this.killed) return;\n            return this.browser.autopilot;\n        }\n    });\n\n    Object.defineProperty(this, 'presenter', {\n        get: function() {\n            if (this.killed) return;\n            return this.browser.presenter;\n        }\n    });\n\n    Object.defineProperty(this, 'ui', {\n        get: function() {\n            if (this.killed) return;\n            return this.browser.ui;\n        }\n    });\n};\n\n\n\nBrowserInterface.prototype.destroy = function() {\n    if (this.killed) return;\n    this.core.destroy();\n    this.browser.kill();\n    this.killed = true;\n    return null;    \n};\n\n\nBrowserInterface.prototype.setControlMode = function(mode) {\n    if (this.killed) return;\n    this.browser.setControlMode(mode);\n    return this;    \n};\n\n\nBrowserInterface.prototype.getControlMode = function() {\n    if (this.killed) return;\n    return this.browser.getControlMode();\n};\n\n\nBrowserInterface.prototype.loadMap = function(path) {\n    if (this.killed) return;\n    this.core.loadMap(path);\n    return this;    \n};\n\n\nBrowserInterface.prototype.destroyMap = function() {\n    if (this.killed) return;\n    this.core.destroyMap();\n    this.map = null;\n    return this;    \n};\n\n\nBrowserInterface.prototype.on = function(eventName, call) {\n    if (this.killed) return;\n    return this.core.on(eventName, call);\n    //return this;    \n};\n\n\nBrowserInterface.prototype.setParams = function(params) {\n    if (this.killed) return;\n    this.setConfigParams(params,true);\n    return this;\n};\n\n\nBrowserInterface.prototype.setParam = function(key, value) {\n    if (this.killed) return;\n    this.browser.setConfigParam(key, value, true);\n    return this;\n};\n\n\nBrowserInterface.prototype.getParam = function(key) {\n    if (this.killed) return;\n    return this.browser.getConfigParam(key);\n};\n\n\nexport default BrowserInterface;\n","\nimport Proj4 from 'melowntech-proj4';\nimport earcut from 'earcut';\nimport {getCoreVersion as getCoreVersion_, checkSupport as checkSupport_} from '../core/core';\nimport {vec2 as vec2_, vec3 as vec3_, vec4 as vec4_, mat3 as mat3_, mat4 as mat4_} from '../core/utils/matrix';\nimport {utils as utils_} from '../core/utils/utils';\nimport {math as math_} from '../core/utils/math';\nimport {platform as platform_} from '../core/utils/platform';\nimport BrowserInterface_ from './interface';\nimport Dom_ from './utility/dom';\n\n//get rid of compiler mess\nvar getCoreVersion = getCoreVersion_, checkSupport = checkSupport_;\nvar vec2 = vec2_, vec3 = vec3_, vec4 = vec4_, mat3 = mat3_, mat4 = mat4_;\nvar utils = utils_;\nvar dom = Dom_;\nvar math = math_;\nvar BrowserInterface = BrowserInterface_;\nvar proj4 = Proj4;\nvar platform = platform_;\n\nfunction browser (element, config) {\n    var browserInterface = new BrowserInterface(element, config);\n    return browserInterface.core ? browserInterface : null;\n}\n\nfunction getBrowserVersion() {\n//    return \"Browser: 2.0.0, Core: \" + getCoreVersion();\n    return '' + getCoreVersion();\n}\n\nexport {vec2,vec3,vec4,mat3,mat4,math,utils,getCoreVersion,checkSupport,browser,getBrowserVersion,proj4,earcut,platform,dom};\n"],"sourceRoot":""}